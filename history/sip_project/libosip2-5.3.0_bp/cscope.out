cscope 15 /home/unasaw/sip_project/libosip2-5.3.0_bp -q 0000002889 0000636994
	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/internal.h

20 #i‚de‡
_INTERNAL_H_


21 
	#_INTERNAL_H_


	)

23 #i‡
deföed
(
HAVE_CONFIG_H
)

24 
	~<osù-c⁄fig.h
>

27 #i‡
deföed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

28 
	#HAVE_CTYPE_H
 1

	)

29 
	#HAVE_STRING_H
 1

	)

30 
	#HAVE_SYS_TYPES_H
 1

	)

31 
	#HAVE_TIME_H
 1

	)

32 
	#HAVE_STDARG_H
 1

	)

34 #ñi‡
deföed
(
__VXWORKS_OS__
Ë|| deföed(
__πems__
)

35 
	#HAVE_STRING_H
 1

	)

36 
	#HAVE_TIME_H
 1

	)

37 
	#HAVE_SYS_TIME_H
 1

	)

38 
	#HAVE_SYS_TYPES_H
 1

	)

39 
	#HAVE_STDARG_H
 1

	)

41 #ñi‡
deföed
 
_WIN32_WCE


43 
	#HAVE_CTYPE_H
 1

	)

44 
	#HAVE_STRING_H
 1

	)

45 
	#HAVE_TIME_H
 1

	)

46 
	#HAVE_STDARG_H
 1

	)

48 
	#¢¥ötf
 
_¢¥ötf


	)

50 #ñi‡
deföed
(
WIN32
)

52 
	#HAVE_CTYPE_H
 1

	)

53 
	#HAVE_STRING_H
 1

	)

54 
	#HAVE_SYS_TYPES_H
 1

	)

55 
	#HAVE_TIME_H
 1

	)

56 
	#HAVE_STDARG_H
 1

	)

58 #i‡(
_MSC_VER
 < 1900)

59 
	#¢¥ötf
 
_¢¥ötf


	)

64 #i‡
_MSC_VER
 >= 1300

65 
	#WIN32_USE_CRYPTO
 1

	)

70 #i‡
deföed
(
HAVE_STRING_H
)

71 
	~<°rög.h
>

72 #ñi‡
deföed
(
HAVE_STRINGS_H
)

73 
	~<°rögs.h
>

75 
	~<°rög.h
>

78 
	~<°dio.h
>

79 
	~<°dlib.h
>

81 #i‡
deföed
(
HAVE_SYS_TYPES_H
)

82 
	~<sys/ty≥s.h
>

85 #ifde‡
HAVE_TIME_H


86 
	~<time.h
>

89 #i‡
deföed
(
HAVE_SYS_TIME_H
)

90 
	~<sys/time.h
>

93 #i‡
deföed
(
__¨c__
)

94 
	~"ö˛udes_≠i.h
"

95 
	~"os_cfg_pub.h
"

96 
	~<posix_time_pub.h
>

99 #ifde‡
__PSOS__


100 
	#VA_START
(
a
, 
f
Ë
	`va_°¨t
◊, f)

	)

101 
	~"≤a.h
"

102 
	~"°dlib.h
"

103 
	~"time.h
"

104 
	#timîcmp
(
tvp
, 
uvp
, 
cmp
Ë(—vp)->
tv_£c
 
	`cmp
(uvp)->tv_£¯|| (tvp)->tv_£¯=(uvp)->tv_£¯&& (tvp)->
tv_u£c
 cmp(uvp)->tv_u£c)

	)

105 
	#¢¥ötf
 
osù_¢¥ötf


	)

106 #i‚de‡
INT_MAX


107 
	#INT_MAX
 0x7FFFFFFF

	)

111 #ifde‡
__BORLANDC__


112 
	#_timeb
 
timeb


	)

113 
	#_·ime
 
·ime


	)

116 #i‚de‡
DOXYGEN


118 #i‡!(
deföed
(
__πems__
Ë|| deföed(
__PALMOS__
Ë|| deföed(
HAVE_STRUCT_TIMEVAL
))

120 
	stimevÆ
 {

121 
	mtv_£c
;

122 
	mtv_u£c
;

126 #i‚de‡
OSIP_MONOTHREAD


129 #i‡
deföed
(
__πems__
)

130 
	~<πems.h
>

135 #i‡!
deföed
(
__VXWORKS_OS__
Ë&& !deföed(
__PSOS__
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
HAVE_PTHREAD_WIN32
Ë&& !deföed(
HAVE_PTHREAD
Ë&& !deföed(
HAVE_PTHREAD_H
Ë&& !deföed(
HAVE_PTH_PTHREAD_H
)

136 #îr‹ 
No
 
thªad
 
im∂emíèti⁄
 
found
!

142 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTHREAD_H
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

143 #i‡
deföed
(
__¨c__
)

144 
	~<ucos_ii_≠i.h
>

147 
	~<±hªad.h
>

148 
±hªad_t
 
	tosù_thªad_t
;

151 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

152 
	~<wö≠iÁmûy.h
>

156 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

157 #i‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

158 
	#HAVE_CPP11_THREAD


	)

159 #ñi‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PC_APP
)

160 
	#HAVE_CPP11_THREAD


	)

164 #i‡
deföed
(
HAVE_CPP11_THREAD
)

167 *
	mh
;

168 } 
	tosù_thªad_t
;

170 #ñi‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

173 
	#_WINSOCKAPI_


	)

174 
	~<wödows.h
>

175 #unde‡
_WINSOCKAPI_


178 
HANDLE
 
	mh
;

179 
	mid
;

180 } 
	tosù_thªad_t
;

183 #ifde‡
__VXWORKS_OS__


184 
	~<èskLib.h
>

186 
	mid
;

187 } 
	tosù_thªad_t
;

190 #ifde‡
__PSOS__


191 
	~<psos.h
>

193 
	mtid
;

194 } 
	tosù_thªad_t
;

200 #i‡!
deföed
(
HAVE_SEMAPHORE_H
Ë&& !deföed(
HAVE_SYS_SEM_H
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
HAVE_PTHREAD_WIN32
Ë&& !deföed(
__PSOS__
Ë&& !deföed(
__VXWORKS_OS__
Ë&& !deföed(
__¨c__
)

201 #îr‹ 
No
 
£m≠h‹e
 
im∂emíèti⁄
 
found


205 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTHREAD_H
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

206 
±hªad_muãx_t
 
	tosù_muãx_t
;

209 #ifde‡
__sun__


210 
	~<£m≠h‹e.h
>

211 #unde‡
gëd©e


212 
	~<synch.h
>

215 #i‡
deföed
(
__¨c__
)

218 
	m_£m_cou¡î
;

219 
osù_muãx
 *
	m_£m_muãx
;

220 } 
	t£m_t
;

222 
£m_t
 
	tosù_£m_t
;

224 #ñi‡(
deföed
(
HAVE_SEMAPHORE_H
Ë&& !deföed(
__APPLE_CC__
)Ë|| deföed(
HAVE_PTHREAD_WIN32
)

225 
	~<£m≠h‹e.h
>

226 #ifde‡
__sun__


227 #unde‡
gëd©e


228 
	~<synch.h
>

234 
£m_t
 
	tosù_£m_t
;

236 #ñi‡
deföed
(
__APPLE_CC__
)

237 
	~<mach/èsk.h
>

238 
	~<mach/£m≠h‹e.h
>

239 
	~<mach/mach_öô.h
>

241 
£m≠h‹e_t
 
	m£mid
;

242 } 
	tosù_£m_t
;

243 #ñi‡
deföed
(
HAVE_SYS_SEM_H
)

244 
	~<sys/ty≥s.h
>

245 
	~<sys/ùc.h
>

246 
	~<sys/£m.h
>

248 
	m£mid
;

249 } 
	tosù_£m_t
;

253 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

255 
	#_WINSOCKAPI_


	)

256 
	~<wödows.h
>

257 #unde‡
_WINSOCKAPI_


259 #i‡(
_WIN32_WINNT
 >0x0403Ë&& (!
deföed
(
_WIN32_WCE
))

261 
	#OSIP_CRITICALSECTION_SPIN
 4000

	)

263 
CRITICAL_SECTION
 
	mh
;

264 } 
	tosù_muãx_t
;

268 
HANDLE
 
	mh
;

269 } 
	tosù_muãx_t
;

273 
HANDLE
 
	mh
;

274 } 
	tosù_£m_t
;

277 #ifde‡
__VXWORKS_OS__


278 
	~<£m≠h‹e.h
>

279 
	~<£mLib.h
>

280 
£m≠h‹e
 
	tosù_muãx_t
;

281 
£m_t
 
	tosù_£m_t
;

284 #ifde‡
__PSOS__


285 
	~<Ty≥s.h
>

286 
	~<os.h
>

288 
UI¡32
 
	mid
;

289 } 
	tosù_muãx_t
;

291 
UI¡32
 
	mid
;

292 } 
	tosù_£m_t
;

301 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

302 
	sosù_c⁄d
 {

303 
±hªad_c⁄d_t
 
	mcv
;

304 } 
	tosù_c⁄d_t
;

307 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

308 
	sosù_c⁄d
 {

309 
osù_muãx
 *
	mmut
;

310 
osù_£m
 *
	m£m
;

311 } 
	tosù_c⁄d_t
;

314 #i‡
deföed
(
__PSOS__
Ë|| deföed(
__VXWORKS_OS__
)

315 
	sosù_c⁄d
 {

316 
osù_£m
 *
	m£m
;

317 } 
	tosù_c⁄d_t
;

322 #i‡
deföed
(
__πems__
)

324 
πems_id
 
	mtid
;

325 } 
	tosù_thªad_t
;

328 
πems_id
 
	mid
;

329 } 
	tosù_£m_t
;

332 
πems_id
 
	mid
;

333 } 
	tosù_muãx_t
;

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip.h

20 #i‚de‡
_OSIP_H_


21 
	#_OSIP_H_


	)

23 
	~<osù∑r£r2/osù_c⁄°.h
>

26 
	~<osù2/osù_time.h
>

28 #ifde‡
__sun


29 
	~<sys/ty≥s.h
>

32 
	~<osù∑r£r2/osù_∑r£r.h
>

33 
	~<osù2/osù_fifo.h
>

47 #ifde‡
__˝lu•lus


56 
	e_°©e_t
 {

58 
ICT_PRE_CALLING
,

59 
ICT_CALLING
,

60 
ICT_PROCEEDING
,

61 
ICT_COMPLETED
,

62 
ICT_TERMINATED
,

65 
IST_PRE_PROCEEDING
,

66 
IST_PROCEEDING
,

67 
IST_COMPLETED
,

68 
IST_CONFIRMED
,

69 
IST_TERMINATED
,

72 
NICT_PRE_TRYING
,

73 
NICT_TRYING
,

74 
NICT_PROCEEDING
,

75 
NICT_COMPLETED
,

76 
NICT_TERMINATED
,

79 
NIST_PRE_TRYING
,

80 
NIST_TRYING
,

81 
NIST_PROCEEDING
,

82 
NIST_COMPLETED
,

83 
NIST_TERMINATED
,

85 #i‚de‡
DOXYGEN


86 
DIALOG_EARLY
,

87 
DIALOG_CONFIRMED
,

88 
DIALOG_CLOSE


90 } 
	t°©e_t
;

109 
	ety≥_t
 {

111 
TIMEOUT_A
,

112 
TIMEOUT_B
,

113 
TIMEOUT_D
,

116 
TIMEOUT_E
,

117 
TIMEOUT_F
,

118 
TIMEOUT_K
,

121 
TIMEOUT_G
,

122 
TIMEOUT_H
,

123 
TIMEOUT_I
,

126 
TIMEOUT_J
,

129 
RCV_REQINVITE
,

130 
RCV_REQACK
,

131 
RCV_REQUEST
,

132 
RCV_STATUS_1XX
,

133 
RCV_STATUS_2XX
,

134 
RCV_STATUS_3456XX
,

137 
SND_REQINVITE
,

138 
SND_REQACK
,

139 
SND_REQUEST
,

140 
SND_STATUS_1XX
,

141 
SND_STATUS_2XX
,

142 
SND_STATUS_3456XX
,

144 
KILL_TRANSACTION
,

145 
UNKNOWN_EVT


146 } 
	tty≥_t
;

156 
	eosù_fsm_ty≥_t
 {

157 
ICT
,

158 
IST
,

159 
NICT
,

160 
NIST


161 } 
	tosù_fsm_ty≥_t
;

163 #i‚de‡
DEFAULT_T1


168 
	#DEFAULT_T1
 500

	)

170 #i‚de‡
DEFAULT_T1_TCP_PROGRESS


180 
	#DEFAULT_T1_TCP_PROGRESS
 500

	)

182 #i‚de‡
DEFAULT_T2


187 
	#DEFAULT_T2
 4000

	)

189 #i‚de‡
DEFAULT_T4


194 
	#DEFAULT_T4
 5000

	)

201 
osù_i˘
 
	tosù_i˘_t
;

207 
	sosù_i˘
 {

208 
timî_a_Àngth
;

209 
timevÆ
 
timî_a_°¨t
;

210 
timî_b_Àngth
;

211 
timevÆ
 
timî_b_°¨t
;

212 
timî_d_Àngth
;

213 
timevÆ
 
timî_d_°¨t
;

214 *
de°ö©i⁄
;

215 
p‹t
;

222 
osù_ni˘
 
	tosù_ni˘_t
;

228 
	sosù_ni˘
 {

229 
timî_e_Àngth
;

230 
timevÆ
 
timî_e_°¨t
;

231 
timî_f_Àngth
;

232 
timevÆ
 
timî_f_°¨t
;

233 
timî_k_Àngth
;

234 
timevÆ
 
timî_k_°¨t
;

235 *
de°ö©i⁄
;

236 
p‹t
;

243 
osù_i°
 
	tosù_i°_t
;

249 
	sosù_i°
 {

250 
timî_g_Àngth
;

251 
timevÆ
 
timî_g_°¨t
;

252 
timî_h_Àngth
;

253 
timevÆ
 
timî_h_°¨t
;

254 
timî_i_Àngth
;

255 
timevÆ
 
timî_i_°¨t
;

262 
osù_ni°
 
	tosù_ni°_t
;

268 
	sosù_ni°
 {

269 
timî_j_Àngth
;

270 
timevÆ
 
timî_j_°¨t
;

277 
osù_§v_íåy
 
	tosù_§v_íåy_t
;

284 
	sosù_§v_íåy
 {

285 
§v
[512];

286 
¥i‹ôy
;

287 
weight
;

288 
rweight
;

289 
p‹t
;

290 
ùaddªss
[512];

291 
timevÆ
 
§v_is_brokí
;

294 
	#OSIP_SRV_STATE_UNKNOWN
 0

	)

295 
	#OSIP_SRV_STATE_RETRYLATER
 2

	)

296 
	#OSIP_SRV_STATE_COMPLETED
 3

	)

297 
	#OSIP_SRV_STATE_NOTSUPPORTED
 4

	)

303 
osù_§v_ªc‹d
 
	tosù_§v_ªc‹d_t
;

309 
	sosù_§v_ªc‹d
 {

310 
«me
[1024];

311 
§v_°©e
;

312 
Êag
[256];

313 
¥Ÿocﬁ
[1024];

314 
ªgexp
[1024];

315 
ª∂a˚mít
[1024];

316 
‹dî
;

317 
¥e„ªn˚
;

318 
ödex
;

319 
osù_§v_íåy_t
 
§víåy
[10];

322 
	#OSIP_NAPTR_STATE_UNKNOWN
 0

	)

323 
	#OSIP_NAPTR_STATE_INPROGRESS
 1

	)

324 
	#OSIP_NAPTR_STATE_NAPTRDONE
 2

	)

325 
	#OSIP_NAPTR_STATE_SRVINPROGRESS
 3

	)

326 
	#OSIP_NAPTR_STATE_SRVDONE
 4

	)

327 
	#OSIP_NAPTR_STATE_RETRYLATER
 5

	)

328 
	#OSIP_NAPTR_STATE_NOTSUPPORTED
 6

	)

334 
osù_«±r
 
	tosù_«±r_t
;

340 
	sosù_«±r
 {

341 
domaö
[512];

342 
AUS
[64];

343 
«±r_°©e
;

344 *
¨g
;

345 
kìp_ö_ˇche
;

346 
osù_§v_ªc‹d
 
sùudp_ªc‹d
;

347 
osù_§v_ªc‹d
 
sùt˝_ªc‹d
;

348 
osù_§v_ªc‹d
 
sùés_ªc‹d
;

349 
osù_§v_ªc‹d
 
sùdés_ªc‹d
;

350 
osù_§v_ªc‹d
 
sùs˘p_ªc‹d
;

351 
osù_§v_ªc‹d
 
sùíum_ªc‹d
;

358 
osù_å™ß˘i⁄
 
	tosù_å™ß˘i⁄_t
;

364 
	sosù_å™ß˘i⁄
 {

365 *
your_ö°™˚
;

366 
å™ß˘i⁄id
;

367 
osù_fifo_t
 *
å™ß˘i⁄ff
;

369 
osù_vü_t
 *
t›vü
;

370 
osù_‰om_t
 *
‰om
;

371 
osù_to_t
 *
to
;

372 
osù_ˇŒ_id_t
 *
ˇŒid
;

373 
osù_c£q_t
 *
c£q
;

375 
osù_mesßge_t
 *
‹ig_ªque°
;

376 
osù_mesßge_t
 *
œ°_ª•⁄£
;

377 
osù_mesßge_t
 *
ack
;

379 
°©e_t
 
°©e
;

381 
time_t
 
búth_time
;

382 
time_t
 
com∂ëed_time
;

383 
timevÆ
 
¸óãd_time
;

384 
timevÆ
 
de°royed_time
;

386 
ö_sockë
;

387 
out_sockë
;

389 *
c⁄fig
;

391 
osù_fsm_ty≥_t
 
˘x_ty≥
;

392 
osù_i˘_t
 *
i˘_c⁄ãxt
;

393 
osù_i°_t
 *
i°_c⁄ãxt
;

394 
osù_ni˘_t
 *
ni˘_c⁄ãxt
;

395 
osù_ni°_t
 *
ni°_c⁄ãxt
;

397 
osù_§v_ªc‹d_t
 
ªc‹d
;

398 
osù_«±r_t
 *
«±r_ªc‹d
;

399 *
ª£rved1
;

400 *
ª£rved2
;

401 *
ª£rved3
;

402 *
ª£rved4
;

403 *
ª£rved5
;

404 *
ª£rved6
;

410 
	eosù_mesßge_ˇŒback_ty≥
 {

411 
OSIP_ICT_INVITE_SENT
 = 0,

412 
OSIP_ICT_INVITE_SENT_AGAIN
,

413 
OSIP_ICT_ACK_SENT
,

414 
OSIP_ICT_ACK_SENT_AGAIN
,

415 
OSIP_ICT_STATUS_1XX_RECEIVED
,

416 
OSIP_ICT_STATUS_2XX_RECEIVED
,

417 
OSIP_ICT_STATUS_2XX_RECEIVED_AGAIN
,

418 
OSIP_ICT_STATUS_3XX_RECEIVED
,

419 
OSIP_ICT_STATUS_4XX_RECEIVED
,

420 
OSIP_ICT_STATUS_5XX_RECEIVED
,

421 
OSIP_ICT_STATUS_6XX_RECEIVED
,

422 
OSIP_ICT_STATUS_3456XX_RECEIVED_AGAIN
,

424 
OSIP_IST_INVITE_RECEIVED
,

425 
OSIP_IST_INVITE_RECEIVED_AGAIN
,

426 
OSIP_IST_ACK_RECEIVED
,

427 
OSIP_IST_ACK_RECEIVED_AGAIN
,

428 
OSIP_IST_STATUS_1XX_SENT
,

429 
OSIP_IST_STATUS_2XX_SENT
,

430 
OSIP_IST_STATUS_2XX_SENT_AGAIN
,

431 
OSIP_IST_STATUS_3XX_SENT
,

432 
OSIP_IST_STATUS_4XX_SENT
,

433 
OSIP_IST_STATUS_5XX_SENT
,

434 
OSIP_IST_STATUS_6XX_SENT
,

435 
OSIP_IST_STATUS_3456XX_SENT_AGAIN
,

437 
OSIP_NICT_REGISTER_SENT
,

438 
OSIP_NICT_BYE_SENT
,

439 
OSIP_NICT_OPTIONS_SENT
,

440 
OSIP_NICT_INFO_SENT
,

441 
OSIP_NICT_CANCEL_SENT
,

442 
OSIP_NICT_NOTIFY_SENT
,

443 
OSIP_NICT_SUBSCRIBE_SENT
,

444 
OSIP_NICT_UNKNOWN_REQUEST_SENT
,

445 
OSIP_NICT_REQUEST_SENT_AGAIN
,

446 
OSIP_NICT_STATUS_1XX_RECEIVED
,

447 
OSIP_NICT_STATUS_2XX_RECEIVED
,

448 
OSIP_NICT_STATUS_2XX_RECEIVED_AGAIN
,

449 
OSIP_NICT_STATUS_3XX_RECEIVED
,

450 
OSIP_NICT_STATUS_4XX_RECEIVED
,

451 
OSIP_NICT_STATUS_5XX_RECEIVED
,

452 
OSIP_NICT_STATUS_6XX_RECEIVED
,

453 
OSIP_NICT_STATUS_3456XX_RECEIVED_AGAIN
,

455 
OSIP_NIST_REGISTER_RECEIVED
,

456 
OSIP_NIST_BYE_RECEIVED
,

457 
OSIP_NIST_OPTIONS_RECEIVED
,

458 
OSIP_NIST_INFO_RECEIVED
,

459 
OSIP_NIST_CANCEL_RECEIVED
,

460 
OSIP_NIST_NOTIFY_RECEIVED
,

461 
OSIP_NIST_SUBSCRIBE_RECEIVED
,

463 
OSIP_NIST_UNKNOWN_REQUEST_RECEIVED
,

464 
OSIP_NIST_REQUEST_RECEIVED_AGAIN
,

465 
OSIP_NIST_STATUS_1XX_SENT
,

466 
OSIP_NIST_STATUS_2XX_SENT
,

467 
OSIP_NIST_STATUS_2XX_SENT_AGAIN
,

468 
OSIP_NIST_STATUS_3XX_SENT
,

469 
OSIP_NIST_STATUS_4XX_SENT
,

470 
OSIP_NIST_STATUS_5XX_SENT
,

471 
OSIP_NIST_STATUS_6XX_SENT
,

472 
OSIP_NIST_STATUS_3456XX_SENT_AGAIN
,

474 
OSIP_ICT_STATUS_TIMEOUT
,

475 
OSIP_NICT_STATUS_TIMEOUT
,

477 
OSIP_MESSAGE_CALLBACK_COUNT


478 } 
	tosù_mesßge_ˇŒback_ty≥_t
;

483 
	eosù_kûl_ˇŒback_ty≥
 {

484 
OSIP_ICT_KILL_TRANSACTION
,

485 
OSIP_IST_KILL_TRANSACTION
,

486 
OSIP_NICT_KILL_TRANSACTION
,

487 
OSIP_NIST_KILL_TRANSACTION
,

489 
OSIP_KILL_CALLBACK_COUNT


490 } 
	tosù_kûl_ˇŒback_ty≥_t
;

495 
	eosù_å™•‹t_îr‹_ˇŒback_ty≥
 {

496 
OSIP_ICT_TRANSPORT_ERROR
,

497 
OSIP_IST_TRANSPORT_ERROR
,

498 
OSIP_NICT_TRANSPORT_ERROR
,

499 
OSIP_NIST_TRANSPORT_ERROR
,

501 
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT


502 } 
	tosù_å™•‹t_îr‹_ˇŒback_ty≥_t
;

508 (*
osù_mesßge_cb_t
)(
	tty≥
, 
	tosù_å™ß˘i⁄_t
 *, 
	tosù_mesßge_t
 *);

513 (*
osù_kûl_å™ß˘i⁄_cb_t
)(
	tty≥
, 
	tosù_å™ß˘i⁄_t
 *);

518 (*
osù_å™•‹t_îr‹_cb_t
)(
	tty≥
, 
	tosù_å™ß˘i⁄_t
 *, 
	tîr‹
);

520 
osù_dülog
;

526 
ixt
 
	tixt_t
;

532 
	sixt
 {

534 
osù_dülog
 *
dülog
;

535 
osù_mesßge_t
 *
msg2xx
;

536 
osù_mesßge_t
 *
ack
;

537 
timevÆ
 
°¨t
;

538 
öãrvÆ
;

539 *
de°
;

540 
p‹t
;

541 
sock
;

542 
cou¡î
;

552 
osù
 
	tosù_t
;

558 
	sosù
 {

559 *
≠∂iˇti⁄_c⁄ãxt
;

561 *
i˘_Á°muãx
;

562 *
i°_Á°muãx
;

563 *
ni˘_Á°muãx
;

564 *
ni°_Á°muãx
;

565 *
ixt_Á°muãx
;

566 *
id_muãx
;

567 
å™ß˘i⁄id
;

570 
osù_li°_t
 
osù_i˘_å™ß˘i⁄s
;

571 
osù_li°_t
 
osù_i°_å™ß˘i⁄s
;

572 
osù_li°_t
 
osù_ni˘_å™ß˘i⁄s
;

573 
osù_li°_t
 
osù_ni°_å™ß˘i⁄s
;

575 
osù_li°_t
 
ixt_ªå™smissi⁄s
;

577 
osù_mesßge_cb_t
 
msg_ˇŒbacks
[
OSIP_MESSAGE_CALLBACK_COUNT
];

578 
osù_kûl_å™ß˘i⁄_cb_t
 
kûl_ˇŒbacks
[
OSIP_KILL_CALLBACK_COUNT
];

579 
osù_å™•‹t_îr‹_cb_t
 
ç_îr‹_ˇŒbacks
[
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
];

581 (*
cb_£nd_mesßge
)(
osù_å™ß˘i⁄_t
 *, 
osù_mesßge_t
 *, *, , );

583 *
osù_i˘_ha°abÀ
;

584 *
osù_i°_ha°abÀ
;

585 *
osù_ni˘_ha°abÀ
;

586 *
osù_ni°_ha°abÀ
;

595 
osù_£t_mesßge_ˇŒback
(
osù_t
 *
osù
, 
ty≥
, 
osù_mesßge_cb_t
 
cb
);

603 
osù_£t_kûl_å™ß˘i⁄_ˇŒback
(
osù_t
 *
osù
, 
ty≥
, 
osù_kûl_å™ß˘i⁄_cb_t
 
cb
);

611 
osù_£t_å™•‹t_îr‹_ˇŒback
(
osù_t
 *
osù
, 
ty≥
, 
osù_å™•‹t_îr‹_cb_t
 
cb
);

621 
osù_evít
 
	tosù_evít_t
;

627 
	sosù_evít
 {

628 
ty≥_t
 
ty≥
;

629 
å™ß˘i⁄id
;

630 
osù_mesßge_t
 *
sù
;

640 
osù_å™ß˘i⁄_öô
(
osù_å™ß˘i⁄_t
 **
å™ß˘i⁄
, 
osù_fsm_ty≥_t
 
˘x_ty≥
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
ªque°
);

645 
osù_å™ß˘i⁄_‰ì
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

653 
osù_å™ß˘i⁄_‰ì2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

662 
osù_ª•⁄£_gë_de°ö©i⁄
(
osù_mesßge_t
 *
ª•⁄£
, **
addªss
, *
p‹äum
);

672 
osù_i˘_£t_de°ö©i⁄
(
osù_i˘_t
 *
i˘
, *
de°ö©i⁄
, 
p‹t
);

683 
osù_ni˘_£t_de°ö©i⁄
(
osù_ni˘_t
 *
ni˘
, *
de°ö©i⁄
, 
p‹t
);

690 
osù_å™ß˘i⁄_add_evít
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_evít_t
 *
evt
);

699 
osù_å™ß˘i⁄_execuã
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_evít_t
 *
evt
);

712 
osù_å™ß˘i⁄_£t_your_ö°™˚
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

725 
osù_å™ß˘i⁄_£t_ª£rved1
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

732 
osù_å™ß˘i⁄_£t_ª£rved2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

740 
osù_å™ß˘i⁄_£t_ª£rved3
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

748 
osù_å™ß˘i⁄_£t_ª£rved4
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

756 
osù_å™ß˘i⁄_£t_ª£rved5
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

764 
osù_å™ß˘i⁄_£t_ª£rved6
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
);

771 *
osù_å™ß˘i⁄_gë_your_ö°™˚
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

777 *
osù_å™ß˘i⁄_gë_ª£rved1
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

783 *
osù_å™ß˘i⁄_gë_ª£rved2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

789 *
osù_å™ß˘i⁄_gë_ª£rved3
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

795 *
osù_å™ß˘i⁄_gë_ª£rved4
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

801 *
osù_å™ß˘i⁄_gë_ª£rved5
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

807 *
osù_å™ß˘i⁄_gë_ª£rved6
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
);

816 
osù_å™ß˘i⁄_gë_de°ö©i⁄
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, **
ù
, *
p‹t
);

824 
osù_å™ß˘i⁄_£t_§v_ªc‹d
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_§v_ªc‹d_t
 *
ªc‹d
);

832 
osù_å™ß˘i⁄_£t_«±r_ªc‹d
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_«±r_t
 *
ªc‹d
);

840 
osù_å™ß˘i⁄_£t_ö_sockë
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
sock
);

847 
osù_å™ß˘i⁄_£t_out_sockë
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
sock
);

853 
osù_öô
(
osù_t
 **
osù
);

858 
osù_ªÀa£
(
osù_t
 *
osù
);

866 
osù_£t_≠∂iˇti⁄_c⁄ãxt
(
osù_t
 *
osù
, *
poöãr
);

873 *
osù_gë_≠∂iˇti⁄_c⁄ãxt
(
osù_t
 *
osù
);

880 
osù_ªmove_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i˘
);

886 
osù_i˘_execuã
(
osù_t
 *
osù
);

891 
osù_i°_execuã
(
osù_t
 *
osù
);

896 
osù_ni˘_execuã
(
osù_t
 *
osù
);

901 
osù_ni°_execuã
(
osù_t
 *
osù
);

911 
osù_timîs_gëtimeout
(
osù_t
 *
osù
, 
timevÆ
 *
lowî_tv
);

917 
osù_timîs_i˘_execuã
(
osù_t
 *
osù
);

922 
osù_timîs_i°_execuã
(
osù_t
 *
osù
);

927 
osù_timîs_ni˘_execuã
(
osù_t
 *
osù
);

932 
osù_timîs_ni°_execuã
(
osù_t
 *
osù
);

940 
osù_å™ß˘i⁄_t
 *
osù_å™ß˘i⁄_föd
(
osù_li°_t
 *
å™ß˘i⁄s
, 
osù_evít_t
 *
evt
);

942 #i‚de‡
DOXYGEN


950 #ifde‡
OSIP_MONOTHREAD


951 
osù_å™ß˘i⁄_t
 *
osù_föd_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
);

954 
osù_å™ß˘i⁄_t
 *
__osù_föd_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
, 
c⁄sume
);

963 
osù_föd_å™ß˘i⁄_™d_add_evít
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
);

970 
osù_å™ß˘i⁄_t
 *
osù_¸óã_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
);

977 
osù_evít_t
 *
osù_∑r£
(c⁄° *
buf
, 
size_t
 
Àngth
);

983 
osù_ªå™smissi⁄s_execuã
(
osù_t
 *
osù
);

992 
osù_°¨t_200ok_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_dülog
 *
dülog
, 
osù_mesßge_t
 *
msg200ok
, 
sock
);

1003 
osù_°¨t_ack_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_dülog
 *
dülog
, 
osù_mesßge_t
 *
ack
, *
de°
, 
p‹t
, 
sock
);

1010 
osù_dülog
 *
osù_°›_200ok_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_mesßge_t
 *
ack
);

1019 
osù_°›_ªå™smissi⁄s_‰om_dülog
(
osù_t
 *
osù
, 
osù_dülog
 *
dülog
);

1025 
osù_evít_t
 *
osù_√w_outgoög_sùmesßge
(
osù_mesßge_t
 *
sù
);

1031 
osù_evít_‰ì
(
osù_evít_t
 *
evít
);

1038 
osù_£t_cb_£nd_mesßge
(
osù_t
 *
cf
, (*
cb
)(
osù_å™ß˘i⁄_t
 *, 
osù_mesßge_t
 *, *, , ));

1045 
	#EVT_IS_RCV_INVITE
(
evít
Ë”vít->
ty≥
 =
RCV_REQINVITE
)

	)

1050 
	#EVT_IS_RCV_ACK
(
evít
Ë”vít->
ty≥
 =
RCV_REQACK
)

	)

1055 
	#EVT_IS_RCV_REQUEST
(
evít
Ë”vít->
ty≥
 =
RCV_REQUEST
)

	)

1060 
	#EVT_IS_RCV_STATUS_1XX
(
evít
Ë”vít->
ty≥
 =
RCV_STATUS_1XX
)

	)

1065 
	#EVT_IS_RCV_STATUS_2XX
(
evít
Ë”vít->
ty≥
 =
RCV_STATUS_2XX
)

	)

1070 
	#EVT_IS_RCV_STATUS_3456XX
(
evít
Ë”vít->
ty≥
 =
RCV_STATUS_3456XX
)

	)

1077 
	#EVT_IS_SND_INVITE
(
evít
Ë”vít->
ty≥
 =
SND_REQINVITE
)

	)

1082 
	#EVT_IS_SND_ACK
(
evít
Ë”vít->
ty≥
 =
SND_REQACK
)

	)

1087 
	#EVT_IS_SND_REQUEST
(
evít
Ë”vít->
ty≥
 =
SND_REQUEST
)

	)

1092 
	#EVT_IS_SND_STATUS_1XX
(
evít
Ë”vít->
ty≥
 =
SND_STATUS_1XX
)

	)

1097 
	#EVT_IS_SND_STATUS_2XX
(
evít
Ë”vít->
ty≥
 =
SND_STATUS_2XX
)

	)

1102 
	#EVT_IS_SND_STATUS_3456XX
(
evít
Ë”vít->
ty≥
 =
SND_STATUS_3456XX
)

	)

1107 
	#EVT_IS_INCOMINGMSG
(
evít
Ë”vít->
ty≥
 >
RCV_REQINVITE
 &&Évít->ty≥ <
RCV_STATUS_3456XX
)

	)

1112 
	#EVT_IS_INCOMINGREQ
(
evít
Ë(
	`EVT_IS_RCV_INVITE
”vítË|| 
	`EVT_IS_RCV_ACK
”vítË|| 
	`EVT_IS_RCV_REQUEST
”vít))

	)

1117 
	#EVT_IS_INCOMINGRESP
(
evít
Ë(
	`EVT_IS_RCV_STATUS_1XX
”vítË|| 
	`EVT_IS_RCV_STATUS_2XX
”vítË|| 
	`EVT_IS_RCV_STATUS_3456XX
”vít))

	)

1122 
	#EVT_IS_OUTGOINGMSG
(
evít
Ë”vít->
ty≥
 >
SND_REQINVITE
 &&Évít->ty≥ <
SND_STATUS_3456XX
)

	)

1127 
	#EVT_IS_OUTGOINGREQ
(
evít
Ë(
	`EVT_IS_SND_INVITE
”vítË|| 
	`EVT_IS_SND_ACK
”vítË|| 
	`EVT_IS_SND_REQUEST
”vít))

	)

1132 
	#EVT_IS_OUTGOINGRESP
(
evít
Ë(
	`EVT_IS_SND_STATUS_1XX
”vítË|| 
	`EVT_IS_SND_STATUS_2XX
”vítË|| 
	`EVT_IS_SND_STATUS_3456XX
”vít))

	)

1138 
	#EVT_IS_MSG
(
evít
Ë”vít->
ty≥
 >
RCV_REQINVITE
 &&Évít->ty≥ <
SND_STATUS_3456XX
)

	)

1144 
	#EVT_IS_KILL_TRANSACTION
(
evít
Ë”vít->
ty≥
 =
KILL_TRANSACTION
)

	)

1146 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_condv.h

20 #i‚de‡
__OSIP_CONDV_H__


21 
	#__OSIP_CONDV_H__


	)

23 
	~<°dio.h
>

25 #i‚de‡
OSIP_MONOTHREAD


41 #ifde‡
__˝lu•lus


45 #i‡
deföed
(
__PSOS__
)

52 #i‡
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)

54 #i‡(
_MSC_VER
 < 1900)

55 #i‚de‡
HAVE_STRUCT_TIMESPEC


56 
	#HAVE_STRUCT_TIMESPEC
 1

	)

61 
	stime•ec
 {

62 
tv_£c
;

63 
tv_n£c
;

69 
	gosù_c⁄d
;

74 
osù_c⁄d
 *
osù_c⁄d_öô
();

79 
osù_c⁄d_de°roy
(
osù_c⁄d
 *
c⁄d
);

84 
osù_c⁄d_sig«l
(
osù_c⁄d
 *
c⁄d
);

91 
osù_c⁄d_waô
(
osù_c⁄d
 *
c⁄d
, 
osù_muãx
 *
mut
);

98 
osù_c⁄d_timedwaô
(
osù_c⁄d
 *
c⁄d
, 
osù_muãx
 *
mut
, c⁄° 
time•ec
 *
ab°ime
);

100 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_dialog.h

20 #i‚de‡
_DIALOG_H_


21 
	#_DIALOG_H_


	)

23 
	~<osù2/osù.h
>

36 #ifde‡
__˝lu•lus


40 #i‚de‡
DOXYGEN


41 
	e_osù_dülog_ty≥_t
 { 
CALLER
, 
CALLEE
 } 
	tosù_dülog_ty≥_t
;

48 
osù_dülog
 
	tosù_dülog_t
;

54 
	sosù_dülog
 {

55 *
	gˇŒ_id
;

56 *
	gloˇl_èg
;

57 *
	gªmŸe_èg
;

58 *
	glöe_∑øm
;

59 
osù_li°_t
 
	grouã_£t
;

60 
	gloˇl_c£q
;

61 
	gªmŸe_c£q
;

62 
osù_to_t
 *
	gªmŸe_uri
;

63 
osù_‰om_t
 *
	gloˇl_uri
;

64 
osù_c⁄è˘_t
 *
	gªmŸe_c⁄è˘_uri
;

66 
	g£cuª
;

68 
osù_dülog_ty≥_t
 
	gty≥
;

69 
°©e_t
 
	g°©e
;

70 *
	gyour_ö°™˚
;

78 
	#osù_dülog_£t_ö°™˚
(
dülog
, 
ö°™˚
Ë(dülog)->
your_ö°™˚
 = (*Ë(ö°™˚)

	)

85 
	#osù_dülog_gë_ö°™˚
(
dülog
Ë(dülog)->
your_ö°™˚


	)

98 
osù_dülog_öô_as_uac
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
ª•⁄£
);

107 
osù_dülog_öô_as_uac_wôh_ªmŸe_ªque°
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
√xt_ªque°
, 
loˇl_c£q
);

117 
osù_dülog_öô_as_uas
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
övôe
, osù_mesßge_à*
ª•⁄£
);

122 
osù_dülog_‰ì
(
osù_dülog_t
 *
dülog
);

129 
osù_dülog_£t_°©e
(
osù_dülog_t
 *
dülog
, 
°©e_t
 
ty≥
);

140 
osù_dülog_upd©e_rouã_£t_as_uas
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
övôe
);

147 
osù_dülog_upd©e_osù_c£q_as_uas
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ªque°
);

154 
osù_dülog_m©ch_as_uac
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ª•⁄£
);

161 
osù_dülog_upd©e_èg_as_uac
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ª•⁄£
);

172 
osù_dülog_upd©e_rouã_£t_as_uac
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ª•⁄£
);

179 
osù_dülog_m©ch_as_uas
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ªque°
);

185 
osù_dülog_is_‹igö©‹
(
osù_dülog_t
 *
dülog
);

190 
osù_dülog_is_ˇŒì
(
osù_dülog_t
 *
dülog
);

192 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_fifo.h

20 #i‚de‡
_FIFO_H_


21 
	#_FIFO_H_


	)

23 #i‚de‡
OSIP_MONOTHREAD


24 
	~<osù2/osù_mt.h
>

26 
	~<osù∑r£r2/osù_li°.h
>

42 #ifde‡
__˝lu•lus


46 #i‚de‡
DOXYGEN


48 íum { 
osù_ok
, 
osù_em±y
 } 
	tosù_fifo_°©e
;

56 
osù_fifo
 
	tosù_fifo_t
;

62 
	sosù_fifo
 {

63 #i‚de‡
OSIP_MONOTHREAD


64 
osù_muãx
 *
	gqi¶ocked
;

65 
osù_£m
 *
	gqi£m±y
;

67 
osù_li°_t
 
	gqueue
;

68 
	gnb_ñt
;

69 
osù_fifo_°©e
 
	g°©e
;

81 
osù_fifo_öô
(
osù_fifo_t
 *
ff
);

86 
osù_fifo_‰ì
(
osù_fifo_t
 *
ff
);

92 
osù_fifo_ö£π
(
osù_fifo_t
 *
ff
, *
ñemít
);

98 
osù_fifo_add
(
osù_fifo_t
 *
ff
, *
ñemít
);

103 
osù_fifo_size
(
osù_fifo_t
 *
ff
);

104 #i‚de‡
OSIP_MONOTHREAD


109 *
osù_fifo_gë
(
osù_fifo_t
 *
ff
);

115 *
osù_fifo_åygë
(
osù_fifo_t
 *
ff
);

119 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_mt.h

20 #i‚de‡
_OSIP_MT_H_


21 
	#_OSIP_MT_H_


	)

23 #i‚de‡
OSIP_MONOTHREAD


25 
	~<°dio.h
>

41 #ifde‡
__˝lu•lus


49 
osù_thªad
;

57 
osù_thªad
 *
osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
);

63 
osù_thªad_joö
(
osù_thªad
 *
thªad
);

70 
osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
thªad
, 
¥i‹ôy
);

74 
osù_thªad_exô
();

76 #ifde‡
__˝lu•lus


84 #ifde‡
__˝lu•lus


92 
osù_£m
;

98 
osù_£m
 *
osù_£m_öô
(
vÆue
);

103 
osù_£m_de°roy
(
osù_£m
 *
£m
);

108 
osù_£m_po°
(
osù_£m
 *
£m
);

114 
osù_£m_waô
(
osù_£m
 *
£m
);

120 
osù_£m_åywaô
(
osù_£m
 *
£m
);

122 #ifde‡
__˝lu•lus


130 #ifde‡
__˝lu•lus


138 
osù_muãx
;

143 
osù_muãx
 *
osù_muãx_öô
();

148 
osù_muãx_de°roy
(
osù_muãx
 *
mut
);

153 
osù_muãx_lock
(
osù_muãx
 *
mut
);

158 
osù_muãx_u∆ock
(
osù_muãx
 *
mut
);

160 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_time.h

20 #i‚de‡
_OSIP_TIME_H_


21 
	#_OSIP_TIME_H_


	)

23 #ifde‡
__˝lu•lus


29 #i‡
deföed
(
_WIN32_WCE
)

30 
	s_timeb
 {

31 
time_t
 
time
;

32 
mûlôm
;

33 
timez⁄e
;

34 
d°Êag
;

40 
	gtimevÆ
;

43 
add_gëtimeofday
(
timevÆ
 *
©v
, 
ms
);

44 
mö_timîcmp
(
timevÆ
 *
tv1
, timevÆ *
tv2
);

47 #i‡!
deföed
(
timîis£t
)

48 
	#osù_timîis£t
(
tvp
Ë(—vp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

50 
	#osù_timîis£t
(
tvp
Ë
	`timîis£t
—vp)

	)

53 #i‡!
deföed
(
timîcmp
)

54 
	#osù_timîcmp
(
a
, 
b
, 
CMP
Ë((◊)->
tv_£c
 =(b)->tv_£cË? (◊)->
tv_u£c
 
	`CMP
(b)->tv_u£cË: (◊)->tv_£¯CMP(b)->tv_£c))

	)

56 
	#osù_timîcmp
(
tvp
, 
uvp
, 
cmp
Ë
	`timîcmp
—vp, uvp, cmp)

	)

59 #i‡!
deföed
(
timî˛ór
)

60 
	#osù_timî˛ór
(
tvp
Ë—vp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0

	)

62 
	#osù_timî˛ór
(
tvp
Ë
	`timî˛ór
—vp)

	)

65 #i‡!
deföed
(
timîsub
)

66 
	#osù_timîsub
(
a
, 
b
, 
ªsu…
) \

68 (
ªsu…
)->
tv_£c
 = (
a
)->tv_£¯- (
b
)->tv_sec; \

69 (
ªsu…
)->
tv_u£c
 = (
a
)->tv_u£¯- (
b
)->tv_usec; \

70 i‡((
ªsu…
)->
tv_u£c
 < 0) { \

71 --(
ªsu…
)->
tv_£c
; \

72 (
ªsu…
)->
tv_u£c
 += 1000000; \

74 } 0)

	)

76 
	#osù_timîsub
(
a
, 
b
, 
ªsu…
Ë
	`timîsub
◊, b,Ñesu…)

	)

79 
osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
);

80 
time_t
 
osù_gësy°emtime
—ime_à*
t
);

81 
osù_com≥nßãtime
();

83 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept.h

20 #i‚de‡
_OSIP_ACCEPT_H_


21 
	#_OSIP_ACCEPT_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_ty≥.h
>

40 
osù_c⁄ã¡_ty≥_t
 
	tosù_ac˚±_t
;

42 #ifde‡
__˝lu•lus


50 
	#ac˚±_öô
(
hódî
Ë
	`osù_c⁄ã¡_ty≥_öô
(hódî)

	)

55 
	#osù_ac˚±_‰ì
 
osù_c⁄ã¡_ty≥_‰ì


	)

61 
	#osù_ac˚±_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_c⁄ã¡_ty≥_∑r£
(hódî, hvÆue)

	)

67 
osù_ac˚±_to_°r
(c⁄° 
osù_ac˚±_t
 *
hódî
, **
de°
);

73 
	#osù_ac˚±_˛⁄e
 
osù_c⁄ã¡_ty≥_˛⁄e


	)

80 
	#osù_ac˚±_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

87 
	#osù_ac˚±_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

89 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_encoding.h

20 #i‚de‡
_OSIP_ACCEPT_ENCONDING_H_


21 
	#_OSIP_ACCEPT_ENCONDING_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

40 
osù_ac˚±_ícodög
 
	tosù_ac˚±_ícodög_t
;

46 
	sosù_ac˚±_ícodög
 {

47 *
	mñemít
;

48 
osù_li°_t
 
	mgí_∑øms
;

51 #ifde‡
__˝lu•lus


59 
osù_ac˚±_ícodög_öô
(
osù_ac˚±_ícodög_t
 **
hódî
);

65 
osù_ac˚±_ícodög_∑r£
(
osù_ac˚±_ícodög_t
 *
hódî
, c⁄° *
hvÆue
);

71 
osù_ac˚±_ícodög_to_°r
(c⁄° 
osù_ac˚±_ícodög_t
 *
hódî
, **
de°
);

76 
osù_ac˚±_ícodög_‰ì
(
osù_ac˚±_ícodög_t
 *
hódî
);

82 
osù_ac˚±_ícodög_˛⁄e
(c⁄° 
osù_ac˚±_ícodög_t
 *
hódî
, osù_ac˚±_ícodög_à**
de°
);

89 
osù_ac˚±_ícodög_£t_ñemít
(
osù_ac˚±_ícodög_t
 *
hódî
, *
vÆue
);

94 *
osù_ac˚±_ícodög_gë_ñemít
(c⁄° 
osù_ac˚±_ícodög_t
 *
hódî
);

101 
	#osù_ac˚±_ícodög_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

108 
	#osù_ac˚±_ícodög_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

110 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_language.h

20 #i‚de‡
_OSIP_ACCEPT_LANGUAGE_H_


21 
	#_OSIP_ACCEPT_LANGUAGE_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_ac˚±_ícodög.h
>

40 
osù_ac˚±_ícodög_t
 
	tosù_ac˚±_œnguage_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_ac˚±_œnguage_öô
(
hódî
Ë
	`osù_ac˚±_ícodög_öô
(hódî)

	)

56 
	#osù_ac˚±_œnguage_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_ac˚±_ícodög_∑r£
(hódî, hvÆue)

	)

62 
	#osù_ac˚±_œnguage_to_°r
 
osù_ac˚±_ícodög_to_°r


	)

67 
	#osù_ac˚±_œnguage_‰ì
 
osù_ac˚±_ícodög_‰ì


	)

73 
	#osù_ac˚±_œnguage_˛⁄e
 
osù_ac˚±_ícodög_˛⁄e


	)

79 
	#osù_ac˚±_œnguage_gë_ñemít
(
hódî
Ë
	`osù_ac˚±_ícodög_gë_ñemít
(hódî)

	)

85 
	#osù_ac˚±_œnguage_£t_ñemít
(
hódî
, 
vÆue
Ë
	`osù_ac˚±_ícodög_£t_ñemít
(hódî, vÆue)

	)

92 
	#osù_ac˚±_œnguage_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

99 
	#osù_ac˚±_œnguage_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

101 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_alert_info.h

20 #i‚de‡
_OSIP_ALERT_INFO_H_


21 
	#_OSIP_ALERT_INFO_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_ˇŒ_öfo.h
>

40 
osù_ˇŒ_öfo_t
 
	tosù_Æît_öfo_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_Æît_öfo_öô
(
hódî
Ë
	`osù_ˇŒ_öfo_öô
(hódî)

	)

55 
	#osù_Æît_öfo_‰ì
 
osù_ˇŒ_öfo_‰ì


	)

61 
	#osù_Æît_öfo_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_ˇŒ_öfo_∑r£
(hódî, hvÆue)

	)

67 
	#osù_Æît_öfo_to_°r
(
hódî
, 
de°
Ë
	`osù_ˇŒ_öfo_to_°r
(hódî, de°)

	)

73 
	#osù_Æît_öfo_˛⁄e
 
osù_ˇŒ_öfo_˛⁄e


	)

78 
	#osù_Æît_öfo_gë_uri
(
hódî
Ë
	`osù_ˇŒ_öfo_gë_uri
(hódî)

	)

84 
	#osù_Æît_öfo_£t_uri
(
hódî
, 
uri
Ë
	`osù_ˇŒ_öfo_£t_uri
(hódî, uri)

	)

86 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_allow.h

20 #i‚de‡
_OSIP_ALLOW_H_


21 
	#_OSIP_ALLOW_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_Àngth.h
>

40 
osù_c⁄ã¡_Àngth_t
 
	tosù_Ælow_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_Ælow_öô
(
hódî
Ë
	`osù_c⁄ã¡_Àngth_öô
(hódî)

	)

56 
	#osù_Ælow_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_c⁄ã¡_Àngth_∑r£
(hódî, hvÆue)

	)

62 
	#osù_Ælow_to_°r
 
osù_c⁄ã¡_Àngth_to_°r


	)

67 
	#osù_Ælow_‰ì
 
osù_c⁄ã¡_Àngth_‰ì


	)

73 
	#osù_Ælow_˛⁄e
 
osù_c⁄ã¡_Àngth_˛⁄e


	)

75 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authentication_info.h

20 #i‚de‡
_OSIP_AUTHENTICATION_INFO_H_


21 
	#_OSIP_AUTHENTICATION_INFO_H_


	)

38 
osù_authítiˇti⁄_öfo
 
	tosù_authítiˇti⁄_öfo_t
;

44 
	sosù_authítiˇti⁄_öfo
 {

45 *
	mauth_ty≥
;

46 *
	m√xä⁄˚
;

47 *
	mq›_›ti⁄s
;

48 *
	mr•auth
;

49 *
	m˙⁄˚
;

50 *
	mn⁄˚_cou¡
;

51 *
	m¢um
;

52 *
	m§™d
;

53 *
	mªÆm
;

54 *
	mèrgë«me
;

55 *
	m›aque
;

58 #ifde‡
__˝lu•lus


66 
osù_authítiˇti⁄_öfo_öô
(
osù_authítiˇti⁄_öfo_t
 **
hódî
);

72 
osù_authítiˇti⁄_öfo_∑r£
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, c⁄° *
hvÆue
);

78 
osù_authítiˇti⁄_öfo_to_°r
(c⁄° 
osù_authítiˇti⁄_öfo_t
 *
hódî
, **
de°
);

83 
osù_authítiˇti⁄_öfo_‰ì
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

89 
osù_authítiˇti⁄_öfo_˛⁄e
(c⁄° 
osù_authítiˇti⁄_öfo_t
 *
hódî
, osù_authítiˇti⁄_öfo_à**
de°
);

95 *
osù_authítiˇti⁄_öfo_gë_auth_ty≥
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

101 
osù_authítiˇti⁄_öfo_£t_auth_ty≥
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

106 *
osù_authítiˇti⁄_öfo_gë_√xä⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

112 
osù_authítiˇti⁄_öfo_£t_√xä⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

117 *
osù_authítiˇti⁄_öfo_gë_˙⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

123 
osù_authítiˇti⁄_öfo_£t_˙⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

128 *
osù_authítiˇti⁄_öfo_gë_q›_›ti⁄s
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

134 
osù_authítiˇti⁄_öfo_£t_q›_›ti⁄s
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

139 *
osù_authítiˇti⁄_öfo_gë_r•auth
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

145 
osù_authítiˇti⁄_öfo_£t_r•auth
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

150 *
osù_authítiˇti⁄_öfo_gë_n⁄˚_cou¡
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

156 
osù_authítiˇti⁄_öfo_£t_n⁄˚_cou¡
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

161 *
osù_authítiˇti⁄_öfo_gë_¢um
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

167 
osù_authítiˇti⁄_öfo_£t_¢um
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

172 *
osù_authítiˇti⁄_öfo_gë_§™d
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

178 
osù_authítiˇti⁄_öfo_£t_§™d
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

183 *
osù_authítiˇti⁄_öfo_gë_èrgë«me
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

189 
osù_authítiˇti⁄_öfo_£t_èrgë«me
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

194 *
osù_authítiˇti⁄_öfo_gë_ªÆm
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

200 
osù_authítiˇti⁄_öfo_£t_ªÆm
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

205 *
osù_authítiˇti⁄_öfo_gë_›aque
(
osù_authítiˇti⁄_öfo_t
 *
hódî
);

211 
osù_authítiˇti⁄_öfo_£t_›aque
(
osù_authítiˇti⁄_öfo_t
 *
hódî
, *
vÆue
);

213 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authorization.h

20 #i‚de‡
_OSIP_AUTHORIZATION_H_


21 
	#_OSIP_AUTHORIZATION_H_


	)

38 
osù_auth‹iz©i⁄
 
	tosù_auth‹iz©i⁄_t
;

44 
	sosù_auth‹iz©i⁄
 {

45 *
	mauth_ty≥
;

46 *
	mu£∫ame
;

47 *
	mªÆm
;

48 *
	mn⁄˚
;

49 *
	muri
;

50 *
	mª•⁄£
;

51 *
	mdige°
;

52 *
	mÆg‹ôhm
;

53 *
	m˙⁄˚
;

54 *
	m›aque
;

55 *
	mmesßge_q›
;

56 *
	mn⁄˚_cou¡
;

57 *
	mvîsi⁄
;

58 *
	mèrgë«me
;

59 *
	mgsßpi_d©a
;

60 *
	m¸™d
;

61 *
	m˙um
;

62 *
	mauth_∑øm
;

65 #ifde‡
__˝lu•lus


73 
osù_auth‹iz©i⁄_öô
(
osù_auth‹iz©i⁄_t
 **
hódî
);

79 
osù_auth‹iz©i⁄_∑r£
(
osù_auth‹iz©i⁄_t
 *
hódî
, c⁄° *
hvÆue
);

85 
osù_auth‹iz©i⁄_to_°r
(c⁄° 
osù_auth‹iz©i⁄_t
 *
hódî
, **
de°
);

90 
osù_auth‹iz©i⁄_‰ì
(
osù_auth‹iz©i⁄_t
 *
hódî
);

96 
osù_auth‹iz©i⁄_˛⁄e
(c⁄° 
osù_auth‹iz©i⁄_t
 *
hódî
, osù_auth‹iz©i⁄_à**
de°
);

102 *
osù_auth‹iz©i⁄_gë_auth_ty≥
(c⁄° 
osù_auth‹iz©i⁄_t
 *
hódî
);

108 
osù_auth‹iz©i⁄_£t_auth_ty≥
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

113 *
osù_auth‹iz©i⁄_gë_u£∫ame
(
osù_auth‹iz©i⁄_t
 *
hódî
);

119 
osù_auth‹iz©i⁄_£t_u£∫ame
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

124 *
osù_auth‹iz©i⁄_gë_ªÆm
(
osù_auth‹iz©i⁄_t
 *
hódî
);

130 
osù_auth‹iz©i⁄_£t_ªÆm
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

135 *
osù_auth‹iz©i⁄_gë_n⁄˚
(
osù_auth‹iz©i⁄_t
 *
hódî
);

141 
osù_auth‹iz©i⁄_£t_n⁄˚
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

146 *
osù_auth‹iz©i⁄_gë_uri
(
osù_auth‹iz©i⁄_t
 *
hódî
);

152 
osù_auth‹iz©i⁄_£t_uri
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

157 *
osù_auth‹iz©i⁄_gë_ª•⁄£
(
osù_auth‹iz©i⁄_t
 *
hódî
);

163 
osù_auth‹iz©i⁄_£t_ª•⁄£
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

168 *
osù_auth‹iz©i⁄_gë_dige°
(
osù_auth‹iz©i⁄_t
 *
hódî
);

174 
osù_auth‹iz©i⁄_£t_dige°
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

179 *
osù_auth‹iz©i⁄_gë_Æg‹ôhm
(
osù_auth‹iz©i⁄_t
 *
hódî
);

185 
osù_auth‹iz©i⁄_£t_Æg‹ôhm
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

190 *
osù_auth‹iz©i⁄_gë_˙⁄˚
(
osù_auth‹iz©i⁄_t
 *
hódî
);

196 
osù_auth‹iz©i⁄_£t_˙⁄˚
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

201 *
osù_auth‹iz©i⁄_gë_›aque
(
osù_auth‹iz©i⁄_t
 *
hódî
);

207 
osù_auth‹iz©i⁄_£t_›aque
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

212 *
osù_auth‹iz©i⁄_gë_mesßge_q›
(
osù_auth‹iz©i⁄_t
 *
hódî
);

218 
osù_auth‹iz©i⁄_£t_mesßge_q›
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

223 *
osù_auth‹iz©i⁄_gë_n⁄˚_cou¡
(
osù_auth‹iz©i⁄_t
 *
hódî
);

229 
osù_auth‹iz©i⁄_£t_n⁄˚_cou¡
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

234 *
osù_auth‹iz©i⁄_gë_vîsi⁄
(
osù_auth‹iz©i⁄_t
 *
hódî
);

240 
osù_auth‹iz©i⁄_£t_vîsi⁄
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

245 *
osù_auth‹iz©i⁄_gë_èrgë«me
(
osù_auth‹iz©i⁄_t
 *
hódî
);

251 
osù_auth‹iz©i⁄_£t_èrgë«me
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

256 *
osù_auth‹iz©i⁄_gë_gsßpi_d©a
(
osù_auth‹iz©i⁄_t
 *
hódî
);

262 
osù_auth‹iz©i⁄_£t_gsßpi_d©a
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

267 *
osù_auth‹iz©i⁄_gë_¸™d
(
osù_auth‹iz©i⁄_t
 *
hódî
);

273 
osù_auth‹iz©i⁄_£t_¸™d
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

278 *
osù_auth‹iz©i⁄_gë_˙um
(
osù_auth‹iz©i⁄_t
 *
hódî
);

284 
osù_auth‹iz©i⁄_£t_˙um
(
osù_auth‹iz©i⁄_t
 *
hódî
, *
vÆue
);

286 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_id.h

20 #i‚de‡
_OSIP_CALL_ID_H_


21 
	#_OSIP_CALL_ID_H_


	)

38 
osù_ˇŒ_id
 
	tosù_ˇŒ_id_t
;

44 
	sosù_ˇŒ_id
 {

45 *
	mnumbî
;

46 *
	mho°
;

49 #ifde‡
__˝lu•lus


57 
osù_ˇŒ_id_öô
(
osù_ˇŒ_id_t
 **
hódî
);

62 
osù_ˇŒ_id_‰ì
(
osù_ˇŒ_id_t
 *
hódî
);

68 
osù_ˇŒ_id_∑r£
(
osù_ˇŒ_id_t
 *
hódî
, c⁄° *
hvÆue
);

74 
osù_ˇŒ_id_to_°r
(c⁄° 
osù_ˇŒ_id_t
 *
hódî
, **
de°
);

80 
osù_ˇŒ_id_˛⁄e
(c⁄° 
osù_ˇŒ_id_t
 *
hódî
, osù_ˇŒ_id_à**
de°
);

86 
osù_ˇŒ_id_£t_numbî
(
osù_ˇŒ_id_t
 *
hódî
, *
vÆue
);

91 *
osù_ˇŒ_id_gë_numbî
(
osù_ˇŒ_id_t
 *
hódî
);

97 
osù_ˇŒ_id_£t_ho°
(
osù_ˇŒ_id_t
 *
hódî
, *
vÆue
);

102 *
osù_ˇŒ_id_gë_ho°
(
osù_ˇŒ_id_t
 *
hódî
);

110 
osù_ˇŒ_id_m©ch
(
osù_ˇŒ_id_t
 *
ˇŒid1
, osù_ˇŒ_id_à*
ˇŒid2
);

112 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_info.h

20 #i‚de‡
_OSIP_CALL_INFO_H_


21 
	#_OSIP_CALL_INFO_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

40 
osù_ˇŒ_öfo
 
	tosù_ˇŒ_öfo_t
;

46 
	sosù_ˇŒ_öfo
 {

47 *
	mñemít
;

48 
osù_li°_t
 
	mgí_∑øms
;

51 #ifde‡
__˝lu•lus


59 
osù_ˇŒ_öfo_öô
(
osù_ˇŒ_öfo_t
 **
hódî
);

64 
osù_ˇŒ_öfo_‰ì
(
osù_ˇŒ_öfo_t
 *
hódî
);

70 
osù_ˇŒ_öfo_∑r£
(
osù_ˇŒ_öfo_t
 *
hódî
, c⁄° *
hvÆue
);

76 
osù_ˇŒ_öfo_to_°r
(c⁄° 
osù_ˇŒ_öfo_t
 *
hódî
, **
de°
);

82 
osù_ˇŒ_öfo_˛⁄e
(c⁄° 
osù_ˇŒ_öfo_t
 *
hódî
, osù_ˇŒ_öfo_à**
de°
);

87 *
osù_ˇŒ_öfo_gë_uri
(
osù_ˇŒ_öfo_t
 *
hódî
);

93 
osù_ˇŒ_öfo_£t_uri
(
osù_ˇŒ_öfo_t
 *
hódî
, *
uri
);

95 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_contact.h

20 #i‚de‡
_OSIP_CONTACT_H_


21 
	#_OSIP_CONTACT_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_‰om.h
>

40 
osù_‰om_t
 
	tosù_c⁄è˘_t
;

42 #ifde‡
__˝lu•lus


46 #i‚de‡
MINISIZE


51 
osù_c⁄è˘_öô
(
osù_c⁄è˘_t
 **
hódî
);

56 
osù_c⁄è˘_‰ì
(
osù_c⁄è˘_t
 *
hódî
);

63 
osù_c⁄è˘_∑r£
(
osù_c⁄è˘_t
 *
hódî
, c⁄° *
hvÆue
);

69 
osù_c⁄è˘_to_°r
(c⁄° 
osù_c⁄è˘_t
 *
hódî
, **
de°
);

70 #i‚de‡
MINISIZE


76 
osù_c⁄è˘_˛⁄e
(c⁄° 
osù_c⁄è˘_t
 *
hódî
, osù_c⁄è˘_à**
de°
);

78 
	#osù_c⁄è˘_öô
 
osù_‰om_öô


	)

79 
	#osù_c⁄è˘_‰ì
 
osù_‰om_‰ì


	)

80 
	#osù_c⁄è˘_˛⁄e
 
osù_‰om_˛⁄e


	)

86 
	#osù_c⁄è˘_gë_di•œy«me
(
hódî
Ë
	`osù_‰om_gë_di•œy«me
((
osù_‰om_t
 *Ëhódî)

	)

92 
	#osù_c⁄è˘_£t_di•œy«me
(
hódî
, 
vÆue
Ë
	`osù_‰om_£t_di•œy«me
((
osù_‰om_t
 *Ëhódî, vÆue)

	)

97 
	#osù_c⁄è˘_gë_uæ
(
hódî
Ë
	`osù_‰om_gë_uæ
((
osù_‰om_t
 *Ëhódî)

	)

103 
	#osù_c⁄è˘_£t_uæ
(
hódî
, 
uæ
Ë
	`osù_‰om_£t_uæ
((
osù_‰om_t
 *Ëhódî, uæ)

	)

110 
	#osù_c⁄è˘_∑øm_gë
(
hódî
, 
pos
, 
de°
Ë
	`osù_‰om_∑øm_gë
((
osù_‰om_t
 *Ëhódî,Öos, de°)

	)

117 
	#osù_c⁄è˘_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

124 
	#osù_c⁄è˘_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

126 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_disposition.h

20 #i‚de‡
_OSIP_CONTENT_DISPOSITION_H_


21 
	#_OSIP_CONTENT_DISPOSITION_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_ˇŒ_öfo.h
>

40 
osù_ˇŒ_öfo_t
 
	tosù_c⁄ã¡_di•osôi⁄_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_c⁄ã¡_di•osôi⁄_öô
(
hódî
Ë
	`osù_ˇŒ_öfo_öô
(hódî)

	)

55 
	#osù_c⁄ã¡_di•osôi⁄_‰ì
(
hódî
Ë
	`osù_ˇŒ_öfo_‰ì
(hódî)

	)

61 
osù_c⁄ã¡_di•osôi⁄_∑r£
(
osù_c⁄ã¡_di•osôi⁄_t
 *
hódî
, c⁄° *
hvÆue
);

67 
	#osù_c⁄ã¡_di•osôi⁄_to_°r
(
hódî
, 
de°
Ë
	`osù_ˇŒ_öfo_to_°r
(hódî, de°)

	)

73 
	#osù_c⁄ã¡_di•osôi⁄_˛⁄e
 
osù_ˇŒ_öfo_˛⁄e


	)

81 
	#osù_c⁄ã¡_di•osôi⁄_£t_ty≥
(
hódî
, 
vÆue
Ë
	`osù_ˇŒ_öfo_£t_uri
(hódî, vÆue)

	)

86 
	#osù_c⁄ã¡_di•osôi⁄_gë_ty≥
(
hódî
Ë
	`osù_ˇŒ_öfo_gë_uri
(hódî)

	)

88 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_encoding.h

20 #i‚de‡
_OSIP_CONTENT_ENCODING_H_


21 
	#_OSIP_CONTENT_ENCODING_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_Àngth.h
>

40 
osù_c⁄ã¡_Àngth_t
 
	tosù_c⁄ã¡_ícodög_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_c⁄ã¡_ícodög_öô
(
hódî
Ë
	`osù_c⁄ã¡_Àngth_öô
(hódî)

	)

56 
	#osù_c⁄ã¡_ícodög_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_c⁄ã¡_Àngth_∑r£
(hódî, hvÆue)

	)

62 
	#osù_c⁄ã¡_ícodög_to_°r
 
osù_c⁄ã¡_Àngth_to_°r


	)

67 
	#osù_c⁄ã¡_ícodög_‰ì
 
osù_c⁄ã¡_Àngth_‰ì


	)

73 
	#osù_c⁄ã¡_ícodög_˛⁄e
 
osù_c⁄ã¡_Àngth_˛⁄e


	)

75 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_length.h

20 #i‚de‡
_OSIP_CONTENT_LENGTH_H_


21 
	#_OSIP_CONTENT_LENGTH_H_


	)

38 
osù_c⁄ã¡_Àngth
 
	tosù_c⁄ã¡_Àngth_t
;

44 
	sosù_c⁄ã¡_Àngth
 {

45 *
	mvÆue
;

48 #ifde‡
__˝lu•lus


56 
osù_c⁄ã¡_Àngth_öô
(
osù_c⁄ã¡_Àngth_t
 **
hódî
);

61 
osù_c⁄ã¡_Àngth_‰ì
(
osù_c⁄ã¡_Àngth_t
 *
hódî
);

67 
osù_c⁄ã¡_Àngth_∑r£
(
osù_c⁄ã¡_Àngth_t
 *
hódî
, c⁄° *
hvÆue
);

73 
osù_c⁄ã¡_Àngth_to_°r
(c⁄° 
osù_c⁄ã¡_Àngth_t
 *
hódî
, **
de°
);

79 
osù_c⁄ã¡_Àngth_˛⁄e
(c⁄° 
osù_c⁄ã¡_Àngth_t
 *
hódî
, osù_c⁄ã¡_Àngth_à**
de°
);

81 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_type.h

20 #i‚de‡
_OSIP_CONTENT_TYPE_H_


21 
	#_OSIP_CONTENT_TYPE_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

40 
osù_c⁄ã¡_ty≥
 
	tosù_c⁄ã¡_ty≥_t
;

46 
	sosù_c⁄ã¡_ty≥
 {

47 *
	mty≥
;

48 *
	msubty≥
;

49 
osù_li°_t
 
	mgí_∑øms
;

52 #ifde‡
__˝lu•lus


60 
osù_c⁄ã¡_ty≥_öô
(
osù_c⁄ã¡_ty≥_t
 **
hódî
);

65 
osù_c⁄ã¡_ty≥_‰ì
(
osù_c⁄ã¡_ty≥_t
 *
hódî
);

71 
osù_c⁄ã¡_ty≥_∑r£
(
osù_c⁄ã¡_ty≥_t
 *
hódî
, c⁄° *
hvÆue
);

77 
osù_c⁄ã¡_ty≥_to_°r
(c⁄° 
osù_c⁄ã¡_ty≥_t
 *
hódî
, **
de°
);

83 
osù_c⁄ã¡_ty≥_˛⁄e
(c⁄° 
osù_c⁄ã¡_ty≥_t
 *
hódî
, osù_c⁄ã¡_ty≥_à**
de°
);

91 
	#osù_c⁄ã¡_ty≥_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

98 
	#osù_c⁄ã¡_ty≥_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

100 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_cseq.h

20 #i‚de‡
_OSIP_CSEQ_H_


21 
	#_OSIP_CSEQ_H_


	)

38 
osù_c£q
 
	tosù_c£q_t
;

44 
	sosù_c£q
 {

45 *
	mmëhod
;

46 *
	mnumbî
;

49 #ifde‡
__˝lu•lus


57 
osù_c£q_öô
(
osù_c£q_t
 **
hódî
);

62 
osù_c£q_‰ì
(
osù_c£q_t
 *
hódî
);

68 
osù_c£q_∑r£
(
osù_c£q_t
 *
hódî
, c⁄° *
hvÆue
);

74 
osù_c£q_to_°r
(c⁄° 
osù_c£q_t
 *
hódî
, **
de°
);

80 
osù_c£q_˛⁄e
(c⁄° 
osù_c£q_t
 *
hódî
, osù_c£q_à**
de°
);

86 
osù_c£q_£t_numbî
(
osù_c£q_t
 *
hódî
, *
vÆue
);

91 *
osù_c£q_gë_numbî
(
osù_c£q_t
 *
hódî
);

97 
osù_c£q_£t_mëhod
(
osù_c£q_t
 *
hódî
, *
vÆue
);

102 *
osù_c£q_gë_mëhod
(
osù_c£q_t
 *
hódî
);

110 
osù_c£q_m©ch
(
osù_c£q_t
 *
c£q1
, osù_c£q_à*
c£q2
);

112 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_error_info.h

20 #i‚de‡
_OSIP_ERROR_INFO_H_


21 
	#_OSIP_ERROR_INFO_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_ˇŒ_öfo.h
>

40 
osù_ˇŒ_öfo_t
 
	tosù_îr‹_öfo_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_îr‹_öfo_öô
(
hódî
Ë
	`osù_ˇŒ_öfo_öô
(hódî)

	)

55 
	#osù_îr‹_öfo_‰ì
 
osù_ˇŒ_öfo_‰ì


	)

61 
	#osù_îr‹_öfo_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_ˇŒ_öfo_∑r£
(hódî, hvÆue)

	)

67 
	#osù_îr‹_öfo_to_°r
(
hódî
, 
de°
Ë
	`osù_ˇŒ_öfo_to_°r
(hódî, de°)

	)

73 
	#osù_îr‹_öfo_˛⁄e
 
osù_ˇŒ_öfo_˛⁄e


	)

80 
	#osù_îr‹_öfo_£t_uri
(
hódî
, 
uri
Ë
	`osù_ˇŒ_öfo_£t_uri
(hódî, uri)

	)

85 
	#osù_îr‹_öfo_gë_uri
(
hódî
Ë
	`osù_ˇŒ_öfo_gë_uri
(hódî)

	)

87 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_from.h

20 #i‚de‡
_OSIP_FROM_H_


21 
	#_OSIP_FROM_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

24 
	~<osù∑r£r2/osù_uri.h
>

41 
osù_‰om
 
	tosù_‰om_t
;

47 
	sosù_‰om
 {

48 *
	mdi•œy«me
;

49 
osù_uri_t
 *
	muæ
;

50 
osù_li°_t
 
	mgí_∑øms
;

53 #ifde‡
__˝lu•lus


61 
osù_‰om_öô
(
osù_‰om_t
 **
hódî
);

66 
osù_‰om_‰ì
(
osù_‰om_t
 *
hódî
);

72 
osù_‰om_∑r£
(
osù_‰om_t
 *
hódî
, c⁄° *
hvÆue
);

78 
osù_‰om_to_°r
(c⁄° 
osù_‰om_t
 *
hódî
, **
de°
);

84 
osù_‰om_˛⁄e
(c⁄° 
osù_‰om_t
 *
hódî
, osù_‰om_à**
de°
);

90 
osù_‰om_£t_di•œy«me
(
osù_‰om_t
 *
hódî
, *
vÆue
);

95 *
osù_‰om_gë_di•œy«me
(
osù_‰om_t
 *
hódî
);

101 
osù_‰om_£t_uæ
(
osù_‰om_t
 *
hódî
, 
osù_uri_t
 *
uæ
);

106 
osù_uri_t
 *
osù_‰om_gë_uæ
(
osù_‰om_t
 *
hódî
);

113 
osù_‰om_∑øm_gë
(
osù_‰om_t
 *
hódî
, 
pos
, 
osù_gíîic_∑øm_t
 **
de°
);

120 
	#osù_‰om_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

127 
	#osù_‰om_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

134 
	#osù_‰om_gë_èg
(
hódî
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
), "èg", de°)

	)

140 
	#osù_‰om_£t_èg
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
), 
	`osù_°rdup
("èg"), vÆue)

	)

142 #i‚de‡
DOXYGEN


144 
osù_‰om_com∑ª
(
osù_‰om_t
 *
hódî1
, osù_‰om_à*
hódî2
);

153 
osù_‰om_èg_m©ch
(
osù_‰om_t
 *
‰om1
, osù_‰om_à*
‰om2
);

155 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_header.h

20 #i‚de‡
_OSIP_HEADER_H_


21 
	#_OSIP_HEADER_H_


	)

23 
	~<osù∑r£r2/osù_uri.h
>

45 
osù_hódî
 
	tosù_hódî_t
;

51 
	sosù_hódî
 {

52 *
	mh«me
;

53 *
	mhvÆue
;

63 
osù_uri_∑øm_t
 
	tosù_gíîic_∑øm_t
;

65 #ifde‡
__˝lu•lus


73 
osù_hódî_öô
(
osù_hódî_t
 **
hódî
);

78 
osù_hódî_‰ì
(
osù_hódî_t
 *
hódî
);

84 
osù_hódî_to_°r
(c⁄° 
osù_hódî_t
 *
hódî
, **
de°
);

89 *
osù_hódî_gë_«me
(c⁄° 
osù_hódî_t
 *
hódî
);

95 
osù_hódî_£t_«me
(
osù_hódî_t
 *
hódî
, *
≤ame
);

100 *
osù_hódî_gë_vÆue
(c⁄° 
osù_hódî_t
 *
hódî
);

106 
osù_hódî_£t_vÆue
(
osù_hódî_t
 *
hódî
, *
pvÆue
);

112 
osù_hódî_˛⁄e
(c⁄° 
osù_hódî_t
 *
hódî
, osù_hódî_à**
de°
);

114 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_mime_version.h

20 #i‚de‡
_OSIP_MIME_VERSION_H_


21 
	#_OSIP_MIME_VERSION_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

24 
	~<osù∑r£r2/osù_uri.h
>

41 
osù_c⁄ã¡_Àngth_t
 
	tosù_mime_vîsi⁄_t
;

43 #ifde‡
__˝lu•lus


51 
	#osù_mime_vîsi⁄_öô
(
hódî
Ë
	`osù_c⁄ã¡_Àngth_öô
(hódî)

	)

57 
	#osù_mime_vîsi⁄_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_c⁄ã¡_Àngth_∑r£
(hódî, hvÆue)

	)

63 
	#osù_mime_vîsi⁄_to_°r
(
hódî
, 
de°
Ë
	`osù_c⁄ã¡_Àngth_to_°r
(hódî, de°)

	)

68 
	#osù_mime_vîsi⁄_‰ì
(
hódî
Ë
	`osù_c⁄ã¡_Àngth_‰ì
(hódî)

	)

74 
	#osù_mime_vîsi⁄_˛⁄e
 
osù_c⁄ã¡_Àngth_˛⁄e


	)

76 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authenticate.h

20 #i‚de‡
_OSIP_PROXY_AUHTHENTICATE_H_


21 
	#_OSIP_PROXY_AUHTHENTICATE_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_www_authítiˇã.h
>

40 
osù_www_authítiˇã_t
 
	tosù_¥oxy_authítiˇã_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_¥oxy_authítiˇã_öô
(
hódî
Ë
	`osù_www_authítiˇã_öô
(hódî)

	)

56 
	#osù_¥oxy_authítiˇã_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_www_authítiˇã_∑r£
(hódî, hvÆue)

	)

62 
	#osù_¥oxy_authítiˇã_to_°r
(
hódî
, 
de°
Ë
	`osù_www_authítiˇã_to_°r
(hódî, de°)

	)

67 
	#osù_¥oxy_authítiˇã_‰ì
 
osù_www_authítiˇã_‰ì


	)

73 
	#osù_¥oxy_authítiˇã_˛⁄e
 
osù_www_authítiˇã_˛⁄e


	)

79 
	#osù_¥oxy_authítiˇã_gë_auth_ty≥
(
hódî
Ë
	`osù_www_authítiˇã_gë_auth_ty≥
(hódî)

	)

85 
	#osù_¥oxy_authítiˇã_£t_auth_ty≥
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_auth_ty≥
(hódî, vÆue)

	)

90 
	#osù_¥oxy_authítiˇã_gë_ªÆm
(
hódî
Ë
	`osù_www_authítiˇã_gë_ªÆm
(hódî)

	)

96 
	#osù_¥oxy_authítiˇã_£t_ªÆm
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_ªÆm
(hódî, vÆue)

	)

101 
	#osù_¥oxy_authítiˇã_gë_domaö
(
hódî
Ë
	`osù_www_authítiˇã_gë_domaö
(hódî)

	)

107 
	#osù_¥oxy_authítiˇã_£t_domaö
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_domaö
(hódî, vÆue)

	)

112 
	#osù_¥oxy_authítiˇã_gë_n⁄˚
(
hódî
Ë
	`osù_www_authítiˇã_gë_n⁄˚
(hódî)

	)

118 
	#osù_¥oxy_authítiˇã_£t_n⁄˚
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_n⁄˚
(hódî, vÆue)

	)

123 
	#osù_¥oxy_authítiˇã_gë_›aque
(
hódî
Ë
	`osù_www_authítiˇã_gë_›aque
(hódî)

	)

129 
	#osù_¥oxy_authítiˇã_£t_›aque
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_›aque
(hódî, vÆue)

	)

134 
	#osù_¥oxy_authítiˇã_gë_°Æe
(
hódî
Ë
	`osù_www_authítiˇã_gë_°Æe
(hódî)

	)

140 
	#osù_¥oxy_authítiˇã_£t_°Æe
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_°Æe
(hódî, vÆue)

	)

145 
	#osù_¥oxy_authítiˇã_£t_°Æe_åue
(
hódî
Ë
	`osù_www_authítiˇã_£t_°Æe
(hódî, 
	`osù_°rdup
("åue"))

	)

150 
	#osù_¥oxy_authítiˇã_£t_°Æe_Ál£
(
hódî
Ë
	`osù_www_authítiˇã_£t_°Æe
(hódî, 
	`osù_°rdup
("Ál£"))

	)

155 
	#osù_¥oxy_authítiˇã_gë_Æg‹ôhm
(
hódî
Ë
	`osù_www_authítiˇã_gë_Æg‹ôhm
(hódî)

	)

161 
	#osù_¥oxy_authítiˇã_£t_Æg‹ôhm
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_Æg‹ôhm
(hódî, vÆue)

	)

166 
	#osù_¥oxy_authítiˇã_£t_Æg‹ôhm_MD5
(
hódî
Ë
	`osù_www_authítiˇã_£t_Æg‹ôhm
(hódî, 
	`osù_°rdup
("MD5"))

	)

171 
	#osù_¥oxy_authítiˇã_gë_q›_›ti⁄s
(
hódî
Ë
	`osù_www_authítiˇã_gë_q›_›ti⁄s
(hódî)

	)

177 
	#osù_¥oxy_authítiˇã_£t_q›_›ti⁄s
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_q›_›ti⁄s
(hódî, vÆue)

	)

182 
	#osù_¥oxy_authítiˇã_gë_vîsi⁄
(
hódî
Ë
	`osù_www_authítiˇã_gë_vîsi⁄
(hódî)

	)

188 
	#osù_¥oxy_authítiˇã_£t_vîsi⁄
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_vîsi⁄
(hódî, vÆue)

	)

193 
	#osù_¥oxy_authítiˇã_gë_èrgë«me
(
hódî
Ë
	`osù_www_authítiˇã_gë_èrgë«me
(hódî)

	)

199 
	#osù_¥oxy_authítiˇã_£t_èrgë«me
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_èrgë«me
(hódî, vÆue)

	)

204 
	#osù_¥oxy_authítiˇã_gë_gsßpi_d©a
(
hódî
Ë
	`osù_www_authítiˇã_gë_gsßpi_d©a
(hódî)

	)

210 
	#osù_¥oxy_authítiˇã_£t_gsßpi_d©a
(
hódî
, 
vÆue
Ë
	`osù_www_authítiˇã_£t_gsßpi_d©a
(hódî, vÆue)

	)

212 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authentication_info.h

20 #i‚de‡
_OSIP_PROXY_AUTHENTICATION_INFO_H_


21 
	#_OSIP_PROXY_AUTHENTICATION_INFO_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_authítiˇti⁄_öfo.h
>

40 
osù_authítiˇti⁄_öfo_t
 
	tosù_¥oxy_authítiˇti⁄_öfo_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_¥oxy_authítiˇti⁄_öfo_öô
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_öô
(hódî)

	)

56 
	#osù_¥oxy_authítiˇti⁄_öfo_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_authítiˇti⁄_öfo_∑r£
(hódî, hvÆue)

	)

62 
	#osù_¥oxy_authítiˇti⁄_öfo_to_°r
(
hódî
, 
de°
Ë
	`osù_authítiˇti⁄_öfo_to_°r
(hódî, de°)

	)

67 
	#osù_¥oxy_authítiˇti⁄_öfo_‰ì
 
osù_authítiˇti⁄_öfo_‰ì


	)

73 
	#osù_¥oxy_authítiˇti⁄_öfo_˛⁄e
 
osù_authítiˇti⁄_öfo_˛⁄e


	)

79 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_√xä⁄˚
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_√xä⁄˚
(hódî)

	)

85 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_√xä⁄˚
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_√xä⁄˚
(hódî, vÆue)

	)

90 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_˙⁄˚
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_˙⁄˚
(hódî)

	)

96 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_˙⁄˚
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_˙⁄˚
(hódî, vÆue)

	)

101 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_q›_›ti⁄s
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_q›_›ti⁄s
(hódî)

	)

107 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_q›_›ti⁄s
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_q›_›ti⁄s
(hódî, vÆue)

	)

112 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_r•auth
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_r•auth
(hódî)

	)

118 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_r•auth
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_r•auth
(hódî, vÆue)

	)

123 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_n⁄˚_cou¡
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_n⁄˚_cou¡
(hódî)

	)

129 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_n⁄˚_cou¡
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_n⁄˚_cou¡
(hódî, vÆue)

	)

134 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_¢um
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_¢um
(hódî)

	)

140 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_¢um
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_¢um
(hódî, vÆue)

	)

145 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_§™d
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_§™d
(hódî)

	)

151 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_§™d
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_§™d
(hódî, vÆue)

	)

156 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_èrgë«me
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_èrgë«me
(hódî)

	)

162 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_èrgë«me
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_èrgë«me
(hódî, vÆue)

	)

167 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_ªÆm
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_ªÆm
(hódî)

	)

173 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_ªÆm
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_ªÆm
(hódî, vÆue)

	)

178 
	#osù_¥oxy_authítiˇti⁄_öfo_gë_›aque
(
hódî
Ë
	`osù_authítiˇti⁄_öfo_gë_›aque
(hódî)

	)

184 
	#osù_¥oxy_authítiˇti⁄_öfo_£t_›aque
(
hódî
, 
vÆue
Ë
	`osù_authítiˇti⁄_öfo_£t_›aque
(hódî, vÆue)

	)

186 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authorization.h

20 #i‚de‡
_OSIP_PROXY_AUHTHORIZATION_H_


21 
	#_OSIP_PROXY_AUHTHORIZATION_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_auth‹iz©i⁄.h
>

40 
osù_auth‹iz©i⁄_t
 
	tosù_¥oxy_auth‹iz©i⁄_t
;

42 #ifde‡
__˝lu•lus


50 
	#osù_¥oxy_auth‹iz©i⁄_öô
(
hódî
Ë
	`osù_auth‹iz©i⁄_öô
(hódî)

	)

56 
	#osù_¥oxy_auth‹iz©i⁄_∑r£
(
hódî
, 
hvÆue
Ë
	`osù_auth‹iz©i⁄_∑r£
(hódî, hvÆue)

	)

62 
	#osù_¥oxy_auth‹iz©i⁄_to_°r
(
hódî
, 
de°
Ë
	`osù_auth‹iz©i⁄_to_°r
(hódî, de°)

	)

67 
	#osù_¥oxy_auth‹iz©i⁄_‰ì
 
osù_auth‹iz©i⁄_‰ì


	)

73 
	#osù_¥oxy_auth‹iz©i⁄_˛⁄e
 
osù_auth‹iz©i⁄_˛⁄e


	)

79 
	#osù_¥oxy_auth‹iz©i⁄_gë_auth_ty≥
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_auth_ty≥
(hódî)

	)

85 
	#osù_¥oxy_auth‹iz©i⁄_£t_auth_ty≥
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_auth_ty≥
(hódî, vÆue)

	)

90 
	#osù_¥oxy_auth‹iz©i⁄_gë_u£∫ame
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_u£∫ame
(hódî)

	)

96 
	#osù_¥oxy_auth‹iz©i⁄_£t_u£∫ame
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_u£∫ame
(hódî, vÆue)

	)

101 
	#osù_¥oxy_auth‹iz©i⁄_gë_ªÆm
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_ªÆm
(hódî)

	)

107 
	#osù_¥oxy_auth‹iz©i⁄_£t_ªÆm
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_ªÆm
(hódî, vÆue)

	)

112 
	#osù_¥oxy_auth‹iz©i⁄_gë_n⁄˚
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_n⁄˚
(hódî)

	)

118 
	#osù_¥oxy_auth‹iz©i⁄_£t_n⁄˚
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_n⁄˚
(hódî, vÆue)

	)

123 
	#osù_¥oxy_auth‹iz©i⁄_gë_uri
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_uri
(hódî)

	)

129 
	#osù_¥oxy_auth‹iz©i⁄_£t_uri
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_uri
(hódî, vÆue)

	)

134 
	#osù_¥oxy_auth‹iz©i⁄_gë_ª•⁄£
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_ª•⁄£
(hódî)

	)

140 
	#osù_¥oxy_auth‹iz©i⁄_£t_ª•⁄£
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_ª•⁄£
(hódî, vÆue)

	)

145 
	#osù_¥oxy_auth‹iz©i⁄_gë_dige°
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_dige°
(hódî)

	)

151 
	#osù_¥oxy_auth‹iz©i⁄_£t_dige°
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_dige°
(hódî, vÆue)

	)

156 
	#osù_¥oxy_auth‹iz©i⁄_gë_Æg‹ôhm
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_Æg‹ôhm
(hódî)

	)

162 
	#osù_¥oxy_auth‹iz©i⁄_£t_Æg‹ôhm
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_Æg‹ôhm
(hódî, vÆue)

	)

167 
	#osù_¥oxy_auth‹iz©i⁄_gë_˙⁄˚
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_˙⁄˚
(hódî)

	)

173 
	#osù_¥oxy_auth‹iz©i⁄_£t_˙⁄˚
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_˙⁄˚
(hódî, vÆue)

	)

178 
	#osù_¥oxy_auth‹iz©i⁄_gë_›aque
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_›aque
(hódî)

	)

184 
	#osù_¥oxy_auth‹iz©i⁄_£t_›aque
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_›aque
(hódî, vÆue)

	)

189 
	#osù_¥oxy_auth‹iz©i⁄_gë_mesßge_q›
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_mesßge_q›
(hódî)

	)

195 
	#osù_¥oxy_auth‹iz©i⁄_£t_mesßge_q›
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_mesßge_q›
(hódî, vÆue)

	)

200 
	#osù_¥oxy_auth‹iz©i⁄_gë_n⁄˚_cou¡
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_n⁄˚_cou¡
(hódî)

	)

206 
	#osù_¥oxy_auth‹iz©i⁄_£t_n⁄˚_cou¡
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_n⁄˚_cou¡
(hódî, vÆue)

	)

211 
	#osù_¥oxy_auth‹iz©i⁄_gë_vîsi⁄
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_vîsi⁄
(hódî)

	)

217 
	#osù_¥oxy_auth‹iz©i⁄_£t_vîsi⁄
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_vîsi⁄
(hódî, vÆue)

	)

222 
	#osù_¥oxy_auth‹iz©i⁄_gë_èrgë«me
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_èrgë«me
(hódî)

	)

228 
	#osù_¥oxy_auth‹iz©i⁄_£t_èrgë«me
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_èrgë«me
(hódî, vÆue)

	)

233 
	#osù_¥oxy_auth‹iz©i⁄_gë_gsßpi_d©a
(
hódî
Ë
	`osù_auth‹iz©i⁄_gë_gsßpi_d©a
(hódî)

	)

239 
	#osù_¥oxy_auth‹iz©i⁄_£t_gsßpi_d©a
(
hódî
, 
vÆue
Ë
	`osù_auth‹iz©i⁄_£t_gsßpi_d©a
(hódî, vÆue)

	)

241 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_record_route.h

20 #i‚de‡
_OSIP_RECORD_ROUTE_H_


21 
	#_OSIP_RECORD_ROUTE_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_‰om.h
>

40 
osù_‰om_t
 
	tosù_ªc‹d_rouã_t
;

42 #ifde‡
__˝lu•lus


46 #i‚de‡
MINISIZE


51 
osù_ªc‹d_rouã_öô
(
osù_ªc‹d_rouã_t
 **
hódî
);

56 
osù_ªc‹d_rouã_‰ì
(
osù_ªc‹d_rouã_t
 *
hódî
);

62 
osù_ªc‹d_rouã_∑r£
(
osù_ªc‹d_rouã_t
 *
hódî
, c⁄° *
hvÆue
);

68 
osù_ªc‹d_rouã_to_°r
(c⁄° 
osù_ªc‹d_rouã_t
 *
hódî
, **
de°
);

74 
	#osù_ªc‹d_rouã_˛⁄e
 
osù_‰om_˛⁄e


	)

76 
	#osù_ªc‹d_rouã_öô
 
osù_‰om_öô


	)

77 
	#osù_ªc‹d_rouã_‰ì
 
osù_‰om_‰ì


	)

78 
	#osù_ªc‹d_rouã_∑r£
 
osù_‰om_∑r£


	)

79 
	#osù_ªc‹d_rouã_to_°r
 
osù_‰om_to_°r


	)

80 
	#osù_ªc‹d_rouã_˛⁄e
 
osù_‰om_˛⁄e


	)

87 
	#osù_ªc‹d_rouã_£t_uæ
(
hódî
, 
uæ
Ë
	`osù_‰om_£t_uæ
((
osù_‰om_t
 *Ëhódî, uæ)

	)

92 
	#osù_ªc‹d_rouã_gë_uæ
(
hódî
Ë
	`osù_‰om_gë_uæ
((
osù_‰om_t
 *Ëhódî)

	)

99 
	#osù_ªc‹d_rouã_∑øm_gë
(
hódî
, 
pos
, 
de°
Ë
	`osù_‰om_∑øm_gë
((
osù_‰om_t
 *Ëhódî,Öos, de°)

	)

106 
	#osù_ªc‹d_rouã_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

113 
	#osù_ªc‹d_rouã_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

115 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_route.h

20 #i‚de‡
_OSIP_RECORD_H_


21 
	#_OSIP_RECORD_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_‰om.h
>

40 
osù_‰om_t
 
	tosù_rouã_t
;

42 #ifde‡
__˝lu•lus


46 #i‚de‡
MINISIZE


51 
osù_rouã_öô
(
osù_rouã_t
 **
hódî
);

56 
osù_rouã_‰ì
(
osù_rouã_t
 *
hódî
);

62 
osù_rouã_∑r£
(
osù_rouã_t
 *
hódî
, c⁄° *
hvÆue
);

68 
osù_rouã_to_°r
(c⁄° 
osù_rouã_t
 *
hódî
, **
de°
);

74 
	#osù_rouã_˛⁄e
 
osù_‰om_˛⁄e


	)

76 
	#osù_rouã_öô
 
osù_‰om_öô


	)

77 
	#osù_rouã_‰ì
 
osù_‰om_‰ì


	)

78 
	#osù_rouã_∑r£
 
osù_‰om_∑r£


	)

79 
	#osù_rouã_to_°r
 
osù_‰om_to_°r


	)

80 
	#osù_rouã_˛⁄e
 
osù_‰om_˛⁄e


	)

87 
	#osù_rouã_£t_uæ
(
hódî
, 
uæ
Ë
	`osù_‰om_£t_uæ
((
osù_‰om_t
 *Ëhódî, uæ)

	)

92 
	#osù_rouã_gë_uæ
(
hódî
Ë
	`osù_‰om_gë_uæ
((
osù_‰om_t
 *Ëhódî)

	)

99 
	#osù_rouã_∑øm_gë
(
hódî
, 
pos
, 
de°
Ë
	`osù_‰om_∑øm_gë
((
osù_‰om_t
 *Ëhódî,Öos, de°)

	)

106 
	#osù_rouã_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

113 
	#osù_rouã_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

115 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_to.h

20 #i‚de‡
_OSIP_TO_H_


21 
	#_OSIP_TO_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_‰om.h
>

40 
osù_‰om_t
 
	tosù_to_t
;

42 #ifde‡
__˝lu•lus


46 #i‚de‡
MINISIZE


51 
osù_to_öô
(
osù_to_t
 **
hódî
);

56 
osù_to_‰ì
(
osù_to_t
 *
hódî
);

62 
osù_to_∑r£
(
osù_to_t
 *
hódî
, c⁄° *
hvÆue
);

68 
osù_to_to_°r
(c⁄° 
osù_to_t
 *
hódî
, **
de°
);

74 
osù_to_˛⁄e
(c⁄° 
osù_to_t
 *
hódî
, osù_to_à**
de°
);

81 
osù_to_èg_m©ch
(
osù_to_t
 *
to1
, osù_to_à*
to2
);

83 
	#osù_to_öô
 
osù_‰om_öô


	)

84 
	#osù_to_‰ì
 
osù_‰om_‰ì


	)

85 
	#osù_to_∑r£
 
osù_‰om_∑r£


	)

86 
	#osù_to_to_°r
 
osù_‰om_to_°r


	)

87 
	#osù_to_˛⁄e
 
osù_‰om_˛⁄e


	)

88 
	#osù_to_èg_m©ch
 
osù_‰om_èg_m©ch


	)

95 
	#osù_to_£t_di•œy«me
(
hódî
, 
vÆue
Ë
	`osù_‰om_£t_di•œy«me
((
osù_‰om_t
 *Ëhódî, vÆue)

	)

100 
	#osù_to_gë_di•œy«me
(
hódî
Ë
	`osù_‰om_gë_di•œy«me
((
osù_‰om_t
 *Ëhódî)

	)

106 
	#osù_to_£t_uæ
(
hódî
, 
uæ
Ë
	`osù_‰om_£t_uæ
((
osù_‰om_t
 *Ëhódî, uæ)

	)

111 
	#osù_to_gë_uæ
(
hódî
Ë
	`osù_‰om_gë_uæ
((
osù_‰om_t
 *Ëhódî)

	)

118 
	#osù_to_∑øm_gë
(
hódî
, 
pos
, 
de°
Ë
	`osù_‰om_∑øm_gë
((
osù_‰om_t
 *Ëhódî,Öos, de°)

	)

125 
	#osù_to_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
),Çame, de°)

	)

132 
	#osù_to_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
),Çame, vÆue)

	)

139 
	#osù_to_£t_èg
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
gí_∑øms
), 
	`osù_°rdup
("èg"), vÆue)

	)

145 
	#osù_to_gë_èg
(
hódî
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
gí_∑øms
), "èg", de°)

	)

147 #i‚de‡
DOXYGEN


149 
	#osù_to_com∑ª
(
hódî1
, 
hódî2
Ë
	`osù_‰om_com∑ª
((
osù_‰om_t
 *Ëhódî1, (osù_‰om_à*Ëhódî2)

	)

152 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_via.h

20 #i‚de‡
_OSIP_VIA_H_


21 
	#_OSIP_VIA_H_


	)

23 
	~<osù∑r£r2/osù_li°.h
>

40 
osù_vü
 
	tosù_vü_t
;

46 
	sosù_vü
 {

47 *
	mvîsi⁄
;

48 *
	m¥Ÿocﬁ
;

49 *
	mho°
;

50 *
	mp‹t
;

51 *
	mcommít
;

52 
osù_li°_t
 
	mvü_∑øms
;

55 #ifde‡
__˝lu•lus


63 
osù_vü_öô
(
osù_vü_t
 **
hódî
);

68 
osù_vü_‰ì
(
osù_vü_t
 *
hódî
);

74 
osù_vü_∑r£
(
osù_vü_t
 *
hódî
, c⁄° *
hvÆue
);

80 
osù_vü_to_°r
(c⁄° 
osù_vü_t
 *
hódî
, **
de°
);

86 
osù_vü_˛⁄e
(c⁄° 
osù_vü_t
 *
hódî
, osù_vü_à**
de°
);

92 
vü_£t_vîsi⁄
(
osù_vü_t
 *
hódî
, *
vÆue
);

93 
	#osù_vü_£t_vîsi⁄
 
vü_£t_vîsi⁄


	)

98 *
vü_gë_vîsi⁄
(
osù_vü_t
 *
hódî
);

99 
	#osù_vü_gë_vîsi⁄
 
vü_gë_vîsi⁄


	)

105 
vü_£t_¥Ÿocﬁ
(
osù_vü_t
 *
hódî
, *
vÆue
);

106 
	#osù_vü_£t_¥Ÿocﬁ
 
vü_£t_¥Ÿocﬁ


	)

111 *
vü_gë_¥Ÿocﬁ
(
osù_vü_t
 *
hódî
);

112 
	#osù_vü_gë_¥Ÿocﬁ
 
vü_gë_¥Ÿocﬁ


	)

118 
vü_£t_ho°
(
osù_vü_t
 *
hódî
, *
vÆue
);

119 
	#osù_vü_£t_ho°
 
vü_£t_ho°


	)

124 *
vü_gë_ho°
(
osù_vü_t
 *
hódî
);

125 
	#osù_vü_gë_ho°
 
vü_gë_ho°


	)

131 
vü_£t_p‹t
(
osù_vü_t
 *
hódî
, *
vÆue
);

132 
	#osù_vü_£t_p‹t
 
vü_£t_p‹t


	)

137 *
vü_gë_p‹t
(
osù_vü_t
 *
hódî
);

138 
	#osù_vü_gë_p‹t
 
vü_gë_p‹t


	)

144 
vü_£t_commít
(
osù_vü_t
 *
hódî
, *
vÆue
);

145 
	#osù_vü_£t_commít
 
vü_£t_commít


	)

150 *
vü_gë_commít
(
osù_vü_t
 *
hódî
);

151 
	#osù_vü_gë_commít
 
vü_gë_commít


	)

157 
	#osù_vü_£t_hiddí
(
hódî
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
), 
	`osù_°rdup
("hiddí"), 
NULL
)

	)

163 
	#osù_vü_£t_âl
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
), 
	`osù_°rdup
("âl"), vÆue)

	)

169 
	#osù_vü_£t_maddr
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
), 
	`osù_°rdup
("maddr"), vÆue)

	)

175 
	#osù_vü_£t_ª˚ived
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
), 
	`osù_°rdup
("ª˚ived"), vÆue)

	)

181 
	#osù_vü_£t_bønch
(
hódî
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
), 
	`osù_°rdup
("bønch"), vÆue)

	)

189 
	#osù_vü_∑øm_add
(
hódî
, 
«me
, 
vÆue
Ë
	`osù_gíîic_∑øm_add
((&(hódî)->
vü_∑øms
),Çame, vÆue)

	)

196 
	#osù_vü_∑øm_gë_by«me
(
hódî
, 
«me
, 
de°
Ë
	`osù_gíîic_∑øm_gë_by«me
((&(hódî)->
vü_∑øms
),Çame, de°)

	)

204 
osù_vü_m©ch
(
osù_vü_t
 *
vü1
, osù_vü_à*
vü2
);

206 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_www_authenticate.h

20 #i‚de‡
_OSIP_WWW_AUTHENTICATE_H_


21 
	#_OSIP_WWW_AUTHENTICATE_H_


	)

38 
osù_www_authítiˇã
 
	tosù_www_authítiˇã_t
;

44 
	sosù_www_authítiˇã
 {

45 *
	mauth_ty≥
;

46 *
	mªÆm
;

47 *
	mdomaö
;

48 *
	mn⁄˚
;

49 *
	m›aque
;

50 *
	m°Æe
;

51 *
	mÆg‹ôhm
;

52 *
	mq›_›ti⁄s
;

53 *
	mvîsi⁄
;

54 *
	mèrgë«me
;

55 *
	mgsßpi_d©a
;

56 *
	mauth_∑øm
;

59 #ifde‡
__˝lu•lus


67 
osù_www_authítiˇã_öô
(
osù_www_authítiˇã_t
 **
hódî
);

73 
osù_www_authítiˇã_∑r£
(
osù_www_authítiˇã_t
 *
hódî
, c⁄° *
hvÆue
);

79 
osù_www_authítiˇã_to_°r
(c⁄° 
osù_www_authítiˇã_t
 *
hódî
, **
de°
);

84 
osù_www_authítiˇã_‰ì
(
osù_www_authítiˇã_t
 *
hódî
);

90 
osù_www_authítiˇã_˛⁄e
(c⁄° 
osù_www_authítiˇã_t
 *
hódî
, osù_www_authítiˇã_à**
de°
);

96 *
osù_www_authítiˇã_gë_auth_ty≥
(
osù_www_authítiˇã_t
 *
hódî
);

102 
osù_www_authítiˇã_£t_auth_ty≥
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

107 *
osù_www_authítiˇã_gë_ªÆm
(
osù_www_authítiˇã_t
 *
hódî
);

113 
osù_www_authítiˇã_£t_ªÆm
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

118 *
osù_www_authítiˇã_gë_domaö
(
osù_www_authítiˇã_t
 *
hódî
);

124 
osù_www_authítiˇã_£t_domaö
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

129 *
osù_www_authítiˇã_gë_n⁄˚
(
osù_www_authítiˇã_t
 *
hódî
);

135 
osù_www_authítiˇã_£t_n⁄˚
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

140 *
osù_www_authítiˇã_gë_›aque
(
osù_www_authítiˇã_t
 *
hódî
);

146 
osù_www_authítiˇã_£t_›aque
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

151 *
osù_www_authítiˇã_gë_°Æe
(
osù_www_authítiˇã_t
 *
hódî
);

157 
osù_www_authítiˇã_£t_°Æe
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

162 
	#osù_www_authítiˇã_£t_°Æe_åue
(
hódî
Ë
	`osù_www_authítiˇã_£t_°Æe
(hódî, 
	`osù_°rdup
("åue"))

	)

167 
	#osù_www_authítiˇã_£t_°Æe_Ál£
(
hódî
Ë
	`osù_www_authítiˇã_£t_°Æe
(hódî, 
	`osù_°rdup
("Ál£"))

	)

172 *
osù_www_authítiˇã_gë_Æg‹ôhm
(
osù_www_authítiˇã_t
 *
hódî
);

178 
osù_www_authítiˇã_£t_Æg‹ôhm
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

183 
	#osù_www_authítiˇã_£t_Æg‹ôhm_MD5
(
hódî
Ë
	`osù_www_authítiˇã_£t_Æg‹ôhm
(hódî, 
	`osù_°rdup
("MD5"))

	)

188 *
osù_www_authítiˇã_gë_q›_›ti⁄s
(
osù_www_authítiˇã_t
 *
hódî
);

194 
osù_www_authítiˇã_£t_q›_›ti⁄s
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

199 *
osù_www_authítiˇã_gë_vîsi⁄
(
osù_www_authítiˇã_t
 *
hódî
);

205 
osù_www_authítiˇã_£t_vîsi⁄
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

210 *
osù_www_authítiˇã_gë_èrgë«me
(
osù_www_authítiˇã_t
 *
hódî
);

216 
osù_www_authítiˇã_£t_èrgë«me
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

221 *
osù_www_authítiˇã_gë_gsßpi_d©a
(
osù_www_authítiˇã_t
 *
hódî
);

227 
osù_www_authítiˇã_£t_gsßpi_d©a
(
osù_www_authítiˇã_t
 *
hódî
, *
vÆue
);

229 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/internal.h

20 #i‚de‡
_INTERNALOSIPPARSER_H_


21 
	#_INTERNALOSIPPARSER_H_


	)

23 #i‡
deföed
(
HAVE_CONFIG_H
)

24 
	~<osù-c⁄fig.h
>

27 #i‡
deföed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

28 
	#HAVE_CTYPE_H
 1

	)

29 
	#HAVE_STRING_H
 1

	)

30 
	#HAVE_SYS_TYPES_H
 1

	)

31 
	#HAVE_TIME_H
 1

	)

32 
	#HAVE_STDARG_H
 1

	)

34 #ñi‡
deföed
(
__VXWORKS_OS__
Ë|| deföed(
__πems__
)

35 
	#HAVE_STRING_H
 1

	)

36 
	#HAVE_TIME_H
 1

	)

37 
	#HAVE_SYS_TIME_H
 1

	)

38 
	#HAVE_SYS_TYPES_H
 1

	)

39 
	#HAVE_STDARG_H
 1

	)

41 #ñi‡
deföed
 
_WIN32_WCE


43 
	#HAVE_CTYPE_H
 1

	)

44 
	#HAVE_STRING_H
 1

	)

45 
	#HAVE_TIME_H
 1

	)

46 
	#HAVE_STDARG_H
 1

	)

48 
	#¢¥ötf
 
_¢¥ötf


	)

49 
	#v¢¥ötf
 
_v¢¥ötf


	)

50 #ñi‡
deföed
(
WIN32
)

52 
	#HAVE_CTYPE_H
 1

	)

53 
	#HAVE_STRING_H
 1

	)

54 
	#HAVE_SYS_TYPES_H
 1

	)

55 
	#HAVE_TIME_H
 1

	)

56 
	#HAVE_STDARG_H
 1

	)

58 
	#HAVE_LOCALTIME
 1

	)

60 #i‡(
_MSC_VER
 < 1900)

61 
	#¢¥ötf
 
_¢¥ötf


	)

62 
	#v¢¥ötf
 
_v¢¥ötf


	)

64 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

65 
	~<wö≠iÁmûy.h
>

70 #i‡
_MSC_VER
 >= 1300

71 
	#WIN32_USE_CRYPTO
 1

	)

72 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

73 #i‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

74 #unde‡
WIN32_USE_CRYPTO


75 #ñi‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PC_APP
)

76 #unde‡
WIN32_USE_CRYPTO


83 #i‡
deföed
(
HAVE_STRING_H
)

84 
	~<°rög.h
>

85 #ñi‡
deföed
(
HAVE_STRINGS_H
)

86 
	~<°rögs.h
>

88 
	~<°rög.h
>

91 
	~<°dio.h
>

92 
	~<°dlib.h
>

94 #i‡
deföed
(
HAVE_SYS_TYPES_H
)

95 
	~<sys/ty≥s.h
>

98 #ifde‡
HAVE_TIME_H


99 
	~<time.h
>

102 #i‡
deföed
(
HAVE_SYS_TIME_H
)

103 
	~<sys/time.h
>

106 #i‡
deföed
(
__¨c__
)

107 
	~"ö˛udes_≠i.h
"

108 
	~"os_cfg_pub.h
"

109 
	~<posix_time_pub.h
>

112 #ifde‡
__PSOS__


113 
	#VA_START
(
a
, 
f
Ë
	`va_°¨t
◊, f)

	)

114 
	~"≤a.h
"

115 
	~"°dlib.h
"

116 
	~"time.h
"

117 
	#timîcmp
(
tvp
, 
uvp
, 
cmp
Ë(—vp)->
tv_£c
 
	`cmp
(uvp)->tv_£¯|| (tvp)->tv_£¯=(uvp)->tv_£¯&& (tvp)->
tv_u£c
 cmp(uvp)->tv_u£c)

	)

118 
	#¢¥ötf
 
osù_¢¥ötf


	)

119 #i‚de‡
INT_MAX


120 
	#INT_MAX
 0x7FFFFFFF

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_body.h

20 #i‚de‡
_OSIP_BODY_H_


21 
	#_OSIP_BODY_H_


	)

23 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_ty≥.h
>

41 
osù_body
 
	tosù_body_t
;

47 
	sosù_body
 {

48 *
	mbody
;

49 
size_t
 
	mÀngth
;

50 
osù_li°_t
 *
	mhódîs
;

51 
osù_c⁄ã¡_ty≥_t
 *
	mc⁄ã¡_ty≥
;

55 #ifde‡
__˝lu•lus


63 
osù_body_öô
(
osù_body_t
 **
body
);

68 
osù_body_‰ì
(
osù_body_t
 *
body
);

75 
osù_body_∑r£
(
osù_body_t
 *
body
, c⁄° *
buf
, 
size_t
 
Àngth
);

81 
osù_body_˛⁄e
(c⁄° 
osù_body_t
 *
body
, osù_body_à**
de°
);

88 
osù_body_∑r£_mime
(
osù_body_t
 *
body
, c⁄° *
buf
, 
size_t
 
Àngth
);

95 
osù_body_to_°r
(c⁄° 
osù_body_t
 *
body
, **
de°
, 
size_t
 *
Àngth
);

102 
osù_body_£t_c⁄ã¡ty≥
(
osù_body_t
 *
body
, c⁄° *
hvÆue
);

110 
osù_body_£t_hódî
(
osù_body_t
 *
body
, c⁄° *
h«me
, c⁄° *
hvÆue
);

112 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_const.h

20 #i‚de‡
_OSIP_CONST_H_


21 
	#_OSIP_CONST_H_


	)

23 #ifde‡
ENABLE_MPATROL


24 
	~<m∑åﬁ.h
>

27 
	#OSIP_CRLF
 "\r\n\0"

	)

28 
	#OSIP_CR
 "\r\0"

	)

29 
	#OSIP_LF
 "\n\0"

	)

30 
	#OSIP_SP
 " \0"

	)

32 
	#ACCEPT
 "ac˚±"

	)

33 
	#ACCEPT_ENCODING
 "ac˚±-ícodög"

	)

34 
	#ACCEPT_LANGUAGE
 "ac˚±-œnguage"

	)

35 
	#ALERT_INFO
 "Æît-öfo"

	)

36 
	#ALLOW
 "Ælow"

	)

37 
	#AUTHENTICATION_INFO
 "authítiˇti⁄-öfo"

	)

38 
	#AUTHORIZATION
 "auth‹iz©i⁄"

	)

39 
	#CALL_ID
 "ˇŒ-id"

	)

40 
	#CALL_ID_SHORT
 "i"

	)

41 
	#CALL_INFO
 "ˇŒ-öfo"

	)

42 
	#CONTACT
 "c⁄è˘"

	)

43 
	#CONTACT_SHORT
 "m"

	)

44 
	#CONTENT_DISPOSITION
 "c⁄ã¡-di•osôi⁄"

	)

45 
	#CONTENT_ENCODING_SHORT
 "e"

	)

46 
	#CONTENT_ENCODING
 "c⁄ã¡-ícodög"

	)

47 
	#CONTENT_LANGUAGE
 "c⁄ã¡-œnguage"

	)

48 
	#CONTENT_LENGTH_SHORT
 "l"

	)

49 
	#CONTENT_LENGTH
 "c⁄ã¡-Àngth"

	)

50 
	#CONTENT_TYPE_SHORT
 "c"

	)

51 
	#CONTENT_TYPE
 "c⁄ã¡-ty≥"

	)

52 
	#CSEQ
 "c£q"

	)

53 
	#SIPDATE
 "d©e"

	)

54 
	#ERROR_INFO
 "îr‹-öfo"

	)

55 
	#EXPIRES
 "expúes"

	)

56 
	#FROM
 "‰om"

	)

57 
	#FROM_SHORT
 "f"

	)

58 
	#IN_REPLY_TO
 "ö-ª∂y-to"

	)

59 
	#MAX_FORWARDS
 "max-f‹w¨ds"

	)

60 
	#MIME_VERSION
 "mime-vîsi⁄"

	)

61 
	#MIN_EXPIRES
 "mö-expúes"

	)

62 
	#ORGANIZATION
 "‹g™iz©i⁄"

	)

63 
	#PRIORITY
 "¥i‹ôy"

	)

64 
	#PROXY_AUTHENTICATE
 "¥oxy-authítiˇã"

	)

65 
	#PROXY_AUTHENTICATION_INFO
 "¥oxy-authítiˇti⁄-öfo"

	)

66 
	#PROXY_AUTHORIZATION
 "¥oxy-auth‹iz©i⁄"

	)

67 
	#PROXY_REQUIRE
 "¥oxy-ªquúe"

	)

68 
	#RECORD_ROUTE
 "ªc‹d-rouã"

	)

69 
	#REPLY_TO
 "ª∂y-to"

	)

70 
	#REQUIRE
 "ªquúe"

	)

71 
	#RETRY_AFTER
 "ªåy-a·î"

	)

72 
	#ROUTE
 "rouã"

	)

73 
	#SERVER
 "£rvî"

	)

74 
	#SUBJECT
 "subje˘"

	)

75 
	#SUBJECT_SHORT
 "s"

	)

76 
	#SUPPORTED
 "suµ‹ãd"

	)

77 
	#TIMESTAMP
 "time°amp"

	)

78 
	#TO
 "to"

	)

79 
	#TO_SHORT
 "t"

	)

80 
	#UNSUPPORTED
 "unsuµ‹ãd"

	)

81 
	#USER_AGENT
 "u£r-agít"

	)

82 
	#VIA
 "vü"

	)

83 
	#VIA_SHORT
 "v"

	)

84 
	#WARNING
 "w¨nög"

	)

85 
	#WWW_AUTHENTICATE
 "www-authítiˇã"

	)

87 
	#RESPONSE_CODES
 51

	)

89 
	#SIP_TRYING
 100

	)

90 
	#SIP_RINGING
 180

	)

91 
	#SIP_CALL_IS_BEING_FORWARDED
 181

	)

92 
	#SIP_QUEUED
 182

	)

93 
	#SIP_SESSION_PROGRESS
 183

	)

94 
	#SIP_OK
 200

	)

95 
	#SIP_ACCEPTED
 202

	)

96 
	#SIP_MULTIPLE_CHOICES
 300

	)

97 
	#SIP_MOVED_PERMANENTLY
 301

	)

98 
	#SIP_MOVED_TEMPORARILY
 302

	)

99 
	#SIP_USE_PROXY
 305

	)

100 
	#SIP_ALTERNATIVE_SERVICE
 380

	)

101 
	#SIP_BAD_REQUEST
 400

	)

102 
	#SIP_UNAUTHORIZED
 401

	)

103 
	#SIP_PAYMENT_REQUIRED
 402

	)

104 
	#SIP_FORBIDDEN
 403

	)

105 
	#SIP_NOT_FOUND
 404

	)

106 
	#SIP_METHOD_NOT_ALLOWED
 405

	)

107 
	#SIP_406_NOT_ACCEPTABLE
 406

	)

108 
	#SIP_PROXY_AUTHENTICATION_REQUIRED
 407

	)

109 
	#SIP_REQUEST_TIME_OUT
 408

	)

110 
	#SIP_GONE
 410

	)

111 
	#SIP_REQUEST_ENTITY_TOO_LARGE
 413

	)

112 
	#SIP_REQUEST_URI_TOO_LARGE
 414

	)

113 
	#SIP_UNSUPPORTED_MEDIA_TYPE
 415

	)

114 
	#SIP_UNSUPPORTED_URI_SCHEME
 416

	)

115 
	#SIP_BAD_EXTENSION
 420

	)

116 
	#SIP_EXTENSION_REQUIRED
 421

	)

117 
	#SIP_INTERVAL_TOO_BRIEF
 423

	)

118 
	#SIP_TEMPORARILY_UNAVAILABLE
 480

	)

119 
	#SIP_CALL_TRANSACTION_DOES_NOT_EXIST
 481

	)

120 
	#SIP_LOOP_DETECTED
 482

	)

121 
	#SIP_TOO_MANY_HOPS
 483

	)

122 
	#SIP_ADDRESS_INCOMPLETE
 484

	)

123 
	#SIP_AMBIGUOUS
 485

	)

124 
	#SIP_BUSY_HERE
 486

	)

125 
	#SIP_REQUEST_TERMINATED
 487

	)

126 
	#SIP_NOT_ACCEPTABLE_HERE
 488

	)

127 
	#SIP_BAD_EVENT
 489

	)

128 
	#SIP_REQUEST_PENDING
 491

	)

129 
	#SIP_UNDECIPHERABLE
 493

	)

130 
	#SIP_INTERNAL_SERVER_ERROR
 500

	)

131 
	#SIP_NOT_IMPLEMENTED
 501

	)

132 
	#SIP_BAD_GATEWAY
 502

	)

133 
	#SIP_SERVICE_UNAVAILABLE
 503

	)

134 
	#SIP_SERVER_TIME_OUT
 504

	)

135 
	#SIP_VERSION_NOT_SUPPORTED
 505

	)

136 
	#SIP_MESSAGE_TOO_LARGE
 513

	)

137 
	#SIP_BUSY_EVRYWHERE
 600

	)

138 
	#SIP_DECLINE
 603

	)

139 
	#SIP_DOES_NOT_EXIST_ANYWHERE
 604

	)

140 
	#SIP_606_NOT_ACCEPTABLE
 606

	)

143 
	#OSIP_IS_SIP_INFO
(
x
Ë(((xË>100Ë&& ((xË< 200))

	)

145 
	#OSIP_IS_SIP_SUCCESS
(
x
Ë(((xË>200Ë&& ((xË< 300))

	)

147 
	#OSIP_IS_SIP_REDIRECT
(
x
Ë(((xË>300Ë&& ((xË< 400))

	)

149 
	#OSIP_IS_SIP_ERROR
(
x
Ë(((xË>400Ë&& ((xË< 600))

	)

151 
	#OSIP_IS_SIP_CLIENT_ERROR
(
x
Ë(((xË>400Ë&& ((xË< 500))

	)

153 
	#OSIP_IS_SIP_SERVER_ERROR
(
x
Ë(((xË>500Ë&& ((xË< 600))

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_headers.h

20 #i‚de‡
_OSIP_HEADERS_H_


21 
	#_OSIP_HEADERS_H_


	)

23 
	~<osù∑r£r2/osù_p‹t.h
>

24 
	~<osù∑r£r2/osù_c⁄°.h
>

25 
	~<osù∑r£r2/osù_uri.h
>

27 
	~<osù∑r£r2/hódîs/osù_hódî.h
>

28 
	~<osù∑r£r2/hódîs/osù_ac˚±.h
>

29 
	~<osù∑r£r2/hódîs/osù_ac˚±_ícodög.h
>

30 
	~<osù∑r£r2/hódîs/osù_ac˚±_œnguage.h
>

31 
	~<osù∑r£r2/hódîs/osù_Æît_öfo.h
>

32 
	~<osù∑r£r2/hódîs/osù_Ælow.h
>

33 
	~<osù∑r£r2/hódîs/osù_authítiˇti⁄_öfo.h
>

34 
	~<osù∑r£r2/hódîs/osù_auth‹iz©i⁄.h
>

35 
	~<osù∑r£r2/hódîs/osù_ˇŒ_id.h
>

36 
	~<osù∑r£r2/hódîs/osù_ˇŒ_öfo.h
>

37 
	~<osù∑r£r2/hódîs/osù_c⁄è˘.h
>

38 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_di•osôi⁄.h
>

39 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_ícodög.h
>

40 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_Àngth.h
>

41 
	~<osù∑r£r2/hódîs/osù_c⁄ã¡_ty≥.h
>

42 
	~<osù∑r£r2/hódîs/osù_c£q.h
>

43 
	~<osù∑r£r2/hódîs/osù_îr‹_öfo.h
>

44 
	~<osù∑r£r2/hódîs/osù_‰om.h
>

45 
	~<osù∑r£r2/hódîs/osù_mime_vîsi⁄.h
>

46 
	~<osù∑r£r2/hódîs/osù_¥oxy_authítiˇã.h
>

47 
	~<osù∑r£r2/hódîs/osù_¥oxy_authítiˇti⁄_öfo.h
>

48 
	~<osù∑r£r2/hódîs/osù_¥oxy_auth‹iz©i⁄.h
>

49 
	~<osù∑r£r2/hódîs/osù_ªc‹d_rouã.h
>

50 
	~<osù∑r£r2/hódîs/osù_rouã.h
>

51 
	~<osù∑r£r2/hódîs/osù_to.h
>

52 
	~<osù∑r£r2/hódîs/osù_vü.h
>

53 
	~<osù∑r£r2/hódîs/osù_www_authítiˇã.h
>

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_list.h

20 #i‚de‡
_LIST_H_


21 
	#_LIST_H_


	)

23 #ifde‡
ENABLE_MPATROL


24 
	~<m∑åﬁ.h
>

39 #ifde‡
__˝lu•lus


43 #i‚de‡
DOXYGEN


48 
__node
 
	t__node_t
;

54 
	s__node
 {

55 
__node_t
 *
	m√xt
;

56 *
	mñemít
;

64 
osù_li°
 
	tosù_li°_t
;

70 
osù_li°_ôî©‹
 
	tosù_li°_ôî©‹_t
;

76 
	sosù_li°_ôî©‹
 {

77 
__node_t
 *
	ga˘uÆ
;

78 
__node_t
 **
	g¥ev
;

79 
osù_li°_t
 *
	gli
;

80 
	gpos
;

87 
	sosù_li°
 {

88 
	gnb_ñt
;

89 
__node_t
 *
	gnode
;

101 
osù_li°_öô
(
osù_li°_t
 *
li
);

108 
osù_li°_•ecül_‰ì
(
osù_li°_t
 *
li
, (*
‰ì_func
)(*));

116 
osù_li°_˛⁄e
(c⁄° 
osù_li°_t
 *
§c
, osù_li°_à*
d°
, (*
˛⁄e_func
)(*, **));

121 
osù_li°_ofch¨_‰ì
(
osù_li°_t
 *
li
);

126 
osù_li°_size
(c⁄° 
osù_li°_t
 *
li
);

132 
osù_li°_eﬁ
(c⁄° 
osù_li°_t
 *
li
, 
pos
);

139 
osù_li°_add
(
osù_li°_t
 *
li
, *
ñemít
, 
pos
);

145 *
osù_li°_gë
(c⁄° 
osù_li°_t
 *
li
, 
pos
);

151 
osù_li°_ªmove
(
osù_li°_t
 *
li
, 
pos
);

157 
	#osù_li°_ôî©‹_has_ñem
(
ô
Ë(0 !(ô).
a˘uÆ
 && (ô).
pos
 < (ô).
li
->
nb_ñt
)

	)

163 *
osù_li°_gë_fú°
(c⁄° 
osù_li°_t
 *
li
, 
osù_li°_ôî©‹_t
 *
ô
);

168 *
osù_li°_gë_√xt
(
osù_li°_ôî©‹_t
 *
ô
);

173 *
osù_li°_ôî©‹_ªmove
(
osù_li°_ôî©‹_t
 *
ô
);

175 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_md5.h

26 #i‚de‡
_MD5_H_


27 
	#_MD5_H_


	)

29 #i‚de‡
DOXYGEN


31 #ifde‡
__˝lu•lus


36 
	#PROTOTYPES
 1

	)

38 #i‚de‡
PROTOTYPES


39 
	#PROTOTYPES
 0

	)

43 *
	tPOINTER
;

46 
	tUINT2
;

49 
	tUINT4
;

55 #i‡
PROTOTYPES


56 
	#PROTO_LIST
(
li°
Ë
	)
list

58 
	#PROTO_LIST
(
li°
Ë()

	)

66 
UINT4
 
°©e
[4];

67 
UINT4
 
cou¡
[2];

68 
buf„r
[64];

69 } 
	tosù_MD5_CTX
;

71 
osù_MD5Inô
 
PROTO_LIST
((
osù_MD5_CTX
 *) );

72 
osù_MD5Upd©e
 
PROTO_LIST
((
osù_MD5_CTX
 *, *, ) );

73 
osù_MD5FöÆ
 
PROTO_LIST
(([16], 
osù_MD5_CTX
 *) );

75 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_message.h

20 #i‚de‡
_OSIP_MESSAGE_H_


21 
	#_OSIP_MESSAGE_H_


	)

23 
	~<osù∑r£r2/osù_c⁄°.h
>

24 
	~<osù∑r£r2/osù_hódîs.h
>

25 
	~<osù∑r£r2/osù_body.h
>

40 #ifde‡
__˝lu•lus


48 
osù_mesßge
 
	tosù_mesßge_t
;

54 
	sosù_mesßge
 {

55 *
sù_vîsi⁄
;

56 
osù_uri_t
 *
ªq_uri
;

57 *
sù_mëhod
;

59 
°©us_code
;

60 *
ªas⁄_phø£
;

62 #i‚de‡
MINISIZE


63 
osù_li°_t
 
ac˚±s
;

64 
osù_li°_t
 
ac˚±_ícodögs
;

65 
osù_li°_t
 
ac˚±_œnguages
;

66 
osù_li°_t
 
Æît_öfos
;

67 
osù_li°_t
 
Ælows
;

68 
osù_li°_t
 
authítiˇti⁄_öfos
;

70 
osù_li°_t
 
auth‹iz©i⁄s
;

71 
osù_ˇŒ_id_t
 *
ˇŒ_id
;

72 
osù_li°_t
 
ˇŒ_öfos
;

73 
osù_li°_t
 
c⁄è˘s
;

74 #i‚de‡
MINISIZE


75 
osù_li°_t
 
c⁄ã¡_ícodögs
;

77 
osù_c⁄ã¡_Àngth_t
 *
c⁄ã¡_Àngth
;

78 
osù_c⁄ã¡_ty≥_t
 *
c⁄ã¡_ty≥
;

79 
osù_c£q_t
 *
c£q
;

80 #i‚de‡
MINISIZE


81 
osù_li°_t
 
îr‹_öfos
;

83 
osù_‰om_t
 *
‰om
;

84 
osù_mime_vîsi⁄_t
 *
mime_vîsi⁄
;

85 
osù_li°_t
 
¥oxy_authítiˇãs
;

86 #i‚de‡
MINISIZE


87 
osù_li°_t
 
¥oxy_authítiˇti⁄_öfos
;

89 
osù_li°_t
 
¥oxy_auth‹iz©i⁄s
;

90 
osù_li°_t
 
ªc‹d_rouãs
;

91 
osù_li°_t
 
rouãs
;

92 
osù_to_t
 *
to
;

93 
osù_li°_t
 
vüs
;

94 
osù_li°_t
 
www_authítiˇãs
;

96 
osù_li°_t
 
hódîs
;

98 
osù_li°_t
 
bodõs
;

104 
mesßge_¥›îty
;

105 *
mesßge
;

106 
size_t
 
mesßge_Àngth
;

108 *
≠∂iˇti⁄_d©a
;

111 #i‚de‡
SIP_MESSAGE_MAX_LENGTH


115 
	#SIP_MESSAGE_MAX_LENGTH
 8000

	)

118 #i‚de‡
BODY_MESSAGE_MAX_SIZE


122 
	#BODY_MESSAGE_MAX_SIZE
 4000

	)

129 
osù_mesßge_öô
(
osù_mesßge_t
 **
sù
);

134 
osù_mesßge_‰ì
(
osù_mesßge_t
 *
sù
);

141 
osù_mesßge_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
);

148 
osù_mesßge_∑r£_sù‰ag
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
);

157 
osù_mesßge_to_°r
(
osù_mesßge_t
 *
sù
, **
de°
, 
size_t
 *
mesßge_Àngth
);

167 
osù_mesßge_to_°r_sù‰ag
(
osù_mesßge_t
 *
sù
, **
de°
, 
size_t
 *
mesßge_Àngth
);

173 
osù_mesßge_˛⁄e
(c⁄° 
osù_mesßge_t
 *
sù
, osù_mesßge_à**
de°
);

180 
osù_mesßge_£t_ªas⁄_phø£
(
osù_mesßge_t
 *
sù
, *
ªas⁄
);

185 *
osù_mesßge_gë_ªas⁄_phø£
(c⁄° 
osù_mesßge_t
 *
sù
);

191 
osù_mesßge_£t_°©us_code
(
osù_mesßge_t
 *
sù
, 
°©uscode
);

196 
osù_mesßge_gë_°©us_code
(c⁄° 
osù_mesßge_t
 *
sù
);

202 
osù_mesßge_£t_mëhod
(
osù_mesßge_t
 *
sù
, *
mëhod
);

207 *
osù_mesßge_gë_mëhod
(c⁄° 
osù_mesßge_t
 *
sù
);

213 
osù_mesßge_£t_vîsi⁄
(
osù_mesßge_t
 *
sù
, *
vîsi⁄
);

218 *
osù_mesßge_gë_vîsi⁄
(c⁄° 
osù_mesßge_t
 *
sù
);

224 
osù_mesßge_£t_uri
(
osù_mesßge_t
 *
sù
, 
osù_uri_t
 *
uri
);

229 
osù_uri_t
 *
osù_mesßge_gë_uri
(c⁄° 
osù_mesßge_t
 *
sù
);

238 
	#MSG_IS_RESPONSE
(
msg
Ë((msg)->
°©us_code
 !0)

	)

243 
	#MSG_IS_REQUEST
(
msg
Ë((msg)->
°©us_code
 =0)

	)

249 
	#MSG_IS_INVITE
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "INVITE"))

	)

254 
	#MSG_IS_ACK
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "ACK"))

	)

259 
	#MSG_IS_REGISTER
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "REGISTER"))

	)

264 
	#MSG_IS_BYE
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "BYE"))

	)

269 
	#MSG_IS_OPTIONS
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "OPTIONS"))

	)

274 
	#MSG_IS_INFO
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "INFO"))

	)

279 
	#MSG_IS_CANCEL
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "CANCEL"))

	)

284 
	#MSG_IS_REFER
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "REFER"))

	)

289 
	#MSG_IS_NOTIFY
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "NOTIFY"))

	)

295 
	#MSG_IS_SUBSCRIBE
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "SUBSCRIBE"))

	)

300 
	#MSG_IS_MESSAGE
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "MESSAGE"))

	)

305 
	#MSG_IS_PRACK
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "PRACK"))

	)

311 
	#MSG_IS_UPDATE
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "UPDATE"))

	)

317 
	#MSG_IS_PUBLISH
(
msg
Ë(
	`MSG_IS_REQUEST
(msgË&& 0 =
	`°rcmp
((msg)->
sù_mëhod
, "PUBLISH"))

	)

323 
	#MSG_IS_STATUS_1XX
(
msg
Ë((msg)->
°©us_code
 >100 && (msg)->°©us_codê< 200)

	)

328 
	#MSG_IS_STATUS_2XX
(
msg
Ë((msg)->
°©us_code
 >200 && (msg)->°©us_codê< 300)

	)

333 
	#MSG_IS_STATUS_3XX
(
msg
Ë((msg)->
°©us_code
 >300 && (msg)->°©us_codê< 400)

	)

338 
	#MSG_IS_STATUS_4XX
(
msg
Ë((msg)->
°©us_code
 >400 && (msg)->°©us_codê< 500)

	)

343 
	#MSG_IS_STATUS_5XX
(
msg
Ë((msg)->
°©us_code
 >500 && (msg)->°©us_codê< 600)

	)

348 
	#MSG_IS_STATUS_6XX
(
msg
Ë((msg)->
°©us_code
 >600 && (msg)->°©us_codê< 700)

	)

354 
	#MSG_TEST_CODE
(
msg
, 
code
Ë(
	`MSG_IS_RESPONSE
(msgË&& (codeË=(msg)->
°©us_code
)

	)

360 
	#MSG_IS_RESPONSE_FOR
(
msg
, 
ªque°«me
Ë(
	`MSG_IS_RESPONSE
(msgË&& 0 =
	`°rcmp
((msg)->
c£q
->
mëhod
, (ªque°«me)))

	)

366 
	#osù_gíîic_∑øm_öô
(
GP
Ë
	`osù_uri_∑øm_öô
(GP)

	)

371 
	#osù_gíîic_∑øm_‰ì
(
GP
Ë
	`osù_uri_∑øm_‰ì
(GP)

	)

378 
	#osù_gíîic_∑øm_£t
(
GP
, 
NAME
, 
VALUE
Ë
	`osù_uri_∑øm_£t
(GP, NAME, VALUE)

	)

384 
	#osù_gíîic_∑øm_˛⁄e
 
osù_uri_∑øm_˛⁄e


	)

385 #i‚de‡
DOXYGEN


390 
	#osù_gíîic_∑øm_‰ìli°
(
LIST
Ë
	`osù_uri_∑øm_‰ìli°
(LIST)

	)

398 
	#osù_gíîic_∑øm_add
(
LIST
, 
NAME
, 
VALUE
Ë
	`osù_uri_∑øm_add
(LIST, NAME, VALUE)

	)

405 
	#osù_gíîic_∑øm_gë_by«me
(
LIST
, 
NAME
, 
DEST
Ë
	`osù_uri_∑øm_gë_by«me
(LIST, NAME, DEST)

	)

412 
osù_gíîic_∑øm_£t_«me
(
osù_gíîic_∑øm_t
 *
gíîic_∑øm
, *
«me
);

417 *
osù_gíîic_∑øm_gë_«me
(c⁄° 
osù_gíîic_∑øm_t
 *
gíîic_∑øm
);

423 
osù_gíîic_∑øm_£t_vÆue
(
osù_gíîic_∑øm_t
 *
gíîic_∑øm
, *
vÆue
);

428 *
osù_gíîic_∑øm_gë_vÆue
(c⁄° 
osù_gíîic_∑øm_t
 *
gíîic_∑øm
);

436 
osù_mesßge_gë_knownhódîli°
(
osù_li°_t
 *
hódî_li°
, 
pos
, **
de°
);

440 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_parser.h

20 #i‚de‡
_OSIP_PARSER_H_


21 
	#_OSIP_PARSER_H_


	)

23 
	~<osù∑r£r2/osù_mesßge.h
>

37 #ifde‡
__˝lu•lus


44 
∑r£r_öô
();

78 
∑r£r_add_comma_£∑øãd_hódî
(c⁄° *
h«me
);

84 
osù_mesßge_fix_œ°_vü_hódî
(
osù_mesßge_t
 *
ªque°
, c⁄° *
ù_addr
, 
p‹t
);

96 
osù_mesßge_gë__¥›îty
(c⁄° 
osù_mesßge_t
 *
sù
);

102 
osù_mesßge_f‹˚_upd©e
(
osù_mesßge_t
 *
sù
);

108 c⁄° *
osù_mesßge_gë_ªas⁄
(
°©us_code
);

115 #i‚de‡
MINISIZE


116 
osù_mesßge_£t_ac˚±
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

118 
	#osù_mesßge_£t_ac˚±
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Ac˚±", vÆue)

	)

126 #i‚de‡
MINISIZE


127 
osù_mesßge_gë_ac˚±
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_t
 **
de°
);

129 
	#osù_mesßge_gë_ac˚±
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ac˚±",Öos, (
osù_hódî_t
 **Ëde°)

	)

136 #i‚de‡
MINISIZE


137 
osù_mesßge_£t_ac˚±_ícodög
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

139 
	#osù_mesßge_£t_ac˚±_ícodög
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Ac˚±-Encodög", vÆue)

	)

147 #i‚de‡
MINISIZE


148 
osù_mesßge_gë_ac˚±_ícodög
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_ícodög_t
 **
de°
);

150 
	#osù_mesßge_gë_ac˚±_ícodög
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ac˚±-ícodög",Öos, (
osù_hódî_t
 **Ëde°)

	)

157 #i‚de‡
MINISIZE


158 
osù_mesßge_£t_ac˚±_œnguage
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

160 
	#osù_mesßge_£t_ac˚±_œnguage
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Ac˚±-L™guage", vÆue)

	)

168 #i‚de‡
MINISIZE


169 
osù_mesßge_gë_ac˚±_œnguage
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_œnguage_t
 **
de°
);

171 
	#osù_mesßge_gë_ac˚±_œnguage
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ac˚±-œnguage",Öos, (
osù_hódî_t
 **Ëde°)

	)

178 #i‚de‡
MINISIZE


179 
osù_mesßge_£t_Æît_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

181 
	#osù_mesßge_£t_Æît_öfo
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"AÀπ-Info", vÆue)

	)

189 #i‚de‡
MINISIZE


190 
osù_mesßge_gë_Æît_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_Æît_öfo_t
 **
de°
);

192 
	#osù_mesßge_gë_Æît_öfo
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Æît-öfo",Öos, (
osù_hódî_t
 **Ëde°)

	)

199 #i‚de‡
MINISIZE


200 
osù_mesßge_£t_Ælow
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

202 
	#osù_mesßge_£t_Ælow
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"AŒow", vÆue)

	)

210 #i‚de‡
MINISIZE


211 
osù_mesßge_gë_Ælow
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_Ælow_t
 **
de°
);

213 
	#osù_mesßge_gë_Ælow
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Ælow",Öos, (
osù_hódî_t
 **Ëde°)

	)

220 #i‚de‡
MINISIZE


221 
osù_mesßge_£t_authítiˇti⁄_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

223 
	#osù_mesßge_£t_authítiˇti⁄_öfo
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Authítiˇti⁄-Info", vÆue)

	)

231 #i‚de‡
MINISIZE


232 
osù_mesßge_gë_authítiˇti⁄_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_authítiˇti⁄_öfo_t
 **
de°
);

234 
	#osù_mesßge_gë_authítiˇti⁄_öfo
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"authítiˇti⁄-öfo",Öos, (
osù_hódî_t
 **Ëde°)

	)

241 
osù_mesßge_£t_auth‹iz©i⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

248 #i‚de‡
MINISIZE


249 
osù_mesßge_gë_auth‹iz©i⁄
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_auth‹iz©i⁄_t
 **
de°
);

251 
	#osù_mesßge_gë_auth‹iz©i⁄
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
auth‹iz©i⁄s
),Öos, (**Ë(de°))

	)

258 
osù_mesßge_£t_ˇŒ_id
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

263 #i‚de‡
MINISIZE


264 
osù_ˇŒ_id_t
 *
osù_mesßge_gë_ˇŒ_id
(c⁄° 
osù_mesßge_t
 *
sù
);

266 
	#osù_mesßge_gë_ˇŒ_id
(
sù
Ë((sù)->
ˇŒ_id
)

	)

273 
osù_mesßge_£t_ˇŒ_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

280 
osù_mesßge_gë_ˇŒ_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ˇŒ_öfo_t
 **
de°
);

286 
osù_mesßge_£t_c⁄è˘
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

293 #i‚de‡
MINISIZE


294 
osù_mesßge_gë_c⁄è˘
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_c⁄è˘_t
 **
de°
);

296 
	#osù_mesßge_gë_c⁄è˘
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
c⁄è˘s
),Öos, (**Ë(de°))

	)

303 #i‚de‡
MINISIZE


304 
osù_mesßge_£t_c⁄ã¡_ícodög
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

306 
	#osù_mesßge_£t_c⁄ã¡_ícodög
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"C⁄ã¡-Encodög", vÆue)

	)

314 #i‚de‡
MINISIZE


315 
osù_mesßge_gë_c⁄ã¡_ícodög
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_c⁄ã¡_ícodög_t
 **
de°
);

317 
	#osù_mesßge_gë_c⁄ã¡_ícodög
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"c⁄ã¡-ícodög",Öos, (
osù_hódî_t
 **Ëde°)

	)

324 
osù_mesßge_£t_c⁄ã¡_Àngth
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

329 #i‚de‡
MINISIZE


330 
osù_c⁄ã¡_Àngth_t
 *
osù_mesßge_gë_c⁄ã¡_Àngth
(c⁄° 
osù_mesßge_t
 *
sù
);

332 
	#osù_mesßge_gë_c⁄ã¡_Àngth
(
sù
Ë((sù)->
c⁄ã¡_Àngth
)

	)

339 
osù_mesßge_£t_c⁄ã¡_ty≥
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

344 #i‚de‡
MINISIZE


345 
osù_c⁄ã¡_ty≥_t
 *
osù_mesßge_gë_c⁄ã¡_ty≥
(c⁄° 
osù_mesßge_t
 *
sù
);

347 
	#osù_mesßge_gë_c⁄ã¡_ty≥
(
sù
Ë((sù)->
c⁄ã¡_ty≥
)

	)

354 
osù_mesßge_£t_c£q
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

359 #i‚de‡
MINISIZE


360 
osù_c£q_t
 *
osù_mesßge_gë_c£q
(c⁄° 
osù_mesßge_t
 *
sù
);

362 
	#osù_mesßge_gë_c£q
(
sù
Ë((sù)->
c£q
)

	)

369 #i‚de‡
MINISIZE


370 
osù_mesßge_£t_îr‹_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

372 
	#osù_mesßge_£t_îr‹_öfo
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Eº‹-Info", vÆue)

	)

380 #i‚de‡
MINISIZE


381 
osù_mesßge_gë_îr‹_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_îr‹_öfo_t
 **
de°
);

383 
	#osù_mesßge_gë_îr‹_öfo
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"îr‹-öfo",Öos, (
osù_hódî_t
 **Ëde°)

	)

390 
osù_mesßge_£t_‰om
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

395 #i‚de‡
MINISIZE


396 
osù_‰om_t
 *
osù_mesßge_gë_‰om
(c⁄° 
osù_mesßge_t
 *
sù
);

398 
	#osù_mesßge_gë_‰om
(
sù
Ë((sù)->
‰om
)

	)

405 
osù_mesßge_£t_mime_vîsi⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

410 #i‚de‡
MINISIZE


411 
osù_mime_vîsi⁄_t
 *
osù_mesßge_gë_mime_vîsi⁄
(c⁄° 
osù_mesßge_t
 *
sù
);

413 
	#osù_mesßge_gë_mime_vîsi⁄
(
sù
Ë((sù)->
mime_vîsi⁄
)

	)

420 
osù_mesßge_£t_¥oxy_authítiˇã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

427 #i‚de‡
MINISIZE


428 
osù_mesßge_gë_¥oxy_authítiˇã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_authítiˇã_t
 **
de°
);

430 
	#osù_mesßge_gë_¥oxy_authítiˇã
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
¥oxy_authítiˇãs
),Öos, (**Ë(de°))

	)

437 
osù_mesßge_£t_¥oxy_auth‹iz©i⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

444 #i‚de‡
MINISIZE


445 
osù_mesßge_gë_¥oxy_auth‹iz©i⁄
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_auth‹iz©i⁄_t
 **
de°
);

447 
	#osù_mesßge_gë_¥oxy_auth‹iz©i⁄
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
¥oxy_auth‹iz©i⁄s
),Öos, (**Ë(de°))

	)

454 #i‚de‡
MINISIZE


455 
osù_mesßge_£t_¥oxy_authítiˇti⁄_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

457 
	#osù_mesßge_£t_¥oxy_authítiˇti⁄_öfo
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Proxy-Authítiˇti⁄-Info", vÆue)

	)

465 #i‚de‡
MINISIZE


466 
osù_mesßge_gë_¥oxy_authítiˇti⁄_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_authítiˇti⁄_öfo_t
 **
de°
);

468 
	#osù_mesßge_gë_¥oxy_authítiˇti⁄_öfo
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"¥oxy-authítiˇti⁄-öfo",Öos, (
osù_hódî_t
 **Ëde°)

	)

475 
osù_mesßge_£t_ªc‹d_rouã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

482 #i‚de‡
MINISIZE


483 
osù_mesßge_gë_ªc‹d_rouã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ªc‹d_rouã_t
 **
de°
);

485 
	#osù_mesßge_gë_ªc‹d_rouã
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
ªc‹d_rouãs
),Öos, (**Ë(de°))

	)

492 
osù_mesßge_£t_rouã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

499 #i‚de‡
MINISIZE


500 
osù_mesßge_gë_rouã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_rouã_t
 **
de°
);

502 
	#osù_mesßge_gë_rouã
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
rouãs
),Öos, (**Ë(de°))

	)

509 
osù_mesßge_£t_to
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

514 #i‚de‡
MINISIZE


515 
osù_to_t
 *
osù_mesßge_gë_to
(c⁄° 
osù_mesßge_t
 *
sù
);

517 
	#osù_mesßge_gë_to
(
sù
Ë((sù)->
to
)

	)

524 
osù_mesßge_£t_vü
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

530 
osù_mesßge_≠≥nd_vü
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

537 #i‚de‡
MINISIZE


538 
osù_mesßge_gë_vü
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_vü_t
 **
de°
);

540 
	#osù_mesßge_gë_vü
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
vüs
),Öos, (**Ë(de°))

	)

547 
osù_mesßge_£t_www_authítiˇã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
);

554 #i‚de‡
MINISIZE


555 
osù_mesßge_gë_www_authítiˇã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_www_authítiˇã_t
 **
de°
);

557 
	#osù_mesßge_gë_www_authítiˇã
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
www_authítiˇãs
),Öos, (**Ë(de°))

	)

559 #i‚de‡
DOXYGEN


566 
osù_mesßge_£t_mu…ùÀ_hódî
(
osù_mesßge_t
 *
sù
, *
h«me
, *
hvÆue
);

574 
osù_mesßge_£t_hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
);

581 
osù_mesßge_ª∂a˚_hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
);

582 #i‚de‡
MINISIZE


590 
osù_mesßge_£t_t›hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
);

599 
osù_mesßge_hódî_gë_by«me
(c⁄° 
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, 
pos
, 
osù_hódî_t
 **
de°
);

606 #i‚de‡
MINISZE


607 
osù_mesßge_gë_hódî
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_hódî_t
 **
de°
);

609 
	#osù_mesßge_gë_hódî
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
hódîs
),Öos, (**Ë(de°))

	)

617 
osù_mesßge_£t_body
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
);

624 
osù_mesßge_£t_body_mime
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
);

631 #i‚de‡
MINISIZE


632 
osù_mesßge_gë_body
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_body_t
 **
de°
);

634 
	#osù_mesßge_gë_body
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_gë_knownhódîli°
((&(sù)->
bodõs
),Öos, (**Ë(de°))

	)

638 #i‚de‡
DOXYGEN


639 #ifde‡
ENABLE_TRACE


640 
msg_logªque°
(
osù_mesßge_t
 *
sù
, *
fmt
);

641 
msg_logª•⁄£
(
osù_mesßge_t
 *
sù
, *
fmt
);

643 
	#msg_logªque°
(
P
, 
Q
Ë;

	)

644 
	#msg_logª•⁄£
(
P
, 
Q
Ë;

	)

653 
	#osù_mesßge_£t_d©e
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"D©e", vÆue)

	)

660 
	#osù_mesßge_gë_d©e
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"d©e",Öos, (
osù_hódî_t
 **Ëde°)

	)

666 
	#osù_mesßge_£t_í¸y±i⁄
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"En¸y±i⁄", vÆue)

	)

673 
	#osù_mesßge_gë_í¸y±i⁄
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"í¸y±i⁄",Öos, (
osù_hódî_t
 **Ëde°)

	)

679 
	#osù_mesßge_£t_‹g™iz©i⁄
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Org™iz©i⁄", vÆue)

	)

686 
	#osù_mesßge_gë_‹g™iz©i⁄
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"‹g™iz©i⁄",Öos, (
osù_hódî_t
 **Ëde°)

	)

692 
	#osù_mesßge_£t_ªquúe
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Requúe", vÆue)

	)

699 
	#osù_mesßge_gë_ªquúe
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ªquúe",Öos, (
osù_hódî_t
 **Ëde°)

	)

705 
	#osù_mesßge_£t_suµ‹ãd
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Suµ‹ãd", vÆue)

	)

712 
	#osù_mesßge_gë_suµ‹ãd
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"suµ‹ãd",Öos, (
osù_hódî_t
 **Ëde°)

	)

718 
	#osù_mesßge_£t_time°amp
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Time°amp", vÆue)

	)

725 
	#osù_mesßge_gë_time°amp
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"time°amp",Öos, (
osù_hódî_t
 **Ëde°)

	)

731 
	#osù_mesßge_£t_u£r_agít
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"U£r-Agít", vÆue)

	)

738 
	#osù_mesßge_gë_u£r_agít
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"u£r-agít",Öos, (
osù_hódî_t
 **Ëde°)

	)

744 
	#osù_mesßge_£t_c⁄ã¡_œnguage
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"C⁄ã¡-L™guage", vÆue)

	)

751 
	#osù_mesßge_gë_c⁄ã¡_œnguage
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"c⁄ã¡-œnguage",Öos, (
osù_hódî_t
 **Ëde°)

	)

757 
	#osù_mesßge_£t_expúes
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Expúes", vÆue)

	)

764 
	#osù_mesßge_gë_expúes
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"expúes",Öos, (
osù_hódî_t
 **Ëde°)

	)

770 
	#osù_mesßge_£t_ö_ª∂y_to
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"In-Rïly-To", vÆue)

	)

777 
	#osù_mesßge_gë_ö_ª∂y_to
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ö-ª∂y-to",Öos, (
osù_hódî_t
 **Ëde°)

	)

783 
	#osù_mesßge_£t_max_f‹w¨ds
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Max-F‹w¨ds", vÆue)

	)

790 
	#osù_mesßge_gë_max_f‹w¨ds
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"max-f‹w¨ds",Öos, (
osù_hódî_t
 **Ëde°)

	)

796 
	#osù_mesßge_£t_¥i‹ôy
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Pri‹ôy", vÆue)

	)

803 
	#osù_mesßge_gë_¥i‹ôy
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"¥i‹ôy",Öos, (
osù_hódî_t
 **Ëde°)

	)

809 
	#osù_mesßge_£t_¥oxy_ªquúe
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Proxy-Requúe", vÆue)

	)

816 
	#osù_mesßge_gë_¥oxy_ªquúe
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"¥oxy-ªquúe",Öos, (
osù_hódî_t
 **Ëde°)

	)

822 
	#osù_mesßge_£t_ª•⁄£_key
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Re•⁄£-Key", vÆue)

	)

829 
	#osù_mesßge_gë_ª•⁄£_key
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ª•⁄£-key",Öos, (
osù_hódî_t
 **Ëde°)

	)

835 
	#osù_mesßge_£t_subje˘
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Subje˘", vÆue)

	)

842 
	#osù_mesßge_gë_subje˘
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"subje˘",Öos, (
osù_hódî_t
 **Ëde°)

	)

848 
	#osù_mesßge_£t_ªåy_a·î
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Rëry-A·î", vÆue)

	)

855 
	#osù_mesßge_gë_ªåy_a·î
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"ªåy-a·î",Öos, (
osù_hódî_t
 **Ëde°)

	)

861 
	#osù_mesßge_£t_£rvî
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Sîvî", vÆue)

	)

868 
	#osù_mesßge_gë_£rvî
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"£rvî",Öos, (
osù_hódî_t
 **Ëde°)

	)

874 
	#osù_mesßge_£t_unsuµ‹ãd
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"Unsuµ‹ãd", vÆue)

	)

881 
	#osù_mesßge_gë_unsuµ‹ãd
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"unsuµ‹ãd",Öos, (
osù_hódî_t
 **Ëde°)

	)

887 
	#osù_mesßge_£t_w¨nög
(
sù
, 
vÆue
Ë
	`osù_mesßge_£t_hódî
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"W¨nög", vÆue)

	)

894 
	#osù_mesßge_gë_w¨nög
(
sù
, 
pos
, 
de°
Ë
	`osù_mesßge_hódî_gë_by«me
((
osù_mesßge_t
 *Ësù, (c⁄° *Ë"w¨nög",Öos, (
osù_hódî_t
 **Ëde°)

	)

898 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_port.h

20 #i‚de‡
_OSIP_PORT_H_


21 
	#_OSIP_PORT_H_


	)

23 
	~<°dio.h
>

27 #i‡
deföed
(
HAVE_STDARG_H
)

28 
	~<°d¨g.h
>

30 #i‡
deföed
(
HAVE_VARARGS_H
)

31 
	~<v¨¨gs.h
>

33 
	~<°d¨g.h
>

37 #i‡
deföed
(
__VXWORKS_OS__
)

39 
osù_v¢¥ötf
(*
buf
, 
max
, c⁄° *
fmt
, 
va_li°
 
≠
);

40 
osù_¢¥ötf
(*
buf
, 
max
, c⁄° *
fmt
, ...);

42 
	#¢¥ötf
 
osù_¢¥ötf


	)

43 
	#v¢¥ötf
 
osù_v¢¥ötf


	)

46 
	~<osù∑r£r2/osù_c⁄°.h
>

48 
	~<osù∑r£r2/osù_li°.h
>

50 
	#SIP_SYNTAX_ERROR
 (-1)

	)

51 
	#SIP_NETWORK_ERROR
 (-2)

	)

52 
	#SIP_ECONNREFUSED
 (-3)

	)

53 
	#SIP_RESSOURCE_ERROR
 (-4)

	)

54 
	#SIP_GLOBAL_ERROR
 (-5)

	)

56 #ifde‡
__˝lu•lus


64 #i‡!
deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
)

66 #i‚de‡
MINISIZE


67 *
	tosù_mÆloc_func_t
(
	tsize_t
 
	tsize
);

68 
	tosù_‰ì_func_t
(*
	t±r
);

69 *
	tosù_ªÆloc_func_t
(*
	t±r
, 
	tsize_t
 
	tsize
);

71 
osù_mÆloc_func_t
 *
osù_mÆloc_func
;

72 
osù_ªÆloc_func_t
 *
osù_ªÆloc_func
;

73 
osù_‰ì_func_t
 *
osù_‰ì_func
;

75 
osù_£t_Æloˇt‹s
(
osù_mÆloc_func_t
 *
mÆloc_func
, 
osù_ªÆloc_func_t
 *
ªÆloc_func
, 
osù_‰ì_func_t
 *
‰ì_func
);

78 #ifde‡
DEBUG_MEM


80 *
_osù_mÆloc
(
size_t
 
size
, *
fûe
, 
löe
);

81 
_osù_‰ì
(*
±r
);

82 *
_osù_ªÆloc
(*
±r
, 
size_t
 
size
, *
fûe
, 
löe
);

84 #i‚de‡
osù_mÆloc


85 
	#osù_mÆloc
(
S
Ë
	`_osù_mÆloc
(S, 
__FILE__
, 
__LINE__
)

	)

87 #i‚de‡
osù_ªÆloc


88 
	#osù_ªÆloc
(
P
, 
S
Ë
	`_osù_ªÆloc
(P, S, 
__FILE__
, 
__LINE__
)

	)

90 #i‚de‡
osù_‰ì


91 
	#osù_‰ì
(
P
) \

93 i‡(
P
 !
NULL
) { \

94 
	`_osù_‰ì
(
P
); \

96 }

	)

101 #i‚de‡
MINISIZE


102 #i‚de‡
osù_mÆloc


103 
	#osù_mÆloc
(
S
Ë(
osù_mÆloc_func
 ? 
	`osù_mÆloc_func
(SË: 
	`mÆloc
(S))

	)

105 #i‚de‡
osù_ªÆloc


106 
	#osù_ªÆloc
(
P
, 
S
Ë(
osù_ªÆloc_func
 ? 
	`osù_ªÆloc_func
(P, SË: 
	`ªÆloc
(P, S))

	)

108 #i‚de‡
osù_‰ì


109 
	#osù_‰ì
(
P
) \

111 i‡(
P
 !
NULL
) { \

112 i‡(
osù_‰ì_func
) \

113 
	`osù_‰ì_func
(
P
); \

115 
	`‰ì
(
P
); \

117 }

	)

122 #i‚de‡
osù_mÆloc


123 
	#osù_mÆloc
(
S
Ë
	`mÆloc
(S)

	)

125 #i‚de‡
osù_ªÆloc


126 
	#osù_ªÆloc
(
P
, 
S
Ë
	`ªÆloc
(P, S)

	)

128 #i‚de‡
osù_‰ì


129 
	#osù_‰ì
(
P
) \

131 i‡(
P
 !
NULL
) { \

132 
	`‰ì
(
P
); \

134 }

	)

144 #i‡
deföed
(
_DEBUG
Ë&& deföed(
WIN32
)

145 
	#OSIP_MEMORY_DEBUG


	)

148 #ifde‡
OSIP_MEMORY_DEBUG


150 #i‚de‡
osù_mÆloc


151 
	#osù_mÆloc
(
S
Ë
	`_osù_mÆloc
(S, 
__FILE__
, 
__LINE__
)

	)

153 #i‚de‡
osù_ªÆloc


154 
	#osù_ªÆloc
(
P
, 
S
Ë
	`_osù_ªÆloc
(P, S, 
__FILE__
, 
__LINE__
)

	)

156 #i‚de‡
osù_‰ì


157 
	#osù_‰ì
(
P
) \

159 i‡(
P
 !
NULL
) { \

160 
	`_osù_‰ì
(
P
); \

162 }

	)

165 *
_osù_mÆloc
(
size_t
 
size
, *
fûe
, 
löe
);

166 
_osù_‰ì
(*
±r
);

167 *
_osù_ªÆloc
(*
±r
, 
size_t
 
size
, *
fûe
, 
löe
);

169 *
osù_mÆloc
(
size_t
 
size
);

170 *
osù_ªÆloc
(*, 
size_t
 
size
);

171 
osù_‰ì
(*);

176 #i‡
deföed
(
WIN32
Ë&& !deföed(
__GNUC__
)

177 
	#Æloˇ
 
_Æloˇ


	)

184 
osù_buûd_øndom_numbî
();

190 
	#SP
 " \0"

	)

192 
osù_u¶ìp
(
u£c⁄ds
);

194 #i‚de‡
MINISIZE


195 
osù_©oi
(c⁄° *
numbî
);

196 
osù_°rˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
);

197 
osù_°∫ˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
, 
size_t
 
Àn
);

200 
	#osù_©oi
 
©oi


	)

201 
	#osù_°rˇ£cmp
 
°rˇ£cmp


	)

202 
	#osù_°∫ˇ£cmp
 
°∫ˇ£cmp


	)

205 *
osù_°rˇ£°r
(c⁄° *
hay°ack
, c⁄° *
√edÀ
);

211 *
osù_°∫˝y
(*
de°
, c⁄° *
§c
, 
size_t
 
Àngth
);

212 *
osù_°rdup
(c⁄° *
ch
);

213 *
osù_°rdup_wôhout_quŸe
(c⁄° *
ch
);

214 
osù_tﬁowî
(*
w‹d
);

215 
osù_˛r•a˚
(*
w‹d
);

216 
__osù_£t_√xt_tokí
(**
de°
, *
buf
, 
íd_£∑øt‹
, **
√xt
);

218 c⁄° *
__osù_quŸe_föd
(c⁄° *
q°rög
);

219 *
osù_íquŸe
(c⁄° *
s
);

220 
osù_dequŸe
(*
s
);

222 
osù_hash
(c⁄° *
°r
);

223 *
osù_°r_≠≥nd
(*
d°
, c⁄° *
§c
);

224 *
osù_°∫_≠≥nd
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
);

225 *
osù_˛∫˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
);

231 
	#LOG_TRUE
 1

	)

232 
	#LOG_FALSE
 0

	)

234 
	e_åa˚_Àvñ
 {

235 
	gTRACE_LEVEL0
 = 0,

236 
	#OSIP_FATAL
 
TRACE_LEVEL0


	)

237 
	gTRACE_LEVEL1
 = 1,

238 
	#OSIP_BUG
 
TRACE_LEVEL1


	)

239 
	gTRACE_LEVEL2
 = 2,

240 
	#OSIP_ERROR
 
TRACE_LEVEL2


	)

241 
	gTRACE_LEVEL3
 = 3,

242 
	#OSIP_WARNING
 
TRACE_LEVEL3


	)

243 
	gTRACE_LEVEL4
 = 4,

244 
	#OSIP_INFO1
 
TRACE_LEVEL4


	)

245 
	gTRACE_LEVEL5
 = 5,

246 
	#OSIP_INFO2
 
TRACE_LEVEL5


	)

247 
	gTRACE_LEVEL6
 = 6,

248 
	#OSIP_INFO3
 
TRACE_LEVEL6


	)

249 
	gTRACE_LEVEL7
 = 7,

250 
	#OSIP_INFO4
 
TRACE_LEVEL7


	)

251 
	gEND_TRACE_LEVEL
 = 8

252 } 
	tosù_åa˚_Àvñ_t
;

254 
	tosù_åa˚_func_t
(c⁄° *
	tfi
, 
	tli
, 
	tosù_åa˚_Àvñ_t
 
	tÀvñ
, c⁄° *
	tch‰
, 
	tva_li°
 
	t≠
);

258 
osù_åa˚_öôülize_func
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
osù_åa˚_func_t
 *
func
);

259 
osù_åa˚_öôülize_sy¶og
(
osù_åa˚_Àvñ_t
 
Àvñ
, *
idít
);

260 
osù_åa˚_öôülize
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
FILE
 *
fûe
);

261 
osù_åa˚_íabÀ_u¡û_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
);

262 
osù_åa˚_íabÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
);

263 
osù_åa˚_dißbÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
);

264 
osù_is_åa˚_Àvñ_a˘iv©e
(
osù_åa˚_Àvñ_t
 
Àvñ
);

266 #i‚de‡
ENABLE_TRACE


268 
	#TRACE_INITIALIZE
(
Àvñ
, 
fûe
) \

270 } 0)

	)

271 
	#TRACE_ENABLE_LEVEL
(
Àvñ
) \

273 } 0)

	)

274 
	#TRACE_DISABLE_LEVEL
(
Àvñ
) \

276 } 0)

	)

277 
	#IS_TRACE_LEVEL_ACTIVATE
(
Àvñ
Ë(-1)

	)

281 
	#TRACE_INITIALIZE
(
Àvñ
, 
fûe
Ë
	`osù_åa˚_öôülize
÷evñ, fûe)

	)

282 
	#TRACE_ENABLE_LEVEL
(
Àvñ
Ë
	`osù_åa˚_íabÀ_Àvñ
÷evñ)

	)

283 
	#TRACE_DISABLE_LEVEL
(
Àvñ
Ë
	`osù_åa˚_dißbÀ_Àvñ
÷evñ)

	)

284 
	#IS_TRACE_LEVEL_ACTIVATE
(
Àvñ
Ë
	`osù_is_åa˚_Àvñ_a˘iv©e
÷evñ)

	)

293 
osù_åa˚
(c⁄° *
fi
, 
li
, 
osù_åa˚_Àvñ_t
 
Àvñ
, 
FILE
 *
f
, c⁄° *
ch‰
, ...);

295 #ifde‡
ENABLE_TRACE


296 
	#OSIP_TRACE
(
P
Ë
	)
P

298 
	#OSIP_TRACE
(
P
) \

300 } 0)

	)

303 
	#REMOVE_ELEMENT
(
fú°_ñemít
, 
ñemít
) \

304 i‡(
ñemít
->
∑ª¡
 =
NULL
) { \

305 
fú°_ñemít
 = 
ñemít
->
√xt
; \

306 i‡(
fú°_ñemít
 !
NULL
) \

307 
fú°_ñemít
->
∑ª¡
 = 
NULL
; \

309 
ñemít
->
∑ª¡
->
√xt
 =Élement->next; \

310 i‡(
ñemít
->
√xt
 !
NULL
) \

311 
ñemít
->
√xt
->
∑ª¡
 =Élement->parent; \

312 
ñemít
->
√xt
 = 
NULL
; \

313 
ñemít
->
∑ª¡
 = 
NULL
; \

314 }

	)

316 
	#ADD_ELEMENT
(
fú°_ñemít
, 
ñemít
) \

317 i‡(
fú°_ñemít
 =
NULL
) { \

318 
fú°_ñemít
 = 
ñemít
; \

319 
ñemít
->
√xt
 = 
NULL
; \

320 
ñemít
->
∑ª¡
 = 
NULL
; \

322 
ñemít
->
√xt
 = 
fú°_ñemít
; \

323 
ñemít
->
∑ª¡
 = 
NULL
; \

324 
ñemít
->
√xt
->
∑ª¡
 =Élement; \

325 
fú°_ñemít
 = 
ñemít
; \

326 }

	)

328 
	#APPEND_ELEMENT
(
ty≥_of_ñemít_t
, 
fú°_ñemít
, 
ñemít
) \

329 i‡(
fú°_ñemít
 =
NULL
) { \

330 
fú°_ñemít
 = 
ñemít
; \

331 
ñemít
->
√xt
 = 
NULL
; \

332 
ñemít
->
∑ª¡
 = 
NULL
; \

334 
ty≥_of_ñemít_t
 *
f
; \

335 
f
 = 
fú°_ñemít
; f->
√xt
 !
NULL
; f = f->next) { \

337 
f
->
√xt
 = 
ñemít
; \

338 
ñemít
->
∑ª¡
 = 
f
; \

339 
ñemít
->
√xt
 = 
NULL
; \

340 }

	)

342 c⁄° *
osù_°ªº‹
(
îr
);

344 #ifde‡
__˝lu•lus


347 
	#OSIP_SUCCESS
 0

	)

348 
	#OSIP_UNDEFINED_ERROR
 -1

	)

349 
	#OSIP_BADPARAMETER
 -2

	)

350 
	#OSIP_WRONG_STATE
 -3

	)

351 
	#OSIP_NOMEM
 -4

	)

352 
	#OSIP_SYNTAXERROR
 -5

	)

353 
	#OSIP_NOTFOUND
 -6

	)

354 
	#OSIP_API_NOT_INITIALIZED
 -7

	)

355 
	#OSIP_NO_NETWORK
 -10

	)

356 
	#OSIP_PORT_BUSY
 -11

	)

357 
	#OSIP_UNKNOWN_HOST
 -12

	)

358 
	#OSIP_DISK_FULL
 -30

	)

359 
	#OSIP_NO_RIGHTS
 -31

	)

360 
	#OSIP_FILE_NOT_EXIST
 -32

	)

361 
	#OSIP_TIMEOUT
 -50

	)

362 
	#OSIP_TOOMUCHCALL
 -51

	)

363 
	#OSIP_WRONG_FORMAT
 -52

	)

364 
	#OSIP_NOCOMMONCODEC
 -53

	)

365 
	#OSIP_RETRY_LIMIT
 -60

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_uri.h

20 #i‚de‡
_URLS_H_


21 
	#_URLS_H_


	)

23 
	~<osù∑r£r2/osù_c⁄°.h
>

24 
	~<osù∑r£r2/osù_li°.h
>

41 #ifde‡
__˝lu•lus


49 
osù_uri_∑øm
 
	tosù_uri_∑øm_t
;

55 
	sosù_uri_∑øm
 {

56 *
g«me
;

57 *
gvÆue
;

65 
osù_uri_∑øm_t
 
	tosù_uri_hódî_t
;

71 
osù_uri_∑øm_öô
(
osù_uri_∑øm_t
 **
uæ_∑øm
);

76 
osù_uri_∑øm_‰ì
(
osù_uri_∑øm_t
 *
uæ_∑øm
);

83 
osù_uri_∑øm_£t
(
osù_uri_∑øm_t
 *
uæ_∑øm
, *
«me
, *
vÆue
);

89 
osù_uri_∑øm_˛⁄e
(c⁄° 
osù_uri_∑øm_t
 *
uæ_∑øm
, osù_uri_∑øm_à**
de°
);

90 #i‚de‡
DOXYGEN


95 
osù_uri_∑øm_‰ìli°
(
osù_li°_t
 *
uæ_∑øms
);

103 
osù_uri_∑øm_add
(
osù_li°_t
 *
uæ_∑øms
, *
«me
, *
vÆue
);

110 
osù_uri_∑øm_gë_by«me
(
osù_li°_t
 *
uæ_∑øms
, *
«me
, 
osù_uri_∑øm_t
 **
de°
);

116 
	#osù_uri_hódî_öô
(
uæ_hódî
Ë
	`osù_uri_∑øm_öô
(uæ_hódî)

	)

121 
	#osù_uri_hódî_‰ì
(
uæ_hódî
Ë
	`osù_uri_∑øm_‰ì
(uæ_hódî)

	)

128 
	#osù_uri_hódî_£t
(
uæ_hódî
, 
«me
, 
vÆue
Ë
	`osù_uri_∑øm_£t
(uæ_hódî,Çame, vÆue)

	)

134 
	#osù_uri_hódî_˛⁄e
(
uæ_hódî
, 
de°
Ë
	`osù_uri_∑øm_˛⁄e
(uæ_hódî, de°)

	)

135 #i‚de‡
DOXYGEN


140 
	#osù_uri_hódî_‰ìli°
(
LIST
Ë
	`osù_uri_∑øm_‰ìli°
(LIST)

	)

148 
	#osù_uri_hódî_add
(
uæ_hódîs
, 
«me
, 
vÆue
Ë
	`osù_uri_∑øm_add
(uæ_hódîs,Çame, vÆue)

	)

155 
	#osù_uri_hódî_gë_by«me
(
uæ_hódîs
, 
«me
, 
de°
Ë
	`osù_uri_∑øm_gë_by«me
(uæ_hódîs,Çame, de°)

	)

161 
osù_uri
 
	tosù_uri_t
;

167 
	sosù_uri
 {

168 *
scheme
;

169 *
u£∫ame
;

170 *
∑ssw‹d
;

171 *
ho°
;

172 *
p‹t
;

173 
osù_li°_t
 
uæ_∑øms
;

174 
osù_li°_t
 
uæ_hódîs
;

177 *
°rög
;

185 
osù_uri_öô
(
osù_uri_t
 **
uæ
);

190 
osù_uri_‰ì
(
osù_uri_t
 *
uæ
);

196 
osù_uri_∑r£
(
osù_uri_t
 *
uæ
, c⁄° *
buf
);

197 #i‚de‡
DOXYGEN


203 
osù_uri_∑r£_hódîs
(
osù_uri_t
 *
uæ
, c⁄° *
buf
);

209 
osù_uri_∑r£_∑øms
(
osù_uri_t
 *
uæ
, c⁄° *
buf
);

216 
osù_uri_to_°r
(c⁄° 
osù_uri_t
 *
uæ
, **
de°
);

222 
osù_uri_˛⁄e
(c⁄° 
osù_uri_t
 *
uæ
, osù_uri_à**
de°
);

229 
osù_uri_to_°r_ˇn⁄iˇl
(c⁄° 
osù_uri_t
 *
uæ
, **
de°
);

236 
osù_uri_£t_scheme
(
osù_uri_t
 *
uæ
, *
vÆue
);

241 *
osù_uri_gë_scheme
(
osù_uri_t
 *
uæ
);

247 
osù_uri_£t_ho°
(
osù_uri_t
 *
uæ
, *
vÆue
);

252 *
osù_uri_gë_ho°
(
osù_uri_t
 *
uæ
);

258 
osù_uri_£t_u£∫ame
(
osù_uri_t
 *
uæ
, *
vÆue
);

263 *
osù_uri_gë_u£∫ame
(
osù_uri_t
 *
uæ
);

269 
osù_uri_£t_∑ssw‹d
(
osù_uri_t
 *
uæ
, *
vÆue
);

274 *
osù_uri_gë_∑ssw‹d
(
osù_uri_t
 *
uæ
);

280 
osù_uri_£t_p‹t
(
osù_uri_t
 *
uæ
, *
vÆue
);

285 *
osù_uri_gë_p‹t
(
osù_uri_t
 *
uæ
);

291 
	#osù_uri_£t_å™•‹t_udp
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("å™•‹t"), osù_°rdup("udp"))

	)

296 
	#osù_uri_£t_å™•‹t_t˝
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("å™•‹t"), osù_°rdup("t˝"))

	)

301 
	#osù_uri_£t_å™•‹t_s˘p
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("å™•‹t"), osù_°rdup("s˘p"))

	)

306 
	#osù_uri_£t_å™•‹t_és
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("å™•‹t"), osù_°rdup("és"))

	)

312 
	#osù_uri_£t_å™•‹t
(
uæ
, 
vÆue
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("å™•‹t"), vÆue)

	)

318 
	#osù_uri_£t_u£r_ph⁄e
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("u£r"), osù_°rdup("ph⁄e"))

	)

323 
	#osù_uri_£t_u£r_ù
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("u£r"), osù_°rdup("ù"))

	)

328 
	#osù_uri_£t_mëhod_övôe
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("INVITE"))

	)

333 
	#osù_uri_£t_mëhod_ack
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("ACK"))

	)

338 
	#osù_uri_£t_mëhod_›ti⁄s
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("OPTIONS"))

	)

343 
	#osù_uri_£t_mëhod_bye
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("BYE"))

	)

348 
	#osù_uri_£t_mëhod_ˇn˚l
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("CANCEL"))

	)

353 
	#osù_uri_£t_mëhod_ªgi°î
(
uæ
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), osù_°rdup("REGISTER"))

	)

359 
	#osù_uri_£t_mëhod
(
uæ
, 
vÆue
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("mëhod"), vÆue)

	)

365 
	#osù_uri_£t_âl
(
uæ
, 
vÆue
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("âl"), vÆue)

	)

371 
	#osù_uri_£t_maddr
(
uæ
, 
vÆue
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
), 
	`osù_°rdup
("maddr"), vÆue)

	)

379 
	#osù_uri_u∑øm_add
(
uæ
, 
«me
, 
vÆue
Ë
	`osù_uri_∑øm_add
((&(uæ)->
uæ_∑øms
),Çame, vÆue)

	)

386 
	#osù_uri_u∑øm_gë_by«me
(
uæ
, 
«me
, 
de°
Ë
	`osù_uri_∑øm_gë_by«me
((&(uæ)->
uæ_∑øms
),Çame, de°)

	)

394 
	#osù_uri_uhódî_add
(
uæ
, 
«me
, 
vÆue
Ë
	`osù_uri_hódî_add
((&(uæ)->
uæ_hódîs
),Çame, vÆue)

	)

401 
	#osù_uri_uhódî_gë_by«me
(
uæ
, 
«me
, 
de°
Ë
	`osù_uri_hódî_gë_by«me
((&(uæ)->
uæ_hódîs
),Çame, de°)

	)

403 #i‚de‡
DOXYGEN


405 c⁄° *
√xt_£∑øt‹
(c⁄° *
ch
, 
£∑øt‹_osù_to_föd
, 
bef‹e_£∑øt‹
);

407 *
__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(c⁄° *
°rög
, c⁄° *
def
);

408 *
__osù_uri_esˇ≥_u£röfo
(c⁄° *
°rög
);

409 *
__osù_uri_esˇ≥_∑ssw‹d
(c⁄° *
°rög
);

410 *
__osù_uri_esˇ≥_uri_∑øm
(*
°rög
);

411 *
__osù_uri_esˇ≥_hódî_∑øm
(*
°rög
);

412 
__osù_uri_u√sˇ≥
(*
°rög
);

418 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/sdp_message.h

20 #i‚de‡
_SDP_H_


21 
	#_SDP_H_


	)

23 #ifde‡
ENABLE_MPATROL


24 
	~<m∑åﬁ.h
>

27 
	~<osù∑r£r2/osù_li°.h
>

42 #ifde‡
__˝lu•lus


50 
sdp_b™dwidth
 
	tsdp_b™dwidth_t
;

56 
	ssdp_b™dwidth
 {

57 *
b_bwty≥
;

58 *
b_b™dwidth
;

65 
sdp_b™dwidth_öô
(
sdp_b™dwidth_t
 **
ñem
);

70 
sdp_b™dwidth_‰ì
(
sdp_b™dwidth_t
 *
ñem
);

76 
sdp_time_des¸
 
	tsdp_time_des¸_t
;

82 
	ssdp_time_des¸
 {

83 *
t_°¨t_time
;

84 *
t_°›_time
;

85 
osù_li°_t
 
r_ª≥©s
;

92 
sdp_time_des¸_öô
(
sdp_time_des¸_t
 **
ñem
);

97 
sdp_time_des¸_‰ì
(
sdp_time_des¸_t
 *
ñem
);

103 
sdp_key
 
	tsdp_key_t
;

109 
	ssdp_key
 {

110 *
k_keyty≥
;

111 *
k_keyd©a
;

118 
sdp_key_öô
(
sdp_key_t
 **
ñem
);

123 
sdp_key_‰ì
(
sdp_key_t
 *
ñem
);

129 
sdp_©åibuã
 
	tsdp_©åibuã_t
;

135 
	ssdp_©åibuã
 {

136 *
a_©t_fõld
;

137 *
a_©t_vÆue
;

144 
sdp_©åibuã_öô
(
sdp_©åibuã_t
 **
ñem
);

149 
sdp_©åibuã_‰ì
(
sdp_©åibuã_t
 *
ñem
);

155 
sdp_c⁄√˘i⁄
 
	tsdp_c⁄√˘i⁄_t
;

161 
	ssdp_c⁄√˘i⁄
 {

162 *
c_√ây≥
;

163 *
c_addπy≥
;

164 *
c_addr
;

165 *
c_addr_mu…iˇ°_âl
;

167 *
c_addr_mu…iˇ°_öt
;

175 
sdp_c⁄√˘i⁄_öô
(
sdp_c⁄√˘i⁄_t
 **
ñem
);

180 
sdp_c⁄√˘i⁄_‰ì
(
sdp_c⁄√˘i⁄_t
 *
ñem
);

186 
sdp_medü
 
	tsdp_medü_t
;

192 
	ssdp_medü
 {

193 *
m_medü
;

194 *
m_p‹t
;

195 *
m_numbî_of_p‹t
;

196 *
m_¥Ÿo
;

197 
osù_li°_t
 
m_∑ylﬂds
;

199 *
i_öfo
;

200 
osù_li°_t
 
c_c⁄√˘i⁄s
;

202 
osù_li°_t
 
b_b™dwidths
;

204 
osù_li°_t
 
a_©åibuãs
;

206 
sdp_key_t
 *
k_key
;

213 
sdp_medü_öô
(
sdp_medü_t
 **
ñem
);

218 
sdp_medü_‰ì
(
sdp_medü_t
 *
ñem
);

224 
sdp_mesßge
 
	tsdp_mesßge_t
;

230 
	ssdp_mesßge
 {

231 *
v_vîsi⁄
;

232 *
o_u£∫ame
;

233 *
o_£ss_id
;

234 *
o_£ss_vîsi⁄
;

235 *
o_√ây≥
;

236 *
o_addπy≥
;

237 *
o_addr
;

238 *
s_«me
;

239 *
i_öfo
;

240 *
u_uri
;

241 
osù_li°_t
 
e_emaûs
;

242 
osù_li°_t
 
p_ph⁄es
;

243 
sdp_c⁄√˘i⁄_t
 *
c_c⁄√˘i⁄
;

245 
osù_li°_t
 
b_b™dwidths
;

247 
osù_li°_t
 
t_des¸s
;

248 *
z_adju°míts
;

249 
sdp_key_t
 *
k_key
;

250 
osù_li°_t
 
a_©åibuãs
;

252 
osù_li°_t
 
m_medüs
;

259 
sdp_mesßge_öô
(
sdp_mesßge_t
 **
sdp
);

265 
sdp_mesßge_∑r£
(
sdp_mesßge_t
 *
sdp
, c⁄° *
buf
);

271 
sdp_mesßge_to_°r
(
sdp_mesßge_t
 *
sdp
, **
de°
);

276 
sdp_mesßge_‰ì
(
sdp_mesßge_t
 *
sdp
);

282 
sdp_mesßge_˛⁄e
(
sdp_mesßge_t
 *
sdp
, sdp_mesßge_à**
de°
);

289 
sdp_mesßge_v_vîsi⁄_£t
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

294 *
sdp_mesßge_v_vîsi⁄_gë
(
sdp_mesßge_t
 *
sdp
);

305 
sdp_mesßge_o_‹igö_£t
(
sdp_mesßge_t
 *
sdp
, *
u£∫ame
, *
£ss_id
, *
£ss_vîsi⁄
, *
√ây≥
, *
addπy≥
, *
addr
);

310 *
sdp_mesßge_o_u£∫ame_gë
(
sdp_mesßge_t
 *
sdp
);

315 *
sdp_mesßge_o_£ss_id_gë
(
sdp_mesßge_t
 *
sdp
);

320 *
sdp_mesßge_o_£ss_vîsi⁄_gë
(
sdp_mesßge_t
 *
sdp
);

325 *
sdp_mesßge_o_√ây≥_gë
(
sdp_mesßge_t
 *
sdp
);

330 *
sdp_mesßge_o_addπy≥_gë
(
sdp_mesßge_t
 *
sdp
);

335 *
sdp_mesßge_o_addr_gë
(
sdp_mesßge_t
 *
sdp
);

341 
sdp_mesßge_s_«me_£t
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

346 *
sdp_mesßge_s_«me_gë
(
sdp_mesßge_t
 *
sdp
);

353 
sdp_mesßge_i_öfo_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
vÆue
);

359 *
sdp_mesßge_i_öfo_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

365 
sdp_mesßge_u_uri_£t
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

370 *
sdp_mesßge_u_uri_gë
(
sdp_mesßge_t
 *
sdp
);

376 
sdp_mesßge_e_emaû_add
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

381 
	#sdp_e_emaû_gë
 
sdp_mesßge_e_emaû_gë


	)

387 *
sdp_mesßge_e_emaû_gë
(
sdp_mesßge_t
 *
sdp
, 
pos
);

393 
sdp_mesßge_p_ph⁄e_add
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

399 *
sdp_mesßge_p_ph⁄e_gë
(
sdp_mesßge_t
 *
sdp
, 
pos
);

410 
sdp_mesßge_c_c⁄√˘i⁄_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
√ây≥
, *
addπy≥
, *
addr
, *
addr_mu…iˇ°_âl
, *
addr_mu…iˇ°_öt
);

411 #i‚de‡
DOXYGEN


413 
sdp_c⁄√˘i⁄_t
 *
sdp_mesßge_c⁄√˘i⁄_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

421 *
sdp_mesßge_c_√ây≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

428 *
sdp_mesßge_c_addπy≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

435 *
sdp_mesßge_c_addr_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

442 *
sdp_mesßge_c_addr_mu…iˇ°_âl_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

449 *
sdp_mesßge_c_addr_mu…iˇ°_öt_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

457 
sdp_mesßge_b_b™dwidth_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
bwty≥
, *
b™dwidth
);

464 
sdp_b™dwidth_t
 *
sdp_mesßge_b™dwidth_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

471 *
sdp_mesßge_b_bwty≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

478 *
sdp_mesßge_b_b™dwidth_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

485 
sdp_mesßge_t_time_des¸_add
(
sdp_mesßge_t
 *
sdp
, *
°¨t
, *
°›
);

491 *
sdp_mesßge_t_°¨t_time_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_td
);

497 *
sdp_mesßge_t_°›_time_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_td
);

504 
sdp_mesßge_r_ª≥©_add
(
sdp_mesßge_t
 *
sdp
, 
pos_time_des¸
, *
vÆue
);

511 *
sdp_mesßge_r_ª≥©_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_time_des¸
, 
pos_ª≥©
);

517 
sdp_mesßge_z_adju°míts_£t
(
sdp_mesßge_t
 *
sdp
, *
vÆue
);

522 *
sdp_mesßge_z_adju°míts_gë
(
sdp_mesßge_t
 *
sdp
);

530 
sdp_mesßge_k_key_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
keyty≥
, *
keyd©a
);

536 *
sdp_mesßge_k_keyty≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

542 *
sdp_mesßge_k_keyd©a_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

550 
sdp_mesßge_a_©åibuã_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
, *
©t_vÆue
);

557 
sdp_mesßge_a_©åibuã_dñ
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
);

565 
sdp_mesßge_a_©åibuã_dñ_©_ödex
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
, 
pos_©å
);

572 
sdp_©åibuã_t
 *
sdp_mesßge_©åibuã_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

579 *
sdp_mesßge_a_©t_fõld_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

586 *
sdp_mesßge_a_©t_vÆue_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

592 
sdp_mesßge_ídof_medü
(
sdp_mesßge_t
 *
sdp
, 
pos
);

601 
sdp_mesßge_m_medü_add
(
sdp_mesßge_t
 *
sdp
, *
medü
, *
p‹t
, *
numbî_of_p‹t
, *
¥Ÿo
);

607 *
sdp_mesßge_m_medü_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

613 *
sdp_mesßge_m_p‹t_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

620 
sdp_mesßge_m_p‹t_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
p‹t
);

626 *
sdp_mesßge_m_numbî_of_p‹t_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

632 *
sdp_mesßge_m_¥Ÿo_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
);

639 
sdp_mesßge_m_∑ylﬂd_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
∑ylﬂd
);

646 *
sdp_mesßge_m_∑ylﬂd_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

653 
sdp_mesßge_m_∑ylﬂd_dñ
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
);

657 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm.h

20 #i‚de‡
_FSM_H_


21 
	#_FSM_H_


	)

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù2/osù.h
>

26 
	~"xixt.h
"

28 #i‚de‡
DOXYGEN


30 
osù_°©emachöe
 
	tosù_°©emachöe_t
;

32 
	sosù_°©emachöe
 {

33 
_å™sôi⁄_t
 *
	må™sôi⁄s
;

42 
osù_evít_t
 *
__osù_evít_√w
(
ty≥_t
 
ty≥
, 
å™ß˘i⁄id
);

45 
ty≥_t
 
evt_£t_ty≥_öcomög_sùmesßge
(
osù_mesßge_t
 *
sù
);

46 
ty≥_t
 
evt_£t_ty≥_outgoög_sùmesßge
(
osù_mesßge_t
 *
sù
);

48 
_å™sôi⁄_t
 
	tå™sôi⁄_t
;

50 
	s_å™sôi⁄_t
 {

51 
°©e_t
 
	m°©e
;

52 
ty≥_t
 
	mty≥
;

53 (*
	mmëhod
)(*, *);

54 
_å™sôi⁄_t
 *
	m√xt
;

55 
_å™sôi⁄_t
 *
	m∑ª¡
;

58 
fsm_ˇŒmëhod
(
ty≥_t
 
ty≥
, 
°©e_t
 
°©e
, 
osù_°©emachöe_t
 *
°©emachöe
, *
sùevít
, *
å™ß˘i⁄
);

68 
i˘_¢d_övôe
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

69 
osù_i˘_timeout_a_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

70 
osù_i˘_timeout_b_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

71 
osù_i˘_timeout_d_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

72 
i˘_rcv_1xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

73 
i˘_rcv_2xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

74 
osù_mesßge_t
 *
i˘_¸óã_ack
(
osù_å™ß˘i⁄_t
 *
i˘
, osù_mesßge_à*
ª•⁄£
);

75 
i˘_rcv_3456xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

76 
i˘_ªå™smô_ack
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
);

82 
i°_rcv_övôe
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

83 
osù_i°_timeout_g_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

84 
osù_i°_timeout_h_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

85 
osù_i°_timeout_i_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

86 
i°_¢d_1xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

87 
i°_¢d_2xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

88 
i°_¢d_3456xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

89 
i°_rcv_ack
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
);

95 
ni˘_¢d_ªque°
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

96 
osù_ni˘_timeout_e_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

97 
osù_ni˘_timeout_f_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

98 
osù_ni˘_timeout_k_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

99 
ni˘_rcv_1xx
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

100 
ni˘_rcv_23456xx
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
);

108 
ni°_rcv_ªque°
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
);

109 
ni°_¢d_1xx
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
);

110 
ni°_¢d_23456xx
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
);

111 
osù_ni°_timeout_j_evít
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
);

117 
__osù_mesßge_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *, 
osù_mesßge_t
 *);

118 
__osù_kûl_å™ß˘i⁄_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *);

119 
__osù_å™•‹t_îr‹_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *, 
îr‹
);

127 
__osù_å™ß˘i⁄_£t_°©e
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
°©e_t
 
°©e
);

135 
__osù_å™ß˘i⁄_m©chög_ª•⁄£_osù_to_xi˘_17_1_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ª•
);

143 
__osù_å™ß˘i⁄_m©chög_ªque°_osù_to_xi°_17_2_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ªque°
);

145 
osù_evít_t
 *
__osù_å™ß˘i⁄_√ed_timî_x_evít
(*
xixt
, 
timevÆ
 *
timî
, 
c⁄d_°©e
, 
å™ß˘i⁄id
, 
TIMER_VAL
);

147 
__osù_å™ß˘i⁄_¢d_xxx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_mesßge_t
 *
msg
);

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm_misc.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù_fifo.h
>

22 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

25 
å™sôi⁄_t
 *
fsm_födmëhod
(
ty≥_t
 
ty≥
, 
°©e_t
 
°©e
, 
osù_°©emachöe_t
 *
°©emachöe
);

29 
å™sôi⁄_t
 *
	$fsm_födmëhod
(
ty≥_t
 
ty≥
, 
°©e_t
 
°©e
, 
osù_°©emachöe_t
 *
°©emachöe
) {

30 
å™sôi⁄_t
 *
å™sôi⁄
;

32 
å™sôi⁄
 = 
°©emachöe
->
å™sôi⁄s
;Åønsôi⁄ !
NULL
;Åønsôi⁄ =Åønsôi⁄->
√xt
) {

33 i‡(
å™sôi⁄
->
ty≥
 =ty≥ &&Åønsôi⁄->
°©e
 == state)

34  
å™sôi⁄
;

37  
NULL
;

38 
	}
}

42 
	$fsm_ˇŒmëhod
(
ty≥_t
 
ty≥
, 
°©e_t
 
°©e
, 
osù_°©emachöe_t
 *
°©emachöe
, *
sùevít
, *
å™ß˘i⁄
) {

43 
å™sôi⁄_t
 *
å™sôi⁄
;

45 
å™sôi⁄
 = 
	`fsm_födmëhod
(
ty≥
, 
°©e
, 
°©emachöe
);

47 i‡(
å™sôi⁄
 =
NULL
) {

49  
OSIP_UNDEFINED_ERROR
;

52 
å™sôi⁄
->
	`mëhod
(
å™ß˘i⁄
, 
sùevít
);

53  
OSIP_SUCCESS
;

54 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__osù_i˘_öô
(
osù_i˘_t
 **
i˘
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
övôe
) {

27 
osù_rouã_t
 *
rouã
;

28 
i
;

30 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating ICT context\n"));

32 *
i˘
 = (
osù_i˘_t
 *Ë
	`osù_mÆloc
((osip_ict_t));

34 i‡(*
i˘
 =
NULL
)

35  
OSIP_NOMEM
;

37 
	`mem£t
(*
i˘
, 0, (
osù_i˘_t
));

40 
osù_vü_t
 *
vü
;

41 *
¥Ÿo
;

43 
i
 = 
	`osù_mesßge_gë_vü
(
övôe
, 0, &
vü
);

45 i‡(
i
 < 0) {

46 
	`osù_‰ì
(*
i˘
);

47  
i
;

50 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

52 i‡(
¥Ÿo
 =
NULL
) {

53 
	`osù_‰ì
(*
i˘
);

54  
OSIP_SYNTAXERROR
;

57 #ifde‡
USE_BLOCKINGSOCKET


59 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

62 (*
i˘
)->
timî_a_Àngth
 = 
DEFAULT_T1
;

64 i‡(64 * 
DEFAULT_T1
 < 32000)

65 (*
i˘
)->
timî_d_Àngth
 = 32000;

68 (*
i˘
)->
timî_d_Àngth
 = 64 * 
DEFAULT_T1
;

70 
	`osù_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, 
NULL
);

71 
	`add_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, (*i˘)->
timî_a_Àngth
);

72 (*
i˘
)->
timî_d_°¨t
.
tv_£c
 = -1;

75 (*
i˘
)->
timî_a_Àngth
 = -1;

76 (*
i˘
)->
timî_d_Àngth
 = 0;

77 (*
i˘
)->
timî_a_°¨t
.
tv_£c
 = -1;

78 (*
i˘
)->
timî_d_°¨t
.
tv_£c
 = -1;

83 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

86 (*
i˘
)->
timî_a_Àngth
 = 
DEFAULT_T1
;

88 i‡(64 * 
DEFAULT_T1
 < 32000)

89 (*
i˘
)->
timî_d_Àngth
 = 32000;

92 (*
i˘
)->
timî_d_Àngth
 = 64 * 
DEFAULT_T1
;

94 
	`osù_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, 
NULL
);

95 
	`add_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, (*i˘)->
timî_a_Àngth
);

96 (*
i˘
)->
timî_d_°¨t
.
tv_£c
 = -1;

99 (*
i˘
)->
timî_a_Àngth
 = 
DEFAULT_T1
;

100 (*
i˘
)->
timî_d_Àngth
 = 0;

101 
	`osù_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, 
NULL
);

102 
	`add_gëtimeofday
(&(*
i˘
)->
timî_a_°¨t
, (*i˘)->
timî_a_Àngth
);

103 (*
i˘
)->
timî_d_°¨t
.
tv_£c
 = -1;

110 
	`osù_mesßge_gë_rouã
(
övôe
, 0, &
rouã
);

112 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

113 
osù_uri_∑øm_t
 *
Ã_∑øm
;

115 
	`osù_uri_u∑øm_gë_by«me
(
rouã
->
uæ
, "Ã", &
Ã_∑øm
);

117 i‡(
Ã_∑øm
 =
NULL
) {

119 
rouã
 = 
NULL
;

123 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

124 
p‹t
 = 5060;

126 i‡(
rouã
->
uæ
->
p‹t
 !
NULL
)

127 
p‹t
 = 
	`osù_©oi
(
rouã
->
uæ
->port);

129 
	`osù_i˘_£t_de°ö©i⁄
((*
i˘
), 
	`osù_°rdup
(
rouã
->
uæ
->
ho°
), 
p‹t
);

132 
p‹t
 = 5060;

135 
osù_uri_∑øm_t
 *
maddr_∑øm
 = 
NULL
;

136 
osù_uri_∑øm_t
 *
obr_∑øm
 = 
NULL
;

137 
osù_uri_∑øm_t
 *
obp_∑øm
 = 
NULL
;

139 
p‹t
 = 5060;

141 i‡(
övôe
->
ªq_uri
->
p‹t
 !
NULL
)

142 
p‹t
 = 
	`osù_©oi
(
övôe
->
ªq_uri
->port);

146 
	`osù_uri_u∑øm_gë_by«me
(
övôe
->
ªq_uri
, "x-obr", &
obr_∑øm
);

147 
	`osù_uri_u∑øm_gë_by«me
(
övôe
->
ªq_uri
, "x-obp", &
obp_∑øm
);

149 
	`osù_uri_u∑øm_gë_by«me
(
övôe
->
ªq_uri
, "maddr", &
maddr_∑øm
);

151 i‡(
maddr_∑øm
 !
NULL
 && maddr_∑øm->
gvÆue
 != NULL)

152 
	`osù_i˘_£t_de°ö©i⁄
((*
i˘
), 
	`osù_°rdup
(
maddr_∑øm
->
gvÆue
), 
p‹t
);

154 i‡(
obr_∑øm
 !
NULL
 && obr_∑øm->
gvÆue
 !NULL && 
obp_∑øm
 != NULL && obp_param->gvalue != NULL)

155 
	`osù_i˘_£t_de°ö©i⁄
((*
i˘
), 
	`osù_°rdup
(
obr_∑øm
->
gvÆue
), 
	`osù_©oi
(
obp_∑øm
->gvalue));

158 
	`osù_i˘_£t_de°ö©i⁄
((*
i˘
), 
	`osù_°rdup
(
övôe
->
ªq_uri
->
ho°
), 
p‹t
);

161 (*
i˘
)->
timî_b_Àngth
 = 64 * 
DEFAULT_T1
;

162 
	`osù_gëtimeofday
(&(*
i˘
)->
timî_b_°¨t
, 
NULL
);

163 
	`add_gëtimeofday
(&(*
i˘
)->
timî_b_°¨t
, (*i˘)->
timî_b_Àngth
);

168  
OSIP_SUCCESS
;

169 
	}
}

171 
	$__osù_i˘_‰ì
(
osù_i˘_t
 *
i˘
) {

172 i‡(
i˘
 =
NULL
)

173  
OSIP_SUCCESS
;

175 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free ictÑesource\n"));

177 
	`osù_‰ì
(
i˘
->
de°ö©i⁄
);

178 
	`osù_‰ì
(
i˘
);

179  
OSIP_SUCCESS
;

180 
	}
}

182 
	$osù_i˘_£t_de°ö©i⁄
(
osù_i˘_t
 *
i˘
, *
de°ö©i⁄
, 
p‹t
) {

183 i‡(
i˘
 =
NULL
)

184  
OSIP_BADPARAMETER
;

186 i‡(
i˘
->
de°ö©i⁄
 !
NULL
)

187 
	`osù_‰ì
(
i˘
->
de°ö©i⁄
);

189 
i˘
->
de°ö©i⁄
 = destination;

190 
i˘
->
p‹t
 =Öort;

191  
OSIP_SUCCESS
;

192 
	}
}

194 
osù_evít_t
 *
	$__osù_i˘_√ed_timî_a_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

195  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i˘
, &i˘->
timî_a_°¨t
, 
°©e
 =
ICT_CALLING
, 
å™ß˘i⁄id
, 
TIMEOUT_A
);

196 
	}
}

198 
osù_evít_t
 *
	$__osù_i˘_√ed_timî_b_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

199  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i˘
, &i˘->
timî_b_°¨t
, 
°©e
 =
ICT_CALLING
, 
å™ß˘i⁄id
, 
TIMEOUT_B
);

200 
	}
}

202 
osù_evít_t
 *
	$__osù_i˘_√ed_timî_d_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

203  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i˘
, &i˘->
timî_d_°¨t
, 
°©e
 =
ICT_COMPLETED
, 
å™ß˘i⁄id
, 
TIMEOUT_D
);

204 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict_fsm.c

20 
	~<osù2/öã∫Æ.h
>

22 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
å™sôi⁄_t
 
	gi˘_å™sôi⁄
[11] = {{
ICT_PRE_CALLING
, 
SND_REQINVITE
, ((*)(*, *)Ë& 
i˘_¢d_övôe
, &
i˘_å™sôi⁄
[1], 
NULL
},

27 {
ICT_CALLING
, 
TIMEOUT_A
, ((*)(*, *)Ë& 
osù_i˘_timeout_a_evít
, &
i˘_å™sôi⁄
[2], 
NULL
},

28 {
ICT_CALLING
, 
TIMEOUT_B
, ((*)(*, *)Ë& 
osù_i˘_timeout_b_evít
, &
i˘_å™sôi⁄
[3], 
NULL
},

29 {
ICT_CALLING
, 
RCV_STATUS_1XX
, ((*)(*, *)Ë& 
i˘_rcv_1xx
, &
i˘_å™sôi⁄
[4], 
NULL
},

30 {
ICT_CALLING
, 
RCV_STATUS_2XX
, ((*)(*, *)Ë& 
i˘_rcv_2xx
, &
i˘_å™sôi⁄
[5], 
NULL
},

31 {
ICT_CALLING
, 
RCV_STATUS_3456XX
, ((*)(*, *)Ë& 
i˘_rcv_3456xx
, &
i˘_å™sôi⁄
[6], 
NULL
},

32 {
ICT_PROCEEDING
, 
RCV_STATUS_1XX
, ((*)(*, *)Ë& 
i˘_rcv_1xx
, &
i˘_å™sôi⁄
[7], 
NULL
},

33 {
ICT_PROCEEDING
, 
RCV_STATUS_2XX
, ((*)(*, *)Ë& 
i˘_rcv_2xx
, &
i˘_å™sôi⁄
[8], 
NULL
},

34 {
ICT_PROCEEDING
, 
RCV_STATUS_3456XX
, ((*)(*, *)Ë& 
i˘_rcv_3456xx
, &
i˘_å™sôi⁄
[9], 
NULL
},

35 {
ICT_COMPLETED
, 
RCV_STATUS_3456XX
, ((*)(*, *)Ë& 
i˘_ªå™smô_ack
, &
i˘_å™sôi⁄
[10], 
NULL
},

36 {
ICT_COMPLETED
, 
TIMEOUT_D
, ((*)(*, *)Ë& 
osù_i˘_timeout_d_evít
, 
NULL
, NULL}};

38 
osù_°©emachöe_t
 
	gi˘_fsm
 = {
i˘_å™sôi⁄
};

40 
	$i˘_h™dÀ_å™•‹t_îr‹
(
osù_å™ß˘i⁄_t
 *
i˘
, 
îr
) {

41 
	`__osù_å™•‹t_îr‹_ˇŒback
(
OSIP_ICT_TRANSPORT_ERROR
, 
i˘
, 
îr
);

42 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_TERMINATED
);

43 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_ICT_KILL_TRANSACTION
, 
i˘
);

45 
	}
}

47 
	$i˘_¢d_övôe
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

48 
i
;

49 
osù_t
 *
osù
 = (osù_à*Ë
i˘
->
c⁄fig
;

52 
i˘
->
‹ig_ªque°
 = 
evt
->
sù
;

54 
i
 = 
osù
->
	`cb_£nd_mesßge
(
i˘
, 
evt
->
sù
, i˘->
i˘_c⁄ãxt
->
de°ö©i⁄
, i˘->i˘_c⁄ãxt->
p‹t
, i˘->
out_sockë
);

56 i‡(
i
 < 0) {

57 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

61 #i‚de‡
USE_BLOCKINGSOCKET


67 i‡(
i
 == 0) {

68 
osù_vü_t
 *
vü
;

69 *
¥Ÿo
;

71 
i
 = 
	`osù_mesßge_gë_vü
(
i˘
->
‹ig_ªque°
, 0, &
vü
);

73 i‡(
i
 < 0) {

74 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

78 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

80 i‡(
¥Ÿo
 =
NULL
) {

81 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

85 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

87 
i˘
->
i˘_c⁄ãxt
->
timî_a_Àngth
 = -1;

88 
i˘
->
i˘_c⁄ãxt
->
timî_a_°¨t
.
tv_£c
 = -1;

94 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_INVITE_SENT
, 
i˘
, i˘->
‹ig_ªque°
);

95 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_CALLING
);

96 
	}
}

98 
	$osù_i˘_timeout_a_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

99 
osù_t
 *
osù
 = (osù_à*Ë
i˘
->
c⁄fig
;

100 
i
;

103 
i˘
->
i˘_c⁄ãxt
->
timî_a_Àngth
 = ict->ict_context->timer_a_length * 2;

104 
	`osù_gëtimeofday
(&
i˘
->
i˘_c⁄ãxt
->
timî_a_°¨t
, 
NULL
);

105 
	`add_gëtimeofday
(&
i˘
->
i˘_c⁄ãxt
->
timî_a_°¨t
, i˘->i˘_c⁄ãxt->
timî_a_Àngth
);

108 
i
 = 
osù
->
	`cb_£nd_mesßge
(
i˘
, i˘->
‹ig_ªque°
, i˘->
i˘_c⁄ãxt
->
de°ö©i⁄
, i˘->i˘_c⁄ãxt->
p‹t
, i˘->
out_sockë
);

110 i‡(
i
 < 0) {

111 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

115 #i‚de‡
USE_BLOCKINGSOCKET


121 i‡(
i
 == 0) {

122 
osù_vü_t
 *
vü
;

123 *
¥Ÿo
;

125 
i
 = 
	`osù_mesßge_gë_vü
(
i˘
->
‹ig_ªque°
, 0, &
vü
);

127 i‡(
i
 < 0) {

128 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

132 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

134 i‡(
¥Ÿo
 =
NULL
) {

135 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

139 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

141 
i˘
->
i˘_c⁄ãxt
->
timî_a_Àngth
 = -1;

142 
i˘
->
i˘_c⁄ãxt
->
timî_a_°¨t
.
tv_£c
 = -1;

148 i‡(
i
 == 0)

149 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_INVITE_SENT_AGAIN
, 
i˘
, i˘->
‹ig_ªque°
);

150 
	}
}

152 
	$osù_i˘_timeout_b_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

153 
i˘
->
i˘_c⁄ãxt
->
timî_b_Àngth
 = -1;

154 
i˘
->
i˘_c⁄ãxt
->
timî_b_°¨t
.
tv_£c
 = -1;

156 i‡(
i˘
->
out_sockë
 == -999) {

157 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, -1);

159 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_TIMEOUT
, 
i˘
, 
evt
->
sù
);

160 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_TERMINATED
);

161 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_ICT_KILL_TRANSACTION
, 
i˘
);

163 
	}
}

165 
	$i˘_rcv_1xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

168 i‡(
i˘
->
œ°_ª•⁄£
 !
NULL
) {

169 
	`osù_mesßge_‰ì
(
i˘
->
œ°_ª•⁄£
);

172 
i˘
->
œ°_ª•⁄£
 = 
evt
->
sù
;

173 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_1XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

174 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_PROCEEDING
);

175 
	}
}

177 
	$i˘_rcv_2xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

180 i‡(
i˘
->
œ°_ª•⁄£
 !
NULL
) {

181 
	`osù_mesßge_‰ì
(
i˘
->
œ°_ª•⁄£
);

184 
i˘
->
œ°_ª•⁄£
 = 
evt
->
sù
;

186 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_2XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

188 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_TERMINATED
);

189 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_ICT_KILL_TRANSACTION
, 
i˘
);

190 
	}
}

192 
osù_mesßge_t
 *
	$i˘_¸óã_ack
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_mesßge_t
 *
ª•⁄£
) {

193 
i
;

194 
osù_mesßge_t
 *
ack
;

196 
i
 = 
	`osù_mesßge_öô
(&
ack
);

198 i‡(
i
 != 0)

199  
NULL
;

202 
i
 = 
	`osù_‰om_˛⁄e
(
ª•⁄£
->
‰om
, &(
ack
->from));

204 i‡(
i
 != 0) {

205 
	`osù_mesßge_‰ì
(
ack
);

206  
NULL
;

209 
i
 = 
	`osù_to_˛⁄e
(
ª•⁄£
->
to
, &(
ack
->to));

211 i‡(
i
 != 0) {

212 
	`osù_mesßge_‰ì
(
ack
);

213  
NULL
;

216 
i
 = 
	`osù_ˇŒ_id_˛⁄e
(
ª•⁄£
->
ˇŒ_id
, &(
ack
->call_id));

218 i‡(
i
 != 0) {

219 
	`osù_mesßge_‰ì
(
ack
);

220  
NULL
;

223 
i
 = 
	`osù_c£q_˛⁄e
(
ª•⁄£
->
c£q
, &(
ack
->cseq));

225 i‡(
i
 != 0) {

226 
	`osù_mesßge_‰ì
(
ack
);

227  
NULL
;

230 
	`osù_‰ì
(
ack
->
c£q
->
mëhod
);

231 
ack
->
c£q
->
mëhod
 = 
	`osù_°rdup
("ACK");

233 i‡(
ack
->
c£q
->
mëhod
 =
NULL
) {

234 
	`osù_mesßge_‰ì
(
ack
);

235  
NULL
;

238 
ack
->
sù_mëhod
 = (*Ë
	`osù_mÆloc
(5);

240 i‡(
ack
->
sù_mëhod
 =
NULL
) {

241 
	`osù_mesßge_‰ì
(
ack
);

242  
NULL
;

245 
	`•rötf
(
ack
->
sù_mëhod
, "ACK");

246 
ack
->
sù_vîsi⁄
 = 
	`osù_°rdup
(
i˘
->
‹ig_ªque°
->sip_version);

248 i‡(
ack
->
sù_vîsi⁄
 =
NULL
) {

249 
	`osù_mesßge_‰ì
(
ack
);

250  
NULL
;

253 
ack
->
°©us_code
 = 0;

254 
ack
->
ªas⁄_phø£
 = 
NULL
;

257 
i
 = 
	`osù_uri_˛⁄e
(
i˘
->
‹ig_ªque°
->
ªq_uri
, &(
ack
->req_uri));

259 i‡(
i
 != 0) {

260 
	`osù_mesßge_‰ì
(
ack
);

261  
NULL
;

266 
osù_vü_t
 *
vü
;

267 
osù_vü_t
 *
‹ig_vü
;

269 
	`osù_mesßge_gë_vü
(
i˘
->
‹ig_ªque°
, 0, &
‹ig_vü
);

271 i‡(
‹ig_vü
 =
NULL
) {

272 
	`osù_mesßge_‰ì
(
ack
);

273  
NULL
;

276 
i
 = 
	`osù_vü_˛⁄e
(
‹ig_vü
, &
vü
);

278 i‡(
i
 != 0) {

279 
	`osù_mesßge_‰ì
(
ack
);

280  
NULL
;

283 
	`osù_li°_add
(&
ack
->
vüs
, 
vü
, -1);

291 
pos
 = 0;

292 
osù_rouã_t
 *
rouã
;

293 
osù_rouã_t
 *
‹ig_rouã
;

295 !
	`osù_li°_eﬁ
(&
i˘
->
‹ig_ªque°
->
rouãs
, 
pos
)) {

296 
‹ig_rouã
 = (
osù_rouã_t
 *Ë
	`osù_li°_gë
(&
i˘
->
‹ig_ªque°
->
rouãs
, 
pos
);

297 
i
 = 
	`osù_rouã_˛⁄e
(
‹ig_rouã
, &
rouã
);

299 i‡(
i
 != 0) {

300 
	`osù_mesßge_‰ì
(
ack
);

301  
NULL
;

304 
	`osù_li°_add
(&
ack
->
rouãs
, 
rouã
, -1);

305 
pos
++;

309 i‡(
ª•⁄£
->
°©us_code
 != 401 &&Ñesponse->status_code != 407) {

311 i‡(
	`osù_li°_size
(&
i˘
->
‹ig_ªque°
->
auth‹iz©i⁄s
) > 0) {

312 
i
 = 
	`osù_li°_˛⁄e
(&
i˘
->
‹ig_ªque°
->
auth‹iz©i⁄s
, &
ack
->auth‹iz©i⁄s, ((*)(*, **)Ë& 
osù_auth‹iz©i⁄_˛⁄e
);

314 i‡(
i
 != 0) {

315 
	`osù_mesßge_‰ì
(
ack
);

316  
NULL
;

321 i‡(
	`osù_li°_size
(&
i˘
->
‹ig_ªque°
->
¥oxy_auth‹iz©i⁄s
) > 0) {

322 
i
 = 
	`osù_li°_˛⁄e
(&
i˘
->
‹ig_ªque°
->
¥oxy_auth‹iz©i⁄s
, &
ack
->¥oxy_auth‹iz©i⁄s, ((*)(*, **)Ë& 
osù_¥oxy_auth‹iz©i⁄_˛⁄e
);

324 i‡(
i
 != 0) {

325 
	`osù_mesßge_‰ì
(
ack
);

326  
NULL
;

334  
ack
;

335 
	}
}

337 
	$i˘_rcv_3456xx
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

338 
osù_rouã_t
 *
rouã
;

339 
i
;

340 
osù_t
 *
osù
 = (osù_à*Ë
i˘
->
c⁄fig
;

344 i‡(
i˘
->
œ°_ª•⁄£
 !
NULL
)

345 
	`osù_mesßge_‰ì
(
i˘
->
œ°_ª•⁄£
);

347 
i˘
->
œ°_ª•⁄£
 = 
evt
->
sù
;

349 i‡(
i˘
->
°©e
 !
ICT_COMPLETED
) {

351 
osù_mesßge_t
 *
ack
 = 
	`i˘_¸óã_ack
(
i˘
, 
evt
->
sù
);

353 
i˘
->
ack
 =áck;

355 i‡(
i˘
->
ack
 =
NULL
) {

356 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_TERMINATED
);

357 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_ICT_KILL_TRANSACTION
, 
i˘
);

363 i‡(
i˘
->
i˘_c⁄ãxt
->
de°ö©i⁄
 =
NULL
) {

364 
	`osù_mesßge_gë_rouã
(
ack
, 0, &
rouã
);

366 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

367 
osù_uri_∑øm_t
 *
Ã_∑øm
;

369 
	`osù_uri_u∑øm_gë_by«me
(
rouã
->
uæ
, "Ã", &
Ã_∑øm
);

371 i‡(
Ã_∑øm
 =
NULL
) {

373 
rouã
 = 
NULL
;

377 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

378 
p‹t
 = 5060;

380 i‡(
rouã
->
uæ
->
p‹t
 !
NULL
)

381 
p‹t
 = 
	`osù_©oi
(
rouã
->
uæ
->port);

383 
	`osù_i˘_£t_de°ö©i⁄
(
i˘
->
i˘_c⁄ãxt
, 
	`osù_°rdup
(
rouã
->
uæ
->
ho°
), 
p‹t
);

386 
p‹t
 = 5060;

389 
osù_uri_∑øm_t
 *
maddr_∑øm
 = 
NULL
;

390 
osù_uri_∑øm_t
 *
obr_∑øm
 = 
NULL
;

391 
osù_uri_∑øm_t
 *
obp_∑øm
 = 
NULL
;

393 
p‹t
 = 5060;

395 i‡(
ack
->
ªq_uri
->
p‹t
 !
NULL
)

396 
p‹t
 = 
	`osù_©oi
(
ack
->
ªq_uri
->port);

400 
	`osù_uri_u∑øm_gë_by«me
(
ack
->
ªq_uri
, "x-obr", &
obr_∑øm
);

401 
	`osù_uri_u∑øm_gë_by«me
(
ack
->
ªq_uri
, "x-obp", &
obp_∑øm
);

403 
	`osù_uri_u∑øm_gë_by«me
(
ack
->
ªq_uri
, "maddr", &
maddr_∑øm
);

405 i‡(
maddr_∑øm
 !
NULL
 && maddr_∑øm->
gvÆue
 != NULL)

406 
	`osù_i˘_£t_de°ö©i⁄
(
i˘
->
i˘_c⁄ãxt
, 
	`osù_°rdup
(
maddr_∑øm
->
gvÆue
), 
p‹t
);

408 i‡(
obr_∑øm
 !
NULL
 && obr_∑øm->
gvÆue
 !NULL && 
obp_∑øm
 != NULL && obp_param->gvalue != NULL)

409 
	`osù_i˘_£t_de°ö©i⁄
(
i˘
->
i˘_c⁄ãxt
, 
	`osù_°rdup
(
obr_∑øm
->
gvÆue
), 
	`osù_©oi
(
obp_∑øm
->gvalue));

412 
	`osù_i˘_£t_de°ö©i⁄
(
i˘
->
i˘_c⁄ãxt
, 
	`osù_°rdup
(
ack
->
ªq_uri
->
ho°
), 
p‹t
);

416 
i
 = 
osù
->
	`cb_£nd_mesßge
(
i˘
, 
ack
, i˘->
i˘_c⁄ãxt
->
de°ö©i⁄
, i˘->i˘_c⁄ãxt->
p‹t
, i˘->
out_sockë
);

418 i‡(
i
 != 0) {

419 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

423 i‡(
	`MSG_IS_STATUS_3XX
(
evt
->
sù
))

424 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_3XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

426 i‡(
	`MSG_IS_STATUS_4XX
(
evt
->
sù
))

427 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_4XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

429 i‡(
	`MSG_IS_STATUS_5XX
(
evt
->
sù
))

430 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_5XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

433 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_6XX_RECEIVED
, 
i˘
, 
evt
->
sù
);

435 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_ACK_SENT
, 
i˘
, 
ack
);

439 
	`osù_gëtimeofday
(&
i˘
->
i˘_c⁄ãxt
->
timî_d_°¨t
, 
NULL
);

440 
	`add_gëtimeofday
(&
i˘
->
i˘_c⁄ãxt
->
timî_d_°¨t
, i˘->i˘_c⁄ãxt->
timî_d_Àngth
);

441 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_COMPLETED
);

442 
	}
}

444 
	$osù_i˘_timeout_d_evít
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

445 
i˘
->
i˘_c⁄ãxt
->
timî_d_Àngth
 = -1;

446 
i˘
->
i˘_c⁄ãxt
->
timî_d_°¨t
.
tv_£c
 = -1;

448 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_TERMINATED
);

449 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_ICT_KILL_TRANSACTION
, 
i˘
);

450 
	}
}

452 
	$i˘_ªå™smô_ack
(
osù_å™ß˘i⁄_t
 *
i˘
, 
osù_evít_t
 *
evt
) {

453 
i
;

454 
osù_t
 *
osù
 = (osù_à*Ë
i˘
->
c⁄fig
;

460 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_STATUS_3456XX_RECEIVED_AGAIN
, 
i˘
, 
evt
->
sù
);

462 
	`osù_mesßge_‰ì
(
evt
->
sù
);

464 
i
 = 
osù
->
	`cb_£nd_mesßge
(
i˘
, i˘->
ack
, i˘->
i˘_c⁄ãxt
->
de°ö©i⁄
, i˘->i˘_c⁄ãxt->
p‹t
, i˘->
out_sockë
);

466 i‡(
i
 == 0) {

467 
	`__osù_mesßge_ˇŒback
(
OSIP_ICT_ACK_SENT_AGAIN
, 
i˘
, i˘->
ack
);

468 
	`__osù_å™ß˘i⁄_£t_°©e
(
i˘
, 
ICT_COMPLETED
);

471 
	`i˘_h™dÀ_å™•‹t_îr‹
(
i˘
, 
i
);

473 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

25 
	$__osù_i°_öô
(
osù_i°_t
 **
i°
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
övôe
) {

26 
i
;

28 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating IST context\n"));

30 *
i°
 = (
osù_i°_t
 *Ë
	`osù_mÆloc
((osip_ist_t));

32 i‡(*
i°
 =
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
i°
, 0, (
osù_i°_t
));

38 
osù_vü_t
 *
vü
;

39 *
¥Ÿo
;

41 
i
 = 
	`osù_mesßge_gë_vü
(
övôe
, 0, &
vü
);

43 i‡(
i
 < 0) {

44 
	`osù_‰ì
(*
i°
);

45 *
i°
 = 
NULL
;

46  
i
;

49 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

51 i‡(
¥Ÿo
 =
NULL
) {

52 
	`osù_‰ì
(*
i°
);

53 *
i°
 = 
NULL
;

54  
OSIP_UNDEFINED_ERROR
;

57 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

60 (*
i°
)->
timî_g_Àngth
 = 
DEFAULT_T1
;

61 (*
i°
)->
timî_i_Àngth
 = 
DEFAULT_T4
;

62 (*
i°
)->
timî_g_°¨t
.
tv_£c
 = -1;

63 (*
i°
)->
timî_i_°¨t
.
tv_£c
 = -1;

66 (*
i°
)->
timî_g_Àngth
 = -1;

67 (*
i°
)->
timî_i_Àngth
 = 0;

68 (*
i°
)->
timî_g_°¨t
.
tv_£c
 = -1;

69 (*
i°
)->
timî_i_°¨t
.
tv_£c
 = -1;

73 (*
i°
)->
timî_h_Àngth
 = 64 * 
DEFAULT_T1
;

74 (*
i°
)->
timî_h_°¨t
.
tv_£c
 = -1;

76  
OSIP_SUCCESS
;

77 
	}
}

79 
	$__osù_i°_‰ì
(
osù_i°_t
 *
i°
) {

80 i‡(
i°
 =
NULL
)

81  
OSIP_SUCCESS
;

83 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free istÑesource\n"));

84 
	`osù_‰ì
(
i°
);

85  
OSIP_SUCCESS
;

86 
	}
}

88 
osù_evít_t
 *
	$__osù_i°_√ed_timî_g_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

89  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i°
, &i°->
timî_g_°¨t
, 
°©e
 =
IST_COMPLETED
, 
å™ß˘i⁄id
, 
TIMEOUT_G
);

90 
	}
}

92 
osù_evít_t
 *
	$__osù_i°_√ed_timî_h_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

93  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i°
, &i°->
timî_h_°¨t
, 
°©e
 =
IST_COMPLETED
, 
å™ß˘i⁄id
, 
TIMEOUT_H
);

94 
	}
}

96 
osù_evít_t
 *
	$__osù_i°_√ed_timî_i_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

97  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
i°
, &i°->
timî_i_°¨t
, 
°©e
 =
IST_CONFIRMED
, 
å™ß˘i⁄id
, 
TIMEOUT_I
);

98 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist_fsm.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

25 
å™sôi⁄_t
 
	gi°_å™sôi⁄
[11] = {{
IST_PRE_PROCEEDING
, 
RCV_REQINVITE
, ((*)(*, *)Ë& 
i°_rcv_övôe
, &
i°_å™sôi⁄
[1], 
NULL
},

26 {
IST_PROCEEDING
, 
RCV_REQINVITE
, ((*)(*, *)Ë& 
i°_rcv_övôe
, &
i°_å™sôi⁄
[2], 
NULL
},

27 {
IST_COMPLETED
, 
RCV_REQINVITE
, ((*)(*, *)Ë& 
i°_rcv_övôe
, &
i°_å™sôi⁄
[3], 
NULL
},

28 {
IST_COMPLETED
, 
TIMEOUT_G
, ((*)(*, *)Ë& 
osù_i°_timeout_g_evít
, &
i°_å™sôi⁄
[4], 
NULL
},

29 {
IST_COMPLETED
, 
TIMEOUT_H
, ((*)(*, *)Ë& 
osù_i°_timeout_h_evít
, &
i°_å™sôi⁄
[5], 
NULL
},

30 {
IST_PROCEEDING
, 
SND_STATUS_1XX
, ((*)(*, *)Ë& 
i°_¢d_1xx
, &
i°_å™sôi⁄
[6], 
NULL
},

31 {
IST_PROCEEDING
, 
SND_STATUS_2XX
, ((*)(*, *)Ë& 
i°_¢d_2xx
, &
i°_å™sôi⁄
[7], 
NULL
},

32 {
IST_PROCEEDING
, 
SND_STATUS_3456XX
, ((*)(*, *)Ë& 
i°_¢d_3456xx
, &
i°_å™sôi⁄
[8], 
NULL
},

33 {
IST_COMPLETED
, 
RCV_REQACK
, ((*)(*, *)Ë& 
i°_rcv_ack
, &
i°_å™sôi⁄
[9], 
NULL
},

34 {
IST_CONFIRMED
, 
RCV_REQACK
, ((*)(*, *)Ë& 
i°_rcv_ack
, &
i°_å™sôi⁄
[10], 
NULL
},

35 {
IST_CONFIRMED
, 
TIMEOUT_I
, ((*)(*, *)Ë& 
osù_i°_timeout_i_evít
, 
NULL
, NULL}};

37 
osù_°©emachöe_t
 
	gi°_fsm
 = {
i°_å™sôi⁄
};

39 
	$i°_h™dÀ_å™•‹t_îr‹
(
osù_å™ß˘i⁄_t
 *
i°
, 
îr
) {

40 
	`__osù_å™•‹t_îr‹_ˇŒback
(
OSIP_IST_TRANSPORT_ERROR
, 
i°
, 
îr
);

41 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_TERMINATED
);

42 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_IST_KILL_TRANSACTION
, 
i°
);

44 
	}
}

46 
	$i°_rcv_övôe
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

47 
i
;

49 i‡(
i°
->
°©e
 =
IST_PRE_PROCEEDING
) {

51 
i°
->
‹ig_ªque°
 = 
evt
->
sù
;

53 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_INVITE_RECEIVED
, 
i°
, 
evt
->
sù
);

58 
	`osù_mesßge_‰ì
(
evt
->
sù
);

60 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_INVITE_RECEIVED_AGAIN
, 
i°
, i°->
‹ig_ªque°
);

62 i‡(
i°
->
œ°_ª•⁄£
 !
NULL
) {

63 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
i°
, i°->
œ°_ª•⁄£
);

65 i‡(
i
 != 0) {

66 
	`i°_h™dÀ_å™•‹t_îr‹
(
i°
, 
i
);

70 i‡(
	`MSG_IS_STATUS_1XX
(
i°
->
œ°_ª•⁄£
))

71 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_1XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

73 i‡(
	`MSG_IS_STATUS_2XX
(
i°
->
œ°_ª•⁄£
))

74 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_2XX_SENT_AGAIN
, 
i°
, i°->
œ°_ª•⁄£
);

77 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_3456XX_SENT_AGAIN
, 
i°
, i°->
œ°_ª•⁄£
);

85 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_PROCEEDING
);

86 
	}
}

88 
	$osù_i°_timeout_g_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

89 
i
;

91 
i°
->
i°_c⁄ãxt
->
timî_g_Àngth
 = ist->ist_context->timer_g_length * 2;

93 i‡(
i°
->
i°_c⁄ãxt
->
timî_g_Àngth
 > 
DEFAULT_T2
)

94 
i°
->
i°_c⁄ãxt
->
timî_g_Àngth
 = 
DEFAULT_T2
;

96 
	`osù_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_g_°¨t
, 
NULL
);

97 
	`add_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_g_°¨t
, i°->i°_c⁄ãxt->
timî_g_Àngth
);

99 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
i°
, i°->
œ°_ª•⁄£
);

101 i‡(
i
 != 0) {

102 
	`i°_h™dÀ_å™•‹t_îr‹
(
i°
, 
i
);

106 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_3456XX_SENT_AGAIN
, 
i°
, i°->
œ°_ª•⁄£
);

107 
	}
}

109 
	$osù_i°_timeout_h_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

110 
i°
->
i°_c⁄ãxt
->
timî_h_Àngth
 = -1;

111 
i°
->
i°_c⁄ãxt
->
timî_h_°¨t
.
tv_£c
 = -1;

113 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_TERMINATED
);

114 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_IST_KILL_TRANSACTION
, 
i°
);

115 
	}
}

117 
	$osù_i°_timeout_i_evít
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

118 
i°
->
i°_c⁄ãxt
->
timî_i_Àngth
 = -1;

119 
i°
->
i°_c⁄ãxt
->
timî_i_°¨t
.
tv_£c
 = -1;

121 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_TERMINATED
);

122 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_IST_KILL_TRANSACTION
, 
i°
);

123 
	}
}

125 
	$i°_¢d_1xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

126 
i
;

128 i‡(
i°
->
œ°_ª•⁄£
 !
NULL
) {

129 
	`osù_mesßge_‰ì
(
i°
->
œ°_ª•⁄£
);

132 
i°
->
œ°_ª•⁄£
 = 
evt
->
sù
;

134 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
i°
, 
evt
->
sù
);

136 i‡(
i
 != 0) {

137 
	`i°_h™dÀ_å™•‹t_îr‹
(
i°
, 
i
);

141 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_1XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

145 
	}
}

147 
	$i°_¢d_2xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

148 
i
;

150 i‡(
i°
->
œ°_ª•⁄£
 !
NULL
) {

151 
	`osù_mesßge_‰ì
(
i°
->
œ°_ª•⁄£
);

154 
i°
->
œ°_ª•⁄£
 = 
evt
->
sù
;

156 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
i°
, 
evt
->
sù
);

158 i‡(
i
 != 0) {

159 
	`i°_h™dÀ_å™•‹t_îr‹
(
i°
, 
i
);

163 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_2XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

164 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_TERMINATED
);

165 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_IST_KILL_TRANSACTION
, 
i°
);

169 
	}
}

171 
	$i°_¢d_3456xx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

172 
i
;

174 i‡(
i°
->
œ°_ª•⁄£
 !
NULL
) {

175 
	`osù_mesßge_‰ì
(
i°
->
œ°_ª•⁄£
);

178 
i°
->
œ°_ª•⁄£
 = 
evt
->
sù
;

180 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
i°
, 
evt
->
sù
);

182 i‡(
i
 != 0) {

183 
	`i°_h™dÀ_å™•‹t_îr‹
(
i°
, 
i
);

187 i‡(
	`MSG_IS_STATUS_3XX
(
i°
->
œ°_ª•⁄£
))

188 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_3XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

190 i‡(
	`MSG_IS_STATUS_4XX
(
i°
->
œ°_ª•⁄£
))

191 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_4XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

193 i‡(
	`MSG_IS_STATUS_5XX
(
i°
->
œ°_ª•⁄£
))

194 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_5XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

197 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_STATUS_6XX_SENT
, 
i°
, i°->
œ°_ª•⁄£
);

200 i‡(
i°
->
i°_c⁄ãxt
->
timî_g_Àngth
 != -1) {

201 
	`osù_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_g_°¨t
, 
NULL
);

202 
	`add_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_g_°¨t
, i°->i°_c⁄ãxt->
timî_g_Àngth
);

205 
	`osù_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_h_°¨t
, 
NULL
);

206 
	`add_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_h_°¨t
, i°->i°_c⁄ãxt->
timî_h_Àngth
);

207 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_COMPLETED
);

209 
	}
}

211 
	$i°_rcv_ack
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_evít_t
 *
evt
) {

212 i‡(
i°
->
ack
 !
NULL
) {

213 
	`osù_mesßge_‰ì
(
i°
->
ack
);

216 
i°
->
ack
 = 
evt
->
sù
;

218 i‡(
i°
->
°©e
 =
IST_COMPLETED
)

219 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_ACK_RECEIVED
, 
i°
, i°->
ack
);

222 
	`__osù_mesßge_ˇŒback
(
OSIP_IST_ACK_RECEIVED_AGAIN
, 
i°
, i°->
ack
);

225 
	`osù_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_i_°¨t
, 
NULL
);

226 
	`add_gëtimeofday
(&
i°
->
i°_c⁄ãxt
->
timî_i_°¨t
, i°->i°_c⁄ãxt->
timî_i_Àngth
);

227 
	`__osù_å™ß˘i⁄_£t_°©e
(
i°
, 
IST_CONFIRMED
);

228 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__osù_ni˘_öô
(
osù_ni˘_t
 **
ni˘
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
ªque°
) {

27 
osù_rouã_t
 *
rouã
;

28 
i
;

30 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating NICT context\n"));

32 *
ni˘
 = (
osù_ni˘_t
 *Ë
	`osù_mÆloc
((osip_nict_t));

34 i‡(*
ni˘
 =
NULL
)

35  
OSIP_NOMEM
;

37 
	`mem£t
(*
ni˘
, 0, (
osù_ni˘_t
));

40 
osù_vü_t
 *
vü
;

41 *
¥Ÿo
;

43 
i
 = 
	`osù_mesßge_gë_vü
(
ªque°
, 0, &
vü
);

45 i‡(
i
 < 0) {

46 
	`osù_‰ì
(*
ni˘
);

47 *
ni˘
 = 
NULL
;

48  
i
;

51 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

53 i‡(
¥Ÿo
 =
NULL
) {

54 
	`osù_‰ì
(*
ni˘
);

55 *
ni˘
 = 
NULL
;

56  
OSIP_UNDEFINED_ERROR
;

59 #ifde‡
USE_BLOCKINGSOCKET


61 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

62 (*
ni˘
)->
timî_e_Àngth
 = 
DEFAULT_T1
;

63 (*
ni˘
)->
timî_k_Àngth
 = 
DEFAULT_T4
;

64 (*
ni˘
)->
timî_e_°¨t
.
tv_£c
 = -1;

65 (*
ni˘
)->
timî_k_°¨t
.
tv_£c
 = -1;

68 (*
ni˘
)->
timî_e_Àngth
 = -1;

69 (*
ni˘
)->
timî_k_Àngth
 = 0;

70 (*
ni˘
)->
timî_e_°¨t
.
tv_£c
 = -1;

71 (*
ni˘
)->
timî_k_°¨t
.
tv_£c
 = -1;

76 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

77 (*
ni˘
)->
timî_e_Àngth
 = 
DEFAULT_T1
;

78 (*
ni˘
)->
timî_k_Àngth
 = 
DEFAULT_T4
;

79 (*
ni˘
)->
timî_e_°¨t
.
tv_£c
 = -1;

80 (*
ni˘
)->
timî_k_°¨t
.
tv_£c
 = -1;

83 (*
ni˘
)->
timî_e_Àngth
 = 
DEFAULT_T1
;

84 (*
ni˘
)->
timî_k_Àngth
 = 0;

85 (*
ni˘
)->
timî_e_°¨t
.
tv_£c
 = -1;

86 (*
ni˘
)->
timî_k_°¨t
.
tv_£c
 = -1;

92 
	`osù_mesßge_gë_rouã
(
ªque°
, 0, &
rouã
);

94 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

95 
osù_uri_∑øm_t
 *
Ã_∑øm
;

97 
	`osù_uri_u∑øm_gë_by«me
(
rouã
->
uæ
, "Ã", &
Ã_∑øm
);

99 i‡(
Ã_∑øm
 =
NULL
) {

101 
rouã
 = 
NULL
;

105 i‡(
rouã
 !
NULL
 &&Ñouã->
uæ
 != NULL) {

106 
p‹t
 = 5060;

108 i‡(
rouã
->
uæ
->
p‹t
 !
NULL
)

109 
p‹t
 = 
	`osù_©oi
(
rouã
->
uæ
->port);

111 
	`osù_ni˘_£t_de°ö©i⁄
((*
ni˘
), 
	`osù_°rdup
(
rouã
->
uæ
->
ho°
), 
p‹t
);

114 
p‹t
 = 5060;

117 
osù_uri_∑øm_t
 *
maddr_∑øm
 = 
NULL
;

118 
osù_uri_∑øm_t
 *
obr_∑øm
 = 
NULL
;

119 
osù_uri_∑øm_t
 *
obp_∑øm
 = 
NULL
;

121 
p‹t
 = 5060;

123 i‡(
ªque°
->
ªq_uri
->
p‹t
 !
NULL
)

124 
p‹t
 = 
	`osù_©oi
(
ªque°
->
ªq_uri
->port);

128 
	`osù_uri_u∑øm_gë_by«me
(
ªque°
->
ªq_uri
, "x-obr", &
obr_∑øm
);

129 
	`osù_uri_u∑øm_gë_by«me
(
ªque°
->
ªq_uri
, "x-obp", &
obp_∑øm
);

131 
	`osù_uri_u∑øm_gë_by«me
(
ªque°
->
ªq_uri
, "maddr", &
maddr_∑øm
);

133 i‡(
maddr_∑øm
 !
NULL
 && maddr_∑øm->
gvÆue
 != NULL)

134 
	`osù_ni˘_£t_de°ö©i⁄
((*
ni˘
), 
	`osù_°rdup
(
maddr_∑øm
->
gvÆue
), 
p‹t
);

136 i‡(
obr_∑øm
 !
NULL
 && obr_∑øm->
gvÆue
 !NULL && 
obp_∑øm
 != NULL && obp_param->gvalue != NULL)

137 
	`osù_ni˘_£t_de°ö©i⁄
((*
ni˘
), 
	`osù_°rdup
(
obr_∑øm
->
gvÆue
), 
	`osù_©oi
(
obp_∑øm
->gvalue));

140 
	`osù_ni˘_£t_de°ö©i⁄
((*
ni˘
), 
	`osù_°rdup
(
ªque°
->
ªq_uri
->
ho°
), 
p‹t
);

143 (*
ni˘
)->
timî_f_Àngth
 = 64 * 
DEFAULT_T1
;

144 
	`osù_gëtimeofday
(&(*
ni˘
)->
timî_f_°¨t
, 
NULL
);

145 
	`add_gëtimeofday
(&(*
ni˘
)->
timî_f_°¨t
, (*ni˘)->
timî_f_Àngth
);

150  
OSIP_SUCCESS
;

151 
	}
}

153 
	$__osù_ni˘_‰ì
(
osù_ni˘_t
 *
ni˘
) {

154 i‡(
ni˘
 =
NULL
)

155  
OSIP_SUCCESS
;

157 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "freeÇictÑesource\n"));

159 
	`osù_‰ì
(
ni˘
->
de°ö©i⁄
);

160 
	`osù_‰ì
(
ni˘
);

161  
OSIP_SUCCESS
;

162 
	}
}

164 
	$osù_ni˘_£t_de°ö©i⁄
(
osù_ni˘_t
 *
ni˘
, *
de°ö©i⁄
, 
p‹t
) {

165 i‡(
ni˘
 =
NULL
)

166  
OSIP_BADPARAMETER
;

168 i‡(
ni˘
->
de°ö©i⁄
 !
NULL
)

169 
	`osù_‰ì
(
ni˘
->
de°ö©i⁄
);

171 
ni˘
->
de°ö©i⁄
 = destination;

172 
ni˘
->
p‹t
 =Öort;

173  
OSIP_SUCCESS
;

174 
	}
}

176 
osù_evít_t
 *
	$__osù_ni˘_√ed_timî_e_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

177  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
ni˘
, &ni˘->
timî_e_°¨t
, 
°©e
 =
NICT_PROCEEDING
 || sèã =
NICT_TRYING
, 
å™ß˘i⁄id
, 
TIMEOUT_E
);

178 
	}
}

180 
osù_evít_t
 *
	$__osù_ni˘_√ed_timî_f_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

181  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
ni˘
, &ni˘->
timî_f_°¨t
, 
°©e
 =
NICT_PROCEEDING
 || sèã =
NICT_TRYING
, 
å™ß˘i⁄id
, 
TIMEOUT_F
);

182 
	}
}

184 
osù_evít_t
 *
	$__osù_ni˘_√ed_timî_k_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

185  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
ni˘
, &ni˘->
timî_k_°¨t
, 
°©e
 =
NICT_COMPLETED
, 
å™ß˘i⁄id
, 
TIMEOUT_K
);

186 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict_fsm.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

25 
å™sôi⁄_t
 
	gni˘_å™sôi⁄
[12] = {

26 {
NICT_PRE_TRYING
, 
SND_REQUEST
, ((*)(*, *)Ë& 
ni˘_¢d_ªque°
, &
ni˘_å™sôi⁄
[1], 
NULL
}, {
NICT_TRYING
, 
TIMEOUT_F
, ((*)(*, *)Ë& 
osù_ni˘_timeout_f_evít
, &nict_transition[2], NULL},

27 {
NICT_TRYING
, 
TIMEOUT_E
, ((*)(*, *)Ë& 
osù_ni˘_timeout_e_evít
, &
ni˘_å™sôi⁄
[3], 
NULL
}, {NICT_TRYING, 
RCV_STATUS_1XX
, ((*)(*, *)Ë& 
ni˘_rcv_1xx
, &nict_transition[4], NULL},

28 {
NICT_TRYING
, 
RCV_STATUS_2XX
, ((*)(*, *)Ë& 
ni˘_rcv_23456xx
, &
ni˘_å™sôi⁄
[5], 
NULL
}, {NICT_TRYING, 
RCV_STATUS_3456XX
, ((*)(*, *)) &Çict_rcv_23456xx, &nict_transition[6], NULL},

29 {
NICT_PROCEEDING
, 
TIMEOUT_F
, ((*)(*, *)Ë& 
osù_ni˘_timeout_f_evít
, &
ni˘_å™sôi⁄
[7], 
NULL
}, {NICT_PROCEEDING, 
TIMEOUT_E
, ((*)(*, *)Ë& 
osù_ni˘_timeout_e_evít
, &nict_transition[8], NULL},

30 {
NICT_PROCEEDING
, 
RCV_STATUS_1XX
, ((*)(*, *)Ë& 
ni˘_rcv_1xx
, &
ni˘_å™sôi⁄
[9], 
NULL
}, {NICT_PROCEEDING, 
RCV_STATUS_2XX
, ((*)(*, *)Ë& 
ni˘_rcv_23456xx
, &nict_transition[10], NULL},

31 {
NICT_PROCEEDING
, 
RCV_STATUS_3456XX
, ((*)(*, *)Ë& 
ni˘_rcv_23456xx
, &
ni˘_å™sôi⁄
[11], 
NULL
}, {
NICT_COMPLETED
, 
TIMEOUT_K
, ((*)(*, *)Ë& 
osù_ni˘_timeout_k_evít
, NULL, NULL}};

33 
osù_°©emachöe_t
 
	gni˘_fsm
 = {
ni˘_å™sôi⁄
};

35 
	$ni˘_h™dÀ_å™•‹t_îr‹
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
îr
) {

36 
	`__osù_å™•‹t_îr‹_ˇŒback
(
OSIP_NICT_TRANSPORT_ERROR
, 
ni˘
, 
îr
);

37 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_TERMINATED
);

38 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_NICT_KILL_TRANSACTION
, 
ni˘
);

40 
	}
}

42 
	$ni˘_¢d_ªque°
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

43 
i
;

44 
osù_t
 *
osù
 = (osù_à*Ë
ni˘
->
c⁄fig
;

47 
ni˘
->
‹ig_ªque°
 = 
evt
->
sù
;

49 
i
 = 
osù
->
	`cb_£nd_mesßge
(
ni˘
, 
evt
->
sù
,Çi˘->
ni˘_c⁄ãxt
->
de°ö©i⁄
,Çi˘->ni˘_c⁄ãxt->
p‹t
,Çi˘->
out_sockë
);

51 i‡(
i
 >= 0) {

53 i‡(
	`MSG_IS_REGISTER
(
evt
->
sù
))

54 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_REGISTER_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

56 i‡(
	`MSG_IS_BYE
(
evt
->
sù
))

57 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_BYE_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

59 i‡(
	`MSG_IS_OPTIONS
(
evt
->
sù
))

60 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_OPTIONS_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

62 i‡(
	`MSG_IS_INFO
(
evt
->
sù
))

63 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_INFO_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

65 i‡(
	`MSG_IS_CANCEL
(
evt
->
sù
))

66 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_CANCEL_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

68 i‡(
	`MSG_IS_NOTIFY
(
evt
->
sù
))

69 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_NOTIFY_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

71 i‡(
	`MSG_IS_SUBSCRIBE
(
evt
->
sù
))

72 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_SUBSCRIBE_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

75 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_UNKNOWN_REQUEST_SENT
, 
ni˘
,Çi˘->
‹ig_ªque°
);

77 #i‚de‡
USE_BLOCKINGSOCKET


83 
osù_vü_t
 *
vü
;

84 *
¥Ÿo
;

85 
k
;

87 
k
 = 
	`osù_mesßge_gë_vü
(
ni˘
->
‹ig_ªque°
, 0, &
vü
);

89 i‡(
k
 < 0) {

90 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, -1);

94 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

96 i‡(
¥Ÿo
 =
NULL
) {

97 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, -1);

101 i‡(
i
 == 0) {

102 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

104 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = -1;

105 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
.
tv_£c
 = -1;

109 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

111 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 
DEFAULT_T1_TCP_PROGRESS
;

117 i‡(
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 > 0) {

118 
	`osù_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
, 
NULL
);

119 
	`add_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
,Çi˘->ni˘_c⁄ãxt->
timî_e_Àngth
);

122 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_TRYING
);

125 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, 
i
);

127 
	}
}

129 
	$osù_ni˘_timeout_e_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

130 
osù_t
 *
osù
 = (osù_à*Ë
ni˘
->
c⁄fig
;

131 
i
;

134 i‡(
ni˘
->
°©e
 =
NICT_TRYING
) {

135 
timevÆ
 
now
;

136 
timevÆ
 
duøti⁄
;

137 
ñ≠£d
;

139 
	`osù_gëtimeofday
(&
now
, 
NULL
);

140 
	`osù_timîsub
(&
now
, &
ni˘
->
¸óãd_time
, &
duøti⁄
);

141 
ñ≠£d
 = 
duøti⁄
.
tv_£c
 * 1000 + duøti⁄.
tv_u£c
 / 1000;

143 i‡(
ñ≠£d
 < 
DEFAULT_T1
)

144 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 
DEFAULT_T1
;

145 i‡(
ñ≠£d
 < 2 * 
DEFAULT_T1
)

146 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 2 * 
DEFAULT_T1
;

147 i‡(
ñ≠£d
 < 4 * 
DEFAULT_T1
)

148 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 4 * 
DEFAULT_T1
;

150 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 =Çict->nict_context->timer_e_length * 2;

152 i‡(
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 > 
DEFAULT_T2
)

153 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 
DEFAULT_T2
;

156 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 
DEFAULT_T2
;

158 
	`osù_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
, 
NULL
);

159 
	`add_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
,Çi˘->ni˘_c⁄ãxt->
timî_e_Àngth
);

162 
i
 = 
osù
->
	`cb_£nd_mesßge
(
ni˘
,Çi˘->
‹ig_ªque°
,Çi˘->
ni˘_c⁄ãxt
->
de°ö©i⁄
,Çi˘->ni˘_c⁄ãxt->
p‹t
,Çi˘->
out_sockë
);

164 i‡(
i
 < 0) {

165 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, 
i
);

169 #i‚de‡
USE_BLOCKINGSOCKET


175 i‡(
i
 == 0) {

176 
osù_vü_t
 *
vü
;

177 *
¥Ÿo
;

179 
i
 = 
	`osù_mesßge_gë_vü
(
ni˘
->
‹ig_ªque°
, 0, &
vü
);

181 i‡(
i
 < 0) {

182 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, -1);

186 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

188 i‡(
¥Ÿo
 =
NULL
) {

189 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, -1);

193 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

195 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = -1;

196 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
.
tv_£c
 = -1;

202 i‡(
i
 == 0)

203 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_REQUEST_SENT_AGAIN
, 
ni˘
,Çi˘->
‹ig_ªque°
);

204 
	}
}

206 
	$osù_ni˘_timeout_f_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

207 
ni˘
->
ni˘_c⁄ãxt
->
timî_f_Àngth
 = -1;

208 
ni˘
->
ni˘_c⁄ãxt
->
timî_f_°¨t
.
tv_£c
 = -1;

210 i‡(
ni˘
->
out_sockë
 == -999) {

211 
	`ni˘_h™dÀ_å™•‹t_îr‹
(
ni˘
, -1);

213 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_TIMEOUT
, 
ni˘
, 
evt
->
sù
);

214 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_TERMINATED
);

215 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_NICT_KILL_TRANSACTION
, 
ni˘
);

217 
	}
}

219 
	$osù_ni˘_timeout_k_evít
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

220 
ni˘
->
ni˘_c⁄ãxt
->
timî_k_Àngth
 = -1;

221 
ni˘
->
ni˘_c⁄ãxt
->
timî_k_°¨t
.
tv_£c
 = -1;

223 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_TERMINATED
);

224 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_NICT_KILL_TRANSACTION
, 
ni˘
);

225 
	}
}

227 
	$ni˘_rcv_1xx
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

230 i‡(
ni˘
->
œ°_ª•⁄£
 !
NULL
) {

231 
	`osù_mesßge_‰ì
(
ni˘
->
œ°_ª•⁄£
);

234 
ni˘
->
œ°_ª•⁄£
 = 
evt
->
sù
;

237 i‡(
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 > 0) {

238 
ni˘
->
ni˘_c⁄ãxt
->
timî_e_Àngth
 = 
DEFAULT_T2
;

239 
	`osù_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
, 
NULL
);

240 
	`add_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_e_°¨t
,Çi˘->ni˘_c⁄ãxt->
timî_e_Àngth
);

243 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_1XX_RECEIVED
, 
ni˘
, 
evt
->
sù
);

244 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_PROCEEDING
);

245 
	}
}

247 
	$ni˘_rcv_23456xx
(
osù_å™ß˘i⁄_t
 *
ni˘
, 
osù_evít_t
 *
evt
) {

250 i‡(
ni˘
->
œ°_ª•⁄£
 !
NULL
) {

251 
	`osù_mesßge_‰ì
(
ni˘
->
œ°_ª•⁄£
);

254 
ni˘
->
œ°_ª•⁄£
 = 
evt
->
sù
;

256 i‡(
	`EVT_IS_RCV_STATUS_2XX
(
evt
))

257 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_2XX_RECEIVED
, 
ni˘
,Çi˘->
œ°_ª•⁄£
);

259 i‡(
	`MSG_IS_STATUS_3XX
(
ni˘
->
œ°_ª•⁄£
))

260 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_3XX_RECEIVED
, 
ni˘
,Çi˘->
œ°_ª•⁄£
);

262 i‡(
	`MSG_IS_STATUS_4XX
(
ni˘
->
œ°_ª•⁄£
))

263 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_4XX_RECEIVED
, 
ni˘
,Çi˘->
œ°_ª•⁄£
);

265 i‡(
	`MSG_IS_STATUS_5XX
(
ni˘
->
œ°_ª•⁄£
))

266 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_5XX_RECEIVED
, 
ni˘
,Çi˘->
œ°_ª•⁄£
);

269 
	`__osù_mesßge_ˇŒback
(
OSIP_NICT_STATUS_6XX_RECEIVED
, 
ni˘
,Çi˘->
œ°_ª•⁄£
);

271 i‡(
ni˘
->
°©e
 !
NICT_COMPLETED
) {

272 
	`osù_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_k_°¨t
, 
NULL
);

273 
	`add_gëtimeofday
(&
ni˘
->
ni˘_c⁄ãxt
->
timî_k_°¨t
,Çi˘->ni˘_c⁄ãxt->
timî_k_Àngth
);

276 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni˘
, 
NICT_COMPLETED
);

277 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__osù_ni°_öô
(
osù_ni°_t
 **
ni°
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
övôe
) {

27 
i
;

29 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating NIST context\n"));

31 *
ni°
 = (
osù_ni°_t
 *Ë
	`osù_mÆloc
((osip_nist_t));

33 i‡(*
ni°
 =
NULL
)

34  
OSIP_NOMEM
;

36 
	`mem£t
(*
ni°
, 0, (
osù_ni°_t
));

39 
osù_vü_t
 *
vü
;

40 *
¥Ÿo
;

42 
i
 = 
	`osù_mesßge_gë_vü
(
övôe
, 0, &
vü
);

44 i‡(
i
 < 0) {

45 
	`osù_‰ì
(*
ni°
);

46 *
ni°
 = 
NULL
;

47  
i
;

50 
¥Ÿo
 = 
	`vü_gë_¥Ÿocﬁ
(
vü
);

52 i‡(
¥Ÿo
 =
NULL
) {

53 
	`osù_‰ì
(*
ni°
);

54 *
ni°
 = 
NULL
;

55  
OSIP_UNDEFINED_ERROR
;

58 i‡(
	`osù_°rˇ£cmp
(
¥Ÿo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

59 (*
ni°
)->
timî_j_Àngth
 = 64 * 
DEFAULT_T1
;

60 (*
ni°
)->
timî_j_°¨t
.
tv_£c
 = -1;

63 (*
ni°
)->
timî_j_Àngth
 = 0;

64 (*
ni°
)->
timî_j_°¨t
.
tv_£c
 = -1;

68  
OSIP_SUCCESS
;

69 
	}
}

71 
	$__osù_ni°_‰ì
(
osù_ni°_t
 *
ni°
) {

72 i‡(
ni°
 =
NULL
)

73  
OSIP_SUCCESS
;

75 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "freeÇistÑesource\n"));

77 
	`osù_‰ì
(
ni°
);

78  
OSIP_SUCCESS
;

79 
	}
}

81 
osù_evít_t
 *
	$__osù_ni°_√ed_timî_j_evít
(
osù_ni°_t
 *
ni°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
) {

82  
	`__osù_å™ß˘i⁄_√ed_timî_x_evít
(
ni°
, &ni°->
timî_j_°¨t
, 
°©e
 =
NIST_COMPLETED
, 
å™ß˘i⁄id
, 
TIMEOUT_J
);

83 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist_fsm.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

25 
å™sôi⁄_t
 
	gni°_å™sôi⁄
[10] = {

26 {
NIST_PRE_TRYING
, 
RCV_REQUEST
, ((*)(*, *)Ë& 
ni°_rcv_ªque°
, &
ni°_å™sôi⁄
[1], 
NULL
}, {
NIST_TRYING
, 
SND_STATUS_1XX
, ((*)(*, *)Ë& 
ni°_¢d_1xx
, &nist_transition[2], NULL},

27 {
NIST_TRYING
, 
SND_STATUS_2XX
, ((*)(*, *)Ë& 
ni°_¢d_23456xx
, &
ni°_å™sôi⁄
[3], 
NULL
}, {NIST_TRYING, 
SND_STATUS_3456XX
, ((*)(*, *)) &Çist_snd_23456xx, &nist_transition[4], NULL},

28 {
NIST_PROCEEDING
, 
SND_STATUS_1XX
, ((*)(*, *)Ë& 
ni°_¢d_1xx
, &
ni°_å™sôi⁄
[5], 
NULL
}, {NIST_PROCEEDING, 
SND_STATUS_2XX
, ((*)(*, *)Ë& 
ni°_¢d_23456xx
, &nist_transition[6], NULL},

29 {
NIST_PROCEEDING
, 
SND_STATUS_3456XX
, ((*)(*, *)Ë& 
ni°_¢d_23456xx
, &
ni°_å™sôi⁄
[7], 
NULL
}, {NIST_PROCEEDING, 
RCV_REQUEST
, ((*)(*, *)Ë& 
ni°_rcv_ªque°
, &nist_transition[8], NULL},

30 {
NIST_COMPLETED
, 
TIMEOUT_J
, ((*)(*, *)Ë& 
osù_ni°_timeout_j_evít
, &
ni°_å™sôi⁄
[9], 
NULL
}, {NIST_COMPLETED, 
RCV_REQUEST
, ((*)(*, *)Ë& 
ni°_rcv_ªque°
, NULL, NULL}};

32 
osù_°©emachöe_t
 
	gni°_fsm
 = {
ni°_å™sôi⁄
};

34 
	$ni°_h™dÀ_å™•‹t_îr‹
(
osù_å™ß˘i⁄_t
 *
ni°
, 
îr
) {

35 
	`__osù_å™•‹t_îr‹_ˇŒback
(
OSIP_NIST_TRANSPORT_ERROR
, 
ni°
, 
îr
);

36 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni°
, 
NIST_TERMINATED
);

37 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_NIST_KILL_TRANSACTION
, 
ni°
);

39 
	}
}

41 
	$ni°_rcv_ªque°
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
) {

42 
i
;

44 i‡(
ni°
->
°©e
 =
NIST_PRE_TRYING
) {

46 
ni°
->
‹ig_ªque°
 = 
evt
->
sù
;

48 i‡(
	`MSG_IS_REGISTER
(
evt
->
sù
))

49 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_REGISTER_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

51 i‡(
	`MSG_IS_BYE
(
evt
->
sù
))

52 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_BYE_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

54 i‡(
	`MSG_IS_OPTIONS
(
evt
->
sù
))

55 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_OPTIONS_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

57 i‡(
	`MSG_IS_INFO
(
evt
->
sù
))

58 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_INFO_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

60 i‡(
	`MSG_IS_CANCEL
(
evt
->
sù
))

61 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_CANCEL_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

63 i‡(
	`MSG_IS_NOTIFY
(
evt
->
sù
))

64 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_NOTIFY_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

66 i‡(
	`MSG_IS_SUBSCRIBE
(
evt
->
sù
))

67 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_SUBSCRIBE_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

70 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_UNKNOWN_REQUEST_RECEIVED
, 
ni°
,Çi°->
‹ig_ªque°
);

75 
	`osù_mesßge_‰ì
(
evt
->
sù
);

77 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_REQUEST_RECEIVED_AGAIN
, 
ni°
,Çi°->
‹ig_ªque°
);

79 i‡(
ni°
->
œ°_ª•⁄£
 !
NULL
) {

80 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
ni°
,Çi°->
œ°_ª•⁄£
);

82 i‡(
i
 != 0) {

83 
	`ni°_h™dÀ_å™•‹t_îr‹
(
ni°
, 
i
);

87 i‡(
	`MSG_IS_STATUS_1XX
(
ni°
->
œ°_ª•⁄£
))

88 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_1XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

90 i‡(
	`MSG_IS_STATUS_2XX
(
ni°
->
œ°_ª•⁄£
))

91 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_2XX_SENT_AGAIN
, 
ni°
,Çi°->
œ°_ª•⁄£
);

94 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_3456XX_SENT_AGAIN
, 
ni°
,Çi°->
œ°_ª•⁄£
);

105 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni°
, 
NIST_TRYING
);

106 
	}
}

108 
	$ni°_¢d_1xx
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
) {

109 
i
;

111 i‡(
ni°
->
œ°_ª•⁄£
 !
NULL
) {

112 
	`osù_mesßge_‰ì
(
ni°
->
œ°_ª•⁄£
);

115 
ni°
->
œ°_ª•⁄£
 = 
evt
->
sù
;

117 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
ni°
,Çi°->
œ°_ª•⁄£
);

119 i‡(
i
 != 0) {

120 
	`ni°_h™dÀ_å™•‹t_îr‹
(
ni°
, 
i
);

124 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_1XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

126 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni°
, 
NIST_PROCEEDING
);

127 
	}
}

129 
	$ni°_¢d_23456xx
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
) {

130 
i
;

132 i‡(
ni°
->
œ°_ª•⁄£
 !
NULL
) {

133 
	`osù_mesßge_‰ì
(
ni°
->
œ°_ª•⁄£
);

136 
ni°
->
œ°_ª•⁄£
 = 
evt
->
sù
;

138 
i
 = 
	`__osù_å™ß˘i⁄_¢d_xxx
(
ni°
,Çi°->
œ°_ª•⁄£
);

140 i‡(
i
 != 0) {

141 
	`ni°_h™dÀ_å™•‹t_îr‹
(
ni°
, 
i
);

145 i‡(
	`EVT_IS_SND_STATUS_2XX
(
evt
))

146 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_2XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

148 i‡(
	`MSG_IS_STATUS_3XX
(
ni°
->
œ°_ª•⁄£
))

149 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_3XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

151 i‡(
	`MSG_IS_STATUS_4XX
(
ni°
->
œ°_ª•⁄£
))

152 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_4XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

154 i‡(
	`MSG_IS_STATUS_5XX
(
ni°
->
œ°_ª•⁄£
))

155 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_5XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

158 
	`__osù_mesßge_ˇŒback
(
OSIP_NIST_STATUS_6XX_SENT
, 
ni°
,Çi°->
œ°_ª•⁄£
);

161 i‡(
ni°
->
°©e
 !
NIST_COMPLETED
) {

162 
	`osù_gëtimeofday
(&
ni°
->
ni°_c⁄ãxt
->
timî_j_°¨t
, 
NULL
);

163 
	`add_gëtimeofday
(&
ni°
->
ni°_c⁄ãxt
->
timî_j_°¨t
,Çi°->ni°_c⁄ãxt->
timî_j_Àngth
);

166 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni°
, 
NIST_COMPLETED
);

167 
	}
}

169 
	$osù_ni°_timeout_j_evít
(
osù_å™ß˘i⁄_t
 *
ni°
, 
osù_evít_t
 *
evt
) {

170 
ni°
->
ni°_c⁄ãxt
->
timî_j_Àngth
 = -1;

171 
ni°
->
ni°_c⁄ãxt
->
timî_j_°¨t
.
tv_£c
 = -1;

173 
	`__osù_å™ß˘i⁄_£t_°©e
(
ni°
, 
NIST_TERMINATED
);

174 
	`__osù_kûl_å™ß˘i⁄_ˇŒback
(
OSIP_NIST_KILL_TRANSACTION
, 
ni°
);

175 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	~<osù2/osù_dülog.h
>

28 #i‡
deföed
(
HAVE_DICT_DICT_H
)

29 
	~<di˘/di˘.h
>

32 
	$osù_ª•⁄£_gë_de°ö©i⁄
(
osù_mesßge_t
 *
ª•⁄£
, **
addªss
, *
p‹äum
) {

33 
osù_vü_t
 *
vü
;

34 *
ho°
 = 
NULL
;

35 
p‹t
 = 0;

37 
vü
 = (
osù_vü_t
 *Ë
	`osù_li°_gë
(&
ª•⁄£
->
vüs
, 0);

39 i‡(
vü
) {

40 
osù_gíîic_∑øm_t
 *
maddr
;

41 
osù_gíîic_∑øm_t
 *
ª˚ived
;

42 
osù_gíîic_∑øm_t
 *
Ω‹t
;

44 
	`osù_vü_∑øm_gë_by«me
(
vü
, "maddr", &
maddr
);

45 
	`osù_vü_∑øm_gë_by«me
(
vü
, "ª˚ived", &
ª˚ived
);

46 
	`osù_vü_∑øm_gë_by«me
(
vü
, "Ω‹t", &
Ω‹t
);

53 i‡(
maddr
 !
NULL
)

54 
ho°
 = 
maddr
->
gvÆue
;

59 i‡(
ª˚ived
 !
NULL
)

60 
ho°
 = 
ª˚ived
->
gvÆue
;

63 
ho°
 = 
vü
->host;

65 i‡(
Ω‹t
 =
NULL
 ||Ñp‹t->
gvÆue
 == NULL) {

66 i‡(
vü
->
p‹t
 !
NULL
)

67 
p‹t
 = 
	`osù_©oi
(
vü
->port);

70 
p‹t
 = 5060;

73 
p‹t
 = 
	`osù_©oi
(
Ω‹t
->
gvÆue
);

76 *
p‹äum
 = 
p‹t
;

78 i‡(
ho°
 !
NULL
)

79 *
addªss
 = 
	`osù_°rdup
(
ho°
);

82 *
addªss
 = 
NULL
;

83 
	}
}

85 
	$osù_ixt_lock
(
osù_t
 *
osù
) {

86 #i‚de‡
OSIP_MONOTHREAD


87  
	`osù_muãx_lock
(
osù
->
ixt_Á°muãx
);

89  
OSIP_SUCCESS
;

91 
	}
}

93 
	$osù_ixt_u∆ock
(
osù_t
 *
osù
) {

94 #i‚de‡
OSIP_MONOTHREAD


95  
	`osù_muãx_u∆ock
(
osù
->
ixt_Á°muãx
);

97  
OSIP_SUCCESS
;

99 
	}
}

101 
osù_id_muãx_lock
(
osù_t
 *
osù
);

102 
osù_id_muãx_u∆ock
(
osù_t
 *
osù
);

104 
	$osù_id_muãx_lock
(
osù_t
 *
osù
) {

105 #i‚de‡
OSIP_MONOTHREAD


106  
	`osù_muãx_lock
(
osù
->
id_muãx
);

108  
OSIP_SUCCESS
;

110 
	}
}

112 
	$osù_id_muãx_u∆ock
(
osù_t
 *
osù
) {

113 #i‚de‡
OSIP_MONOTHREAD


114  
	`osù_muãx_u∆ock
(
osù
->
id_muãx
);

116  
OSIP_SUCCESS
;

118 
	}
}

121 
	$osù_add_ixt
(
osù_t
 *
osù
, 
ixt_t
 *
ixt
) {

123 
	`osù_ixt_lock
(
osù
);

124 
	`osù_li°_add
(&
osù
->
ixt_ªå™smissi⁄s
, (*Ë
ixt
, 0);

125 
	`osù_ixt_u∆ock
(
osù
);

126 
	}
}

128 
	$ixt_öô
(
ixt_t
 **
ixt
) {

129 
ixt_t
 *
pixt
;

131 *
ixt
 = 
pixt
 = (
ixt_t
 *Ë
	`osù_mÆloc
((ixt_t));

133 i‡(
pixt
 =
NULL
)

134  
OSIP_NOMEM
;

136 
pixt
->
dülog
 = 
NULL
;

137 
pixt
->
msg2xx
 = 
NULL
;

138 
pixt
->
ack
 = 
NULL
;

139 
pixt
->
öãrvÆ
 = 
DEFAULT_T1
;

140 
	`osù_gëtimeofday
(&
pixt
->
°¨t
, 
NULL
);

141 
	`add_gëtimeofday
(&
pixt
->
°¨t
,Öixt->
öãrvÆ
 + 10);

142 
pixt
->
cou¡î
 = 10;

143 
pixt
->
de°
 = 
NULL
;

144 
pixt
->
p‹t
 = 5060;

145 
pixt
->
sock
 = -1;

146  
OSIP_SUCCESS
;

147 
	}
}

149 
	$ixt_‰ì
(
ixt_t
 *
ixt
) {

150 
	`osù_mesßge_‰ì
(
ixt
->
ack
);

151 
	`osù_mesßge_‰ì
(
ixt
->
msg2xx
);

152 
	`osù_‰ì
(
ixt
->
de°
);

153 
	`osù_‰ì
(
ixt
);

154 
	}
}

157 
	$osù_°¨t_200ok_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
msg200ok
, 
sock
) {

158 
i
;

159 
ixt_t
 *
ixt
;

161 
i
 = 
	`ixt_öô
(&
ixt
);

163 i‡(
i
 != 0)

166 
ixt
->
dülog
 = dialog;

167 
	`osù_mesßge_˛⁄e
(
msg200ok
, &
ixt
->
msg2xx
);

168 
ixt
->
sock
 = sock;

169 
	`osù_ª•⁄£_gë_de°ö©i⁄
(
msg200ok
, &
ixt
->
de°
, &ixt->
p‹t
);

170 
	`osù_add_ixt
(
osù
, 
ixt
);

171 
	}
}

173 
	$osù_°¨t_ack_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ack
, *
de°
, 
p‹t
, 
sock
) {

174 
i
;

175 
ixt_t
 *
ixt
;

177 
i
 = 
	`ixt_öô
(&
ixt
);

179 i‡(
i
 != 0)

182 
ixt
->
dülog
 = dialog;

183 
	`osù_mesßge_˛⁄e
(
ack
, &
ixt
->ack);

184 
ixt
->
de°
 = 
	`osù_°rdup
(dest);

185 
ixt
->
p‹t
 =Öort;

186 
ixt
->
sock
 = sock;

187 
	`osù_add_ixt
(
osù
, 
ixt
);

188 
	}
}

191 
osù_dülog
 *
	$osù_°›_200ok_ªå™smissi⁄s
(
osù_t
 *
osù
, 
osù_mesßge_t
 *
ack
) {

192 
osù_dülog_t
 *
dülog
 = 
NULL
;

193 
i
;

194 
ixt_t
 *
ixt
;

196 i‡(
ack
 =
NULL
 ||áck->
c£q
 =NULL ||áck->c£q->
numbî
 == NULL)

197  
NULL
;

199 
	`osù_ixt_lock
(
osù
);

201 
i
 = 0; !
	`osù_li°_eﬁ
(&
osù
->
ixt_ªå™smissi⁄s
, i); i++) {

202 
ixt
 = (
ixt_t
 *Ë
	`osù_li°_gë
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

204 i‡(
ixt
->
msg2xx
 =
NULL
 || ixt->msg2xx->
c£q
 =NULL || ixt->msg2xx->c£q->
numbî
 == NULL)

207 i‡(
	`osù_dülog_m©ch_as_uas
(
ixt
->
dülog
, 
ack
Ë=0 && 
	`°rcmp
(ixt->
msg2xx
->
c£q
->
numbî
,áck->cseq->number) == 0) {

208 
	`osù_li°_ªmove
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

209 
dülog
 = 
ixt
->dialog;

210 
	`ixt_‰ì
(
ixt
);

215 
	`osù_ixt_u∆ock
(
osù
);

216  
dülog
;

217 
	}
}

221 
	$osù_°›_ªå™smissi⁄s_‰om_dülog
(
osù_t
 *
osù
, 
osù_dülog_t
 *
dülog
) {

222 
i
;

223 
ixt_t
 *
ixt
;

225 
	`osù_ixt_lock
(
osù
);

227 
i
 = 0; !
	`osù_li°_eﬁ
(&
osù
->
ixt_ªå™smissi⁄s
, i); i++) {

228 
ixt
 = (
ixt_t
 *Ë
	`osù_li°_gë
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

230 i‡(
ixt
->
dülog
 == dialog) {

231 
	`osù_li°_ªmove
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

232 
	`ixt_‰ì
(
ixt
);

233 
i
--;

237 
	`osù_ixt_u∆ock
(
osù
);

238 
	}
}

240 
	$ixt_ªå™smô
(
osù_t
 *
osù
, 
ixt_t
 *
ixt
, 
timevÆ
 *
cuºít
) {

241 i‡(
	`osù_timîcmp
(
cuºít
, &
ixt
->
°¨t
, >=)) {

242 
ixt
->
öãrvÆ
 = ixt->interval * 2;

244 i‡(
ixt
->
öãrvÆ
 > 
DEFAULT_T2
)

245 
ixt
->
öãrvÆ
 = 
DEFAULT_T2
;

247 
	`add_gëtimeofday
(&
ixt
->
°¨t
, ixt->
öãrvÆ
);

249 i‡(
ixt
->
ack
 !
NULL
)

250 
osù
->
	`cb_£nd_mesßge
(
NULL
, 
ixt
->
ack
, ixt->
de°
, ixt->
p‹t
, ixt->
sock
);

252 i‡(
ixt
->
msg2xx
 !
NULL
)

253 
osù
->
	`cb_£nd_mesßge
(
NULL
, 
ixt
->
msg2xx
, ixt->
de°
, ixt->
p‹t
, ixt->
sock
);

255 
ixt
->
cou¡î
--;

257 
	}
}

259 
	$osù_ªå™smissi⁄s_execuã
(
osù_t
 *
osù
) {

260 
i
;

261 
ixt_t
 *
ixt
;

262 
timevÆ
 
cuºít
;

264 
	`osù_gëtimeofday
(&
cuºít
, 
NULL
);

266 
	`osù_ixt_lock
(
osù
);

268 
i
 = 0; !
	`osù_li°_eﬁ
(&
osù
->
ixt_ªå™smissi⁄s
, i); i++) {

269 
ixt
 = (
ixt_t
 *Ë
	`osù_li°_gë
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

270 
	`ixt_ªå™smô
(
osù
, 
ixt
, &
cuºít
);

272 i‡(
ixt
->
cou¡î
 == 0) {

274 
	`osù_li°_ªmove
(&
osù
->
ixt_ªå™smissi⁄s
, 
i
);

275 
	`ixt_‰ì
(
ixt
);

276 
i
--;

280 
	`osù_ixt_u∆ock
(
osù
);

281 
	}
}

283 
	$osù_i˘_lock
(
osù_t
 *
osù
) {

284 #i‚de‡
OSIP_MONOTHREAD


285  
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

287  
OSIP_SUCCESS
;

289 
	}
}

291 
	$osù_i˘_u∆ock
(
osù_t
 *
osù
) {

292 #i‚de‡
OSIP_MONOTHREAD


293  
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

295  
OSIP_SUCCESS
;

297 
	}
}

299 
	$osù_i°_lock
(
osù_t
 *
osù
) {

300 #i‚de‡
OSIP_MONOTHREAD


301  
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

303  
OSIP_SUCCESS
;

305 
	}
}

307 
	$osù_i°_u∆ock
(
osù_t
 *
osù
) {

308 #i‚de‡
OSIP_MONOTHREAD


309  
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

311  
OSIP_SUCCESS
;

313 
	}
}

315 
	$osù_ni˘_lock
(
osù_t
 *
osù
) {

316 #i‚de‡
OSIP_MONOTHREAD


317  
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

319  
OSIP_SUCCESS
;

321 
	}
}

323 
	$osù_ni˘_u∆ock
(
osù_t
 *
osù
) {

324 #i‚de‡
OSIP_MONOTHREAD


325  
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

327  
OSIP_SUCCESS
;

329 
	}
}

331 
	$osù_ni°_lock
(
osù_t
 *
osù
) {

332 #i‚de‡
OSIP_MONOTHREAD


333  
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

335  
OSIP_SUCCESS
;

337 
	}
}

339 
	$osù_ni°_u∆ock
(
osù_t
 *
osù
) {

340 #i‚de‡
OSIP_MONOTHREAD


341  
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

343  
OSIP_SUCCESS
;

345 
	}
}

347 #i‡
deföed
(
HAVE_DICT_DICT_H
)

348 
	#HSIZE
 200

	)

350 
s_hash
(c⁄° *
p
);

352 
	$s_hash
(c⁄° *
p
) {

353 
hash
 = 0;

355 *
p
) {

356 
hash
 *= 31;

357 
hash
 ^*
p
++;

360  
hash
;

361 
	}
}

364 
	$__osù_add_i˘
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i˘
) {

365 #i‚de‡
OSIP_MONOTHREAD


366 
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

368 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

370 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

371 
rv
 = -99;

373 
	`osù_vü_∑øm_gë_by«me
(
i˘
->
t›vü
, "bønch", &
b_ªque°
);

375 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL)

376 
rv
 = 
	`di˘_ö£π
((
di˘
 *Ë
osù
->
osù_i˘_ha°abÀ
, 
b_ªque°
->
gvÆue
, (*Ë
i˘
, 
FALSE
);

378 i‡(
rv
 == 0) {

379 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£πed i¿i˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

381 } i‡(
rv
 != -99) {

382 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Æªady in£πed `%s'\n", 
b_ªque°
->
gvÆue
));

386 
	`osù_li°_add
(&
osù
->
osù_i˘_å™ß˘i⁄s
, 
i˘
, -1);

387 #i‚de‡
OSIP_MONOTHREAD


388 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

390  
OSIP_SUCCESS
;

391 
	}
}

393 
	$__osù_add_i°
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i°
) {

394 #i‚de‡
OSIP_MONOTHREAD


395 
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

397 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

399 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

400 
rv
 = -99;

402 
	`osù_vü_∑øm_gë_by«me
(
i°
->
t›vü
, "bønch", &
b_ªque°
);

404 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL)

405 
rv
 = 
	`di˘_ö£π
((
di˘
 *Ë
osù
->
osù_i°_ha°abÀ
, 
b_ªque°
->
gvÆue
, (*Ë
i°
, 
FALSE
);

407 i‡(
rv
 == 0) {

408 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£πed i¿i° ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

410 } i‡(
rv
 != -99) {

411 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Æªady in£πed `%s'\n", 
b_ªque°
->
gvÆue
));

415 
	`osù_li°_add
(&
osù
->
osù_i°_å™ß˘i⁄s
, 
i°
, -1);

416 #i‚de‡
OSIP_MONOTHREAD


417 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

419  
OSIP_SUCCESS
;

420 
	}
}

422 
	$__osù_add_ni˘
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni˘
) {

423 #i‚de‡
OSIP_MONOTHREAD


424 
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

426 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

428 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

429 
rv
 = -99;

431 
	`osù_vü_∑øm_gë_by«me
(
ni˘
->
t›vü
, "bønch", &
b_ªque°
);

433 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL)

434 
rv
 = 
	`di˘_ö£π
((
di˘
 *Ë
osù
->
osù_ni˘_ha°abÀ
, 
b_ªque°
->
gvÆue
, (*Ë
ni˘
, 
FALSE
);

436 i‡(
rv
 == 0) {

437 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£πed i¿ni˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

439 } i‡(
rv
 != -99) {

440 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Æªady in£πed `%s'\n", 
b_ªque°
->
gvÆue
));

444 
	`osù_li°_add
(&
osù
->
osù_ni˘_å™ß˘i⁄s
, 
ni˘
, -1);

445 #i‚de‡
OSIP_MONOTHREAD


446 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

448  
OSIP_SUCCESS
;

449 
	}
}

451 
	$__osù_add_ni°
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni°
) {

452 #i‚de‡
OSIP_MONOTHREAD


453 
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

455 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

457 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

458 
rv
 = -99;

460 
	`osù_vü_∑øm_gë_by«me
(
ni°
->
t›vü
, "bønch", &
b_ªque°
);

462 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL)

463 
rv
 = 
	`di˘_ö£π
((
di˘
 *Ë
osù
->
osù_ni°_ha°abÀ
, 
b_ªque°
->
gvÆue
, (*Ë
ni°
, 
FALSE
);

465 i‡(
rv
 == 0) {

466 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£πed i¿i˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

468 } i‡(
rv
 != -99) {

469 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Æªady in£πed `%s'\n", 
b_ªque°
->
gvÆue
));

473 
	`osù_li°_add
(&
osù
->
osù_ni°_å™ß˘i⁄s
, 
ni°
, -1);

474 #i‚de‡
OSIP_MONOTHREAD


475 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

477  
OSIP_SUCCESS
;

478 
	}
}

480 
	$osù_ªmove_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
å
) {

481 
i
 = -1;

483 i‡(
å
 =
NULL
)

484  
OSIP_BADPARAMETER
;

486 i‡(
å
->
˘x_ty≥
 =
ICT
)

487 
i
 = 
	`__osù_ªmove_i˘_å™ß˘i⁄
(
osù
, 
å
);

489 i‡(
å
->
˘x_ty≥
 =
IST
)

490 
i
 = 
	`__osù_ªmove_i°_å™ß˘i⁄
(
osù
, 
å
);

492 i‡(
å
->
˘x_ty≥
 =
NICT
)

493 
i
 = 
	`__osù_ªmove_ni˘_å™ß˘i⁄
(
osù
, 
å
);

495 i‡(
å
->
˘x_ty≥
 =
NIST
)

496 
i
 = 
	`__osù_ªmove_ni°_å™ß˘i⁄
(
osù
, 
å
);

499  
OSIP_BADPARAMETER
;

501  
i
;

502 
	}
}

504 
	$__osù_ªmove_i˘_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i˘
) {

505 
osù_li°_ôî©‹_t
 
ôî©‹
;

506 
osù_å™ß˘i⁄_t
 *
tmp
;

508 #i‚de‡
OSIP_MONOTHREAD


509 
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

512 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

514 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

515 
rv
;

517 
	`osù_vü_∑øm_gë_by«me
(
i˘
->
t›vü
, "bønch", &
b_ªque°
);

519 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

520 
rv
 = 
	`di˘_ªmove
((
di˘
 *Ë
osù
->
osù_i˘_ha°abÀ
, 
b_ªque°
->
gvÆue
, 
TRUE
);

522 i‡(
rv
 == 0) {

523 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key dñëed i¿i˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

526 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "keyÇŸÑemoved `%s'\n", 
b_ªque°
->
gvÆue
));

532 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i˘_å™ß˘i⁄s
, &
ôî©‹
);

534 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

535 i‡(
tmp
->
å™ß˘i⁄id
 =
i˘
->transactionid) {

536 
	`osù_li°_ôî©‹_ªmove
(&
ôî©‹
);

537 #i‚de‡
OSIP_MONOTHREAD


538 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

540  
OSIP_SUCCESS
;

543 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

546 #i‚de‡
OSIP_MONOTHREAD


547 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

549  
OSIP_UNDEFINED_ERROR
;

550 
	}
}

552 
	$__osù_ªmove_i°_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i°
) {

553 
osù_li°_ôî©‹_t
 
ôî©‹
;

554 
osù_å™ß˘i⁄_t
 *
tmp
;

556 #i‚de‡
OSIP_MONOTHREAD


557 
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

560 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

562 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

563 
rv
;

565 
	`osù_vü_∑øm_gë_by«me
(
i°
->
t›vü
, "bønch", &
b_ªque°
);

567 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

568 
rv
 = 
	`di˘_ªmove
((
di˘
 *Ë
osù
->
osù_i°_ha°abÀ
, 
b_ªque°
->
gvÆue
, 
TRUE
);

570 i‡(
rv
 == 0) {

571 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key dñëed i¿i° ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

574 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "keyÇŸÑemoved `%s'\n", 
b_ªque°
->
gvÆue
));

580 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i°_å™ß˘i⁄s
, &
ôî©‹
);

582 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

583 i‡(
tmp
->
å™ß˘i⁄id
 =
i°
->transactionid) {

584 
	`osù_li°_ôî©‹_ªmove
(&
ôî©‹
);

585 #i‚de‡
OSIP_MONOTHREAD


586 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

588  
OSIP_SUCCESS
;

591 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

594 #i‚de‡
OSIP_MONOTHREAD


595 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

597  
OSIP_UNDEFINED_ERROR
;

598 
	}
}

600 
	$__osù_ªmove_ni˘_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni˘
) {

601 
osù_li°_ôî©‹_t
 
ôî©‹
;

602 
osù_å™ß˘i⁄_t
 *
tmp
;

604 #i‚de‡
OSIP_MONOTHREAD


605 
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

608 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

610 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

611 
rv
;

613 
	`osù_vü_∑øm_gë_by«me
(
ni˘
->
t›vü
, "bønch", &
b_ªque°
);

615 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

616 
rv
 = 
	`di˘_ªmove
((
di˘
 *Ë
osù
->
osù_ni˘_ha°abÀ
, 
b_ªque°
->
gvÆue
, 
TRUE
);

618 i‡(
rv
 == 0) {

619 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key dñëed i¿ni˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

622 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "keyÇŸÑemoved `%s'\n", 
b_ªque°
->
gvÆue
));

628 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni˘_å™ß˘i⁄s
, &
ôî©‹
);

630 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

631 i‡(
tmp
->
å™ß˘i⁄id
 =
ni˘
->transactionid) {

632 
	`osù_li°_ôî©‹_ªmove
(&
ôî©‹
);

633 #i‚de‡
OSIP_MONOTHREAD


634 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

636  
OSIP_SUCCESS
;

639 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

642 #i‚de‡
OSIP_MONOTHREAD


643 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

645  
OSIP_UNDEFINED_ERROR
;

646 
	}
}

648 
	$__osù_ªmove_ni°_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni°
) {

649 
osù_li°_ôî©‹_t
 
ôî©‹
;

650 
osù_å™ß˘i⁄_t
 *
tmp
;

652 #i‚de‡
OSIP_MONOTHREAD


653 
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

656 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

658 
osù_gíîic_∑øm_t
 *
b_ªque°
 = 
NULL
;

659 
rv
;

661 
	`osù_vü_∑øm_gë_by«me
(
ni°
->
t›vü
, "bønch", &
b_ªque°
);

663 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

664 
rv
 = 
	`di˘_ªmove
((
di˘
 *Ë
osù
->
osù_ni°_ha°abÀ
, 
b_ªque°
->
gvÆue
, 
TRUE
);

666 i‡(
rv
 == 0) {

667 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key dñëed i¿i˘ ha°abÀ `%s'\n", 
b_ªque°
->
gvÆue
));

670 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "keyÇŸÑemoved `%s'\n", 
b_ªque°
->
gvÆue
));

676 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni°_å™ß˘i⁄s
, &
ôî©‹
);

678 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

679 i‡(
tmp
->
å™ß˘i⁄id
 =
ni°
->transactionid) {

680 
	`osù_li°_ôî©‹_ªmove
(&
ôî©‹
);

681 #i‚de‡
OSIP_MONOTHREAD


682 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

684  
OSIP_SUCCESS
;

687 
tmp
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

690 #i‚de‡
OSIP_MONOTHREAD


691 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

693  
OSIP_UNDEFINED_ERROR
;

694 
	}
}

696 
	$osù_föd_å™ß˘i⁄_™d_add_evít
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
) {

697 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
 = 
	`__osù_föd_å™ß˘i⁄
(
osù
, 
evt
, 1);

699 i‡(
å™ß˘i⁄
 =
NULL
)

700  
OSIP_UNDEFINED_ERROR
;

702  
OSIP_SUCCESS
;

703 
	}
}

705 #ifde‡
OSIP_MONOTHREAD


706 
osù_å™ß˘i⁄_t
 *
	$osù_föd_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
) {

707  
	`__osù_föd_å™ß˘i⁄
(
osù
, 
evt
, 0);

708 
	}
}

711 
osù_å™ß˘i⁄_t
 *
	$__osù_föd_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
, 
c⁄sume
) {

712 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
 = 
NULL
;

713 
osù_li°_t
 *
å™ß˘i⁄s
 = 
NULL
;

715 #i‚de‡
OSIP_MONOTHREAD


716 
osù_muãx
 *
mut
 = 
NULL
;

719 i‡(
evt
 =
NULL
 ||Évt->
sù
 =NULL ||Évt->sù->
c£q
 == NULL)

720  
NULL
;

722 i‡(
	`EVT_IS_INCOMINGMSG
(
evt
)) {

723 i‡(
	`MSG_IS_REQUEST
(
evt
->
sù
)) {

724 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE") || 0 == strcmp(evt->sip->cseq->method, "ACK")) {

725 
å™ß˘i⁄s
 = &
osù
->
osù_i°_å™ß˘i⁄s
;

726 #i‚de‡
OSIP_MONOTHREAD


727 
mut
 = 
osù
->
i°_Á°muãx
;

731 
å™ß˘i⁄s
 = &
osù
->
osù_ni°_å™ß˘i⁄s
;

732 #i‚de‡
OSIP_MONOTHREAD


733 
mut
 = 
osù
->
ni°_Á°muãx
;

738 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE")) {

739 
å™ß˘i⁄s
 = &
osù
->
osù_i˘_å™ß˘i⁄s
;

740 #i‚de‡
OSIP_MONOTHREAD


741 
mut
 = 
osù
->
i˘_Á°muãx
;

745 
å™ß˘i⁄s
 = &
osù
->
osù_ni˘_å™ß˘i⁄s
;

746 #i‚de‡
OSIP_MONOTHREAD


747 
mut
 = 
osù
->
ni˘_Á°muãx
;

752 } i‡(
	`EVT_IS_OUTGOINGMSG
(
evt
)) {

753 i‡(
	`MSG_IS_RESPONSE
(
evt
->
sù
)) {

754 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE")) {

755 
å™ß˘i⁄s
 = &
osù
->
osù_i°_å™ß˘i⁄s
;

756 #i‚de‡
OSIP_MONOTHREAD


757 
mut
 = 
osù
->
i°_Á°muãx
;

761 
å™ß˘i⁄s
 = &
osù
->
osù_ni°_å™ß˘i⁄s
;

762 #i‚de‡
OSIP_MONOTHREAD


763 
mut
 = 
osù
->
ni°_Á°muãx
;

768 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE") || 0 == strcmp(evt->sip->cseq->method, "ACK")) {

769 
å™ß˘i⁄s
 = &
osù
->
osù_i˘_å™ß˘i⁄s
;

770 #i‚de‡
OSIP_MONOTHREAD


771 
mut
 = 
osù
->
i˘_Á°muãx
;

775 
å™ß˘i⁄s
 = &
osù
->
osù_ni˘_å™ß˘i⁄s
;

776 #i‚de‡
OSIP_MONOTHREAD


777 
mut
 = 
osù
->
ni˘_Á°muãx
;

783 i‡(
å™ß˘i⁄s
 =
NULL
)

784  
NULL
;

786 #i‚de‡
OSIP_MONOTHREAD


787 
	`osù_muãx_lock
(
mut
);

789 
å™ß˘i⁄
 = 
	`osù_å™ß˘i⁄_föd
(
å™ß˘i⁄s
, 
evt
);

791 i‡(
c⁄sume
 == 1) {

792 i‡(
å™ß˘i⁄
 !
NULL
) {

793 
	`osù_å™ß˘i⁄_add_evít
(
å™ß˘i⁄
, 
evt
);

794 #i‚de‡
OSIP_MONOTHREAD


795 
	`osù_muãx_u∆ock
(
mut
);

797  
å™ß˘i⁄
;

801 #i‚de‡
OSIP_MONOTHREAD


802 
	`osù_muãx_u∆ock
(
mut
);

805  
å™ß˘i⁄
;

806 
	}
}

808 
osù_å™ß˘i⁄_t
 *
	$osù_¸óã_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_evít_t
 *
evt
) {

809 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

810 
i
;

811 
osù_fsm_ty≥_t
 
˘x_ty≥
;

813 i‡(
evt
 =
NULL
)

814  
NULL
;

816 i‡(
evt
->
sù
 =
NULL
)

817  
NULL
;

820 i‡(
	`MSG_IS_REQUEST
(
evt
->
sù
)) {

823 i‡(
evt
->
sù
->
c£q
 =
NULL
 ||Évt->sù->c£q->
mëhod
 =NULL ||Évt->sù->
sù_mëhod
 == NULL) {

824  
NULL
;

827 i‡(0 !
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
,Évt->sù->
sù_mëhod
)) {

828 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "core module: Discard invalid message with method!=cseq!\n"));

829  
NULL
;

833 i‡(
	`MSG_IS_ACK
(
evt
->
sù
))

834  
NULL
;

836 i‡(
	`EVT_IS_INCOMINGREQ
(
evt
)) {

838 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE"))

839 
˘x_ty≥
 = 
IST
;

842 
˘x_ty≥
 = 
NIST
;

844 } i‡(
	`EVT_IS_OUTGOINGREQ
(
evt
)) {

845 i‡(0 =
	`°rcmp
(
evt
->
sù
->
c£q
->
mëhod
, "INVITE"))

846 
˘x_ty≥
 = 
ICT
;

849 
˘x_ty≥
 = 
NICT
;

852 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Cannot buildáÅransaction forÅhis message!\n"));

853  
NULL
;

856 
i
 = 
	`osù_å™ß˘i⁄_öô
(&
å™ß˘i⁄
, 
˘x_ty≥
, 
osù
, 
evt
->
sù
);

858 i‡(
i
 != 0) {

859  
NULL
;

862 
evt
->
å™ß˘i⁄id
 = 
å™ß˘i⁄
->transactionid;

863  
å™ß˘i⁄
;

864 
	}
}

866 
osù_å™ß˘i⁄_t
 *
	$osù_å™ß˘i⁄_föd
(
osù_li°_t
 *
å™ß˘i⁄s
, 
osù_evít_t
 *
evt
) {

867 
osù_li°_ôî©‹_t
 
ôî©‹
;

868 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

869 
osù_t
 *
osù
 = 
NULL
;

871 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(
å™ß˘i⁄s
, &
ôî©‹
);

873 i‡(
å™ß˘i⁄
 !
NULL
)

874 
osù
 = (
osù_t
 *Ë
å™ß˘i⁄
->
c⁄fig
;

876 i‡(
osù
 =
NULL
)

877  
NULL
;

879 i‡(
	`EVT_IS_INCOMINGREQ
(
evt
)) {

880 #ifde‡
HAVE_DICT_DICT_H


882 
osù_gíîic_∑øm_t
 *
b_ªque°
;

883 
osù_vü_t
 *
t›vü_ªque°
;

885 
t›vü_ªque°
 = 
	`osù_li°_gë
(&
evt
->
sù
->
vüs
, 0);

887 i‡(
t›vü_ªque°
 =
NULL
) {

888 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA isÇot compliant: missingá Via header!\n"));

889  
NULL
;

892 
	`osù_vü_∑øm_gë_by«me
(
t›vü_ªque°
, "bønch", &
b_ªque°
);

894 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

895 i‡(
	`MSG_IS_INVITE
(
evt
->
sù
Ë|| 
	`MSG_IS_ACK
(evt->sip)) {

896 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`di˘_£¨ch
((
di˘
 *Ë
osù
->
osù_i°_ha°abÀ
, 
b_ªque°
->
gvÆue
);

897 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for INVITE(ACK) REQUEST!\n"));

899 i‡(
å™ß˘i⁄
 !
NULL
)

900  
å™ß˘i⁄
;

903 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`di˘_£¨ch
((
di˘
 *Ë
osù
->
osù_ni°_ha°abÀ
, 
b_ªque°
->
gvÆue
);

904 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for NON-INVITE REQUEST!\n"));

906 i‡(
å™ß˘i⁄
 !
NULL
)

907  
å™ß˘i⁄
;

913 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(
å™ß˘i⁄s
, &
ôî©‹
);

915 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

916 i‡(0 =
	`__osù_å™ß˘i⁄_m©chög_ªque°_osù_to_xi°_17_2_3
(
å™ß˘i⁄
, 
evt
->
sù
))

917  
å™ß˘i⁄
;

919 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

922 } i‡(
	`EVT_IS_INCOMINGRESP
(
evt
)) {

923 #ifde‡
HAVE_DICT_DICT_H


925 
osù_gíîic_∑øm_t
 *
b_ªque°
;

926 
osù_vü_t
 *
t›vü_ªque°
;

928 
t›vü_ªque°
 = 
	`osù_li°_gë
(&
evt
->
sù
->
vüs
, 0);

930 i‡(
t›vü_ªque°
 =
NULL
) {

931 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA isÇot compliant: missingá Via header!\n"));

932  
NULL
;

935 
	`osù_vü_∑øm_gë_by«me
(
t›vü_ªque°
, "bønch", &
b_ªque°
);

937 i‡(
b_ªque°
 !
NULL
 && b_ªque°->
gvÆue
 != NULL) {

938 i‡(
	`MSG_IS_RESPONSE_FOR
(
evt
->
sù
, "INVITE")) {

939 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`di˘_£¨ch
((
di˘
 *Ë
osù
->
osù_i˘_ha°abÀ
, 
b_ªque°
->
gvÆue
);

940 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for INVITE ANSWER!\n"));

942 i‡(
å™ß˘i⁄
 !
NULL
)

943  
å™ß˘i⁄
;

946 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`di˘_£¨ch
((
di˘
 *Ë
osù
->
osù_ni˘_ha°abÀ
, 
b_ªque°
->
gvÆue
);

947 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for NON-INVITE ANSWER!\n"));

949 i‡(
å™ß˘i⁄
 !
NULL
)

950  
å™ß˘i⁄
;

956 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(
å™ß˘i⁄s
, &
ôî©‹
);

958 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

959 i‡(0 =
	`__osù_å™ß˘i⁄_m©chög_ª•⁄£_osù_to_xi˘_17_1_3
(
å™ß˘i⁄
, 
evt
->
sù
))

960  
å™ß˘i⁄
;

962 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

967 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(
å™ß˘i⁄s
, &
ôî©‹
);

969 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

970 i‡(
å™ß˘i⁄
->
å™ß˘i⁄id
 =
evt
->transactionid)

971  
å™ß˘i⁄
;

973 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

977  
NULL
;

978 
	}
}

980 
	$osù_öô
(
osù_t
 **
osù
) {

981 
ªf_cou¡
 = 0;

983 i‡(
ªf_cou¡
 == 0) {

984 
ªf_cou¡
++;

986 
	`∑r£r_öô
();

989 *
osù
 = (
osù_t
 *Ë
	`osù_mÆloc
((osip_t));

991 i‡(*
osù
 =
NULL
)

992  
OSIP_NOMEM
;

994 
	`mem£t
(*
osù
, 0, (
osù_t
));

996 #i‚de‡
OSIP_MONOTHREAD


997 (*
osù
)->
i˘_Á°muãx
 = 
	`osù_muãx_öô
();

998 (*
osù
)->
i°_Á°muãx
 = 
	`osù_muãx_öô
();

999 (*
osù
)->
ni˘_Á°muãx
 = 
	`osù_muãx_öô
();

1000 (*
osù
)->
ni°_Á°muãx
 = 
	`osù_muãx_öô
();

1002 (*
osù
)->
ixt_Á°muãx
 = 
	`osù_muãx_öô
();

1003 (*
osù
)->
id_muãx
 = 
	`osù_muãx_öô
();

1006 
	`osù_li°_öô
(&(*
osù
)->
osù_i˘_å™ß˘i⁄s
);

1007 
	`osù_li°_öô
(&(*
osù
)->
osù_i°_å™ß˘i⁄s
);

1008 
	`osù_li°_öô
(&(*
osù
)->
osù_ni˘_å™ß˘i⁄s
);

1009 
	`osù_li°_öô
(&(*
osù
)->
osù_ni°_å™ß˘i⁄s
);

1010 
	`osù_li°_öô
(&(*
osù
)->
ixt_ªå™smissi⁄s
);

1012 (*
osù
)->
å™ß˘i⁄id
 = 1;

1014 #i‡
	`deföed
(
HAVE_DICT_DICT_H
)

1015 (*
osù
)->
osù_i˘_ha°abÀ
 = (
di˘
 *Ë
	`hashèbÀ_di˘_√w
((
di˘_cmp_func
Ë
°rcmp
, (
di˘_hsh_func
Ë
s_hash
, 
NULL
, NULL, 
HSIZE
);

1016 (*
osù
)->
osù_i°_ha°abÀ
 = (
di˘
 *Ë
	`hashèbÀ_di˘_√w
((
di˘_cmp_func
Ë
°rcmp
, (
di˘_hsh_func
Ë
s_hash
, 
NULL
, NULL, 
HSIZE
);

1017 (*
osù
)->
osù_ni˘_ha°abÀ
 = (
di˘
 *Ë
	`hashèbÀ_di˘_√w
((
di˘_cmp_func
Ë
°rcmp
, (
di˘_hsh_func
Ë
s_hash
, 
NULL
, NULL, 
HSIZE
);

1018 (*
osù
)->
osù_ni°_ha°abÀ
 = (
di˘
 *Ë
	`hashèbÀ_di˘_√w
((
di˘_cmp_func
Ë
°rcmp
, (
di˘_hsh_func
Ë
s_hash
, 
NULL
, NULL, 
HSIZE
);

1021  
OSIP_SUCCESS
;

1022 
	}
}

1024 
	$osù_ªÀa£
(
osù_t
 *
osù
) {

1025 #i‚de‡
OSIP_MONOTHREAD


1026 
	`osù_muãx_de°roy
(
osù
->
i˘_Á°muãx
);

1027 
	`osù_muãx_de°roy
(
osù
->
i°_Á°muãx
);

1028 
	`osù_muãx_de°roy
(
osù
->
ni˘_Á°muãx
);

1029 
	`osù_muãx_de°roy
(
osù
->
ni°_Á°muãx
);

1031 
	`osù_muãx_de°roy
(
osù
->
ixt_Á°muãx
);

1032 
	`osù_muãx_de°roy
(
osù
->
id_muãx
);

1035 
	`osù_‰ì
(
osù
);

1036 
	}
}

1038 
	$osù_£t_≠∂iˇti⁄_c⁄ãxt
(
osù_t
 *
osù
, *
poöãr
) {

1039 
osù
->
≠∂iˇti⁄_c⁄ãxt
 = 
poöãr
;

1040 
	}
}

1042 *
	$osù_gë_≠∂iˇti⁄_c⁄ãxt
(
osù_t
 *
osù
) {

1043 i‡(
osù
 =
NULL
)

1044  
NULL
;

1046  
osù
->
≠∂iˇti⁄_c⁄ãxt
;

1047 
	}
}

1049 
	$osù_i˘_execuã
(
osù_t
 *
osù
) {

1050 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

1051 
osù_evít_t
 *
£
;

1052 
m‹e_evít
;

1053 
osù_li°_ôî©‹_t
 
ôî©‹
;

1054 **
¨øy
;

1055 
Àn
;

1056 
ödex
 = 0;

1059 #i‚de‡
OSIP_MONOTHREAD


1060 
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

1062 
Àn
 = 
	`osù_li°_size
(&
osù
->
osù_i˘_å™ß˘i⁄s
);

1064 i‡(0 >
Àn
) {

1065 #i‚de‡
OSIP_MONOTHREAD


1066 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1068  
OSIP_SUCCESS
;

1071 
¨øy
 = 
	`osù_mÆloc
((*Ë* 
Àn
);

1073 i‡(
¨øy
 =
NULL
) {

1074 #i‚de‡
OSIP_MONOTHREAD


1075 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1077  
OSIP_NOMEM
;

1080 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i˘_å™ß˘i⁄s
, &
ôî©‹
);

1082 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1083 
¨øy
[
ödex
++] = 
å™ß˘i⁄
;

1084 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1087 #i‚de‡
OSIP_MONOTHREAD


1088 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1091 
ödex
 = 0; index < 
Àn
; ++index) {

1092 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
¨øy
[
ödex
];

1093 
m‹e_evít
 = 1;

1096 
£
 = (
osù_evít_t
 *Ë
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

1098 i‡(
£
 =
NULL
)

1099 
m‹e_evít
 = 0;

1102 
	`osù_å™ß˘i⁄_execuã
(
å™ß˘i⁄
, 
£
);

1103 } 
m‹e_evít
 == 1);

1106 
	`osù_‰ì
(
¨øy
);

1108  
OSIP_SUCCESS
;

1109 
	}
}

1111 
	$osù_i°_execuã
(
osù_t
 *
osù
) {

1112 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

1113 
osù_evít_t
 *
£
;

1114 
m‹e_evít
;

1115 
osù_li°_ôî©‹_t
 
ôî©‹
;

1116 **
¨øy
;

1117 
Àn
;

1118 
ödex
 = 0;

1121 #i‚de‡
OSIP_MONOTHREAD


1122 
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

1124 
Àn
 = 
	`osù_li°_size
(&
osù
->
osù_i°_å™ß˘i⁄s
);

1126 i‡(0 >
Àn
) {

1127 #i‚de‡
OSIP_MONOTHREAD


1128 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1130  
OSIP_SUCCESS
;

1133 
¨øy
 = 
	`osù_mÆloc
((*Ë* 
Àn
);

1135 i‡(
¨øy
 =
NULL
) {

1136 #i‚de‡
OSIP_MONOTHREAD


1137 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1139  
OSIP_NOMEM
;

1142 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i°_å™ß˘i⁄s
, &
ôî©‹
);

1144 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1145 
¨øy
[
ödex
++] = 
å™ß˘i⁄
;

1146 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1149 #i‚de‡
OSIP_MONOTHREAD


1150 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1153 
ödex
 = 0; index < 
Àn
; ++index) {

1154 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
¨øy
[
ödex
];

1155 
m‹e_evít
 = 1;

1158 
£
 = (
osù_evít_t
 *Ë
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

1160 i‡(
£
 =
NULL
)

1161 
m‹e_evít
 = 0;

1164 
	`osù_å™ß˘i⁄_execuã
(
å™ß˘i⁄
, 
£
);

1165 } 
m‹e_evít
 == 1);

1168 
	`osù_‰ì
(
¨øy
);

1170  
OSIP_SUCCESS
;

1171 
	}
}

1173 
	$osù_ni˘_execuã
(
osù_t
 *
osù
) {

1174 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

1175 
osù_evít_t
 *
£
;

1176 
m‹e_evít
;

1177 
osù_li°_ôî©‹_t
 
ôî©‹
;

1178 **
¨øy
;

1179 
Àn
;

1180 
ödex
 = 0;

1183 #i‚de‡
OSIP_MONOTHREAD


1184 
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

1186 
Àn
 = 
	`osù_li°_size
(&
osù
->
osù_ni˘_å™ß˘i⁄s
);

1188 i‡(0 >
Àn
) {

1189 #i‚de‡
OSIP_MONOTHREAD


1190 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1192  
OSIP_SUCCESS
;

1195 
¨øy
 = 
	`osù_mÆloc
((*Ë* 
Àn
);

1197 i‡(
¨øy
 =
NULL
) {

1198 #i‚de‡
OSIP_MONOTHREAD


1199 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1201  
OSIP_NOMEM
;

1204 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni˘_å™ß˘i⁄s
, &
ôî©‹
);

1206 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1207 
¨øy
[
ödex
++] = 
å™ß˘i⁄
;

1208 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1211 #i‚de‡
OSIP_MONOTHREAD


1212 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1215 
ödex
 = 0; index < 
Àn
; ++index) {

1216 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
¨øy
[
ödex
];

1217 
m‹e_evít
 = 1;

1220 
£
 = (
osù_evít_t
 *Ë
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

1222 i‡(
£
 =
NULL
)

1223 
m‹e_evít
 = 0;

1226 
	`osù_å™ß˘i⁄_execuã
(
å™ß˘i⁄
, 
£
);

1227 } 
m‹e_evít
 == 1);

1230 
	`osù_‰ì
(
¨øy
);

1232  
OSIP_SUCCESS
;

1233 
	}
}

1235 
	$osù_ni°_execuã
(
osù_t
 *
osù
) {

1236 
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
;

1237 
osù_evít_t
 *
£
;

1238 
m‹e_evít
;

1239 
osù_li°_ôî©‹_t
 
ôî©‹
;

1240 **
¨øy
;

1241 
Àn
;

1242 
ödex
 = 0;

1245 #i‚de‡
OSIP_MONOTHREAD


1246 
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

1248 
Àn
 = 
	`osù_li°_size
(&
osù
->
osù_ni°_å™ß˘i⁄s
);

1250 i‡(0 >
Àn
) {

1251 #i‚de‡
OSIP_MONOTHREAD


1252 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1254  
OSIP_SUCCESS
;

1257 
¨øy
 = 
	`osù_mÆloc
((*Ë* 
Àn
);

1259 i‡(
¨øy
 =
NULL
) {

1260 #i‚de‡
OSIP_MONOTHREAD


1261 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1263  
OSIP_NOMEM
;

1266 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni°_å™ß˘i⁄s
, &
ôî©‹
);

1268 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1269 
¨øy
[
ödex
++] = 
å™ß˘i⁄
;

1270 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1273 #i‚de‡
OSIP_MONOTHREAD


1274 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1277 
ödex
 = 0; index < 
Àn
; ++index) {

1278 
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
¨øy
[
ödex
];

1279 
m‹e_evít
 = 1;

1282 
£
 = (
osù_evít_t
 *Ë
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

1284 i‡(
£
 =
NULL
)

1285 
m‹e_evít
 = 0;

1288 
	`osù_å™ß˘i⁄_execuã
(
å™ß˘i⁄
, 
£
);

1289 } 
m‹e_evít
 == 1);

1292 
	`osù_‰ì
(
¨øy
);

1294  
OSIP_SUCCESS
;

1295 
	}
}

1297 
	$osù_timîs_gëtimeout
(
osù_t
 *
osù
, 
timevÆ
 *
lowî_tv
) {

1298 
timevÆ
 
now
;

1299 
osù_å™ß˘i⁄_t
 *
å
;

1300 
osù_li°_ôî©‹_t
 
ôî©‹
;

1302 
	`osù_gëtimeofday
(&
now
, 
NULL
);

1303 
lowî_tv
->
tv_£c
 = 
now
.tv_sec + 3600 * 24 * 365;

1304 
lowî_tv
->
tv_u£c
 = 
now
.tv_usec;

1306 #i‚de‡
OSIP_MONOTHREAD


1307 
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

1310 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i˘_å™ß˘i⁄s
, &
ôî©‹
);

1312 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1313 i‡(1 <
	`osù_fifo_size
(
å
->
å™ß˘i⁄ff
)) {

1314 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "1 PendingÉventálready inÅransaction !\n"));

1315 
lowî_tv
->
tv_£c
 = 0;

1316 
lowî_tv
->
tv_u£c
 = 0;

1317 #i‚de‡
OSIP_MONOTHREAD


1318 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1323 i‡(
å
->
°©e
 =
ICT_CALLING
)

1324 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i˘_c⁄ãxt
->
timî_b_°¨t
);

1326 i‡(
å
->
°©e
 =
ICT_CALLING
)

1327 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i˘_c⁄ãxt
->
timî_a_°¨t
);

1329 i‡(
å
->
°©e
 =
ICT_COMPLETED
)

1330 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i˘_c⁄ãxt
->
timî_d_°¨t
);

1332 i‡(
	`osù_timîcmp
(&
now
, 
lowî_tv
, >=)) {

1333 
lowî_tv
->
tv_£c
 = 0;

1334 
lowî_tv
->
tv_u£c
 = 0;

1335 #i‚de‡
OSIP_MONOTHREAD


1336 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1342 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1345 #i‚de‡
OSIP_MONOTHREAD


1346 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1349 #i‚de‡
OSIP_MONOTHREAD


1350 
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

1353 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i°_å™ß˘i⁄s
, &
ôî©‹
);

1355 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1356 i‡(
å
->
°©e
 =
IST_CONFIRMED
)

1357 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i°_c⁄ãxt
->
timî_i_°¨t
);

1359 i‡(
å
->
°©e
 =
IST_COMPLETED
)

1360 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i°_c⁄ãxt
->
timî_h_°¨t
);

1362 i‡(
å
->
°©e
 =
IST_COMPLETED
)

1363 
	`mö_timîcmp
(
lowî_tv
, &
å
->
i°_c⁄ãxt
->
timî_g_°¨t
);

1365 i‡(
	`osù_timîcmp
(&
now
, 
lowî_tv
, >=)) {

1366 
lowî_tv
->
tv_£c
 = 0;

1367 
lowî_tv
->
tv_u£c
 = 0;

1368 #i‚de‡
OSIP_MONOTHREAD


1369 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1374 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1377 #i‚de‡
OSIP_MONOTHREAD


1378 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1381 #i‚de‡
OSIP_MONOTHREAD


1382 
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

1385 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni˘_å™ß˘i⁄s
, &
ôî©‹
);

1387 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1388 i‡(
å
->
°©e
 =
NICT_COMPLETED
)

1389 
	`mö_timîcmp
(
lowî_tv
, &
å
->
ni˘_c⁄ãxt
->
timî_k_°¨t
);

1391 i‡(
å
->
°©e
 =
NICT_PROCEEDING
 ||År->°©ê=
NICT_TRYING
)

1392 
	`mö_timîcmp
(
lowî_tv
, &
å
->
ni˘_c⁄ãxt
->
timî_f_°¨t
);

1394 i‡(
å
->
°©e
 =
NICT_PROCEEDING
 ||År->°©ê=
NICT_TRYING
)

1395 
	`mö_timîcmp
(
lowî_tv
, &
å
->
ni˘_c⁄ãxt
->
timî_e_°¨t
);

1397 i‡(
	`osù_timîcmp
(&
now
, 
lowî_tv
, >=)) {

1398 
lowî_tv
->
tv_£c
 = 0;

1399 
lowî_tv
->
tv_u£c
 = 0;

1400 #i‚de‡
OSIP_MONOTHREAD


1401 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1406 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1409 #i‚de‡
OSIP_MONOTHREAD


1410 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1413 #i‚de‡
OSIP_MONOTHREAD


1414 
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

1417 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni°_å™ß˘i⁄s
, &
ôî©‹
);

1419 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1420 i‡(
å
->
°©e
 =
NIST_COMPLETED
)

1421 
	`mö_timîcmp
(
lowî_tv
, &
å
->
ni°_c⁄ãxt
->
timî_j_°¨t
);

1423 i‡(
	`osù_timîcmp
(&
now
, 
lowî_tv
, >=)) {

1424 
lowî_tv
->
tv_£c
 = 0;

1425 
lowî_tv
->
tv_u£c
 = 0;

1426 #i‚de‡
OSIP_MONOTHREAD


1427 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1432 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1435 #i‚de‡
OSIP_MONOTHREAD


1436 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1439 #i‚de‡
OSIP_MONOTHREAD


1440 
	`osù_muãx_lock
(
osù
->
ixt_Á°muãx
);

1443 
ixt_t
 *
ixt
;

1445 
ixt
 = (
ixt_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
ixt_ªå™smissi⁄s
, &
ôî©‹
);

1447 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1448 
	`mö_timîcmp
(
lowî_tv
, &
ixt
->
°¨t
);

1450 i‡(
	`osù_timîcmp
(&
now
, 
lowî_tv
, >=)) {

1451 
lowî_tv
->
tv_£c
 = 0;

1452 
lowî_tv
->
tv_u£c
 = 0;

1453 #i‚de‡
OSIP_MONOTHREAD


1454 
	`osù_muãx_u∆ock
(
osù
->
ixt_Á°muãx
);

1459 
ixt
 = (
ixt_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1462 #i‚de‡
OSIP_MONOTHREAD


1463 
	`osù_muãx_u∆ock
(
osù
->
ixt_Á°muãx
);

1466 
lowî_tv
->
tv_£c
 =Üowî_tv->tv_£¯- 
now
.tv_sec;

1467 
lowî_tv
->
tv_u£c
 =Üowî_tv->tv_u£¯- 
now
.tv_usec;

1470 i‡(
lowî_tv
->
tv_u£c
 < 0) {

1471 
lowî_tv
->
tv_u£c
 =Üower_tv->tv_usec + 1000000;

1472 
lowî_tv
->
tv_£c
--;

1475 i‡(
lowî_tv
->
tv_£c
 < 0) {

1476 
lowî_tv
->
tv_£c
 = 0;

1477 
lowî_tv
->
tv_u£c
 = 0;

1480 i‡(
lowî_tv
->
tv_u£c
 > 1000000) {

1481 
lowî_tv
->
tv_u£c
 =Üower_tv->tv_usec - 1000000;

1482 
lowî_tv
->
tv_£c
++;

1486 
	}
}

1488 
	$osù_timîs_i˘_execuã
(
osù_t
 *
osù
) {

1489 
osù_å™ß˘i⁄_t
 *
å
;

1490 
osù_li°_ôî©‹_t
 
ôî©‹
;

1492 #i‚de‡
OSIP_MONOTHREAD


1493 
	`osù_muãx_lock
(
osù
->
i˘_Á°muãx
);

1496 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i˘_å™ß˘i⁄s
, &
ôî©‹
);

1498 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1499 
osù_evít_t
 *
evt
;

1501 i‡(1 <
	`osù_fifo_size
(
å
->
å™ß˘i⁄ff
)) {

1502 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "1 PendingÉventálready inÅransaction !\n"));

1505 
evt
 = 
	`__osù_i˘_√ed_timî_b_evít
(
å
->
i˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1507 i‡(
evt
 !
NULL
)

1508 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1511 
evt
 = 
	`__osù_i˘_√ed_timî_a_evít
(
å
->
i˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1513 i‡(
evt
 !
NULL
)

1514 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1517 
evt
 = 
	`__osù_i˘_√ed_timî_d_evít
(
å
->
i˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1519 i‡(
evt
 !
NULL
)

1520 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1525 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1528 #i‚de‡
OSIP_MONOTHREAD


1529 
	`osù_muãx_u∆ock
(
osù
->
i˘_Á°muãx
);

1531 
	}
}

1533 
	$osù_timîs_i°_execuã
(
osù_t
 *
osù
) {

1534 
osù_å™ß˘i⁄_t
 *
å
;

1535 
osù_li°_ôî©‹_t
 
ôî©‹
;

1537 #i‚de‡
OSIP_MONOTHREAD


1538 
	`osù_muãx_lock
(
osù
->
i°_Á°muãx
);

1541 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_i°_å™ß˘i⁄s
, &
ôî©‹
);

1543 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1544 
osù_evít_t
 *
evt
;

1546 
evt
 = 
	`__osù_i°_√ed_timî_i_evít
(
å
->
i°_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1548 i‡(
evt
 !
NULL
)

1549 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1552 
evt
 = 
	`__osù_i°_√ed_timî_h_evít
(
å
->
i°_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1554 i‡(
evt
 !
NULL
)

1555 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1558 
evt
 = 
	`__osù_i°_√ed_timî_g_evít
(
å
->
i°_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1560 i‡(
evt
 !
NULL
)

1561 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1565 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1568 #i‚de‡
OSIP_MONOTHREAD


1569 
	`osù_muãx_u∆ock
(
osù
->
i°_Á°muãx
);

1571 
	}
}

1573 
	$osù_timîs_ni˘_execuã
(
osù_t
 *
osù
) {

1574 
osù_å™ß˘i⁄_t
 *
å
;

1575 
osù_li°_ôî©‹_t
 
ôî©‹
;

1577 #i‚de‡
OSIP_MONOTHREAD


1578 
	`osù_muãx_lock
(
osù
->
ni˘_Á°muãx
);

1581 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni˘_å™ß˘i⁄s
, &
ôî©‹
);

1583 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1584 
osù_evít_t
 *
evt
;

1586 
evt
 = 
	`__osù_ni˘_√ed_timî_k_evít
(
å
->
ni˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1588 i‡(
evt
 !
NULL
)

1589 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1592 
evt
 = 
	`__osù_ni˘_√ed_timî_f_evít
(
å
->
ni˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1594 i‡(
evt
 !
NULL
)

1595 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1598 
evt
 = 
	`__osù_ni˘_√ed_timî_e_evít
(
å
->
ni˘_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1600 i‡(
evt
 !
NULL
)

1601 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1605 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1608 #i‚de‡
OSIP_MONOTHREAD


1609 
	`osù_muãx_u∆ock
(
osù
->
ni˘_Á°muãx
);

1611 
	}
}

1613 
	$osù_timîs_ni°_execuã
(
osù_t
 *
osù
) {

1614 
osù_å™ß˘i⁄_t
 *
å
;

1615 
osù_li°_ôî©‹_t
 
ôî©‹
;

1617 #i‚de‡
OSIP_MONOTHREAD


1618 
	`osù_muãx_lock
(
osù
->
ni°_Á°muãx
);

1621 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_fú°
(&
osù
->
osù_ni°_å™ß˘i⁄s
, &
ôî©‹
);

1623 
	`osù_li°_ôî©‹_has_ñem
(
ôî©‹
)) {

1624 
osù_evít_t
 *
evt
;

1626 
evt
 = 
	`__osù_ni°_√ed_timî_j_evít
(
å
->
ni°_c⁄ãxt
,År->
°©e
,År->
å™ß˘i⁄id
);

1628 i‡(
evt
 !
NULL
)

1629 
	`osù_fifo_add
(
å
->
å™ß˘i⁄ff
, 
evt
);

1631 
å
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_li°_gë_√xt
(&
ôî©‹
);

1634 #i‚de‡
OSIP_MONOTHREAD


1635 
	`osù_muãx_u∆ock
(
osù
->
ni°_Á°muãx
);

1637 
	}
}

1639 
	$osù_£t_cb_£nd_mesßge
(
osù_t
 *
cf
, (*
cb
)(
osù_å™ß˘i⁄_t
 *, 
osù_mesßge_t
 *, *, , )) {

1640 
cf
->
cb_£nd_mesßge
 = 
cb
;

1641 
	}
}

1643 
	$__osù_mesßge_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
msg
) {

1644 
osù_t
 *
c⁄fig
 = 
å
->config;

1646 i‡(
ty≥
 >
OSIP_MESSAGE_CALLBACK_COUNT
) {

1647 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1651 i‡(
c⁄fig
->
msg_ˇŒbacks
[
ty≥
] =
NULL
)

1654 
c⁄fig
->
msg_ˇŒbacks
[
ty≥
]—y≥, 
å
, 
msg
);

1655 
	}
}

1657 
	$__osù_kûl_å™ß˘i⁄_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *
å
) {

1658 
osù_t
 *
c⁄fig
 = 
å
->config;

1660 i‡(
ty≥
 >
OSIP_KILL_CALLBACK_COUNT
) {

1661 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1665 
å
->
com∂ëed_time
 = 
	`osù_gësy°emtime
(
NULL
);

1666 
	`osù_gëtimeofday
(&
å
->
de°royed_time
, 
NULL
);

1668 i‡(
c⁄fig
->
kûl_ˇŒbacks
[
ty≥
] =
NULL
)

1671 
c⁄fig
->
kûl_ˇŒbacks
[
ty≥
]—y≥, 
å
);

1672 
	}
}

1674 
	$__osù_å™•‹t_îr‹_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *
å
, 
îr‹
) {

1675 
osù_t
 *
c⁄fig
 = 
å
->config;

1677 i‡(
ty≥
 >
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
) {

1678 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1682 i‡(
c⁄fig
->
ç_îr‹_ˇŒbacks
[
ty≥
] =
NULL
)

1685 
c⁄fig
->
ç_îr‹_ˇŒbacks
[
ty≥
]—y≥, 
å
, 
îr‹
);

1686 
	}
}

1688 
	$osù_£t_mesßge_ˇŒback
(
osù_t
 *
c⁄fig
, 
ty≥
, 
osù_mesßge_cb_t
 
cb
) {

1689 i‡(
ty≥
 >
OSIP_MESSAGE_CALLBACK_COUNT
) {

1690 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1691  
OSIP_BADPARAMETER
;

1694 
c⁄fig
->
msg_ˇŒbacks
[
ty≥
] = 
cb
;

1696  
OSIP_SUCCESS
;

1697 
	}
}

1699 
	$osù_£t_kûl_å™ß˘i⁄_ˇŒback
(
osù_t
 *
c⁄fig
, 
ty≥
, 
osù_kûl_å™ß˘i⁄_cb_t
 
cb
) {

1700 i‡(
ty≥
 >
OSIP_KILL_CALLBACK_COUNT
) {

1701 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1702  
OSIP_BADPARAMETER
;

1705 
c⁄fig
->
kûl_ˇŒbacks
[
ty≥
] = 
cb
;

1706  
OSIP_SUCCESS
;

1707 
	}
}

1709 
	$osù_£t_å™•‹t_îr‹_ˇŒback
(
osù_t
 *
c⁄fig
, 
ty≥
, 
osù_å™•‹t_îr‹_cb_t
 
cb
) {

1710 i‡(
ty≥
 >
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
) {

1711 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "övÆid cÆlbackÅy≥ %d\n", 
ty≥
));

1712  
OSIP_BADPARAMETER
;

1715 
c⁄fig
->
ç_îr‹_ˇŒbacks
[
ty≥
] = 
cb
;

1716  
OSIP_SUCCESS
;

1717 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_dialog.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~<osù2/osù_dülog.h
>

26 
	$osù_dülog_£t_°©e
(
osù_dülog_t
 *
dülog
, 
°©e_t
 
°©e
) {

27 i‡(
dülog
 =
NULL
)

30 
dülog
->
°©e
 = state;

31 
	}
}

33 
	$osù_dülog_upd©e_rouã_£t_as_uas
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
övôe
) {

34 
osù_c⁄è˘_t
 *
c⁄è˘
;

35 
i
;

37 i‡(
dülog
 =
NULL
)

38  
OSIP_BADPARAMETER
;

40 i‡(
övôe
 =
NULL
)

41  
OSIP_BADPARAMETER
;

43 i‡(
	`osù_li°_eﬁ
(&
övôe
->
c⁄è˘s
, 0)) {

44 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "missingá contact in invite!\n"));

47 i‡(
dülog
->
ªmŸe_c⁄è˘_uri
 !
NULL
) {

48 
	`osù_c⁄è˘_‰ì
(
dülog
->
ªmŸe_c⁄è˘_uri
);

51 
dülog
->
ªmŸe_c⁄è˘_uri
 = 
NULL
;

52 
c⁄è˘
 = 
	`osù_li°_gë
(&
övôe
->
c⁄è˘s
, 0);

53 
i
 = 
	`osù_c⁄è˘_˛⁄e
(
c⁄è˘
, &(
dülog
->
ªmŸe_c⁄è˘_uri
));

55 i‡(
i
 != 0)

56  
i
;

59  
OSIP_SUCCESS
;

60 
	}
}

62 
	$osù_dülog_upd©e_osù_c£q_as_uas
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
övôe
) {

63 i‡(
dülog
 =
NULL
)

64  
OSIP_BADPARAMETER
;

66 i‡(
övôe
 =
NULL
 || invôe->
c£q
 =NULL || invôe->c£q->
numbî
 == NULL)

67  
OSIP_BADPARAMETER
;

69 
dülog
->
ªmŸe_c£q
 = 
	`osù_©oi
(
övôe
->
c£q
->
numbî
);

70  
OSIP_SUCCESS
;

71 
	}
}

73 
	$osù_dülog_upd©e_rouã_£t_as_uac
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ª•⁄£
) {

75 
osù_c⁄è˘_t
 *
c⁄è˘
;

76 
i
;

78 i‡(
dülog
 =
NULL
)

79  
OSIP_BADPARAMETER
;

81 i‡(
ª•⁄£
 =
NULL
)

82  
OSIP_BADPARAMETER
;

84 i‡(
	`osù_li°_eﬁ
(&
ª•⁄£
->
c⁄è˘s
, 0)) {

85 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "missingá contact inÑesponse!\n"));

90 i‡(
dülog
->
ªmŸe_c⁄è˘_uri
 !
NULL
) {

91 
	`osù_c⁄è˘_‰ì
(
dülog
->
ªmŸe_c⁄è˘_uri
);

94 
dülog
->
ªmŸe_c⁄è˘_uri
 = 
NULL
;

95 
c⁄è˘
 = 
	`osù_li°_gë
(&
ª•⁄£
->
c⁄è˘s
, 0);

96 
i
 = 
	`osù_c⁄è˘_˛⁄e
(
c⁄è˘
, &(
dülog
->
ªmŸe_c⁄è˘_uri
));

98 i‡(
i
 != 0)

99  
i
;

102 i‡(
dülog
->
°©e
 =
DIALOG_EARLY
 && 
	`osù_li°_size
(&dülog->
rouã_£t
) > 0) {

103 
	`osù_li°_•ecül_‰ì
(&
dülog
->
rouã_£t
, ((*)(*)Ë& 
osù_ªc‹d_rouã_‰ì
);

104 
	`osù_li°_öô
(&
dülog
->
rouã_£t
);

107 i‡(
dülog
->
°©e
 =
DIALOG_EARLY
 && 
	`osù_li°_size
(&dülog->
rouã_£t
) == 0) {

108 
pos
 = 0;

110 !
	`osù_li°_eﬁ
(&
ª•⁄£
->
ªc‹d_rouãs
, 
pos
)) {

111 
osù_ªc‹d_rouã_t
 *
º
;

112 
osù_ªc‹d_rouã_t
 *
º2
;

114 
º
 = (
osù_ªc‹d_rouã_t
 *Ë
	`osù_li°_gë
(&
ª•⁄£
->
ªc‹d_rouãs
, 
pos
);

115 
i
 = 
	`osù_ªc‹d_rouã_˛⁄e
(
º
, &
º2
);

117 i‡(
i
 != 0)

118  
i
;

120 
	`osù_li°_add
(&
dülog
->
rouã_£t
, 
º2
, 0);

121 
pos
++;

125 i‡(
	`MSG_IS_STATUS_2XX
(
ª•⁄£
))

126 
dülog
->
°©e
 = 
DIALOG_CONFIRMED
;

128  
OSIP_SUCCESS
;

129 
	}
}

131 
	$osù_dülog_upd©e_èg_as_uac
(
osù_dülog_t
 *
dülog
, 
osù_mesßge_t
 *
ª•⁄£
) {

132 
osù_gíîic_∑øm_t
 *
èg
;

133 
i
;

135 i‡(
dülog
 =
NULL
)

136  
OSIP_BADPARAMETER
;

138 i‡(
ª•⁄£
 =
NULL
 ||Ñe•⁄£->
to
 == NULL)

139  
OSIP_BADPARAMETER
;

141 i‡(
dülog
->
ªmŸe_èg
 !
NULL
) {

142 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "This dialogálready haveáÑemoteÅag: it can't be changed!\n"));

143  
OSIP_WRONG_STATE
;

146 
i
 = 
	`osù_to_gë_èg
(
ª•⁄£
->
to
, &
èg
);

148 i‡(
i
 !0 || 
èg
 =
NULL
 ||Åag->
gvÆue
 == NULL) {

149 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA isÇot compliant: missingáÅag inÑesponse!\n"));

150 
dülog
->
ªmŸe_èg
 = 
NULL
;

153 
dülog
->
ªmŸe_èg
 = 
	`osù_°rdup
(
èg
->
gvÆue
);

155  
OSIP_SUCCESS
;

156 
	}
}

158 
	$osù_dülog_m©ch_as_uac
(
osù_dülog_t
 *
dlg
, 
osù_mesßge_t
 *
™swî
) {

159 
osù_gíîic_∑øm_t
 *
èg_∑øm_loˇl
;

160 
osù_gíîic_∑øm_t
 *
èg_∑øm_ªmŸe
;

161 *
tmp
;

162 
i
;

164 i‡(
dlg
 =
NULL
 || dlg->
ˇŒ_id
 == NULL)

165  
OSIP_BADPARAMETER
;

167 i‡(
™swî
 =
NULL
 ||ánswî->
ˇŒ_id
 =NULL ||ánswî->
‰om
 =NULL ||ánswî->
to
 == NULL)

168  
OSIP_BADPARAMETER
;

170 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "UsingÅhis method is discouraged. See source codeÉxplanations!\n"));

183 
i
 = 
	`osù_ˇŒ_id_to_°r
(
™swî
->
ˇŒ_id
, &
tmp
);

185 i‡(
i
 != 0)

186  
i
;

188 i‡(0 !
	`°rcmp
(
dlg
->
ˇŒ_id
, 
tmp
)) {

189 
	`osù_‰ì
(
tmp
);

190  
OSIP_UNDEFINED_ERROR
;

193 
	`osù_‰ì
(
tmp
);

199 
i
 = 
	`osù_‰om_gë_èg
(
™swî
->
‰om
, &
èg_∑øm_loˇl
);

201 i‡(
i
 != 0)

202  
OSIP_SYNTAXERROR
;

204 i‡(
dlg
->
loˇl_èg
 =
NULL
)

206  
OSIP_SYNTAXERROR
;

208 i‡(0 !
	`°rcmp
(
èg_∑øm_loˇl
->
gvÆue
, 
dlg
->
loˇl_èg
))

209  
OSIP_UNDEFINED_ERROR
;

211 
i
 = 
	`osù_to_gë_èg
(
™swî
->
to
, &
èg_∑øm_ªmŸe
);

213 i‡(
i
 !0 && 
dlg
->
ªmŸe_èg
 !
NULL
)

214  
OSIP_SYNTAXERROR
;

216 i‡(
i
 !0 && 
dlg
->
ªmŸe_èg
 =
NULL
) {

217 i‡(0 =
	`osù_‰om_com∑ª
((
osù_‰om_t
 *Ë
dlg
->
loˇl_uri
, (osù_‰om_à*Ë
™swî
->
‰om
Ë&& 0 =osù_‰om_com∑ª(dlg->
ªmŸe_uri
,ánswî->
to
))

218  
OSIP_SUCCESS
;

220  
OSIP_UNDEFINED_ERROR
;

223 i‡(
dlg
->
ªmŸe_èg
 =
NULL
) {

224 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA isÇot compliant: missingáÅag in To fields!\n"));

226 i‡(0 =
	`osù_‰om_com∑ª
((
osù_‰om_t
 *Ë
dlg
->
loˇl_uri
, (osù_‰om_à*Ë
™swî
->
‰om
Ë&& 0 =osù_‰om_com∑ª(dlg->
ªmŸe_uri
,ánswî->
to
))

227  
OSIP_SUCCESS
;

229  
OSIP_UNDEFINED_ERROR
;

236 i‡(0 =
	`°rcmp
(
èg_∑øm_ªmŸe
->
gvÆue
, 
dlg
->
ªmŸe_èg
))

237  
OSIP_SUCCESS
;

239  
OSIP_UNDEFINED_ERROR
;

240 
	}
}

242 
	$osù_dülog_m©ch_as_uas
(
osù_dülog_t
 *
dlg
, 
osù_mesßge_t
 *
ªque°
) {

243 
osù_gíîic_∑øm_t
 *
èg_∑øm_ªmŸe
;

244 
i
;

245 *
tmp
;

247 i‡(
dlg
 =
NULL
 || dlg->
ˇŒ_id
 == NULL)

248  
OSIP_BADPARAMETER
;

250 i‡(
ªque°
 =
NULL
 ||Ñeque°->
ˇŒ_id
 =NULL ||Ñeque°->
‰om
 =NULL ||Ñeque°->
to
 == NULL)

251  
OSIP_BADPARAMETER
;

253 
i
 = 
	`osù_ˇŒ_id_to_°r
(
ªque°
->
ˇŒ_id
, &
tmp
);

255 i‡(
i
 != 0)

256  
i
;

258 i‡(0 !
	`°rcmp
(
dlg
->
ˇŒ_id
, 
tmp
)) {

259 
	`osù_‰ì
(
tmp
);

260  
OSIP_UNDEFINED_ERROR
;

263 
	`osù_‰ì
(
tmp
);

270 i‡(
dlg
->
loˇl_èg
 =
NULL
)

272  
OSIP_SYNTAXERROR
;

277 i‡(
dlg
->
löe_∑øm
) {

278 
osù_uri_∑øm_t
 *
löe_∑øm
;

280 
i
 = 
	`osù_uri_∑øm_gë_by«me
(&
ªque°
->
ªq_uri
->
uæ_∑øms
, "löe", &
löe_∑øm
);

282 i‡(
i
 =0 && 
	`°rcmp
(
dlg
->
löe_∑øm
,Üöe_∑øm->
gvÆue
))

283  
OSIP_UNDEFINED_ERROR
;

288 
i
 = 
	`osù_‰om_gë_èg
(
ªque°
->
‰om
, &
èg_∑øm_ªmŸe
);

290 i‡(
i
 !0 && 
dlg
->
ªmŸe_èg
 !
NULL
)

291  
OSIP_SYNTAXERROR
;

293 i‡(
i
 !0 && 
dlg
->
ªmŸe_èg
 =
NULL
) {

294 i‡(0 =
	`osù_‰om_com∑ª
((
osù_‰om_t
 *Ë
dlg
->
ªmŸe_uri
, (osù_‰om_à*Ë
ªque°
->
‰om
Ë&& 0 =osù_‰om_com∑ª(dlg->
loˇl_uri
,Ñeque°->
to
))

295  
OSIP_SUCCESS
;

297  
OSIP_UNDEFINED_ERROR
;

300 i‡(
dlg
->
ªmŸe_èg
 =
NULL
) {

301 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA isÇot compliant: missingáÅag in To feilds!\n"));

303 i‡(0 =
	`osù_‰om_com∑ª
((
osù_‰om_t
 *Ë
dlg
->
ªmŸe_uri
, (osù_‰om_à*Ë
ªque°
->
‰om
Ë&& 0 =osù_‰om_com∑ª(dlg->
loˇl_uri
,Ñeque°->
to
))

304  
OSIP_SUCCESS
;

306  
OSIP_UNDEFINED_ERROR
;

313 i‡(0 =
	`°rcmp
(
èg_∑øm_ªmŸe
->
gvÆue
, 
dlg
->
ªmŸe_èg
))

314  
OSIP_SUCCESS
;

316  
OSIP_UNDEFINED_ERROR
;

317 
	}
}

319 
	$__osù_dülog_öô
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
övôe
, osù_mesßge_à*
ª•⁄£
, 
osù_‰om_t
 *
loˇl
, 
osù_to_t
 *
ªmŸe
, osù_mesßge_à*
ªmŸe_msg
) {

320 
i
;

321 
pos
;

322 
osù_gíîic_∑øm_t
 *
èg
;

324 *
dülog
 = 
NULL
;

326 i‡(
ª•⁄£
 =
NULL
)

327  
OSIP_BADPARAMETER
;

329 i‡(
ª•⁄£
->
c£q
 =
NULL
 || 
loˇl
 =NULL || 
ªmŸe
 == NULL)

330  
OSIP_SYNTAXERROR
;

332 (*
dülog
Ë(
osù_dülog_t
 *Ë
	`osù_mÆloc
((osip_dialog_t));

334 i‡(*
dülog
 =
NULL
)

335  
OSIP_NOMEM
;

337 
	`mem£t
(*
dülog
, 0, (
osù_dülog_t
));

338 (*
dülog
)->
your_ö°™˚
 = 
NULL
;

340 i‡(
	`MSG_IS_STATUS_2XX
(
ª•⁄£
))

341 (*
dülog
)->
°©e
 = 
DIALOG_CONFIRMED
;

344 (*
dülog
)->
°©e
 = 
DIALOG_EARLY
;

346 
i
 = 
	`osù_ˇŒ_id_to_°r
(
ª•⁄£
->
ˇŒ_id
, &((*
dülog
)->call_id));

348 i‡(
i
 != 0) {

349 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

350 
	`osù_dülog_‰ì
(*
dülog
);

351 *
dülog
 = 
NULL
;

352  
i
;

355 
i
 = 
	`osù_to_gë_èg
(
loˇl
, &
èg
);

357 i‡(
i
 != 0) {

358 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

359 
	`osù_dülog_‰ì
(*
dülog
);

360 *
dülog
 = 
NULL
;

361  
i
;

364 (*
dülog
)->
loˇl_èg
 = 
	`osù_°rdup
(
èg
->
gvÆue
);

366 
i
 = 
	`osù_‰om_gë_èg
(
ªmŸe
, &
èg
);

368 i‡(
i
 == 0)

369 (*
dülog
)->
ªmŸe_èg
 = 
	`osù_°rdup
(
èg
->
gvÆue
);

372 i‡(
övôe
) {

373 
osù_uri_∑øm_t
 *
löe_∑øm
;

375 
i
 = 
	`osù_uri_∑øm_gë_by«me
(&
övôe
->
ªq_uri
->
uæ_∑øms
, "löe", &
löe_∑øm
);

377 i‡(
i
 =0 && 
löe_∑øm
 !
NULL
 &&Üöe_∑øm->
gvÆue
 != NULL)

378 (*
dülog
)->
löe_∑øm
 = 
	`osù_°rdup
÷öe_∑øm->
gvÆue
);

381 
	`osù_li°_öô
(&(*
dülog
)->
rouã_£t
);

383 
pos
 = 0;

385 !
	`osù_li°_eﬁ
(&
ª•⁄£
->
ªc‹d_rouãs
, 
pos
)) {

386 
osù_ªc‹d_rouã_t
 *
º
;

387 
osù_ªc‹d_rouã_t
 *
º2
;

389 
º
 = (
osù_ªc‹d_rouã_t
 *Ë
	`osù_li°_gë
(&
ª•⁄£
->
ªc‹d_rouãs
, 
pos
);

390 
i
 = 
	`osù_ªc‹d_rouã_˛⁄e
(
º
, &
º2
);

392 i‡(
i
 != 0) {

393 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

394 
	`osù_dülog_‰ì
(*
dülog
);

395 *
dülog
 = 
NULL
;

396  
i
;

399 i‡(
övôe
 =
NULL
)

400 
	`osù_li°_add
(&(*
dülog
)->
rouã_£t
, 
º2
, 0);

403 
	`osù_li°_add
(&(*
dülog
)->
rouã_£t
, 
º2
, -1);

405 
pos
++;

410 (*
dülog
)->
loˇl_c£q
 = 
	`osù_©oi
(
ª•⁄£
->
c£q
->
numbî
);

412 
i
 = 
	`osù_‰om_˛⁄e
(
ªmŸe
, &((*
dülog
)->
ªmŸe_uri
));

414 i‡(
i
 != 0) {

415 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

416 
	`osù_dülog_‰ì
(*
dülog
);

417 *
dülog
 = 
NULL
;

418  
i
;

421 
i
 = 
	`osù_to_˛⁄e
(
loˇl
, &((*
dülog
)->
loˇl_uri
));

423 i‡(
i
 != 0) {

424 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

425 
	`osù_dülog_‰ì
(*
dülog
);

426 *
dülog
 = 
NULL
;

427  
i
;

431 
osù_c⁄è˘_t
 *
c⁄è˘
;

433 i‡(!
	`osù_li°_eﬁ
(&
ªmŸe_msg
->
c⁄è˘s
, 0)) {

434 
c⁄è˘
 = 
	`osù_li°_gë
(&
ªmŸe_msg
->
c⁄è˘s
, 0);

435 
i
 = 
	`osù_c⁄è˘_˛⁄e
(
c⁄è˘
, &((*
dülog
)->
ªmŸe_c⁄è˘_uri
));

437 i‡(
i
 != 0) {

438 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÉstablish dialog!\n"));

439 
	`osù_dülog_‰ì
(*
dülog
);

440 *
dülog
 = 
NULL
;

441  
i
;

445 (*
dülog
)->
ªmŸe_c⁄è˘_uri
 = 
NULL
;

446 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA isÇot compliant: missingá contact inÑemote message!\n"));

450 (*
dülog
)->
£cuª
 = -1;

452  
OSIP_SUCCESS
;

453 
	}
}

455 
	$osù_dülog_öô_as_uac
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
ª•⁄£
) {

456 
i
;

458 
i
 = 
	`__osù_dülog_öô
(
dülog
, 
NULL
, 
ª•⁄£
,Ñe•⁄£->
‰om
,Ñe•⁄£->
to
,Ñesponse);

460 i‡(
i
 != 0) {

461 *
dülog
 = 
NULL
;

462  
i
;

465 (*
dülog
)->
ty≥
 = 
CALLER
;

466 (*
dülog
)->
ªmŸe_c£q
 = -1;

468  
OSIP_SUCCESS
;

469 
	}
}

472 
	$osù_dülog_öô_as_uac_wôh_ªmŸe_ªque°
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
√xt_ªque°
, 
loˇl_c£q
) {

473 
i
;

475 *
dülog
 = 
NULL
;

477 i‡(
√xt_ªque°
->
c£q
 =
NULL
)

478  
OSIP_BADPARAMETER
;

480 
i
 = 
	`__osù_dülog_öô
(
dülog
, 
√xt_ªque°
,Çext_ªque°,Çext_ªque°->
to
,Çext_ªque°->
‰om
,Çext_request);

482 i‡(
i
 != 0) {

483 *
dülog
 = 
NULL
;

484  
i
;

487 (*
dülog
)->
ty≥
 = 
CALLER
;

488 (*
dülog
)->
°©e
 = 
DIALOG_CONFIRMED
;

490 (*
dülog
)->
loˇl_c£q
 =Üocal_cseq;

491 (*
dülog
)->
ªmŸe_c£q
 = 
	`osù_©oi
(
√xt_ªque°
->
c£q
->
numbî
);

493  
OSIP_SUCCESS
;

494 
	}
}

496 
	$osù_dülog_öô_as_uas
(
osù_dülog_t
 **
dülog
, 
osù_mesßge_t
 *
övôe
, osù_mesßge_à*
ª•⁄£
) {

497 
i
;

499 *
dülog
 = 
NULL
;

501 i‡(
ª•⁄£
->
c£q
 =
NULL
)

502  
OSIP_SYNTAXERROR
;

504 
i
 = 
	`__osù_dülog_öô
(
dülog
, 
övôe
, 
ª•⁄£
,Ñe•⁄£->
to
,Ñe•⁄£->
‰om
, invite);

506 i‡(
i
 != 0) {

507 *
dülog
 = 
NULL
;

508  
i
;

511 (*
dülog
)->
ty≥
 = 
CALLEE
;

512 (*
dülog
)->
ªmŸe_c£q
 = 
	`osù_©oi
(
ª•⁄£
->
c£q
->
numbî
);

514  
OSIP_SUCCESS
;

515 
	}
}

517 
	$osù_dülog_‰ì
(
osù_dülog_t
 *
dülog
) {

518 i‡(
dülog
 =
NULL
)

521 
	`osù_c⁄è˘_‰ì
(
dülog
->
ªmŸe_c⁄è˘_uri
);

522 
	`osù_‰om_‰ì
(
dülog
->
loˇl_uri
);

523 
	`osù_to_‰ì
(
dülog
->
ªmŸe_uri
);

524 
	`osù_li°_•ecül_‰ì
(&
dülog
->
rouã_£t
, ((*)(*)Ë& 
osù_ªc‹d_rouã_‰ì
);

525 
	`osù_‰ì
(
dülog
->
löe_∑øm
);

526 
	`osù_‰ì
(
dülog
->
ªmŸe_èg
);

527 
	`osù_‰ì
(
dülog
->
loˇl_èg
);

528 
	`osù_‰ì
(
dülog
->
ˇŒ_id
);

529 
	`osù_‰ì
(
dülog
);

530 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_event.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

28 
osù_evít_t
 *
	$osù_∑r£
(c⁄° *
buf
, 
size_t
 
Àngth
) {

29 
i
;

30 
osù_evít_t
 *
£
 = 
	`__osù_evít_√w
(
UNKNOWN_EVT
, 0);

32 i‡(
£
 =
NULL
)

33  
NULL
;

36 
i
 = 
	`osù_mesßge_öô
(&(
£
->
sù
));

38 i‡(
i
 != 0) {

39 
	`osù_‰ì
(
£
);

40  
NULL
;

43 i‡(
	`osù_mesßge_∑r£
(
£
->
sù
, 
buf
, 
Àngth
) != 0) {

44 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "couldÇotÖarse message\n"));

45 
	`osù_mesßge_‰ì
(
£
->
sù
);

46 
	`osù_‰ì
(
£
);

47  
NULL
;

50 i‡(
£
->
sù
->
ˇŒ_id
 !
NULL
 && se->sù->ˇŒ_id->
numbî
 != NULL) {

51 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO3
, 
NULL
, "MESSAGE REC. CALLID:%s\n", 
£
->
sù
->
ˇŒ_id
->
numbî
));

54 i‡(
	`MSG_IS_REQUEST
(
£
->
sù
)) {

55 i‡(
£
->
sù
->
sù_mëhod
 =
NULL
 || se->sù->
ªq_uri
 == NULL) {

56 
	`osù_mesßge_‰ì
(
£
->
sù
);

57 
	`osù_‰ì
(
£
);

58  
NULL
;

62 
£
->
ty≥
 = 
	`evt_£t_ty≥_öcomög_sùmesßge
(£->
sù
);

63  
£
;

65 
	}
}

72 
osù_evít_t
 *
	$__osù_evít_√w
(
ty≥_t
 
ty≥
, 
å™ß˘i⁄id
) {

73 
osù_evít_t
 *
sùevít
;

75 
sùevít
 = (
osù_evít_t
 *Ë
	`osù_mÆloc
((osip_event_t));

77 i‡(
sùevít
 =
NULL
)

78  
NULL
;

80 
sùevít
->
ty≥
 =Åype;

81 
sùevít
->
sù
 = 
NULL
;

82 
sùevít
->
å™ß˘i⁄id
 =Åransactionid;

83  
sùevít
;

84 
	}
}

90 
osù_evít_t
 *
	$osù_√w_outgoög_sùmesßge
(
osù_mesßge_t
 *
sù
) {

91 
osù_evít_t
 *
sùevít
;

93 i‡(
sù
 =
NULL
)

94  
NULL
;

96 i‡(
	`MSG_IS_REQUEST
(
sù
)) {

97 i‡(
sù
->
sù_mëhod
 =
NULL
)

98  
NULL
;

100 i‡(
sù
->
ªq_uri
 =
NULL
)

101  
NULL
;

104 
sùevít
 = (
osù_evít_t
 *Ë
	`osù_mÆloc
((osip_event_t));

106 i‡(
sùevít
 =
NULL
)

107  
NULL
;

109 
sùevít
->
sù
 = sip;

110 
sùevít
->
ty≥
 = 
	`evt_£t_ty≥_outgoög_sùmesßge
(
sù
);

111 
sùevít
->
å™ß˘i⁄id
 = 0;

112  
sùevít
;

113 
	}
}

115 
ty≥_t
 
	$evt_£t_ty≥_öcomög_sùmesßge
(
osù_mesßge_t
 *
sù
) {

116 i‡(
	`MSG_IS_REQUEST
(
sù
)) {

117 i‡(
	`MSG_IS_INVITE
(
sù
))

118  
RCV_REQINVITE
;

120 i‡(
	`MSG_IS_ACK
(
sù
))

121  
RCV_REQACK
;

123  
RCV_REQUEST
;

126 i‡(
	`MSG_IS_STATUS_1XX
(
sù
))

127  
RCV_STATUS_1XX
;

129 i‡(
	`MSG_IS_STATUS_2XX
(
sù
))

130  
RCV_STATUS_2XX
;

132  
RCV_STATUS_3456XX
;

134 
	}
}

136 
ty≥_t
 
	$evt_£t_ty≥_outgoög_sùmesßge
(
osù_mesßge_t
 *
sù
) {

137 i‡(
	`MSG_IS_REQUEST
(
sù
)) {

138 i‡(
	`MSG_IS_INVITE
(
sù
))

139  
SND_REQINVITE
;

141 i‡(
	`MSG_IS_ACK
(
sù
))

142  
SND_REQACK
;

144  
SND_REQUEST
;

147 i‡(
	`MSG_IS_STATUS_1XX
(
sù
))

148  
SND_STATUS_1XX
;

150 i‡(
	`MSG_IS_STATUS_2XX
(
sù
))

151  
SND_STATUS_2XX
;

153  
SND_STATUS_3456XX
;

155 
	}
}

157 
	$osù_evít_‰ì
(
osù_evít_t
 *
evít
) {

158 i‡(
evít
 !
NULL
) {

159 
	`osù_mesßge_‰ì
(
evít
->
sù
);

160 
	`osù_‰ì
(
evít
);

162 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_time.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù_time.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

24 #ifde‡
__APPLE__


25 
	~<mach/˛ock.h
>

26 
	~<mach/mach.h
>

29 
timevÆ
 
	goff£t
 = {0, 0};

31 
	$add_gëtimeofday
(
timevÆ
 *
©v
, 
ms
) {

32 
m
;

34 i‡(
ms
 >= 1000000) {

35 
©v
->
tv_u£c
 = 0;

36 
m
 = 
ms
 / 1000;

39 
©v
->
tv_u£c
 +
ms
 * 1000;

40 
m
 = 
©v
->
tv_u£c
 / 1000000;

41 
©v
->
tv_u£c
 =átv->tv_usec % 1000000;

44 
©v
->
tv_£c
 +
m
;

45 
	}
}

47 
	$mö_timîcmp
(
timevÆ
 *
tv1
, timevÆ *
tv2
) {

48 i‡(
tv2
->
tv_£c
 == -1)

51 i‡(
	`osù_timîcmp
(
tv1
, 
tv2
, >)) {

53 
tv1
->
tv_£c
 = 
tv2
->tv_sec;

54 
tv1
->
tv_u£c
 = 
tv2
->tv_usec;

56 
	}
}

58 #i‡!
deföed
(
__PALMOS__
Ë&& deföed(
_WIN32_WCE
)

60 
	~<time.h
>

62 
	$osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

63 
DWORD
 
timemûlis
 = 
	`GëTickCou¡
();

65 
ç
->
tv_£c
 = (
timemûlis
 / 1000Ë+ 
off£t
.tv_sec;

66 
ç
->
tv_u£c
 = (
timemûlis
 - (ç->
tv_£c
 * 1000)) * 1000;

68 
	}
}

70 
	$_osù_gëtimeofday_ªÆtime
(
timevÆ
 *
ç
, *
tz
) {

71 
ç
->
tv_£c
 = 0;

72 
ç
->
tv_u£c
 = 0;

74 
	}
}

76 
time_t
 
	$time
(
time_t
 *
t
) {

77 
DWORD
 
timemûlis
 = 
	`GëTickCou¡
();

79 i‡(
timemûlis
 > 0) {

80 i‡(
t
 !
NULL
)

81 *
t
 = 
timemûlis
 / 1000;

84  
timemûlis
 / 1000;

85 
	}
}

87 #ñi‡!
deföed
(
__PALMOS__
Ë&& deföed(
WIN32
)

89 
	~<time.h
>

90 
	~<sys/timeb.h
>

91 
	~<wödows.h
>

93 
	$osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

94 
_timeb
 
timebuf„r
;

96 
	`_·ime
(&
timebuf„r
);

97 
ç
->
tv_£c
 = (Ë
timebuf„r
.
time
 + 
off£t
.tv_sec;

98 
ç
->
tv_u£c
 = 
timebuf„r
.
mûlôm
 * 1000;

100 
	}
}

102 
	$_osù_gëtimeofday_ªÆtime
(
timevÆ
 *
ç
, *
tz
) {

103 
FILETIME
 
lSy°emTimeAsFûeTime
;

104 
LONGLONG
 
Œ_now
;

106 
	`GëSy°emTimeAsFûeTime
(&
lSy°emTimeAsFûeTime
);

107 
Œ_now
 = (
LONGLONG
Ë
lSy°emTimeAsFûeTime
.
dwLowD©eTime
 + ((LONGLONG)÷Sy°emTimeAsFûeTime.
dwHighD©eTime
) << 32LL);

108 
Œ_now
 =Ül_now / 10;

109 
ç
->
tv_£c
 = (Ë
Œ_now
 / 1000000;

110 
ç
->
tv_u£c
 = (Ë
Œ_now
 % 1000000;

112 
	}
}

114 #ñi‡
deföed
(
__löux
Ë|| deföed(
__löux__
Ë|| deföed(
HAVE_CLOCK_GETTIME_MONOTONIC
)

116 
	$osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

117 
time•ec
 
ts
;

119 i‡(
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
) < 0) {

120 
	`gëtimeofday
(
ç
, 
tz
);

124 
ç
->
tv_£c
 = 
ts
.tv_£¯+ 
off£t
.tv_sec;

125 
ç
->
tv_u£c
 = 
ts
.
tv_n£c
 / 1000;

127 
	}
}

129 
	$_osù_gëtimeofday_ªÆtime
(
timevÆ
 *
ç
, *
tz
) {

130 
time•ec
 
ts
;

132 i‡(
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
ts
) < 0) {

133 
	`gëtimeofday
(
ç
, 
tz
);

137 
ç
->
tv_£c
 = 
ts
.tv_sec;

138 
ç
->
tv_u£c
 = 
ts
.
tv_n£c
 / 1000;

140 
	}
}

142 #ñi‡
deföed
(
__APPLE__
)

144 
	$osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

145 
˛ock_£rv_t
 
c˛ock
;

146 
mach_time•ec_t
 
mts
;

148 
	`ho°_gë_˛ock_£rvi˚
(
	`mach_ho°_£lf
(), 
SYSTEM_CLOCK
, &
c˛ock
);

149 
	`˛ock_gë_time
(
c˛ock
, &
mts
);

150 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
c˛ock
);

151 
ç
->
tv_£c
 = 
mts
.tv_£¯+ 
off£t
.tv_sec;

152 
ç
->
tv_u£c
 = 
mts
.
tv_n£c
 / 1000;

154 
	}
}

156 
	$_osù_gëtimeofday_ªÆtime
(
timevÆ
 *
ç
, *
tz
) {

158 
ç
->
tv_£c
 = 0;

159 
ç
->
tv_u£c
 = 0;

161 
	}
}

166 
	$osù_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

167 
	`gëtimeofday
(
ç
, 
tz
);

168 
ç
->
tv_£c
 +
off£t
.tv_sec;

170 
	}
}

172 
	$_osù_gëtimeofday_ªÆtime
(
timevÆ
 *
ç
, *
tz
) {

173 
ç
->
tv_£c
 = 0;

174 
ç
->
tv_u£c
 = 0;

176 
	}
}

180 #i‡
deföed
(
__¨c__
)

182 
time_t
 
	$time
(
time_t
 *
t
) {

183 
timevÆ
 
now
;

185 
	`osù_gëtimeofday
(&
now
, 
NULL
);

187 i‡(
t
 !
NULL
) {

188 *
t
 = 
now
.
tv_£c
;

191  
now
.
tv_£c
;

192 
	}
}

196 
	$osù_com≥nßãtime
() {

197 #i‚de‡
ANDROID


200 
timevÆ
 
œ°_now_m⁄Ÿ⁄ic
 = {0, 0};

201 
timevÆ
 
œ°_now_ªÆ
 = {0, 0};

202 
timevÆ
 
now_m⁄Ÿ⁄ic
;

203 
timevÆ
 
now_ªÆ
;

204 
timevÆ
 
diff_m⁄Ÿ⁄ic
;

205 
timevÆ
 
diff_ªÆ
;

207 
	`_osù_gëtimeofday_ªÆtime
(&
now_ªÆ
, 
NULL
);

208 
	`osù_gëtimeofday
(&
now_m⁄Ÿ⁄ic
, 
NULL
);

209 
now_m⁄Ÿ⁄ic
.
tv_£c
 -
off£t
.tv_sec;

211 i‡(
now_ªÆ
.
tv_£c
 == 0)

218 i‡(
œ°_now_m⁄Ÿ⁄ic
.
tv_£c
 == 0) {

219 
	`_osù_gëtimeofday_ªÆtime
(&
œ°_now_ªÆ
, 
NULL
);

220 
	`osù_gëtimeofday
(&
œ°_now_m⁄Ÿ⁄ic
, 
NULL
);

221 
œ°_now_m⁄Ÿ⁄ic
.
tv_£c
 -
off£t
.tv_sec;

226 
diff_m⁄Ÿ⁄ic
.
tv_£c
 = 
now_m⁄Ÿ⁄ic
.tv_£¯- 
œ°_now_m⁄Ÿ⁄ic
.tv_sec;

227 
diff_ªÆ
.
tv_£c
 = 
now_ªÆ
.tv_£¯- 
œ°_now_ªÆ
.tv_sec;

229 i‡(
diff_ªÆ
.
tv_£c
 < 5)

232 i‡(
diff_ªÆ
.
tv_£c
 > 3600)

235 i‡(
diff_ªÆ
.
tv_£c
 < 
diff_m⁄Ÿ⁄ic
.tv_sec + 2)

238 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "adju°ögÉxosù m⁄Ÿ⁄i¯timê(%i)!\n", 
diff_ªÆ
.
tv_£c
 - 
diff_m⁄Ÿ⁄ic
.tv_sec));

239 
off£t
.
tv_£c
 +
diff_ªÆ
.tv_£¯- 
diff_m⁄Ÿ⁄ic
.tv_sec;

242 
	`_osù_gëtimeofday_ªÆtime
(&
œ°_now_ªÆ
, 
NULL
);

243 
	`osù_gëtimeofday
(&
œ°_now_m⁄Ÿ⁄ic
, 
NULL
);

244 
œ°_now_m⁄Ÿ⁄ic
.
tv_£c
 -
off£t
.tv_sec;

246 
	}
}

248 
time_t
 
	$osù_gësy°emtime
(
time_t
 *
t
) {

249 
timevÆ
 
now_m⁄Ÿ⁄ic
;

251 #ifde‡
ANDROID


252 
	`osù_com≥nßãtime
();

255 
	`osù_gëtimeofday
(&
now_m⁄Ÿ⁄ic
, 
NULL
);

257 i‡(
t
 !
NULL
) {

258 *
t
 = 
now_m⁄Ÿ⁄ic
.
tv_£c
;

261  
now_m⁄Ÿ⁄ic
.
tv_£c
;

262 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_transaction.c

20 
	~<osù2/öã∫Æ.h
>

21 
	~<osù2/osù.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
osù_°©emachöe_t
 
i˘_fsm
;

27 
osù_°©emachöe_t
 
i°_fsm
;

28 
osù_°©emachöe_t
 
ni˘_fsm
;

29 
osù_°©emachöe_t
 
ni°_fsm
;

31 
osù_id_muãx_lock
(
osù_t
 *
osù
);

32 
osù_id_muãx_u∆ock
(
osù_t
 *
osù
);

34 
__osù_å™ß˘i⁄_£t_t›vü
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_vü_t
 *
t›vü
);

35 
__osù_å™ß˘i⁄_£t_‰om
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_‰om_t
 *
‰om
);

36 
__osù_å™ß˘i⁄_£t_to
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_to_t
 *
to
);

37 
__osù_å™ß˘i⁄_£t_ˇŒ_id
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_ˇŒ_id_t
 *
ˇŒ_id
);

38 
__osù_å™ß˘i⁄_£t_c£q
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_c£q_t
 *
c£q
);

40 
	$__osù_å™ß˘i⁄_£t_t›vü
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_vü_t
 *
t›vü
) {

41 
i
;

43 i‡(
å™ß˘i⁄
 =
NULL
)

44  
OSIP_BADPARAMETER
;

46 
i
 = 
	`osù_vü_˛⁄e
(
t›vü
, &(
å™ß˘i⁄
->topvia));

48 i‡(
i
 == 0)

49  
OSIP_SUCCESS
;

51 
å™ß˘i⁄
->
t›vü
 = 
NULL
;

52  
i
;

53 
	}
}

55 
	$__osù_å™ß˘i⁄_£t_‰om
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_‰om_t
 *
‰om
) {

56 
i
;

58 i‡(
å™ß˘i⁄
 =
NULL
)

59  
OSIP_BADPARAMETER
;

61 
i
 = 
	`osù_‰om_˛⁄e
(
‰om
, &(
å™ß˘i⁄
->from));

63 i‡(
i
 == 0)

64  
OSIP_SUCCESS
;

66 
å™ß˘i⁄
->
‰om
 = 
NULL
;

67  
i
;

68 
	}
}

70 
	$__osù_å™ß˘i⁄_£t_to
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_to_t
 *
to
) {

71 
i
;

73 i‡(
å™ß˘i⁄
 =
NULL
)

74  
OSIP_BADPARAMETER
;

76 
i
 = 
	`osù_to_˛⁄e
(
to
, &(
å™ß˘i⁄
->to));

78 i‡(
i
 == 0)

79  
OSIP_SUCCESS
;

81 
å™ß˘i⁄
->
to
 = 
NULL
;

82  
i
;

83 
	}
}

85 
	$__osù_å™ß˘i⁄_£t_ˇŒ_id
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_ˇŒ_id_t
 *
ˇŒ_id
) {

86 
i
;

88 i‡(
å™ß˘i⁄
 =
NULL
)

89  
OSIP_BADPARAMETER
;

91 
i
 = 
	`osù_ˇŒ_id_˛⁄e
(
ˇŒ_id
, &(
å™ß˘i⁄
->
ˇŒid
));

93 i‡(
i
 == 0)

94  
OSIP_SUCCESS
;

96 
å™ß˘i⁄
->
ˇŒid
 = 
NULL
;

97  
i
;

98 
	}
}

100 
	$__osù_å™ß˘i⁄_£t_c£q
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_c£q_t
 *
c£q
) {

101 
i
;

103 i‡(
å™ß˘i⁄
 =
NULL
)

104  
OSIP_BADPARAMETER
;

106 
i
 = 
	`osù_c£q_˛⁄e
(
c£q
, &(
å™ß˘i⁄
->cseq));

108 i‡(
i
 == 0)

109  
OSIP_SUCCESS
;

111 
å™ß˘i⁄
->
c£q
 = 
NULL
;

112  
i
;

113 
	}
}

115 
	$osù_å™ß˘i⁄_öô
(
osù_å™ß˘i⁄_t
 **
å™ß˘i⁄
, 
osù_fsm_ty≥_t
 
˘x_ty≥
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
ªque°
) {

116 
osù_vü_t
 *
t›vü
;

118 
i
;

120 *
å™ß˘i⁄
 = 
NULL
;

122 i‡(
ªque°
 =
NULL
)

123  
OSIP_BADPARAMETER
;

125 i‡(
ªque°
->
ˇŒ_id
 =
NULL
)

126  
OSIP_BADPARAMETER
;

128 i‡(
ªque°
->
ˇŒ_id
->
numbî
 =
NULL
)

129  
OSIP_BADPARAMETER
;

131 *
å™ß˘i⁄
 = (
osù_å™ß˘i⁄_t
 *Ë
	`osù_mÆloc
((osip_transaction_t));

133 i‡(*
å™ß˘i⁄
 =
NULL
)

134  
OSIP_NOMEM
;

136 
	`mem£t
(*
å™ß˘i⁄
, 0, (
osù_å™ß˘i⁄_t
));

138 (*
å™ß˘i⁄
)->
búth_time
 = 
	`osù_gësy°emtime
(
NULL
);

139 
	`osù_gëtimeofday
(&((*
å™ß˘i⁄
)->
¸óãd_time
), 
NULL
);

140 
	`osù_id_muãx_lock
(
osù
);

141 (*
å™ß˘i⁄
)->
å™ß˘i⁄id
 = 
osù
->transactionid++;

142 
	`osù_id_muãx_u∆ock
(
osù
);

143 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "ÆloˇtögÅønß˘i⁄Ñesour˚ %ò%s\n", (*
å™ß˘i⁄
)->
å™ß˘i⁄id
, 
ªque°
->
ˇŒ_id
->
numbî
));

146 (*
å™ß˘i⁄
)->
˘x_ty≥
 = ctx_type;

147 (*
å™ß˘i⁄
)->
i˘_c⁄ãxt
 = 
NULL
;

148 (*
å™ß˘i⁄
)->
i°_c⁄ãxt
 = 
NULL
;

149 (*
å™ß˘i⁄
)->
ni˘_c⁄ãxt
 = 
NULL
;

150 (*
å™ß˘i⁄
)->
ni°_c⁄ãxt
 = 
NULL
;

151 (*
å™ß˘i⁄
)->
c⁄fig
 = 
osù
;

153 
t›vü
 = 
	`osù_li°_gë
(&
ªque°
->
vüs
, 0);

155 i‡(
t›vü
 =
NULL
) {

156 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

157 *
å™ß˘i⁄
 = 
NULL
;

158  
OSIP_SYNTAXERROR
;

161 
i
 = 
	`__osù_å™ß˘i⁄_£t_t›vü
(*
å™ß˘i⁄
, 
t›vü
);

163 i‡(
i
 != 0) {

164 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

165 *
å™ß˘i⁄
 = 
NULL
;

166  
i
;

172 
i
 = 
	`__osù_å™ß˘i⁄_£t_‰om
(*
å™ß˘i⁄
, 
ªque°
->
‰om
);

174 i‡(
i
 != 0) {

175 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

176 *
å™ß˘i⁄
 = 
NULL
;

177  
i
;

180 
i
 = 
	`__osù_å™ß˘i⁄_£t_to
(*
å™ß˘i⁄
, 
ªque°
->
to
);

182 i‡(
i
 != 0) {

183 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

184 *
å™ß˘i⁄
 = 
NULL
;

185  
i
;

188 
i
 = 
	`__osù_å™ß˘i⁄_£t_ˇŒ_id
(*
å™ß˘i⁄
, 
ªque°
->
ˇŒ_id
);

190 i‡(
i
 != 0) {

191 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

192 *
å™ß˘i⁄
 = 
NULL
;

193  
i
;

196 
i
 = 
	`__osù_å™ß˘i⁄_£t_c£q
(*
å™ß˘i⁄
, 
ªque°
->
c£q
);

198 i‡(
i
 != 0) {

199 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

200 *
å™ß˘i⁄
 = 
NULL
;

201  
i
;

206 (*
å™ß˘i⁄
)->
‹ig_ªque°
 = 
NULL
;

208 (*
å™ß˘i⁄
)->
å™ß˘i⁄ff
 = (
osù_fifo_t
 *Ë
	`osù_mÆloc
((osip_fifo_t));

210 i‡((*
å™ß˘i⁄
)->
å™ß˘i⁄ff
 =
NULL
) {

211 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

212 *
å™ß˘i⁄
 = 
NULL
;

213  
OSIP_NOMEM
;

216 
	`osù_fifo_öô
((*
å™ß˘i⁄
)->
å™ß˘i⁄ff
);

218 i‡(
˘x_ty≥
 =
ICT
) {

219 (*
å™ß˘i⁄
)->
°©e
 = 
ICT_PRE_CALLING
;

220 
i
 = 
	`__osù_i˘_öô
(&((*
å™ß˘i⁄
)->
i˘_c⁄ãxt
), 
osù
, 
ªque°
);

222 i‡(
i
 != 0) {

223 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

224 *
å™ß˘i⁄
 = 
NULL
;

225  
i
;

228 
	`__osù_add_i˘
(
osù
, *
å™ß˘i⁄
);

230 } i‡(
˘x_ty≥
 =
IST
) {

231 (*
å™ß˘i⁄
)->
°©e
 = 
IST_PRE_PROCEEDING
;

232 
i
 = 
	`__osù_i°_öô
(&((*
å™ß˘i⁄
)->
i°_c⁄ãxt
), 
osù
, 
ªque°
);

234 i‡(
i
 != 0) {

235 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

236 *
å™ß˘i⁄
 = 
NULL
;

237  
i
;

240 
	`__osù_add_i°
(
osù
, *
å™ß˘i⁄
);

242 } i‡(
˘x_ty≥
 =
NICT
) {

243 (*
å™ß˘i⁄
)->
°©e
 = 
NICT_PRE_TRYING
;

244 
i
 = 
	`__osù_ni˘_öô
(&((*
å™ß˘i⁄
)->
ni˘_c⁄ãxt
), 
osù
, 
ªque°
);

246 i‡(
i
 != 0) {

247 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

248 *
å™ß˘i⁄
 = 
NULL
;

249  
i
;

252 
	`__osù_add_ni˘
(
osù
, *
å™ß˘i⁄
);

255 (*
å™ß˘i⁄
)->
°©e
 = 
NIST_PRE_TRYING
;

256 
i
 = 
	`__osù_ni°_öô
(&((*
å™ß˘i⁄
)->
ni°_c⁄ãxt
), 
osù
, 
ªque°
);

258 i‡(
i
 != 0) {

259 
	`osù_å™ß˘i⁄_‰ì
(*
å™ß˘i⁄
);

260 *
å™ß˘i⁄
 = 
NULL
;

261  
i
;

264 
	`__osù_add_ni°
(
osù
, *
å™ß˘i⁄
);

267  
OSIP_SUCCESS
;

268 
	}
}

284 
	$osù_å™ß˘i⁄_‰ì
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

285 
i
;

287 i‡(
å™ß˘i⁄
 =
NULL
)

288  
OSIP_BADPARAMETER
;

290 
i
 = 
	`osù_ªmove_å™ß˘i⁄
(
å™ß˘i⁄
->
c⁄fig
,Åransaction);

292 i‡(
i
 != 0) {

293 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "å™ß˘i⁄áÃódyÑemoved fromÜi° %i!\n", 
å™ß˘i⁄
->
å™ß˘i⁄id
));

296  
	`osù_å™ß˘i⁄_‰ì2
(
å™ß˘i⁄
);

297 
	}
}

301 
	$osù_å™ß˘i⁄_‰ì2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

302 
osù_evít_t
 *
evt
;

304 i‡(
å™ß˘i⁄
 =
NULL
)

305  
OSIP_BADPARAMETER
;

307 i‡(
å™ß˘i⁄
->
‹ig_ªque°
 !
NULL
 &&Åønß˘i⁄->‹ig_ªque°->
ˇŒ_id
 !NULL &&Åønß˘i⁄->‹ig_ªque°->ˇŒ_id->
numbî
 != NULL) {

308 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "‰ìÅønß˘i⁄Ñesour˚ %ò%s\n", 
å™ß˘i⁄
->
å™ß˘i⁄id
,Åønß˘i⁄->
‹ig_ªque°
->
ˇŒ_id
->
numbî
));

311 i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
ICT
) {

312 
	`__osù_i˘_‰ì
(
å™ß˘i⁄
->
i˘_c⁄ãxt
);

314 } i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
IST
) {

315 
	`__osù_i°_‰ì
(
å™ß˘i⁄
->
i°_c⁄ãxt
);

317 } i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
NICT
) {

318 
	`__osù_ni˘_‰ì
(
å™ß˘i⁄
->
ni˘_c⁄ãxt
);

321 
	`__osù_ni°_‰ì
(
å™ß˘i⁄
->
ni°_c⁄ãxt
);

325 i‡(
å™ß˘i⁄
->
å™ß˘i⁄ff
 !
NULL
) {

326 
evt
 = 
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

328 
evt
 !
NULL
) {

329 
	`osù_mesßge_‰ì
(
evt
->
sù
);

330 
	`osù_‰ì
(
evt
);

331 
evt
 = 
	`osù_fifo_åygë
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

334 
	`osù_fifo_‰ì
(
å™ß˘i⁄
->
å™ß˘i⁄ff
);

337 
	`osù_mesßge_‰ì
(
å™ß˘i⁄
->
‹ig_ªque°
);

338 
	`osù_mesßge_‰ì
(
å™ß˘i⁄
->
œ°_ª•⁄£
);

339 
	`osù_mesßge_‰ì
(
å™ß˘i⁄
->
ack
);

341 
	`osù_vü_‰ì
(
å™ß˘i⁄
->
t›vü
);

342 
	`osù_‰om_‰ì
(
å™ß˘i⁄
->
‰om
);

343 
	`osù_to_‰ì
(
å™ß˘i⁄
->
to
);

344 
	`osù_ˇŒ_id_‰ì
(
å™ß˘i⁄
->
ˇŒid
);

345 
	`osù_c£q_‰ì
(
å™ß˘i⁄
->
c£q
);

347 
	`osù_‰ì
(
å™ß˘i⁄
);

348  
OSIP_SUCCESS
;

349 
	}
}

351 
	$osù_å™ß˘i⁄_add_evít
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_evít_t
 *
evt
) {

352 i‡(
evt
 =
NULL
)

353  
OSIP_BADPARAMETER
;

355 i‡(
å™ß˘i⁄
 =
NULL
)

356  
OSIP_BADPARAMETER
;

358 
evt
->
å™ß˘i⁄id
 = 
å™ß˘i⁄
->transactionid;

359 
	`osù_fifo_add
(
å™ß˘i⁄
->
å™ß˘i⁄ff
, 
evt
);

360  
OSIP_SUCCESS
;

361 
	}
}

363 
	$osù_å™ß˘i⁄_execuã
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_evít_t
 *
evt
) {

364 
osù_°©emachöe_t
 *
°©emachöe
;

367 i‡(
	`EVT_IS_KILL_TRANSACTION
(
evt
)) {

373 
	`osù_‰ì
(
evt
);

374  
OSIP_SUCCESS
;

377 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sùevíàå->å™ß˘i⁄id: %i\n", 
å™ß˘i⁄
->
å™ß˘i⁄id
));

378 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sùevíàå->°©e: %i\n", 
å™ß˘i⁄
->
°©e
));

379 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sùevíàevt->ty≥: %i\n", 
evt
->
ty≥
));

380 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sùevíàevt->sù: %x\n", 
evt
->
sù
));

382 i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
ICT
)

383 
°©emachöe
 = &
i˘_fsm
;

385 i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
IST
)

386 
°©emachöe
 = &
i°_fsm
;

388 i‡(
å™ß˘i⁄
->
˘x_ty≥
 =
NICT
)

389 
°©emachöe
 = &
ni˘_fsm
;

392 
°©emachöe
 = &
ni°_fsm
;

394 i‡(0 !
	`fsm_ˇŒmëhod
(
evt
->
ty≥
, 
å™ß˘i⁄
->
°©e
, 
°©emachöe
,Évt,Åransaction)) {

395 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO3
, 
NULL
, "USELESSÉvent!\n"));

398 i‡(
	`EVT_IS_MSG
(
evt
)) {

399 i‡(
evt
->
sù
 !
NULL
) {

400 
	`osù_mesßge_‰ì
(
evt
->
sù
);

405 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sipeventÉvt: method called!\n"));

408 
	`osù_‰ì
(
evt
);

410 
	}
}

412 
	$osù_å™ß˘i⁄_gë_de°ö©i⁄
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, **
ù
, *
p‹t
) {

413 *
ù
 = 
NULL
;

414 *
p‹t
 = 0;

416 i‡(
å™ß˘i⁄
 =
NULL
)

417  
OSIP_BADPARAMETER
;

419 i‡(
å™ß˘i⁄
->
i˘_c⁄ãxt
 !
NULL
) {

420 *
ù
 = 
å™ß˘i⁄
->
i˘_c⁄ãxt
->
de°ö©i⁄
;

421 *
p‹t
 = 
å™ß˘i⁄
->
i˘_c⁄ãxt
->port;

422  
OSIP_SUCCESS
;

424 } i‡(
å™ß˘i⁄
->
ni˘_c⁄ãxt
 !
NULL
) {

425 *
ù
 = 
å™ß˘i⁄
->
ni˘_c⁄ãxt
->
de°ö©i⁄
;

426 *
p‹t
 = 
å™ß˘i⁄
->
ni˘_c⁄ãxt
->port;

427  
OSIP_SUCCESS
;

430  
OSIP_UNDEFINED_ERROR
;

431 
	}
}

433 
	$osù_å™ß˘i⁄_£t_§v_ªc‹d
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_§v_ªc‹d_t
 *
ªc‹d
) {

434 i‡(
å™ß˘i⁄
 =
NULL
)

435  
OSIP_BADPARAMETER
;

437 
	`mem˝y
(&
å™ß˘i⁄
->
ªc‹d
,Ñec‹d, (
osù_§v_ªc‹d_t
));

438  
OSIP_SUCCESS
;

439 
	}
}

441 
	$osù_å™ß˘i⁄_£t_«±r_ªc‹d
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
osù_«±r_t
 *
ªc‹d
) {

442 i‡(
å™ß˘i⁄
 =
NULL
)

443  
OSIP_BADPARAMETER
;

445 
å™ß˘i⁄
->
«±r_ªc‹d
 = 
ªc‹d
;

446  
OSIP_SUCCESS
;

447 
	}
}

449 
	$osù_å™ß˘i⁄_£t_your_ö°™˚
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

450 i‡(
å™ß˘i⁄
 =
NULL
)

451  
OSIP_BADPARAMETER
;

453 
å™ß˘i⁄
->
ª£rved1
 = 
±r
;

454  
OSIP_SUCCESS
;

455 
	}
}

457 
	$osù_å™ß˘i⁄_£t_ª£rved1
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

458 i‡(
å™ß˘i⁄
 =
NULL
)

459  
OSIP_BADPARAMETER
;

461 
å™ß˘i⁄
->
ª£rved1
 = 
±r
;

462  
OSIP_SUCCESS
;

463 
	}
}

465 
	$osù_å™ß˘i⁄_£t_ª£rved2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

466 i‡(
å™ß˘i⁄
 =
NULL
)

467  
OSIP_BADPARAMETER
;

469 
å™ß˘i⁄
->
ª£rved2
 = 
±r
;

470  
OSIP_SUCCESS
;

471 
	}
}

473 
	$osù_å™ß˘i⁄_£t_ª£rved3
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

474 i‡(
å™ß˘i⁄
 =
NULL
)

475  
OSIP_BADPARAMETER
;

477 
å™ß˘i⁄
->
ª£rved3
 = 
±r
;

478  
OSIP_SUCCESS
;

479 
	}
}

481 
	$osù_å™ß˘i⁄_£t_ª£rved4
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

482 i‡(
å™ß˘i⁄
 =
NULL
)

483  
OSIP_BADPARAMETER
;

485 
å™ß˘i⁄
->
ª£rved4
 = 
±r
;

486  
OSIP_SUCCESS
;

487 
	}
}

489 
	$osù_å™ß˘i⁄_£t_ª£rved5
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

490 i‡(
å™ß˘i⁄
 =
NULL
)

491  
OSIP_BADPARAMETER
;

493 
å™ß˘i⁄
->
ª£rved5
 = 
±r
;

494  
OSIP_SUCCESS
;

495 
	}
}

497 
	$osù_å™ß˘i⁄_£t_ª£rved6
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, *
±r
) {

498 i‡(
å™ß˘i⁄
 =
NULL
)

499  
OSIP_BADPARAMETER
;

501 
å™ß˘i⁄
->
ª£rved6
 = 
±r
;

502  
OSIP_SUCCESS
;

503 
	}
}

505 *
	$osù_å™ß˘i⁄_gë_your_ö°™˚
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

506 i‡(
å™ß˘i⁄
 =
NULL
)

507  
NULL
;

509  
å™ß˘i⁄
->
ª£rved1
;

510 
	}
}

512 *
	$osù_å™ß˘i⁄_gë_ª£rved1
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

513 i‡(
å™ß˘i⁄
 =
NULL
)

514  
NULL
;

516  
å™ß˘i⁄
->
ª£rved1
;

517 
	}
}

519 *
	$osù_å™ß˘i⁄_gë_ª£rved2
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

520 i‡(
å™ß˘i⁄
 =
NULL
)

521  
NULL
;

523  
å™ß˘i⁄
->
ª£rved2
;

524 
	}
}

526 *
	$osù_å™ß˘i⁄_gë_ª£rved3
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

527 i‡(
å™ß˘i⁄
 =
NULL
)

528  
NULL
;

530  
å™ß˘i⁄
->
ª£rved3
;

531 
	}
}

533 *
	$osù_å™ß˘i⁄_gë_ª£rved4
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

534 i‡(
å™ß˘i⁄
 =
NULL
)

535  
NULL
;

537  
å™ß˘i⁄
->
ª£rved4
;

538 
	}
}

540 *
	$osù_å™ß˘i⁄_gë_ª£rved5
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

541 i‡(
å™ß˘i⁄
 =
NULL
)

542  
NULL
;

544  
å™ß˘i⁄
->
ª£rved5
;

545 
	}
}

547 *
	$osù_å™ß˘i⁄_gë_ª£rved6
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
) {

548 i‡(
å™ß˘i⁄
 =
NULL
)

549  
NULL
;

551  
å™ß˘i⁄
->
ª£rved6
;

552 
	}
}

554 
	$__osù_å™ß˘i⁄_£t_°©e
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
°©e_t
 
°©e
) {

555 i‡(
å™ß˘i⁄
 =
NULL
)

556  
OSIP_BADPARAMETER
;

558 
å™ß˘i⁄
->
°©e
 = state;

559  
OSIP_SUCCESS
;

560 
	}
}

562 
	$osù_å™ß˘i⁄_£t_ö_sockë
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
sock
) {

563 i‡(
å™ß˘i⁄
 =
NULL
)

564  
OSIP_BADPARAMETER
;

566 
å™ß˘i⁄
->
ö_sockë
 = 
sock
;

567  
OSIP_SUCCESS
;

568 
	}
}

570 
	$osù_å™ß˘i⁄_£t_out_sockë
(
osù_å™ß˘i⁄_t
 *
å™ß˘i⁄
, 
sock
) {

571 i‡(
å™ß˘i⁄
 =
NULL
)

572  
OSIP_BADPARAMETER
;

574 
å™ß˘i⁄
->
out_sockë
 = 
sock
;

575  
OSIP_SUCCESS
;

576 
	}
}

578 
	$__osù_å™ß˘i⁄_m©chög_ª•⁄£_osù_to_xi˘_17_1_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ª•⁄£
) {

579 
osù_gíîic_∑øm_t
 *
b_ªque°
;

580 
osù_gíîic_∑øm_t
 *
b_ª•⁄£
;

581 
osù_vü_t
 *
t›vü_ª•⁄£
;

584 i‡(
å
 =
NULL
 || (å->
i˘_c⁄ãxt
 =NULL &&År->
ni˘_c⁄ãxt
 == NULL) ||

586 
ª•⁄£
 =
NULL
 ||Ñe•⁄£->
c£q
 =NULL ||Ñe•⁄£->c£q->
mëhod
 == NULL)

587  
OSIP_BADPARAMETER
;

589 
t›vü_ª•⁄£
 = 
	`osù_li°_gë
(&
ª•⁄£
->
vüs
, 0);

591 i‡(
t›vü_ª•⁄£
 =
NULL
) {

592 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA isÇot compliant: missingá Via header!\n"));

593  
OSIP_SYNTAXERROR
;

596 
	`osù_vü_∑øm_gë_by«me
(
å
->
t›vü
, "bønch", &
b_ªque°
);

598 i‡(
b_ªque°
 =
NULL
) {

599 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "You createdáÅransaction withoutány branch! THIS IS NOT ALLOWED\n"));

600  
OSIP_SYNTAXERROR
;

603 
	`osù_vü_∑øm_gë_by«me
(
t›vü_ª•⁄£
, "bønch", &
b_ª•⁄£
);

605 i‡(
b_ª•⁄£
 =
NULL
) {

606 #ifde‡
FWDSUPPORT


609 i‡(
	`‰om_èg_m©ch
(
å
->
‰om
, 
ª•⁄£
->from) != 0)

610  
OSIP_UNDEFINED_ERROR
;

613 i‡(
	`c£q_m©ch
(
å
->
c£q
, 
ª•⁄£
->cseq) != 0)

614  
OSIP_UNDEFINED_ERROR
;

617 i‡(
ª•⁄£
->
to
->
uæ
->
u£∫ame
 =
NULL
 && 
å
->
‰om
->url->username != NULL)

618  
OSIP_UNDEFINED_ERROR
;

620 i‡(
ª•⁄£
->
to
->
uæ
->
u£∫ame
 !
NULL
 && 
å
->
‰om
->url->username == NULL)

621  
OSIP_UNDEFINED_ERROR
;

623 i‡(
ª•⁄£
->
to
->
uæ
->
u£∫ame
 !
NULL
 && 
å
->
‰om
->url->username != NULL) {

624 i‡(
	`°rcmp
(
ª•⁄£
->
to
->
uæ
->
ho°
, 
å
->
‰om
->uæ->ho°Ë|| såcmp‘e•⁄£->to->uæ->
u£∫ame
,År->from->url->username))

625  
OSIP_UNDEFINED_ERROR
;

628 i‡(
	`°rcmp
(
ª•⁄£
->
to
->
uæ
->
ho°
, 
å
->
‰om
->url->host))

629  
OSIP_UNDEFINED_ERROR
;

633 i‡(
	`ˇŒ_id_m©ch
(
å
->
ˇŒid
, 
ª•⁄£
->
ˇŒ_id
) != 0)

634  
OSIP_UNDEFINED_ERROR
;

636  
OSIP_SUCCESS
;

638 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "Remote UA isÇot compliant: missingá branchÖarameter in Via header!\n"));

639  
OSIP_SYNTAXERROR
;

643 i‡((
b_ªque°
->
gvÆue
 =
NULL
Ë|| (
b_ª•⁄£
->gvalue == NULL)) {

644 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "Remote UA isÇot compliant: missingá branchÖarameter in Via header!\n"));

645  
OSIP_SYNTAXERROR
;

657 i‡(0 !
	`°rcmp
(
b_ªque°
->
gvÆue
, 
b_ª•⁄£
->gvalue))

658  
OSIP_UNDEFINED_ERROR
;

668 i‡(0 =
	`°rcmp
(
ª•⁄£
->
c£q
->
mëhod
, 
å
->cseq->method))

669  
OSIP_SUCCESS
;

671  
OSIP_UNDEFINED_ERROR
;

672 
	}
}

674 
	$__osù_å™ß˘i⁄_m©chög_ªque°_osù_to_xi°_17_2_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ªque°
) {

675 
osù_gíîic_∑øm_t
 *
b_‹igªque°
;

676 
osù_gíîic_∑øm_t
 *
b_ªque°
;

677 
osù_vü_t
 *
t›vü_ªque°
;

678 
size_t
 
Àngth_br
;

679 
size_t
 
Àngth_br2
;

682 i‡(
å
 =
NULL
 || (å->
i°_c⁄ãxt
 =NULL &&År->
ni°_c⁄ãxt
 == NULL) ||

684 
ªque°
 =
NULL
 ||Ñeque°->
c£q
 =NULL ||Ñeque°->c£q->
mëhod
 == NULL)

685  
OSIP_BADPARAMETER
;

687 
t›vü_ªque°
 = 
	`osù_li°_gë
(&
ªque°
->
vüs
, 0);

689 i‡(
t›vü_ªque°
 =
NULL
) {

690 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA isÇot compliant: missingá Via header!\n"));

691  
OSIP_SYNTAXERROR
;

694 
	`osù_vü_∑øm_gë_by«me
(
t›vü_ªque°
, "bønch", &
b_ªque°
);

695 
	`osù_vü_∑øm_gë_by«me
(
å
->
t›vü
, "bønch", &
b_‹igªque°
);

697 i‡((
b_‹igªque°
 =
NULL
 && 
b_ªque°
 != NULL) || (b_origrequest != NULL && b_request == NULL))

698  
OSIP_SYNTAXERROR
;

707 i‡(
b_‹igªque°
 !
NULL
 && 
b_ªque°
 != NULL)

710 i‡(!
b_‹igªque°
->
gvÆue
)

711  
OSIP_UNDEFINED_ERROR
;

713 i‡(!
b_ªque°
->
gvÆue
)

714  
OSIP_UNDEFINED_ERROR
;

716 
Àngth_br
 = 
	`°æí
(
b_‹igªque°
->
gvÆue
);

717 
Àngth_br2
 = 
	`°æí
(
b_ªque°
->
gvÆue
);

719 i‡(
Àngth_br
 !
Àngth_br2
)

720  
OSIP_UNDEFINED_ERROR
;

723 i‡(0 =
	`°∫cmp
(
b_‹igªque°
->
gvÆue
, "z9hG4bK", 7Ë&& 0 =°∫cmp(
b_ªque°
->gvalue, "z9hG4bK", 7)) {

733 i‡(0 !
	`°rcmp
(
b_‹igªque°
->
gvÆue
, 
b_ªque°
->gvalue))

734  
OSIP_UNDEFINED_ERROR
;

738 *
b_p‹t
 = 
	`vü_gë_p‹t
(
t›vü_ªque°
);

739 *
b_‹igp‹t
 = 
	`vü_gë_p‹t
(
å
->
t›vü
);

740 *
b_ho°
 = 
	`vü_gë_ho°
(
t›vü_ªque°
);

741 *
b_‹igho°
 = 
	`vü_gë_ho°
(
å
->
t›vü
);

743 i‡((
b_ho°
 =
NULL
 || 
b_‹igho°
 == NULL))

744  
OSIP_UNDEFINED_ERROR
;

746 i‡(0 !
	`°rcmp
(
b_‹igho°
, 
b_ho°
))

747  
OSIP_UNDEFINED_ERROR
;

749 i‡(
b_p‹t
 !
NULL
 && 
b_‹igp‹t
 =NULL && 0 !
	`°rcmp
(b_port, "5060"))

750  
OSIP_UNDEFINED_ERROR
;

752 i‡(
b_‹igp‹t
 !
NULL
 && 
b_p‹t
 =NULL && 0 !
	`°rcmp
(b_origport, "5060"))

753  
OSIP_UNDEFINED_ERROR
;

755 i‡(
b_‹igp‹t
 !
NULL
 && 
b_p‹t
 !NULL && 0 !
	`°rcmp
(b_origport, b_port))

756  
OSIP_UNDEFINED_ERROR
;

758 #ifde‡
AC_BUG


761 i‡(0 !
	`osù_‰om_èg_m©ch
(
å
->
‰om
, 
ªque°
->from))

762  
OSIP_UNDEFINED_ERROR
;

768 (!(0 =
	`°rcmp
(
å
->
c£q
->
mëhod
, "INVITE"Ë&& 0 =°rcmp(
ªque°
->cseq->method, "ACK"))) && 0 != strcmp(tr->cseq->method,Ñequest->cseq->method))

769  
OSIP_UNDEFINED_ERROR
;

771  
OSIP_SUCCESS
;

776 i‡(0 !
	`osù_ˇŒ_id_m©ch
(
å
->
ˇŒid
, 
ªque°
->
ˇŒ_id
))

777  
OSIP_UNDEFINED_ERROR
;

779 i‡(
	`MSG_IS_ACK
(
ªque°
)) {

780 
osù_gíîic_∑øm_t
 *
èg_‰om1
;

781 
osù_gíîic_∑øm_t
 *
èg_‰om2
;

783 
	`osù_‰om_∑øm_gë_by«me
(
å
->
to
, "èg", &
èg_‰om1
);

784 
	`osù_‰om_∑øm_gë_by«me
(
ªque°
->
to
, "èg", &
èg_‰om2
);

786 i‡(
èg_‰om1
 =
NULL
 && 
èg_‰om2
 != NULL) {

789 } i‡(
èg_‰om1
 !
NULL
 && 
èg_‰om2
 == NULL) {

790  
OSIP_UNDEFINED_ERROR
;

793 i‡(0 !
	`osù_to_èg_m©ch
(
å
->
to
, 
ªque°
->to))

794  
OSIP_UNDEFINED_ERROR
;

798 i‡(
å
->
‹ig_ªque°
 =
NULL
 ||År->‹ig_ªque°->
to
 == NULL)

799  
OSIP_UNDEFINED_ERROR
;

801 i‡(0 !
	`osù_to_èg_m©ch
(
å
->
‹ig_ªque°
->
to
, 
ªque°
->to))

802  
OSIP_UNDEFINED_ERROR
;

805 i‡(0 !
	`osù_‰om_èg_m©ch
(
å
->
‰om
, 
ªque°
->from))

806  
OSIP_UNDEFINED_ERROR
;

808 i‡(0 !
	`osù_c£q_m©ch
(
å
->
c£q
, 
ªque°
->cseq))

809  
OSIP_UNDEFINED_ERROR
;

811 i‡(0 !
	`osù_vü_m©ch
(
å
->
t›vü
, 
t›vü_ªque°
))

812  
OSIP_UNDEFINED_ERROR
;

814  
OSIP_SUCCESS
;

815 
	}
}

817 
osù_evít_t
 *
	$__osù_å™ß˘i⁄_√ed_timî_x_evít
(*
xixt
, 
timevÆ
 *
timî
, 
c⁄d_°©e
, 
å™ß˘i⁄id
, 
TIMER_VAL
) {

818 
timevÆ
 
now
;

820 
	`osù_gëtimeofday
(&
now
, 
NULL
);

822 i‡(
xixt
 =
NULL
)

823  
NULL
;

825 i‡(
c⁄d_°©e
) {

826 i‡(
timî
->
tv_£c
 == -1)

827  
NULL
;

829 i‡(
	`osù_timîcmp
(&
now
, 
timî
, >=))

830  
	`__osù_evít_√w
(
TIMER_VAL
, 
å™ß˘i⁄id
);

833  
NULL
;

834 
	}
}

836 
	$__osù_å™ß˘i⁄_¢d_xxx
(
osù_å™ß˘i⁄_t
 *
i°
, 
osù_mesßge_t
 *
msg
) {

837 
osù_t
 *
osù
 = (osù_à*Ë
i°
->
c⁄fig
;

838 
osù_vü_t
 *
vü
;

839 *
ho°
;

840 
p‹t
;

841 
osù_gíîic_∑øm_t
 *
maddr
;

842 
osù_gíîic_∑øm_t
 *
ª˚ived
;

843 
osù_gíîic_∑øm_t
 *
Ω‹t
;

845 
vü
 = (
osù_vü_t
 *Ë
	`osù_li°_gë
(&
msg
->
vüs
, 0);

847 i‡(!
vü
)

848  
OSIP_SYNTAXERROR
;

850 
	`osù_vü_∑øm_gë_by«me
(
vü
, "maddr", &
maddr
);

851 
	`osù_vü_∑øm_gë_by«me
(
vü
, "ª˚ived", &
ª˚ived
);

852 
	`osù_vü_∑øm_gë_by«me
(
vü
, "Ω‹t", &
Ω‹t
);

859 i‡(
maddr
 !
NULL
)

860 
ho°
 = 
maddr
->
gvÆue
;

865 i‡(
ª˚ived
 !
NULL
)

866 
ho°
 = 
ª˚ived
->
gvÆue
;

869 
ho°
 = 
vü
->host;

871 i‡(
Ω‹t
 =
NULL
 ||Ñp‹t->
gvÆue
 == NULL) {

872 i‡(
vü
->
p‹t
 !
NULL
)

873 
p‹t
 = 
	`osù_©oi
(
vü
->port);

876 
p‹t
 = 5060;

879 
p‹t
 = 
	`osù_©oi
(
Ω‹t
->
gvÆue
);

881  
osù
->
	`cb_£nd_mesßge
(
i°
, 
msg
, 
ho°
, 
p‹t
, i°->
out_sockë
);

882 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_condv.c

20 
	~<osù2/öã∫Æ.h
>

22 #i‚de‡
OSIP_MONOTHREAD


24 
	~<osù∑r£r2/osù_p‹t.h
>

25 
	~<osù2/osù_mt.h
>

26 
	~<osù2/osù_c⁄dv.h
>

28 #i‡!
deföed
(
__πems__
Ë&& !deföed(
__VXWORKS_OS__
Ë&& !deföed(
__PSOS__
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
HAVE_PTHREAD_WIN32
Ë&& !deföed(
HAVE_PTHREAD
Ë&& !deföed(
HAVE_PTH_PTHREAD_H
)

29 #îr‹ 
No
 
thªad
 
im∂emíèti⁄
 
found
!

32 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

37 
	~<±hªad.h
>

39 
osù_c⁄d
 *
	$osù_c⁄d_öô
() {

40 
osù_c⁄d_t
 *
c⁄d
 = (osù_c⁄d_à*Ë
	`osù_mÆloc
((osip_cond_t));

42 i‡(
c⁄d
 && (
	`±hªad_c⁄d_öô
(&c⁄d->
cv
, 
NULL
) == 0)) {

43  (
osù_c⁄d
 *Ë(
c⁄d
);

46 
	`osù_‰ì
(
c⁄d
);

48  
NULL
;

49 
	}
}

51 
	$osù_c⁄d_de°roy
(
osù_c⁄d
 *
_c⁄d
) {

52 
ªt
;

54 i‡(!
_c⁄d
)

55  
OSIP_BADPARAMETER
;

57 
ªt
 = 
	`±hªad_c⁄d_de°roy
(&
_c⁄d
->
cv
);

58 
	`osù_‰ì
(
_c⁄d
);

59  
ªt
;

60 
	}
}

62 
	$osù_c⁄d_sig«l
(
osù_c⁄d
 *
_c⁄d
) {

63 i‡(!
_c⁄d
)

64  
OSIP_BADPARAMETER
;

66  
	`±hªad_c⁄d_sig«l
(&
_c⁄d
->
cv
);

67 
	}
}

69 
	$osù_c⁄d_waô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
) {

70 i‡(!
_c⁄d
)

71  
OSIP_BADPARAMETER
;

73  
	`±hªad_c⁄d_waô
(&
_c⁄d
->
cv
, (
±hªad_muãx_t
 *Ë
_mut
);

74 
	}
}

76 
	$osù_c⁄d_timedwaô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
, c⁄° 
time•ec
 *
ab°ime
) {

77 i‡(!
_c⁄d
)

78  
OSIP_BADPARAMETER
;

80  
	`±hªad_c⁄d_timedwaô
(&
_c⁄d
->
cv
, (
±hªad_muãx_t
 *Ë
_mut
, (c⁄° 
time•ec
 *Ë
ab°ime
);

81 
	}
}

85 #i‡
deföed
(
_WIN32_WCE
)

89 #i‡
deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

91 
	~<sys/ty≥s.h
>

92 
	~<sys/timeb.h
>

94 
osù_c⁄d
 *
	$osù_c⁄d_öô
() {

95 
osù_c⁄d_t
 *
c⁄d
 = (osù_c⁄d_à*Ë
	`osù_mÆloc
((osip_cond_t));

97 i‡(
c⁄d
 && (c⁄d->
mut
 = 
	`osù_muãx_öô
()Ë!
NULL
) {

98 
c⁄d
->
£m
 = 
	`osù_£m_öô
(0);

99  (
osù_c⁄d
 *Ë(
c⁄d
);

102 
	`osù_‰ì
(
c⁄d
);

104  
NULL
;

105 
	}
}

107 
	$osù_c⁄d_de°roy
(
osù_c⁄d
 *
_c⁄d
) {

108 i‡(!
_c⁄d
)

109  
OSIP_SUCCESS
;

111 i‡(
_c⁄d
->
£m
 =
NULL
)

112  
OSIP_SUCCESS
;

114 
	`osù_£m_de°roy
(
_c⁄d
->
£m
);

116 i‡(
_c⁄d
->
mut
 =
NULL
)

117  
OSIP_SUCCESS
;

119 
	`osù_muãx_de°roy
(
_c⁄d
->
mut
);

120 
	`osù_‰ì
(
_c⁄d
);

122 
	}
}

124 
	$osù_c⁄d_sig«l
(
osù_c⁄d
 *
_c⁄d
) {

125 i‡(!
_c⁄d
)

126  
OSIP_BADPARAMETER
;

128  
	`osù_£m_po°
(
_c⁄d
->
£m
);

129 
	}
}

131 
	$osù_c⁄d_waô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
) {

132 
ªt1
 = 0, 
ªt2
 = 0, 
ªt3
 = 0;

133 
i
;

135 i‡(!
_c⁄d
)

136  
OSIP_BADPARAMETER
;

138 
i
 = 
	`osù_muãx_lock
(
_c⁄d
->
mut
);

140 i‡(
i
 != 0)

141  
i
;

143 
i
 = 
	`osù_muãx_u∆ock
(
_mut
);

145 i‡(
i
 != 0)

146  
i
;

148 
ªt1
 = 
	`osù_£m_waô
(
_c⁄d
->
£m
);

150 
ªt2
 = 
	`osù_muãx_lock
(
_mut
);

152 
ªt3
 = 
	`osù_muãx_u∆ock
(
_c⁄d
->
mut
);

154 i‡(
ªt1
)

155  
ªt1
;

157 i‡(
ªt2
)

158  
ªt2
;

160 i‡(
ªt3
)

161  
ªt3
;

163  
OSIP_SUCCESS
;

164 
	}
}

166 
	#OSIP_CLOCK_REALTIME
 4002

	)

168 
	$__osù_˛ock_gëtime
(
˛ock_id
, 
time•ec
 *
ç
) {

169 
_timeb
 
time_vÆ
;

171 i‡(
˛ock_id
 !
OSIP_CLOCK_REALTIME
)

172  
OSIP_BADPARAMETER
;

174 i‡(
ç
 =
NULL
)

175  
OSIP_BADPARAMETER
;

177 
	`_·ime
(&
time_vÆ
);

178 
ç
->
tv_£c
 = (Ë
time_vÆ
.
time
;

179 
ç
->
tv_n£c
 = 
time_vÆ
.
mûlôm
 * 1000000;

180  
OSIP_SUCCESS
;

181 
	}
}

183 
	$_dñè_time
(c⁄° 
time•ec
 *
°¨t
, c⁄° time•e¯*
íd
) {

184 
difx
;

186 i‡(
°¨t
 =
NULL
 || 
íd
 == NULL)

187  
OSIP_SUCCESS
;

189 
difx
 = ((
íd
->
tv_£c
 - 
°¨t
->tv_£cË* 1000Ë+ (”nd->
tv_n£c
 - start->tv_nsec) / 1000000);

191  
difx
;

192 
	}
}

194 
	$osù_c⁄d_timedwaô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
, c⁄° 
time•ec
 *
ab°ime
) {

195 
DWORD
 
dwRë
;

196 
time•ec
 
now
;

197 
timeout_ms
;

198 
HANDLE
 
£m
;

199 
i
;

201 i‡(!
_c⁄d
)

202  
OSIP_BADPARAMETER
;

204 
£m
 = *((
HANDLE
 *Ë
_c⁄d
->sem);

206 i‡(
£m
 =
NULL
)

207  
OSIP_UNDEFINED_ERROR
;

209 i‡(
ab°ime
 =
NULL
)

210  
OSIP_BADPARAMETER
;

212 
	`__osù_˛ock_gëtime
(
OSIP_CLOCK_REALTIME
, &
now
);

214 
timeout_ms
 = 
	`_dñè_time
(&
now
, 
ab°ime
);

216 i‡(
timeout_ms
 <= 0)

219 
i
 = 
	`osù_muãx_u∆ock
(
_mut
);

221 i‡(
i
 != 0)

222  
i
;

224 
dwRë
 = 
	`WaôF‹SögÀObje˘Ex
(
£m
, 
timeout_ms
, 
FALSE
);

226 
i
 = 
	`osù_muãx_lock
(
_mut
);

228 i‡(
i
 != 0)

229  
i
;

231 
dwRë
) {

232 
WAIT_OBJECT_0
:

233  
OSIP_SUCCESS
;

236 
WAIT_TIMEOUT
:

241  
OSIP_UNDEFINED_ERROR
;

244 
	}
}

247 #ifde‡
__PSOS__


251 #ifde‡
__VXWORKS_OS__


252 
osù_c⁄d
 *
	$osù_c⁄d_öô
() {

253 
osù_c⁄d_t
 *
c⁄d
 = (osù_c⁄d_à*Ë
	`osù_mÆloc
((osip_cond_t));

255 i‡((
c⁄d
->
£m
 = 
	`osù_£m_öô
(0)Ë!
NULL
) {

256  (
osù_c⁄d
 *Ë(
c⁄d
);

259 
	`osù_‰ì
(
c⁄d
);

261  
NULL
;

262 
	}
}

264 
	$osù_c⁄d_de°roy
(
osù_c⁄d
 *
_c⁄d
) {

265 i‡(
_c⁄d
->
£m
 =
NULL
)

266  
OSIP_SUCCESS
;

268 
	`osù_£m_de°roy
(
_c⁄d
->
£m
);

269 
	`osù_‰ì
(
_c⁄d
);

271 
	}
}

273 
	$osù_c⁄d_sig«l
(
osù_c⁄d
 *
_c⁄d
) {

274  
	`osù_£m_po°
(
_c⁄d
->
£m
);

275 
	}
}

277 + 
	$_c⁄d_waô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
, 
ticks
) {

278 
ªt
;

280 i‡(
_c⁄d
 =
NULL
)

281  
OSIP_BADPARAMETER
;

283 
ªt
 = 
	`osù_muãx_u∆ock
(
_mut
);

285 i‡(
ªt
 != 0) {

286  
ªt
;

289 
ªt
 = 
	`£mTake
(((
osù_£m_t
 *Ë
_c⁄d
->
£m
)->
£mId
, 
ticks
);

291 i‡(
ªt
 !
OK
) {

292 
î∫o
) {

293 
S_objLib_OBJ_ID_ERROR
:

296 
S_objLib_OBJ_UNAVAILABLE
:

299 
S_ötLib_NOT_ISR_CALLABLE
:

301 
ªt
 = 
OSIP_UNDEFINED_ERROR
;

304 
S_objLib_OBJ_TIMEOUT
:

305 
ªt
 = 1;

309 
ªt
 = 1;

314 
i
 = 
	`osù_muãx_lock
(
_mut
);

316 i‡(
i
 != 0) {

317 
ªt
 = 
i
;

320  
ªt
;

321 
	}
}

323 
	$osù_c⁄d_waô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
) {

324  
	`_c⁄d_waô
(
_c⁄d
, 
_mut
, 
WAIT_FOREVER
);

325 
	}
}

327 
	$osù_c⁄d_timedwaô
(
osù_c⁄d
 *
_c⁄d
, 
osù_muãx
 *
_mut
, c⁄° 
time•ec
 *
ab°ime
) {

328 
øã
 = 
	`sysClkR©eGë
();

329 
time•ec
 
now
;

330 
£c
, 
n£c
;

331 
ticks
;

332 
SEM_ID
 
£m
;

334 i‡(
_c⁄d
 =
NULL
)

335  
OSIP_BADPARAMETER
;

337 
£m
 = ((
osù_£m_t
 *Ë
_c⁄d
->£m)->
£mId
;

339 i‡(
£m
 =
NULL
)

340  
OSIP_UNDEFINED_ERROR
;

342 i‡(
ab°ime
 =
NULL
)

343  
OSIP_BADPARAMETER
;

345 
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
now
);

347 
£c
 = 
ab°ime
->
tv_£c
 - 
now
.tv_sec;

348 
n£c
 = 
ab°ime
->
tv_n£c
 - 
now
.tv_nsec;

350 (
£c
 > 0Ë&& (
n£c
 < 0)) {

351 --
£c
;

352 
n£c
 += 1000000000;

355 i‡(
n£c
 < 0)

358 
ticks
 = (
£c
 * 
øã
Ë+ (
n£c
 / 1000 *Ñate / 1000000);

360  
	`_c⁄d_waô
(
_c⁄d
, 
_mut
, 
ticks
);

361 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_fifo.c

20 
	~<osù2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù2/osù_fifo.h
>

27 
	$osù_fifo_öô
(
osù_fifo_t
 *
ff
) {

28 #i‚de‡
OSIP_MONOTHREAD


29 
ff
->
qi¶ocked
 = 
	`osù_muãx_öô
();

31 
ff
->
qi£m±y
 = 
	`osù_£m_öô
(0);

33 
	`osù_li°_öô
(&
ff
->
queue
);

35 
ff
->
°©e
 = 
osù_em±y
;

36 
	}
}

38 
	$osù_fifo_add
(
osù_fifo_t
 *
ff
, *
ñ
) {

39 #i‚de‡
OSIP_MONOTHREAD


40 
	`osù_muãx_lock
(
ff
->
qi¶ocked
);

43 
	`osù_li°_add
(&
ff
->
queue
, 
ñ
, -1);

44 
ff
->
°©e
 = 
osù_ok
;

46 #i‚de‡
OSIP_MONOTHREAD


47 
	`osù_£m_po°
(
ff
->
qi£m±y
);

48 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$osù_fifo_ö£π
(
osù_fifo_t
 *
ff
, *
ñ
) {

54 #i‚de‡
OSIP_MONOTHREAD


55 
	`osù_muãx_lock
(
ff
->
qi¶ocked
);

58 
	`osù_li°_add
(&
ff
->
queue
, 
ñ
, 0);

59 
ff
->
°©e
 = 
osù_ok
;

61 #i‚de‡
OSIP_MONOTHREAD


62 
	`osù_£m_po°
(
ff
->
qi£m±y
);

63 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$osù_fifo_size
(
osù_fifo_t
 *
ff
) {

69 
i
;

71 #i‚de‡
OSIP_MONOTHREAD


72 
	`osù_muãx_lock
(
ff
->
qi¶ocked
);

75 
i
 = 
	`osù_li°_size
(&
ff
->
queue
);

76 #i‚de‡
OSIP_MONOTHREAD


77 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

79  
i
;

80 
	}
}

82 *
	$osù_fifo_gë
(
osù_fifo_t
 *
ff
) {

83 *
ñ
 = 
NULL
;

85 #i‚de‡
OSIP_MONOTHREAD


86 
i
 = 
	`osù_£m_waô
(
ff
->
qi£m±y
);

88 i‡(
i
 != 0)

89  
NULL
;

91 
	`osù_muãx_lock
(
ff
->
qi¶ocked
);

94 i‡(
ff
->
°©e
 !
osù_em±y
) {

95 
ñ
 = 
	`osù_li°_gë
(&
ff
->
queue
, 0);

96 
	`osù_li°_ªmove
(&
ff
->
queue
, 0);

100 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "noÉlement in fifo.\n"));

101 #i‚de‡
OSIP_MONOTHREAD


102 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

104  
OSIP_SUCCESS
;

108 i‡(
	`osù_li°_size
(&
ff
->
queue
) <= 0)

109 
ff
->
°©e
 = 
osù_em±y
;

112 
ff
->
°©e
 = 
osù_ok
;

114 #i‚de‡
OSIP_MONOTHREAD


115 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

117  
ñ
;

118 
	}
}

120 *
	$osù_fifo_åygë
(
osù_fifo_t
 *
ff
) {

121 *
ñ
 = 
NULL
;

123 #i‚de‡
OSIP_MONOTHREAD


125 i‡(0 !
	`osù_£m_åywaô
(
ff
->
qi£m±y
)) {

126  
NULL
;

129 
	`osù_muãx_lock
(
ff
->
qi¶ocked
);

132 i‡(
ff
->
°©e
 =
osù_em±y
)

133  
NULL
;

137 i‡(
ff
->
°©e
 !
osù_em±y
) {

138 
ñ
 = 
	`osù_li°_gë
(&
ff
->
queue
, 0);

139 
	`osù_li°_ªmove
(&
ff
->
queue
, 0);

143 #i‚de‡
OSIP_MONOTHREAD


146 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "noÉlement in fifo.\n"));

147 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

148  
OSIP_SUCCESS
;

154 i‡(
	`osù_li°_size
(&
ff
->
queue
) <= 0)

155 
ff
->
°©e
 = 
osù_em±y
;

158 
ff
->
°©e
 = 
osù_ok
;

160 #i‚de‡
OSIP_MONOTHREAD


161 
	`osù_muãx_u∆ock
(
ff
->
qi¶ocked
);

163  
ñ
;

164 
	}
}

166 
	$osù_fifo_‰ì
(
osù_fifo_t
 *
ff
) {

167 i‡(
ff
 =
NULL
)

170 #i‚de‡
OSIP_MONOTHREAD


171 
	`osù_muãx_de°roy
(
ff
->
qi¶ocked
);

173 
	`osù_£m_de°roy
(
ff
->
qi£m±y
);

175 
	`osù_‰ì
(
ff
);

176 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_sema.c

20 
	~<osù2/öã∫Æ.h
>

22 #i‚de‡
OSIP_MONOTHREAD


24 
	~<osù∑r£r2/osù_p‹t.h
>

25 
	~<osù2/osù_mt.h
>

27 #i‡
deföed
(
__πems__
)

28 
	~<πems.h
>

31 #i‡!
deföed
(
__VXWORKS_OS__
Ë&& !deföed(
__PSOS__
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
HAVE_PTHREAD_WIN32
Ë&& !deföed(
HAVE_PTHREAD
Ë&& !deföed(
HAVE_PTH_PTHREAD_H
Ë&& !deföed(
__πems__
)

32 #îr‹ 
No
 
thªad
 
im∂emíèti⁄
 
found
!

35 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

37 
osù_muãx
 *
	$osù_muãx_öô
() {

38 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
	`osù_mÆloc
((osip_mutex_t));

40 i‡(
mut
 =
NULL
)

41  
NULL
;

43 
	`±hªad_muãx_öô
(
mut
, 
NULL
);

44  (
osù_muãx
 *Ë
mut
;

45 
	}
}

47 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

48 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

50 i‡(
mut
 =
NULL
)

53 
	`±hªad_muãx_de°roy
(
mut
);

54 
	`osù_‰ì
(
mut
);

55 
	}
}

57 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

58 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

60 i‡(
mut
 =
NULL
)

61  
OSIP_BADPARAMETER
;

63  
	`±hªad_muãx_lock
(
mut
);

64 
	}
}

66 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

67 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

69 i‡(
mut
 =
NULL
)

70  
OSIP_BADPARAMETER
;

72  
	`±hªad_muãx_u∆ock
(
mut
);

73 
	}
}

77 #i‡
deföed
(
__¨c__
)

80 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

81 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

83 i‡(
£m
 =
NULL
)

84  
NULL
;

86 
£m
->
_£m_cou¡î
 = 0;

87 
£m
->
_£m_muãx
 = 
	`osù_muãx_öô
();

89 i‡(
£m
->
_£m_muãx
 !
NULL
)

90  (
osù_£m
 *Ë
£m
;

92 
	`osù_‰ì
(
£m
);

93  
NULL
;

94 
	}
}

96 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

97 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

99 i‡(
£m
 =
NULL
)

100  
OSIP_SUCCESS
;

102 
	`osù_muãx_de°roy
(
£m
->
_£m_muãx
);

103 
	`osù_‰ì
(
£m
);

104  
OSIP_SUCCESS
;

105 
	}
}

107 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

108 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

110 i‡(
£m
 =
NULL
)

111  
OSIP_BADPARAMETER
;

113 
	`osù_muãx_lock
(
£m
->
_£m_muãx
);

114 
£m
->
_£m_cou¡î
++;

115 
	`osù_muãx_u∆ock
(
£m
->
_£m_muãx
);

116  
OSIP_SUCCESS
;

117 
	}
}

119 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

120 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

122 i‡(
£m
 =
NULL
)

123  
OSIP_BADPARAMETER
;

127 
	`osù_muãx_lock
(
£m
->
_£m_muãx
);

129 i‡(
£m
->
_£m_cou¡î
 > 0) {

130 
£m
->
_£m_cou¡î
--;

131 
	`osù_muãx_u∆ock
(
£m
->
_£m_muãx
);

132  
OSIP_SUCCESS
;

135 
	`osù_muãx_u∆ock
(
£m
->
_£m_muãx
);

136 
	`osù_u¶ìp
(1000);

139  
OSIP_UNDEFINED_ERROR
;

140 
	}
}

142 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

143 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

145 i‡(
£m
 =
NULL
)

146  
OSIP_BADPARAMETER
;

148 
	`osù_muãx_lock
(
£m
->
_£m_muãx
);

150 i‡(
£m
->
_£m_cou¡î
 > 0) {

151 
£m
->
_£m_cou¡î
--;

152 
	`osù_muãx_u∆ock
(
£m
->
_£m_muãx
);

153  
OSIP_SUCCESS
;

156 
	`osù_muãx_u∆ock
(
£m
->
_£m_muãx
);

157  
OSIP_UNDEFINED_ERROR
;

158 
	}
}

160 #ñi‡(
deföed
(
HAVE_SEMAPHORE_H
Ë&& !deföed(
__APPLE_CC__
)Ë|| deföed(
HAVE_PTHREAD_WIN32
)

163 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

164 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

166 i‡(
£m
 =
NULL
)

167  
NULL
;

169 i‡(
	`£m_öô
(
£m
, 0, 
vÆue
) == 0)

170  (
osù_£m
 *Ë
£m
;

172 
	`osù_‰ì
(
£m
);

173  
NULL
;

174 
	}
}

176 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

177 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

179 i‡(
£m
 =
NULL
)

180  
OSIP_SUCCESS
;

182 
	`£m_de°roy
(
£m
);

183 
	`osù_‰ì
(
£m
);

184  
OSIP_SUCCESS
;

185 
	}
}

187 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

188 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

190 i‡(
£m
 =
NULL
)

191  
OSIP_BADPARAMETER
;

193  
	`£m_po°
(
£m
);

194 
	}
}

196 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

197 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

199 i‡(
£m
 =
NULL
)

200  
OSIP_BADPARAMETER
;

202  
	`£m_waô
(
£m
);

203 
	}
}

205 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

206 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

208 i‡(
£m
 =
NULL
)

209  
OSIP_BADPARAMETER
;

211  
	`£m_åywaô
(
£m
);

212 
	}
}

214 #ñi‡
deföed
(
__APPLE_CC__
)

215 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

216 
èsk_t
 
èsk
 = 
	`mach_èsk_£lf
();

217 
pﬁicy
 = 
SYNC_POLICY_FIFO
;

218 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

220 i‡(
£m
 =
NULL
)

221  
NULL
;

223 i‡(
	`£m≠h‹e_¸óã
(
èsk
, &
£m
->
£mid
, 
pﬁicy
, 
vÆue
Ë=
KERN_SUCCESS
)

224  (
osù_£m
 *Ë
£m
;

226 
	`osù_‰ì
(
£m
);

227  
NULL
;

228 
	}
}

230 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

231 
èsk_t
 
èsk
 = 
	`mach_èsk_£lf
();

232 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

234 i‡(
£m
 =
NULL
)

235  
OSIP_SUCCESS
;

237 i‡(
	`£m≠h‹e_de°roy
(
èsk
, 
£m
->
£mid
Ë=
KERN_SUCCESS
) {

238 
	`osù_‰ì
(
£m
);

239  
OSIP_SUCCESS
;

242 
	`osù_‰ì
(
£m
);

243  
OSIP_SUCCESS
;

244 
	}
}

246 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

247 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

249 i‡(
£m
 =
NULL
)

250  
OSIP_BADPARAMETER
;

252 i‡(
	`£m≠h‹e_sig«l
(
£m
->
£mid
Ë=
KERN_SUCCESS
)

253  
OSIP_SUCCESS
;

255  
OSIP_UNDEFINED_ERROR
;

256 
	}
}

258 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

259 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

261 i‡(
£m
 =
NULL
)

262  
OSIP_BADPARAMETER
;

264 i‡(
	`£m≠h‹e_waô
(
£m
->
£mid
Ë=
KERN_SUCCESS
)

265  
OSIP_SUCCESS
;

267  
OSIP_UNDEFINED_ERROR
;

268 
	}
}

270 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

271 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

273 i‡(
£m
 =
NULL
)

274  
OSIP_BADPARAMETER
;

276 
mach_time•ec_t
 
waô_time
 = {0, 0};

278 i‡(
	`£m≠h‹e_timedwaô
(
£m
->
£mid
, 
waô_time
Ë=
KERN_SUCCESS
)

279  
OSIP_SUCCESS
;

281  
OSIP_UNDEFINED_ERROR
;

282 
	}
}

284 #ñi‡
deföed
(
HAVE_SYS_SEM_H
)

287 
	#SEM_PERM
 0600

	)

289 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

290 
£mun
 
vÆ
;

291 
i
;

292 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

294 i‡(
£m
 =
NULL
)

295  
NULL
;

297 
£m
->
£mid
 = 
	`£mgë
(
IPC_PRIVATE
, 1, 
IPC_CREAT
 | 
SEM_PERM
);

299 i‡(
£m
->
£mid
 == -1) {

300 
	`≥º‹
("semgetÉrror");

301 
	`osù_‰ì
(
£m
);

302  
NULL
;

305 
vÆ
.vÆ = (Ë
vÆue
;

306 
i
 = 
	`£m˘l
(
£m
->
£mid
, 0, 
SETVAL
, 
vÆ
);

308 i‡(
i
 != 0) {

309 
	`≥º‹
("semctlÉrror");

310 
	`osù_‰ì
(
£m
);

311  
NULL
;

314  (
osù_£m
 *Ë
£m
;

315 
	}
}

317 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

318 
£mun
 
vÆ
;

319 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

321 i‡(
£m
 =
NULL
)

322  
OSIP_SUCCESS
;

324 
vÆ
.val = 0;

325 
	`£m˘l
(
£m
->
£mid
, 0, 
IPC_RMID
, 
vÆ
);

326 
	`osù_‰ì
(
£m
);

327  
OSIP_SUCCESS
;

328 
	}
}

330 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

331 
£mbuf
 
sb
;

332 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

334 i‡(
£m
 =
NULL
)

335  
OSIP_BADPARAMETER
;

337 
sb
.
£m_num
 = 0;

338 
sb
.
£m_›
 = 1;

339 
sb
.
£m_Êg
 = 0;

340  
	`£m›
(
£m
->
£mid
, &
sb
, 1);

341 
	}
}

343 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

344 
£mbuf
 
sb
;

345 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

347 i‡(
£m
 =
NULL
)

348  
OSIP_BADPARAMETER
;

350 
sb
.
£m_num
 = 0;

351 
sb
.
£m_›
 = -1;

352 
sb
.
£m_Êg
 = 0;

353  
	`£m›
(
£m
->
£mid
, &
sb
, 1);

354 
	}
}

356 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

357 
£mbuf
 
sb
;

358 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

360 i‡(
£m
 =
NULL
)

361  
OSIP_BADPARAMETER
;

363 
sb
.
£m_num
 = 0;

364 
sb
.
£m_›
 = -1;

365 
sb
.
£m_Êg
 = 
IPC_NOWAIT
;

366  
	`£m›
(
£m
->
£mid
, &
sb
, 1);

367 
	}
}

372 #ifde‡
__VXWORKS_OS__


374 
osù_muãx
 *
	$osù_muãx_öô
() {

375  (
osù_muãx
 *Ë
	`£mMCª©e
(
SEM_Q_FIFO
 | 
SEM_DELETE_SAFE
);

376 
	}
}

378 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

379 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

381 i‡(
mut
 =
NULL
)

384 
	`£mDñëe
(
mut
);

385 
	}
}

387 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

388 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

390 i‡(
mut
 =
NULL
)

391  
OSIP_BADPARAMETER
;

393  
	`£mTake
(
mut
, 
WAIT_FOREVER
);

394 
	}
}

396 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

397 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

399 i‡(
mut
 =
NULL
)

400  
OSIP_BADPARAMETER
;

402  
	`£mGive
(
mut
);

403 
	}
}

405 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

406 
SEM_ID
 
öô£m
;

407 
osù_£m_t
 *
x
;

409 
x
 = (
osù_£m_t
 *Ë
	`osù_mÆloc
((osip_sem_t));

411 i‡(
x
 =
NULL
)

412  
NULL
;

414 
öô£m
 = 
	`£mCCª©e
(
SEM_Q_FIFO
, 
vÆue
);

415 
x
->
£mId
 = 
öô£m
;

416 
x
->
ªfC¡
 = 
vÆue
;

417 
x
->
£m_«me
 = 
NULL
;

418  (
osù_£m
 *Ë
x
;

419 
	}
}

421 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

422 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

424 i‡(
£m
 =
NULL
)

425  
OSIP_SUCCESS
;

427 
	`£mDñëe
(
£m
->
£mId
);

428 
	`osù_‰ì
(
£m
);

429  
OSIP_SUCCESS
;

430 
	}
}

432 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

433 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

435 i‡(
£m
 =
NULL
)

436  
OSIP_BADPARAMETER
;

438  
	`£mGive
(
£m
->
£mId
);

439 
	}
}

441 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

442 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

444 i‡(
£m
 =
NULL
)

445  
OSIP_BADPARAMETER
;

447  
	`£mTake
(
£m
->
£mId
, 
WAIT_FOREVER
);

448 
	}
}

450 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

451 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

453 i‡(
£m
 =
NULL
)

454  
OSIP_BADPARAMETER
;

456  
	`£mTake
(
£m
->
£mId
, 
NO_WAIT
);

457 
	}
}

461 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

462 
	~<limôs.h
>

464 #i‡(
_WIN32_WINNT
 >0x0403Ë&& !
deföed
(
_WIN32_WCE
)

465 
osù_muãx
 *
	$osù_muãx_öô
() {

466 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
	`osù_mÆloc
((osip_mutex_t));

468 i‡(
mut
 =
NULL
)

469  
NULL
;

471 #i‡
	`deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

473 i‡(
	`InôülizeCrôiˇlSe˘i⁄Ex
(&
mut
->
h
, 
OSIP_CRITICALSECTION_SPIN
, 
CRITICAL_SECTION_NO_DEBUG_INFO
) != 0) {

474  (
osù_muãx
 *Ë(
mut
);

479 i‡(
	`InôülizeCrôiˇlSe˘i⁄AndSpöCou¡
(&
mut
->
h
, 
OSIP_CRITICALSECTION_SPIN
) != 0)

480  (
osù_muãx
 *Ë(
mut
);

483 
	`osù_‰ì
(
mut
);

484  (
NULL
);

485 
	}
}

487 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

488 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

490 i‡(
mut
 =
NULL
)

493 
	`DñëeCrôiˇlSe˘i⁄
(&
mut
->
h
);

494 
	`osù_‰ì
(
mut
);

495 
	}
}

497 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

498 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

500 i‡(
mut
 =
NULL
)

501  
OSIP_BADPARAMETER
;

503 
	`E¡îCrôiˇlSe˘i⁄
(&
mut
->
h
);

506 
	}
}

508 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

509 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

511 i‡(
mut
 =
NULL
)

512  
OSIP_BADPARAMETER
;

514 
	`LóveCrôiˇlSe˘i⁄
(&
mut
->
h
);

516 
	}
}

519 
osù_muãx
 *
	$osù_muãx_öô
() {

520 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
	`osù_mÆloc
((osip_mutex_t));

522 i‡(
mut
 =
NULL
)

523  
NULL
;

525 i‡((
mut
->
h
 = 
	`Cª©eMuãx
(
NULL
, 
FALSE
, NULL)) != NULL)

526  (
osù_muãx
 *Ë(
mut
);

528 
	`osù_‰ì
(
mut
);

529  (
NULL
);

530 
	}
}

532 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

533 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

535 i‡(
mut
 =
NULL
)

538 
	`Clo£H™dÀ
(
mut
->
h
);

539 
	`osù_‰ì
(
mut
);

540 
	}
}

542 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

543 
DWORD
 
îr
;

544 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

546 i‡(
mut
 =
NULL
)

547  
OSIP_BADPARAMETER
;

549 i‡((
îr
 = 
	`WaôF‹SögÀObje˘
(
mut
->
h
, 
INFINITE
)Ë=
WAIT_OBJECT_0
)

553 
	}
}

555 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

556 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

558 i‡(
mut
 =
NULL
)

559  
OSIP_BADPARAMETER
;

561 
	`Rñó£Muãx
(
mut
->
h
);

563 
	}
}

566 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

567 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

569 i‡(
£m
 =
NULL
)

570  
NULL
;

572 #i‡
	`deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

574 i‡((
£m
->
h
 = 
	`Cª©eSem≠h‹eExW
(
NULL
, 
vÆue
, 
LONG_MAX
, NULL, 0, (
STANDARD_RIGHTS_REQUIRED
 | 
SYNCHRONIZE
 | 
SEMAPHORE_MODIFY_STATE
))) != NULL)

575  (
osù_£m
 *Ë(
£m
);

579 i‡((
£m
->
h
 = 
	`Cª©eSem≠h‹e
(
NULL
, 
vÆue
, 
LONG_MAX
, NULL)) != NULL)

580  (
osù_£m
 *Ë(
£m
);

583 
	`osù_‰ì
(
£m
);

584  (
NULL
);

585 
	}
}

587 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

588 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

590 i‡(
£m
 =
NULL
)

591  
OSIP_SUCCESS
;

593 
	`Clo£H™dÀ
(
£m
->
h
);

594 
	`osù_‰ì
(
£m
);

596 
	}
}

598 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

599 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

601 i‡(
£m
 =
NULL
)

602  
OSIP_BADPARAMETER
;

604 
	`Rñó£Sem≠h‹e
(
£m
->
h
, 1, 
NULL
);

606 
	}
}

608 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

609 
DWORD
 
îr
;

610 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

612 i‡(
£m
 =
NULL
)

613  
OSIP_BADPARAMETER
;

615 i‡((
îr
 = 
	`WaôF‹SögÀObje˘Ex
(
£m
->
h
, 
INFINITE
, 
FALSE
)Ë=
WAIT_OBJECT_0
)

618 i‡(
îr
 =
WAIT_TIMEOUT
)

622 
	}
}

624 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

625 
DWORD
 
îr
;

626 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

628 i‡(
£m
 =
NULL
)

629  
OSIP_BADPARAMETER
;

631 i‡((
îr
 = 
	`WaôF‹SögÀObje˘Ex
(
£m
->
h
, 0, 
FALSE
)Ë=
WAIT_OBJECT_0
)

635 
	}
}

638 #ifde‡
__PSOS__


639 
osù_muãx
 *
	$osù_muãx_öô
() {

640 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
	`osù_mÆloc
((osip_mutex_t));

642 i‡(
	`sm_¸óã
("mut", 1, 0, &
mut
->
id
) == 0)

643  (
osù_muãx
 *Ë(
mut
);

645 
	`osù_‰ì
(
mut
);

646  (
NULL
);

647 
	}
}

649 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

650 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

652 i‡(
mut
) {

653 
	`sm_dñëe
(
mut
->
id
);

654 
	`osù_‰ì
(
mut
);

656 
	}
}

658 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

659 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

661 i‡(
mut
) {

662 i‡(
	`sm_p
(
mut
->
id
, 
SM_WAIT
, 0) != 0)

663  
OSIP_UNDEFINED_ERROR
;

667 
	}
}

669 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

670 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

672 i‡(
mut
) {

673 
	`sm_v
(
mut
->
id
);

677 
	}
}

679 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

680 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

682 i‡(
	`sm_¸óã
("£m", 
vÆue
, 0, &
£m
->
id
) == 0)

683  (
osù_£m
 *Ë(
£m
);

685 
	`osù_‰ì
(
£m
);

686  (
NULL
);

687 
	}
}

689 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

690 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

692 i‡(
£m
 =
NULL
)

693  
OSIP_SUCCESS
;

695 
	`sm_dñëe
(
£m
->
id
);

696 
	`osù_‰ì
(
£m
);

698 
	}
}

700 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

701 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

703 i‡(
£m
 =
NULL
)

704  
OSIP_BADPARAMETER
;

706  (
	`sm_v
(
£m
->
id
));

707 
	}
}

709 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

710 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

712 i‡(
£m
 =
NULL
)

713  
OSIP_BADPARAMETER
;

715 i‡(
	`sm_p
(
£m
->
id
, 
SM_WAIT
, 0) != 0)

719 
	}
}

721 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

722 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

724 i‡(
£m
 =
NULL
)

725  
OSIP_BADPARAMETER
;

727 i‡(
	`sm_p
(
£m
->
id
, 
SM_NOWAIT
, 0) != 0)

728  
OSIP_UNDEFINED_ERROR
;

731 
	}
}

735 #i‡
deföed
(
__πems__
)

737 
osù_muãx
 *
	$osù_muãx_öô
() {

738 
πems_°©us_code
 
°©us
;

739 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
	`osù_mÆloc
((osip_mutex_t));

741 
°©us
 = 
	`πems_£m≠h‹e_¸óã
(
	`πems_buûd_«me
('s', 'i', 'p', 'M'), 1,

742 
RTEMS_SIMPLE_BINARY_SEMAPHORE
, 0, &
mut
->
id
);

744 i‡(
°©us
 =
RTEMS_SUCCESSFUL
) {

745  (
osù_muãx
 *Ë(
mut
);

748 
	`osù_‰ì
(
mut
);

749  (
NULL
);

750 
	}
}

752 
	$osù_muãx_de°roy
(
osù_muãx
 *
_mut
) {

753 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

755 i‡(
mut
 !
NULL
) {

756 
	`πems_£m≠h‹e_dñëe
(
mut
->
id
);

757 
	`osù_‰ì
(
mut
);

759 
	}
}

761 
	$osù_muãx_lock
(
osù_muãx
 *
_mut
) {

762 
πems_°©us_code
 
°©us
;

763 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

765 i‡(
mut
 !
NULL
) {

766 
°©us
 = 
	`πems_£m≠h‹e_obèö
(
mut
->
id
, 
RTEMS_WAIT
, 
RTEMS_NO_TIMEOUT
);

768 i‡(
°©us
 !
RTEMS_SUCCESSFUL
) {

769  
OSIP_UNDEFINED_ERROR
;

773  
OSIP_SUCCESS
;

774 
	}
}

776 
	$osù_muãx_u∆ock
(
osù_muãx
 *
_mut
) {

777 
osù_muãx_t
 *
mut
 = (osù_muãx_à*Ë
_mut
;

779 i‡(
mut
 !
NULL
) {

780 (Ë
	`πems_£m≠h‹e_ªÀa£
(
mut
->
id
);

784 
	}
}

786 
osù_£m
 *
	$osù_£m_öô
(
vÆue
) {

787 
πems_°©us_code
 
°©us
;

789 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
	`osù_mÆloc
((osip_sem_t));

791 
°©us
 = 
	`πems_£m≠h‹e_¸óã
(
	`πems_buûd_«me
('s', 'i', 'p', 'S'), 
vÆue
, 
RTEMS_COUNTING_SEMAPHORE
, 0, &
£m
->
id
);

793 i‡(
°©us
 =
RTEMS_SUCCESSFUL
) {

794  (
osù_£m
 *Ë(
£m
);

797 
	`osù_‰ì
(
£m
);

798  (
NULL
);

799 
	}
}

801 
	$osù_£m_de°roy
(
osù_£m
 *
_£m
) {

802 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

804 i‡(
£m
 =
NULL
) {

805  
OSIP_SUCCESS
;

808 
	`πems_£m≠h‹e_dñëe
(
£m
->
id
);

809 
	`osù_‰ì
(
£m
);

811 
	}
}

813 
	$osù_£m_po°
(
osù_£m
 *
_£m
) {

814 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

816 i‡(
£m
 =
NULL
) {

817  
OSIP_UNDEFINED_ERROR
;

820  
	`πems_£m≠h‹e_ªÀa£
(
£m
->
id
);

821 
	}
}

823 
	$osù_£m_waô
(
osù_£m
 *
_£m
) {

824 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

826 i‡(
£m
 =
NULL
) {

827  
OSIP_BADPARAMETER
;

830 i‡(
	`πems_£m≠h‹e_obèö
(
£m
->
id
, 
RTEMS_WAIT
, 
RTEMS_NO_TIMEOUT
Ë!
RTEMS_SUCCESSFUL
) {

831  
OSIP_UNDEFINED_ERROR
;

835 
	}
}

837 
	$osù_£m_åywaô
(
osù_£m
 *
_£m
) {

838 
osù_£m_t
 *
£m
 = (osù_£m_à*Ë
_£m
;

840 i‡(
£m
 =
NULL
) {

841  
OSIP_BADPARAMETER
;

844 i‡(
	`πems_£m≠h‹e_obèö
(
£m
->
id
, 
RTEMS_NO_WAIT
, 0Ë!
RTEMS_SUCCESSFUL
) {

845  
OSIP_UNDEFINED_ERROR
;

849 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_thread.c

20 
	~<osù2/öã∫Æ.h
>

22 #i‚de‡
OSIP_MONOTHREAD


24 
	~<osù∑r£r2/osù_p‹t.h
>

25 
	~<osù2/osù_mt.h
>

27 #i‡
deföed
(
__πems__
)

28 
	~<πems.h
>

31 #i‡!
deföed
(
__πems__
)

32 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

33 #i‡
deföed
 
_WIN32_WCE


34 
	#_begöthªadex
 
Cª©eThªad


	)

35 
	#_ídthªadex
 
ExôThªad


	)

36 #ñi‡
deföed
 
WIN32


37 
	~<¥o˚ss.h
>

43 #i‚de‡
__VXWORKS_OS__


44 #i‡
deföed
(
HAVE_PTHREAD
Ë|| deföed(
HAVE_PTH_PTHREAD_H
Ë|| deföed(
HAVE_PTHREAD_WIN32
)

46 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

47 
i
;

48 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

50 i‡(
thªad
 =
NULL
)

51  
NULL
;

53 
i
 = 
	`±hªad_¸óã
(
thªad
, 
NULL
, 
func
, (*Ë
¨g
);

55 i‡(
i
 != 0) {

56 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Error while creatingáÇewÅhread\n"));

57 
	`osù_‰ì
(
thªad
);

58  
NULL
;

61  (
osù_thªad
 *Ë
thªad
;

62 
	}
}

64 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
thªad
, 
¥i‹ôy
) {

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

69 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

71 i‡(
thªad
 =
NULL
)

72  
OSIP_BADPARAMETER
;

74  
	`±hªad_joö
(*
thªad
, 
NULL
);

75 
	}
}

77 
	$osù_thªad_exô
() {

78 #i‡!
	`deföed
(
__¨c__
)

79 
	`±hªad_exô
(
NULL
);

81 
	}
}

86 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)Ë&& !deföed(
HAVE_PTHREAD_WIN32
)

88 #i‡
deföed
(
HAVE_CPP11_THREAD
)

89 
	~<io°ªam
>

90 
	~<thªad
>

92 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

93 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

95 i‡(
thªad
 =
NULL
)

96  
NULL
;

98 
thªad
->
h
 = 
√w
 
°d
::
	`thªad
(
func
, 
¨g
);

100 i‡(
thªad
->
h
 == 0) {

101 
	`osù_‰ì
(
thªad
);

102  
NULL
;

105  (
osù_thªad
 *Ë
thªad
;

106 
	}
}

108 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

109 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

111 
°d
::
thªad
 *
th
;

113 i‡(
thªad
 =
NULL
)

114  
OSIP_BADPARAMETER
;

116 
th
 = (
°d
::
thªad
 *Ëthªad->
h
;

117 
th
->
	`joö
();

118 
dñëe
 
th
;

120 
thªad
->
h
 = 
NULL
;

122 
	}
}

124 
	$osù_thªad_exô
() {

125 
	}
}

127 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
thªad
, 
¥i‹ôy
) {

128  
OSIP_SUCCESS
;

129 
	}
}

133 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

134 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

136 i‡(
thªad
 =
NULL
)

137  
NULL
;

139 
thªad
->
h
 = (
HANDLE
Ë
	`_begöthªadex
(
NULL
,

141 ((
__°dˇŒ
 *)(*)Ë
func
, 
¨g
, 0, &(
thªad
->
id
));

143 i‡(
thªad
->
h
 == 0) {

144 
	`osù_‰ì
(
thªad
);

145  
NULL
;

148  (
osù_thªad
 *Ë
thªad
;

149 
	}
}

151 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

152 
i
;

153 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

155 i‡(
thªad
 =
NULL
)

156  
OSIP_BADPARAMETER
;

158 
i
 = 
	`WaôF‹SögÀObje˘
(
thªad
->
h
, 
INFINITE
);

160 i‡(
i
 =
WAIT_OBJECT_0
) {

164  
OSIP_UNDEFINED_ERROR
;

167 
	`Clo£H™dÀ
(
thªad
->
h
);

169 
	}
}

171 
	$osù_thªad_exô
() {

173 
	`_ídthªadex
(0);

174 
	}
}

176 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
thªad
, 
¥i‹ôy
) {

177  
OSIP_SUCCESS
;

178 
	}
}

184 #i‚de‡
__VXWORKS_OS__


185 #ifde‡
__PSOS__


186 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

187 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

189 i‡(
thªad
 =
NULL
)

190  (
NULL
);

192 i‡(
	`t_¸óã
("sù", 150, 
°acksize
, 0, 0, &
thªad
->
tid
) != 0) {

193 
	`osù_‰ì
(
thªad
);

194  (
NULL
);

197 i‡(
	`t_°¨t
(
thªad
->
tid
, 
T_PREEMPT
 | 
T_ISR
, 
func
, 0) != 0) {

198 
	`osù_‰ì
(
thªad
);

199  (
NULL
);

202  (
osù_thªad
 *Ë
thªad
;

203 
	}
}

205 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
_thªad
, 
¥i‹ôy
) {

206 
ﬁd¥io
;

207 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

209 i‡(
thªad
 =
NULL
)

210  
OSIP_BADPARAMETER
;

212 
	`t_£t_¥i
(
thªad
->
tid
, 
¥i‹ôy
, &
ﬁd¥io
);

213  
OSIP_SUCCESS
;

214 
	}
}

216 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

217 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

219 i‡(
thªad
 =
NULL
)

220  
OSIP_BADPARAMETER
;

222 
	`t_dñëe
(
thªad
->
tid
);

225 
	}
}

227 
	$osù_thªad_exô
() {

228 
	`t_dñëe
(0);

229 
	}
}

233 #ifde‡
__VXWORKS_OS__


234 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

235 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

237 i‡(
thªad
 =
NULL
)

238  
NULL
;

240 
thªad
->
id
 = 
	`èskS∑wn
(
NULL
, 5, 0, 
°acksize
, (
FUNCPTR
Ë
func
, (Ë
¨g
, 0, 0, 0, 0, 0, 0, 0, 0, 0);

242 i‡(
thªad
->
id
 < 0)

243 
	`osù_‰ì
(
thªad
);

245  (
osù_thªad
 *Ë
thªad
;

246 
	}
}

248 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
_thªad
, 
¥i‹ôy
) {

249 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

251 i‡(
thªad
 =
NULL
)

252  
OSIP_BADPARAMETER
;

254 
	`èskPri‹ôySë
(
thªad
->
id
, 1);

255  
OSIP_SUCCESS
;

256 
	}
}

258 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

259 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

261 i‡(
thªad
 =
NULL
)

262  
OSIP_BADPARAMETER
;

264  
	`èskDñëe
(
thªad
->
id
);

265 
	}
}

267 
	$osù_thªad_exô
() {

269 
	}
}

274 #i‡
deföed
(
__πems__
)

275 
osù_thªad
 *
	$osù_thªad_¸óã
(
°acksize
, *(*
func
)(*), *
¨g
) {

276 
πems_°©us_code
 
°©us
;

277 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
	`osù_mÆloc
((osip_thread_t));

279 i‡(
thªad
 =
NULL
)

280  
NULL
;

282 
°©us
 = 
	`πems_èsk_¸óã
(
	`πems_buûd_«me
('S', 'I', 'P', 'T'), 100, 
°acksize
, 
RTEMS_DEFAULT_MODES
, 
RTEMS_DEFAULT_ATTRIBUTES
, &
thªad
->
tid
);

284 i‡(
°©us
 =
RTEMS_SUCCESSFUL
) {

285 
°©us
 = 
	`πems_èsk_°¨t
(
thªad
->
tid
, (
πems_èsk_íåy
Ë
func
, (
πems_èsk_¨gumít
Ë
¨g
);

288 i‡(
°©us
 !
RTEMS_SUCCESSFUL
) {

289 
	`osù_‰ì
(
thªad
);

290 
thªad
 = 
NULL
;

293  (
osù_thªad
 *Ë
thªad
;

294 
	}
}

296 
	$osù_thªad_£t_¥i‹ôy
(
osù_thªad
 *
_thªad
, 
¥i‹ôy
) {

297 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

299 
πems_èsk_¥i‹ôy
 
ﬁd
;

301 i‡(
thªad
 !
NULL
) {

302  
	`πems_èsk_£t_¥i‹ôy
(
thªad
->
tid
, 
¥i‹ôy
, &
ﬁd
);

305  
OSIP_SUCCESS
;

306 
	}
}

308 
	$osù_thªad_joö
(
osù_thªad
 *
_thªad
) {

309 
osù_thªad_t
 *
thªad
 = (osù_thªad_à*Ë
_thªad
;

311 i‡(
thªad
 =
NULL
) {

312  
OSIP_BADPARAMETER
;

315  
	`πems_èsk_dñëe
(
thªad
->
tid
);

316 
	}
}

318 
	$osù_thªad_exô
() {

319 
	`πems_èsk_dñëe
(
RTEMS_SELF
);

320 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/xixt.h

20 #i‚de‡
_XIXT_H_


21 
	#_XIXT_H_


	)

23 
	~<osù∑r£r2/osù_c⁄°.h
>

24 
	~<osù∑r£r2/osù_p‹t.h
>

26 #ifde‡
__˝lu•lus


30 
__osù_mesßge_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *, 
osù_mesßge_t
 *);

31 
__osù_kûl_å™ß˘i⁄_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *);

32 
__osù_å™•‹t_îr‹_ˇŒback
(
ty≥
, 
osù_å™ß˘i⁄_t
 *, 
îr‹
);

41 
__osù_i˘_öô
(
osù_i˘_t
 **
i˘
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
övôe
);

47 
__osù_i˘_‰ì
(
osù_i˘_t
 *
i˘
);

56 
osù_evít_t
 *
__osù_i˘_√ed_timî_a_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

64 
osù_evít_t
 *
__osù_i˘_√ed_timî_b_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

72 
osù_evít_t
 *
__osù_i˘_√ed_timî_d_evít
(
osù_i˘_t
 *
i˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

81 
__osù_ni˘_öô
(
osù_ni˘_t
 **
ni˘
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
ªque°
);

87 
__osù_ni˘_‰ì
(
osù_ni˘_t
 *
ni˘
);

96 
osù_evít_t
 *
__osù_ni˘_√ed_timî_e_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

104 
osù_evít_t
 *
__osù_ni˘_√ed_timî_f_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

112 
osù_evít_t
 *
__osù_ni˘_√ed_timî_k_evít
(
osù_ni˘_t
 *
ni˘
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

121 
__osù_i°_öô
(
osù_i°_t
 **
i°
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
övôe
);

127 
__osù_i°_‰ì
(
osù_i°_t
 *
i°
);

136 
osù_evít_t
 *
__osù_i°_√ed_timî_g_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

144 
osù_evít_t
 *
__osù_i°_√ed_timî_h_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

152 
osù_evít_t
 *
__osù_i°_√ed_timî_i_evít
(
osù_i°_t
 *
i°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

161 
__osù_ni°_öô
(
osù_ni°_t
 **
ni°
, 
osù_t
 *
osù
, 
osù_mesßge_t
 *
ªque°
);

168 
__osù_ni°_‰ì
(
osù_ni°_t
 *
ni°
);

176 
osù_evít_t
 *
__osù_ni°_√ed_timî_j_evít
(
osù_ni°_t
 *
ni°
, 
°©e_t
 
°©e
, 
å™ß˘i⁄id
);

184 
__osù_å™ß˘i⁄_m©chög_ª•⁄£_osù_to_xi˘_17_1_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ª•
);

192 
__osù_å™ß˘i⁄_m©chög_ªque°_osù_to_xi°_17_2_3
(
osù_å™ß˘i⁄_t
 *
å
, 
osù_mesßge_t
 *
ªque°
);

199 
osù_i˘_lock
(
osù_t
 *
osù
);

205 
osù_i˘_u∆ock
(
osù_t
 *
osù
);

211 
osù_i°_lock
(
osù_t
 *
osù
);

217 
osù_i°_u∆ock
(
osù_t
 *
osù
);

223 
osù_ni˘_lock
(
osù_t
 *
osù
);

229 
osù_ni˘_u∆ock
(
osù_t
 *
osù
);

235 
osù_ni°_lock
(
osù_t
 *
osù
);

241 
osù_ni°_u∆ock
(
osù_t
 *
osù
);

249 
__osù_add_i˘
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i˘
);

256 
__osù_add_i°
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i°
);

263 
__osù_add_ni˘
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni˘
);

270 
__osù_add_ni°
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni°
);

277 
__osù_ªmove_i˘_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i˘
);

283 
__osù_ªmove_i°_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
i°
);

289 
__osù_ªmove_ni˘_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni˘
);

295 
__osù_ªmove_ni°_å™ß˘i⁄
(
osù_t
 *
osù
, 
osù_å™ß˘i⁄_t
 *
ni°
);

303 
osù_evít_t
 *
__osù_evít_√w
(
ty≥_t
 
ty≥
, 
å™ß˘i⁄id
);

309 
osù_evít_t
 *
osù_√w_outgoög_sùmesßge
(
osù_mesßge_t
 *
sù
);

311 #ifde‡
__˝lu•lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 #i‚de‡
MINISIZE


32 
	$osù_mesßge_£t_ac˚±
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

33 
osù_ac˚±_t
 *
ac˚±
;

34 
i
;

36 
i
 = 
	`ac˚±_öô
(&
ac˚±
);

38 i‡(
i
 != 0)

39  
i
;

41 
i
 = 
	`osù_ac˚±_∑r£
(
ac˚±
, 
hvÆue
);

43 i‡(
i
 != 0) {

44 
	`osù_ac˚±_‰ì
(
ac˚±
);

45  
i
;

48 
sù
->
mesßge_¥›îty
 = 2;

50 
	`osù_li°_add
(&
sù
->
ac˚±s
, 
ac˚±
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

54 
	$osù_mesßge_gë_ac˚±
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_t
 **
de°
) {

55 
osù_ac˚±_t
 *
ac˚±
;

57 *
de°
 = 
NULL
;

59 i‡(
	`osù_li°_size
(&
sù
->
ac˚±s
Ë<
pos
)

60  
OSIP_UNDEFINED_ERROR
;

62 
ac˚±
 = (
osù_ac˚±_t
 *Ë
	`osù_li°_gë
(&
sù
->
ac˚±s
, 
pos
);

63 *
de°
 = 
ac˚±
;

64  
pos
;

65 
	}
}

70 
	$osù_ac˚±_to_°r
(c⁄° 
osù_ac˚±_t
 *
ac˚±
, **
de°
) {

71 *
buf
;

72 *
tmp
;

73 
size_t
 
Àn
 = 0;

75 *
de°
 = 
NULL
;

77 i‡(
ac˚±
 =
NULL
)

78  
OSIP_BADPARAMETER
;

80 i‡(
ac˚±
->
ty≥
 !
NULL
)

81 
Àn
 +
	`°æí
(
ac˚±
->
ty≥
);

83 i‡(
ac˚±
->
subty≥
 !
NULL
)

84 
Àn
 +
	`°æí
(
ac˚±
->
subty≥
);

86 i‡(
Àn
 == 0) {

88 
buf
 = (*Ë
	`osù_mÆloc
(2);

90 i‡(
buf
 =
NULL
)

91  
OSIP_NOMEM
;

93 
buf
[0] = ' ';

94 
buf
[1] = '\0';

95 *
de°
 = 
buf
;

96  
OSIP_SUCCESS
;

100 
Àn
 += 4

101 + 10 * 
	`osù_li°_size
(&
ac˚±
->
gí_∑øms
);

103 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

105 i‡(
buf
 =
NULL
)

106  
OSIP_NOMEM
;

108 
tmp
 = 
buf
;

110 
	`•rötf
(
tmp
, "%s/%s", 
ac˚±
->
ty≥
,ác˚±->
subty≥
);

112 
tmp
 =Åm∞+ 
	`°æí
(tmp);

114 
osù_li°_ôî©‹_t
 
ô
;

115 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
ac˚±
->
gí_∑øms
, &
ô
);

117 
u_∑øm
 !
OSIP_SUCCESS
) {

118 
size_t
 
tmp_Àn
;

120 i‡(
u_∑øm
->
gvÆue
 =
NULL
) {

121 
	`osù_‰ì
(
buf
);

122  
OSIP_SYNTAXERROR
;

125 
tmp_Àn
 = 
	`°æí
(
buf
Ë+ 4 + såÀn(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 1;

127 i‡(
Àn
 < 
tmp_Àn
) {

128 
buf
 = 
	`osù_ªÆloc
(buf, 
tmp_Àn
);

129 
Àn
 = 
tmp_Àn
;

130 
tmp
 = 
buf
 + 
	`°æí
(buf);

133 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), "; %s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

134 
tmp
 =Åm∞+ 
	`°æí
(tmp);

135 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

138 *
de°
 = 
buf
;

139  
OSIP_SUCCESS
;

140 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_encoding.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


32 
	$osù_mesßge_£t_ac˚±_ícodög
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

33 
osù_ac˚±_ícodög_t
 *
ac˚±_ícodög
;

34 
i
;

36 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`osù_ac˚±_ícodög_öô
(&
ac˚±_ícodög
);

41 i‡(
i
 != 0)

42  
i
;

44 
i
 = 
	`osù_ac˚±_ícodög_∑r£
(
ac˚±_ícodög
, 
hvÆue
);

46 i‡(
i
 != 0) {

47 
	`osù_ac˚±_ícodög_‰ì
(
ac˚±_ícodög
);

48  
i
;

51 
sù
->
mesßge_¥›îty
 = 2;

52 
	`osù_li°_add
(&
sù
->
ac˚±_ícodögs
, 
ac˚±_ícodög
, -1);

53  
OSIP_SUCCESS
;

54 
	}
}

56 
	$osù_mesßge_gë_ac˚±_ícodög
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_ícodög_t
 **
de°
) {

57 
osù_ac˚±_ícodög_t
 *
ac˚±_ícodög
;

59 *
de°
 = 
NULL
;

61 i‡(
	`osù_li°_size
(&
sù
->
ac˚±_ícodögs
Ë<
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
ac˚±_ícodög
 = (
osù_ac˚±_ícodög_t
 *Ë
	`osù_li°_gë
(&
sù
->
ac˚±_ícodögs
, 
pos
);

65 *
de°
 = 
ac˚±_ícodög
;

66  
pos
;

67 
	}
}

69 
	$osù_ac˚±_ícodög_öô
(
osù_ac˚±_ícodög_t
 **
ac˚±_ícodög
) {

70 *
ac˚±_ícodög
 = (
osù_ac˚±_ícodög_t
 *Ë
	`osù_mÆloc
((osip_accept_encoding_t));

72 i‡(*
ac˚±_ícodög
 =
NULL
)

73  
OSIP_NOMEM
;

75 (*
ac˚±_ícodög
)->
ñemít
 = 
NULL
;

77 
	`osù_li°_öô
(&(*
ac˚±_ícodög
)->
gí_∑øms
);

79  
OSIP_SUCCESS
;

80 
	}
}

82 
	$osù_ac˚±_ícodög_∑r£
(
osù_ac˚±_ícodög_t
 *
ac˚±_ícodög
, c⁄° *
hvÆue
) {

83 
i
;

84 c⁄° *
osù_ac˚±_ícodög_∑øms
;

86 
osù_ac˚±_ícodög_∑øms
 = 
	`°rchr
(
hvÆue
, ';');

88 i‡(
osù_ac˚±_ícodög_∑øms
 !
NULL
) {

89 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
ac˚±_ícodög
->
gí_∑øms
, 
osù_ac˚±_ícodög_∑øms
);

91 i‡(
i
 != 0)

92  
i
;

95 
osù_ac˚±_ícodög_∑øms
 = 
hvÆue
 + 
	`°æí
(hvalue);

97 i‡(
osù_ac˚±_ícodög_∑øms
 - 
hvÆue
 + 1 < 2)

98  
OSIP_SYNTAXERROR
;

100 
ac˚±_ícodög
->
ñemít
 = (*Ë
	`osù_mÆloc
(
osù_ac˚±_ícodög_∑øms
 - 
hvÆue
 + 1);

102 i‡(
ac˚±_ícodög
->
ñemít
 =
NULL
)

103  
OSIP_NOMEM
;

105 
	`osù_˛∫˝y
(
ac˚±_ícodög
->
ñemít
, 
hvÆue
, 
osù_ac˚±_ícodög_∑øms
 - hvalue);

107  
OSIP_SUCCESS
;

108 
	}
}

113 
	$osù_ac˚±_ícodög_to_°r
(c⁄° 
osù_ac˚±_ícodög_t
 *
ac˚±_ícodög
, **
de°
) {

114 *
buf
;

115 *
tmp
;

116 
size_t
 
Àn
;

118 *
de°
 = 
NULL
;

120 i‡((
ac˚±_ícodög
 =
NULL
Ë|| (ac˚±_ícodög->
ñemít
 == NULL))

121  
OSIP_BADPARAMETER
;

123 
Àn
 = 
	`°æí
(
ac˚±_ícodög
->
ñemít
) + 2;

124 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

126 i‡(
buf
 =
NULL
)

127  
OSIP_NOMEM
;

129 
	`•rötf
(
buf
, "%s", 
ac˚±_ícodög
->
ñemít
);

131 
size_t
 
∂í
;

132 
osù_li°_ôî©‹_t
 
ô
;

133 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
ac˚±_ícodög
->
gí_∑øms
, &
ô
);

135 
u_∑øm
 !
OSIP_SUCCESS
) {

136 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

137 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
) + 2;

140 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 3;

142 
Àn
 =Üí + 
∂í
;

143 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

144 
tmp
 = 
buf
;

145 
tmp
 =Åm∞+ 
	`°æí
(tmp);

147 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

148 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s", 
u_∑øm
->
g«me
);

151 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

153 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

156 *
de°
 = 
buf
;

157  
OSIP_SUCCESS
;

158 
	}
}

162 
	$osù_ac˚±_ícodög_‰ì
(
osù_ac˚±_ícodög_t
 *
ac˚±_ícodög
) {

163 i‡(
ac˚±_ícodög
 =
NULL
)

166 
	`osù_‰ì
(
ac˚±_ícodög
->
ñemít
);

168 
	`osù_gíîic_∑øm_‰ìli°
(&
ac˚±_ícodög
->
gí_∑øms
);

170 
ac˚±_ícodög
->
ñemít
 = 
NULL
;

171 
	`osù_‰ì
(
ac˚±_ícodög
);

172 
	}
}

174 
	$osù_ac˚±_ícodög_˛⁄e
(c⁄° 
osù_ac˚±_ícodög_t
 *
˘t
, osù_ac˚±_ícodög_à**
de°
) {

175 
i
;

176 
osù_ac˚±_ícodög_t
 *
˘
;

178 *
de°
 = 
NULL
;

180 i‡(
˘t
 =
NULL
)

181  
OSIP_BADPARAMETER
;

183 i‡(
˘t
->
ñemít
 =
NULL
)

184  
OSIP_BADPARAMETER
;

186 
i
 = 
	`osù_ac˚±_ícodög_öô
(&
˘
);

188 i‡(
i
 != 0)

189  
i
;

191 
˘
->
ñemít
 = 
	`osù_°rdup
(
˘t
->element);

193 i‡(
˘
->
ñemít
 =
NULL
) {

194 
	`osù_ac˚±_ícodög_‰ì
(
˘
);

195  
OSIP_NOMEM
;

199 
osù_gíîic_∑øm_t
 *
de°_∑øm
;

200 
osù_li°_ôî©‹_t
 
ô
;

201 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
˘t
->
gí_∑øms
, &
ô
);

203 
u_∑øm
 !
OSIP_SUCCESS
) {

204 
i
 = 
	`osù_gíîic_∑øm_˛⁄e
(
u_∑øm
, &
de°_∑øm
);

206 i‡(
i
 != 0) {

207 
	`osù_ac˚±_ícodög_‰ì
(
˘
);

208  
i
;

211 
	`osù_li°_add
(&
˘
->
gí_∑øms
, 
de°_∑øm
, -1);

212 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

216 *
de°
 = 
˘
;

217  
OSIP_SUCCESS
;

218 
	}
}

220 *
	$osù_ac˚±_ícodög_gë_ñemít
(c⁄° 
osù_ac˚±_ícodög_t
 *
´
) {

221  
´
->
ñemít
;

222 
	}
}

224 
	$osù_ac˚±_ícodög_£t_ñemít
(
osù_ac˚±_ícodög_t
 *
´
, *
ñemít
) {

225 
´
->
ñemít
 =Élement;

226 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_language.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


29 
	$osù_mesßge_£t_ac˚±_œnguage
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

30 
osù_ac˚±_œnguage_t
 *
ac˚±_œnguage
;

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`osù_ac˚±_œnguage_öô
(&
ac˚±_œnguage
);

38 i‡(
i
 != 0)

39  
i
;

41 
i
 = 
	`osù_ac˚±_œnguage_∑r£
(
ac˚±_œnguage
, 
hvÆue
);

43 i‡(
i
 != 0) {

44 
	`osù_ac˚±_œnguage_‰ì
(
ac˚±_œnguage
);

45  
i
;

48 
sù
->
mesßge_¥›îty
 = 2;

49 
	`osù_li°_add
(&
sù
->
ac˚±_œnguages
, 
ac˚±_œnguage
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$osù_mesßge_gë_ac˚±_œnguage
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ac˚±_œnguage_t
 **
de°
) {

54 
osù_ac˚±_œnguage_t
 *
ac˚±_œnguage
;

56 *
de°
 = 
NULL
;

58 i‡(
	`osù_li°_size
(&
sù
->
ac˚±_œnguages
Ë<
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
ac˚±_œnguage
 = (
osù_ac˚±_œnguage_t
 *Ë
	`osù_li°_gë
(&
sù
->
ac˚±_œnguages
, 
pos
);

62 *
de°
 = 
ac˚±_œnguage
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_alert_info.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


29 
	$osù_mesßge_£t_Æît_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

30 
osù_Æît_öfo_t
 *
Æît_öfo
;

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`osù_Æît_öfo_öô
(&
Æît_öfo
);

38 i‡(
i
 != 0)

39  
i
;

41 
i
 = 
	`osù_Æît_öfo_∑r£
(
Æît_öfo
, 
hvÆue
);

43 i‡(
i
 != 0) {

44 
	`osù_Æît_öfo_‰ì
(
Æît_öfo
);

45  
i
;

48 
sù
->
mesßge_¥›îty
 = 2;

49 
	`osù_li°_add
(&
sù
->
Æît_öfos
, 
Æît_öfo
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$osù_mesßge_gë_Æît_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_Æît_öfo_t
 **
de°
) {

54 
osù_Æît_öfo_t
 *
Æît_öfo
;

56 *
de°
 = 
NULL
;

58 i‡(
	`osù_li°_size
(&
sù
->
Æît_öfos
Ë<
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
Æît_öfo
 = (
osù_Æît_öfo_t
 *Ë
	`osù_li°_gë
(&
sù
->
Æît_öfos
, 
pos
);

62 *
de°
 = 
Æît_öfo
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_allow.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


29 
	$osù_mesßge_£t_Ælow
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

30 
osù_Ælow_t
 *
Ælow
;

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`osù_Ælow_öô
(&
Ælow
);

38 i‡(
i
 != 0)

39  
i
;

41 
i
 = 
	`osù_Ælow_∑r£
(
Ælow
, 
hvÆue
);

43 i‡(
i
 != 0) {

44 
	`osù_Ælow_‰ì
(
Ælow
);

45  
i
;

48 
sù
->
mesßge_¥›îty
 = 2;

49 
	`osù_li°_add
(&
sù
->
Ælows
, 
Ælow
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$osù_mesßge_gë_Ælow
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_Ælow_t
 **
de°
) {

54 
osù_Ælow_t
 *
Ælow
;

56 *
de°
 = 
NULL
;

58 i‡(
	`osù_li°_size
(&
sù
->
Ælows
Ë<
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
Ælow
 = (
osù_Ælow_t
 *Ë
	`osù_li°_gë
(&
sù
->
Ælows
, 
pos
);

62 *
de°
 = 
Ælow
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authentication_info.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


29 
	$osù_authítiˇti⁄_öfo_öô
(
osù_authítiˇti⁄_öfo_t
 **
de°
) {

30 *
de°
 = (
osù_authítiˇti⁄_öfo_t
 *Ë
	`osù_mÆloc
((osip_authentication_info_t));

32 i‡(*
de°
 =
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
de°
, 0, (
osù_authítiˇti⁄_öfo_t
));

36  
OSIP_SUCCESS
;

37 
	}
}

43 
	$osù_mesßge_£t_authítiˇti⁄_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

44 
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
;

45 
i
;

47 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

48  
OSIP_SUCCESS
;

50 i‡(
sù
 =
NULL
)

51  
OSIP_BADPARAMETER
;

53 
i
 = 
	`osù_authítiˇti⁄_öfo_öô
(&
authítiˇti⁄_öfo
);

55 i‡(
i
 != 0)

56  
i
;

58 
i
 = 
	`osù_authítiˇti⁄_öfo_∑r£
(
authítiˇti⁄_öfo
, 
hvÆue
);

60 i‡(
i
 != 0) {

61 
	`osù_authítiˇti⁄_öfo_‰ì
(
authítiˇti⁄_öfo
);

62  
i
;

65 
sù
->
mesßge_¥›îty
 = 2;

67 
	`osù_li°_add
(&
sù
->
authítiˇti⁄_öfos
, 
authítiˇti⁄_öfo
, -1);

68  
OSIP_SUCCESS
;

69 
	}
}

79 
	$osù_authítiˇti⁄_öfo_∑r£
(
osù_authítiˇti⁄_öfo_t
 *
aöfo
, c⁄° *
hvÆue
) {

80 c⁄° *
•a˚
, *
hack
;

81 c⁄° *
√xt
 = 
NULL
;

82 
i
;

84 
•a˚
 = 
	`°rchr
(
hvÆue
, ' ');

85 
hack
 = 
	`°rchr
(
hvÆue
, '=');

87 i‡(
•a˚
 && 
hack
 && hack > space) {

88 
aöfo
->
auth_ty≥
 = (*Ë
	`osù_mÆloc
(
•a˚
 - 
hvÆue
 + 1);

90 i‡(
aöfo
->
auth_ty≥
 =
NULL
)

91  
OSIP_NOMEM
;

93 
	`osù_°∫˝y
(
aöfo
->
auth_ty≥
, 
hvÆue
, 
•a˚
 - hvalue);

96 
•a˚
 = 
hvÆue
;

99 
∑r£_ok
 = 0;

101 
i
 = 
	`__osù_quŸed_°rög_£t
("√xä⁄˚", 
•a˚
, &(
aöfo
->
√xä⁄˚
), &
√xt
);

103 i‡(
i
 != 0)

104  
i
;

106 i‡(
√xt
 =
NULL
)

107  
OSIP_SUCCESS
;

108 i‡(
√xt
 !
•a˚
) {

109 
•a˚
 = 
√xt
;

110 
∑r£_ok
++;

113 
i
 = 
	`__osù_quŸed_°rög_£t
("˙⁄˚", 
•a˚
, &(
aöfo
->
˙⁄˚
), &
√xt
);

115 i‡(
i
 != 0)

116  
i
;

118 i‡(
√xt
 =
NULL
)

119  
OSIP_SUCCESS
;

120 i‡(
√xt
 !
•a˚
) {

121 
•a˚
 = 
√xt
;

122 
∑r£_ok
++;

125 
i
 = 
	`__osù_quŸed_°rög_£t
("r•auth", 
•a˚
, &(
aöfo
->
r•auth
), &
√xt
);

127 i‡(
i
 != 0)

128  
i
;

130 i‡(
√xt
 =
NULL
)

131  
OSIP_SUCCESS
;

132 i‡(
√xt
 !
•a˚
) {

133 
•a˚
 = 
√xt
;

134 
∑r£_ok
++;

137 
i
 = 
	`__osù_tokí_£t
("nc", 
•a˚
, &(
aöfo
->
n⁄˚_cou¡
), &
√xt
);

139 i‡(
i
 != 0)

140  
i
;

142 i‡(
√xt
 =
NULL
)

143  
OSIP_SUCCESS
;

144 i‡(
√xt
 !
•a˚
) {

145 
•a˚
 = 
√xt
;

146 
∑r£_ok
++;

149 
i
 = 
	`__osù_tokí_£t
("q›", 
•a˚
, &(
aöfo
->
q›_›ti⁄s
), &
√xt
);

151 i‡(
i
 != 0)

152  
i
;

154 i‡(
√xt
 =
NULL
)

155  
OSIP_SUCCESS
;

156 i‡(
√xt
 !
•a˚
) {

157 
•a˚
 = 
√xt
;

158 
∑r£_ok
++;

161 
i
 = 
	`__osù_quŸed_°rög_£t
("¢um", 
•a˚
, &(
aöfo
->
¢um
), &
√xt
);

163 i‡(
i
 != 0)

164  
i
;

166 i‡(
√xt
 =
NULL
)

167  
OSIP_SUCCESS
;

168 i‡(
√xt
 !
•a˚
) {

169 
•a˚
 = 
√xt
;

170 
∑r£_ok
++;

173 
i
 = 
	`__osù_quŸed_°rög_£t
("§™d", 
•a˚
, &(
aöfo
->
§™d
), &
√xt
);

175 i‡(
i
 != 0)

176  
i
;

178 i‡(
√xt
 =
NULL
)

179  
OSIP_SUCCESS
;

180 i‡(
√xt
 !
•a˚
) {

181 
•a˚
 = 
√xt
;

182 
∑r£_ok
++;

185 
i
 = 
	`__osù_quŸed_°rög_£t
("èrgë«me", 
•a˚
, &(
aöfo
->
èrgë«me
), &
√xt
);

187 i‡(
i
 != 0)

188  
i
;

190 i‡(
√xt
 =
NULL
)

191  
OSIP_SUCCESS
;

192 i‡(
√xt
 !
•a˚
) {

193 
•a˚
 = 
√xt
;

194 
∑r£_ok
++;

197 
i
 = 
	`__osù_quŸed_°rög_£t
("ªÆm", 
•a˚
, &(
aöfo
->
ªÆm
), &
√xt
);

199 i‡(
i
 != 0)

200  
i
;

202 i‡(
√xt
 =
NULL
)

203  
OSIP_SUCCESS
;

204 i‡(
√xt
 !
•a˚
) {

205 
•a˚
 = 
√xt
;

206 
∑r£_ok
++;

209 
i
 = 
	`__osù_quŸed_°rög_£t
("›aque", 
•a˚
, &(
aöfo
->
›aque
), &
√xt
);

211 i‡(
i
 != 0)

212  
i
;

214 i‡(
√xt
 =
NULL
)

215  
OSIP_SUCCESS
;

216 i‡(
√xt
 !
•a˚
) {

217 
•a˚
 = 
√xt
;

218 
∑r£_ok
++;

221 i‡(0 =
∑r£_ok
) {

222 c⁄° *
quŸe1
, *
quŸe2
, *
tmp
;

227 i‡(
	`°æí
(
•a˚
) < 1)

228  
OSIP_SUCCESS
;

230 
tmp
 = 
	`°rchr
(
•a˚
 + 1, ',');

232 i‡(
tmp
 =
NULL
)

233  
OSIP_SUCCESS
;

235 
quŸe1
 = 
	`__osù_quŸe_föd
(
•a˚
);

237 i‡((
quŸe1
 !
NULL
Ë&& (quŸe1 < 
tmp
)) {

238 
quŸe2
 = 
	`__osù_quŸe_föd
(
quŸe1
 + 1);

240 i‡(
quŸe2
 =
NULL
)

241  
OSIP_SYNTAXERROR
;

243 i‡(
tmp
 < 
quŸe2
)

244 
•a˚
 = 
	`°rchr
(
quŸe2
, ',');

247 
•a˚
 = 
tmp
;

249 i‡(
•a˚
 =
NULL
)

250  
OSIP_SUCCESS
;

253 
•a˚
 = 
tmp
;

259  
OSIP_SUCCESS
;

260 
	}
}

265 
	$osù_mesßge_gë_authítiˇti⁄_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_authítiˇti⁄_öfo_t
 **
de°
) {

266 
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
;

268 *
de°
 = 
NULL
;

270 i‡(
	`osù_li°_size
(&
sù
->
authítiˇti⁄_öfos
Ë<
pos
)

271  
OSIP_UNDEFINED_ERROR
;

273 
authítiˇti⁄_öfo
 = (
osù_authítiˇti⁄_öfo_t
 *Ë
	`osù_li°_gë
(&
sù
->
authítiˇti⁄_öfos
, 
pos
);

275 *
de°
 = 
authítiˇti⁄_öfo
;

276  
pos
;

277 
	}
}

279 *
	$osù_authítiˇti⁄_öfo_gë_auth_ty≥
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

280  
authítiˇti⁄_öfo
->
auth_ty≥
;

281 
	}
}

283 
	$osù_authítiˇti⁄_öfo_£t_auth_ty≥
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
auth_ty≥
) {

284 
authítiˇti⁄_öfo
->
auth_ty≥
 = (*)áuth_type;

285 
	}
}

287 *
	$osù_authítiˇti⁄_öfo_gë_√xä⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

288  
authítiˇti⁄_öfo
->
√xä⁄˚
;

289 
	}
}

291 
	$osù_authítiˇti⁄_öfo_£t_√xä⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
√xä⁄˚
) {

292 
authítiˇti⁄_öfo
->
√xä⁄˚
 = (*)Çextnonce;

293 
	}
}

295 *
	$osù_authítiˇti⁄_öfo_gë_˙⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

296  
authítiˇti⁄_öfo
->
˙⁄˚
;

297 
	}
}

299 
	$osù_authítiˇti⁄_öfo_£t_˙⁄˚
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
˙⁄˚
) {

300 
authítiˇti⁄_öfo
->
˙⁄˚
 = (*) cnonce;

301 
	}
}

303 *
	$osù_authítiˇti⁄_öfo_gë_r•auth
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

304  
authítiˇti⁄_öfo
->
r•auth
;

305 
	}
}

307 
	$osù_authítiˇti⁄_öfo_£t_r•auth
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
r•auth
) {

308 
authítiˇti⁄_öfo
->
r•auth
 = (*)Ñspauth;

309 
	}
}

311 *
	$osù_authítiˇti⁄_öfo_gë_n⁄˚_cou¡
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

312  
authítiˇti⁄_öfo
->
n⁄˚_cou¡
;

313 
	}
}

315 
	$osù_authítiˇti⁄_öfo_£t_n⁄˚_cou¡
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
n⁄˚_cou¡
) {

316 
authítiˇti⁄_öfo
->
n⁄˚_cou¡
 = (*)Çonce_count;

317 
	}
}

319 *
	$osù_authítiˇti⁄_öfo_gë_q›_›ti⁄s
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

320  
authítiˇti⁄_öfo
->
q›_›ti⁄s
;

321 
	}
}

323 
	$osù_authítiˇti⁄_öfo_£t_q›_›ti⁄s
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
q›_›ti⁄s
) {

324 
authítiˇti⁄_öfo
->
q›_›ti⁄s
 = (*) qop_options;

325 
	}
}

327 *
	$osù_authítiˇti⁄_öfo_gë_¢um
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

328  
authítiˇti⁄_öfo
->
¢um
;

329 
	}
}

331 
	$osù_authítiˇti⁄_öfo_£t_¢um
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
¢um
) {

332 
authítiˇti⁄_öfo
->
¢um
 = (*) snum;

333 
	}
}

335 *
	$osù_authítiˇti⁄_öfo_gë_§™d
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

336  
authítiˇti⁄_öfo
->
§™d
;

337 
	}
}

339 
	$osù_authítiˇti⁄_öfo_£t_§™d
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
§™d
) {

340 
authítiˇti⁄_öfo
->
§™d
 = (*) srand;

341 
	}
}

343 *
	$osù_authítiˇti⁄_öfo_gë_èrgë«me
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

344  
authítiˇti⁄_öfo
->
èrgë«me
;

345 
	}
}

347 
	$osù_authítiˇti⁄_öfo_£t_èrgë«me
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
èrgë«me
) {

348 
authítiˇti⁄_öfo
->
èrgë«me
 = (*)Åargetname;

349 
	}
}

351 *
	$osù_authítiˇti⁄_öfo_gë_ªÆm
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

352  
authítiˇti⁄_öfo
->
ªÆm
;

353 
	}
}

355 
	$osù_authítiˇti⁄_öfo_£t_ªÆm
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
ªÆm
) {

356 
authítiˇti⁄_öfo
->
ªÆm
 = (*)Ñealm;

357 
	}
}

359 *
	$osù_authítiˇti⁄_öfo_gë_›aque
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

360  
authítiˇti⁄_öfo
->
›aque
;

361 
	}
}

363 
	$osù_authítiˇti⁄_öfo_£t_›aque
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
, *
›aque
) {

364 
authítiˇti⁄_öfo
->
›aque
 = (*) opaque;

365 
	}
}

370 
	$osù_authítiˇti⁄_öfo_to_°r
(c⁄° 
osù_authítiˇti⁄_öfo_t
 *
aöfo
, **
de°
) {

371 
size_t
 
Àn
;

372 *
tmp
, *
°¨t
;

374 *
de°
 = 
NULL
;

376 i‡(
aöfo
 =
NULL
)

377  
OSIP_BADPARAMETER
;

379 
Àn
 = 0;

381 i‡(
aöfo
->
auth_ty≥
 !
NULL
)

382 
Àn
 =Üí + 
	`°æí
(
aöfo
->
auth_ty≥
) + 1;

384 i‡(
aöfo
->
√xä⁄˚
 !
NULL
)

385 
Àn
 =Üí + 
	`°æí
(
aöfo
->
√xä⁄˚
) + 12;

387 i‡(
aöfo
->
r•auth
 !
NULL
)

388 
Àn
 =Üí + 
	`°æí
(
aöfo
->
r•auth
) + 10;

390 i‡(
aöfo
->
˙⁄˚
 !
NULL
)

391 
Àn
 =Üí + 
	`°æí
(
aöfo
->
˙⁄˚
) + 9;

393 i‡(
aöfo
->
n⁄˚_cou¡
 !
NULL
)

394 
Àn
 =Üí + 
	`°æí
(
aöfo
->
n⁄˚_cou¡
) + 5;

396 i‡(
aöfo
->
q›_›ti⁄s
 !
NULL
)

397 
Àn
 =Üí + 
	`°æí
(
aöfo
->
q›_›ti⁄s
) + 6;

399 i‡(
aöfo
->
¢um
 !
NULL
)

400 
Àn
 =Üí + 
	`°æí
(
aöfo
->
¢um
) + 7;

402 i‡(
aöfo
->
§™d
 !
NULL
)

403 
Àn
 =Üí + 
	`°æí
(
aöfo
->
§™d
) + 8;

405 i‡(
aöfo
->
èrgë«me
 !
NULL
)

406 
Àn
 =Üí + 
	`°æí
(
aöfo
->
èrgë«me
) + 13;

408 i‡(
aöfo
->
ªÆm
 !
NULL
)

409 
Àn
 =Üí + 
	`°æí
(
aöfo
->
ªÆm
) + 8;

411 i‡(
aöfo
->
›aque
 !
NULL
)

412 
Àn
 =Üí + 
	`°æí
(
aöfo
->
›aque
) + 9;

414 i‡(
Àn
 == 0)

415  
OSIP_BADPARAMETER
;

417 
Àn
++;

418 
tmp
 = (*Ë
	`osù_mÆloc
(
Àn
);

420 i‡(
tmp
 =
NULL
)

421  
OSIP_NOMEM
;

423 *
de°
 = 
tmp
;

425 
°¨t
 = 
tmp
;

427 i‡(
aöfo
->
auth_ty≥
 !
NULL
) {

428 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
auth_ty≥
);

429 
tmp
 = 
	`osù_°r_≠≥nd
(tmp, " ");

430 
°¨t
 = 
tmp
;

433 i‡(
aöfo
->
q›_›ti⁄s
 !
NULL
) {

434 i‡(
tmp
 !
°¨t
) {

435 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

438 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "qop=", 4);

439 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
q›_›ti⁄s
);

442 i‡(
aöfo
->
√xä⁄˚
 !
NULL
) {

443 i‡(
tmp
 !
°¨t
) {

444 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

447 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "nextnonce=", 10);

448 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
√xä⁄˚
);

451 i‡(
aöfo
->
r•auth
 !
NULL
) {

452 i‡(
tmp
 !
°¨t
) {

453 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

456 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "rspauth=", 8);

457 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
r•auth
);

460 i‡(
aöfo
->
˙⁄˚
 !
NULL
) {

461 i‡(
tmp
 !
°¨t
) {

462 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

465 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "cnonce=", 7);

466 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
˙⁄˚
);

469 i‡(
aöfo
->
n⁄˚_cou¡
 !
NULL
) {

470 i‡(
tmp
 !
°¨t
) {

471 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

474 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "nc=", 3);

475 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
n⁄˚_cou¡
);

478 i‡(
aöfo
->
¢um
 !
NULL
) {

479 i‡(
tmp
 !
°¨t
) {

480 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

483 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "snum=", 5);

484 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
¢um
);

487 i‡(
aöfo
->
§™d
 !
NULL
) {

488 i‡(
tmp
 !
°¨t
) {

489 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

492 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "srand=", 6);

493 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
§™d
);

496 i‡(
aöfo
->
èrgë«me
 !
NULL
) {

497 i‡(
tmp
 !
°¨t
) {

498 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

501 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "targetname=", 11);

502 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
èrgë«me
);

505 i‡(
aöfo
->
ªÆm
 !
NULL
) {

506 i‡(
tmp
 !
°¨t
) {

507 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

510 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "realm=", 6);

511 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
ªÆm
);

514 i‡(
aöfo
->
›aque
 !
NULL
) {

515 i‡(
tmp
 !
°¨t
) {

516 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", ", 2);

519 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "opaque=", 7);

520 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
aöfo
->
›aque
);

523  
OSIP_SUCCESS
;

524 
	}
}

528 
	$osù_authítiˇti⁄_öfo_‰ì
(
osù_authítiˇti⁄_öfo_t
 *
authítiˇti⁄_öfo
) {

529 i‡(
authítiˇti⁄_öfo
 =
NULL
)

532 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
auth_ty≥
);

533 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
√xä⁄˚
);

534 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
r•auth
);

535 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
˙⁄˚
);

536 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
n⁄˚_cou¡
);

537 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
q›_›ti⁄s
);

538 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
¢um
);

539 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
§™d
);

540 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
èrgë«me
);

541 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
ªÆm
);

542 
	`osù_‰ì
(
authítiˇti⁄_öfo
->
›aque
);

543 
	`osù_‰ì
(
authítiˇti⁄_öfo
);

544 
	}
}

546 
	$osù_authítiˇti⁄_öfo_˛⁄e
(c⁄° 
osù_authítiˇti⁄_öfo_t
 *
aöfo
, osù_authítiˇti⁄_öfo_à**
de°
) {

547 
i
;

548 
osù_authítiˇti⁄_öfo_t
 *
wa
;

550 *
de°
 = 
NULL
;

552 i‡(
aöfo
 =
NULL
)

553  
OSIP_BADPARAMETER
;

555 
i
 = 
	`osù_authítiˇti⁄_öfo_öô
(&
wa
);

557 i‡(
i
 != 0)

558  
i
;

560 i‡(
aöfo
->
auth_ty≥
 !
NULL
)

561 
wa
->
auth_ty≥
 = 
	`osù_°rdup
(
aöfo
->auth_type);

563 i‡(
aöfo
->
√xä⁄˚
 !
NULL
)

564 
wa
->
√xä⁄˚
 = 
	`osù_°rdup
(
aöfo
->nextnonce);

566 i‡(
aöfo
->
˙⁄˚
 !
NULL
)

567 
wa
->
˙⁄˚
 = 
	`osù_°rdup
(
aöfo
->cnonce);

569 i‡(
aöfo
->
r•auth
 !
NULL
)

570 
wa
->
r•auth
 = 
	`osù_°rdup
(
aöfo
->rspauth);

572 i‡(
aöfo
->
n⁄˚_cou¡
 !
NULL
)

573 
wa
->
n⁄˚_cou¡
 = 
	`osù_°rdup
(
aöfo
->nonce_count);

575 i‡(
aöfo
->
q›_›ti⁄s
 !
NULL
)

576 
wa
->
q›_›ti⁄s
 = 
	`osù_°rdup
(
aöfo
->qop_options);

578 i‡(
aöfo
->
¢um
 !
NULL
)

579 
wa
->
¢um
 = 
	`osù_°rdup
(
aöfo
->snum);

581 i‡(
aöfo
->
§™d
 !
NULL
)

582 
wa
->
§™d
 = 
	`osù_°rdup
(
aöfo
->srand);

584 i‡(
aöfo
->
èrgë«me
 !
NULL
)

585 
wa
->
èrgë«me
 = 
	`osù_°rdup
(
aöfo
->targetname);

587 i‡(
aöfo
->
ªÆm
 !
NULL
)

588 
wa
->
ªÆm
 = 
	`osù_°rdup
(
aöfo
->realm);

590 i‡(
aöfo
->
›aque
 !
NULL
)

591 
wa
->
›aque
 = 
	`osù_°rdup
(
aöfo
->opaque);

593 *
de°
 = 
wa
;

594  
OSIP_SUCCESS
;

595 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authorization.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 
	$osù_auth‹iz©i⁄_öô
(
osù_auth‹iz©i⁄_t
 **
de°
) {

28 *
de°
 = (
osù_auth‹iz©i⁄_t
 *Ë
	`osù_mÆloc
((osip_authorization_t));

30 i‡(*
de°
 =
NULL
)

31  
OSIP_NOMEM
;

33 
	`mem£t
(*
de°
, 0, (
osù_auth‹iz©i⁄_t
));

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$osù_mesßge_£t_auth‹iz©i⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

42 
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
;

43 
i
;

45 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

46  
OSIP_SUCCESS
;

48 i‡(
sù
 =
NULL
)

49  
OSIP_BADPARAMETER
;

51 
i
 = 
	`osù_auth‹iz©i⁄_öô
(&
auth‹iz©i⁄
);

53 i‡(
i
 != 0)

54  
i
;

56 
i
 = 
	`osù_auth‹iz©i⁄_∑r£
(
auth‹iz©i⁄
, 
hvÆue
);

58 i‡(
i
 != 0) {

59 
	`osù_auth‹iz©i⁄_‰ì
(
auth‹iz©i⁄
);

60  
i
;

63 
sù
->
mesßge_¥›îty
 = 2;

64 
	`osù_li°_add
(&
sù
->
auth‹iz©i⁄s
, 
auth‹iz©i⁄
, -1);

65  
OSIP_SUCCESS
;

66 
	}
}

76 
	$osù_auth‹iz©i⁄_∑r£
(
osù_auth‹iz©i⁄_t
 *
auth
, c⁄° *
hvÆue
) {

77 c⁄° *
•a˚
;

78 c⁄° *
√xt
 = 
NULL
;

79 
i
;

81 
•a˚
 = 
	`°rchr
(
hvÆue
, ' ');

83 i‡(
•a˚
 =
NULL
)

84  
OSIP_SYNTAXERROR
;

86 i‡(
•a˚
 - 
hvÆue
 < 1)

87  
OSIP_SYNTAXERROR
;

89 
auth
->
auth_ty≥
 = (*Ë
	`osù_mÆloc
(
•a˚
 - 
hvÆue
 + 1);

91 i‡(
auth
->
auth_ty≥
 =
NULL
)

92  
OSIP_NOMEM
;

94 
	`osù_°∫˝y
(
auth
->
auth_ty≥
, 
hvÆue
, 
•a˚
 - hvalue);

97 
∑r£_ok
 = 0;

99 
i
 = 
	`__osù_quŸed_°rög_£t
("u£∫ame", 
•a˚
, &(
auth
->
u£∫ame
), &
√xt
);

101 i‡(
i
 != 0)

102  
i
;

104 i‡(
√xt
 =
NULL
)

105  
OSIP_SUCCESS
;

106 i‡(
√xt
 !
•a˚
) {

107 
•a˚
 = 
√xt
;

108 
∑r£_ok
++;

111 
i
 = 
	`__osù_quŸed_°rög_£t
("ªÆm", 
•a˚
, &(
auth
->
ªÆm
), &
√xt
);

113 i‡(
i
 != 0)

114  
i
;

116 i‡(
√xt
 =
NULL
)

117  
OSIP_SUCCESS
;

119 i‡(
√xt
 !
•a˚
) {

120 
•a˚
 = 
√xt
;

121 
∑r£_ok
++;

124 
i
 = 
	`__osù_quŸed_°rög_£t
("n⁄˚", 
•a˚
, &(
auth
->
n⁄˚
), &
√xt
);

126 i‡(
i
 != 0)

127  
i
;

129 i‡(
√xt
 =
NULL
)

130  
OSIP_SUCCESS
;

131 i‡(
√xt
 !
•a˚
) {

132 
•a˚
 = 
√xt
;

133 
∑r£_ok
++;

136 
i
 = 
	`__osù_quŸed_°rög_£t
("uri", 
•a˚
, &(
auth
->
uri
), &
√xt
);

138 i‡(
i
 != 0)

139  
i
;

141 i‡(
√xt
 =
NULL
)

142  
OSIP_SUCCESS
;

143 i‡(
√xt
 !
•a˚
) {

144 
•a˚
 = 
√xt
;

145 
∑r£_ok
++;

148 
i
 = 
	`__osù_quŸed_°rög_£t
("ª•⁄£", 
•a˚
, &(
auth
->
ª•⁄£
), &
√xt
);

150 i‡(
i
 != 0)

151  
i
;

153 i‡(
√xt
 =
NULL
)

154  
OSIP_SUCCESS
;

155 i‡(
√xt
 !
•a˚
) {

156 
•a˚
 = 
√xt
;

157 
∑r£_ok
++;

160 
i
 = 
	`__osù_quŸed_°rög_£t
("dige°", 
•a˚
, &(
auth
->
dige°
), &
√xt
);

162 i‡(
i
 != 0)

163  
i
;

165 i‡(
√xt
 =
NULL
)

166  
OSIP_SUCCESS
;

167 i‡(
√xt
 !
•a˚
) {

168 
•a˚
 = 
√xt
;

169 
∑r£_ok
++;

172 
i
 = 
	`__osù_tokí_£t
("Æg‹ôhm", 
•a˚
, &(
auth
->
Æg‹ôhm
), &
√xt
);

174 i‡(
i
 != 0)

175  
i
;

177 i‡(
√xt
 =
NULL
)

178  
OSIP_SUCCESS
;

179 i‡(
√xt
 !
•a˚
) {

180 
•a˚
 = 
√xt
;

181 
∑r£_ok
++;

184 
i
 = 
	`__osù_quŸed_°rög_£t
("˙⁄˚", 
•a˚
, &(
auth
->
˙⁄˚
), &
√xt
);

186 i‡(
i
 != 0)

187  
i
;

189 i‡(
√xt
 =
NULL
)

190  
OSIP_SUCCESS
;

191 i‡(
√xt
 !
•a˚
) {

192 
•a˚
 = 
√xt
;

193 
∑r£_ok
++;

196 
i
 = 
	`__osù_quŸed_°rög_£t
("›aque", 
•a˚
, &(
auth
->
›aque
), &
√xt
);

198 i‡(
i
 != 0)

199  
i
;

201 i‡(
√xt
 =
NULL
)

202  
OSIP_SUCCESS
;

203 i‡(
√xt
 !
•a˚
) {

204 
•a˚
 = 
√xt
;

205 
∑r£_ok
++;

208 
i
 = 
	`__osù_tokí_£t
("q›", 
•a˚
, &(
auth
->
mesßge_q›
), &
√xt
);

210 i‡(
i
 != 0)

211  
i
;

213 i‡(
√xt
 =
NULL
)

214  
OSIP_SUCCESS
;

215 i‡(
√xt
 !
•a˚
) {

216 
•a˚
 = 
√xt
;

217 
∑r£_ok
++;

220 
i
 = 
	`__osù_tokí_£t
("nc", 
•a˚
, &(
auth
->
n⁄˚_cou¡
), &
√xt
);

222 i‡(
i
 != 0)

223  
i
;

225 i‡(
√xt
 =
NULL
)

226  
OSIP_SUCCESS
;

227 i‡(
√xt
 !
•a˚
) {

228 
•a˚
 = 
√xt
;

229 
∑r£_ok
++;

232 
i
 = 
	`__osù_tokí_£t
("vîsi⁄", 
•a˚
, &(
auth
->
vîsi⁄
), &
√xt
);

234 i‡(
i
 != 0)

235  
i
;

237 i‡(
√xt
 =
NULL
)

238  
OSIP_SUCCESS
;

239 i‡(
√xt
 !
•a˚
) {

240 
•a˚
 = 
√xt
;

241 
∑r£_ok
++;

244 
i
 = 
	`__osù_quŸed_°rög_£t
("èrgë«me", 
•a˚
, &(
auth
->
èrgë«me
), &
√xt
);

246 i‡(
i
 != 0)

247  
i
;

249 i‡(
√xt
 =
NULL
)

250  
OSIP_SUCCESS
;

251 i‡(
√xt
 !
•a˚
) {

252 
•a˚
 = 
√xt
;

253 
∑r£_ok
++;

256 
i
 = 
	`__osù_quŸed_°rög_£t
("gsßpi-d©a", 
•a˚
, &(
auth
->
gsßpi_d©a
), &
√xt
);

258 i‡(
i
 != 0)

259  
i
;

261 i‡(
√xt
 =
NULL
)

262  
OSIP_SUCCESS
;

263 i‡(
√xt
 !
•a˚
) {

264 
•a˚
 = 
√xt
;

265 
∑r£_ok
++;

268 
i
 = 
	`__osù_quŸed_°rög_£t
("¸™d", 
•a˚
, &(
auth
->
¸™d
), &
√xt
);

270 i‡(
i
 != 0)

271  
i
;

273 i‡(
√xt
 =
NULL
)

274  
OSIP_SUCCESS
;

275 i‡(
√xt
 !
•a˚
) {

276 
•a˚
 = 
√xt
;

277 
∑r£_ok
++;

280 
i
 = 
	`__osù_quŸed_°rög_£t
("˙um", 
•a˚
, &(
auth
->
˙um
), &
√xt
);

282 i‡(
i
 != 0)

283  
i
;

285 i‡(
√xt
 =
NULL
)

286  
OSIP_SUCCESS
;

287 i‡(
√xt
 !
•a˚
) {

288 
•a˚
 = 
√xt
;

289 
∑r£_ok
++;

297 i‡(0 =
∑r£_ok
) {

298 c⁄° *
quŸe1
, *
quŸe2
, *
tmp
;

303 i‡(
	`°æí
(
•a˚
) < 1)

304  
OSIP_SUCCESS
;

306 
tmp
 = 
	`°rchr
(
•a˚
 + 1, ',');

308 i‡(
tmp
 =
NULL
)

309  
OSIP_SUCCESS
;

311 
quŸe1
 = 
	`__osù_quŸe_föd
(
•a˚
);

313 i‡((
quŸe1
 !
NULL
Ë&& (quŸe1 < 
tmp
)) {

314 
quŸe2
 = 
	`__osù_quŸe_föd
(
quŸe1
 + 1);

316 i‡(
quŸe2
 =
NULL
)

317  
OSIP_SYNTAXERROR
;

319 i‡(
tmp
 < 
quŸe2
)

320 
•a˚
 = 
	`°rchr
(
quŸe2
, ',');

323 
•a˚
 = 
tmp
;

325 i‡(
•a˚
 =
NULL
)

326  
OSIP_SUCCESS
;

329 
•a˚
 = 
tmp
;

335  
OSIP_SUCCESS
;

336 
	}
}

338 #i‚de‡
MINISIZE


342 
	$osù_mesßge_gë_auth‹iz©i⁄
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_auth‹iz©i⁄_t
 **
de°
) {

343 
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
;

345 *
de°
 = 
NULL
;

347 i‡(
	`osù_li°_size
(&
sù
->
auth‹iz©i⁄s
Ë<
pos
)

348  
OSIP_UNDEFINED_ERROR
;

350 
auth‹iz©i⁄
 = (
osù_auth‹iz©i⁄_t
 *Ë
	`osù_li°_gë
(&
sù
->
auth‹iz©i⁄s
, 
pos
);

351 *
de°
 = 
auth‹iz©i⁄
;

352  
pos
;

353 
	}
}

356 *
	$osù_auth‹iz©i⁄_gë_auth_ty≥
(c⁄° 
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

357  
auth‹iz©i⁄
->
auth_ty≥
;

358 
	}
}

360 
	$osù_auth‹iz©i⁄_£t_auth_ty≥
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
auth_ty≥
) {

361 
auth‹iz©i⁄
->
auth_ty≥
 = (*)áuth_type;

362 
	}
}

364 *
	$osù_auth‹iz©i⁄_gë_u£∫ame
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

365  
auth‹iz©i⁄
->
u£∫ame
;

366 
	}
}

368 
	$osù_auth‹iz©i⁄_£t_u£∫ame
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
u£∫ame
) {

369 
auth‹iz©i⁄
->
u£∫ame
 = (*) username;

370 
	}
}

372 *
	$osù_auth‹iz©i⁄_gë_ªÆm
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

373  
auth‹iz©i⁄
->
ªÆm
;

374 
	}
}

376 
	$osù_auth‹iz©i⁄_£t_ªÆm
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
ªÆm
) {

377 
auth‹iz©i⁄
->
ªÆm
 = (*)Ñealm;

378 
	}
}

380 *
	$osù_auth‹iz©i⁄_gë_n⁄˚
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

381  
auth‹iz©i⁄
->
n⁄˚
;

382 
	}
}

384 
	$osù_auth‹iz©i⁄_£t_n⁄˚
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
n⁄˚
) {

385 
auth‹iz©i⁄
->
n⁄˚
 = (*)Çonce;

386 
	}
}

388 *
	$osù_auth‹iz©i⁄_gë_uri
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

389  
auth‹iz©i⁄
->
uri
;

390 
	}
}

392 
	$osù_auth‹iz©i⁄_£t_uri
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
uri
) {

393 
auth‹iz©i⁄
->
uri
 = (*) uri;

394 
	}
}

396 *
	$osù_auth‹iz©i⁄_gë_ª•⁄£
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

397  
auth‹iz©i⁄
->
ª•⁄£
;

398 
	}
}

400 
	$osù_auth‹iz©i⁄_£t_ª•⁄£
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
ª•⁄£
) {

401 
auth‹iz©i⁄
->
ª•⁄£
 = (*)Ñesponse;

402 
	}
}

404 *
	$osù_auth‹iz©i⁄_gë_dige°
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

405  
auth‹iz©i⁄
->
dige°
;

406 
	}
}

408 
	$osù_auth‹iz©i⁄_£t_dige°
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
dige°
) {

409 
auth‹iz©i⁄
->
dige°
 = (*) digest;

410 
	}
}

412 *
	$osù_auth‹iz©i⁄_gë_Æg‹ôhm
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

413  
auth‹iz©i⁄
->
Æg‹ôhm
;

414 
	}
}

416 
	$osù_auth‹iz©i⁄_£t_Æg‹ôhm
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
Æg‹ôhm
) {

417 
auth‹iz©i⁄
->
Æg‹ôhm
 = (*)álgorithm;

418 
	}
}

420 *
	$osù_auth‹iz©i⁄_gë_˙⁄˚
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

421  
auth‹iz©i⁄
->
˙⁄˚
;

422 
	}
}

424 
	$osù_auth‹iz©i⁄_£t_˙⁄˚
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
˙⁄˚
) {

425 
auth‹iz©i⁄
->
˙⁄˚
 = (*) cnonce;

426 
	}
}

428 *
	$osù_auth‹iz©i⁄_gë_›aque
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

429  
auth‹iz©i⁄
->
›aque
;

430 
	}
}

432 
	$osù_auth‹iz©i⁄_£t_›aque
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
›aque
) {

433 
auth‹iz©i⁄
->
›aque
 = (*) opaque;

434 
	}
}

436 *
	$osù_auth‹iz©i⁄_gë_mesßge_q›
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

437  
auth‹iz©i⁄
->
mesßge_q›
;

438 
	}
}

440 
	$osù_auth‹iz©i⁄_£t_mesßge_q›
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
mesßge_q›
) {

441 
auth‹iz©i⁄
->
mesßge_q›
 = (*) message_qop;

442 
	}
}

444 *
	$osù_auth‹iz©i⁄_gë_n⁄˚_cou¡
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

445  
auth‹iz©i⁄
->
n⁄˚_cou¡
;

446 
	}
}

448 
	$osù_auth‹iz©i⁄_£t_n⁄˚_cou¡
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
n⁄˚_cou¡
) {

449 
auth‹iz©i⁄
->
n⁄˚_cou¡
 = (*)Çonce_count;

450 
	}
}

452 *
	$osù_auth‹iz©i⁄_gë_vîsi⁄
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

453  
auth‹iz©i⁄
->
vîsi⁄
;

454 
	}
}

456 
	$osù_auth‹iz©i⁄_£t_vîsi⁄
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
vîsi⁄
) {

457 
auth‹iz©i⁄
->
vîsi⁄
 = (*) version;

458 
	}
}

460 *
	$osù_auth‹iz©i⁄_gë_èrgë«me
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

461  
auth‹iz©i⁄
->
èrgë«me
;

462 
	}
}

464 
	$osù_auth‹iz©i⁄_£t_èrgë«me
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
èrgë«me
) {

465 
auth‹iz©i⁄
->
èrgë«me
 = (*)Åargetname;

466 
	}
}

468 *
	$osù_auth‹iz©i⁄_gë_gsßpi_d©a
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

469  
auth‹iz©i⁄
->
gsßpi_d©a
;

470 
	}
}

472 
	$osù_auth‹iz©i⁄_£t_gsßpi_d©a
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
gsßpi_d©a
) {

473 
auth‹iz©i⁄
->
gsßpi_d©a
 = (*) gssapi_data;

474 
	}
}

476 *
	$osù_auth‹iz©i⁄_gë_¸™d
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

477  
auth‹iz©i⁄
->
¸™d
;

478 
	}
}

480 
	$osù_auth‹iz©i⁄_£t_¸™d
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
¸™d
) {

481 
auth‹iz©i⁄
->
¸™d
 = (*) crand;

482 
	}
}

484 *
	$osù_auth‹iz©i⁄_gë_˙um
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

485  
auth‹iz©i⁄
->
˙um
;

486 
	}
}

488 
	$osù_auth‹iz©i⁄_£t_˙um
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
, *
˙um
) {

489 
auth‹iz©i⁄
->
˙um
 = (*) cnum;

490 
	}
}

495 
	$osù_auth‹iz©i⁄_to_°r
(c⁄° 
osù_auth‹iz©i⁄_t
 *
auth
, **
de°
) {

496 
size_t
 
Àn
;

497 *
tmp
;

498 
fú°
 = 1;

500 *
de°
 = 
NULL
;

504 i‡((
auth
 =
NULL
Ë|| (auth->
auth_ty≥
 =NULLË|| (auth->
ªÆm
 == NULL)

505 || (
auth
->
n⁄˚
 =
NULL
))

506  
OSIP_BADPARAMETER
;

513 i‡((
auth
 =
NULL
Ë|| (auth->
auth_ty≥
 == NULL))

514  
OSIP_BADPARAMETER
;

518 
Àn
 = 
	`°æí
(
auth
->
auth_ty≥
) + 1;

520 i‡(
auth
->
u£∫ame
 !
NULL
)

521 
Àn
 =Üí + 10 + 
	`°æí
(
auth
->
u£∫ame
);

523 i‡(
auth
->
ªÆm
 !
NULL
)

524 
Àn
 =Üí + 8 + 
	`°æí
(
auth
->
ªÆm
);

526 i‡(
auth
->
n⁄˚
 !
NULL
)

527 
Àn
 =Üí + 8 + 
	`°æí
(
auth
->
n⁄˚
);

529 i‡(
auth
->
uri
 !
NULL
)

530 
Àn
 =Üí + 6 + 
	`°æí
(
auth
->
uri
);

532 i‡(
auth
->
ª•⁄£
 !
NULL
)

533 
Àn
 =Üí + 11 + 
	`°æí
(
auth
->
ª•⁄£
);

535 
Àn
 =Üen + 2;

537 i‡(
auth
->
dige°
 !
NULL
)

538 
Àn
 =Üí + 
	`°æí
(
auth
->
dige°
) + 9;

540 i‡(
auth
->
Æg‹ôhm
 !
NULL
)

541 
Àn
 =Üí + 
	`°æí
(
auth
->
Æg‹ôhm
) + 12;

543 i‡(
auth
->
˙⁄˚
 !
NULL
)

544 
Àn
 =Üí + 
	`°æí
(
auth
->
˙⁄˚
) + 9;

546 i‡(
auth
->
›aque
 !
NULL
)

547 
Àn
 =Üí + 9 + 
	`°æí
(
auth
->
›aque
);

549 i‡(
auth
->
n⁄˚_cou¡
 !
NULL
)

550 
Àn
 =Üí + 
	`°æí
(
auth
->
n⁄˚_cou¡
) + 5;

552 i‡(
auth
->
mesßge_q›
 !
NULL
)

553 
Àn
 =Üí + 
	`°æí
(
auth
->
mesßge_q›
) + 6;

555 i‡(
auth
->
vîsi⁄
 !
NULL
)

556 
Àn
 =Üí + 
	`°æí
(
auth
->
vîsi⁄
) + 10;

558 i‡(
auth
->
èrgë«me
 !
NULL
)

559 
Àn
 =Üí + 
	`°æí
(
auth
->
èrgë«me
) + 13;

561 i‡(
auth
->
gsßpi_d©a
 !
NULL
)

562 
Àn
 =Üí + 
	`°æí
(
auth
->
gsßpi_d©a
) + 14;

564 i‡(
auth
->
¸™d
 !
NULL
)

565 
Àn
 =Üí + 
	`°æí
(
auth
->
¸™d
) + 8;

567 i‡(
auth
->
˙um
 !
NULL
)

568 
Àn
 =Üí + 
	`°æí
(
auth
->
˙um
) + 7;

570 
tmp
 = (*Ë
	`osù_mÆloc
(
Àn
);

572 i‡(
tmp
 =
NULL
)

573  
OSIP_NOMEM
;

575 *
de°
 = 
tmp
;

577 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
auth_ty≥
);

579 i‡(
auth
->
u£∫ame
 !
NULL
) {

580 i‡(!
fú°
)

581 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

583 
fú°
 = 0;

584 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " username=", 10);

586 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
u£∫ame
);

589 i‡(
auth
->
ªÆm
 !
NULL
) {

590 i‡(!
fú°
)

591 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

593 
fú°
 = 0;

594 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Ñealm=", 7);

596 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
ªÆm
);

599 i‡(
auth
->
n⁄˚
 !
NULL
) {

600 i‡(!
fú°
)

601 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

603 
fú°
 = 0;

604 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Çonce=", 7);

606 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
n⁄˚
);

609 i‡(
auth
->
uri
 !
NULL
) {

610 i‡(!
fú°
)

611 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

613 
fú°
 = 0;

614 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " uri=", 5);

616 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
uri
);

619 i‡(
auth
->
ª•⁄£
 !
NULL
) {

620 i‡(!
fú°
)

621 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

623 
fú°
 = 0;

624 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Ñesponse=", 10);

626 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
ª•⁄£
);

629 i‡(
auth
->
dige°
 !
NULL
) {

630 i‡(!
fú°
)

631 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

633 
fú°
 = 0;

634 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " digest=", 8);

636 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
dige°
);

639 i‡(
auth
->
Æg‹ôhm
 !
NULL
) {

640 i‡(!
fú°
)

641 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

643 
fú°
 = 0;

644 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "álgorithm=", 11);

645 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
Æg‹ôhm
);

648 i‡(
auth
->
˙⁄˚
 !
NULL
) {

649 i‡(!
fú°
)

650 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

652 
fú°
 = 0;

653 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " cnonce=", 8);

654 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
˙⁄˚
);

657 i‡(
auth
->
›aque
 !
NULL
) {

658 i‡(!
fú°
)

659 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

661 
fú°
 = 0;

662 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " opaque=", 8);

663 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
›aque
);

666 i‡(
auth
->
mesßge_q›
 !
NULL
) {

667 i‡(!
fú°
)

668 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

670 
fú°
 = 0;

671 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " qop=", 5);

672 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
mesßge_q›
);

675 i‡(
auth
->
n⁄˚_cou¡
 !
NULL
) {

676 i‡(!
fú°
)

677 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

679 
fú°
 = 0;

680 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Çc=", 4);

681 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
n⁄˚_cou¡
);

684 i‡(
auth
->
vîsi⁄
 !
NULL
) {

685 i‡(!
fú°
)

686 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

688 
fú°
 = 0;

689 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " version=", 9);

690 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
vîsi⁄
);

693 i‡(
auth
->
èrgë«me
 !
NULL
) {

694 i‡(!
fú°
)

695 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

697 
fú°
 = 0;

698 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Åargetname=", 12);

699 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
èrgë«me
);

702 i‡(
auth
->
gsßpi_d©a
 !
NULL
) {

703 i‡(!
fú°
)

704 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

706 
fú°
 = 0;

707 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " gssapi-data=", 13);

708 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
gsßpi_d©a
);

711 i‡(
auth
->
¸™d
 !
NULL
) {

712 i‡(!
fú°
)

713 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

715 
fú°
 = 0;

716 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " crand=", 7);

717 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
¸™d
);

720 i‡(
auth
->
˙um
 !
NULL
) {

721 i‡(!
fú°
)

722 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",", 1);

724 
fú°
 = 0;

725 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, " cnum=", 6);

726 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
auth
->
˙um
);

729  
OSIP_SUCCESS
;

730 
	}
}

734 
	$osù_auth‹iz©i⁄_‰ì
(
osù_auth‹iz©i⁄_t
 *
auth‹iz©i⁄
) {

735 i‡(
auth‹iz©i⁄
 =
NULL
)

738 
	`osù_‰ì
(
auth‹iz©i⁄
->
auth_ty≥
);

739 
	`osù_‰ì
(
auth‹iz©i⁄
->
u£∫ame
);

740 
	`osù_‰ì
(
auth‹iz©i⁄
->
ªÆm
);

741 
	`osù_‰ì
(
auth‹iz©i⁄
->
n⁄˚
);

742 
	`osù_‰ì
(
auth‹iz©i⁄
->
uri
);

743 
	`osù_‰ì
(
auth‹iz©i⁄
->
ª•⁄£
);

744 
	`osù_‰ì
(
auth‹iz©i⁄
->
dige°
);

745 
	`osù_‰ì
(
auth‹iz©i⁄
->
Æg‹ôhm
);

746 
	`osù_‰ì
(
auth‹iz©i⁄
->
˙⁄˚
);

747 
	`osù_‰ì
(
auth‹iz©i⁄
->
›aque
);

748 
	`osù_‰ì
(
auth‹iz©i⁄
->
mesßge_q›
);

749 
	`osù_‰ì
(
auth‹iz©i⁄
->
n⁄˚_cou¡
);

750 
	`osù_‰ì
(
auth‹iz©i⁄
->
vîsi⁄
);

751 
	`osù_‰ì
(
auth‹iz©i⁄
->
èrgë«me
);

752 
	`osù_‰ì
(
auth‹iz©i⁄
->
gsßpi_d©a
);

753 
	`osù_‰ì
(
auth‹iz©i⁄
->
¸™d
);

754 
	`osù_‰ì
(
auth‹iz©i⁄
->
˙um
);

755 
	`osù_‰ì
(
auth‹iz©i⁄
);

756 
	}
}

758 
	$osù_auth‹iz©i⁄_˛⁄e
(c⁄° 
osù_auth‹iz©i⁄_t
 *
auth
, osù_auth‹iz©i⁄_à**
de°
) {

759 
i
;

760 
osù_auth‹iz©i⁄_t
 *
au
;

762 *
de°
 = 
NULL
;

764 i‡(
auth
 =
NULL
)

765  
OSIP_BADPARAMETER
;

777 
i
 = 
	`osù_auth‹iz©i⁄_öô
(&
au
);

779 i‡(
i
 != 0)

780  
i
;

782 i‡(
auth
->
auth_ty≥
 !
NULL
) {

783 
au
->
auth_ty≥
 = 
	`osù_°rdup
(
auth
->auth_type);

785 i‡(
au
->
auth_ty≥
 =
NULL
) {

786 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

787  
OSIP_NOMEM
;

791 i‡(
auth
->
u£∫ame
 !
NULL
) {

792 
au
->
u£∫ame
 = 
	`osù_°rdup
(
auth
->username);

794 i‡(
au
->
u£∫ame
 =
NULL
) {

795 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

796  
OSIP_NOMEM
;

800 i‡(
auth
->
ªÆm
 !
NULL
) {

801 
au
->
ªÆm
 = 
	`osù_°rdup
(
auth
->realm);

803 i‡(
auth
->
ªÆm
 =
NULL
) {

804 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

805  
OSIP_NOMEM
;

809 i‡(
auth
->
n⁄˚
 !
NULL
) {

810 
au
->
n⁄˚
 = 
	`osù_°rdup
(
auth
->nonce);

812 i‡(
auth
->
n⁄˚
 =
NULL
) {

813 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

814  
OSIP_NOMEM
;

818 i‡(
auth
->
uri
 !
NULL
) {

819 
au
->
uri
 = 
	`osù_°rdup
(
auth
->uri);

821 i‡(
au
->
uri
 =
NULL
) {

822 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

823  
OSIP_NOMEM
;

827 i‡(
auth
->
ª•⁄£
 !
NULL
) {

828 
au
->
ª•⁄£
 = 
	`osù_°rdup
(
auth
->response);

830 i‡(
auth
->
ª•⁄£
 =
NULL
) {

831 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

832  
OSIP_NOMEM
;

836 i‡(
auth
->
dige°
 !
NULL
) {

837 
au
->
dige°
 = 
	`osù_°rdup
(
auth
->digest);

839 i‡(
au
->
dige°
 =
NULL
) {

840 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

841  
OSIP_NOMEM
;

845 i‡(
auth
->
Æg‹ôhm
 !
NULL
) {

846 
au
->
Æg‹ôhm
 = 
	`osù_°rdup
(
auth
->algorithm);

848 i‡(
auth
->
Æg‹ôhm
 =
NULL
) {

849 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

850  
OSIP_NOMEM
;

854 i‡(
auth
->
˙⁄˚
 !
NULL
) {

855 
au
->
˙⁄˚
 = 
	`osù_°rdup
(
auth
->cnonce);

857 i‡(
au
->
˙⁄˚
 =
NULL
) {

858 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

859  
OSIP_NOMEM
;

863 i‡(
auth
->
›aque
 !
NULL
) {

864 
au
->
›aque
 = 
	`osù_°rdup
(
auth
->opaque);

866 i‡(
auth
->
›aque
 =
NULL
) {

867 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

868  
OSIP_NOMEM
;

872 i‡(
auth
->
mesßge_q›
 !
NULL
) {

873 
au
->
mesßge_q›
 = 
	`osù_°rdup
(
auth
->message_qop);

875 i‡(
auth
->
mesßge_q›
 =
NULL
) {

876 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

877  
OSIP_NOMEM
;

881 i‡(
auth
->
n⁄˚_cou¡
 !
NULL
) {

882 
au
->
n⁄˚_cou¡
 = 
	`osù_°rdup
(
auth
->nonce_count);

884 i‡(
auth
->
n⁄˚_cou¡
 =
NULL
) {

885 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

886  
OSIP_NOMEM
;

890 i‡(
auth
->
vîsi⁄
 !
NULL
) {

891 
au
->
vîsi⁄
 = 
	`osù_°rdup
(
auth
->version);

893 i‡(
auth
->
vîsi⁄
 =
NULL
) {

894 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

895  
OSIP_NOMEM
;

899 i‡(
auth
->
èrgë«me
 !
NULL
) {

900 
au
->
èrgë«me
 = 
	`osù_°rdup
(
auth
->targetname);

902 i‡(
auth
->
èrgë«me
 =
NULL
) {

903 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

904  
OSIP_NOMEM
;

908 i‡(
auth
->
gsßpi_d©a
 !
NULL
) {

909 
au
->
gsßpi_d©a
 = 
	`osù_°rdup
(
auth
->gssapi_data);

911 i‡(
auth
->
gsßpi_d©a
 =
NULL
) {

912 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

913  
OSIP_NOMEM
;

917 i‡(
auth
->
¸™d
 !
NULL
) {

918 
au
->
¸™d
 = 
	`osù_°rdup
(
auth
->crand);

920 i‡(
auth
->
¸™d
 =
NULL
) {

921 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

922  
OSIP_NOMEM
;

926 i‡(
auth
->
˙um
 !
NULL
) {

927 
au
->
˙um
 = 
	`osù_°rdup
(
auth
->cnum);

929 i‡(
auth
->
˙um
 =
NULL
) {

930 
	`osù_auth‹iz©i⁄_‰ì
(
au
);

931  
OSIP_NOMEM
;

935 *
de°
 = 
au
;

936  
OSIP_SUCCESS
;

937 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_body.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~<osù∑r£r2/osù_body.h
>

26 
	~"∑r£r.h
"

28 
osù_body_∑r£_hódî
(
osù_body_t
 *
body
, c⁄° *
°¨t_of_osù_body_hódî
, c⁄° **
√xt_body
);

30 
	$osù_body_öô
(
osù_body_t
 **
body
) {

31 *
body
 = (
osù_body_t
 *Ë
	`osù_mÆloc
((osip_body_t));

33 i‡(*
body
 =
NULL
)

34  
OSIP_NOMEM
;

36 (*
body
)->body = 
NULL
;

37 (*
body
)->
c⁄ã¡_ty≥
 = 
NULL
;

38 (*
body
)->
Àngth
 = 0;

40 (*
body
)->
hódîs
 = (
osù_li°_t
 *Ë
	`osù_mÆloc
((osip_list_t));

42 i‡((*
body
)->
hódîs
 =
NULL
) {

43 
	`osù_‰ì
(*
body
);

44 *
body
 = 
NULL
;

45  
OSIP_NOMEM
;

48 
	`osù_li°_öô
((*
body
)->
hódîs
);

49  
OSIP_SUCCESS
;

50 
	}
}

52 
	$osù_mesßge_£t_body
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
) {

53 
osù_body_t
 *
body
;

54 
i
;

56 
i
 = 
	`osù_body_öô
(&
body
);

58 i‡(
i
 != 0)

59  
i
;

61 
i
 = 
	`osù_body_∑r£
(
body
, 
buf
, 
Àngth
);

63 i‡(
i
 != 0) {

64 
	`osù_body_‰ì
(
body
);

65  
i
;

68 
sù
->
mesßge_¥›îty
 = 2;

69 
	`osù_li°_add
(&
sù
->
bodõs
, 
body
, -1);

70  
OSIP_SUCCESS
;

71 
	}
}

73 
	$osù_body_˛⁄e
(c⁄° 
osù_body_t
 *
body
, osù_body_à**
de°
) {

74 
i
;

75 
osù_body_t
 *
c›y
;

77 i‡(
body
 =
NULL
 || body->
Àngth
 <= 0)

78  
OSIP_BADPARAMETER
;

80 
i
 = 
	`osù_body_öô
(&
c›y
);

82 i‡(
i
 != 0)

83  
i
;

85 
c›y
->
body
 = (*Ë
	`osù_mÆloc
(body->
Àngth
 + 2);

87 i‡(
c›y
->
body
 =
NULL
) {

88 
	`osù_body_‰ì
(
c›y
);

89  
OSIP_NOMEM
;

92 
c›y
->
Àngth
 = 
body
->length;

93 
	`mem˝y
(
c›y
->
body
, body->body, body->
Àngth
);

94 
c›y
->
body
[body->
Àngth
] = '\0';

96 i‡(
body
->
c⁄ã¡_ty≥
 !
NULL
) {

97 
i
 = 
	`osù_c⁄ã¡_ty≥_˛⁄e
(
body
->
c⁄ã¡_ty≥
, &(
c›y
->content_type));

99 i‡(
i
 != 0) {

100 
	`osù_body_‰ì
(
c›y
);

101  
i
;

105 
i
 = 
	`osù_li°_˛⁄e
(
body
->
hódîs
, 
c›y
->hódîs, ((*)(*, **)Ë& 
osù_hódî_˛⁄e
);

107 i‡(
i
 != 0) {

108 
	`osù_body_‰ì
(
c›y
);

109  
i
;

112 *
de°
 = 
c›y
;

113  
OSIP_SUCCESS
;

114 
	}
}

116 #i‚de‡
MINISIZE


122 
	$osù_mesßge_gë_body
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_body_t
 **
de°
) {

123 
osù_body_t
 *
body
;

125 *
de°
 = 
NULL
;

127 i‡(
	`osù_li°_size
(&
sù
->
bodõs
Ë<
pos
)

128  
OSIP_UNDEFINED_ERROR
;

130 
body
 = (
osù_body_t
 *Ë
	`osù_li°_gë
(&
sù
->
bodõs
, 
pos
);

131 *
de°
 = 
body
;

132  
pos
;

133 
	}
}

136 
	$osù_body_£t_c⁄ã¡ty≥
(
osù_body_t
 *
body
, c⁄° *
hvÆue
) {

137 
i
;

139 i‡(
body
 =
NULL
)

140  
OSIP_BADPARAMETER
;

142 i‡(
hvÆue
 =
NULL
)

143  
OSIP_BADPARAMETER
;

145 
i
 = 
	`osù_c⁄ã¡_ty≥_öô
(&(
body
->
c⁄ã¡_ty≥
));

147 i‡(
i
 != 0)

148  
i
;

150 
i
 = 
	`osù_c⁄ã¡_ty≥_∑r£
(
body
->
c⁄ã¡_ty≥
, 
hvÆue
);

152 i‡(
i
 != 0) {

153 
	`osù_c⁄ã¡_ty≥_‰ì
(
body
->
c⁄ã¡_ty≥
);

154 
body
->
c⁄ã¡_ty≥
 = 
NULL
;

155  
i
;

158  
OSIP_SUCCESS
;

159 
	}
}

161 
	$osù_body_£t_hódî
(
osù_body_t
 *
body
, c⁄° *
h«me
, c⁄° *
hvÆue
) {

162 
osù_hódî_t
 *
h
;

163 
i
;

165 i‡(
body
 =
NULL
)

166  
OSIP_BADPARAMETER
;

168 i‡(
h«me
 =
NULL
)

169  
OSIP_BADPARAMETER
;

171 i‡(
hvÆue
 =
NULL
)

172  
OSIP_BADPARAMETER
;

174 
i
 = 
	`osù_hódî_öô
(&
h
);

176 i‡(
i
 != 0)

177  
i
;

179 
h
->
h«me
 = 
	`osù_°rdup
(hname);

181 i‡(
h
->
h«me
 =
NULL
) {

182 
	`osù_hódî_‰ì
(
h
);

183  
OSIP_NOMEM
;

186 
h
->
hvÆue
 = 
	`osù_°rdup
(hvalue);

188 i‡(
h
->
hvÆue
 =
NULL
) {

189 
	`osù_hódî_‰ì
(
h
);

190  
OSIP_NOMEM
;

193 
	`osù_li°_add
(
body
->
hódîs
, 
h
, -1);

194  
OSIP_SUCCESS
;

195 
	}
}

201 
	$osù_mesßge_£t_body_mime
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
) {

202 
osù_body_t
 *
body
;

203 
i
;

205 i‡(
sù
 =
NULL
)

206  
OSIP_BADPARAMETER
;

208 
i
 = 
	`osù_body_öô
(&
body
);

210 i‡(
i
 != 0)

211  
i
;

213 
i
 = 
	`osù_body_∑r£_mime
(
body
, 
buf
, 
Àngth
);

215 i‡(
i
 != 0) {

216 
	`osù_body_‰ì
(
body
);

217  
i
;

220 
sù
->
mesßge_¥›îty
 = 2;

221 
	`osù_li°_add
(&
sù
->
bodõs
, 
body
, -1);

222  
OSIP_SUCCESS
;

223 
	}
}

225 
	$osù_body_∑r£_hódî
(
osù_body_t
 *
body
, c⁄° *
°¨t_of_osù_body_hódî
, c⁄° **
√xt_body
) {

226 c⁄° *
°¨t_of_löe
;

227 c⁄° *
íd_of_löe
;

228 c⁄° *
cﬁ⁄_ödex
;

229 *
h«me
;

230 *
hvÆue
;

231 
i
;

233 *
√xt_body
 = 
NULL
;

234 
°¨t_of_löe
 = 
°¨t_of_osù_body_hódî
;

237 
i
 = 
	`__osù_föd_√xt_¸lf
(
°¨t_of_löe
, &
íd_of_löe
);

239 i‡(
i
 == -2) {

240 } i‡(
i
 != 0)

241  
i
;

244 
cﬁ⁄_ödex
 = 
	`°rchr
(
°¨t_of_löe
, ':');

246 i‡(
cﬁ⁄_ödex
 =
NULL
)

247  
OSIP_SYNTAXERROR
;

249 i‡(
cﬁ⁄_ödex
 - 
°¨t_of_löe
 + 1 < 2)

250  
OSIP_SYNTAXERROR
;

252 
h«me
 = (*Ë
	`osù_mÆloc
(
cﬁ⁄_ödex
 - 
°¨t_of_löe
 + 1);

254 i‡(
h«me
 =
NULL
)

255  
OSIP_NOMEM
;

257 
	`osù_˛∫˝y
(
h«me
, 
°¨t_of_löe
, 
cﬁ⁄_ödex
 - start_of_line);

259 i‡((
íd_of_löe
 - 2Ë- 
cﬁ⁄_ödex
 < 2) {

260 
	`osù_‰ì
(
h«me
);

261  
OSIP_SYNTAXERROR
;

264 
hvÆue
 = (*Ë
	`osù_mÆloc
((
íd_of_löe
 - 2Ë- 
cﬁ⁄_ödex
);

266 i‡(
hvÆue
 =
NULL
) {

267 
	`osù_‰ì
(
h«me
);

268  
OSIP_NOMEM
;

271 
	`osù_˛∫˝y
(
hvÆue
, 
cﬁ⁄_ödex
 + 1, (
íd_of_löe
 - 2) - colon_index - 1);

274 i‡(
	`osù_°∫ˇ£cmp
(
h«me
, "content-type", 12) == 0)

275 
i
 = 
	`osù_body_£t_c⁄ã¡ty≥
(
body
, 
hvÆue
);

278 
i
 = 
	`osù_body_£t_hódî
(
body
, 
h«me
, 
hvÆue
);

280 
	`osù_‰ì
(
h«me
);

281 
	`osù_‰ì
(
hvÆue
);

283 i‡(
i
 != 0)

284  
i
;

286 i‡(
	`°∫cmp
(
íd_of_löe
, 
OSIP_CRLF
, 2) == 0 || strncmp(end_of_line, "\n", 1) == 0 || strncmp(end_of_line, "\r", 1) == 0) {

287 *
√xt_body
 = 
íd_of_löe
;

288  
OSIP_SUCCESS
;

291 
°¨t_of_löe
 = 
íd_of_löe
;

293 
	}
}

295 
	$osù_body_∑r£
(
osù_body_t
 *
body
, c⁄° *
°¨t_of_body
, 
size_t
 
Àngth
) {

296 i‡(
body
 =
NULL
)

297  
OSIP_BADPARAMETER
;

299 i‡(
°¨t_of_body
 =
NULL
)

300  
OSIP_BADPARAMETER
;

302 i‡(
body
->
hódîs
 =
NULL
)

303  
OSIP_BADPARAMETER
;

305 
body
->body = (*Ë
	`osù_mÆloc
(
Àngth
 + 1);

307 i‡(
body
->body =
NULL
)

308  
OSIP_NOMEM
;

310 
	`mem˝y
(
body
->body, 
°¨t_of_body
, 
Àngth
);

311 
body
->body[
Àngth
] = '\0';

312 
body
->
Àngth
 =Üength;

313  
OSIP_SUCCESS
;

314 
	}
}

316 
	$osù_body_∑r£_mime
(
osù_body_t
 *
body
, c⁄° *
°¨t_of_body
, 
size_t
 
Àngth
) {

317 c⁄° *
íd_of_osù_body_hódî
;

318 c⁄° *
°¨t_of_osù_body_hódî
;

319 
i
;

321 i‡(
body
 =
NULL
)

322  
OSIP_BADPARAMETER
;

324 i‡(
°¨t_of_body
 =
NULL
)

325  
OSIP_BADPARAMETER
;

327 i‡(
body
->
hódîs
 =
NULL
)

328  
OSIP_BADPARAMETER
;

330 
°¨t_of_osù_body_hódî
 = 
°¨t_of_body
;

332 
i
 = 
	`osù_body_∑r£_hódî
(
body
, 
°¨t_of_osù_body_hódî
, &
íd_of_osù_body_hódî
);

334 i‡(
i
 != 0)

335  
i
;

337 
°¨t_of_osù_body_hódî
 = 
íd_of_osù_body_hódî
;

340 i‡(
	`°∫cmp
(
°¨t_of_osù_body_hódî
, 
OSIP_CRLF
, 2) == 0)

341 
°¨t_of_osù_body_hódî
 = start_of_osip_body_header + 2;

344 i‡((
	`°∫cmp
(
°¨t_of_osù_body_hódî
, "\n", 1) == 0) || (strncmp(start_of_osip_body_header, "\r", 1) == 0))

345 
°¨t_of_osù_body_hódî
 = start_of_osip_body_header + 1;

348  
OSIP_SYNTAXERROR
;

351 
íd_of_osù_body_hódî
 = 
°¨t_of_body
 + 
Àngth
;

353 i‡(
íd_of_osù_body_hódî
 - 
°¨t_of_osù_body_hódî
 <= 0)

354  
OSIP_SYNTAXERROR
;

356 
body
->body = (*Ë
	`osù_mÆloc
(
íd_of_osù_body_hódî
 - 
°¨t_of_osù_body_hódî
 + 1);

358 i‡(
body
->body =
NULL
)

359  
OSIP_NOMEM
;

361 
	`mem˝y
(
body
->body, 
°¨t_of_osù_body_hódî
, 
íd_of_osù_body_hódî
 - start_of_osip_body_header);

362 
body
->
Àngth
 = 
íd_of_osù_body_hódî
 - 
°¨t_of_osù_body_hódî
;

364 
body
->body[body->
Àngth
] = '\0';

366  
OSIP_SUCCESS
;

367 
	}
}

372 
	$osù_body_to_°r
(c⁄° 
osù_body_t
 *
body
, **
de°
, 
size_t
 *
°r_Àngth
) {

373 *
tmp_body
;

374 *
tmp
;

375 *
±r
;

376 
i
;

377 
size_t
 
Àngth
;

379 i‡(
de°
)

380 *
de°
 = 
NULL
;

382 i‡(
°r_Àngth
)

383 *
°r_Àngth
 = 0;

385 i‡(
body
 =
NULL
)

386  
OSIP_BADPARAMETER
;

388 i‡(
body
->body =
NULL
)

389  
OSIP_BADPARAMETER
;

391 i‡(
body
->
hódîs
 =
NULL
)

392  
OSIP_BADPARAMETER
;

394 i‡(
body
->
Àngth
 <= 0)

395  
OSIP_BADPARAMETER
;

397 
Àngth
 = 15 + 
body
->Àngth + (
	`osù_li°_size
(body->
hódîs
) * 40);

398 
tmp_body
 = (*Ë
	`osù_mÆloc
(
Àngth
);

400 i‡(
tmp_body
 =
NULL
)

401  
OSIP_NOMEM
;

403 
±r
 = 
tmp_body
;

405 i‡(
body
->
c⁄ã¡_ty≥
 !
NULL
) {

406 
tmp_body
 = 
	`osù_°∫_≠≥nd
(tmp_body, "content-type: ", 14);

407 
i
 = 
	`osù_c⁄ã¡_ty≥_to_°r
(
body
->
c⁄ã¡_ty≥
, &
tmp
);

409 i‡(
i
 != 0) {

410 
	`osù_‰ì
(
±r
);

411  
i
;

414 i‡(
Àngth
 < 
tmp_body
 - 
±r
 + 
	`°æí
(
tmp
) + 4) {

415 
size_t
 
Àn
;

417 
Àn
 = 
tmp_body
 - 
±r
;

418 
Àngth
 =Üígth + 
	`°æí
(
tmp
) + 4;

419 
±r
 = 
	`osù_ªÆloc
’å, 
Àngth
);

420 
tmp_body
 = 
±r
 + 
Àn
;

423 
tmp_body
 = 
	`osù_°r_≠≥nd
—mp_body, 
tmp
);

424 
	`osù_‰ì
(
tmp
);

425 
tmp_body
 = 
	`osù_°∫_≠≥nd
—mp_body, 
OSIP_CRLF
, 2);

429 
osù_li°_ôî©‹_t
 
ô
;

430 
osù_hódî_t
 *
hódî
 = (osù_hódî_à*Ë
	`osù_li°_gë_fú°
(
body
->
hódîs
, &
ô
);

432 
hódî
 !
OSIP_SUCCESS
) {

433 
i
 = 
	`osù_hódî_to_°r
(
hódî
, &
tmp
);

435 i‡(
i
 != 0) {

436 
	`osù_‰ì
(
±r
);

437  
i
;

440 i‡(
Àngth
 < 
tmp_body
 - 
±r
 + 
	`°æí
(
tmp
) + 4) {

441 
size_t
 
Àn
;

443 
Àn
 = 
tmp_body
 - 
±r
;

444 
Àngth
 =Üígth + 
	`°æí
(
tmp
) + 4;

445 
±r
 = 
	`osù_ªÆloc
’å, 
Àngth
);

446 
tmp_body
 = 
±r
 + 
Àn
;

449 
tmp_body
 = 
	`osù_°r_≠≥nd
—mp_body, 
tmp
);

450 
	`osù_‰ì
(
tmp
);

451 
tmp_body
 = 
	`osù_°∫_≠≥nd
—mp_body, 
OSIP_CRLF
, 2);

452 
hódî
 = (
osù_hódî_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

456 i‡((
	`osù_li°_size
(
body
->
hódîs
Ë> 0Ë|| (body->
c⁄ã¡_ty≥
 !
NULL
)) {

457 i‡(
Àngth
 < (
size_t
)(
tmp_body
 - 
±r
 + 3)) {

458 
size_t
 
Àn
;

460 
Àn
 = 
tmp_body
 - 
±r
;

461 
Àngth
 =Üígth + 3 + 
body
->length;

462 
±r
 = 
	`osù_ªÆloc
’å, 
Àngth
);

463 
tmp_body
 = 
±r
 + 
Àn
;

466 
tmp_body
 = 
	`osù_°∫_≠≥nd
—mp_body, 
OSIP_CRLF
, 2);

469 i‡(
Àngth
 < 
tmp_body
 - 
±r
 + 
body
->length + 4) {

470 
size_t
 
Àn
;

472 
Àn
 = 
tmp_body
 - 
±r
;

473 
Àngth
 =Üígth + 
body
->length + 4;

474 
±r
 = 
	`osù_ªÆloc
’å, 
Àngth
);

475 
tmp_body
 = 
±r
 + 
Àn
;

478 
	`mem˝y
(
tmp_body
, 
body
->body, body->
Àngth
);

479 
tmp_body
 =Åmp_body + 
body
->
Àngth
;

482 i‡(
°r_Àngth
 !
NULL
)

483 *
°r_Àngth
 = 
tmp_body
 - 
±r
;

485 *
de°
 = 
±r
;

486  
OSIP_SUCCESS
;

487 
	}
}

491 
	$osù_body_‰ì
(
osù_body_t
 *
body
) {

492 i‡(
body
 =
NULL
)

495 
	`osù_‰ì
(
body
->body);

497 i‡(
body
->
c⁄ã¡_ty≥
 !
NULL
) {

498 
	`osù_c⁄ã¡_ty≥_‰ì
(
body
->
c⁄ã¡_ty≥
);

501 
	`osù_li°_•ecül_‰ì
(
body
->
hódîs
, ((*)(*)Ë& 
osù_hódî_‰ì
);

502 
	`osù_‰ì
(
body
->
hódîs
);

503 
	`osù_‰ì
(
body
);

504 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_id.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

30 
	$osù_mesßge_£t_ˇŒ_id
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 i‡(
sù
->
ˇŒ_id
 !
NULL
)

37  
OSIP_SYNTAXERROR
;

39 
i
 = 
	`osù_ˇŒ_id_öô
(&(
sù
->
ˇŒ_id
));

41 i‡(
i
 != 0)

42  
i
;

44 
sù
->
mesßge_¥›îty
 = 2;

45 
i
 = 
	`osù_ˇŒ_id_∑r£
(
sù
->
ˇŒ_id
, 
hvÆue
);

47 i‡(
i
 != 0) {

48 
	`osù_ˇŒ_id_‰ì
(
sù
->
ˇŒ_id
);

49 
sù
->
ˇŒ_id
 = 
NULL
;

50  
i
;

53  
OSIP_SUCCESS
;

54 
	}
}

56 #i‚de‡
MINISIZE


59 
osù_ˇŒ_id_t
 *
	$osù_mesßge_gë_ˇŒ_id
(c⁄° 
osù_mesßge_t
 *
sù
) {

60  
sù
->
ˇŒ_id
;

61 
	}
}

64 
	$osù_ˇŒ_id_öô
(
osù_ˇŒ_id_t
 **
ˇŒid
) {

65 *
ˇŒid
 = (
osù_ˇŒ_id_t
 *Ë
	`osù_mÆloc
((osip_call_id_t));

67 i‡(*
ˇŒid
 =
NULL
)

68  
OSIP_NOMEM
;

70 (*
ˇŒid
)->
numbî
 = 
NULL
;

71 (*
ˇŒid
)->
ho°
 = 
NULL
;

72  
OSIP_SUCCESS
;

73 
	}
}

77 
	$osù_ˇŒ_id_‰ì
(
osù_ˇŒ_id_t
 *
ˇŒid
) {

78 i‡(
ˇŒid
 =
NULL
)

81 
	`osù_‰ì
(
ˇŒid
->
numbî
);

82 
	`osù_‰ì
(
ˇŒid
->
ho°
);

84 
ˇŒid
->
numbî
 = 
NULL
;

85 
ˇŒid
->
ho°
 = 
NULL
;

87 
	`osù_‰ì
(
ˇŒid
);

88 
	}
}

94 
	$osù_ˇŒ_id_∑r£
(
osù_ˇŒ_id_t
 *
ˇŒid
, c⁄° *
hvÆue
) {

95 c⁄° *
ho°
;

96 c⁄° *
íd
;

98 
ˇŒid
->
numbî
 = 
NULL
;

99 
ˇŒid
->
ho°
 = 
NULL
;

101 
ho°
 = 
	`°rchr
(
hvÆue
, '@');

102 
íd
 = 
hvÆue
 + 
	`°æí
(hvalue);

104 i‡(
ho°
 =
NULL
)

105 
ho°
 = 
íd
;

108 i‡(
íd
 - 
ho°
 + 1 < 2)

109  
OSIP_SYNTAXERROR
;

111 
ˇŒid
->
ho°
 = (*Ë
	`osù_mÆloc
(
íd
 - host);

113 i‡(
ˇŒid
->
ho°
 =
NULL
)

114  
OSIP_NOMEM
;

116 
	`osù_˛∫˝y
(
ˇŒid
->
ho°
, ho° + 1, 
íd
 - host - 1);

119 i‡(
ho°
 - 
hvÆue
 + 1 < 2)

120  
OSIP_SYNTAXERROR
;

122 
ˇŒid
->
numbî
 = (*Ë
	`osù_mÆloc
(
ho°
 - 
hvÆue
 + 1);

124 i‡(
ˇŒid
->
numbî
 =
NULL
)

125  
OSIP_NOMEM
;

127 
	`osù_˛∫˝y
(
ˇŒid
->
numbî
, 
hvÆue
, 
ho°
 - hvalue);

129  
OSIP_SUCCESS
;

130 
	}
}

135 
	$osù_ˇŒ_id_to_°r
(c⁄° 
osù_ˇŒ_id_t
 *
ˇŒid
, **
de°
) {

136 *
de°
 = 
NULL
;

138 i‡((
ˇŒid
 =
NULL
Ë|| (ˇŒid->
numbî
 == NULL))

139  
OSIP_BADPARAMETER
;

141 i‡(
ˇŒid
->
ho°
 =
NULL
) {

142 *
de°
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
ˇŒid
->
numbî
) + 1);

144 i‡(*
de°
 =
NULL
)

145  
OSIP_NOMEM
;

147 
	`•rötf
(*
de°
, "%s", 
ˇŒid
->
numbî
);

150 *
de°
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
ˇŒid
->
numbî
Ë+ såÀn(ˇŒid->
ho°
) + 2);

152 i‡(*
de°
 =
NULL
)

153  
OSIP_NOMEM
;

155 
	`•rötf
(*
de°
, "%s@%s", 
ˇŒid
->
numbî
, cÆlid->
ho°
);

158  
OSIP_SUCCESS
;

159 
	}
}

161 *
	$osù_ˇŒ_id_gë_numbî
(
osù_ˇŒ_id_t
 *
ˇŒid
) {

162 i‡(
ˇŒid
 =
NULL
)

163  
NULL
;

165  
ˇŒid
->
numbî
;

166 
	}
}

168 *
	$osù_ˇŒ_id_gë_ho°
(
osù_ˇŒ_id_t
 *
ˇŒid
) {

169 i‡(
ˇŒid
 =
NULL
)

170  
NULL
;

172  
ˇŒid
->
ho°
;

173 
	}
}

175 
	$osù_ˇŒ_id_£t_numbî
(
osù_ˇŒ_id_t
 *
ˇŒid
, *
numbî
) {

176 
ˇŒid
->
numbî
 =Çumber;

177 
	}
}

179 
	$osù_ˇŒ_id_£t_ho°
(
osù_ˇŒ_id_t
 *
ˇŒid
, *
ho°
) {

180 
ˇŒid
->
ho°
 = host;

181 
	}
}

183 
	$osù_ˇŒ_id_˛⁄e
(c⁄° 
osù_ˇŒ_id_t
 *
ˇŒid
, osù_ˇŒ_id_à**
de°
) {

184 
i
;

185 
osù_ˇŒ_id_t
 *
ci
;

187 *
de°
 = 
NULL
;

189 i‡(
ˇŒid
 =
NULL
)

190  
OSIP_BADPARAMETER
;

192 i‡(
ˇŒid
->
numbî
 =
NULL
)

193  
OSIP_BADPARAMETER
;

195 
i
 = 
	`osù_ˇŒ_id_öô
(&
ci
);

197 i‡(
i
 != 0)

198  
i
;

200 
ci
->
numbî
 = 
	`osù_°rdup
(
ˇŒid
->number);

202 i‡(
ˇŒid
->
ho°
 !
NULL
)

203 
ci
->
ho°
 = 
	`osù_°rdup
(
ˇŒid
->host);

205 *
de°
 = 
ci
;

206  
OSIP_SUCCESS
;

207 
	}
}

209 
	$osù_ˇŒ_id_m©ch
(
osù_ˇŒ_id_t
 *
ˇŒid1
, osù_ˇŒ_id_à*
ˇŒid2
) {

210 i‡(
ˇŒid1
 =
NULL
 || 
ˇŒid2
 == NULL)

211  
OSIP_BADPARAMETER
;

213 i‡(
ˇŒid1
->
numbî
 =
NULL
 || 
ˇŒid2
->number == NULL)

214  
OSIP_BADPARAMETER
;

216 i‡(0 !
	`°rcmp
(
ˇŒid1
->
numbî
, 
ˇŒid2
->number))

217  
OSIP_UNDEFINED_ERROR
;

219 i‡((
ˇŒid1
->
ho°
 =
NULL
Ë&& (
ˇŒid2
->host == NULL))

220  
OSIP_SUCCESS
;

222 i‡((
ˇŒid1
->
ho°
 =
NULL
Ë&& (
ˇŒid2
->host != NULL))

223  
OSIP_UNDEFINED_ERROR
;

225 i‡((
ˇŒid1
->
ho°
 !
NULL
Ë&& (
ˇŒid2
->host == NULL))

226  
OSIP_UNDEFINED_ERROR
;

228 i‡(0 !
	`°rcmp
(
ˇŒid1
->
ho°
, 
ˇŒid2
->host))

229  
OSIP_UNDEFINED_ERROR
;

231  
OSIP_SUCCESS
;

232 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_info.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 
	$osù_mesßge_£t_ˇŒ_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

28 
osù_ˇŒ_öfo_t
 *
ˇŒ_öfo
;

29 
i
;

31 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

32  
OSIP_SUCCESS
;

34 
i
 = 
	`osù_ˇŒ_öfo_öô
(&
ˇŒ_öfo
);

36 i‡(
i
 != 0)

37  
i
;

39 
i
 = 
	`osù_ˇŒ_öfo_∑r£
(
ˇŒ_öfo
, 
hvÆue
);

41 i‡(
i
 != 0) {

42 
	`osù_ˇŒ_öfo_‰ì
(
ˇŒ_öfo
);

43  
i
;

46 
sù
->
mesßge_¥›îty
 = 2;

47 
	`osù_li°_add
(&
sù
->
ˇŒ_öfos
, 
ˇŒ_öfo
, -1);

48  
OSIP_SUCCESS
;

49 
	}
}

51 
	$osù_mesßge_gë_ˇŒ_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ˇŒ_öfo_t
 **
de°
) {

52 
osù_ˇŒ_öfo_t
 *
ˇŒ_öfo
;

54 *
de°
 = 
NULL
;

56 i‡(
	`osù_li°_size
(&
sù
->
ˇŒ_öfos
Ë<
pos
)

57  
OSIP_UNDEFINED_ERROR
;

59 
ˇŒ_öfo
 = (
osù_ˇŒ_öfo_t
 *Ë
	`osù_li°_gë
(&
sù
->
ˇŒ_öfos
, 
pos
);

60 *
de°
 = 
ˇŒ_öfo
;

61  
pos
;

62 
	}
}

64 
	$osù_ˇŒ_öfo_öô
(
osù_ˇŒ_öfo_t
 **
ˇŒ_öfo
) {

65 *
ˇŒ_öfo
 = (
osù_ˇŒ_öfo_t
 *Ë
	`osù_mÆloc
((osip_call_info_t));

67 i‡(*
ˇŒ_öfo
 =
NULL
)

68  
OSIP_NOMEM
;

70 (*
ˇŒ_öfo
)->
ñemít
 = 
NULL
;

72 
	`osù_li°_öô
(&(*
ˇŒ_öfo
)->
gí_∑øms
);

74  
OSIP_SUCCESS
;

75 
	}
}

77 
	$osù_ˇŒ_öfo_∑r£
(
osù_ˇŒ_öfo_t
 *
ˇŒ_öfo
, c⁄° *
hvÆue
) {

78 c⁄° *
osù_ˇŒ_öfo_∑øms
;

79 
i
;

81 
osù_ˇŒ_öfo_∑øms
 = 
	`°rchr
(
hvÆue
, '<');

83 i‡(
osù_ˇŒ_öfo_∑øms
 =
NULL
)

84  
OSIP_SYNTAXERROR
;

86 
osù_ˇŒ_öfo_∑øms
 = 
	`°rchr
(osip_call_info_params + 1, '>');

88 i‡(
osù_ˇŒ_öfo_∑øms
 =
NULL
)

89  
OSIP_SYNTAXERROR
;

91 
osù_ˇŒ_öfo_∑øms
 = 
	`°rchr
(osip_call_info_params + 1, ';');

93 i‡(
osù_ˇŒ_öfo_∑øms
 !
NULL
) {

94 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
ˇŒ_öfo
->
gí_∑øms
, 
osù_ˇŒ_öfo_∑øms
);

96 i‡(
i
 != 0)

97  
i
;

100 
osù_ˇŒ_öfo_∑øms
 = 
hvÆue
 + 
	`°æí
(hvalue);

102 i‡(
osù_ˇŒ_öfo_∑øms
 - 
hvÆue
 + 1 < 2)

103  
OSIP_SYNTAXERROR
;

105 
ˇŒ_öfo
->
ñemít
 = (*Ë
	`osù_mÆloc
(
osù_ˇŒ_öfo_∑øms
 - 
hvÆue
 + 1);

107 i‡(
ˇŒ_öfo
->
ñemít
 =
NULL
)

108  
OSIP_NOMEM
;

110 
	`osù_˛∫˝y
(
ˇŒ_öfo
->
ñemít
, 
hvÆue
, 
osù_ˇŒ_öfo_∑øms
 - hvalue);

112  
OSIP_SUCCESS
;

113 
	}
}

118 
	$osù_ˇŒ_öfo_to_°r
(c⁄° 
osù_ˇŒ_öfo_t
 *
ˇŒ_öfo
, **
de°
) {

119 *
buf
;

120 *
tmp
;

121 
size_t
 
Àn
;

122 
size_t
 
∂í
;

124 *
de°
 = 
NULL
;

126 i‡((
ˇŒ_öfo
 =
NULL
Ë|| (ˇŒ_öfo->
ñemít
 == NULL))

127  
OSIP_BADPARAMETER
;

129 
Àn
 = 
	`°æí
(
ˇŒ_öfo
->
ñemít
) + 2;

130 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

132 i‡(
buf
 =
NULL
)

133  
OSIP_NOMEM
;

135 *
de°
 = 
buf
;

137 
	`•rötf
(
buf
, "%s", 
ˇŒ_öfo
->
ñemít
);

140 
osù_li°_ôî©‹_t
 
ô
;

141 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
ˇŒ_öfo
->
gí_∑øms
, &
ô
);

143 
u_∑øm
 !
OSIP_SUCCESS
) {

144 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

145 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
) + 2;

148 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 3;

150 
Àn
 =Üí + 
∂í
;

151 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

152 
tmp
 = 
buf
;

153 
tmp
 =Åm∞+ 
	`°æí
(tmp);

155 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

156 
	`•rötf
(
tmp
, ";%s", 
u_∑øm
->
g«me
);

159 
	`•rötf
(
tmp
, ";%s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

161 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

164 *
de°
 = 
buf
;

165  
OSIP_SUCCESS
;

166 
	}
}

170 
	$osù_ˇŒ_öfo_‰ì
(
osù_ˇŒ_öfo_t
 *
ˇŒ_öfo
) {

171 i‡(
ˇŒ_öfo
 =
NULL
)

174 
	`osù_‰ì
(
ˇŒ_öfo
->
ñemít
);

176 
	`osù_gíîic_∑øm_‰ìli°
(&
ˇŒ_öfo
->
gí_∑øms
);

178 
ˇŒ_öfo
->
ñemít
 = 
NULL
;

180 
	`osù_‰ì
(
ˇŒ_öfo
);

181 
	}
}

183 
	$osù_ˇŒ_öfo_˛⁄e
(c⁄° 
osù_ˇŒ_öfo_t
 *
˘t
, osù_ˇŒ_öfo_à**
de°
) {

184 
i
;

185 
osù_ˇŒ_öfo_t
 *
˘
;

187 *
de°
 = 
NULL
;

189 i‡(
˘t
 =
NULL
)

190  
OSIP_BADPARAMETER
;

192 i‡(
˘t
->
ñemít
 =
NULL
)

193  
OSIP_BADPARAMETER
;

195 
i
 = 
	`osù_ˇŒ_öfo_öô
(&
˘
);

197 i‡(
i
 != 0)

198  
i
;

200 
˘
->
ñemít
 = 
	`osù_°rdup
(
˘t
->element);

202 i‡(
˘
->
ñemít
 =
NULL
) {

203 
	`osù_ˇŒ_öfo_‰ì
(
˘
);

204  
OSIP_NOMEM
;

207 
i
 = 
	`osù_li°_˛⁄e
(&
˘t
->
gí_∑øms
, &
˘
->gí_∑øms, ((*)(*, **)Ë& 
osù_gíîic_∑øm_˛⁄e
);

209 i‡(
i
 != 0) {

210 
	`osù_ˇŒ_öfo_‰ì
(
˘
);

211  
i
;

214 *
de°
 = 
˘
;

215  
OSIP_SUCCESS
;

216 
	}
}

218 *
	$osù_ˇŒ_öfo_gë_uri
(
osù_ˇŒ_öfo_t
 *
´
) {

219  
´
->
ñemít
;

220 
	}
}

222 
	$osù_ˇŒ_öfo_£t_uri
(
osù_ˇŒ_öfo_t
 *
´
, *
uri
) {

223 
´
->
ñemít
 = 
uri
;

224 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_contact.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

30 
	$osù_mesßge_£t_c⁄è˘
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

31 
i
;

32 
osù_c⁄è˘_t
 *
c⁄è˘
;

34 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 
i
 = 
	`osù_c⁄è˘_öô
(&
c⁄è˘
);

39 i‡(
i
 != 0)

40  
i
;

42 
i
 = 
	`osù_c⁄è˘_∑r£
(
c⁄è˘
, 
hvÆue
);

44 i‡(
i
 != 0) {

45 
	`osù_c⁄è˘_‰ì
(
c⁄è˘
);

46  
i
;

49 
sù
->
mesßge_¥›îty
 = 2;

50 
	`osù_li°_add
(&
sù
->
c⁄è˘s
, 
c⁄è˘
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

58 
	$osù_c⁄è˘_∑r£
(
osù_c⁄è˘_t
 *
c⁄è˘
, c⁄° *
hvÆue
) {

59 i‡(
c⁄è˘
 =
NULL
)

60  
OSIP_BADPARAMETER
;

62 i‡(
	`°∫cmp
(
hvÆue
, "*", 1) == 0) {

63 
c⁄è˘
->
di•œy«me
 = 
	`osù_°rdup
(
hvÆue
);

65 i‡(
c⁄è˘
->
di•œy«me
 =
NULL
) {

66  
OSIP_NOMEM
;

69  
OSIP_SUCCESS
;

72  
	`osù_‰om_∑r£
((
osù_‰om_t
 *Ë
c⁄è˘
, 
hvÆue
);

73 
	}
}

75 #i‚de‡
MINISIZE


76 
	$osù_c⁄è˘_öô
(
osù_c⁄è˘_t
 **
c⁄è˘
) {

77  
	`osù_‰om_öô
((
osù_‰om_t
 **Ë
c⁄è˘
);

78 
	}
}

81 #i‚de‡
MINISIZE


87 
	$osù_mesßge_gë_c⁄è˘
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_c⁄è˘_t
 **
de°
) {

88 *
de°
 = 
NULL
;

90 i‡(
sù
 =
NULL
)

91  
OSIP_BADPARAMETER
;

93 i‡(
	`osù_li°_size
(&
sù
->
c⁄è˘s
Ë<
pos
)

94  
OSIP_UNDEFINED_ERROR
;

96 *
de°
 = (
osù_c⁄è˘_t
 *Ë
	`osù_li°_gë
(&
sù
->
c⁄è˘s
, 
pos
);

97  
pos
;

98 
	}
}

104 
	$osù_c⁄è˘_to_°r
(c⁄° 
osù_c⁄è˘_t
 *
c⁄è˘
, **
de°
) {

105 i‡(
c⁄è˘
 =
NULL
)

106  
OSIP_BADPARAMETER
;

108 i‡(
c⁄è˘
->
di•œy«me
 !
NULL
) {

109 i‡(
	`°∫cmp
(
c⁄è˘
->
di•œy«me
, "*", 1) == 0) {

110 *
de°
 = 
	`osù_°rdup
("*");

112 i‡(*
de°
 =
NULL
)

113  
OSIP_NOMEM
;

115  
OSIP_SUCCESS
;

119  
	`osù_‰om_to_°r
((
osù_‰om_t
 *Ë
c⁄è˘
, 
de°
);

120 
	}
}

122 #i‚de‡
MINISIZE


125 
	$osù_c⁄è˘_‰ì
(
osù_c⁄è˘_t
 *
c⁄è˘
) {

126 
	`osù_‰om_‰ì
((
osù_‰om_t
 *Ë
c⁄è˘
);

127 
	}
}

129 
	$osù_c⁄è˘_˛⁄e
(c⁄° 
osù_c⁄è˘_t
 *
c⁄è˘
, osù_c⁄è˘_à**
de°
) {

130  
	`osù_‰om_˛⁄e
((
osù_‰om_t
 *Ë
c⁄è˘
, (osù_‰om_à**Ë
de°
);

131 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_disposition.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 
	$osù_c⁄ã¡_di•osôi⁄_∑r£
(
osù_c⁄ã¡_di•osôi⁄_t
 *
cd
, c⁄° *
hvÆue
) {

28 c⁄° *
cd_∑øms
;

29 
i
;

31 
cd_∑øms
 = 
	`°rchr
(
hvÆue
, ';');

33 i‡(
cd_∑øms
 !
NULL
) {

34 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
cd
->
gí_∑øms
, 
cd_∑øms
);

36 i‡(
i
 != 0)

37  
i
;

40 
cd_∑øms
 = 
hvÆue
 + 
	`°æí
(hvalue);

42 i‡(
cd_∑øms
 - 
hvÆue
 + 1 < 2)

43  
OSIP_SYNTAXERROR
;

45 
cd
->
ñemít
 = (*Ë
	`osù_mÆloc
(
cd_∑øms
 - 
hvÆue
 + 1);

47 i‡(
cd
->
ñemít
 =
NULL
)

48  
OSIP_NOMEM
;

50 
	`osù_˛∫˝y
(
cd
->
ñemít
, 
hvÆue
, 
cd_∑øms
 - hvalue);

52  
OSIP_SUCCESS
;

53 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_encoding.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


32 
	$osù_mesßge_£t_c⁄ã¡_ícodög
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

33 
osù_c⁄ã¡_ícodög_t
 *
c⁄ã¡_ícodög
;

34 
i
;

36 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`osù_c⁄ã¡_ícodög_öô
(&
c⁄ã¡_ícodög
);

41 i‡(
i
 != 0)

42  
i
;

44 
i
 = 
	`osù_c⁄ã¡_ícodög_∑r£
(
c⁄ã¡_ícodög
, 
hvÆue
);

46 i‡(
i
 != 0) {

47 
	`osù_c⁄ã¡_ícodög_‰ì
(
c⁄ã¡_ícodög
);

48  
i
;

51 
sù
->
mesßge_¥›îty
 = 2;

52 
	`osù_li°_add
(&
sù
->
c⁄ã¡_ícodögs
, 
c⁄ã¡_ícodög
, -1);

53  
OSIP_SUCCESS
;

54 
	}
}

56 
	$osù_mesßge_gë_c⁄ã¡_ícodög
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_c⁄ã¡_ícodög_t
 **
de°
) {

57 
osù_c⁄ã¡_ícodög_t
 *
˚
;

59 *
de°
 = 
NULL
;

61 i‡(
	`osù_li°_size
(&
sù
->
c⁄ã¡_ícodögs
Ë<
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
˚
 = (
osù_c⁄ã¡_ícodög_t
 *Ë
	`osù_li°_gë
(&
sù
->
c⁄ã¡_ícodögs
, 
pos
);

65 *
de°
 = 
˚
;

66  
pos
;

67 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_length.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 
	$osù_c⁄ã¡_Àngth_öô
(
osù_c⁄ã¡_Àngth_t
 **
˛
) {

27 *
˛
 = (
osù_c⁄ã¡_Àngth_t
 *Ë
	`osù_mÆloc
((osip_content_length_t));

29 i‡(*
˛
 =
NULL
)

30  
OSIP_NOMEM
;

32 (*
˛
)->
vÆue
 = 
NULL
;

33  
OSIP_SUCCESS
;

34 
	}
}

40 
	$osù_mesßge_£t_c⁄ã¡_Àngth
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

41 
i
;

43 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

44  
OSIP_SUCCESS
;

46 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
)

47  
OSIP_SYNTAXERROR
;

49 
i
 = 
	`osù_c⁄ã¡_Àngth_öô
(&(
sù
->
c⁄ã¡_Àngth
));

51 i‡(
i
 != 0)

52  
i
;

54 
sù
->
mesßge_¥›îty
 = 2;

55 
i
 = 
	`osù_c⁄ã¡_Àngth_∑r£
(
sù
->
c⁄ã¡_Àngth
, 
hvÆue
);

57 i‡(
i
 != 0) {

58 
	`osù_c⁄ã¡_Àngth_‰ì
(
sù
->
c⁄ã¡_Àngth
);

59 
sù
->
c⁄ã¡_Àngth
 = 
NULL
;

60  
i
;

63  
OSIP_SUCCESS
;

64 
	}
}

66 
	$osù_c⁄ã¡_Àngth_∑r£
(
osù_c⁄ã¡_Àngth_t
 *
c⁄ã¡_Àngth
, c⁄° *
hvÆue
) {

67 
size_t
 
Àn
;

69 i‡(
hvÆue
 =
NULL
)

70  
OSIP_BADPARAMETER
;

72 
Àn
 = 
	`°æí
(
hvÆue
);

74 i‡(
Àn
 + 1 < 2)

75  
OSIP_SYNTAXERROR
;

77 
c⁄ã¡_Àngth
->
vÆue
 = (*Ë
	`osù_mÆloc
(
Àn
 + 1);

79 i‡(
c⁄ã¡_Àngth
->
vÆue
 =
NULL
)

80  
OSIP_NOMEM
;

82 
	`osù_°∫˝y
(
c⁄ã¡_Àngth
->
vÆue
, 
hvÆue
, 
Àn
);

83  
OSIP_SUCCESS
;

84 
	}
}

86 #i‚de‡
MINISIZE


90 
osù_c⁄ã¡_Àngth_t
 *
	$osù_mesßge_gë_c⁄ã¡_Àngth
(c⁄° 
osù_mesßge_t
 *
sù
) {

91  
sù
->
c⁄ã¡_Àngth
;

92 
	}
}

98 
	$osù_c⁄ã¡_Àngth_to_°r
(c⁄° 
osù_c⁄ã¡_Àngth_t
 *
˛
, **
de°
) {

99 i‡(
˛
 =
NULL
)

100  
OSIP_BADPARAMETER
;

102 *
de°
 = 
	`osù_°rdup
(
˛
->
vÆue
);

104 i‡(*
de°
 =
NULL
)

105  
OSIP_NOMEM
;

107  
OSIP_SUCCESS
;

108 
	}
}

112 
	$osù_c⁄ã¡_Àngth_‰ì
(
osù_c⁄ã¡_Àngth_t
 *
c⁄ã¡_Àngth
) {

113 i‡(
c⁄ã¡_Àngth
 =
NULL
)

116 
	`osù_‰ì
(
c⁄ã¡_Àngth
->
vÆue
);

117 
	`osù_‰ì
(
c⁄ã¡_Àngth
);

118 
	}
}

120 
	$osù_c⁄ã¡_Àngth_˛⁄e
(c⁄° 
osù_c⁄ã¡_Àngth_t
 *
˘l
, osù_c⁄ã¡_Àngth_à**
de°
) {

121 
i
;

122 
osù_c⁄ã¡_Àngth_t
 *
˛
;

124 *
de°
 = 
NULL
;

126 i‡(
˘l
 =
NULL
)

127  
OSIP_BADPARAMETER
;

133 
i
 = 
	`osù_c⁄ã¡_Àngth_öô
(&
˛
);

135 i‡(
i
 != 0)

136  
i
;

138 i‡(
˘l
->
vÆue
 !
NULL
) {

139 
˛
->
vÆue
 = 
	`osù_°rdup
(
˘l
->value);

141 i‡(
˛
->
vÆue
 =
NULL
) {

142 
	`osù_c⁄ã¡_Àngth_‰ì
(
˛
);

143  
OSIP_NOMEM
;

147 *
de°
 = 
˛
;

148  
OSIP_SUCCESS
;

149 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_type.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 
	$osù_c⁄ã¡_ty≥_öô
(
osù_c⁄ã¡_ty≥_t
 **
c⁄ã¡_ty≥
) {

28 *
c⁄ã¡_ty≥
 = (
osù_c⁄ã¡_ty≥_t
 *Ë
	`osù_mÆloc
((osip_content_type_t));

30 i‡(*
c⁄ã¡_ty≥
 =
NULL
)

31  
OSIP_NOMEM
;

33 (*
c⁄ã¡_ty≥
)->
ty≥
 = 
NULL
;

34 (*
c⁄ã¡_ty≥
)->
subty≥
 = 
NULL
;

36 
	`osù_li°_öô
(&(*
c⁄ã¡_ty≥
)->
gí_∑øms
);

38  
OSIP_SUCCESS
;

39 
	}
}

45 
	$osù_mesßge_£t_c⁄ã¡_ty≥
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

46 
i
;

48 i‡(
sù
->
c⁄ã¡_ty≥
 !
NULL
)

49  
OSIP_BADPARAMETER
;

51 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

52  
OSIP_SUCCESS
;

54 
i
 = 
	`osù_c⁄ã¡_ty≥_öô
(&(
sù
->
c⁄ã¡_ty≥
));

56 i‡(
i
 != 0)

57  
i
;

59 
sù
->
mesßge_¥›îty
 = 2;

60 
i
 = 
	`osù_c⁄ã¡_ty≥_∑r£
(
sù
->
c⁄ã¡_ty≥
, 
hvÆue
);

62 i‡(
i
 != 0) {

63 
	`osù_c⁄ã¡_ty≥_‰ì
(
sù
->
c⁄ã¡_ty≥
);

64 
sù
->
c⁄ã¡_ty≥
 = 
NULL
;

65  
i
;

68  
OSIP_SUCCESS
;

69 
	}
}

71 #i‚de‡
MINISIZE


75 
osù_c⁄ã¡_ty≥_t
 *
	$osù_mesßge_gë_c⁄ã¡_ty≥
(c⁄° 
osù_mesßge_t
 *
sù
) {

76  
sù
->
c⁄ã¡_ty≥
;

77 
	}
}

84 
	$osù_c⁄ã¡_ty≥_∑r£
(
osù_c⁄ã¡_ty≥_t
 *
c⁄ã¡_ty≥
, c⁄° *
hvÆue
) {

85 *
subty≥
;

86 *
osù_c⁄ã¡_ty≥_∑øms
;

87 
i
;

100 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

101  
OSIP_SUCCESS
;

103 
subty≥
 = 
	`°rchr
(
hvÆue
, '/');

104 
osù_c⁄ã¡_ty≥_∑øms
 = 
	`°rchr
(
hvÆue
, ';');

106 i‡(
subty≥
 =
NULL
)

107  
OSIP_SYNTAXERROR
;

109 i‡(
osù_c⁄ã¡_ty≥_∑øms
 !
NULL
) {

110 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
c⁄ã¡_ty≥
->
gí_∑øms
, 
osù_c⁄ã¡_ty≥_∑øms
);

112 i‡(
i
 != 0)

113  
i
;

116 
osù_c⁄ã¡_ty≥_∑øms
 = 
subty≥
 + 
	`°æí
(subtype);

118 i‡(
subty≥
 - 
hvÆue
 + 1 < 2)

119  
OSIP_SYNTAXERROR
;

121 
c⁄ã¡_ty≥
->
ty≥
 = (*Ë
	`osù_mÆloc
(
subty≥
 - 
hvÆue
 + 1);

123 i‡(
c⁄ã¡_ty≥
->
ty≥
 =
NULL
)

124  
OSIP_NOMEM
;

126 
	`osù_˛∫˝y
(
c⁄ã¡_ty≥
->
ty≥
, 
hvÆue
, 
subty≥
 - hvalue);

128 i‡(
osù_c⁄ã¡_ty≥_∑øms
 - 
subty≥
 < 2)

129  
OSIP_SYNTAXERROR
;

131 
c⁄ã¡_ty≥
->
subty≥
 = (*Ë
	`osù_mÆloc
(
osù_c⁄ã¡_ty≥_∑øms
 - subtype);

133 i‡(
c⁄ã¡_ty≥
->
subty≥
 =
NULL
)

134  
OSIP_NOMEM
;

136 
	`osù_˛∫˝y
(
c⁄ã¡_ty≥
->
subty≥
, subty≥ + 1, 
osù_c⁄ã¡_ty≥_∑øms
 - subtype - 1);

138  
OSIP_SUCCESS
;

139 
	}
}

144 
	$osù_c⁄ã¡_ty≥_to_°r
(c⁄° 
osù_c⁄ã¡_ty≥_t
 *
c⁄ã¡_ty≥
, **
de°
) {

145 *
buf
;

146 *
tmp
;

147 
size_t
 
Àn
;

149 *
de°
 = 
NULL
;

151 i‡((
c⁄ã¡_ty≥
 =
NULL
Ë|| (c⁄ã¡_ty≥->
ty≥
 =NULLË|| (c⁄ã¡_ty≥->
subty≥
 == NULL))

152  
OSIP_BADPARAMETER
;

155 
Àn
 = 
	`°æí
(
c⁄ã¡_ty≥
->
ty≥
Ë+ såÀn(c⁄ã¡_ty≥->
subty≥
) + 4

156 + 10 * 
	`osù_li°_size
(&
c⁄ã¡_ty≥
->
gí_∑øms
);

158 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

160 i‡(
buf
 =
NULL
)

161  
OSIP_NOMEM
;

163 
tmp
 = 
buf
;

165 
	`•rötf
(
tmp
, "%s/%s", 
c⁄ã¡_ty≥
->
ty≥
, c⁄ã¡_ty≥->
subty≥
);

167 
tmp
 =Åm∞+ 
	`°æí
(tmp);

169 
osù_li°_ôî©‹_t
 
ô
;

170 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
c⁄ã¡_ty≥
->
gí_∑øms
, &
ô
);

172 
u_∑øm
 !
OSIP_SUCCESS
) {

173 
size_t
 
tmp_Àn
;

175 i‡(
u_∑øm
->
gvÆue
 =
NULL
) {

176 
	`osù_‰ì
(
buf
);

177  
OSIP_SYNTAXERROR
;

180 
tmp_Àn
 = 
	`°æí
(
buf
Ë+ 4 + såÀn(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 1;

182 i‡(
Àn
 < 
tmp_Àn
) {

183 
buf
 = 
	`osù_ªÆloc
(buf, 
tmp_Àn
);

184 
Àn
 = 
tmp_Àn
;

185 
tmp
 = 
buf
 + 
	`°æí
(buf);

188 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), "; %s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

189 
tmp
 =Åm∞+ 
	`°æí
(tmp);

190 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

193 *
de°
 = 
buf
;

194  
OSIP_SUCCESS
;

195 
	}
}

199 
	$osù_c⁄ã¡_ty≥_‰ì
(
osù_c⁄ã¡_ty≥_t
 *
c⁄ã¡_ty≥
) {

200 i‡(
c⁄ã¡_ty≥
 =
NULL
)

203 
	`osù_‰ì
(
c⁄ã¡_ty≥
->
ty≥
);

204 
	`osù_‰ì
(
c⁄ã¡_ty≥
->
subty≥
);

206 
	`osù_gíîic_∑øm_‰ìli°
(&
c⁄ã¡_ty≥
->
gí_∑øms
);

208 
c⁄ã¡_ty≥
->
ty≥
 = 
NULL
;

209 
c⁄ã¡_ty≥
->
subty≥
 = 
NULL
;

211 
	`osù_‰ì
(
c⁄ã¡_ty≥
);

212 
	}
}

214 
	$osù_c⁄ã¡_ty≥_˛⁄e
(c⁄° 
osù_c⁄ã¡_ty≥_t
 *
˘t
, osù_c⁄ã¡_ty≥_à**
de°
) {

215 
i
;

216 
osù_c⁄ã¡_ty≥_t
 *
˘
;

218 *
de°
 = 
NULL
;

220 i‡(
˘t
 =
NULL
)

221  
OSIP_BADPARAMETER
;

223 
i
 = 
	`osù_c⁄ã¡_ty≥_öô
(&
˘
);

225 i‡(
i
 != 0)

226  
i
;

228 i‡(
˘t
->
ty≥
 !
NULL
)

229 
˘
->
ty≥
 = 
	`osù_°rdup
(
˘t
->type);

231 i‡(
˘t
->
subty≥
 !
NULL
)

232 
˘
->
subty≥
 = 
	`osù_°rdup
(
˘t
->subtype);

235 
osù_gíîic_∑øm_t
 *
de°_∑øm
;

236 
osù_li°_ôî©‹_t
 
ô
;

237 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
˘t
->
gí_∑øms
, &
ô
);

239 
u_∑øm
 !
OSIP_SUCCESS
) {

240 
i
 = 
	`osù_gíîic_∑øm_˛⁄e
(
u_∑øm
, &
de°_∑øm
);

242 i‡(
i
 != 0) {

243 
	`osù_c⁄ã¡_ty≥_‰ì
(
˘
);

244  
i
;

247 
	`osù_li°_add
(&
˘
->
gí_∑øms
, 
de°_∑øm
, -1);

248 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

251 *
de°
 = 
˘
;

252  
OSIP_SUCCESS
;

253 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_cseq.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 
	$osù_c£q_öô
(
osù_c£q_t
 **
c£q
) {

27 *
c£q
 = (
osù_c£q_t
 *Ë
	`osù_mÆloc
((osip_cseq_t));

29 i‡(*
c£q
 =
NULL
)

30  
OSIP_NOMEM
;

32 (*
c£q
)->
mëhod
 = 
NULL
;

33 (*
c£q
)->
numbî
 = 
NULL
;

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$osù_mesßge_£t_c£q
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

42 
i
;

44 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

45  
OSIP_SUCCESS
;

47 i‡(
sù
->
c£q
 !
NULL
)

48  
OSIP_BADPARAMETER
;

50 
i
 = 
	`osù_c£q_öô
(&(
sù
->
c£q
));

52 i‡(
i
 != 0)

53  
i
;

55 
sù
->
mesßge_¥›îty
 = 2;

56 
i
 = 
	`osù_c£q_∑r£
(
sù
->
c£q
, 
hvÆue
);

58 i‡(
i
 != 0) {

59 
	`osù_c£q_‰ì
(
sù
->
c£q
);

60 
sù
->
c£q
 = 
NULL
;

61  
i
;

64  
OSIP_SUCCESS
;

65 
	}
}

71 
	$osù_c£q_∑r£
(
osù_c£q_t
 *
c£q
, c⁄° *
hvÆue
) {

72 *
mëhod
 = 
NULL
;

73 c⁄° *
íd
 = 
NULL
;

75 i‡(
c£q
 =
NULL
 || 
hvÆue
 == NULL)

76  
OSIP_BADPARAMETER
;

78 
c£q
->
numbî
 = 
NULL
;

79 
c£q
->
mëhod
 = 
NULL
;

81 
mëhod
 = 
	`°rchr
(
hvÆue
, ' ');

83 i‡(
mëhod
 =
NULL
)

84  
OSIP_SYNTAXERROR
;

86 
íd
 = 
hvÆue
 + 
	`°æí
(hvalue);

88 i‡(
mëhod
 - 
hvÆue
 + 1 < 2)

89  
OSIP_SYNTAXERROR
;

91 
c£q
->
numbî
 = (*Ë
	`osù_mÆloc
(
mëhod
 - 
hvÆue
 + 1);

93 i‡(
c£q
->
numbî
 =
NULL
)

94  
OSIP_NOMEM
;

96 
	`osù_˛∫˝y
(
c£q
->
numbî
, 
hvÆue
, 
mëhod
 - hvalue);

98 i‡(
íd
 - 
mëhod
 + 1 < 2)

99  
OSIP_SYNTAXERROR
;

101 
c£q
->
mëhod
 = (*Ë
	`osù_mÆloc
(
íd
 - method + 1);

103 i‡(
c£q
->
mëhod
 =
NULL
)

104  
OSIP_NOMEM
;

106 
	`osù_˛∫˝y
(
c£q
->
mëhod
, mëhod + 1, 
íd
 - method);

108  
OSIP_SUCCESS
;

109 
	}
}

111 #i‚de‡
MINISIZE


115 
osù_c£q_t
 *
	$osù_mesßge_gë_c£q
(c⁄° 
osù_mesßge_t
 *
sù
) {

116  
sù
->
c£q
;

117 
	}
}

120 *
	$osù_c£q_gë_numbî
(
osù_c£q_t
 *
c£q
) {

121  
c£q
->
numbî
;

122 
	}
}

124 *
	$osù_c£q_gë_mëhod
(
osù_c£q_t
 *
c£q
) {

125  
c£q
->
mëhod
;

126 
	}
}

128 
	$osù_c£q_£t_numbî
(
osù_c£q_t
 *
c£q
, *
numbî
) {

129 
c£q
->
numbî
 = (*)Çumber;

130 
	}
}

132 
	$osù_c£q_£t_mëhod
(
osù_c£q_t
 *
c£q
, *
mëhod
) {

133 
c£q
->
mëhod
 = (*) method;

134 
	}
}

139 
	$osù_c£q_to_°r
(c⁄° 
osù_c£q_t
 *
c£q
, **
de°
) {

140 
size_t
 
Àn
;

142 *
de°
 = 
NULL
;

144 i‡((
c£q
 =
NULL
Ë|| (c£q->
numbî
 =NULLË|| (c£q->
mëhod
 == NULL))

145  
OSIP_BADPARAMETER
;

147 
Àn
 = 
	`°æí
(
c£q
->
mëhod
Ë+ såÀn(c£q->
numbî
) + 2;

148 *
de°
 = (*Ë
	`osù_mÆloc
(
Àn
);

150 i‡(*
de°
 =
NULL
)

151  
OSIP_NOMEM
;

153 
	`¢¥ötf
(*
de°
, 
Àn
, "%†%s", 
c£q
->
numbî
, c£q->
mëhod
);

154  
OSIP_SUCCESS
;

155 
	}
}

159 
	$osù_c£q_‰ì
(
osù_c£q_t
 *
c£q
) {

160 i‡(
c£q
 =
NULL
)

163 
	`osù_‰ì
(
c£q
->
mëhod
);

164 
	`osù_‰ì
(
c£q
->
numbî
);

165 
	`osù_‰ì
(
c£q
);

166 
	}
}

168 
	$osù_c£q_˛⁄e
(c⁄° 
osù_c£q_t
 *
c£q
, osù_c£q_à**
de°
) {

169 
i
;

170 
osù_c£q_t
 *
cs
;

172 *
de°
 = 
NULL
;

174 i‡(
c£q
 =
NULL
)

175  
OSIP_BADPARAMETER
;

177 i‡(
c£q
->
mëhod
 =
NULL
)

178  
OSIP_BADPARAMETER
;

180 i‡(
c£q
->
numbî
 =
NULL
)

181  
OSIP_BADPARAMETER
;

183 
i
 = 
	`osù_c£q_öô
(&
cs
);

185 i‡(
i
 != 0) {

186 
	`osù_c£q_‰ì
(
cs
);

187  
i
;

190 
cs
->
mëhod
 = 
	`osù_°rdup
(
c£q
->method);

191 
cs
->
numbî
 = 
	`osù_°rdup
(
c£q
->number);

193 *
de°
 = 
cs
;

194  
OSIP_SUCCESS
;

195 
	}
}

197 
	$osù_c£q_m©ch
(
osù_c£q_t
 *
c£q1
, osù_c£q_à*
c£q2
) {

198 i‡(
c£q1
 =
NULL
 || 
c£q2
 == NULL)

199  
OSIP_BADPARAMETER
;

201 i‡(
c£q1
->
numbî
 =
NULL
 || 
c£q2
->numbî =NULL || c£q1->
mëhod
 == NULL || cseq2->method == NULL)

202  
OSIP_BADPARAMETER
;

204 i‡(0 =
	`°rcmp
(
c£q1
->
numbî
, 
c£q2
->number)) {

205 i‡(0 =
	`°rcmp
(
c£q2
->
mëhod
, "INVITE") || 0 == strcmp(cseq2->method, "ACK")) {

206 i‡(0 =
	`°rcmp
(
c£q1
->
mëhod
, "INVITE") || 0 == strcmp(cseq1->method, "ACK"))

207  
OSIP_SUCCESS
;

210 i‡(0 =
	`°rcmp
(
c£q1
->
mëhod
, 
c£q2
->method))

211  
OSIP_SUCCESS
;

215  
OSIP_UNDEFINED_ERROR
;

216 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_error_info.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 #i‚de‡
MINISIZE


29 
	$osù_mesßge_£t_îr‹_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

30 
osù_îr‹_öfo_t
 *
îr‹_öfo
;

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`osù_îr‹_öfo_öô
(&
îr‹_öfo
);

38 i‡(
i
 != 0)

39  
i
;

41 
i
 = 
	`osù_îr‹_öfo_∑r£
(
îr‹_öfo
, 
hvÆue
);

43 i‡(
i
 != 0) {

44 
	`osù_îr‹_öfo_‰ì
(
îr‹_öfo
);

45  
i
;

48 
sù
->
mesßge_¥›îty
 = 2;

49 
	`osù_li°_add
(&
sù
->
îr‹_öfos
, 
îr‹_öfo
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$osù_mesßge_gë_îr‹_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_îr‹_öfo_t
 **
de°
) {

54 
osù_îr‹_öfo_t
 *
îr‹_öfo
;

56 *
de°
 = 
NULL
;

58 i‡(
	`osù_li°_size
(&
sù
->
îr‹_öfos
Ë<
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
îr‹_öfo
 = (
osù_îr‹_öfo_t
 *Ë
	`osù_li°_gë
(&
sù
->
îr‹_öfos
, 
pos
);

62 *
de°
 = 
îr‹_öfo
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_from.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

31 
	$osù_mesßge_£t_‰om
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

32 
i
;

34 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 i‡(
sù
->
‰om
 !
NULL
)

38  
OSIP_SYNTAXERROR
;

40 
i
 = 
	`osù_‰om_öô
(&(
sù
->
‰om
));

42 i‡(
i
 != 0)

43  
i
;

45 
sù
->
mesßge_¥›îty
 = 2;

46 
i
 = 
	`osù_‰om_∑r£
(
sù
->
‰om
, 
hvÆue
);

48 i‡(
i
 != 0) {

49 
	`osù_‰om_‰ì
(
sù
->
‰om
);

50 
sù
->
‰om
 = 
NULL
;

51  
i
;

54  
OSIP_SUCCESS
;

55 
	}
}

57 #i‚de‡
MINISIZE


61 
osù_‰om_t
 *
	$osù_mesßge_gë_‰om
(c⁄° 
osù_mesßge_t
 *
sù
) {

62  
sù
->
‰om
;

63 
	}
}

66 
	$osù_‰om_öô
(
osù_‰om_t
 **
‰om
) {

67 *
‰om
 = (
osù_‰om_t
 *Ë
	`osù_mÆloc
((osip_from_t));

69 i‡(*
‰om
 =
NULL
)

70  
OSIP_NOMEM
;

72 (*
‰om
)->
di•œy«me
 = 
NULL
;

73 (*
‰om
)->
uæ
 = 
NULL
;

75 
	`osù_li°_öô
(&(*
‰om
)->
gí_∑øms
);

77  
OSIP_SUCCESS
;

78 
	}
}

82 
	$osù_‰om_‰ì
(
osù_‰om_t
 *
‰om
) {

83 i‡(
‰om
 =
NULL
)

86 i‡(
‰om
->
uæ
 !
NULL
) {

87 
	`osù_uri_‰ì
(
‰om
->
uæ
);

90 
	`osù_‰ì
(
‰om
->
di•œy«me
);

92 
	`osù_gíîic_∑øm_‰ìli°
(&
‰om
->
gí_∑øms
);

94 
	`osù_‰ì
(
‰om
);

95 
	}
}

101 
	$osù_‰om_∑r£
(
osù_‰om_t
 *
‰om
, c⁄° *
hvÆue
) {

102 c⁄° *
di•œy«me
 = 
NULL
;

103 c⁄° *
uæ
 = 
NULL
;

104 c⁄° *
uæ_íd
 = 
NULL
;

105 c⁄° *
gí_∑øms
;

106 c⁄° *
±r
;

107 
i
;

109 i‡(
‰om
 =
NULL
 || 
hvÆue
 == NULL)

110  
OSIP_BADPARAMETER
;

129 
±r
 = 
hvÆue
;

131 
±r
[0] != '\0') {

132 i‡(
±r
[0] == ' ') {

133 
±r
++;

137 i‡(
±r
[0] == '"') {

138 
di•œy«me
 = 
±r
;

145 i‡(
±r
[0] == '\0')

146  
OSIP_SUCCESS
;

148 i‡(
di•œy«me
 !
NULL
) {

150 c⁄° *
£c⁄d
 = 
NULL
;

153 
£c⁄d
 = 
	`__osù_quŸe_föd
(
di•œy«me
 + 1);

155 i‡(
£c⁄d
 =
NULL
)

156  
OSIP_SYNTAXERROR
;

158 i‡(
£c⁄d
 - 
di•œy«me
 + 2 >= 2) {

159 
‰om
->
di•œy«me
 = (*Ë
	`osù_mÆloc
(
£c⁄d
 - displayname + 2);

161 i‡(
‰om
->
di•œy«me
 =
NULL
)

162  
OSIP_NOMEM
;

164 
	`osù_°∫˝y
(
‰om
->
di•œy«me
, di•œy«me, 
£c⁄d
 - displayname + 1);

170 
±r
 = 
£c⁄d
 + 1;

172 
±r
[0] != '\0') {

173 i‡(
±r
[0] == ' ') {

174 
±r
++;

178 i‡(
±r
[0] == '<') {

179 
uæ
 = 
±r
;

186 i‡(
uæ
 =
NULL
)

187  
OSIP_SYNTAXERROR
;

189 i‡(
±r
[1] == '\0')

190  
OSIP_SYNTAXERROR
;

195 c⁄° *
beg
 = 
±r
;

197 
±r
[0] != '\0') {

198 i‡(
±r
[0] == ' ') {

199 
±r
++;

203 i‡(
±r
[0] >= 'a' &&Ötr[0] <= 'z') {

204 
±r
++;

208 i‡(
±r
[0] >= 'A' &&Ötr[0] <= 'Z') {

209 
±r
++;

213 i‡(
±r
[0] >= '0' &&Ötr[0] <= '9') {

214 
±r
++;

218 i‡(
±r
[0] == '-' ||Ötr[0] == '.' ||Ötr[0] == '!' ||Ötr[0] == '%' ||Ötr[0] == '*' ||Ötr[0] == '_' ||Ötr[0] == '+' ||Ötr[0] == '`' ||Ötr[0] == '\'' ||Ötr[0] == '~') {

219 
±r
++;

223 
uæ
 = 
±r
;

227 i‡(
±r
[0] ='\0' || 
uæ
 =
NULL
)

228  
OSIP_SYNTAXERROR
;

230 i‡(
±r
[0] == '<') {

232 i‡(
±r
[1] == '\0')

233  
OSIP_SYNTAXERROR
;

235 i‡(
uæ
 - 
beg
 > 0) {

236 
‰om
->
di•œy«me
 = (*Ë
	`osù_mÆloc
(
uæ
 - 
beg
 + 1);

238 i‡(
‰om
->
di•œy«me
 =
NULL
)

239  
OSIP_NOMEM
;

241 
	`osù_˛∫˝y
(
‰om
->
di•œy«me
, 
hvÆue
, 
uæ
 - 
beg
);

244 } i‡(
±r
[0] == ':') {

246 
uæ
 = 
beg
;

250 
uæ
 = 
beg
;

255 i‡(
uæ
[0] == '<') {

256 
uæ
++;

257 
±r
 = 
uæ
;

259 
uæ_íd
 = 
	`°rchr
(
±r
, '>');

261 i‡(
uæ_íd
 =
NULL
)

262  
OSIP_SYNTAXERROR
;

264 
uæ_íd
--;

265 
gí_∑øms
 = 
	`°rchr
(
uæ_íd
, ';');

269 i‡(
uæ_íd
 =
NULL
) {

276 
gí_∑øms
 = 
	`°rchr
(
uæ
, ';');

278 i‡(
gí_∑øms
 !
NULL
)

279 
uæ_íd
 = 
gí_∑øms
 - 1;

282 
uæ_íd
 = 
uæ
 + 
	`°æí
(url);

285 i‡(
gí_∑øms
 !
NULL
) {

286 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
‰om
->
gí_∑øms
, gen_params);

288 i‡(
i
 != 0) {

289  
i
;

295 *
tmp
;

297 i‡(
uæ_íd
 - 
uæ
 + 2 < 7)

298  
OSIP_SYNTAXERROR
;

300 
i
 = 
	`osù_uri_öô
(&(
‰om
->
uæ
));

302 i‡(
i
 != 0)

303  
i
;

305 
tmp
 = (*Ë
	`osù_mÆloc
(
uæ_íd
 - 
uæ
 + 2);

307 i‡(
tmp
 =
NULL
)

308  
OSIP_NOMEM
;

310 
	`osù_°∫˝y
(
tmp
, 
uæ
, 
uæ_íd
 - url + 1);

311 
i
 = 
	`osù_uri_∑r£
(
‰om
->
uæ
, 
tmp
);

312 
	`osù_‰ì
(
tmp
);

314 i‡(
i
 != 0)

315  
i
;

317  
OSIP_SUCCESS
;

318 
	}
}

323 
	$osù_‰om_to_°r
(c⁄° 
osù_‰om_t
 *
‰om
, **
de°
) {

324 *
uæ
;

325 *
buf
;

326 
i
;

327 
size_t
 
Àn
;

329 *
de°
 = 
NULL
;

331 i‡((
‰om
 =
NULL
Ë|| (‰om->
uæ
 == NULL))

332  
OSIP_BADPARAMETER
;

334 
i
 = 
	`osù_uri_to_°r
(
‰om
->
uæ
, &url);

336 i‡(
i
 != 0)

337  
i
;

339 i‡(
‰om
->
di•œy«me
 =
NULL
)

340 
Àn
 = 
	`°æí
(
uæ
) + 5;

343 
Àn
 = 
	`°æí
(
uæ
Ë+ såÀn(
‰om
->
di•œy«me
) + 5;

345 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

347 i‡(
buf
 =
NULL
) {

348 
	`osù_‰ì
(
uæ
);

349  
OSIP_NOMEM
;

352 i‡(
‰om
->
di•œy«me
 !
NULL
)

353 
	`•rötf
(
buf
, "%†<%s>", 
‰om
->
di•œy«me
, 
uæ
);

359 
	`•rötf
(
buf
, "<%s>", 
uæ
);

361 
	`osù_‰ì
(
uæ
);

364 
size_t
 
∂í
;

365 *
tmp
;

366 
osù_li°_ôî©‹_t
 
ô
;

367 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
‰om
->
gí_∑øms
, &
ô
);

369 
u_∑øm
 !
OSIP_SUCCESS
) {

370 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

371 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
) + 2;

374 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 3;

376 
Àn
 =Üí + 
∂í
;

377 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

378 
tmp
 = 
buf
;

379 
tmp
 =Åm∞+ 
	`°æí
(tmp);

381 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

382 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s", 
u_∑øm
->
g«me
);

385 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

387 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

390 *
de°
 = 
buf
;

391  
OSIP_SUCCESS
;

392 
	}
}

394 *
	$osù_‰om_gë_di•œy«me
(
osù_‰om_t
 *
‰om
) {

395 i‡(
‰om
 =
NULL
)

396  
NULL
;

398  
‰om
->
di•œy«me
;

399 
	}
}

401 
	$osù_‰om_£t_di•œy«me
(
osù_‰om_t
 *
‰om
, *
di•œy«me
) {

402 
‰om
->
di•œy«me
 = displayname;

403 
	}
}

405 
osù_uri_t
 *
	$osù_‰om_gë_uæ
(
osù_‰om_t
 *
‰om
) {

406 i‡(
‰om
 =
NULL
)

407  
NULL
;

409  
‰om
->
uæ
;

410 
	}
}

412 
	$osù_‰om_£t_uæ
(
osù_‰om_t
 *
‰om
, 
osù_uri_t
 *
uæ
) {

413 
‰om
->
uæ
 = url;

414 
	}
}

416 
	$osù_‰om_∑øm_gë
(
osù_‰om_t
 *
‰om
, 
pos
, 
osù_gíîic_∑øm_t
 **
Â¨am
) {

417 *
Â¨am
 = 
NULL
;

419 i‡(
‰om
 =
NULL
)

420  
OSIP_BADPARAMETER
;

422 i‡(
	`osù_li°_size
(&
‰om
->
gí_∑øms
Ë<
pos
)

423  
OSIP_UNDEFINED_ERROR
;

425 *
Â¨am
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë
(&
‰om
->
gí_∑øms
, 
pos
);

426  
pos
;

427 
	}
}

429 
	$osù_‰om_˛⁄e
(c⁄° 
osù_‰om_t
 *
‰om
, osù_‰om_à**
de°
) {

430 
i
;

431 
osù_‰om_t
 *
‰
;

433 *
de°
 = 
NULL
;

435 i‡(
‰om
 =
NULL
)

436  
OSIP_BADPARAMETER
;

438 
i
 = 
	`osù_‰om_öô
(&
‰
);

440 i‡(
i
 != 0)

441  
i
;

443 i‡(
‰om
->
di•œy«me
 !
NULL
) {

444 
‰
->
di•œy«me
 = 
	`osù_°rdup
(
‰om
->displayname);

446 i‡(
‰
->
di•œy«me
 =
NULL
) {

447 
	`osù_‰om_‰ì
(
‰
);

448  
OSIP_NOMEM
;

452 i‡(
‰om
->
uæ
 !
NULL
) {

453 
i
 = 
	`osù_uri_˛⁄e
(
‰om
->
uæ
, &(
‰
->url));

455 i‡(
i
 != 0) {

456 
	`osù_‰om_‰ì
(
‰
);

457  
i
;

461 
i
 = 
	`osù_li°_˛⁄e
(&
‰om
->
gí_∑øms
, &
‰
->gí_∑øms, ((*)(*, **)Ë& 
osù_gíîic_∑øm_˛⁄e
);

463 i‡(
i
 != 0) {

464 
	`osù_‰om_‰ì
(
‰
);

465  
i
;

468 *
de°
 = 
‰
;

469  
OSIP_SUCCESS
;

470 
	}
}

472 
	$osù_‰om_com∑ª
(
osù_‰om_t
 *
‰om1
, osù_‰om_à*
‰om2
) {

473 *
èg1
;

474 *
èg2
;

476 i‡(
‰om1
 =
NULL
 || 
‰om2
 == NULL)

477  
OSIP_BADPARAMETER
;

479 i‡(
‰om1
->
uæ
 =
NULL
 || 
‰om2
->url == NULL)

480  
OSIP_BADPARAMETER
;

484 i‡(
‰om1
->
uæ
->
ho°
 =
NULL
 && 
‰om2
->url->host == NULL) {

485 i‡(
‰om1
->
uæ
->
°rög
 =
NULL
 || 
‰om2
->url->string == NULL)

486  
OSIP_UNDEFINED_ERROR
;

488 i‡(0 =
	`°rcmp
(
‰om1
->
uæ
->
°rög
, 
‰om2
->url->string))

489  
OSIP_SUCCESS
;

492 i‡(
‰om1
->
uæ
->
ho°
 =
NULL
 || 
‰om2
->url->host == NULL)

493  
OSIP_UNDEFINED_ERROR
;

496 i‡(0 !
	`°rcmp
(
‰om1
->
uæ
->
ho°
, 
‰om2
->url->host))

497  
OSIP_UNDEFINED_ERROR
;

499 i‡(
‰om1
->
uæ
->
u£∫ame
 !
NULL
 && 
‰om2
->url->username != NULL)

500 i‡(0 !
	`°rcmp
(
‰om1
->
uæ
->
u£∫ame
, 
‰om2
->url->username))

501  
OSIP_UNDEFINED_ERROR
;

503 
èg1
 = 
NULL
;

504 
èg2
 = 
NULL
;

506 
osù_li°_ôî©‹_t
 
ô
;

507 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
‰om1
->
gí_∑øms
, &
ô
);

509 
u_∑øm
 !
OSIP_SUCCESS
) {

510 i‡(0 =
	`°∫cmp
(
u_∑øm
->
g«me
, "tag", 3)) {

511 
èg1
 = 
u_∑øm
->
gvÆue
;

515 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

519 
osù_li°_ôî©‹_t
 
ô
;

520 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
‰om2
->
gí_∑øms
, &
ô
);

522 
u_∑øm
 !
OSIP_SUCCESS
) {

523 i‡(0 =
	`°∫cmp
(
u_∑øm
->
g«me
, "tag", 3)) {

524 
èg2
 = 
u_∑øm
->
gvÆue
;

528 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

540 i‡(
èg1
 !
NULL
 && 
èg2
 != NULL)

541 i‡(0 !
	`°rcmp
(
èg1
, 
èg2
))

542  
OSIP_UNDEFINED_ERROR
;

547  
OSIP_SUCCESS
;

548 
	}
}

550 
	$__osù_gíîic_∑øm_∑r£Æl
(
osù_li°_t
 *
gí_∑øms
, c⁄° *
∑øms
) {

551 
i
;

552 *
≤ame
;

553 *
pvÆue
;

555 c⁄° *
comma
;

556 c⁄° *
equÆ
;

557 c⁄° *
°¨tquŸe
;

558 c⁄° *
ídquŸe
;

563 
equÆ
 = 
	`√xt_£∑øt‹
(
∑øms
 + 1, '=', ';');

564 
comma
 = 
	`°rchr
(
∑øms
 + 1, ';');

567 i‡(
equÆ
 !
NULL
) {

568 c⁄° *
tmp
;

570 
°¨tquŸe
 = 
NULL
;

572 
tmp
 = 
equÆ
 + 1;Åmp[0] == ' ';Åmp++) {

575 i‡(
tmp
[0] == '"')

576 
°¨tquŸe
 = 
tmp
;

578 i‡(
°¨tquŸe
 !
NULL
 && 
comma
 > startquote) {

579 
comma
 = 
NULL
;

580 
ídquŸe
 = 
	`__osù_quŸe_föd
(
°¨tquŸe
 + 1);

582 i‡(
ídquŸe
)

583 
comma
 = 
	`°rchr
(
ídquŸe
, ';');

587 
comma
 !
NULL
) {

588 i‡(
equÆ
 =
NULL
) {

589 
equÆ
 = 
comma
;

590 
pvÆue
 = 
NULL
;

593 c⁄° *
tmp
;

596 
tmp
 = 
equÆ
 + 1;

597 
tmp
 +
	`°r•n
(tmp, "\t ");

598 
pvÆue
 = 
NULL
;

600 i‡(*
tmp
 != ',' && *tmp != '\0') {

601 i‡(
comma
 - 
equÆ
 < 2)

602  
OSIP_SYNTAXERROR
;

604 
pvÆue
 = (*Ë
	`osù_mÆloc
(
comma
 - 
equÆ
);

606 i‡(
pvÆue
 =
NULL
)

607  
OSIP_NOMEM
;

609 
	`osù_°∫˝y
(
pvÆue
, 
equÆ
 + 1, 
comma
 -Équal - 1);

613 i‡(
equÆ
 - 
∑øms
 < 2) {

614 
	`osù_‰ì
(
pvÆue
);

615  
OSIP_SYNTAXERROR
;

618 
≤ame
 = (*Ë
	`osù_mÆloc
(
equÆ
 - 
∑øms
);

620 i‡(
≤ame
 =
NULL
) {

621 
	`osù_‰ì
(
pvÆue
);

622  
OSIP_NOMEM
;

625 
	`osù_°∫˝y
(
≤ame
, 
∑øms
 + 1, 
equÆ
 -Öarams - 1);

627 
i
 = 
	`osù_gíîic_∑øm_add
(
gí_∑øms
, 
≤ame
, 
pvÆue
);

629 i‡(
i
 !
OSIP_SUCCESS
) {

630 
	`osù_‰ì
(
≤ame
);

631 
	`osù_‰ì
(
pvÆue
);

632  
OSIP_NOMEM
;

635 
∑øms
 = 
comma
;

636 
equÆ
 = 
	`√xt_£∑øt‹
(
∑øms
 + 1, '=', ';');

637 
comma
 = 
	`°rchr
(
∑øms
 + 1, ';');

640 i‡(
equÆ
 !
NULL
) {

641 c⁄° *
tmp
;

643 
°¨tquŸe
 = 
NULL
;

645 
tmp
 = 
equÆ
 + 1;Åmp[0] == ' ';Åmp++) {

648 i‡(
tmp
[0] == '"')

649 
°¨tquŸe
 = 
tmp
;

651 i‡(
°¨tquŸe
 !
NULL
 && 
comma
 > startquote) {

652 
comma
 = 
NULL
;

653 
ídquŸe
 = 
	`__osù_quŸe_föd
(
°¨tquŸe
 + 1);

655 i‡(
ídquŸe
)

656 
comma
 = 
	`°rchr
(
ídquŸe
, ';');

662 
comma
 = 
∑øms
 + 
	`°æí
(params);

664 i‡(
equÆ
 =
NULL
) {

665 
equÆ
 = 
comma
;

666 
pvÆue
 = 
NULL
;

668 i‡(
equÆ
 - 
∑øms
 < 2) {

669 
	`osù_‰ì
(
pvÆue
);

670  
OSIP_SUCCESS
;

674 c⁄° *
tmp
;

677 
tmp
 = 
equÆ
 + 1;

678 
tmp
 +
	`°r•n
(tmp, "\t ");

679 
pvÆue
 = 
NULL
;

681 i‡(*
tmp
 != ',' && *tmp != '\0') {

682 i‡(
comma
 - 
equÆ
 < 2)

683  
OSIP_SYNTAXERROR
;

685 
pvÆue
 = (*Ë
	`osù_mÆloc
(
comma
 - 
equÆ
);

687 i‡(
pvÆue
 =
NULL
)

688  
OSIP_NOMEM
;

690 
	`osù_°∫˝y
(
pvÆue
, 
equÆ
 + 1, 
comma
 -Équal - 1);

694 i‡(
equÆ
 - 
∑øms
 < 2) {

695 
	`osù_‰ì
(
pvÆue
);

696  
OSIP_SYNTAXERROR
;

699 
≤ame
 = (*Ë
	`osù_mÆloc
(
equÆ
 - 
∑øms
);

701 i‡(
≤ame
 =
NULL
) {

702 
	`osù_‰ì
(
pvÆue
);

703  
OSIP_NOMEM
;

706 
	`osù_°∫˝y
(
≤ame
, 
∑øms
 + 1, 
equÆ
 -Öarams - 1);

708 
i
 = 
	`osù_gíîic_∑øm_add
(
gí_∑øms
, 
≤ame
, 
pvÆue
);

710 i‡(
i
 !
OSIP_SUCCESS
) {

711 
	`osù_‰ì
(
≤ame
);

712 
	`osù_‰ì
(
pvÆue
);

713  
OSIP_NOMEM
;

716  
OSIP_SUCCESS
;

717 
	}
}

719 
	$osù_gíîic_∑øm_£t_vÆue
(
osù_gíîic_∑øm_t
 *
Â¨am
, *
vÆue
) {

720 
Â¨am
->
gvÆue
 = 
vÆue
;

721 
	}
}

723 *
	$osù_gíîic_∑øm_gë_«me
(c⁄° 
osù_gíîic_∑øm_t
 *
Â¨am
) {

724 i‡(
Â¨am
 =
NULL
)

725  
NULL
;

727  
Â¨am
->
g«me
;

728 
	}
}

730 
	$osù_gíîic_∑øm_£t_«me
(
osù_gíîic_∑øm_t
 *
Â¨am
, *
«me
) {

731 
Â¨am
->
g«me
 = 
«me
;

732 
	}
}

734 *
	$osù_gíîic_∑øm_gë_vÆue
(c⁄° 
osù_gíîic_∑øm_t
 *
Â¨am
) {

735 i‡(
Â¨am
 =
NULL
)

736  
NULL
;

738 i‡(
Â¨am
->
g«me
 =
NULL
)

739  
NULL
;

741  
Â¨am
->
gvÆue
;

742 
	}
}

744 
	$osù_‰om_èg_m©ch
(
osù_‰om_t
 *
‰om1
, osù_‰om_à*
‰om2
) {

745 
osù_gíîic_∑øm_t
 *
èg_‰om1
;

746 
osù_gíîic_∑øm_t
 *
èg_‰om2
;

748 i‡(
‰om1
 =
NULL
 || 
‰om2
 == NULL)

749  
OSIP_BADPARAMETER
;

751 
	`osù_‰om_∑øm_gë_by«me
(
‰om1
, "èg", &
èg_‰om1
);

752 
	`osù_‰om_∑øm_gë_by«me
(
‰om2
, "èg", &
èg_‰om2
);

754 i‡(
èg_‰om1
 =
NULL
 && 
èg_‰om2
 == NULL)

755  
OSIP_SUCCESS
;

757 i‡((
èg_‰om1
 !
NULL
 && 
èg_‰om2
 == NULL) || (tag_from1 == NULL &&Åag_from2 != NULL))

758  
OSIP_UNDEFINED_ERROR
;

760 i‡(
èg_‰om1
->
gvÆue
 =
NULL
 || 
èg_‰om2
->gvalue == NULL)

761  
OSIP_UNDEFINED_ERROR
;

763 i‡(0 !
	`°rcmp
(
èg_‰om1
->
gvÆue
, 
èg_‰om2
->gvalue))

764  
OSIP_UNDEFINED_ERROR
;

766  
OSIP_SUCCESS
;

767 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_header.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

31 
	$osù_mesßge_£t_hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
) {

32 
osù_hódî_t
 *
h
;

33 
i
;

35 i‡(
sù
 =
NULL
 || 
h«me
 == NULL)

36  
OSIP_BADPARAMETER
;

38 
i
 = 
	`osù_hódî_öô
(&
h
);

40 i‡(
i
 != 0)

41  
i
;

43 
h
->
h«me
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hname) + 1);

45 i‡(
h
->
h«me
 =
NULL
) {

46 
	`osù_hódî_‰ì
(
h
);

47  
OSIP_NOMEM
;

50 
	`osù_˛∫˝y
(
h
->
h«me
, h«me, 
	`°æí
(hname));

52 i‡(
hvÆue
 !
NULL
) {

53 
h
->
hvÆue
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hvalue) + 1);

55 i‡(
h
->
hvÆue
 =
NULL
) {

56 
	`osù_hódî_‰ì
(
h
);

57  
OSIP_NOMEM
;

60 
	`osù_˛∫˝y
(
h
->
hvÆue
, hvÆue, 
	`°æí
(hvalue));

63 
h
->
hvÆue
 = 
NULL
;

65 
sù
->
mesßge_¥›îty
 = 2;

66 
	`osù_li°_add
(&
sù
->
hódîs
, 
h
, -1);

67  
OSIP_SUCCESS
;

68 
	}
}

75 
	$osù_mesßge_ª∂a˚_hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
) {

76 
osù_hódî_t
 *
h
, *
ﬁdh
;

77 
i
, 
ﬁdpos
 = -1;

79 i‡(
sù
 =
NULL
 || 
h«me
 == NULL)

80  
OSIP_BADPARAMETER
;

82 
ﬁdpos
 = 
	`osù_mesßge_hódî_gë_by«me
(
sù
, 
h«me
, 0, &
ﬁdh
);

84 
i
 = 
	`osù_hódî_öô
(&
h
);

86 i‡(
i
 != 0)

87  
i
;

89 
h
->
h«me
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hname) + 1);

91 i‡(
h
->
h«me
 =
NULL
) {

92 
	`osù_hódî_‰ì
(
h
);

93  
OSIP_NOMEM
;

96 
	`osù_˛∫˝y
(
h
->
h«me
, h«me, 
	`°æí
(hname));

98 i‡(
hvÆue
 !
NULL
) {

99 
h
->
hvÆue
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hvalue) + 1);

101 i‡(
h
->
hvÆue
 =
NULL
) {

102 
	`osù_hódî_‰ì
(
h
);

103  
OSIP_NOMEM
;

106 
	`osù_˛∫˝y
(
h
->
hvÆue
, hvÆue, 
	`°æí
(hvalue));

109 
h
->
hvÆue
 = 
NULL
;

111 i‡(
ﬁdpos
 != -1) {

112 
	`osù_li°_ªmove
(&
sù
->
hódîs
, 
ﬁdpos
);

113 
	`osù_hódî_‰ì
(
ﬁdh
);

116 
sù
->
mesßge_¥›îty
 = 2;

117 
	`osù_li°_add
(&
sù
->
hódîs
, 
h
, -1);

118  
OSIP_SUCCESS
;

119 
	}
}

121 #i‚de‡
MINISIZE


127 
	$osù_mesßge_£t_t›hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
) {

128 
osù_hódî_t
 *
h
;

129 
i
;

131 i‡(
sù
 =
NULL
 || 
h«me
 == NULL)

132  
OSIP_BADPARAMETER
;

134 
i
 = 
	`osù_hódî_öô
(&
h
);

136 i‡(
i
 != 0)

137  
i
;

139 
h
->
h«me
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hname) + 1);

141 i‡(
h
->
h«me
 =
NULL
) {

142 
	`osù_hódî_‰ì
(
h
);

143  
OSIP_NOMEM
;

146 
	`osù_˛∫˝y
(
h
->
h«me
, h«me, 
	`°æí
(hname));

148 i‡(
hvÆue
 !
NULL
) {

149 
h
->
hvÆue
 = (*Ë
	`osù_mÆloc
(
	`°æí
(hvalue) + 1);

151 i‡(
h
->
hvÆue
 =
NULL
) {

152 
	`osù_hódî_‰ì
(
h
);

153  
OSIP_NOMEM
;

156 
	`osù_˛∫˝y
(
h
->
hvÆue
, hvÆue, 
	`°æí
(hvalue));

159 
h
->
hvÆue
 = 
NULL
;

161 
sù
->
mesßge_¥›îty
 = 2;

162 
	`osù_li°_add
(&
sù
->
hódîs
, 
h
, 0);

163  
OSIP_SUCCESS
;

164 
	}
}

170 
	$osù_mesßge_gë_hódî
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_hódî_t
 **
de°
) {

171 *
de°
 = 
NULL
;

173 i‡(
	`osù_li°_size
(&
sù
->
hódîs
Ë<
pos
)

174  
OSIP_UNDEFINED_ERROR
;

176 *
de°
 = (
osù_hódî_t
 *Ë
	`osù_li°_gë
(&
sù
->
hódîs
, 
pos
);

177  
pos
;

178 
	}
}

186 
	$osù_mesßge_hódî_gë_by«me
(c⁄° 
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, 
pos
, 
osù_hódî_t
 **
de°
) {

187 
i
;

188 
osù_hódî_t
 *
tmp
;

190 *
de°
 = 
NULL
;

191 
i
 = 
pos
;

193 i‡(
	`osù_li°_size
(&
sù
->
hódîs
Ë<
pos
)

194  
OSIP_UNDEFINED_ERROR
;

196 
	`osù_li°_size
(&
sù
->
hódîs
Ë> 
i
) {

197 
tmp
 = (
osù_hódî_t
 *Ë
	`osù_li°_gë
(&
sù
->
hódîs
, 
i
);

199 i‡(
	`osù_°rˇ£cmp
(
tmp
->
h«me
, hname) == 0) {

200 *
de°
 = 
tmp
;

201  
i
;

204 
i
++;

207  
OSIP_UNDEFINED_ERROR
;

208 
	}
}

210 
	$osù_hódî_öô
(
osù_hódî_t
 **
hódî
) {

211 *
hódî
 = (
osù_hódî_t
 *Ë
	`osù_mÆloc
((osip_header_t));

213 i‡(*
hódî
 =
NULL
)

214  
OSIP_NOMEM
;

216 (*
hódî
)->
h«me
 = 
NULL
;

217 (*
hódî
)->
hvÆue
 = 
NULL
;

218  
OSIP_SUCCESS
;

219 
	}
}

221 
	$osù_hódî_‰ì
(
osù_hódî_t
 *
hódî
) {

222 i‡(
hódî
 =
NULL
)

225 
	`osù_‰ì
(
hódî
->
h«me
);

226 
	`osù_‰ì
(
hódî
->
hvÆue
);

227 
hódî
->
h«me
 = 
NULL
;

228 
hódî
->
hvÆue
 = 
NULL
;

230 
	`osù_‰ì
(
hódî
);

231 
	}
}

236 
	$osù_hódî_to_°r
(c⁄° 
osù_hódî_t
 *
hódî
, **
de°
) {

237 
size_t
 
Àn
, 
hÀn
;

239 *
de°
 = 
NULL
;

241 i‡((
hódî
 =
NULL
Ë|| (hódî->
h«me
 == NULL))

242  
OSIP_BADPARAMETER
;

244 
Àn
 = 0;

245 
hÀn
 = 
	`°æí
(
hódî
->
h«me
);

247 i‡(
hódî
->
hvÆue
 !
NULL
)

248 
Àn
 = 
	`°æí
(
hódî
->
hvÆue
);

250 *
de°
 = (*Ë
	`osù_mÆloc
(
hÀn
 + 
Àn
 + 3);

252 i‡(*
de°
 =
NULL
)

253  
OSIP_NOMEM
;

255 i‡(
hódî
->
hvÆue
 !
NULL
)

256 
	`¢¥ötf
(*
de°
, 
hÀn
 + 
Àn
 + 3, "%s: %s", 
hódî
->
h«me
, hódî->
hvÆue
);

259 
	`¢¥ötf
(*
de°
, 
hÀn
 + 
Àn
 + 3, "%s: ", 
hódî
->
h«me
);

261 i‡(*
de°
[0] >= 'a' && *dest[0] <= 'z')

262 *
de°
[0] = (*dest[0] - 32);

264  
OSIP_SUCCESS
;

265 
	}
}

267 *
	$osù_hódî_gë_«me
(c⁄° 
osù_hódî_t
 *
hódî
) {

268 i‡(
hódî
 =
NULL
)

269  
NULL
;

271  
hódî
->
h«me
;

272 
	}
}

274 
	$osù_hódî_£t_«me
(
osù_hódî_t
 *
hódî
, *
«me
) {

275 
hódî
->
h«me
 = 
«me
;

276 
	}
}

278 *
	$osù_hódî_gë_vÆue
(c⁄° 
osù_hódî_t
 *
hódî
) {

279 i‡(
hódî
 =
NULL
)

280  
NULL
;

282  
hódî
->
hvÆue
;

283 
	}
}

285 
	$osù_hódî_£t_vÆue
(
osù_hódî_t
 *
hódî
, *
vÆue
) {

286 
hódî
->
hvÆue
 = 
vÆue
;

287 
	}
}

289 
	$osù_hódî_˛⁄e
(c⁄° 
osù_hódî_t
 *
hódî
, osù_hódî_à**
de°
) {

290 
i
;

291 
osù_hódî_t
 *
he
;

293 *
de°
 = 
NULL
;

295 i‡(
hódî
 =
NULL
)

296  
OSIP_BADPARAMETER
;

298 i‡(
hódî
->
h«me
 =
NULL
)

299  
OSIP_BADPARAMETER
;

301 
i
 = 
	`osù_hódî_öô
(&
he
);

303 i‡(
i
 != 0)

304  
i
;

306 
he
->
h«me
 = 
	`osù_°rdup
(
hódî
->hname);

308 i‡(
he
->
h«me
 =
NULL
) {

309 
	`osù_hódî_‰ì
(
he
);

310  
OSIP_NOMEM
;

313 i‡(
hódî
->
hvÆue
 !
NULL
) {

314 
he
->
hvÆue
 = 
	`osù_°rdup
(
hódî
->hvalue);

316 i‡(
he
->
hvÆue
 =
NULL
) {

317 
	`osù_hódî_‰ì
(
he
);

318  
OSIP_NOMEM
;

322 *
de°
 = 
he
;

323  
OSIP_SUCCESS
;

324 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_list.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_li°.h
>

25 
	$osù_li°_öô
(
osù_li°_t
 *
li
) {

26 i‡(
li
 =
NULL
)

27  
OSIP_BADPARAMETER
;

29 
	`mem£t
(
li
, 0, (
osù_li°_t
));

30  
OSIP_SUCCESS
;

31 
	}
}

33 
	$osù_li°_˛⁄e
(c⁄° 
osù_li°_t
 *
§c
, osù_li°_à*
d°
, (*
˛⁄e_func
)(*, **)) {

34 *
d©a
;

35 *
d©a2
;

36 
i
;

37 
osù_li°_ôî©‹_t
 
ôî©‹
;

39 
d©a
 = 
	`osù_li°_gë_fú°
((
osù_li°_t
 *Ë
§c
, &
ôî©‹
); 
	`osù_li°_ôî©‹_has_ñem
(ôî©‹); d©®
	`osù_li°_gë_√xt
(&iterator)) {

40 
i
 = 
	`˛⁄e_func
(
d©a
, &
d©a2
);

42 i‡(
i
 != 0)

43  
i
;

45 
	`osù_li°_add
(
d°
, 
d©a2
, -1);

48  
OSIP_SUCCESS
;

49 
	}
}

51 
	$osù_li°_•ecül_‰ì
(
osù_li°_t
 *
li
, (*
‰ì_func
)(*)) {

52 *
ñemít
;

54 i‡(
li
 =
NULL
)

57 !
	`osù_li°_eﬁ
(
li
, 0)) {

58 
ñemít
 = (*Ë
	`osù_li°_gë
(
li
, 0);

59 
	`osù_li°_ªmove
(
li
, 0);

61 i‡(
‰ì_func
 !
NULL
)

62 
	`‰ì_func
(
ñemít
);

64 
	}
}

66 
	$osù_li°_ofch¨_‰ì
(
osù_li°_t
 *
li
) {

67 *
chaö
;

69 i‡(
li
 =
NULL
)

72 !
	`osù_li°_eﬁ
(
li
, 0)) {

73 
chaö
 = (*Ë
	`osù_li°_gë
(
li
, 0);

74 
	`osù_li°_ªmove
(
li
, 0);

75 
	`osù_‰ì
(
chaö
);

77 
	}
}

79 
	$osù_li°_size
(c⁄° 
osù_li°_t
 *
li
) {

80 i‡(
li
 =
NULL
)

81  
OSIP_BADPARAMETER
;

83  
li
->
nb_ñt
;

84 
	}
}

86 
	$osù_li°_eﬁ
(c⁄° 
osù_li°_t
 *
li
, 
i
) {

87 i‡(
li
 =
NULL
)

88  
OSIP_BADPARAMETER
;

90 i‡(
i
 < 
li
->
nb_ñt
)

91  
OSIP_SUCCESS
;

94 
	}
}

97 
	$osù_li°_add
(
osù_li°_t
 *
li
, *
ñ
, 
pos
) {

98 
__node_t
 *
¡mp
;

99 
i
 = 0;

101 i‡(
li
 =
NULL
)

102  
OSIP_BADPARAMETER
;

104 i‡(
li
->
nb_ñt
 == 0) {

105 
li
->
node
 = (
__node_t
 *Ë
	`osù_mÆloc
((__node_t));

107 i‡(
li
->
node
 =
NULL
)

108  
OSIP_NOMEM
;

110 
li
->
node
->
ñemít
 = 
ñ
;

111 
li
->
node
->
√xt
 = 
NULL
;

112 
li
->
nb_ñt
++;

113  
li
->
nb_ñt
;

116 i‡(
pos
 =-1 ||Öo†>
li
->
nb_ñt
) {

117 
pos
 = 
li
->
nb_ñt
;

120 
¡mp
 = 
li
->
node
;

122 i‡(
pos
 == 0) {

123 
li
->
node
 = (
__node_t
 *Ë
	`osù_mÆloc
((__node_t));

125 i‡(
li
->
node
 =
NULL
) {

127 
li
->
node
 = 
¡mp
;

128  
OSIP_NOMEM
;

131 
li
->
node
->
ñemít
 = 
ñ
;

132 
li
->
node
->
√xt
 = 
¡mp
;

133 
li
->
nb_ñt
++;

134  
li
->
nb_ñt
;

137 
pos
 > 
i
 + 1) {

138 
i
++;

140 
¡mp
 =Çtmp->
√xt
;

144 i‡(
pos
 =
li
->
nb_ñt
) {

145 
¡mp
->
√xt
 = 
	`osù_mÆloc
((
__node_t
));

147 i‡(
¡mp
->
√xt
 =
NULL
)

148  
OSIP_NOMEM
;

150 
¡mp
 =Çtmp->
√xt
;

151 
¡mp
->
ñemít
 = 
ñ
;

152 
¡mp
->
√xt
 = 
NULL
;

153 
li
->
nb_ñt
++;

154  
li
->
nb_ñt
;

159 
__node_t
 *
√xäode
 = 
¡mp
->
√xt
;

161 
¡mp
->
√xt
 = 
	`osù_mÆloc
((
__node_t
));

163 i‡(
¡mp
->
√xt
 =
NULL
) {

165 
¡mp
->
√xt
 = 
√xäode
;

166  
OSIP_NOMEM
;

169 
¡mp
 =Çtmp->
√xt
;

170 
¡mp
->
ñemít
 = 
ñ
;

171 
¡mp
->
√xt
 = 
√xäode
;

172 
li
->
nb_ñt
++;

174  
li
->
nb_ñt
;

175 
	}
}

178 *
	$osù_li°_gë
(c⁄° 
osù_li°_t
 *
li
, 
pos
) {

179 
__node_t
 *
¡mp
;

180 
i
 = 0;

182 i‡(
li
 =
NULL
)

183  
NULL
;

185 i‡(
pos
 < 0 ||Öo†>
li
->
nb_ñt
)

187  
NULL
;

189 
¡mp
 = 
li
->
node
;

191 
pos
 > 
i
) {

192 
i
++;

193 
¡mp
 =Çtmp->
√xt
;

196  
¡mp
->
ñemít
;

197 
	}
}

200 *
	$osù_li°_gë_fú°
(c⁄° 
osù_li°_t
 *
li
, 
osù_li°_ôî©‹_t
 *
ôî©‹
) {

201 i‡(
li
 =
NULL
 || 0 >li->
nb_ñt
) {

202 
ôî©‹
->
a˘uÆ
 = 0;

203  
OSIP_SUCCESS
;

206 
ôî©‹
->
a˘uÆ
 = 
li
->
node
;

207 
ôî©‹
->
¥ev
 = (
__node_t
 **Ë&
li
->
node
;

208 
ôî©‹
->
li
 = (
osù_li°_t
 *)Üi;

209 
ôî©‹
->
pos
 = 0;

211  
li
->
node
->
ñemít
;

212 
	}
}

215 *
	$osù_li°_gë_√xt
(
osù_li°_ôî©‹_t
 *
ôî©‹
) {

216 i‡(
ôî©‹
->
a˘uÆ
 =
NULL
) {

217  
OSIP_SUCCESS
;

220 
ôî©‹
->
¥ev
 = &(ôî©‹->
a˘uÆ
->
√xt
);

221 
ôî©‹
->
a˘uÆ
 = iãøt‹->a˘uÆ->
√xt
;

222 ++(
ôî©‹
->
pos
);

224 i‡(
	`osù_li°_ôî©‹_has_ñem
(*
ôî©‹
)) {

225  
ôî©‹
->
a˘uÆ
->
ñemít
;

228 
ôî©‹
->
a˘uÆ
 = 0;

229  
OSIP_SUCCESS
;

230 
	}
}

233 *
	$osù_li°_ôî©‹_ªmove
(
osù_li°_ôî©‹_t
 *
ôî©‹
) {

234 i‡(
	`osù_li°_ôî©‹_has_ñem
(*
ôî©‹
)) {

235 --(
ôî©‹
->
li
->
nb_ñt
);

237 *(
ôî©‹
->
¥ev
Ëôî©‹->
a˘uÆ
->
√xt
;

239 
	`osù_‰ì
(
ôî©‹
->
a˘uÆ
);

240 
ôî©‹
->
a˘uÆ
 = *(ôî©‹->
¥ev
);

243 i‡(
	`osù_li°_ôî©‹_has_ñem
(*
ôî©‹
)) {

244  
ôî©‹
->
a˘uÆ
->
ñemít
;

247  
OSIP_SUCCESS
;

248 
	}
}

251 
	$osù_li°_ªmove
(
osù_li°_t
 *
li
, 
pos
) {

252 
__node_t
 *
¡mp
;

253 
i
 = 0;

255 i‡(
li
 =
NULL
)

256  
OSIP_BADPARAMETER
;

258 i‡(
pos
 < 0 ||Öo†>
li
->
nb_ñt
)

260  
OSIP_UNDEFINED_ERROR
;

262 
¡mp
 = 
li
->
node
;

264 i‡(
pos
 == 0) {

265 
li
->
node
 = 
¡mp
->
√xt
;

266 
li
->
nb_ñt
--;

267 
	`osù_‰ì
(
¡mp
);

268  
li
->
nb_ñt
;

271 
pos
 > 
i
 + 1) {

272 
i
++;

273 
¡mp
 =Çtmp->
√xt
;

278 
__node_t
 *
ªmnode
;

280 
ªmnode
 = 
¡mp
->
√xt
;

281 
¡mp
->
√xt
 = (ntmp->next)->next;

282 
	`osù_‰ì
(
ªmnode
);

283 
li
->
nb_ñt
--;

285  
li
->
nb_ñt
;

286 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_md5c.c

34 #i‚de‡
NO_MD5_SUPPORT


36 
	~<osù∑r£r2/osù_md5.h
>

41 
	#S11
 7

	)

42 
	#S12
 12

	)

43 
	#S13
 17

	)

44 
	#S14
 22

	)

45 
	#S21
 5

	)

46 
	#S22
 9

	)

47 
	#S23
 14

	)

48 
	#S24
 20

	)

49 
	#S31
 4

	)

50 
	#S32
 11

	)

51 
	#S33
 16

	)

52 
	#S34
 23

	)

53 
	#S41
 6

	)

54 
	#S42
 10

	)

55 
	#S43
 15

	)

56 
	#S44
 21

	)

58 
osù_MD5Tønsf‹m
 
PROTO_LIST
((
UINT4
[4], [64]));

59 
osù_Encode
 
PROTO_LIST
((*, 
UINT4
 *, ) );

60 
osù_Decode
 
PROTO_LIST
((
UINT4
 *, *, ) );

61 
osù_MD5_mem˝y
 
PROTO_LIST
((
POINTER
, POINTER, ) );

62 
osù_MD5_mem£t
 
PROTO_LIST
((
POINTER
, , ) );

64 
	gPADDING
[64] = {0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

68 
	#F
(
x
, 
y
, 
z
Ë(((xË& (y)Ë| ((~xË& (z)))

	)

69 
	#G
(
x
, 
y
, 
z
Ë(((xË& (z)Ë| ((yË& (~z)))

	)

70 
	#H
(
x
, 
y
, 
z
Ë((xË^ (yË^ (z))

	)

71 
	#I
(
x
, 
y
, 
z
Ë((yË^ ((xË| (~z)))

	)

75 
	#ROTATE_LEFT
(
x
, 
n
Ë(((xË<< (n)Ë| ((xË>> (32 - (n))))

	)

80 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

82 (
a
Ë+
	`F
((
b
), (
c
), (
d
)Ë+ (
x
Ë+ (
UINT4
)(
ac
); \

83 (
a
Ë
	`ROTATE_LEFT
(◊), (
s
)); \

84 (
a
Ë+(
b
); \

85 }

	)

86 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

88 (
a
Ë+
	`G
((
b
), (
c
), (
d
)Ë+ (
x
Ë+ (
UINT4
)(
ac
); \

89 (
a
Ë
	`ROTATE_LEFT
(◊), (
s
)); \

90 (
a
Ë+(
b
); \

91 }

	)

92 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

94 (
a
Ë+
	`H
((
b
), (
c
), (
d
)Ë+ (
x
Ë+ (
UINT4
)(
ac
); \

95 (
a
Ë
	`ROTATE_LEFT
(◊), (
s
)); \

96 (
a
Ë+(
b
); \

97 }

	)

98 
	#II
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

100 (
a
Ë+
	`I
((
b
), (
c
), (
d
)Ë+ (
x
Ë+ (
UINT4
)(
ac
); \

101 (
a
Ë
	`ROTATE_LEFT
(◊), (
s
)); \

102 (
a
Ë+(
b
); \

103 }

	)

107 
	$osù_MD5Inô
(
osù_MD5_CTX
 *
c⁄ãxt


109 
c⁄ãxt
->
cou¡
[0] = context->count[1] = 0;

112 
c⁄ãxt
->
°©e
[0] = 0x67452301;

113 
c⁄ãxt
->
°©e
[1] = 0xefcdab89;

114 
c⁄ãxt
->
°©e
[2] = 0x98badcfe;

115 
c⁄ãxt
->
°©e
[3] = 0x10325476;

116 
	}
}

122 
	$osù_MD5Upd©e
(
osù_MD5_CTX
 *
c⁄ãxt
,

123 *
öput
,

124 
öputLí


126 
i
, 
ödex
, 
∑πLí
;

129 
ödex
 = (Ë((
c⁄ãxt
->
cou¡
[0] >> 3) & 0x3F);

132 i‡((
c⁄ãxt
->
cou¡
[0] +((
UINT4
Ë
öputLí
 << 3)) < ((UINT4) inputLen << 3))

133 
c⁄ãxt
->
cou¡
[1]++;

135 
c⁄ãxt
->
cou¡
[1] +((
UINT4
Ë
öputLí
 >> 29);

137 
∑πLí
 = 64 - 
ödex
;

141 i‡(
öputLí
 >
∑πLí
) {

142 
	`osù_MD5_mem˝y
((
POINTER
Ë&
c⁄ãxt
->
buf„r
[
ödex
], (POINTERË
öput
, 
∑πLí
);

143 
	`osù_MD5Tønsf‹m
(
c⁄ãxt
->
°©e
, c⁄ãxt->
buf„r
);

145 
i
 = 
∑πLí
; i + 63 < 
öputLí
; i += 64)

146 
	`osù_MD5Tønsf‹m
(
c⁄ãxt
->
°©e
, &
öput
[
i
]);

148 
ödex
 = 0;

151 
i
 = 0;

154 
	`osù_MD5_mem˝y
((
POINTER
Ë&
c⁄ãxt
->
buf„r
[
ödex
], (POINTERË&
öput
[
i
], 
öputLí
 - i);

155 
	}
}

160 
	$osù_MD5FöÆ
(
dige°
[16],

161 
osù_MD5_CTX
 *
c⁄ãxt


163 
bôs
[8];

164 
ödex
, 
∑dLí
;

167 
	`osù_Encode
(
bôs
, 
c⁄ãxt
->
cou¡
, 8);

171 
ödex
 = (Ë((
c⁄ãxt
->
cou¡
[0] >> 3) & 0x3f);

172 
∑dLí
 = (
ödex
 < 56) ? (56 - index) : (120 - index);

173 
	`osù_MD5Upd©e
(
c⁄ãxt
, 
PADDING
, 
∑dLí
);

176 
	`osù_MD5Upd©e
(
c⁄ãxt
, 
bôs
, 8);

179 
	`osù_Encode
(
dige°
, 
c⁄ãxt
->
°©e
, 16);

183 
	`osù_MD5_mem£t
((
POINTER
Ë
c⁄ãxt
, 0, (*context));

184 
	}
}

188 
	$osù_MD5Tønsf‹m
(
UINT4
 
°©e
[4], 
block
[64]) {

189 
UINT4
 
a
 = 
°©e
[0], 
b
 = sèã[1], 
c
 = sèã[2], 
d
 = sèã[3], 
x
[16];

191 
	`osù_Decode
(
x
, 
block
, 64);

194 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[0], 
S11
, 0xd76aa478);

195 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[1], 
S12
, 0xe8c7b756);

196 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[2], 
S13
, 0x242070db);

197 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[3], 
S14
, 0xc1bdceee);

198 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[4], 
S11
, 0xf57c0faf);

199 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[5], 
S12
, 0x4787c62a);

200 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[6], 
S13
, 0xa8304613);

201 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[7], 
S14
, 0xfd469501);

202 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[8], 
S11
, 0x698098d8);

203 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[9], 
S12
, 0x8b44f7af);

204 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[10], 
S13
, 0xffff5bb1);

205 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[11], 
S14
, 0x895cd7be);

206 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[12], 
S11
, 0x6b901122);

207 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[13], 
S12
, 0xfd987193);

208 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[14], 
S13
, 0xa679438e);

209 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[15], 
S14
, 0x49b40821);

212 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[1], 
S21
, 0xf61e2562);

213 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[6], 
S22
, 0xc040b340);

214 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[11], 
S23
, 0x265e5a51);

215 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[0], 
S24
, 0xe9b6c7aa);

216 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[5], 
S21
, 0xd62f105d);

217 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[10], 
S22
, 0x2441453);

218 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[15], 
S23
, 0xd8a1e681);

219 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[4], 
S24
, 0xe7d3fbc8);

220 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[9], 
S21
, 0x21e1cde6);

221 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[14], 
S22
, 0xc33707d6);

222 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[3], 
S23
, 0xf4d50d87);

223 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[8], 
S24
, 0x455a14ed);

224 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[13], 
S21
, 0xa9e3e905);

225 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[2], 
S22
, 0xfcefa3f8);

226 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[7], 
S23
, 0x676f02d9);

227 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[12], 
S24
, 0x8d2a4c8a);

230 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[5], 
S31
, 0xfffa3942);

231 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[8], 
S32
, 0x8771f681);

232 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[11], 
S33
, 0x6d9d6122);

233 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[14], 
S34
, 0xfde5380c);

234 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[1], 
S31
, 0xa4beea44);

235 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[4], 
S32
, 0x4bdecfa9);

236 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[7], 
S33
, 0xf6bb4b60);

237 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[10], 
S34
, 0xbebfbc70);

238 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[13], 
S31
, 0x289b7ec6);

239 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[0], 
S32
, 0xeaa127fa);

240 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[3], 
S33
, 0xd4ef3085);

241 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[6], 
S34
, 0x4881d05);

242 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[9], 
S31
, 0xd9d4d039);

243 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[12], 
S32
, 0xe6db99e5);

244 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[15], 
S33
, 0x1fa27cf8);

245 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[2], 
S34
, 0xc4ac5665);

248 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[0], 
S41
, 0xf4292244);

249 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[7], 
S42
, 0x432aff97);

250 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[14], 
S43
, 0xab9423a7);

251 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[5], 
S44
, 0xfc93a039);

252 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[12], 
S41
, 0x655b59c3);

253 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[3], 
S42
, 0x8f0ccc92);

254 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[10], 
S43
, 0xffeff47d);

255 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[1], 
S44
, 0x85845dd1);

256 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[8], 
S41
, 0x6fa87e4f);

257 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[15], 
S42
, 0xfe2ce6e0);

258 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[6], 
S43
, 0xa3014314);

259 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[13], 
S44
, 0x4e0811a1);

260 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[4], 
S41
, 0xf7537e82);

261 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[11], 
S42
, 0xbd3af235);

262 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[2], 
S43
, 0x2ad7d2bb);

263 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[9], 
S44
, 0xeb86d391);

265 
°©e
[0] +
a
;

266 
°©e
[1] +
b
;

267 
°©e
[2] +
c
;

268 
°©e
[3] +
d
;

272 
	`osù_MD5_mem£t
((
POINTER
Ë
x
, 0, (x));

273 
	}
}

278 
	$osù_Encode
(*
ouçut
, 
UINT4
 *
öput
, 
Àn
) {

279 
i
, 
j
;

281 
i
 = 0, 
j
 = 0; j < 
Àn
; i++, j += 4) {

282 
ouçut
[
j
] = (Ë(
öput
[
i
] & 0xff);

283 
ouçut
[
j
 + 1] = (Ë((
öput
[
i
] >> 8) & 0xff);

284 
ouçut
[
j
 + 2] = (Ë((
öput
[
i
] >> 16) & 0xff);

285 
ouçut
[
j
 + 3] = (Ë((
öput
[
i
] >> 24) & 0xff);

287 
	}
}

292 
	$osù_Decode
(
UINT4
 *
ouçut
, *
öput
, 
Àn
) {

293 
i
, 
j
;

295 
i
 = 0, 
j
 = 0; j < 
Àn
; i++, j += 4)

296 
ouçut
[
i
] = ((
UINT4
Ë
öput
[
j
]) | (((UINT4) input[j + 1]) << 8) | (((UINT4) input[j + 2]) << 16) | (((UINT4) input[j + 3]) << 24);

297 
	}
}

302 
	$osù_MD5_mem˝y
(
POINTER
 
ouçut
, POINTER 
öput
, 
Àn
) {

303 
i
;

305 
i
 = 0; i < 
Àn
; i++)

306 
ouçut
[
i
] = 
öput
[i];

307 
	}
}

311 
	$osù_MD5_mem£t
(
POINTER
 
ouçut
, 
vÆue
, 
Àn
) {

312 
i
;

314 
i
 = 0; i < 
Àn
; i++)

315 ((*Ë
ouçut
)[
i
] = (Ë
vÆue
;

316 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

27 c⁄° *
	gosù_¥Ÿocﬁ_vîsi⁄
 = "SIP/2.0";

29 
	$osù_mesßge_öô
(
osù_mesßge_t
 **
sù
) {

30 *
sù
 = (
osù_mesßge_t
 *Ë
	`osù_mÆloc
((osip_message_t));

32 i‡(*
sù
 =
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
sù
, 0, (
osù_mesßge_t
));

37 #i‚de‡
MINISIZE


38 
	`osù_li°_öô
(&(*
sù
)->
ac˚±s
);

39 
	`osù_li°_öô
(&(*
sù
)->
ac˚±_ícodögs
);

41 
	`osù_li°_öô
(&(*
sù
)->
ac˚±_œnguages
);

42 
	`osù_li°_öô
(&(*
sù
)->
Æît_öfos
);

43 
	`osù_li°_öô
(&(*
sù
)->
Ælows
);

44 
	`osù_li°_öô
(&(*
sù
)->
authítiˇti⁄_öfos
);

46 
	`osù_li°_öô
(&(*
sù
)->
auth‹iz©i⁄s
);

47 (*
sù
)->
ˇŒ_id
 = 
NULL
;

48 
	`osù_li°_öô
(&(*
sù
)->
ˇŒ_öfos
);

49 
	`osù_li°_öô
(&(*
sù
)->
c⁄è˘s
);

51 #i‚de‡
MINISIZE


52 
	`osù_li°_öô
(&(*
sù
)->
c⁄ã¡_ícodögs
);

54 (*
sù
)->
c⁄ã¡_Àngth
 = 
NULL
;

55 (*
sù
)->
c⁄ã¡_ty≥
 = 
NULL
;

56 (*
sù
)->
c£q
 = 
NULL
;

57 #i‚de‡
MINISIZE


58 
	`osù_li°_öô
(&(*
sù
)->
îr‹_öfos
);

60 (*
sù
)->
‰om
 = 
NULL
;

61 (*
sù
)->
mime_vîsi⁄
 = 
NULL
;

62 
	`osù_li°_öô
(&(*
sù
)->
¥oxy_authítiˇãs
);

63 #i‚de‡
MINISIZE


64 
	`osù_li°_öô
(&(*
sù
)->
¥oxy_authítiˇti⁄_öfos
);

66 
	`osù_li°_öô
(&(*
sù
)->
¥oxy_auth‹iz©i⁄s
);

67 
	`osù_li°_öô
(&(*
sù
)->
ªc‹d_rouãs
);

68 
	`osù_li°_öô
(&(*
sù
)->
rouãs
);

69 (*
sù
)->
to
 = 
NULL
;

70 
	`osù_li°_öô
(&(*
sù
)->
vüs
);

71 
	`osù_li°_öô
(&(*
sù
)->
www_authítiˇãs
);

73 
	`osù_li°_öô
(&(*
sù
)->
bodõs
);

75 
	`osù_li°_öô
(&(*
sù
)->
hódîs
);

77 (*
sù
)->
mesßge_¥›îty
 = 3;

78 (*
sù
)->
mesßge
 = 
NULL
;

79 (*
sù
)->
mesßge_Àngth
 = 0;

81 (*
sù
)->
≠∂iˇti⁄_d©a
 = 
NULL
;

82  
OSIP_SUCCESS
;

83 
	}
}

85 
	$osù_mesßge_£t_ªas⁄_phø£
(
osù_mesßge_t
 *
sù
, *
ªas⁄
) {

86 
sù
->
ªas⁄_phø£
 = 
ªas⁄
;

87 
	}
}

89 
	$osù_mesßge_£t_°©us_code
(
osù_mesßge_t
 *
sù
, 
°©us_code
) {

90 
sù
->
°©us_code
 = status_code;

91 
	}
}

93 
	$osù_mesßge_£t_mëhod
(
osù_mesßge_t
 *
sù
, *
sù_mëhod
) {

94 
sù
->
sù_mëhod
 = sip_method;

95 
	}
}

97 
	$osù_mesßge_£t_vîsi⁄
(
osù_mesßge_t
 *
sù
, *
sù_vîsi⁄
) {

98 
sù
->
sù_vîsi⁄
 = sip_version;

99 
	}
}

101 
	$osù_mesßge_£t_uri
(
osù_mesßge_t
 *
sù
, 
osù_uri_t
 *
uæ
) {

102 
sù
->
ªq_uri
 = 
uæ
;

103 
	}
}

105 
	$osù_mesßge_‰ì
(
osù_mesßge_t
 *
sù
) {

106 i‡(
sù
 =
NULL
)

109 
	`osù_‰ì
(
sù
->
sù_mëhod
);

110 
	`osù_‰ì
(
sù
->
sù_vîsi⁄
);

112 i‡(
sù
->
ªq_uri
 !
NULL
)

113 
	`osù_uri_‰ì
(
sù
->
ªq_uri
);

115 
	`osù_‰ì
(
sù
->
ªas⁄_phø£
);

117 #i‚de‡
MINISIZE


118 
	`osù_li°_•ecül_‰ì
(&
sù
->
ac˚±s
, ((*)(*)Ë& 
osù_ac˚±_‰ì
);

120 
	`osù_li°_•ecül_‰ì
(&
sù
->
auth‹iz©i⁄s
, ((*)(*)Ë& 
osù_auth‹iz©i⁄_‰ì
);

122 i‡(
sù
->
ˇŒ_id
 !
NULL
)

123 
	`osù_ˇŒ_id_‰ì
(
sù
->
ˇŒ_id
);

125 #i‚de‡
MINISIZE


126 
	`osù_li°_•ecül_‰ì
(&
sù
->
ac˚±_ícodögs
, ((*)(*)Ë& 
osù_ac˚±_ícodög_‰ì
);

127 
	`osù_li°_•ecül_‰ì
(&
sù
->
ac˚±_œnguages
, ((*)(*)Ë& 
osù_ac˚±_œnguage_‰ì
);

128 
	`osù_li°_•ecül_‰ì
(&
sù
->
Æît_öfos
, ((*)(*)Ë& 
osù_Æît_öfo_‰ì
);

129 
	`osù_li°_•ecül_‰ì
(&
sù
->
Ælows
, ((*)(*)Ë& 
osù_Ælow_‰ì
);

130 
	`osù_li°_•ecül_‰ì
(&
sù
->
authítiˇti⁄_öfos
, ((*)(*)Ë& 
osù_authítiˇti⁄_öfo_‰ì
);

131 
	`osù_li°_•ecül_‰ì
(&
sù
->
c⁄ã¡_ícodögs
, ((*)(*)Ë& 
osù_c⁄ã¡_ícodög_‰ì
);

132 
	`osù_li°_•ecül_‰ì
(&
sù
->
îr‹_öfos
, ((*)(*)Ë& 
osù_îr‹_öfo_‰ì
);

133 
	`osù_li°_•ecül_‰ì
(&
sù
->
¥oxy_authítiˇti⁄_öfos
, ((*)(*)Ë& 
osù_¥oxy_authítiˇti⁄_öfo_‰ì
);

135 
	`osù_li°_•ecül_‰ì
(&
sù
->
ˇŒ_öfos
, ((*)(*)Ë& 
osù_ˇŒ_öfo_‰ì
);

136 
	`osù_li°_•ecül_‰ì
(&
sù
->
c⁄è˘s
, ((*)(*)Ë& 
osù_c⁄è˘_‰ì
);

138 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
)

139 
	`osù_c⁄ã¡_Àngth_‰ì
(
sù
->
c⁄ã¡_Àngth
);

141 i‡(
sù
->
c⁄ã¡_ty≥
 !
NULL
)

142 
	`osù_c⁄ã¡_ty≥_‰ì
(
sù
->
c⁄ã¡_ty≥
);

144 i‡(
sù
->
c£q
 !
NULL
)

145 
	`osù_c£q_‰ì
(
sù
->
c£q
);

147 i‡(
sù
->
‰om
 !
NULL
)

148 
	`osù_‰om_‰ì
(
sù
->
‰om
);

150 i‡(
sù
->
mime_vîsi⁄
 !
NULL
)

151 
	`osù_mime_vîsi⁄_‰ì
(
sù
->
mime_vîsi⁄
);

153 
	`osù_li°_•ecül_‰ì
(&
sù
->
¥oxy_authítiˇãs
, ((*)(*)Ë& 
osù_¥oxy_authítiˇã_‰ì
);

154 
	`osù_li°_•ecül_‰ì
(&
sù
->
¥oxy_auth‹iz©i⁄s
, ((*)(*)Ë& 
osù_¥oxy_auth‹iz©i⁄_‰ì
);

155 
	`osù_li°_•ecül_‰ì
(&
sù
->
ªc‹d_rouãs
, ((*)(*)Ë& 
osù_ªc‹d_rouã_‰ì
);

156 
	`osù_li°_•ecül_‰ì
(&
sù
->
rouãs
, ((*)(*)Ë& 
osù_rouã_‰ì
);

158 i‡(
sù
->
to
 !
NULL
)

159 
	`osù_to_‰ì
(
sù
->
to
);

161 
	`osù_li°_•ecül_‰ì
(&
sù
->
vüs
, ((*)(*)Ë& 
osù_vü_‰ì
);

162 
	`osù_li°_•ecül_‰ì
(&
sù
->
www_authítiˇãs
, ((*)(*)Ë& 
osù_www_authítiˇã_‰ì
);

163 
	`osù_li°_•ecül_‰ì
(&
sù
->
hódîs
, ((*)(*)Ë& 
osù_hódî_‰ì
);

164 
	`osù_li°_•ecül_‰ì
(&
sù
->
bodõs
, ((*)(*)Ë& 
osù_body_‰ì
);

165 
	`osù_‰ì
(
sù
->
mesßge
);

166 
	`osù_‰ì
(
sù
);

167 
	}
}

169 
	$osù_mesßge_˛⁄e
(c⁄° 
osù_mesßge_t
 *
sù
, osù_mesßge_à**
de°
) {

170 
osù_mesßge_t
 *
c›y
;

171 
i
;

173 *
de°
 = 
NULL
;

175 i‡(
sù
 =
NULL
)

176  
OSIP_BADPARAMETER
;

178 
i
 = 
	`osù_mesßge_öô
(&
c›y
);

180 i‡(
i
 != 0)

181  
i
;

183 
c›y
->
sù_mëhod
 = 
	`osù_°rdup
(
sù
->sip_method);

185 i‡(
sù
->
sù_mëhod
 !
NULL
 && 
c›y
->sip_method == NULL) {

186 
	`osù_mesßge_‰ì
(
c›y
);

187  
OSIP_NOMEM
;

190 
c›y
->
sù_vîsi⁄
 = 
	`osù_°rdup
(
sù
->sip_version);

192 i‡(
sù
->
sù_vîsi⁄
 !
NULL
 && 
c›y
->sip_version == NULL) {

193 
	`osù_mesßge_‰ì
(
c›y
);

194  
OSIP_NOMEM
;

197 
c›y
->
°©us_code
 = 
sù
->status_code;

198 
c›y
->
ªas⁄_phø£
 = 
	`osù_°rdup
(
sù
->reason_phrase);

200 i‡(
sù
->
ªas⁄_phø£
 !
NULL
 && 
c›y
->reason_phrase == NULL) {

201 
	`osù_mesßge_‰ì
(
c›y
);

202  
OSIP_NOMEM
;

205 i‡(
sù
->
ªq_uri
 !
NULL
) {

206 
i
 = 
	`osù_uri_˛⁄e
(
sù
->
ªq_uri
, &(
c›y
->req_uri));

208 i‡(
i
 != 0) {

209 
	`osù_mesßge_‰ì
(
c›y
);

210  
i
;

214 #i‚de‡
MINISIZE


215 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
ac˚±s
, &
c›y
->ac˚±s, ((*)(*, **)Ë& 
osù_ac˚±_˛⁄e
);

217 i‡(
i
 != 0) {

218 
	`osù_mesßge_‰ì
(
c›y
);

219  
i
;

222 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
ac˚±_ícodögs
, &
c›y
->ac˚±_ícodögs, ((*)(*, **)Ë& 
osù_ac˚±_ícodög_˛⁄e
);

224 i‡(
i
 != 0) {

225 
	`osù_mesßge_‰ì
(
c›y
);

226  
i
;

229 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
ac˚±_œnguages
, &
c›y
->ac˚±_œnguages, ((*)(*, **)Ë& 
osù_ac˚±_œnguage_˛⁄e
);

231 i‡(
i
 != 0) {

232 
	`osù_mesßge_‰ì
(
c›y
);

233  
i
;

236 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
Æît_öfos
, &
c›y
->Æît_öfos, ((*)(*, **)Ë& 
osù_Æît_öfo_˛⁄e
);

238 i‡(
i
 != 0) {

239 
	`osù_mesßge_‰ì
(
c›y
);

240  
i
;

243 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
Ælows
, &
c›y
->Ælows, ((*)(*, **)Ë& 
osù_Ælow_˛⁄e
);

245 i‡(
i
 != 0) {

246 
	`osù_mesßge_‰ì
(
c›y
);

247  
i
;

250 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
authítiˇti⁄_öfos
, &
c›y
->authítiˇti⁄_öfos, ((*)(*, **)Ë& 
osù_authítiˇti⁄_öfo_˛⁄e
);

252 i‡(
i
 != 0) {

253 
	`osù_mesßge_‰ì
(
c›y
);

254  
i
;

257 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
c⁄ã¡_ícodögs
, &
c›y
->c⁄ã¡_ícodögs, ((*)(*, **)Ë& 
osù_c⁄ã¡_ícodög_˛⁄e
);

259 i‡(
i
 != 0) {

260 
	`osù_mesßge_‰ì
(
c›y
);

261  
i
;

264 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
îr‹_öfos
, &
c›y
->îr‹_öfos, ((*)(*, **)Ë& 
osù_îr‹_öfo_˛⁄e
);

266 i‡(
i
 != 0) {

267 
	`osù_mesßge_‰ì
(
c›y
);

268  
i
;

271 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
¥oxy_authítiˇti⁄_öfos
, &
c›y
->¥oxy_authítiˇti⁄_öfos, ((*)(*, **)Ë& 
osù_¥oxy_authítiˇti⁄_öfo_˛⁄e
);

273 i‡(
i
 != 0) {

274 
	`osù_mesßge_‰ì
(
c›y
);

275  
i
;

279 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
ˇŒ_öfos
, &
c›y
->ˇŒ_öfos, ((*)(*, **)Ë& 
osù_ˇŒ_öfo_˛⁄e
);

281 i‡(
i
 != 0) {

282 
	`osù_mesßge_‰ì
(
c›y
);

283  
i
;

286 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
auth‹iz©i⁄s
, &
c›y
->auth‹iz©i⁄s, ((*)(*, **)Ë& 
osù_auth‹iz©i⁄_˛⁄e
);

288 i‡(
i
 != 0) {

289 
	`osù_mesßge_‰ì
(
c›y
);

290  
i
;

293 i‡(
sù
->
ˇŒ_id
 !
NULL
) {

294 
i
 = 
	`osù_ˇŒ_id_˛⁄e
(
sù
->
ˇŒ_id
, &(
c›y
->call_id));

296 i‡(
i
 != 0) {

297 
	`osù_mesßge_‰ì
(
c›y
);

298  
i
;

302 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
c⁄è˘s
, &
c›y
->c⁄è˘s, ((*)(*, **)Ë& 
osù_c⁄è˘_˛⁄e
);

304 i‡(
i
 != 0) {

305 
	`osù_mesßge_‰ì
(
c›y
);

306  
i
;

309 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
) {

310 
i
 = 
	`osù_c⁄ã¡_Àngth_˛⁄e
(
sù
->
c⁄ã¡_Àngth
, &(
c›y
->content_length));

312 i‡(
i
 != 0) {

313 
	`osù_mesßge_‰ì
(
c›y
);

314  
i
;

318 i‡(
sù
->
c⁄ã¡_ty≥
 !
NULL
) {

319 
i
 = 
	`osù_c⁄ã¡_ty≥_˛⁄e
(
sù
->
c⁄ã¡_ty≥
, &(
c›y
->content_type));

321 i‡(
i
 != 0) {

322 
	`osù_mesßge_‰ì
(
c›y
);

323  
i
;

327 i‡(
sù
->
c£q
 !
NULL
) {

328 
i
 = 
	`osù_c£q_˛⁄e
(
sù
->
c£q
, &(
c›y
->cseq));

330 i‡(
i
 != 0) {

331 
	`osù_mesßge_‰ì
(
c›y
);

332  
i
;

336 i‡(
sù
->
‰om
 !
NULL
) {

337 
i
 = 
	`osù_‰om_˛⁄e
(
sù
->
‰om
, &(
c›y
->from));

339 i‡(
i
 != 0) {

340 
	`osù_mesßge_‰ì
(
c›y
);

341  
i
;

345 i‡(
sù
->
mime_vîsi⁄
 !
NULL
) {

346 
i
 = 
	`osù_mime_vîsi⁄_˛⁄e
(
sù
->
mime_vîsi⁄
, &(
c›y
->mime_version));

348 i‡(
i
 != 0) {

349 
	`osù_mesßge_‰ì
(
c›y
);

350  
i
;

354 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
¥oxy_authítiˇãs
, &
c›y
->¥oxy_authítiˇãs, ((*)(*, **)Ë& 
osù_¥oxy_authítiˇã_˛⁄e
);

356 i‡(
i
 != 0) {

357 
	`osù_mesßge_‰ì
(
c›y
);

358  
i
;

361 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
¥oxy_auth‹iz©i⁄s
, &
c›y
->¥oxy_auth‹iz©i⁄s, ((*)(*, **)Ë& 
osù_¥oxy_auth‹iz©i⁄_˛⁄e
);

363 i‡(
i
 != 0) {

364 
	`osù_mesßge_‰ì
(
c›y
);

365  
i
;

368 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
ªc‹d_rouãs
, &
c›y
->ªc‹d_rouãs, ((*)(*, **)Ë& 
osù_ªc‹d_rouã_˛⁄e
);

370 i‡(
i
 != 0) {

371 
	`osù_mesßge_‰ì
(
c›y
);

372  
i
;

375 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
rouãs
, &
c›y
->rouãs, ((*)(*, **)Ë& 
osù_rouã_˛⁄e
);

377 i‡(
i
 != 0) {

378 
	`osù_mesßge_‰ì
(
c›y
);

379  
i
;

382 i‡(
sù
->
to
 !
NULL
) {

383 
i
 = 
	`osù_to_˛⁄e
(
sù
->
to
, &(
c›y
->to));

385 i‡(
i
 != 0) {

386 
	`osù_mesßge_‰ì
(
c›y
);

387  
i
;

391 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
vüs
, &
c›y
->vüs, ((*)(*, **)Ë& 
osù_vü_˛⁄e
);

393 i‡(
i
 != 0) {

394 
	`osù_mesßge_‰ì
(
c›y
);

395  
i
;

398 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
www_authítiˇãs
, &
c›y
->www_authítiˇãs, ((*)(*, **)Ë& 
osù_www_authítiˇã_˛⁄e
);

400 i‡(
i
 != 0) {

401 
	`osù_mesßge_‰ì
(
c›y
);

402  
i
;

405 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
hódîs
, &
c›y
->hódîs, ((*)(*, **)Ë& 
osù_hódî_˛⁄e
);

407 i‡(
i
 != 0) {

408 
	`osù_mesßge_‰ì
(
c›y
);

409  
i
;

412 
i
 = 
	`osù_li°_˛⁄e
(&
sù
->
bodõs
, &
c›y
->bodõs, ((*)(*, **)Ë& 
osù_body_˛⁄e
);

414 i‡(
i
 != 0) {

415 
	`osù_mesßge_‰ì
(
c›y
);

416  
i
;

419 
c›y
->
mesßge_Àngth
 = 
sù
->message_length;

420 
c›y
->
mesßge
 = 
	`osù_°rdup
(
sù
->message);

422 i‡(
c›y
->
mesßge
 =
NULL
 && 
sù
->message != NULL) {

423 
	`osù_mesßge_‰ì
(
c›y
);

424  
OSIP_NOMEM
;

427 
c›y
->
mesßge_¥›îty
 = 
sù
->message_property;

428 
c›y
->
≠∂iˇti⁄_d©a
 = 
sù
->application_data;

430 *
de°
 = 
c›y
;

431  
OSIP_SUCCESS
;

432 
	}
}

434 
	$osù_mesßge_gë_knownhódîli°
(
osù_li°_t
 *
hódî_li°
, 
pos
, **
de°
) {

435 *
de°
 = 
NULL
;

437 i‡(
	`osù_li°_size
(
hódî_li°
Ë<
pos
)

438  
OSIP_UNDEFINED_ERROR
;

440 *
de°
 = (*Ë
	`osù_li°_gë
(
hódî_li°
, 
pos
);

441  
pos
;

442 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_parse.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_∑r£r.h
>

24 
	~"∑r£r.h
"

26 
osù_utû_ª∂a˚_Æl_lws
(*
sù_mesßge
);

27 
osù_mesßge_£t__hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
);

28 
msg_hódîs_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
°¨t_of_hódî
, c⁄° **
body
);

29 
msg_osù_body_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
°¨t_of_buf
, c⁄° **
√xt_body
, 
size_t
 
Àngth
);

31 
	$__osù_mesßge_°¨éöe_∑r£ªq
(
osù_mesßge_t
 *
de°
, c⁄° *
buf
, c⁄° **
hódîs
) {

32 c⁄° *
p1
;

33 c⁄° *
p2
;

34 *
ªque°uri
;

35 
i
;

37 
de°
->
sù_mëhod
 = 
NULL
;

38 
de°
->
°©us_code
 = 0;

39 
de°
->
ªas⁄_phø£
 = 
NULL
;

41 *
hódîs
 = 
buf
;

44 
p2
 = 
	`°rchr
(
buf
, ' ');

46 i‡(
p2
 =
NULL
)

47  
OSIP_SYNTAXERROR
;

49 i‡(*(
p2
 + 1) == '\0' || *(p2 + 2) == '\0')

50  
OSIP_SYNTAXERROR
;

52 i‡(
p2
 - 
buf
 == 0) {

53 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No spaceállowed here\n"));

54  
OSIP_SYNTAXERROR
;

57 
de°
->
sù_mëhod
 = (*Ë
	`osù_mÆloc
(
p2
 - 
buf
 + 1);

59 i‡(
de°
->
sù_mëhod
 =
NULL
)

60  
OSIP_NOMEM
;

62 
	`osù_°∫˝y
(
de°
->
sù_mëhod
, 
buf
, 
p2
 - buf);

65 
p1
 = 
	`°rchr
(
p2
 + 2, ' ');

67 i‡(
p1
 =
NULL
) {

68 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "UncompliantÑequest-uri\n"));

69 
	`osù_‰ì
(
de°
->
sù_mëhod
);

70 
de°
->
sù_mëhod
 = 
NULL
;

71  
OSIP_SYNTAXERROR
;

74 i‡(
p1
 - 
p2
 < 2) {

75 
	`osù_‰ì
(
de°
->
sù_mëhod
);

76 
de°
->
sù_mëhod
 = 
NULL
;

77  
OSIP_SYNTAXERROR
;

80 
ªque°uri
 = (*Ë
	`osù_mÆloc
(
p1
 - 
p2
);

82 i‡(
ªque°uri
 =
NULL
) {

83 
	`osù_‰ì
(
de°
->
sù_mëhod
);

84 
de°
->
sù_mëhod
 = 
NULL
;

85  
OSIP_NOMEM
;

88 
	`osù_˛∫˝y
(
ªque°uri
, 
p2
 + 1, (
p1
 -Ö2 - 1));

90 
i
 = 
	`osù_uri_öô
(&(
de°
->
ªq_uri
));

92 i‡(
i
 != 0) {

93 
	`osù_‰ì
(
ªque°uri
);

94 
ªque°uri
 = 
NULL
;

95 
	`osù_‰ì
(
de°
->
sù_mëhod
);

96 
de°
->
sù_mëhod
 = 
NULL
;

97  
OSIP_NOMEM
;

100 
i
 = 
	`osù_uri_∑r£
(
de°
->
ªq_uri
, 
ªque°uri
);

101 
	`osù_‰ì
(
ªque°uri
);

103 i‡(
i
 != 0) {

104 
	`osù_‰ì
(
de°
->
sù_mëhod
);

105 
de°
->
sù_mëhod
 = 
NULL
;

106 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

107 
de°
->
ªq_uri
 = 
NULL
;

108  
OSIP_SYNTAXERROR
;

113 c⁄° *
hp
 = 
p1
;

115 
hp
++;

117 i‡(*
hp
 == '\0' || *(hp + 1) == '\0' || *(hp + 2) == '\0' || *(hp + 3) == '\0' || *(hp + 4) == '\0' || *(hp + 5) == '\0' || *(hp + 6) == '\0') {

118 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "UncompleteÑequestÜine\n"));

119 
	`osù_‰ì
(
de°
->
sù_mëhod
);

120 
de°
->
sù_mëhod
 = 
NULL
;

121 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

122 
de°
->
ªq_uri
 = 
NULL
;

123  
OSIP_SYNTAXERROR
;

126 i‡(((
hp
[0] != 'S') && (hp[0] != 's')) || ((hp[1] != 'I') && (hp[1] != 'i')) || ((hp[2] != 'P') && (hp[2] != 'p')) || (hp[3] != '/')) {

127 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found/No SIP/2.0 found\n"));

128 
	`osù_‰ì
(
de°
->
sù_mëhod
);

129 
de°
->
sù_mëhod
 = 
NULL
;

130 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

131 
de°
->
ªq_uri
 = 
NULL
;

132  
OSIP_SYNTAXERROR
;

135 
hp
 = hp + 4;

137 (*
hp
 != '\r') && (*hp != '\n')) {

138 i‡(*
hp
) {

139 i‡((*
hp
 >= '0') && (*hp <= '9'))

140 
hp
++;

142 i‡(*
hp
 == '.')

143 
hp
++;

146 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "incorrect sip version string\n"));

147 
	`osù_‰ì
(
de°
->
sù_mëhod
);

148 
de°
->
sù_mëhod
 = 
NULL
;

149 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

150 
de°
->
ªq_uri
 = 
NULL
;

151  
OSIP_SYNTAXERROR
;

155 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found\n"));

156 
	`osù_‰ì
(
de°
->
sù_mëhod
);

157 
de°
->
sù_mëhod
 = 
NULL
;

158 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

159 
de°
->
ªq_uri
 = 
NULL
;

160  
OSIP_SYNTAXERROR
;

164 i‡(
hp
 - 
p1
 < 2) {

165 
	`osù_‰ì
(
de°
->
sù_mëhod
);

166 
de°
->
sù_mëhod
 = 
NULL
;

167 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

168 
de°
->
ªq_uri
 = 
NULL
;

169  
OSIP_SYNTAXERROR
;

172 
de°
->
sù_vîsi⁄
 = (*Ë
	`osù_mÆloc
(
hp
 - 
p1
);

174 i‡(
de°
->
sù_vîsi⁄
 =
NULL
) {

175 
	`osù_‰ì
(
de°
->
sù_mëhod
);

176 
de°
->
sù_mëhod
 = 
NULL
;

177 
	`osù_uri_‰ì
(
de°
->
ªq_uri
);

178 
de°
->
ªq_uri
 = 
NULL
;

179  
OSIP_NOMEM
;

182 
	`osù_°∫˝y
(
de°
->
sù_vîsi⁄
, 
p1
 + 1, (
hp
 -Ö1 - 1));

184 i‡(0 !
	`osù_°rˇ£cmp
(
de°
->
sù_vîsi⁄
, "SIP/2.0")) {

185 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Wrong versionÇumber\n"));

188 
hp
++;

190 i‡((*
hp
) && ('\r' == hp[-1]) && ('\n' == hp[0]))

191 
hp
++;

193 (*
hódîs
Ë
hp
;

195  
OSIP_SUCCESS
;

196 
	}
}

198 
	$__osù_mesßge_°¨éöe_∑r£ª•
(
osù_mesßge_t
 *
de°
, c⁄° *
buf
, c⁄° **
hódîs
) {

199 c⁄° *
°©uscode
;

200 c⁄° *
ªas⁄phø£
;

202 
de°
->
ªq_uri
 = 
NULL
;

203 
de°
->
sù_mëhod
 = 
NULL
;

205 *
hódîs
 = 
buf
;

207 
°©uscode
 = 
	`°rchr
(
buf
, ' ');

209 i‡(
°©uscode
 =
NULL
)

210  
OSIP_SYNTAXERROR
;

212 i‡(
°©uscode
 - (*
hódîs
) < 7)

213  
OSIP_SYNTAXERROR
;

215 
de°
->
sù_vîsi⁄
 = (*Ë
	`osù_mÆloc
(
°©uscode
 - (*
hódîs
) + 1);

217 i‡(
de°
->
sù_vîsi⁄
 =
NULL
)

218  
OSIP_NOMEM
;

220 
	`osù_°∫˝y
(
de°
->
sù_vîsi⁄
, *
hódîs
, 
°©uscode
 - (*headers));

222 
ªas⁄phø£
 = 
	`°rchr
(
°©uscode
 + 1, ' ');

224 i‡(
ªas⁄phø£
 =
NULL
) {

225 
	`osù_‰ì
(
de°
->
sù_vîsi⁄
);

226 
de°
->
sù_vîsi⁄
 = 
NULL
;

227  
OSIP_SYNTAXERROR
;

232 i‡(
	`ssˇnf
(
°©uscode
 + 1, "%d", &
de°
->
°©us_code
) != 1) {

234  
OSIP_SYNTAXERROR
;

237 i‡(
de°
->
°©us_code
 == 0)

238  
OSIP_SYNTAXERROR
;

241 c⁄° *
hp
 = 
ªas⁄phø£
;

243 (*
hp
 != '\r') && (*hp != '\n')) {

244 i‡(*
hp
)

245 
hp
++;

248 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found\n"));

249  
OSIP_SYNTAXERROR
;

253 
de°
->
ªas⁄_phø£
 = (*Ë
	`osù_mÆloc
(
hp
 - 
ªas⁄phø£
);

255 i‡(
de°
->
ªas⁄_phø£
 =
NULL
) {

256 
	`osù_‰ì
(
de°
->
sù_vîsi⁄
);

257 
de°
->
sù_vîsi⁄
 = 
NULL
;

258  
OSIP_NOMEM
;

261 
	`osù_°∫˝y
(
de°
->
ªas⁄_phø£
, 
ªas⁄phø£
 + 1, 
hp
 -Ñeasonphrase - 1);

263 
hp
++;

265 i‡((*
hp
) && ('\r' == hp[-1]) && ('\n' == hp[0]))

266 
hp
++;

268 (*
hódîs
Ë
hp
;

270  
OSIP_SUCCESS
;

271 
	}
}

273 
	$__osù_mesßge_°¨éöe_∑r£
(
osù_mesßge_t
 *
de°
, c⁄° *
buf
, c⁄° **
hódîs
) {

274 i‡(0 =
	`°∫cmp
((c⁄° *Ë
buf
, (const *) "SIP/", 4))

275  
	`__osù_mesßge_°¨éöe_∑r£ª•
(
de°
, 
buf
, 
hódîs
);

278  
	`__osù_mesßge_°¨éöe_∑r£ªq
(
de°
, 
buf
, 
hódîs
);

279 
	}
}

281 
	$__osù_föd_√xt_occuªn˚
(c⁄° *
°r
, c⁄° *
buf
, c⁄° **
ödex_of_°r
, c⁄° *
íd_of_buf
) {

282 
size_t
 
¶í
;

284 *
ödex_of_°r
 = 
NULL
;

286 i‡(
°r
 =
NULL
 || 
buf
 == NULL)

287  
OSIP_BADPARAMETER
;

289 
¶í
 = 
	`°æí
(
°r
);

291 
¶í
 < (
size_t
)(
íd_of_buf
 - 
buf
)) {

292 i‡(!
	`memcmp
(
°r
, 
buf
, 
¶í
)) {

293 *
ödex_of_°r
 = 
buf
;

294  
OSIP_SUCCESS
;

297 ++
buf
;

300  
OSIP_SYNTAXERROR
;

301 
	}
}

306 
	$osù_utû_ª∂a˚_Æl_lws
(*
sù_mesßge
) {

308 *
tmp
;

310 i‡(
sù_mesßge
 =
NULL
)

315 
tmp
 = 
sù_mesßge
;

317 ; 
tmp
[0] != '\0';Åmp++) {

318 i‡(('\0' =
tmp
[0]) || ('\0' ==Åmp[1]) || ('\0' ==Åmp[2]) || ('\0' ==Åmp[3]))

321 i‡((('\r' =
tmp
[0]) && ('\n' ==Åmp[1]) && ('\r' ==Åmp[2]) && ('\n' ==Åmp[3])) || (('\r' ==Åmp[0]) && ('\r' ==Åmp[1])) || (('\n' ==Åmp[0]) && ('\n' ==Åmp[1])))

324 i‡((('\r' =
tmp
[0]) && ('\n' ==Åmp[1]) && ((' ' ==Åmp[2]) || ('\t' ==Åmp[2]))) || (('\r' ==Åmp[0]) && ((' ' ==Åmp[1]) || ('\t' ==Åmp[1]))) || (('\n' ==Åmp[0]) && ((' ' ==Åmp[1]) || ('\t' ==Åmp[1])))) {

326 
tmp
[0] = ' ';

327 
tmp
[1] = ' ';

328 
tmp
 =Åmp + 2;

331 ; ('\t' =
tmp
[0] || ' ' ==Åmp[0]);) {

332 
tmp
[0] = ' ';

333 
tmp
++;

336 i‡(
tmp
[0] == '\0')

340 
	}
}

342 
	$__osù_föd_√xt_¸lf
(c⁄° *
°¨t_of_hódî
, c⁄° **
íd_of_hódî
) {

343 c⁄° *
soh
 = 
°¨t_of_hódî
;

345 *
íd_of_hódî
 = 
NULL
;

347 ('\r' !*
soh
) && ('\n' != *soh)) {

348 i‡(*
soh
)

349 
soh
++;

352 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

353  
OSIP_SYNTAXERROR
;

357 i‡(('\r' =
soh
[0]) && ('\n' == soh[1]))

360 
soh
 = soh + 1;

364 i‡((' ' =
soh
[1]) || ('\t' == soh[1])) {

370 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "MessageÅhat contains LWS must beÖrocessed with osip_util_replace_all_lws(char *tmp) before beingÖarsed.\n"));

374 *
íd_of_hódî
 = 
soh
 + 1;

375  
OSIP_SUCCESS
;

376 
	}
}

378 
	$__osù_föd_√xt_¸lf¸lf
(c⁄° *
°¨t_of_∑π
, c⁄° **
íd_of_∑π
) {

379 c⁄° *
°¨t_of_löe
;

380 c⁄° *
íd_of_löe
;

381 
i
;

383 
°¨t_of_löe
 = 
°¨t_of_∑π
;

386 
i
 = 
	`__osù_föd_√xt_¸lf
(
°¨t_of_löe
, &
íd_of_löe
);

388 i‡(
i
 == -2) {

389 } i‡(
i
 != 0) {

390 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

391  
i
;

394 i‡('\0' =
íd_of_löe
[0]) {

395 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

396  
OSIP_SYNTAXERROR
;

398 } i‡('\r' =
íd_of_löe
[0]) {

399 i‡('\n' =
íd_of_löe
[1])

400 
íd_of_löe
++;

402 *
íd_of_∑π
 = 
íd_of_löe
 + 1;

403  
OSIP_SUCCESS
;

405 } i‡('\n' =
íd_of_löe
[0]) {

406 *
íd_of_∑π
 = 
íd_of_löe
 + 1;

407  
OSIP_SUCCESS
;

410 
°¨t_of_löe
 = 
íd_of_löe
;

412 
	}
}

414 
	$osù_mesßge_£t__hódî
(
osù_mesßge_t
 *
sù
, c⁄° *
h«me
, c⁄° *
hvÆue
) {

415 
my_ödex
;

417 i‡(
h«me
 =
NULL
)

418  
OSIP_SYNTAXERROR
;

422 
my_ödex
 = 
	`__osù_mesßge_is_known_hódî
(
h«me
);

424 i‡(
my_ödex
 >= 0) {

425 
ªt
;

427 
ªt
 = 
	`__osù_mesßge_ˇŒ_mëhod
(
my_ödex
, 
sù
, 
hvÆue
);

429 i‡(
ªt
 != 0)

430  
ªt
;

432  
OSIP_SUCCESS
;

436 i‡(
	`osù_mesßge_£t_hódî
(
sù
, 
h«me
, 
hvÆue
) != 0) {

437 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "CouldÇot set unknown header\n"));

438  
OSIP_SUCCESS
;

441  
OSIP_SUCCESS
;

442 
	}
}

444 
	$osù_mesßge_£t_mu…ùÀ_hódî
(
osù_mesßge_t
 *
sù
, *
h«me
, *
hvÆue
) {

445 
i
;

446 *
±r
, *
p
;

447 *
comma
;

448 *
beg
;

449 *
íd
;

450 
öquŸes
, 
öuri
;

453 
	`osù_tﬁowî
(
h«me
);

455 i‡(
hvÆue
 =
NULL
) {

456 
i
 = 
	`osù_mesßge_£t__hódî
(
sù
, 
h«me
, 
hvÆue
);

458 i‡(
i
 != 0)

459  
i
;

461  
OSIP_SUCCESS
;

464 
±r
 = 
hvÆue
;

465 
comma
 = 
	`°rchr
(
±r
, ',');

472 i‡(
comma
 =
NULL
 || 
	`__osù_mesßge_is_hódî_comma_£∑øãd
(
h«me
Ë!
OSIP_SUCCESS
) {

473 
i
 = 
	`osù_mesßge_£t__hódî
(
sù
, 
h«me
, 
hvÆue
);

475 i‡(
i
 != 0)

476  
i
;

478  
OSIP_SUCCESS
;

481 
beg
 = 
hvÆue
;

482 
öquŸes
 = 0;

483 
öuri
 = 0;

486 ;; 
±r
++) {

487 *
±r
) {

491 
i
 = 0, 
p
 = 
±r
 - 1;Ö >
beg
 && *p == '\\';Ö--, i++)

494 i‡(
i
 % 2 == 0)

495 
öquŸes
 = !inquotes;

500 i‡(!
öquŸes
) {

501 i‡(!
öuri
) {

502 i‡((
	`osù_°∫ˇ£cmp
(
±r
 + 1, "sip:", 4) == 0 || osip_strncasecmp(ptr + 1, "sips:", 5) == 0 || osip_strncasecmp(ptr + 1, "http:", 5) == 0 || osip_strncasecmp(ptr + 1, "https:", 6) == 0 || osip_strncasecmp(ptr + 1, "tel:", 4) == 0) &&

503 
	`°rchr
(
±r
, '>'))

504 
öuri
 = 1;

519 i‡(!
öquŸes
) {

520 i‡(
öuri
)

521 
öuri
 = 0;

528 
öquŸes
 = 0;

529 
öuri
 = 0;

534 i‡(!
öquŸes
 && !
öuri
) {

535 *
avÆue
;

537 i‡(
beg
[0] == '\0')

538  
OSIP_SUCCESS
;

540 
íd
 = 
±r
;

542 i‡(
íd
 - 
beg
 + 1 < 2) {

543 
beg
 = 
íd
 + 1;

547 
avÆue
 = (*Ë
	`osù_mÆloc
(
íd
 - 
beg
 + 1);

549 i‡(
avÆue
 =
NULL
)

550  
OSIP_NOMEM
;

552 
	`osù_˛∫˝y
(
avÆue
, 
beg
, 
íd
 - beg);

554 
i
 = 
	`osù_mesßge_£t__hódî
(
sù
, 
h«me
, 
avÆue
);

555 
	`osù_‰ì
(
avÆue
);

557 i‡(
i
 != 0)

558  
i
;

560 
beg
 = 
íd
 + 1;

563 i‡(*
±r
 == '\0')

564  
OSIP_SUCCESS
;

572 
	}
}

575 
	$msg_hódîs_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
°¨t_of_hódî
, c⁄° **
body
) {

576 c⁄° *
cﬁ⁄_ödex
;

577 *
h«me
;

578 *
hvÆue
;

579 c⁄° *
íd_of_hódî
;

580 
i
;

583 i‡(
°¨t_of_hódî
[0] == '\0') {

584 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "SIP message doesÇotÉnd with CRLFCRLF\n"));

585  
OSIP_SUCCESS
;

588 
i
 = 
	`__osù_föd_√xt_¸lf
(
°¨t_of_hódî
, &
íd_of_hódî
);

590 i‡(
i
 == -2) {

591 } i‡(
i
 != 0) {

592 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

593  
i
;

598 i‡((
°¨t_of_hódî
[0] == '\r') || (start_of_header[0] == '\n')) {

599 *
body
 = 
°¨t_of_hódî
;

600  
OSIP_SUCCESS
;

604 
cﬁ⁄_ödex
 = 
	`°rchr
(
°¨t_of_hódî
, ':');

606 i‡(
cﬁ⁄_ödex
 =
NULL
) {

607 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

608  
OSIP_SYNTAXERROR
;

611 i‡(
cﬁ⁄_ödex
 - 
°¨t_of_hódî
 + 1 < 2)

612  
OSIP_SYNTAXERROR
;

614 i‡(
íd_of_hódî
 <
cﬁ⁄_ödex
) {

615 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Malformed message\n"));

616  
OSIP_SYNTAXERROR
;

619 
h«me
 = (*Ë
	`osù_mÆloc
(
cﬁ⁄_ödex
 - 
°¨t_of_hódî
 + 1);

621 i‡(
h«me
 =
NULL
)

622  
OSIP_NOMEM
;

624 
	`osù_˛∫˝y
(
h«me
, 
°¨t_of_hódî
, 
cﬁ⁄_ödex
 - start_of_header);

627 c⁄° *
íd
;

631 i‡((
íd_of_hódî
[-2] == '\r') || (end_of_header[-2] == '\n'))

632 
íd
 = 
íd_of_hódî
 - 2;

635 
íd
 = 
íd_of_hódî
 - 1;

637 i‡((
íd
Ë-
cﬁ⁄_ödex
 < 2)

638 
hvÆue
 = 
NULL
;

640 
hvÆue
 = (*Ë
	`osù_mÆloc
((
íd
Ë-
cﬁ⁄_ödex
 + 1);

642 i‡(
hvÆue
 =
NULL
) {

643 
	`osù_‰ì
(
h«me
);

644  
OSIP_NOMEM
;

647 
	`osù_˛∫˝y
(
hvÆue
, 
cﬁ⁄_ödex
 + 1, (
íd
) -colon_index - 1);

655 
i
 = 
	`osù_mesßge_£t_mu…ùÀ_hódî
(
sù
, 
h«me
, 
hvÆue
);

657 
	`osù_‰ì
(
h«me
);

659 i‡(
hvÆue
 !
NULL
)

660 
	`osù_‰ì
(
hvÆue
);

662 i‡(
i
 != 0) {

663 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

664  
OSIP_SYNTAXERROR
;

668 
°¨t_of_hódî
 = 
íd_of_hódî
;

675  
OSIP_SYNTAXERROR
;

676 
	}
}

678 
	$msg_osù_body_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
°¨t_of_buf
, c⁄° **
√xt_body
, 
size_t
 
Àngth
) {

679 c⁄° *
°¨t_of_body
;

680 c⁄° *
íd_of_body
;

681 c⁄° *
íd_of_buf
;

682 *
tmp
;

683 
i
;

685 *
£p_bound¨y
;

686 
size_t
 
Àn_£p_bound¨y
;

687 
osù_gíîic_∑øm_t
 *
˘_∑øm
;

689 i‡(
sù
->
c⁄ã¡_ty≥
 =
NULL
 || sù->c⁄ã¡_ty≥->
ty≥
 =NULL || sù->c⁄ã¡_ty≥->
subty≥
 == NULL)

690  
OSIP_SUCCESS
;

692 i‡(0 !
	`osù_°rˇ£cmp
(
sù
->
c⁄ã¡_ty≥
->
ty≥
, "multipart")) {

693 
size_t
 
osù_body_Àn
;

695 i‡(
°¨t_of_buf
[0] == '\0')

696  
OSIP_SYNTAXERROR
;

699 i‡('\r' =
°¨t_of_buf
[0]) {

700 i‡('\n' =
°¨t_of_buf
[1])

701 
°¨t_of_body
 = 
°¨t_of_buf
 + 2;

704 
°¨t_of_body
 = 
°¨t_of_buf
 + 1;

706 } i‡('\n' =
°¨t_of_buf
[0])

707 
°¨t_of_body
 = 
°¨t_of_buf
 + 1;

710  
OSIP_SYNTAXERROR
;

713 
Àngth
 =Üígth - (
°¨t_of_body
 - 
°¨t_of_buf
);

715 i‡(
Àngth
 <= 0)

716  
OSIP_SYNTAXERROR
;

718 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
)

719 
osù_body_Àn
 = 
	`osù_©oi
(
sù
->
c⁄ã¡_Àngth
->
vÆue
);

723 
tmp
[16];

725 
osù_body_Àn
 = 
Àngth
;

726 
	`•rötf
(
tmp
, "%i", (Ë
osù_body_Àn
);

727 
i
 = 
	`osù_mesßge_£t_c⁄ã¡_Àngth
(
sù
, 
tmp
);

729 i‡(
i
 != 0)

730  
i
;

733 i‡(
Àngth
 < 
osù_body_Àn
) {

734 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Mesßgêwa†nŸÑe˚õvedÉ¡îñy.Üígth=%òosù_body_Àn=%i\n", (Ë
Àngth
, (Ë
osù_body_Àn
));

735  
OSIP_SYNTAXERROR
;

738 
íd_of_body
 = 
°¨t_of_body
 + 
osù_body_Àn
;

739 
tmp
 = 
	`osù_mÆloc
(
íd_of_body
 - 
°¨t_of_body
 + 2);

741 i‡(
tmp
 =
NULL
)

742  
OSIP_NOMEM
;

744 
	`mem˝y
(
tmp
, 
°¨t_of_body
, 
íd_of_body
 - start_of_body);

745 
tmp
[
íd_of_body
 - 
°¨t_of_body
] = '\0';

747 
i
 = 
	`osù_mesßge_£t_body
(
sù
, 
tmp
, 
íd_of_body
 - 
°¨t_of_body
);

748 
	`osù_‰ì
(
tmp
);

750 i‡(
i
 != 0)

751  
i
;

753  
OSIP_SUCCESS
;

757 
i
 = 
	`osù_gíîic_∑øm_gë_by«me
(&
sù
->
c⁄ã¡_ty≥
->
gí_∑øms
, "bound¨y", &
˘_∑øm
);

759 i‡(
i
 != 0)

760  
i
;

762 i‡(
˘_∑øm
 =
NULL
)

763  
OSIP_SYNTAXERROR
;

765 i‡(
˘_∑øm
->
gvÆue
 =
NULL
)

766  
OSIP_SYNTAXERROR
;

769 c⁄° *
bound¨y_¥efix
 = "\n--";

771 
size_t
 
Àn
 = 
	`°æí
(
˘_∑øm
->
gvÆue
);

773 
£p_bound¨y
 = (*Ë
	`osù_mÆloc
(
Àn
 + 4);

775 i‡(
£p_bound¨y
 =
NULL
)

776  
OSIP_NOMEM
;

778 
	`°r˝y
(
£p_bound¨y
, 
bound¨y_¥efix
);

780 i‡(
˘_∑øm
->
gvÆue
[0] ='"' && ct_∑øm->gvÆue[
Àn
 - 1] == '"')

781 
	`°∫ˇt
(
£p_bound¨y
, 
˘_∑øm
->
gvÆue
 + 1, 
Àn
 - 2);

784 
	`°∫ˇt
(
£p_bound¨y
, 
˘_∑øm
->
gvÆue
, 
Àn
);

787 
Àn_£p_bound¨y
 = 
	`°æí
(
£p_bound¨y
);

789 *
√xt_body
 = 
NULL
;

790 
°¨t_of_body
 = 
°¨t_of_buf
;

792 
íd_of_buf
 = 
°¨t_of_buf
 + 
Àngth
;

795 
size_t
 
body_Àn
 = 0;

797 
i
 = 
	`__osù_föd_√xt_occuªn˚
(
£p_bound¨y
, 
°¨t_of_body
, &°¨t_of_body, 
íd_of_buf
);

799 i‡(
i
 != 0) {

800 
	`osù_‰ì
(
£p_bound¨y
);

801  
i
;

804 
i
 = 
	`__osù_föd_√xt_occuªn˚
(
£p_bound¨y
, 
°¨t_of_body
 + 
Àn_£p_bound¨y
, &
íd_of_body
, 
íd_of_buf
);

806 i‡(
i
 != 0) {

807 
	`osù_‰ì
(
£p_bound¨y
);

808  
i
;

812 
°¨t_of_body
 = sèπ_of_body + 
Àn_£p_bound¨y
 + 1;

814 i‡('\n' =
°¨t_of_body
[0] || '\r' == start_of_body[0])

815 
°¨t_of_body
++;

818 i‡(
íd_of_body
 <
°¨t_of_body
) {

819 
	`osù_‰ì
(
£p_bound¨y
);

820  
OSIP_SYNTAXERROR
;

823 
body_Àn
 = 
íd_of_body
 - 
°¨t_of_body
;

826 i‡(*(
íd_of_body
 - 1) == '\r')

827 
body_Àn
--;

829 
tmp
 = 
	`osù_mÆloc
(
body_Àn
 + 2);

831 i‡(
tmp
 =
NULL
) {

832 
	`osù_‰ì
(
£p_bound¨y
);

833  
OSIP_NOMEM
;

836 
	`mem˝y
(
tmp
, 
°¨t_of_body
, 
body_Àn
);

837 
tmp
[
body_Àn
] = '\0';

839 
i
 = 
	`osù_mesßge_£t_body_mime
(
sù
, 
tmp
, 
body_Àn
);

840 
	`osù_‰ì
(
tmp
);

842 i‡(
i
 != 0) {

843 
	`osù_‰ì
(
£p_bound¨y
);

844  
i
;

847 i‡(
	`°∫cmp
(
íd_of_body
 + 
Àn_£p_bound¨y
, "--", 2) == 0) {

848 *
√xt_body
 = 
íd_of_body
;

849 
	`osù_‰ì
(
£p_bound¨y
);

850  
OSIP_SUCCESS
;

854 
°¨t_of_body
 = 
íd_of_body
;

859  
OSIP_SYNTAXERROR
;

860 
	}
}

863 
	$_osù_mesßge_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
, 
sù‰ag
) {

864 
i
;

865 c⁄° *
√xt_hódî_ödex
;

866 *
tmp
;

867 *
beg
;

869 
tmp
 = 
	`osù_mÆloc
(
Àngth
 + 2);

871 i‡(
tmp
 =
NULL
) {

872 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotállocate memory.\n"));

873  
OSIP_NOMEM
;

876 
beg
 = 
tmp
;

877 
	`mem˝y
(
tmp
, 
buf
, 
Àngth
);

878 
tmp
[
Àngth
] = '\0';

880 
tmp
 +
	`°r•n
(tmp, "\r\n");

881 
	`osù_utû_ª∂a˚_Æl_lws
(
tmp
);

883 
i
 = 
	`__osù_mesßge_°¨éöe_∑r£
(
sù
, 
tmp
, &
√xt_hódî_ödex
);

885 i‡(
i
 !0 && !
sù‰ag
) {

886 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "CouldÇotÖarse startÜine of message.\n"));

887 
	`osù_‰ì
(
beg
);

888  
i
;

891 
tmp
 = (*Ë
√xt_hódî_ödex
;

894 
i
 = 
	`msg_hódîs_∑r£
(
sù
, 
tmp
, &
√xt_hódî_ödex
);

896 i‡(
i
 != 0) {

897 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "error in msg_headers_parse()\n"));

898 
	`osù_‰ì
(
beg
);

899  
i
;

902 
tmp
 = (*Ë
√xt_hódî_ödex
;

904 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
 && sù->c⁄ã¡_Àngth->
vÆue
 == NULL) {

906 
	`osù_c⁄ã¡_Àngth_‰ì
(
sù
->
c⁄ã¡_Àngth
);

907 
sù
->
c⁄ã¡_Àngth
 = 
NULL
;

910 i‡(
sù
->
c⁄ã¡_Àngth
 !
NULL
 && sù->c⁄ã¡_Àngth->
vÆue
 !NULL && 
	`©oi
(sip->content_length->value) > 0) {

912 } i‡(
sù
->
c⁄ã¡_Àngth
 =
NULL
 && '\r' =
√xt_hódî_ödex
[0] && '\n' =√xt_hódî_ödex[1] && 
Àngth
 - (
tmp
 - 
beg
) - (2) > 0) {

914 } i‡(
sù
->
c⁄ã¡_Àngth
 =
NULL
 && '\n' =
√xt_hódî_ödex
[0] && 
Àngth
 - (
tmp
 - 
beg
) - (1) > 0) {

917 i‡(
sù
->
c⁄ã¡_Àngth
 =
NULL
)

918 
	`osù_mesßge_£t_c⁄ã¡_Àngth
(
sù
, "0");

920 
	`osù_‰ì
(
beg
);

921  
OSIP_SUCCESS
;

924 
i
 = 
	`msg_osù_body_∑r£
(
sù
, 
tmp
, &
√xt_hódî_ödex
, 
Àngth
 - (tm∞- 
beg
));

925 
	`osù_‰ì
(
beg
);

927 i‡(
i
 != 0) {

928 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "error in msg_osip_body_parse()\n"));

929  
i
;

933 i‡(
sù
->
c⁄ã¡_Àngth
 =
NULL
)

934 
	`osù_mesßge_£t_c⁄ã¡_Àngth
(
sù
, "0");

936  
OSIP_SUCCESS
;

937 
	}
}

939 
	$osù_mesßge_∑r£
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
) {

940  
	`_osù_mesßge_∑r£
(
sù
, 
buf
, 
Àngth
, 0);

941 
	}
}

943 
	$osù_mesßge_∑r£_sù‰ag
(
osù_mesßge_t
 *
sù
, c⁄° *
buf
, 
size_t
 
Àngth
) {

944  
	`_osù_mesßge_∑r£
(
sù
, 
buf
, 
Àngth
, 1);

945 
	}
}

949 
	$osù_mesßge_fix_œ°_vü_hódî
(
osù_mesßge_t
 *
ªque°
, c⁄° *
ù_addr
, 
p‹t
) {

950 
osù_gíîic_∑øm_t
 *
Ω‹t
;

951 
osù_vü_t
 *
vü
;

954 i‡(
ªque°
 =
NULL
)

955  
OSIP_BADPARAMETER
;

957 i‡(
	`MSG_IS_RESPONSE
(
ªque°
))

958  
OSIP_SUCCESS
;

960 
vü
 = 
	`osù_li°_gë
(&
ªque°
->
vüs
, 0);

962 i‡(
vü
 =
NULL
 || vü->
ho°
 == NULL)

964  
OSIP_BADPARAMETER
;

966 
	`osù_vü_∑øm_gë_by«me
(
vü
, "Ω‹t", &
Ω‹t
);

968 i‡(
Ω‹t
 !
NULL
) {

969 i‡(
Ω‹t
->
gvÆue
 =
NULL
) {

970 
Ω‹t
->
gvÆue
 = (*Ë
	`osù_mÆloc
(9);

972 i‡(
Ω‹t
->
gvÆue
 =
NULL
)

973  
OSIP_NOMEM
;

975 #i‡!
deföed
 
__PALMOS__
 && (deföed 
WIN32
 || deföed 
_WIN32_WCE
)

976 
	`_¢¥ötf
(
Ω‹t
->
gvÆue
, 8, "%i", 
p‹t
);

978 
	`¢¥ötf
(
Ω‹t
->
gvÆue
, 8, "%i", 
p‹t
);

985 i‡(0 =
	`°rcmp
(
vü
->
ho°
, 
ù_addr
))

986  
OSIP_SUCCESS
;

988 
	`osù_vü_£t_ª˚ived
(
vü
, 
	`osù_°rdup
(
ù_addr
));

989  
OSIP_SUCCESS
;

990 
	}
}

992 c⁄° *
	$osù_mesßge_gë_ªas⁄
(
ª∂ycode
) {

993 
	scode_to_ªas⁄
 {

994 
code
;

995 c⁄° *
ªas⁄
;

998 c⁄° 
code_to_ªas⁄
 
ªas⁄s1xx
[] = {

1001 c⁄° 
code_to_ªas⁄
 
ªas⁄s2xx
[] = {

1006 c⁄° 
code_to_ªas⁄
 
ªas⁄s3xx
[] = {

1009 c⁄° 
code_to_ªas⁄
 
ªas⁄s4xx
[] = {

1058 c⁄° 
code_to_ªas⁄
 
ªas⁄s5xx
[] = {

1061 c⁄° 
code_to_ªas⁄
 
ªas⁄s6xx
[] = {{600, "Busy Everywhere"}, {603, "Decline"}, {604, "Does Not Exist Anywhere"}, {606, "Not Acceptable"}, {607, "Unwanted"}, {687, "Dialog Terminated"}};

1062 c⁄° 
code_to_ªas⁄
 *
ªas⁄s
;

1063 
Àn
, 
i
;

1065 
ª∂ycode
 / 100) {

1067 
ªas⁄s
 = 
ªas⁄s1xx
;

1068 
Àn
 = (
ªas⁄s1xx
Ë/ (*
ªas⁄s
);

1072 
ªas⁄s
 = 
ªas⁄s2xx
;

1073 
Àn
 = (
ªas⁄s2xx
Ë/ (*
ªas⁄s
);

1077 
ªas⁄s
 = 
ªas⁄s3xx
;

1078 
Àn
 = (
ªas⁄s3xx
Ë/ (*
ªas⁄s
);

1082 
ªas⁄s
 = 
ªas⁄s4xx
;

1083 
Àn
 = (
ªas⁄s4xx
Ë/ (*
ªas⁄s
);

1087 
ªas⁄s
 = 
ªas⁄s5xx
;

1088 
Àn
 = (
ªas⁄s5xx
Ë/ (*
ªas⁄s
);

1092 
ªas⁄s
 = 
ªas⁄s6xx
;

1093 
Àn
 = (
ªas⁄s6xx
Ë/ (*
ªas⁄s
);

1097  
NULL
;

1100 
i
 = 0; i < 
Àn
; i++)

1101 i‡(
ªas⁄s
[
i
].
code
 =
ª∂ycode
)

1102  
ªas⁄s
[
i
].
ªas⁄
;

1105  
NULL
;

1106 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_to_str.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	#MIME_MAX_BOUNDARY_LEN
 70

	)

27 c⁄° *
osù_¥Ÿocﬁ_vîsi⁄
;

29 
°rˇt_sim∂e_hódî
(**
_°rög
, 
size_t
 *
mÆloc_size
, **
_mesßge
, *
±r_hódî
, *
hódî_«me
, size_à
size_of_hódî
, (*
xxx_to_°r
)(*, **), **
√xt
);

30 
	`°rˇt_hódîs_⁄e_≥r_löe
(**
_°rög
, 
size_t
 *
mÆloc_size
, **
_mesßge
, 
osù_li°_t
 *
hódîs
, *
hódî
, size_à
size_of_hódî
, (*
xxx_to_°r
)(*, **), **
√xt
);

32 
	$__osù_mesßge_°¨éöe_to_°ºeq
(
osù_mesßge_t
 *
sù
, **
de°
) {

33 c⁄° *
sù_vîsi⁄
;

34 *
tmp
;

35 *
rquri
;

36 
i
;

38 *
de°
 = 
NULL
;

40 i‡((
sù
 =
NULL
Ë|| (sù->
ªq_uri
 =NULLË|| (sù->
sù_mëhod
 == NULL))

41  
OSIP_BADPARAMETER
;

43 
i
 = 
	`osù_uri_to_°r
(
sù
->
ªq_uri
, &
rquri
);

45 i‡(
i
 != 0)

46  
i
;

48 i‡(
sù
->
sù_vîsi⁄
 =
NULL
)

49 
sù_vîsi⁄
 = 
osù_¥Ÿocﬁ_vîsi⁄
;

52 
sù_vîsi⁄
 = 
sù
->sip_version;

54 *
de°
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
sù
->
sù_mëhod
Ë+ såÀn(
rquri
Ë+ såÀn(
sù_vîsi⁄
) + 3);

56 i‡(*
de°
 =
NULL
) {

57 
	`osù_‰ì
(
rquri
);

58  
OSIP_NOMEM
;

61 
tmp
 = *
de°
;

63 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
sù
->
sù_mëhod
);

64 *
tmp
 = ' ';

65 
tmp
++;

66 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
rquri
);

67 *
tmp
 = ' ';

68 
tmp
++;

69 
	`°r˝y
(
tmp
, 
sù_vîsi⁄
);

71 
	`osù_‰ì
(
rquri
);

72  
OSIP_SUCCESS
;

73 
	}
}

75 
	$__osù_mesßge_°¨éöe_to_°ºe•
(
osù_mesßge_t
 *
sù
, **
de°
) {

76 *
tmp
;

77 c⁄° *
sù_vîsi⁄
;

78 
°©us_code
[5];

80 *
de°
 = 
NULL
;

82 i‡((
sù
 =
NULL
Ë|| (sù->
ªas⁄_phø£
 =NULLË|| (sù->
°©us_code
 < 100) || (sip->status_code > 699))

83  
OSIP_BADPARAMETER
;

85 i‡(
sù
->
sù_vîsi⁄
 =
NULL
)

86 
sù_vîsi⁄
 = 
osù_¥Ÿocﬁ_vîsi⁄
;

89 
sù_vîsi⁄
 = 
sù
->sip_version;

91 
	`•rötf
(
°©us_code
, "%u", 
sù
->status_code);

93 *
de°
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
sù_vîsi⁄
Ë+ 3 + såÀn(
sù
->
ªas⁄_phø£
) + 4);

95 i‡(*
de°
 =
NULL
)

96  
OSIP_NOMEM
;

98 
tmp
 = *
de°
;

100 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
sù_vîsi⁄
);

101 *
tmp
 = ' ';

102 
tmp
++;

104 
tmp
 = 
	`osù_°∫_≠≥nd
—mp, 
°©us_code
, 3);

105 *
tmp
 = ' ';

106 
tmp
++;

107 
	`°r˝y
(
tmp
, 
sù
->
ªas⁄_phø£
);

109  
OSIP_SUCCESS
;

110 
	}
}

112 
	$__osù_mesßge_°¨éöe_to_°r
(
osù_mesßge_t
 *
sù
, **
de°
) {

113 i‡(
sù
->
sù_mëhod
 !
NULL
)

114  
	`__osù_mesßge_°¨éöe_to_°ºeq
(
sù
, 
de°
);

116 i‡(
sù
->
°©us_code
 != 0)

117  
	`__osù_mesßge_°¨éöe_to_°ºe•
(
sù
, 
de°
);

119 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
TRACE_LEVEL1
, 
NULL
, "ERROR method hasÇo value or status code is 0!\n"));

120  
OSIP_BADPARAMETER
;

121 
	}
}

123 *
	$osù_mesßge_gë_ªas⁄_phø£
(c⁄° 
osù_mesßge_t
 *
sù
) {

124  
sù
->
ªas⁄_phø£
;

125 
	}
}

127 
	$osù_mesßge_gë_°©us_code
(c⁄° 
osù_mesßge_t
 *
sù
) {

128  
sù
->
°©us_code
;

129 
	}
}

131 *
	$osù_mesßge_gë_mëhod
(c⁄° 
osù_mesßge_t
 *
sù
) {

132  
sù
->
sù_mëhod
;

133 
	}
}

135 *
	$osù_mesßge_gë_vîsi⁄
(c⁄° 
osù_mesßge_t
 *
sù
) {

136  
sù
->
sù_vîsi⁄
;

137 
	}
}

139 
osù_uri_t
 *
	$osù_mesßge_gë_uri
(c⁄° 
osù_mesßge_t
 *
sù
) {

140  
sù
->
ªq_uri
;

141 
	}
}

143 
	$°rˇt_sim∂e_hódî
(**
_°rög
, 
size_t
 *
mÆloc_size
, **
_mesßge
, *
±r_hódî
, *
hódî_«me
, size_à
size_of_hódî
, (*
xxx_to_°r
)(*, **), **
√xt
) {

144 *
°rög
;

145 *
mesßge
;

146 *
tmp
;

147 
i
;

149 
°rög
 = *
_°rög
;

150 
mesßge
 = *
_mesßge
;

152 i‡(
±r_hódî
 !
NULL
) {

153 i‡(*
mÆloc_size
 < 
mesßge
 - 
°rög
 + 100 + 
size_of_hódî
) {

155 
size_t
 
size
 = 
mesßge
 - 
°rög
;

157 *
mÆloc_size
 = 
mesßge
 - 
°rög
 + 
size_of_hódî
 + 100;

158 
°rög
 = 
	`osù_ªÆloc
(°rög, *
mÆloc_size
);

160 i‡(
°rög
 =
NULL
) {

161 
	`osù_‰ì
(*
_°rög
);

162 *
_°rög
 = 
NULL
;

163 *
_mesßge
 = 
NULL
;

164  
OSIP_NOMEM
;

167 *
_°rög
 = 
°rög
;

168 
mesßge
 = 
°rög
 + 
size
;

171 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
hódî_«me
, 
size_of_hódî
);

173 
i
 = 
	`xxx_to_°r
(
±r_hódî
, &
tmp
);

175 i‡(
i
 != 0) {

176 *
_°rög
 = 
°rög
;

177 *
_mesßge
 = 
mesßge
;

178 *
√xt
 = 
NULL
;

179  
i
;

182 i‡(*
mÆloc_size
 < 
mesßge
 - 
°rög
 + 
	`°æí
(
tmp
) + 100) {

183 
size_t
 
size
 = 
mesßge
 - 
°rög
;

185 *
mÆloc_size
 = 
mesßge
 - 
°rög
 + 
	`°æí
(
tmp
) + 100;

186 
°rög
 = 
	`osù_ªÆloc
(°rög, *
mÆloc_size
);

188 i‡(
°rög
 =
NULL
) {

189 
	`osù_‰ì
(*
_°rög
);

190 *
_°rög
 = 
NULL
;

191 *
_mesßge
 = 
NULL
;

192  
OSIP_NOMEM
;

195 *
_°rög
 = 
°rög
;

196 
mesßge
 = 
°rög
 + 
size
;

199 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
tmp
);

200 
	`osù_‰ì
(
tmp
);

201 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

204 *
_°rög
 = 
°rög
;

205 *
_mesßge
 = 
mesßge
;

206 *
√xt
 = 
mesßge
;

207  
OSIP_SUCCESS
;

208 
	}
}

210 
	$°rˇt_hódîs_⁄e_≥r_löe
(**
_°rög
, 
size_t
 *
mÆloc_size
, **
_mesßge
, 
osù_li°_t
 *
hódîs
, *
hódî
, size_à
size_of_hódî
, (*
xxx_to_°r
)(*, **), **
√xt
) {

211 *
°rög
;

212 *
mesßge
;

213 *
tmp
;

214 
i
;

215 
osù_li°_ôî©‹_t
 
ô
;

216 *
ñt
 = 
	`osù_li°_gë_fú°
(
hódîs
, &
ô
);

218 
°rög
 = *
_°rög
;

219 
mesßge
 = *
_mesßge
;

221 
ñt
 !
OSIP_SUCCESS
) {

222 i‡(*
mÆloc_size
 < 
mesßge
 - 
°rög
 + 100 + 
size_of_hódî
)

226 
size_t
 
size
 = 
mesßge
 - 
°rög
;

228 *
mÆloc_size
 = 
mesßge
 - 
°rög
 + 
size_of_hódî
 + 100;

229 
°rög
 = 
	`osù_ªÆloc
(°rög, *
mÆloc_size
);

231 i‡(
°rög
 =
NULL
) {

232 
	`osù_‰ì
(*
_°rög
);

233 *
_°rög
 = 
NULL
;

234 *
_mesßge
 = 
NULL
;

235  
OSIP_NOMEM
;

238 *
_°rög
 = 
°rög
;

239 
mesßge
 = 
°rög
 + 
size
;

242 
	`osù_°∫˝y
(
mesßge
, 
hódî
, 
size_of_hódî
);

243 
i
 = 
	`xxx_to_°r
(
ñt
, &
tmp
);

245 i‡(
i
 != 0) {

246 *
_°rög
 = 
°rög
;

247 *
_mesßge
 = 
mesßge
;

248 *
√xt
 = 
NULL
;

249  
i
;

252 
mesßge
 = mesßgê+ 
	`°æí
(message);

254 i‡(*
mÆloc_size
 < 
mesßge
 - 
°rög
 + 
	`°æí
(
tmp
) + 100) {

255 
size_t
 
size
 = 
mesßge
 - 
°rög
;

257 *
mÆloc_size
 = 
mesßge
 - 
°rög
 + 
	`°æí
(
tmp
) + 100;

258 
°rög
 = 
	`osù_ªÆloc
(°rög, *
mÆloc_size
);

260 i‡(
°rög
 =
NULL
) {

261 
	`osù_‰ì
(*
_°rög
);

262 *
_°rög
 = 
NULL
;

263 *
_mesßge
 = 
NULL
;

264  
OSIP_NOMEM
;

267 *
_°rög
 = 
°rög
;

268 
mesßge
 = 
°rög
 + 
size
;

271 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
tmp
);

272 
	`osù_‰ì
(
tmp
);

273 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

274 
ñt
 = 
	`osù_li°_gë_√xt
(&
ô
);

277 *
_°rög
 = 
°rög
;

278 *
_mesßge
 = 
mesßge
;

279 *
√xt
 = 
mesßge
;

280  
OSIP_SUCCESS
;

281 
	}
}

288 
	$osù_mesßge_gë__¥›îty
(c⁄° 
osù_mesßge_t
 *
sù
) {

289 i‡(
sù
 =
NULL
)

290  
OSIP_BADPARAMETER
;

292  
sù
->
mesßge_¥›îty
;

293 
	}
}

295 
	$osù_mesßge_f‹˚_upd©e
(
osù_mesßge_t
 *
sù
) {

296 i‡(
sù
 =
NULL
)

297  
OSIP_BADPARAMETER
;

299 
sù
->
mesßge_¥›îty
 = 2;

300  
OSIP_SUCCESS
;

301 
	}
}

303 
	$_osù_mesßge_ªÆloc
(**
mesßge
, **
de°
, 
size_t
 
√eded
, size_à*
mÆloc_size
) {

304 
size_t
 
size
 = *
mesßge
 - *
de°
;

306 i‡(*
mÆloc_size
 < (
size_t
)(
size
 + 
√eded
 + 100)) {

307 *
mÆloc_size
 = 
size
 + 
√eded
 + 100;

308 *
de°
 = 
	`osù_ªÆloc
(*de°, *
mÆloc_size
);

310 i‡(*
de°
 =
NULL
)

311  
OSIP_NOMEM
;

313 *
mesßge
 = *
de°
 + 
size
;

316  
OSIP_SUCCESS
;

317 
	}
}

319 
	$_osù_mesßge_to_°r
(
osù_mesßge_t
 *
sù
, **
de°
, 
size_t
 *
mesßge_Àngth
, 
sù‰ag
) {

320 
size_t
 
mÆloc_size
;

321 
size_t
 
tŸÆ_Àngth
 = 0;

324 *
°¨t_of_bodõs
;

325 *
c⁄ã¡_Àngth_to_modify
 = 
NULL
;

327 *
mesßge
;

328 *
√xt
;

329 *
tmp
;

330 
pos
;

331 
i
;

332 *
bound¨y
 = 
NULL
;

334 
mÆloc_size
 = 
SIP_MESSAGE_MAX_LENGTH
;

336 *
de°
 = 
NULL
;

338 i‡(
sù
 =
NULL
)

339  
OSIP_BADPARAMETER
;

342 i‡(1 =
	`osù_mesßge_gë__¥›îty
(
sù
)) {

344 *
de°
 = 
	`osù_mÆloc
(
sù
->
mesßge_Àngth
 + 1);

346 i‡(*
de°
 =
NULL
)

347  
OSIP_NOMEM
;

349 
	`mem˝y
(*
de°
, 
sù
->
mesßge
, sù->
mesßge_Àngth
);

350 (*
de°
)[
sù
->
mesßge_Àngth
] = '\0';

352 i‡(
mesßge_Àngth
 !
NULL
)

353 *
mesßge_Àngth
 = 
sù
->message_length;

355  
OSIP_SUCCESS
;

359 
	`osù_‰ì
(
sù
->
mesßge
);

360 
sù
->
mesßge
 = 
NULL
;

364 
mesßge
 = (*Ë
	`osù_mÆloc
(
SIP_MESSAGE_MAX_LENGTH
);

366 i‡(
mesßge
 =
NULL
)

367  
OSIP_NOMEM
;

369 *
de°
 = 
mesßge
;

372 
i
 = 
	`__osù_mesßge_°¨éöe_to_°r
(
sù
, &
tmp
);

374 i‡(
i
 != 0) {

375 i‡(!
sù‰ag
) {

376 
	`osù_‰ì
(*
de°
);

377 *
de°
 = 
NULL
;

378  
i
;

384 
size_t
 
mesßge_Àn
 = 
	`°æí
(
tmp
);

386 i‡(
	`_osù_mesßge_ªÆloc
(&
mesßge
, 
de°
, 
mesßge_Àn
 + 3, &
mÆloc_size
) < 0) {

387 
	`osù_‰ì
(
tmp
);

388 *
de°
 = 
NULL
;

389  
OSIP_NOMEM
;

392 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
tmp
);

393 
	`osù_‰ì
(
tmp
);

394 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

398 
	sto_°r_èbÀ
 {

399 
hódî_«me
[30];

400 
hódî_Àngth
;

401 
osù_li°_t
 *
hódî_li°
;

402 *
hódî_d©a
;

403 (*
to_°r
)(*, **);

405 #i‚de‡
MINISIZE


406 
èbÀ
[25] =

408 
èbÀ
[16] =

410 {{"Vü: ", 5, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_vü_to_°r
},

411 {"Rec‹d-Rouã: ", 14, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ªc‹d_rouã_to_°r
},

412 {"Rouã: ", 7, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_rouã_to_°r
},

413 {"From: ", 6, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_‰om_to_°r
},

414 {"To: ", 4, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_to_to_°r
},

415 {"CÆl-ID: ", 9, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ˇŒ_id_to_°r
},

416 {"CSeq: ", 6, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_c£q_to_°r
},

417 {"C⁄è˘: ", 9, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_c⁄è˘_to_°r
},

418 {"Auth‹iz©i⁄: ", 15, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_auth‹iz©i⁄_to_°r
},

419 {"WWW-Authítiˇã: ", 18, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_www_authítiˇã_to_°r
},

420 {"Proxy-Authítiˇã: ", 20, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_www_authítiˇã_to_°r
},

421 {"Proxy-Auth‹iz©i⁄: ", 21, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_auth‹iz©i⁄_to_°r
},

422 {"CÆl-Info: ", 11, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ˇŒ_öfo_to_°r
},

423 {"C⁄ã¡-Ty≥: ", 14, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_c⁄ã¡_ty≥_to_°r
},

424 {"Mime-Vîsi⁄: ", 14, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_c⁄ã¡_Àngth_to_°r
},

425 #i‚de‡
MINISIZE


426 {"AŒow: ", 7, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_Ælow_to_°r
},

427 {"C⁄ã¡-Encodög: ", 18, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_c⁄ã¡_ícodög_to_°r
},

428 {"AÀπ-Info: ", 12, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ˇŒ_öfo_to_°r
},

429 {"Eº‹-Info: ", 12, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ˇŒ_öfo_to_°r
},

430 {"Ac˚±: ", 8, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ac˚±_to_°r
},

431 {"Ac˚±-Encodög: ", 17, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ac˚±_ícodög_to_°r
},

432 {"Ac˚±-L™guage: ", 17, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_ac˚±_œnguage_to_°r
},

433 {"Authítiˇti⁄-Info: ", 21, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_authítiˇti⁄_öfo_to_°r
},

434 {"Proxy-Authítiˇti⁄-Info: ", 27, 
NULL
, NULL, ((*)(*, **)Ë& 
osù_authítiˇti⁄_öfo_to_°r
},

436 {{'\0'}, 0, 
NULL
, NULL, NULL}};

437 
èbÀ
[0].
hódî_li°
 = &
sù
->
vüs
;

438 
èbÀ
[1].
hódî_li°
 = &
sù
->
ªc‹d_rouãs
;

439 
èbÀ
[2].
hódî_li°
 = &
sù
->
rouãs
;

440 
èbÀ
[3].
hódî_d©a
 = 
sù
->
‰om
;

441 
èbÀ
[4].
hódî_d©a
 = 
sù
->
to
;

442 
èbÀ
[5].
hódî_d©a
 = 
sù
->
ˇŒ_id
;

443 
èbÀ
[6].
hódî_d©a
 = 
sù
->
c£q
;

444 
èbÀ
[7].
hódî_li°
 = &
sù
->
c⁄è˘s
;

445 
èbÀ
[8].
hódî_li°
 = &
sù
->
auth‹iz©i⁄s
;

446 
èbÀ
[9].
hódî_li°
 = &
sù
->
www_authítiˇãs
;

447 
èbÀ
[10].
hódî_li°
 = &
sù
->
¥oxy_authítiˇãs
;

448 
èbÀ
[11].
hódî_li°
 = &
sù
->
¥oxy_auth‹iz©i⁄s
;

449 
èbÀ
[12].
hódî_li°
 = &
sù
->
ˇŒ_öfos
;

450 
èbÀ
[13].
hódî_d©a
 = 
sù
->
c⁄ã¡_ty≥
;

451 
èbÀ
[14].
hódî_d©a
 = 
sù
->
mime_vîsi⁄
;

452 #i‚de‡
MINISIZE


453 
èbÀ
[15].
hódî_li°
 = &
sù
->
Ælows
;

454 
èbÀ
[16].
hódî_li°
 = &
sù
->
c⁄ã¡_ícodögs
;

455 
èbÀ
[17].
hódî_li°
 = &
sù
->
Æît_öfos
;

456 
èbÀ
[18].
hódî_li°
 = &
sù
->
îr‹_öfos
;

457 
èbÀ
[19].
hódî_li°
 = &
sù
->
ac˚±s
;

458 
èbÀ
[20].
hódî_li°
 = &
sù
->
ac˚±_ícodögs
;

459 
èbÀ
[21].
hódî_li°
 = &
sù
->
ac˚±_œnguages
;

460 
èbÀ
[22].
hódî_li°
 = &
sù
->
authítiˇti⁄_öfos
;

461 
èbÀ
[23].
hódî_li°
 = &
sù
->
¥oxy_authítiˇti⁄_öfos
;

464 
pos
 = 0;

466 
èbÀ
[
pos
].
hódî_«me
[0] != '\0') {

467 i‡(
èbÀ
[13].
hódî_li°
 =
NULL
)

468 
i
 = 
	`°rˇt_sim∂e_hódî
(
de°
, &
mÆloc_size
, &
mesßge
, 
èbÀ
[
pos
].
hódî_d©a
,ÅabÀ[pos].
hódî_«me
,ÅabÀ[pos].
hódî_Àngth
, (((*)(*, **)ËèbÀ[pos].
to_°r
), &
√xt
);

470 
i
 = 
	`°rˇt_hódîs_⁄e_≥r_löe
(
de°
, &
mÆloc_size
, &
mesßge
, 
èbÀ
[
pos
].
hódî_li°
,ÅabÀ[pos].
hódî_«me
,ÅabÀ[pos].
hódî_Àngth
, (((*)(*, **)ËèbÀ[pos].
to_°r
), &
√xt
);

472 i‡(
i
 != 0) {

473 
	`osù_‰ì
(*
de°
);

474 *
de°
 = 
NULL
;

475  
i
;

478 
mesßge
 = 
√xt
;

480 
pos
++;

485 
osù_li°_ôî©‹_t
 
ô
;

486 
osù_hódî_t
 *
hódî
 = (osù_hódî_à*Ë
	`osù_li°_gë_fú°
(&
sù
->
hódîs
, &
ô
);

488 
hódî
 !
OSIP_SUCCESS
) {

489 
size_t
 
hódî_Àn
 = 0;

491 
i
 = 
	`osù_hódî_to_°r
(
hódî
, &
tmp
);

493 i‡(
i
 != 0) {

494 
	`osù_‰ì
(*
de°
);

495 *
de°
 = 
NULL
;

496  
i
;

499 
hódî_Àn
 = 
	`°æí
(
tmp
);

501 i‡(
	`_osù_mesßge_ªÆloc
(&
mesßge
, 
de°
, 
hódî_Àn
 + 3, &
mÆloc_size
) < 0) {

502 
	`osù_‰ì
(
tmp
);

503 *
de°
 = 
NULL
;

504  
OSIP_NOMEM
;

507 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
tmp
);

508 
	`osù_‰ì
(
tmp
);

509 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

511 
hódî
 = (
osù_hódî_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

518 i‡(
	`_osù_mesßge_ªÆloc
(&
mesßge
, 
de°
, 16, &
mÆloc_size
) < 0)

519  
OSIP_NOMEM
;

521 i‡(
sù‰ag
 && 
	`osù_li°_eﬁ
(&
sù
->
bodõs
, 0)) {

523 
	`osù_°∫˝y
(
mesßge
, 
OSIP_CRLF
, 2);

524 
mesßge
 = message + 2;

527 
sù
->
mesßge_¥›îty
 = 1;

528 
sù
->
mesßge
 = 
	`osù_°rdup
(*
de°
);

529 
sù
->
mesßge_Àngth
 = 
mesßge
 - *
de°
;

531 i‡(
mesßge_Àngth
 !
NULL
)

532 *
mesßge_Àngth
 = 
mesßge
 - *
de°
;

534  
OSIP_SUCCESS
;

537 
	`osù_°∫˝y
(
mesßge
, "Content-Length: ", 16);

538 
mesßge
 = message + 16;

555 i‡(
	`osù_li°_eﬁ
(&
sù
->
bodõs
, 0))

556 
mesßge
 = 
	`osù_°∫_≠≥nd
(message, "0", 1);

567 
c⁄ã¡_Àngth_to_modify
 = 
mesßge
;

568 
mesßge
 = 
	`osù_°r_≠≥nd
(message, " ");

573 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

576 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

578 
°¨t_of_bodõs
 = 
mesßge
;

579 
tŸÆ_Àngth
 = 
°¨t_of_bodõs
 - *
de°
;

581 i‡(
	`osù_li°_eﬁ
(&
sù
->
bodõs
, 0)) {

583 
sù
->
mesßge_¥›îty
 = 1;

584 
sù
->
mesßge
 = 
	`osù_°rdup
(*
de°
);

585 
sù
->
mesßge_Àngth
 = 
tŸÆ_Àngth
;

587 i‡(
mesßge_Àngth
 !
NULL
)

588 *
mesßge_Àngth
 = 
tŸÆ_Àngth
;

590  
OSIP_SUCCESS
;

593 i‡(
sù
->
c⁄ã¡_ty≥
 && sù->c⁄ã¡_ty≥->
ty≥
 && !
	`osù_°rˇ£cmp
(sip->content_type->type, "multipart")) {

594 
osù_gíîic_∑øm_t
 *
˘_∑øm
 = 
NULL
;

597 
i
 = 
	`osù_gíîic_∑øm_gë_by«me
(&
sù
->
c⁄ã¡_ty≥
->
gí_∑øms
, "bound¨y", &
˘_∑øm
);

599 i‡((
i
 >0Ë&& 
˘_∑øm
 && ct_∑øm->
gvÆue
) {

600 
size_t
 
Àn
 = 
	`°æí
(
˘_∑øm
->
gvÆue
);

602 i‡(
Àn
 > 
MIME_MAX_BOUNDARY_LEN
) {

603 
	`osù_‰ì
(*
de°
);

604 *
de°
 = 
NULL
;

605  
OSIP_SYNTAXERROR
;

608 i‡(
Àn
 =1 && 
˘_∑øm
->
gvÆue
[0] == '"') {

609 
	`osù_‰ì
(*
de°
);

610 *
de°
 = 
NULL
;

611  
OSIP_SYNTAXERROR
;

614 i‡(
Àn
 =2 && 
˘_∑øm
->
gvÆue
[0] == '"' && ct_param->gvalue[1] == '"') {

615 
	`osù_‰ì
(*
de°
);

616 *
de°
 = 
NULL
;

617  
OSIP_SYNTAXERROR
;

620 
bound¨y
 = 
	`osù_mÆloc
(
Àn
 + 5);

622 i‡(
bound¨y
 =
NULL
) {

623 
	`osù_‰ì
(*
de°
);

624 *
de°
 = 
NULL
;

625  
OSIP_NOMEM
;

628 
	`osù_°∫˝y
(
bound¨y
, 
OSIP_CRLF
, 2);

629 
	`osù_°∫˝y
(
bound¨y
 + 2, "--", 2);

631 i‡(
˘_∑øm
->
gvÆue
[0] ='"' && ct_∑øm->gvÆue[
Àn
 - 1] == '"')

632 
	`osù_°∫˝y
(
bound¨y
 + 4, 
˘_∑øm
->
gvÆue
 + 1, 
Àn
 - 2);

635 
	`osù_°∫˝y
(
bound¨y
 + 4, 
˘_∑øm
->
gvÆue
, 
Àn
);

640 
osù_li°_ôî©‹_t
 
ô
;

641 
osù_body_t
 *
body
 = (osù_body_à*Ë
	`osù_li°_gë_fú°
(&
sù
->
bodõs
, &
ô
);

643 
body
 !
OSIP_SUCCESS
) {

644 
size_t
 
body_Àngth
;

646 i‡(
bound¨y
) {

649 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
bound¨y
);

650 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

653 
i
 = 
	`osù_body_to_°r
(
body
, &
tmp
, &
body_Àngth
);

655 i‡(
i
 != 0) {

656 
	`osù_‰ì
(*
de°
);

657 *
de°
 = 
NULL
;

659 i‡(
bound¨y
)

660 
	`osù_‰ì
(
bound¨y
);

662  
i
;

665 i‡(
mÆloc_size
 < 
mesßge
 - *
de°
 + 100 + 
body_Àngth
) {

666 
size_t
 
size
 = 
mesßge
 - *
de°
;

667 
off£t_of_body
;

668 
off£t_c⁄ã¡_Àngth_to_modify
 = 0;

670 
off£t_of_body
 = (Ë(
°¨t_of_bodõs
 - *
de°
);

672 i‡(
c⁄ã¡_Àngth_to_modify
 !
NULL
)

673 
off£t_c⁄ã¡_Àngth_to_modify
 = (Ë(
c⁄ã¡_Àngth_to_modify
 - *
de°
);

675 
mÆloc_size
 = 
mesßge
 - *
de°
 + 
body_Àngth
 + 100;

676 *
de°
 = 
	`osù_ªÆloc
(*de°, 
mÆloc_size
);

678 i‡(*
de°
 =
NULL
) {

679 
	`osù_‰ì
(
tmp
);

681 i‡(
bound¨y
)

682 
	`osù_‰ì
(
bound¨y
);

684  
OSIP_NOMEM
;

687 
°¨t_of_bodõs
 = *
de°
 + 
off£t_of_body
;

689 i‡(
c⁄ã¡_Àngth_to_modify
 !
NULL
)

690 
c⁄ã¡_Àngth_to_modify
 = *
de°
 + 
off£t_c⁄ã¡_Àngth_to_modify
;

692 
mesßge
 = *
de°
 + 
size
;

695 
	`mem˝y
(
mesßge
, 
tmp
, 
body_Àngth
);

696 
mesßge
[
body_Àngth
] = '\0';

697 
	`osù_‰ì
(
tmp
);

698 
mesßge
 = mesßgê+ 
body_Àngth
;

700 
body
 = (
osù_body_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

704 i‡(
bound¨y
) {

707 
mesßge
 = 
	`osù_°r_≠≥nd
(mesßge, 
bound¨y
);

708 
mesßge
 = 
	`osù_°∫_≠≥nd
(message, "--", 2);

709 
mesßge
 = 
	`osù_°∫_≠≥nd
(mesßge, 
OSIP_CRLF
, 2);

711 
	`osù_‰ì
(
bound¨y
);

712 
bound¨y
 = 
NULL
;

715 i‡(
c⁄ã¡_Àngth_to_modify
 =
NULL
) {

716 
	`osù_‰ì
(*
de°
);

717 *
de°
 = 
NULL
;

718  
OSIP_SYNTAXERROR
;

723 
size_t
 
size
 = 
mesßge
 - 
°¨t_of_bodõs
;

724 
tmp2
[15];

726 
tŸÆ_Àngth
 +
size
;

727 
	`¢¥ötf
(
tmp2
, 15, "%i", (Ë
size
);

729 
	`mem˝y
(
c⁄ã¡_Àngth_to_modify
 + 5 - 
	`°æí
(
tmp2
),Åmp2, strlen(tmp2));

733 
sù
->
mesßge_¥›îty
 = 1;

734 
sù
->
mesßge
 = 
	`osù_mÆloc
(
tŸÆ_Àngth
 + 1);

736 i‡(
sù
->
mesßge
 !
NULL
) {

737 
	`mem˝y
(
sù
->
mesßge
, *
de°
, 
tŸÆ_Àngth
);

738 
sù
->
mesßge
[
tŸÆ_Àngth
] = '\0';

739 
sù
->
mesßge_Àngth
 = 
tŸÆ_Àngth
;

741 i‡(
mesßge_Àngth
 !
NULL
)

742 *
mesßge_Àngth
 = 
tŸÆ_Àngth
;

745  
OSIP_SUCCESS
;

746 
	}
}

748 
	$osù_mesßge_to_°r
(
osù_mesßge_t
 *
sù
, **
de°
, 
size_t
 *
mesßge_Àngth
) {

749  
	`_osù_mesßge_to_°r
(
sù
, 
de°
, 
mesßge_Àngth
, 0);

750 
	}
}

752 
	$osù_mesßge_to_°r_sù‰ag
(
osù_mesßge_t
 *
sù
, **
de°
, 
size_t
 *
mesßge_Àngth
) {

753  
	`_osù_mesßge_to_°r
(
sù
, 
de°
, 
mesßge_Àngth
, 1);

754 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_mime_version.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

30 
	$osù_mesßge_£t_mime_vîsi⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

31 
i
;

33 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 i‡(
sù
->
mime_vîsi⁄
 !
NULL
)

37  
OSIP_SYNTAXERROR
;

39 
i
 = 
	`osù_mime_vîsi⁄_öô
(&(
sù
->
mime_vîsi⁄
));

41 i‡(
i
 != 0)

42  
i
;

44 
sù
->
mesßge_¥›îty
 = 2;

45 
i
 = 
	`osù_mime_vîsi⁄_∑r£
(
sù
->
mime_vîsi⁄
, 
hvÆue
);

47 i‡(
i
 != 0) {

48 
	`osù_mime_vîsi⁄_‰ì
(
sù
->
mime_vîsi⁄
);

49 
sù
->
mime_vîsi⁄
 = 
NULL
;

50  
i
;

53  
OSIP_SUCCESS
;

54 
	}
}

56 #i‚de‡
MINISIZE


60 
osù_mime_vîsi⁄_t
 *
	$osù_mesßge_gë_mime_vîsi⁄
(c⁄° 
osù_mesßge_t
 *
sù
) {

61  
sù
->
mime_vîsi⁄
;

62 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_parser_cfg.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_∑r£r.h
>

24 
	~"∑r£r.h
"

26 
__osù_mesßge_c⁄fig_t
 
	gpc⁄fig
[
NUMBER_OF_HEADERS
];

27 
__osù_mesßge_c⁄fig_comma£∑øãd_t
 
	gpc⁄fig_comma£p
[
NUMBER_OF_HEADERS_COMMASEPARATED
];

35 #i‚de‡
HASH_TABLE_SIZE


36 #ifde‡
__amd64__


37 
	#HASH_TABLE_SIZE
 150

	)

39 
	#HASH_TABLE_SIZE
 \

40 150

	)

44 
	ghdr_ªf_èbÀ
[
HASH_TABLE_SIZE
];

60 
	$∑r£r_öô
() {

61 
i
 = 0;

62 
h«me_Àngth
 = (
pc⁄fig_comma£p
[0].
h«me
);

64 
	`mem£t
(
pc⁄fig_comma£p
, 0, (pconfig_commasep));

66 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept");

67 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "a");

68 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept-Encoding");

69 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept-Language");

70 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Alert-Info");

71 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Allow");

72 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Authentication-Info");

73 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Call-Info");

74 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Contact");

75 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "m");

76 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Content-Encoding");

77 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "e");

78 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Content-Language");

79 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Error-Info");

80 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "In-Reply-To");

81 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Proxy-Require");

82 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Record-Route");

83 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Require");

84 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Route");

85 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Supported");

86 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "k");

87 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Unsupported");

88 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Via");

89 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "v");

90 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Warning");

93 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Media-Authorization");

96 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Asserted-Identity");

97 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Preferred-Identity");

100 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Reason");

103 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Path");

106 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Security-Client");

107 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Security-Server");

108 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Security-Verify");

111 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Service-Route");

114 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Request-Disposition");

115 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "d");

116 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept-Contact");

117 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "a");

118 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Reject-Contact");

119 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "j");

122 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Resource-Priority");

123 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept-Resource-Priority");

126 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Early-Media");

129 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Refused-URI-List");

132 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Permission-Missing");

133 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Trigger-Consent");

136 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Asserted-Service");

137 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Preferred-Service");

140 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Recv-Info");

143 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Allow-Events");

144 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "u");

147 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Policy-ID");

148 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Policy-Contact");

151 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Feature-Caps");

154 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "History-Info");

155 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "Accept");

158 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Associated-URI");

159 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Visited-Network-ID");

160 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Access-Network-Info");

161 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "P-Charging-Function-Addresses");

164 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
++].
h«me
, 
h«me_Àngth
, "%s", "User-to-User");

166 
i
 = 0;

167 #i‚de‡
MINISIZE


168 
pc⁄fig
[
i
].
h«me
 = 
ACCEPT
;

169 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

170 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ac˚±
);

171 
pc⁄fig
[
i
].
h«me
 = 
ACCEPT_ENCODING
;

172 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

173 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ac˚±_ícodög
);

174 
pc⁄fig
[
i
].
h«me
 = 
ACCEPT_LANGUAGE
;

175 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

176 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ac˚±_œnguage
);

177 
pc⁄fig
[
i
].
h«me
 = 
ALERT_INFO
;

178 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

179 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_Æît_öfo
);

180 
pc⁄fig
[
i
].
h«me
 = 
ALLOW
;

181 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

182 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_Ælow
);

183 
pc⁄fig
[
i
].
h«me
 = 
AUTHENTICATION_INFO
;

184 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

185 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_authítiˇti⁄_öfo
);

187 
pc⁄fig
[
i
].
h«me
 = 
AUTHORIZATION
;

188 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

189 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_auth‹iz©i⁄
);

190 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_TYPE_SHORT
;

191 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

192 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_ty≥
);

193 
pc⁄fig
[
i
].
h«me
 = 
CALL_ID
;

194 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

195 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ˇŒ_id
);

196 #i‚de‡
MINISIZE


197 
pc⁄fig
[
i
].
h«me
 = 
CALL_INFO
;

198 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

199 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ˇŒ_öfo
);

201 
pc⁄fig
[
i
].
h«me
 = 
CONTACT
;

202 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

203 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄è˘
);

204 #i‚de‡
MINISIZE


205 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_ENCODING
;

206 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

207 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_ícodög
);

209 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_LENGTH
;

210 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

211 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_Àngth
);

212 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_TYPE
;

213 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

214 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_ty≥
);

215 
pc⁄fig
[
i
].
h«me
 = 
CSEQ
;

216 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

217 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c£q
);

218 #i‚de‡
MINISIZE


219 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_ENCODING_SHORT
;

220 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

221 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_ícodög
);

222 
pc⁄fig
[
i
].
h«me
 = 
ERROR_INFO
;

223 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

224 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_îr‹_öfo
);

226 
pc⁄fig
[
i
].
h«me
 = 
FROM_SHORT
;

227 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

228 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_‰om
);

229 
pc⁄fig
[
i
].
h«me
 = 
FROM
;

230 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

231 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_‰om
);

232 
pc⁄fig
[
i
].
h«me
 = 
CALL_ID_SHORT
;

233 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

234 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ˇŒ_id
);

235 
pc⁄fig
[
i
].
h«me
 = 
CONTENT_LENGTH_SHORT
;

236 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

237 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄ã¡_Àngth
);

238 
pc⁄fig
[
i
].
h«me
 = 
CONTACT_SHORT
;

239 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

240 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_c⁄è˘
);

241 
pc⁄fig
[
i
].
h«me
 = 
MIME_VERSION
;

242 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

243 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_mime_vîsi⁄
);

244 
pc⁄fig
[
i
].
h«me
 = 
PROXY_AUTHENTICATE
;

245 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

246 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_¥oxy_authítiˇã
);

247 #i‚de‡
MINISIZE


248 
pc⁄fig
[
i
].
h«me
 = 
PROXY_AUTHENTICATION_INFO
;

249 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

250 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_¥oxy_authítiˇti⁄_öfo
);

252 
pc⁄fig
[
i
].
h«me
 = 
PROXY_AUTHORIZATION
;

253 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

254 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_¥oxy_auth‹iz©i⁄
);

255 
pc⁄fig
[
i
].
h«me
 = 
RECORD_ROUTE
;

256 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

257 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_ªc‹d_rouã
);

258 
pc⁄fig
[
i
].
h«me
 = 
ROUTE
;

259 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

260 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_rouã
);

261 
pc⁄fig
[
i
].
h«me
 = 
TO_SHORT
;

262 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

263 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_to
);

264 
pc⁄fig
[
i
].
h«me
 = 
TO
;

265 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

266 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_to
);

267 
pc⁄fig
[
i
].
h«me
 = 
VIA_SHORT
;

268 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

269 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_vü
);

270 
pc⁄fig
[
i
].
h«me
 = 
VIA
;

271 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 0;

272 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_vü
);

273 
pc⁄fig
[
i
].
h«me
 = 
WWW_AUTHENTICATE
;

274 
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 = 1;

275 
pc⁄fig
[
i
++].
£thódî
 = (&
osù_mesßge_£t_www_authítiˇã
);

280 
i
 = 0; i < 
HASH_TABLE_SIZE
; i++) {

281 
hdr_ªf_èbÀ
[
i
] = -1;

284 
i
 = 0; i < 
NUMBER_OF_HEADERS
; i++) {

285 
hash
;

289 
hash
 = 
	`osù_hash
(
pc⁄fig
[
i
].
h«me
);

290 
hash
 = hash % 
HASH_TABLE_SIZE
;

292 i‡(
hdr_ªf_èbÀ
[
hash
] == -1) {

294 
hdr_ªf_èbÀ
[
hash
] = 
i
;

299 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "conflict with current hashtable size\n"));

300  
OSIP_UNDEFINED_ERROR
;

304  
OSIP_SUCCESS
;

305 
	}
}

307 
	$∑r£r_add_comma_£∑øãd_hódî
(c⁄° *
h«me
) {

308 
i
;

310 
i
 = 0; i < 
NUMBER_OF_HEADERS_COMMASEPARATED
; i++) {

311 i‡(
pc⁄fig_comma£p
[
i
].
h«me
[0] == '\0') {

312 
	`¢¥ötf
(
pc⁄fig_comma£p
[
i
].
h«me
, (pconfig_commasep[i].hname), "%s", hname);

313  
OSIP_SUCCESS
;

317  
OSIP_UNDEFINED_ERROR
;

318 
	}
}

320 
	$__osù_mesßge_is_hódî_comma_£∑øãd
(c⁄° *
h«me
) {

321 
i
;

323 
i
 = 0; i < 
NUMBER_OF_HEADERS_COMMASEPARATED
; i++) {

324 i‡(
pc⁄fig_comma£p
[
i
].
h«me
[0] == '\0')

327 i‡(
	`osù_°rˇ£cmp
(
pc⁄fig_comma£p
[
i
].
h«me
, hname) == 0)

328  
OSIP_SUCCESS
;

331  
OSIP_UNDEFINED_ERROR
;

332 
	}
}

336 
	$__osù_mesßge_is_known_hódî
(c⁄° *
h«me
) {

337 
hash
;

338 
ªsu…
 = -1;

340 
ödex
;

342 
hash
 = 
	`osù_hash
(
h«me
);

343 
hash
 = hash % 
HASH_TABLE_SIZE
;

344 
ödex
 = 
hdr_ªf_èbÀ
[
hash
];

346 i‡((
ödex
 !-1Ë&& (0 =
	`°rcmp
(
pc⁄fig
[ödex].
h«me
, hname))) {

347 
ªsu…
 = 
ödex
;

350  
ªsu…
;

351 
	}
}

356 
	$__osù_mesßge_ˇŒ_mëhod
(
i
, 
osù_mesßge_t
 *
de°
, c⁄° *
hvÆue
) {

357 
îr
;

359 
îr
 = 
pc⁄fig
[
i
].
	`£thódî
(
de°
, 
hvÆue
);

361 i‡(
îr
 < 0) {

362 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "CouldÇŸ së hódî: %s: %s\n", 
pc⁄fig
[
i
].
h«me
, 
hvÆue
));

365 i‡(
pc⁄fig
[
i
].
ign‹ed_whí_övÆid
 == 1)

366  
OSIP_SUCCESS
;

368  
îr
;

369 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_port.c

20 #ifde‡
_WIN32_WCE


21 
	#_INC_TIME


	)

22 
	~<wödows.h
>

25 
	~<osù∑r£r2/öã∫Æ.h
>

27 
	~<osù∑r£r2/osù_p‹t.h
>

29 #ifde‡
HAVE_SYS_TYPES_H


30 
	~<sys/ty≥s.h
>

32 #ifde‡
HAVE_SYS_STAT_H


33 
	~<sys/°©.h
>

35 #ifde‡
HAVE_FCNTL_H


36 
	~<f˙é.h
>

39 #ifde‡
HAVE_CTYPE_H


40 
	~<˘y≥.h
>

43 #i‡
deföed
(
HAVE_STDARG_H
)

44 
	~<°d¨g.h
>

45 
	#VA_START
(
a
, 
f
Ë
	`va_°¨t
◊, f)

	)

47 #i‡
deföed
(
HAVE_VARARGS_H
)

48 
	~<v¨¨gs.h
>

49 
	#VA_START
(
a
, 
f
Ë
	`va_°¨t
◊)

	)

51 
	~<°d¨g.h
>

52 
	#VA_START
(
a
, 
f
Ë
	`va_°¨t
◊, f)

	)

56 #i‡
deföed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

57 
	~<TimeMgr.h
>

58 
	~<SysUtûs.h
>

59 
	~<Sy°emMgr.h
>

60 
	~<SåögMgr.h
>

62 
	~<time.h
>

65 #i‡
deföed
(
__VXWORKS_OS__
)

66 
	~<£À˘Lib.h
>

69 
	~<vxW‹ks.h
>

70 
	~<fioLib.h
>

71 
	~<°rög.h
>

73 #ñi‡
deföed
(
__PALMOS__
)

74 #i‡
__PALMOS__
 >= 0x06000000

75 
	~<sys/time.h
>

76 
	~<SysThªad.h
>

78 #ñi‡(!
deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
))

79 
	~<sys/time.h
>

80 #ñi‡
deföed
(
WIN32
)

81 
	~<wödows.h
>

82 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

83 #i‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

84 
	~<wösock2.h
>

85 #ñi‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PC_APP
)

89 #ifde‡
WIN32_USE_CRYPTO


90 
	~<Wö¸y±.h
>

94 #i‡
deföed
(
__πems__
)

95 
	~<πems.h
>

98 #i‡
deföed
(
HAVE_SYS_UNISTD_H
)

99 
	~<sys/uni°d.h
>

102 #i‡
deföed
(
HAVE_UNISTD_H
)

103 
	~<uni°d.h
>

106 #i‡
deföed
(
HAVE_SYSLOG_H
Ë&& !deföed(
__¨c__
)

107 
	~<sy¶og.h
>

110 #i‡
deföed
(
HAVE_SYS_SELECT_H
)

111 
	~<sys/£À˘.h
>

114 #ifde‡
HAVE_PTH_PTHREAD_H


115 
	~<±hªad.h
>

118 #i‡
deföed
(
__¨c__
)

119 
	#HAVE_LRAND48


	)

122 
FILE
 *
	glogfûe
 = 
NULL
;

123 
	gåacög_èbÀ
[
END_TRACE_LEVEL
];

124 
	gu£_sy¶og
 = 0;

125 
osù_åa˚_func_t
 *
	gåa˚_func
 = 0;

127 
	gøndom_£ed_£t
 = 0;

129 #i‚de‡
MINISIZE


130 #i‡!
deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
)

131 
osù_mÆloc_func_t
 *
	gosù_mÆloc_func
 = 0;

132 
osù_ªÆloc_func_t
 *
	gosù_ªÆloc_func
 = 0;

133 
osù_‰ì_func_t
 *
	gosù_‰ì_func
 = 0;

137 c⁄° *
	gosù_îr‹_èbÀ
[] = {

146 c⁄° *
	$osù_°ªº‹
(
îr
) {

147 i‡(
îr
 > 0)

148  
osù_îr‹_èbÀ
[0];

150 i‡(
îr
 > -60)

151  
osù_îr‹_èbÀ
[-
îr
];

153  
osù_îr‹_èbÀ
[59];

154 
	}
}

156 #i‚de‡
WIN32_USE_CRYPTO


157 
	$osù_buûd_øndom_numbî
()

159 
	$osù_ÁŒback_øndom_numbî
()

162 i‡(!
øndom_£ed_£t
) {

163 
ticks
;

165 #ifde‡
__PALMOS__


166 #i‡
__PALMOS__
 < 0x06000000

167 
	`SysR™dom
((
I¡32
Ë
	`TimGëTicks
());

169 
timevÆ
 
tv
;

171 
	`gëtimeofday
(&
tv
, 
NULL
);

172 
	`§™d
(
tv
.
tv_u£c
);

173 
ticks
 = 
tv
.
tv_£c
 +Åv.
tv_u£c
;

175 #ñi‡
	`deföed
(
WIN32
)

176 
LARGE_INTEGER
 
lCou¡
;

178 
	`QuîyPîf‹m™˚Cou¡î
(&
lCou¡
);

179 
ticks
 = 
lCou¡
.
LowP¨t
 +ÜCou¡.
HighP¨t
;

180 #ñi‡
	`deföed
(
_WIN32_WCE
)

181 
ticks
 = 
	`GëTickCou¡
();

182 #ñi‡
	`deföed
(
__PSOS__
)

183 #ñi‡
	`deföed
(
__πems__
)

184 
	`πems_˛ock_gë
(
RTEMS_CLOCK_GET_TICKS_SINCE_BOOT
, &
ticks
);

185 #ñi‡
	`deföed
(
__VXWORKS_OS__
)

186 
time•ec
 
ç
;

188 
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
ç
);

189 
ticks
 = 
ç
.
tv_£c
 +Åp.
tv_n£c
;

191 
timevÆ
 
tv
;

192 
fd
;

194 
	`gëtimeofday
(&
tv
, 
NULL
);

195 
ticks
 = (Ë(
tv
.
tv_£c
 +Åv.
tv_u£c
);

196 
fd
 = 
	`›í
("/dev/uøndom", 
O_RDONLY
);

198 i‡(
fd
 > 0) {

199 
r
;

200 
i
;

202 
i
 = 0; i < 512; i++) {

203 
	`ªad
(
fd
, &
r
, (r));

204 
ticks
 +
r
;

207 
	`˛o£
(
fd
);

212 #ifde‡
HAVE_LRAND48


213 
	`§™d48
(
ticks
);

215 
	`§™d
(
ticks
);

217 
øndom_£ed_£t
 = 1;

220 #ifde‡
HAVE_LRAND48


222 
vÆ
 = (Ë
	`Ã™d48
();

224 i‡(
vÆ
 == 0) {

225 
ticks
;

226 
timevÆ
 
tv
;

228 
	`gëtimeofday
(&
tv
, 
NULL
);

229 
ticks
 = (Ë(
tv
.
tv_£c
 +Åv.
tv_u£c
);

230 
	`§™d48
(
ticks
);

231  (Ë
	`Ã™d48
();

234  
vÆ
;

237  
	`ønd
();

239 
	}
}

241 #ifde‡
WIN32_USE_CRYPTO


243 
	$osù_buûd_øndom_numbî
() {

244 
HCRYPTPROV
 
¸y±o
;

245 
BOOL
 
îr
;

246 
num
;

248 i‡(!
øndom_£ed_£t
) {

249 
ticks
;

250 
LARGE_INTEGER
 
lCou¡
;

252 
	`QuîyPîf‹m™˚Cou¡î
(&
lCou¡
);

253 
ticks
 = 
lCou¡
.
LowP¨t
 +ÜCou¡.
HighP¨t
;

254 
	`§™d
(
ticks
);

255 
øndom_£ed_£t
 = 1;

258 
îr
 = 
	`Cry±AcquúeC⁄ãxt
(&
¸y±o
, 
NULL
, NULL, 
PROV_RSA_FULL
, 
CRYPT_VERIFYCONTEXT
);

260 i‡(
îr
) {

261 
îr
 = 
	`Cry±GíR™dom
(
¸y±o
, (
num
), (
BYTE
 *) &num);

262 
	`Cry±Rñó£C⁄ãxt
(
¸y±o
, 0);

265 i‡(!
îr
) {

266 
num
 = 
	`osù_ÁŒback_øndom_numbî
();

269  
num
;

270 
	}
}

274 #i‡
deföed
(
__löux
)

275 
	~<limôs.h
>

278 *
	$osù_°∫˝y
(*
de°
, c⁄° *
§c
, 
size_t
 
Àngth
) {

279 
	`°∫˝y
(
de°
, 
§c
, 
Àngth
);

280 
de°
[
Àngth
] = '\0';

281  
de°
;

282 
	}
}

284 #unde‡
osù_°rdup


286 *
	$osù_°rdup
(c⁄° *
ch
) {

287 *
c›y
;

288 
size_t
 
Àngth
;

290 i‡(
ch
 =
NULL
)

291  
NULL
;

293 
Àngth
 = 
	`°æí
(
ch
);

294 
c›y
 = (*Ë
	`osù_mÆloc
(
Àngth
 + 1);

296 i‡(
c›y
 =
NULL
)

297  
NULL
;

299 
	`osù_°∫˝y
(
c›y
, 
ch
, 
Àngth
);

300  
c›y
;

301 
	}
}

303 #i‚de‡
MINISIZE


304 
	$osù_©oi
(c⁄° *
numbî
) {

305 #i‡
	`deföed
(
__löux
Ë|| deföed(
HAVE_STRTOL
)

306 
i
;

308 i‡(
numbî
 =
NULL
)

309  
OSIP_UNDEFINED_ERROR
;

311 
i
 = 
	`°πﬁ
(
numbî
, (**Ë
NULL
, 10);

313 i‡(
i
 =
LONG_MIN
 || i =
LONG_MAX
)

314  
OSIP_UNDEFINED_ERROR
;

316  
i
;

319  
	`©oi
(
numbî
);

320 
	}
}

324 #i‡(
_MSC_VER
 >1700Ë&& !
deföed
(
_USING_V110_SDK71_
)

325 #i‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PHONE_APP
)

326 
	#HAVE_WINDOWSPHONE_API


	)

327 #ñi‡
deföed
(
WINAPI_FAMILY
Ë&& (WINAPI_FAMILY =
WINAPI_FAMILY_PC_APP
)

328 
	#HAVE_WINAPPSTORE_API


	)

332 
	$osù_u¶ìp
(
u£c⁄ds
) {

333 #i‡
	`deföed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

335 
n£cs_t
 
«no£c⁄ds
 = 
u£c⁄ds
 * 1000;

337 
	`SysThªadDñay
(
«no£c⁄ds
, 
P_ABSOLUTE_TIMEOUT
);

338 #ñi‡
	`deföed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

339 
UI¡32
 
°›time
 = 
	`TimGëTicks
(Ë+ (
u£c⁄ds
 / 1000000Ë* 
	`SysTicksPîSec⁄d
();

341 
°›time
 > 
	`TimGëTicks
())

345 #ñi‡
	`deföed
(
HAVE_WINDOWSPHONE_API
)

346 
timevÆ
 
dñay
;

347 
£c
;

349 
£c
 = (Ë
u£c⁄ds
 / 1000000;

351 i‡(
£c
 > 0) {

352 
dñay
.
tv_£c
 = 
£c
;

353 
dñay
.
tv_u£c
 = 0;

356 
dñay
.
tv_£c
 = 0;

357 
dñay
.
tv_u£c
 = 
u£c⁄ds
;

360 
	`£À˘
(0, 0, 0, 0, &
dñay
);

361 #ñi‡
	`deföed
(
HAVE_WINAPPSTORE_API
)

362 
TODO


363 #ñi‡
	`deföed
(
WIN32
)

364 
	`SÀï
(
u£c⁄ds
 / 1000);

365 #ñi‡
	`deföed
(
__πems__
)

366 
	`πems_èsk_wake_a·î
(
	`RTEMS_MICROSECONDS_TO_TICKS
(
u£c⁄ds
));

367 #ñi‡
	`deföed
(
__¨c__
)

368 
time•ec
 
ªq
;

369 
time•ec
 
ªm
;

371 
ªq
.
tv_£c
 = (Ë
u£c⁄ds
 / 1000000;

372 
ªq
.
tv_n£c
 = (Ë(
u£c⁄ds
 % 1000000) * 1000;

373 
	`«no¶ìp
(&
ªq
, &
ªm
);

375 
timevÆ
 
dñay
;

376 
£c
;

378 
£c
 = (Ë
u£c⁄ds
 / 1000000;

380 i‡(
£c
 > 0) {

381 
dñay
.
tv_£c
 = 
£c
;

382 
dñay
.
tv_u£c
 = 0;

385 
dñay
.
tv_£c
 = 0;

386 
dñay
.
tv_u£c
 = 
u£c⁄ds
;

389 
	`£À˘
(0, 0, 0, 0, &
dñay
);

391 
	}
}

393 *
	$osù_°rdup_wôhout_quŸe
(c⁄° *
ch
) {

394 *
c›y
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
ch
) + 1);

396 i‡(
c›y
 =
NULL
)

397  
NULL
;

400 i‡((*
ch
 == '\"')) {

401 
	`osù_°∫˝y
(
c›y
, 
ch
 + 1, 
	`°æí
(ch + 1));

402 
	`osù_°∫˝y
(
c›y
 + 
	`°æí
(copy) - 1, "\0", 1);

405 
	`osù_°∫˝y
(
c›y
, 
ch
, 
	`°æí
(ch));

407  
c›y
;

408 
	}
}

410 
	$osù_tﬁowî
(*
w‹d
) {

411 #i‡
	`deföed
(
HAVE_CTYPE_H
Ë&& !deföed(
_WIN32_WCE
)

413 ; *
w‹d
; word++)

414 *
w‹d
 = (Ë
	`tﬁowî
(*word);

417 
size_t
 
i
;

418 
size_t
 
Àn
 = 
	`°æí
(
w‹d
);

420 
i
 = 0; i <
Àn
 - 1; i++) {

421 i‡('A' <
w‹d
[
i
] && word[i] <= 'Z')

422 
w‹d
[
i
] = word[i] + 32;

426  
OSIP_SUCCESS
;

427 
	}
}

429 #i‚de‡
MINISIZE


430 
	$osù_°rˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
) {

431 #i‡
	`deföed
(
__VXWORKS_OS__
Ë|| deföed(
__PSOS__
)

433 (*
s1
 !'\0'Ë&& (
	`tﬁowî
(*s1Ë=tﬁowî(*
s2
))) {

434 
s1
++;

435 
s2
++;

438  (
	`tﬁowî
(*
s1
Ë-Åﬁowî(*
s2
));

439 #ñi‡
	`deföed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

440  
	`SåCa£ÀssCom∑ª
(
s1
, 
s2
);

441 #ñi‡
	`deföed
(
__PALMOS__
Ë|| (!
deföed
 
WIN32
 && !deföed 
_WIN32_WCE
)

442  
	`°rˇ£cmp
(
s1
, 
s2
);

444  
	`_°ricmp
(
s1
, 
s2
);

446 
	}
}

448 
	$osù_°∫ˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
, 
size_t
 
Àn
) {

449 #i‡
	`deföed
(
__VXWORKS_OS__
Ë|| deföed(
__PSOS__
)

451 i‡(
Àn
 == 0)

452  
OSIP_SUCCESS
;

454 (
Àn
 > 0Ë&& (
	`tﬁowî
(*
s1
Ë=tﬁowî(*
s2
))) {

455 
Àn
--;

457 i‡((
Àn
 =0Ë|| (*
s1
 ='\0'Ë|| (*
s2
 == '\0'))

460 
s1
++;

461 
s2
++;

464  
	`tﬁowî
(*
s1
Ë-Åﬁowî(*
s2
);

465 #ñi‡
	`deföed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

466  
	`SåNCa£ÀssCom∑ª
(
s1
, 
s2
, 
Àn
);

467 #ñi‡
	`deföed
(
__PALMOS__
Ë|| (!
deföed
 
WIN32
 && !deföed 
_WIN32_WCE
)

468  
	`°∫ˇ£cmp
(
s1
, 
s2
, 
Àn
);

470  
	`_°∫icmp
(
s1
, 
s2
, 
Àn
);

472 
	}
}

476 *
	$osù_°rˇ£°r
(c⁄° *
hay°ack
, c⁄° *
√edÀ
) {

477 
c
, 
sc
;

478 
size_t
 
Àn
;

480 i‡((
c
 = *
√edÀ
++) != 0) {

481 
c
 = 
	`tﬁowî
(() c);

482 
Àn
 = 
	`°æí
(
√edÀ
);

486 i‡((
sc
 = *
hay°ack
++) == 0)

487  (
NULL
);

488 } (Ë
	`tﬁowî
((Ë
sc
Ë!
c
);

489 } 
	`osù_°∫ˇ£cmp
(
hay°ack
, 
√edÀ
, 
Àn
) != 0);

491 
hay°ack
--;

494  (*Ë
hay°ack
;

495 
	}
}

498 
	$osù_˛r•a˚
(*
w‹d
) {

499 *
pbeg
;

500 *
≥nd
;

501 
size_t
 
Àn
;

503 i‡(
w‹d
 =
NULL
)

504  
OSIP_UNDEFINED_ERROR
;

506 i‡(*
w‹d
 == '\0')

507  
OSIP_SUCCESS
;

509 
Àn
 = 
	`°æí
(
w‹d
);

511 
pbeg
 = 
w‹d
;

512 
pbeg
 +
	`°r•n
(pbeg, " \r\n\t");

514 
≥nd
 = 
w‹d
 + 
Àn
 - 1;

516 (' ' =*
≥nd
) || ('\r' == *pend) || ('\n' == *pend) || ('\t' == *pend)) {

517 
≥nd
--;

519 i‡(
≥nd
 < 
pbeg
) {

520 *
w‹d
 = '\0';

521  
OSIP_SUCCESS
;

526 i‡(
≥nd
 + 1 <
w‹d
 + (
Àn
 - 1))

527 
≥nd
[1] = '\0';

529 i‡(
pbeg
 !
w‹d
)

530 
	`memmove
(
w‹d
, 
pbeg
, 
≥nd
 -Öbeg + 2);

532  
OSIP_SUCCESS
;

533 
	}
}

547 
	$__osù_£t_√xt_tokí
(**
de°
, *
buf
, 
íd_£∑øt‹
, **
√xt
) {

548 *
£p
;

550 *
√xt
 = 
NULL
;

552 
£p
 = 
buf
;

554 (*
£p
 !
íd_£∑øt‹
) && (*sep != '\0') && (*sep != '\r') && (*sep != '\n'))

555 
£p
++;

557 i‡((*
£p
 == '\r') || (*sep == '\n')) {

558 i‡(*
£p
 !
íd_£∑øt‹
)

559  
OSIP_UNDEFINED_ERROR
;

562 i‡(*
£p
 == '\0')

563  
OSIP_UNDEFINED_ERROR
;

565 i‡(
£p
 =
buf
)

566  
OSIP_UNDEFINED_ERROR
;

568 *
de°
 = 
	`osù_mÆloc
(
£p
 - (
buf
) + 1);

570 i‡(*
de°
 =
NULL
)

571  
OSIP_NOMEM
;

573 
	`osù_°∫˝y
(*
de°
, 
buf
, 
£p
 - buf);

575 *
√xt
 = 
£p
 + 1;

576  
OSIP_SUCCESS
;

577 
	}
}

582 
	$__osù_£t_√xt_tokí_bëãr
(**
de°
, *
buf
, 
íd_£∑øt‹
, *
f‹biddí_èb
[], 
size_èb
, **
√xt
) {

583 *
£p
;

585 *
√xt
 = 
NULL
;

587 
£p
 = 
buf
;

589 (*
£p
 !
íd_£∑øt‹
) && (*sep != '\0') && (*sep != '\r')

590 && (*
£p
 != '\n'))

591 
£p
++;

593 i‡((*
£p
 == '\r') && (*sep == '\n')) {

594 i‡(*
£p
 !
íd_£∑øt‹
)

595  
OSIP_UNDEFINED_ERROR
;

598 i‡(*
£p
 == '\0')

599  
OSIP_UNDEFINED_ERROR
;

601 i‡(
£p
 =
buf
)

602  
OSIP_UNDEFINED_ERROR
;

604 *
de°
 = 
	`osù_mÆloc
(
£p
 - (
buf
) + 1);

606 i‡(*
de°
 =
NULL
)

607  
OSIP_NOMEM
;

609 
	`osù_°∫˝y
(*
de°
, 
buf
, 
£p
 - buf);

611 *
√xt
 = 
£p
 + 1;

613 
	}
}

618 c⁄° *
	$__osù_quŸe_föd
(c⁄° *
q°rög
) {

619 c⁄° *
quŸe
;

621 
quŸe
 = 
	`°rchr
(
q°rög
, '"');

623 i‡(
quŸe
 =
q°rög
)

624  
quŸe
;

626 i‡(
quŸe
 =
NULL
)

627  
NULL
;

638 
i
 = 1;

641 i‡(0 =
	`°∫cmp
(
quŸe
 - 
i
, "\\", 1))

642 
i
++;

645 i‡(
i
 % 2 == 1)

646  
quŸe
;

649 
quŸe
 = 
	`°rchr
(quote + 1, '"');

651 i‡(
quŸe
 =
NULL
)

652  
NULL
;

654 
i
 = 1;

657 i‡(
quŸe
 - 
i
 =
q°rög
 - 1)

662 i‡(*
q°rög
 == '\\')

663 
i
++;

665 i‡(
i
 % 2 == 0)

666  
quŸe
;

669 
q°rög
 = 
quŸe
 + 1;

671 
quŸe
 = 
	`°rchr
(quote + 1, '"');

673 i‡(
quŸe
 =
NULL
)

674  
NULL
;

676 
i
 = 1;

681  
NULL
;

683 
	}
}

685 *
	$osù_íquŸe
(c⁄° *
s
) {

686 *
πn
;

687 *
t
;

689 
t
 = 
πn
 = 
	`osù_mÆloc
(
	`°æí
(
s
) * 2 + 3);

691 i‡(
πn
 =
NULL
)

692  
NULL
;

694 *
t
++ = '"';

696 ; *
s
 != '\0'; s++) {

697 *
s
) {

701 *
t
++ = '\\';

702 *
t
++ = *
s
;

707 *
t
++ = ' ';

711 *
t
++ = *
s
;

716 *
t
++ = '"';

717 *
t
++ = '\0';

718  
πn
;

719 
	}
}

721 
	$osù_dequŸe
(*
s
) {

722 
size_t
 
Àn
;

724 i‡(*
s
 == '\0')

727 i‡(*
s
 != '"')

730 
Àn
 = 
	`°æí
(
s
);

731 
	`memmove
(
s
, s + 1, 
Àn
--);

733 i‡(
Àn
 > 0 && 
s
[len - 1] == '"')

734 
s
[--
Àn
] = '\0';

736 ; *
s
 !'\0'; s++, 
Àn
--) {

737 i‡(*
s
 == '\\')

738 
	`memmove
(
s
, s + 1, 
Àn
--);

740 
	}
}

749 #i‚de‡
ENABLE_TRACE


750 
	$osù_åa˚_öôülize_func
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
osù_åa˚_func_t
 *
func
) {

751 
	}
}

753 
	$osù_åa˚_öôülize_sy¶og
(
osù_åa˚_Àvñ_t
 
Àvñ
, *
idít
) {

754 
	}
}

756 
	$osù_åa˚_öôülize
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
FILE
 *
fûe
) {

757  
OSIP_UNDEFINED_ERROR
;

758 
	}
}

760 
	$osù_åa˚_íabÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

761 
	}
}

763 
	$osù_åa˚_dißbÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

764 
	}
}

766 
	$osù_is_åa˚_Àvñ_a˘iv©e
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

767  
LOG_FALSE
;

768 
	}
}

774 
	$osù_åa˚_öôülize
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
FILE
 *
fûe
) {

775 
osù_åa˚_Àvñ_t
 
i
 = 
TRACE_LEVEL0
;

778 
logfûe
 = 
NULL
;

780 i‡(
fûe
 !
NULL
)

781 
logfûe
 = 
fûe
;

784 
logfûe
 = 
°dout
;

787 
i
 < 
END_TRACE_LEVEL
) {

788 i‡(
i
 < 
Àvñ
)

789 
åacög_èbÀ
[
i
] = 
LOG_TRUE
;

792 
åacög_èbÀ
[
i
] = 
LOG_FALSE
;

794 
i
++;

798 
	}
}

800 
	$osù_åa˚_öôülize_sy¶og
(
osù_åa˚_Àvñ_t
 
Àvñ
, *
idít
) {

801 
osù_åa˚_Àvñ_t
 
i
 = 
TRACE_LEVEL0
;

803 #i‡
	`deföed
(
HAVE_SYSLOG_H
Ë&& !deföed(
__¨c__
)

804 
	`›ílog
(
idít
, 
LOG_CONS
 | 
LOG_PID
, 
LOG_DAEMON
);

805 
u£_sy¶og
 = 1;

809 
i
 < 
END_TRACE_LEVEL
) {

810 i‡(
i
 < 
Àvñ
)

811 
åacög_èbÀ
[
i
] = 
LOG_TRUE
;

814 
åacög_èbÀ
[
i
] = 
LOG_FALSE
;

816 
i
++;

818 
	}
}

820 
	$osù_åa˚_íabÀ_u¡û_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

821 
osù_åa˚_Àvñ_t
 
i
 = 0;

823 
i
 < 
END_TRACE_LEVEL
) {

824 i‡(
i
 < 
Àvñ
)

825 
åacög_èbÀ
[
i
] = 
LOG_TRUE
;

828 
åacög_èbÀ
[
i
] = 
LOG_FALSE
;

830 
i
++;

832 
	}
}

834 
	$osù_åa˚_öôülize_func
(
osù_åa˚_Àvñ_t
 
Àvñ
, 
osù_åa˚_func_t
 *
func
) {

835 
osù_åa˚_Àvñ_t
 
i
 = 0;

837 
åa˚_func
 = 
func
;

840 
i
 < 
END_TRACE_LEVEL
) {

841 i‡(
i
 < 
Àvñ
)

842 
åacög_èbÀ
[
i
] = 
LOG_TRUE
;

845 
åacög_èbÀ
[
i
] = 
LOG_FALSE
;

847 
i
++;

849 
	}
}

852 
	$osù_åa˚_íabÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

853 
åacög_èbÀ
[
Àvñ
] = 
LOG_TRUE
;

854 
	}
}

857 
	$osù_åa˚_dißbÀ_Àvñ
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

858 
åacög_èbÀ
[
Àvñ
] = 
LOG_FALSE
;

859 
	}
}

862 
	$osù_is_åa˚_Àvñ_a˘iv©e
(
osù_åa˚_Àvñ_t
 
Àvñ
) {

863  
åacög_èbÀ
[
Àvñ
];

864 
	}
}

867 #i‡
deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
)

869 
	~<time.h
>

870 
	~<sys/timeb.h
>

872 
	$__osù_p‹t_gëtimeofday
(
timevÆ
 *
ç
, *
tz
) {

873 
_timeb
 
timebuf„r
;

875 
	`_·ime
(&
timebuf„r
);

876 
ç
->
tv_£c
 = (Ë
timebuf„r
.
time
;

877 
ç
->
tv_u£c
 = 
timebuf„r
.
mûlôm
 * 1000;

878  
OSIP_SUCCESS
;

879 
	}
}

880 #ñi‡
deföed
(
__löux
)

881 
	~<sys/time.h
>

882 
	#__osù_p‹t_gëtimeofday
 
gëtimeofday


	)

883 #ñi‡
deföed
(
__APPLE__
)

884 
	~<sys/time.h
>

885 
	#__osù_p‹t_gëtimeofday
 
gëtimeofday


	)

888 #ifde‡
ANDROID


889 
	~<™droid/log.h
>

892 #i‚de‡
MAX_LENGTH_TR


893 
	#MAX_LENGTH_TR
 2024

	)

896 
	$osù_åa˚
(c⁄° *
fûíame_l⁄g
, 
li
, 
osù_åa˚_Àvñ_t
 
Àvñ
, 
FILE
 *
f
, c⁄° *
ch‰
, ...) {

897 #ifde‡
ENABLE_TRACE


898 
va_li°
 
≠
;

899 
time_buf„r
[80] = {'\0'};

901 c⁄° *
fi
 = 
NULL
;

903 i‡(
logfûe
 =
NULL
 && 
u£_sy¶og
 =0 && 
åa˚_func
 =NULL && 
f
 == NULL) {

905 
	`osù_åa˚_öôülize
(
OSIP_WARNING
, 
°dout
);

908 i‡(
åacög_èbÀ
[
Àvñ
] =
LOG_FALSE
)

909  
OSIP_SUCCESS
;

911 #i‡
	`deföed
(
HAVE_LOCALTIME
)

913 
time_t
 
time°amp
;

914 
timevÆ
 
now
;

915 
tm
 *
±m
;

916 #ifde‡
__USE_POSIX


917 
tm
 
loˇl_tm
;

919 
ã¡hs_ms
;

920 
	`__osù_p‹t_gëtimeofday
(&
now
, 
NULL
);

922 
time°amp
 = 
now
.
tv_£c
;

923 
ã¡hs_ms
 = 
now
.
tv_u£c
 / (100L);

924 #ifde‡
__USE_POSIX


925 
±m
 = 
	`loˇ…ime_r
(&
time°amp
, &
loˇl_tm
);

927 
±m
 = 
	`loˇ…ime
(&
time°amp
);

930 
	`¢¥ötf
(
time_buf„r
, 80, "%04d-%02d-%02d %02d:%02d:%02d.%04d", 1900 + 
±m
->
tm_yór
,Ötm->
tm_m⁄
 + 1,Ötm->
tm_mday
,Ötm->
tm_hour
,Ötm->
tm_mö
,Ötm->
tm_£c
, 
ã¡hs_ms
);

934 i‡(
fûíame_l⁄g
 !
NULL
) {

935 
fi
 = 
	`°ºchr
(
fûíame_l⁄g
, '/');

937 i‡(
fi
 =
NULL
)

938 
fi
 = 
	`°ºchr
(
fûíame_l⁄g
, '\\');

940 i‡(
fi
 !
NULL
)

941 
fi
++;

943 i‡(
fi
 =
NULL
)

944 
fi
 = 
fûíame_l⁄g
;

947 i‡(
f
 =
NULL
)

948 
f
 = 
logfûe
;

950 #i‡
	`deföed
(
__VXWORKS_OS__
Ë|| deföed(
__πems__
)

952 
f
 = 
°dout
;

955 
	`VA_START
(
≠
, 
ch‰
);

957 i‡(
åa˚_func
) {

958 
	`åa˚_func
(
fi
, 
li
, 
Àvñ
, 
ch‰
, 
≠
);

959 
	`va_íd
(
≠
);

960  
OSIP_SUCCESS
;

963 #ifde‡
ANDROID


965 
Àv
;

967 
Àvñ
) {

968 
OSIP_INFO3
:

969 
Àv
 = 
ANDROID_LOG_DEBUG
;

972 
OSIP_INFO4
:

973 
Àv
 = 
ANDROID_LOG_DEBUG
;

976 
OSIP_INFO2
:

977 
Àv
 = 
ANDROID_LOG_INFO
;

980 
OSIP_INFO1
:

981 
Àv
 = 
ANDROID_LOG_INFO
;

984 
OSIP_WARNING
:

985 
Àv
 = 
ANDROID_LOG_WARN
;

988 
OSIP_ERROR
:

989 
Àv
 = 
ANDROID_LOG_ERROR
;

992 
OSIP_BUG
:

993 
Àv
 = 
ANDROID_LOG_FATAL
;

996 
OSIP_FATAL
:

997 
Àv
 = 
ANDROID_LOG_FATAL
;

1001 
Àv
 = 
ANDROID_LOG_DEFAULT
;

1005 
	`__™droid_log_v¥öt
(
Àv
, "osù2", 
ch‰
, 
≠
);

1006 
	`va_íd
(
≠
);

1007  
OSIP_SUCCESS
;

1012 
buf„r
[
MAX_LENGTH_TR
];

1013 
ö
 = 0;

1015 
	`mem£t
(
buf„r
, 0, (buffer));

1017 i‡(
Àvñ
 =
OSIP_FATAL
)

1018 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| FATAL | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1020 i‡(
Àvñ
 =
OSIP_BUG
)

1021 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| BUG | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1023 i‡(
Àvñ
 =
OSIP_ERROR
)

1024 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| ERROR | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1026 i‡(
Àvñ
 =
OSIP_WARNING
)

1027 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "|WARNING| %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1029 i‡(
Àvñ
 =
OSIP_INFO1
)

1030 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| INFO1 | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1032 i‡(
Àvñ
 =
OSIP_INFO2
)

1033 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| INFO2 | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1035 i‡(
Àvñ
 =
OSIP_INFO3
)

1036 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| INFO3 | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1038 i‡(
Àvñ
 =
OSIP_INFO4
)

1039 
ö
 = 
	`¢¥ötf
(
buf„r
, 
MAX_LENGTH_TR
 - 1, "| INFO4 | %†<%10.10s:%5i> ", 
time_buf„r
, 
fi
, 
li
);

1041 
	`v¢¥ötf
(
buf„r
 + 
ö
, 
MAX_LENGTH_TR
 - 1 - in, 
ch‰
, 
≠
);

1043 #i‡
	`deföed
(
HAVE_SYSLOG_H
Ë&& !deföed(
__¨c__
)

1045 i‡(
u£_sy¶og
 == 1) {

1046 i‡(
Àvñ
 =
OSIP_FATAL
)

1047 
	`sy¶og
(
LOG_ERR
, "%s", 
buf„r
);

1049 i‡(
Àvñ
 =
OSIP_BUG
)

1050 
	`sy¶og
(
LOG_ERR
, "%s", 
buf„r
);

1052 i‡(
Àvñ
 =
OSIP_ERROR
)

1053 
	`sy¶og
(
LOG_ERR
, "%s", 
buf„r
);

1055 i‡(
Àvñ
 =
OSIP_WARNING
)

1056 
	`sy¶og
(
LOG_WARNING
, "%s", 
buf„r
);

1058 i‡(
Àvñ
 =
OSIP_INFO1
)

1059 
	`sy¶og
(
LOG_INFO
, "%s", 
buf„r
);

1061 i‡(
Àvñ
 =
OSIP_INFO2
)

1062 
	`sy¶og
(
LOG_INFO
, "%s", 
buf„r
);

1064 i‡(
Àvñ
 =
OSIP_INFO3
)

1065 
	`sy¶og
(
LOG_DEBUG
, "%s", 
buf„r
);

1067 i‡(
Àvñ
 =
OSIP_INFO4
)

1068 
	`sy¶og
(
LOG_DEBUG
, "%s", 
buf„r
);

1070 
	`va_íd
(
≠
);

1071  
OSIP_SUCCESS
;

1076 #i‡
	`deföed
(
WIN32
)

1078 i‡(
f
 =
°dout
) {

1079 #ifde‡
UNICODE


1080 
WCHAR
 
wUnicode
[
MAX_LENGTH_TR
 * 2];

1081 
size
;

1083 
size
 = 
	`Mu…iByãToWideCh¨
(
CP_UTF8
, 0, 
buf„r
, -1, 
wUnicode
, 
MAX_LENGTH_TR
 * 2);

1084 
wUnicode
[
size
 - 2] = '\n';

1085 
wUnicode
[
size
 - 1] = '\0';

1086 
	`OuçutDebugSåög
(
wUnicode
);

1088 
	`OuçutDebugSåög
(
buf„r
);

1090 
	`va_íd
(
≠
);

1091  
OSIP_SUCCESS
;

1096 #i‡
	`deföed
(
__APPLE__
Ë&& deföed(
__OBJC__
)

1098 i‡(
f
 =
°dout
) {

1099 
	`NSLog
(@"%s", 
buf„r
);

1100 
	`va_íd
(
≠
);

1101  
OSIP_SUCCESS
;

1106 i‡(
f
) {

1107 
	`Ârötf
(
f
, "%s", 
buf„r
);

1108 
	`fÊush
(
f
);

1109 
	`va_íd
(
≠
);

1110  
OSIP_SUCCESS
;

1114 
	`va_íd
(
≠
);

1116  
OSIP_SUCCESS
;

1117 
	}
}

1119 #i‡
deföed
(
WIN32
Ë|| deföed(
_WIN32_WCE
)

1121 #unde‡
osù_mÆloc


1122 *
	$osù_mÆloc
(
size_t
 
size
) {

1123 *
±r
 = 
	`mÆloc
(
size
);

1125 i‡(
±r
 !
NULL
)

1126 
	`mem£t
(
±r
, 0, 
size
);

1128  
±r
;

1129 
	}
}

1131 #unde‡
osù_ªÆloc


1132 *
	$osù_ªÆloc
(*
±r
, 
size_t
 
size
) {

1133  
	`ªÆloc
(
±r
, 
size
);

1134 
	}
}

1136 #unde‡
osù_‰ì


1137 
	$osù_‰ì
(*
±r
) {

1138 i‡(
±r
 =
NULL
)

1141 
	`‰ì
(
±r
);

1142 
	}
}

1146 #i‚de‡
MINISIZE


1147 
	$osù_£t_Æloˇt‹s
(
osù_mÆloc_func_t
 *
mÆloc_func
, 
osù_ªÆloc_func_t
 *
ªÆloc_func
, 
osù_‰ì_func_t
 *
‰ì_func
) {

1148 
osù_mÆloc_func
 = 
mÆloc_func
;

1149 
osù_ªÆloc_func
 = 
ªÆloc_func
;

1150 
osù_‰ì_func
 = 
‰ì_func
;

1151 
	}
}

1156 #i‡
deföed
(
__VXWORKS_OS__
)

1159 *
	m°r
;

1160 
	mmax
;

1161 
	mÀn
;

1162 } 
	t_c⁄ãxt
;

1164 
STATUS
 
_cb_¢¥ötf
(*
buf„r
, 
nc
, 
¨g
);

1166 
STATUS
 
	$_cb_¢¥ötf
(*
buf„r
, 
nc
, 
¨g
) {

1167 
_c⁄ãxt
 *
˘x
 = (_c⁄ãxà*Ë
¨g
;

1169 i‡(
˘x
->
max
 - ctx->
Àn
 - 
nc
 < 1) {

1170 
nc
 = 
˘x
->
max
 - ctx->
Àn
 - 1;

1173 i‡(
nc
 > 0) {

1174 
	`mem˝y
(
˘x
->
°r
 + ctx->
Àn
, 
buf„r
, 
nc
);

1175 
˘x
->
Àn
 +
nc
;

1178 
˘x
->
°r
[˘x->
Àn
] = '\0';

1180  
OK
;

1181 
	}
}

1183 
	$osù_v¢¥ötf
(*
buf
, 
max
, c⁄° *
fmt
, 
va_li°
 
≠
) {

1184 
_c⁄ãxt
 
˘x
;

1186 
˘x
.
°r
 = 
buf
;

1187 
˘x
.
max
 = max;

1188 
˘x
.
Àn
 = 0;

1190 i‡(
	`fioF‹m©V
(
fmt
, 
≠
, 
_cb_¢¥ötf
, (Ë&
˘x
Ë!
OK
) {

1191  
OSIP_UNDEFINED_ERROR
;

1194  
˘x
.
Àn
;

1195 
	}
}

1197 
	$osù_¢¥ötf
(*
buf
, 
max
, c⁄° *
fmt
, ...) {

1198 
ªtvÆ
;

1199 
va_li°
 
≠
;

1201 
	`va_°¨t
(
≠
, 
fmt
);

1202 
ªtvÆ
 = 
	`osù_v¢¥ötf
(
buf
, 
max
, 
fmt
, 
≠
);

1203 
	`va_íd
(
≠
);

1204  
ªtvÆ
;

1205 
	}
}

1209 #i‡
deföed
(
__PSOS__
)

1211 
	$osù_¢¥ötf
(*
buf
, 
max
, c⁄° *
fmt
, ...) {

1212 
buf„r
[1024];

1213 
ªtvÆ
;

1214 
va_li°
 
≠
;

1216 
buf„r
[0] = '\n';

1217 
	`va_°¨t
(
≠
, 
fmt
);

1218 
	`v•rötf
(&(
buf„r
[
	`°æí
(buf„r)]), 
fmt
, 
≠
);

1219 
	`va_íd
(
≠
);

1220 
ªtvÆ
 = 
	`°æí
(
buf„r
);

1221 
	`memmove
(
buf
, 
buf„r
, 
max
);

1223 i‡(
ªtvÆ
 > 
max
)

1224  
OSIP_UNDEFINED_ERROR
;

1226  
ªtvÆ
;

1227 
	}
}

1231 #ifde‡
DEBUG_MEM


1240 *
	$_osù_mÆloc
(
size_t
 
size
, *
fûe
, 
löe
) {

1241 *
mem
;

1243 
mem
 = 
	`osù_mÆloc_func
(
size
 + 20);

1245 i‡(
mem
 !
NULL
) {

1246 *
s
;

1248 
	`mem˝y
(
mem
, &
löe
, 2);

1250 
s
 = 
fûe
 + 
	`°æí
(file); s != file; s--) {

1251 i‡(*
s
 == '\\' || *s == '/') {

1252 
s
++;

1257 
	`°∫˝y
((*Ë
mem
 + 2, 
s
, 18);

1258  (*Ë((*Ë
mem
 + 20);

1261  
NULL
;

1262 
	}
}

1264 
	$_osù_‰ì
(*
±r
) {

1265 i‡(
±r
 !
NULL
) {

1266 
	`osù_‰ì_func
((*Ë
±r
 - 20);

1268 
	}
}

1270 *
	$_osù_ªÆloc
(*
±r
, 
size_t
 
size
, *
fûe
, 
löe
) {

1271 *
mem
;

1273 
mem
 = 
	`osù_ªÆloc_func
((*Ë
±r
 - 20, 
size
 + 20);

1275 i‡(
mem
 !
NULL
) {

1276 *
s
;

1278 
	`mem˝y
(
mem
, &
löe
, 2);

1280 
s
 = 
fûe
 + 
	`°æí
(file); s != file; s--) {

1281 i‡(*
s
 == '\\' || *s == '/') {

1282 
s
++;

1287 
	`°∫˝y
((*Ë
mem
 + 2, 
s
, 18);

1288  (*Ë
mem
 + 20;

1291  
NULL
;

1292 
	}
}

1296 #ifde‡
OSIP_MEMORY_DEBUG


1298 
	#_CRTDBG_MAP_ALLOC


	)

1299 
	~<¸tdbg.h
>

1307 *
	$_osù_mÆloc
(
size_t
 
size
, *
fûe
, 
löe
) {

1308  
	`_mÆloc_dbg
(
size
, 
_NORMAL_BLOCK
, 
fûe
, 
löe
);

1309 
	}
}

1311 
	$_osù_‰ì
(*
±r
) {

1312 
	`_‰ì_dbg
(
±r
, 
_NORMAL_BLOCK
);

1313 
	}
}

1315 *
	$_osù_ªÆloc
(*
±r
, 
size_t
 
size
, *
fûe
, 
löe
) {

1316  
	`_ªÆloc_dbg
(
±r
, 
size
, 
_NORMAL_BLOCK
, 
fûe
, 
löe
);

1317 
	}
}

1322 
	$osù_hash
(c⁄° *
°r
) {

1323 
hash
 = 5381;

1324 
c
;

1326 (
c
 = *
°r
++))

1327 
hash
 = ((hash << 5Ë+ hashË+ 
c
;

1329  
hash
 & 0xFFFFFFFFu;

1330 
	}
}

1345 *
	$osù_°r_≠≥nd
(*
d°
, c⁄° *
§c
) {

1346 *
§c
 != '\0') {

1347 *
d°
 = *
§c
;

1348 
§c
++;

1349 
d°
++;

1352 *
d°
 = '\0';

1353  
d°
;

1354 
	}
}

1358 *
	$osù_°∫_≠≥nd
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
) {

1359 
	`memmove
((*Ë
d°
, (*Ë
§c
, 
Àn
);

1360 
d°
 +
Àn
;

1361 *
d°
 = '\0';

1362  
d°
;

1363 
	}
}

1369 #i‚de‡
MINISIZE


1370 *
	$osù_˛∫˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
) {

1371 c⁄° *
pbeg
;

1372 c⁄° *
≥nd
;

1373 *
p
;

1374 
size_t
 
•a˚Àss_Àngth
;

1376 i‡(
§c
 =
NULL
 || 
Àn
 == 0) {

1377 *
d°
 = '\0';

1378  
NULL
;

1382 
pbeg
 = 
§c
;

1383 
pbeg
 +
	`°r•n
(pbeg, " \r\n\t");

1386 
≥nd
 = 
§c
 + 
Àn
 - 1;

1388 (' ' =*
≥nd
) || ('\r' == *pend) || ('\n' == *pend) || ('\t' == *pend)) {

1389 
≥nd
--;

1391 i‡(
≥nd
 < 
pbeg
) {

1392 *
d°
 = '\0';

1393  
d°
;

1398 
•a˚Àss_Àngth
 = 
≥nd
 - 
pbeg
 + 1;

1399 
	`memmove
(
d°
, 
pbeg
, 
•a˚Àss_Àngth
);

1400 
p
 = 
d°
 + 
•a˚Àss_Àngth
;

1402 #i‡
	`deföed
(
__GNUC__
)

1406 *
p
 = '\0';

1408 i‡(
	`__buûtö_ex≥˘
(++
•a˚Àss_Àngth
 < 
Àn
, 0)) {

1410 *++
p
 = '\0';

1412 ++
•a˚Àss_Àngth
 < 
Àn
);

1419 *
p
 = '\0';

1420 
p
++;

1421 
•a˚Àss_Àngth
++;

1422 } 
•a˚Àss_Àngth
 < 
Àn
);

1426  
d°
;

1427 
	}
}

1431 *
	$osù_˛∫˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
) {

1432 
	`osù_°∫˝y
(
d°
, 
§c
, 
Àn
);

1433 
	`osù_˛r•a˚
(
d°
);

1434  
d°
;

1435 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authenticate.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

30 
	$osù_mesßge_£t_¥oxy_authítiˇã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

31 
osù_¥oxy_authítiˇã_t
 *
¥oxy_authítiˇã
;

32 
i
;

34 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 
i
 = 
	`osù_¥oxy_authítiˇã_öô
(&(
¥oxy_authítiˇã
));

39 i‡(
i
 != 0)

40  
i
;

42 
i
 = 
	`osù_¥oxy_authítiˇã_∑r£
(
¥oxy_authítiˇã
, 
hvÆue
);

44 i‡(
i
 != 0) {

45 
	`osù_¥oxy_authítiˇã_‰ì
(
¥oxy_authítiˇã
);

46  
i
;

49 
sù
->
mesßge_¥›îty
 = 2;

50 
	`osù_li°_add
(&
sù
->
¥oxy_authítiˇãs
, 
¥oxy_authítiˇã
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

54 #i‚de‡
MINISIZE


58 
	$osù_mesßge_gë_¥oxy_authítiˇã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_authítiˇã_t
 **
de°
) {

59 
osù_¥oxy_authítiˇã_t
 *
¥oxy_authítiˇã
;

61 *
de°
 = 
NULL
;

63 i‡(
	`osù_li°_size
(&
sù
->
¥oxy_authítiˇãs
Ë<
pos
)

64  
OSIP_UNDEFINED_ERROR
;

66 
¥oxy_authítiˇã
 = (
osù_¥oxy_authítiˇã_t
 *Ë
	`osù_li°_gë
(&
sù
->
¥oxy_authítiˇãs
, 
pos
);

68 *
de°
 = 
¥oxy_authítiˇã
;

69  
pos
;

70 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authentication_info.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 #i‚de‡
MINISIZE


32 
	$osù_mesßge_£t_¥oxy_authítiˇti⁄_öfo
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

33 
osù_¥oxy_authítiˇti⁄_öfo_t
 *
¥oxy_authítiˇti⁄_öfo
;

34 
i
;

36 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`osù_¥oxy_authítiˇti⁄_öfo_öô
(&(
¥oxy_authítiˇti⁄_öfo
));

41 i‡(
i
 != 0)

42  
i
;

44 
i
 = 
	`osù_¥oxy_authítiˇti⁄_öfo_∑r£
(
¥oxy_authítiˇti⁄_öfo
, 
hvÆue
);

46 i‡(
i
 != 0) {

47 
	`osù_¥oxy_authítiˇti⁄_öfo_‰ì
(
¥oxy_authítiˇti⁄_öfo
);

48  
i
;

51 
sù
->
mesßge_¥›îty
 = 2;

53 
	`osù_li°_add
(&
sù
->
¥oxy_authítiˇti⁄_öfos
, 
¥oxy_authítiˇti⁄_öfo
, -1);

54  
OSIP_SUCCESS
;

55 
	}
}

60 
	$osù_mesßge_gë_¥oxy_authítiˇti⁄_öfo
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_authítiˇti⁄_öfo_t
 **
de°
) {

61 
osù_¥oxy_authítiˇti⁄_öfo_t
 *
¥oxy_authítiˇti⁄_öfo
;

63 *
de°
 = 
NULL
;

65 i‡(
	`osù_li°_size
(&
sù
->
¥oxy_authítiˇti⁄_öfos
Ë<
pos
)

66  
OSIP_UNDEFINED_ERROR
;

68 
¥oxy_authítiˇti⁄_öfo
 = (
osù_¥oxy_authítiˇti⁄_öfo_t
 *Ë
	`osù_li°_gë
(&
sù
->
¥oxy_authítiˇti⁄_öfos
, 
pos
);

70 *
de°
 = 
¥oxy_authítiˇti⁄_öfo
;

71  
pos
;

72 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authorization.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

31 
	$osù_mesßge_£t_¥oxy_auth‹iz©i⁄
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

32 
osù_¥oxy_auth‹iz©i⁄_t
 *
¥oxy_auth‹iz©i⁄
;

33 
i
;

35 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

36  
OSIP_SUCCESS
;

38 
i
 = 
	`osù_¥oxy_auth‹iz©i⁄_öô
(&
¥oxy_auth‹iz©i⁄
);

40 i‡(
i
 != 0)

41  
i
;

43 
i
 = 
	`osù_¥oxy_auth‹iz©i⁄_∑r£
(
¥oxy_auth‹iz©i⁄
, 
hvÆue
);

45 i‡(
i
 != 0) {

46 
	`osù_¥oxy_auth‹iz©i⁄_‰ì
(
¥oxy_auth‹iz©i⁄
);

47  
i
;

50 
sù
->
mesßge_¥›îty
 = 2;

51 
	`osù_li°_add
(&
sù
->
¥oxy_auth‹iz©i⁄s
, 
¥oxy_auth‹iz©i⁄
, -1);

52  
OSIP_SUCCESS
;

53 
	}
}

55 #i‚de‡
MINISIZE


56 
	$osù_mesßge_gë_¥oxy_auth‹iz©i⁄
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_¥oxy_auth‹iz©i⁄_t
 **
de°
) {

57 
osù_¥oxy_auth‹iz©i⁄_t
 *
¥oxy_auth‹iz©i⁄
;

59 *
de°
 = 
NULL
;

61 i‡(
	`osù_li°_size
(&
sù
->
¥oxy_auth‹iz©i⁄s
Ë<
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
¥oxy_auth‹iz©i⁄
 = (
osù_¥oxy_auth‹iz©i⁄_t
 *Ë
	`osù_li°_gë
(&
sù
->
¥oxy_auth‹iz©i⁄s
, 
pos
);

65 *
de°
 = 
¥oxy_auth‹iz©i⁄
;

66  
pos
;

67 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_record_route.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 #i‚de‡
MINISIZE


27 
	$osù_ªc‹d_rouã_öô
(
osù_ªc‹d_rouã_t
 **
ªc‹d_rouã
) {

28  
	`osù_‰om_öô
((
osù_‰om_t
 **Ë
ªc‹d_rouã
);

29 
	}
}

36 
	$osù_mesßge_£t_ªc‹d_rouã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

37 
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
;

38 
i
;

40 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

41  
OSIP_SUCCESS
;

43 
i
 = 
	`osù_ªc‹d_rouã_öô
(&
ªc‹d_rouã
);

45 i‡(
i
 != 0)

46  
i
;

48 
i
 = 
	`osù_ªc‹d_rouã_∑r£
(
ªc‹d_rouã
, 
hvÆue
);

50 i‡(
i
 != 0) {

51 
	`osù_ªc‹d_rouã_‰ì
(
ªc‹d_rouã
);

52  
i
;

55 
sù
->
mesßge_¥›îty
 = 2;

56 
	`osù_li°_add
(&
sù
->
ªc‹d_rouãs
, 
ªc‹d_rouã
, -1);

57  
OSIP_SUCCESS
;

58 
	}
}

60 #i‚de‡
MINISIZE


64 
	$osù_mesßge_gë_ªc‹d_rouã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_ªc‹d_rouã_t
 **
de°
) {

65 
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
;

67 *
de°
 = 
NULL
;

69 i‡(
	`osù_li°_size
(&
sù
->
ªc‹d_rouãs
Ë<
pos
)

70  
OSIP_UNDEFINED_ERROR
;

72 
ªc‹d_rouã
 = (
osù_ªc‹d_rouã_t
 *Ë
	`osù_li°_gë
(&
sù
->
ªc‹d_rouãs
, 
pos
);

73 *
de°
 = 
ªc‹d_rouã
;

74  
pos
;

75 
	}
}

78 #i‚de‡
MINISIZE


79 
	$osù_ªc‹d_rouã_∑r£
(
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
, c⁄° *
hvÆue
) {

80  
	`osù_‰om_∑r£
((
osù_‰om_t
 *Ë
ªc‹d_rouã
, 
hvÆue
);

81 
	}
}

86 
	$osù_ªc‹d_rouã_to_°r
(c⁄° 
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
, **
de°
) {

87 *
uæ
;

88 *
buf
;

89 
i
;

90 
size_t
 
Àn
;

92 *
de°
 = 
NULL
;

94 i‡((
ªc‹d_rouã
 =
NULL
Ë|| (ªc‹d_rouã->
uæ
 == NULL))

95  
OSIP_BADPARAMETER
;

97 
i
 = 
	`osù_uri_to_°r
(
ªc‹d_rouã
->
uæ
, &url);

99 i‡(
i
 != 0)

100  
i
;

102 i‡(
ªc‹d_rouã
->
di•œy«me
 =
NULL
)

103 
Àn
 = 
	`°æí
(
uæ
) + 5;

106 
Àn
 = 
	`°æí
(
uæ
Ë+ såÀn(
ªc‹d_rouã
->
di•œy«me
) + 5;

108 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

110 i‡(
buf
 =
NULL
) {

111 
	`osù_‰ì
(
uæ
);

112  
OSIP_NOMEM
;

116 i‡(
ªc‹d_rouã
->
di•œy«me
 !
NULL
)

117 
	`•rötf
(
buf
, "%†<%s>", 
ªc‹d_rouã
->
di•œy«me
, 
uæ
);

120 
	`•rötf
(
buf
, "<%s>", 
uæ
);

122 
	`osù_‰ì
(
uæ
);

125 
size_t
 
∂í
;

126 *
tmp
;

127 
osù_li°_ôî©‹_t
 
ô
;

128 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
ªc‹d_rouã
->
gí_∑øms
, &
ô
);

130 
u_∑øm
 !
OSIP_SUCCESS
) {

131 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

132 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
) + 2;

135 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 3;

137 
Àn
 =Üí + 
∂í
;

138 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

139 
tmp
 = 
buf
;

140 
tmp
 =Åm∞+ 
	`°æí
(tmp);

142 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

143 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s", 
u_∑øm
->
g«me
);

146 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), ";%s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

148 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

151 *
de°
 = 
buf
;

152  
OSIP_SUCCESS
;

153 
	}
}

157 
	$osù_ªc‹d_rouã_‰ì
(
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
) {

158 
	`osù_‰om_‰ì
((
osù_‰om_t
 *Ë
ªc‹d_rouã
);

159 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_route.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

26 #i‚de‡
MINISIZE


27 
	$osù_rouã_öô
(
osù_rouã_t
 **
rouã
) {

28  
	`osù_‰om_öô
((
osù_‰om_t
 **Ë
rouã
);

29 
	}
}

36 
	$osù_mesßge_£t_rouã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

37 
osù_rouã_t
 *
rouã
;

38 
i
;

40 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

41  
OSIP_SUCCESS
;

43 
i
 = 
	`osù_rouã_öô
(&
rouã
);

45 i‡(
i
 != 0)

46  
i
;

48 
i
 = 
	`osù_rouã_∑r£
(
rouã
, 
hvÆue
);

50 i‡(
i
 != 0) {

51 
	`osù_rouã_‰ì
(
rouã
);

52  
i
;

55 
sù
->
mesßge_¥›îty
 = 2;

56 
	`osù_li°_add
(&
sù
->
rouãs
, 
rouã
, -1);

57  
OSIP_SUCCESS
;

58 
	}
}

60 #i‚de‡
MINISIZE


64 
	$osù_mesßge_gë_rouã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_rouã_t
 **
de°
) {

65 
osù_rouã_t
 *
rouã
;

67 *
de°
 = 
NULL
;

69 i‡(
	`osù_li°_size
(&
sù
->
rouãs
Ë<
pos
)

70  
OSIP_UNDEFINED_ERROR
;

72 
rouã
 = (
osù_rouã_t
 *Ë
	`osù_li°_gë
(&
sù
->
rouãs
, 
pos
);

73 *
de°
 = 
rouã
;

74  
pos
;

75 
	}
}

78 #i‚de‡
MINISIZE


79 
	$osù_rouã_∑r£
(
osù_rouã_t
 *
rouã
, c⁄° *
hvÆue
) {

80  
	`osù_‰om_∑r£
((
osù_‰om_t
 *Ë
rouã
, 
hvÆue
);

81 
	}
}

86 
	$osù_rouã_to_°r
(c⁄° 
osù_rouã_t
 *
rouã
, **
de°
) {

89  
	`osù_ªc‹d_rouã_to_°r
((
osù_ªc‹d_rouã_t
 *Ë
rouã
, 
de°
);

90 
	}
}

94 
	$osù_rouã_‰ì
(
osù_rouã_t
 *
rouã
) {

95 
	`osù_‰om_‰ì
((
osù_‰om_t
 *Ë
rouã
);

96 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_to.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_mesßge.h
>

23 
	~<osù∑r£r2/osù_∑r£r.h
>

25 #i‚de‡
MINISIZE


26 
	$osù_to_öô
(
osù_to_t
 **
to
) {

27  
	`osù_‰om_öô
((
osù_‰om_t
 **Ë
to
);

28 
	}
}

35 
	$osù_mesßge_£t_to
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

36 
i
;

38 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

39  
OSIP_SUCCESS
;

41 i‡(
sù
->
to
 !
NULL
)

42  
OSIP_SYNTAXERROR
;

44 
i
 = 
	`osù_to_öô
(&(
sù
->
to
));

46 i‡(
i
 != 0)

47  
i
;

49 
sù
->
mesßge_¥›îty
 = 2;

50 
i
 = 
	`osù_to_∑r£
(
sù
->
to
, 
hvÆue
);

52 i‡(
i
 != 0) {

53 
	`osù_to_‰ì
(
sù
->
to
);

54 
sù
->
to
 = 
NULL
;

55  
i
;

58  
OSIP_SUCCESS
;

59 
	}
}

61 #i‚de‡
MINISIZE


65 
osù_to_t
 *
	$osù_mesßge_gë_to
(c⁄° 
osù_mesßge_t
 *
sù
) {

66  
sù
->
to
;

67 
	}
}

70 #i‚de‡
MINISIZE


72 
	$osù_to_∑r£
(
osù_to_t
 *
to
, c⁄° *
hvÆue
) {

73  
	`osù_‰om_∑r£
((
osù_‰om_t
 *Ë
to
, 
hvÆue
);

74 
	}
}

79 
	$osù_to_to_°r
(c⁄° 
osù_to_t
 *
to
, **
de°
) {

80  
	`osù_‰om_to_°r
((
osù_‰om_t
 *Ë
to
, 
de°
);

81 
	}
}

85 
	$osù_to_‰ì
(
osù_to_t
 *
to
) {

86 
	`osù_‰om_‰ì
((
osù_‰om_t
 *Ë
to
);

87 
	}
}

89 
	$osù_to_˛⁄e
(c⁄° 
osù_to_t
 *
to
, osù_to_à**
de°
) {

90  
	`osù_‰om_˛⁄e
((
osù_‰om_t
 *Ë
to
, (osù_‰om_à**Ë
de°
);

91 
	}
}

93 
	$osù_to_èg_m©ch
(
osù_to_t
 *
to1
, osù_to_à*
to2
) {

94  
	`osù_‰om_èg_m©ch
((
osù_‰om_t
 *Ë
to1
, (osù_‰om_à*Ë
to2
);

95 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_uri.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

25 
	#osù_is_Æpha
(
ö
Ë((ö >'a' && i¿<'z'Ë|| (ö >'A' && i¿<'Z'))

	)

31 
	$osù_uri_öô
(
osù_uri_t
 **
uæ
) {

32 *
uæ
 = (
osù_uri_t
 *Ë
	`osù_mÆloc
((osip_uri_t));

34 i‡(*
uæ
 =
NULL
)

35  
OSIP_NOMEM
;

37 (*
uæ
)->
scheme
 = 
NULL
;

38 (*
uæ
)->
u£∫ame
 = 
NULL
;

39 (*
uæ
)->
∑ssw‹d
 = 
NULL
;

40 (*
uæ
)->
ho°
 = 
NULL
;

41 (*
uæ
)->
p‹t
 = 
NULL
;

43 
	`osù_li°_öô
(&(*
uæ
)->
uæ_∑øms
);

45 
	`osù_li°_öô
(&(*
uæ
)->
uæ_hódîs
);

47 (*
uæ
)->
°rög
 = 
NULL
;

48  
OSIP_SUCCESS
;

49 
	}
}

70 c⁄° *
	$√xt_£∑øt‹
(c⁄° *
ch
, 
£∑øt‹_osù_to_föd
, 
bef‹e_£∑øt‹
) {

71 c⁄° *
öd
;

72 c⁄° *
tmp
;

74 
öd
 = 
	`°rchr
(
ch
, 
£∑øt‹_osù_to_föd
);

76 i‡(
öd
 =
NULL
)

77  
NULL
;

79 
tmp
 = 
NULL
;

81 i‡(
bef‹e_£∑øt‹
 != 0)

82 
tmp
 = 
	`°rchr
(
ch
, 
bef‹e_£∑øt‹
);

84 i‡(
tmp
 !
NULL
) {

85 i‡(
öd
 < 
tmp
)

86  
öd
;

89  
öd
;

91  
NULL
;

92 
	}
}

99 
	$osù_uri_∑r£
(
osù_uri_t
 *
uæ
, c⁄° *
buf
) {

100 c⁄° *
u£∫ame
;

101 c⁄° *
∑ssw‹d
;

102 c⁄° *
ho°
;

103 c⁄° *
p‹t
;

104 c⁄° *
∑øms
;

105 c⁄° *
hódîs
;

106 c⁄° *
tmp
;

107 
i
;

110 i‡(
buf
 =
NULL
 || buf[0] == '\0')

111  
OSIP_BADPARAMETER
;

113 
tmp
 = 
	`°rchr
(
buf
, ':');

115 i‡(
tmp
 =
NULL
)

116  
OSIP_SYNTAXERROR
;

118 i‡(
tmp
 - 
buf
 < 2)

119  
OSIP_SYNTAXERROR
;

121 
i
 = 0;

123 
buf
 + 
i
 < 
tmp
) {

124 i‡(!
	`osù_is_Æpha
(
buf
[
i
]))

125  
OSIP_SYNTAXERROR
;

127 
i
++;

130 
uæ
->
scheme
 = (*Ë
	`osù_mÆloc
(
tmp
 - 
buf
 + 1);

132 i‡(
uæ
->
scheme
 =
NULL
)

133  
OSIP_NOMEM
;

135 
	`osù_°∫˝y
(
uæ
->
scheme
, 
buf
, 
tmp
 - buf);

137 i‡(
	`°rchr
(
uæ
->
scheme
, ' 'Ë!
NULL
) {

138  
OSIP_SYNTAXERROR
;

141 i‡(
	`°æí
(
uæ
->
scheme
Ë< 3 || (0 !
	`osù_°∫ˇ£cmp
(url->scheme, "sip", 3) && 0 != osip_strncasecmp(url->scheme, "sips", 4))) {

142 
size_t
 
i
 = 
	`°æí
(
tmp
 + 1);

144 i‡(
i
 < 2)

145  
OSIP_SYNTAXERROR
;

147 
uæ
->
°rög
 = (*Ë
	`osù_mÆloc
(
i
 + 1);

149 i‡(
uæ
->
°rög
 =
NULL
)

150  
OSIP_NOMEM
;

152 
	`osù_°∫˝y
(
uæ
->
°rög
, 
tmp
 + 1, 
i
);

153  
OSIP_SUCCESS
;

165 
u£∫ame
 = 
	`°rchr
(
buf
, ':');

168 i‡(
u£∫ame
 =
NULL
)

169  
OSIP_SYNTAXERROR
;

171 
ho°
 = 
	`°rchr
(
buf
, '@');

173 i‡(
ho°
 =
NULL
)

174 
ho°
 = 
u£∫ame
;

176 i‡(
u£∫ame
[1] == '@')

177 
ho°
 = 
u£∫ame
 + 1;

182 
∑ssw‹d
 = 
	`√xt_£∑øt‹
(
u£∫ame
 + 1, ':', '@');

184 i‡(
∑ssw‹d
 =
NULL
)

185 
∑ssw‹d
 = 
ho°
;

190 i‡(
ho°
 - 
∑ssw‹d
 < 2)

191  
OSIP_SYNTAXERROR
;

193 
uæ
->
∑ssw‹d
 = (*Ë
	`osù_mÆloc
(
ho°
 -Öassword);

195 i‡(
uæ
->
∑ssw‹d
 =
NULL
)

196  
OSIP_NOMEM
;

198 
	`osù_°∫˝y
(
uæ
->
∑ssw‹d
,Öassw‹d + 1, 
ho°
 -Öassword - 1);

199 
	`__osù_uri_u√sˇ≥
(
uæ
->
∑ssw‹d
);

202 i‡(
∑ssw‹d
 - 
u£∫ame
 < 2)

203  
OSIP_SYNTAXERROR
;

206 
uæ
->
u£∫ame
 = (*Ë
	`osù_mÆloc
(
∑ssw‹d
 - username);

208 i‡(
uæ
->
u£∫ame
 =
NULL
)

209  
OSIP_NOMEM
;

211 
	`osù_°∫˝y
(
uæ
->
u£∫ame
, u£∫amê+ 1, 
∑ssw‹d
 - username - 1);

212 
	`__osù_uri_u√sˇ≥
(
uæ
->
u£∫ame
);

217 
hódîs
 = 
	`°rchr
(
ho°
, '?');

219 i‡(
hódîs
 =
NULL
)

220 
hódîs
 = 
buf
 + 
	`°æí
(buf);

224 
	`osù_uri_∑r£_hódîs
(
uæ
, 
hódîs
);

227 
∑øms
 = 
	`°rchr
(
ho°
, ';');

229 i‡(
∑øms
 =
NULL
)

230 
∑øms
 = 
hódîs
;

235 *
tmpbuf
;

237 i‡(
hódîs
 - 
∑øms
 + 1 < 2)

238  
OSIP_SYNTAXERROR
;

240 
tmpbuf
 = 
	`osù_mÆloc
(
hódîs
 - 
∑øms
 + 1);

242 i‡(
tmpbuf
 =
NULL
)

243  
OSIP_NOMEM
;

245 
tmpbuf
 = 
	`osù_°∫˝y
—mpbuf, 
∑øms
, 
hódîs
 -Öarams);

246 
	`osù_uri_∑r£_∑øms
(
uæ
, 
tmpbuf
);

247 
	`osù_‰ì
(
tmpbuf
);

250 
p‹t
 = 
∑øms
 - 1;

252 
p‹t
 > 
ho°
 && *port != ']' && *port != ':')

253 
p‹t
--;

255 i‡(*
p‹t
 == ':') {

256 i‡(
ho°
 =
p‹t
)

257 
p‹t
 = 
∑øms
;

260 i‡((
∑øms
 - 
p‹t
 < 2) || (params -Öort > 8))

261  
OSIP_SYNTAXERROR
;

263 
uæ
->
p‹t
 = (*Ë
	`osù_mÆloc
(
∑øms
 -Öort);

265 i‡(
uæ
->
p‹t
 =
NULL
)

266  
OSIP_NOMEM
;

268 
	`osù_˛∫˝y
(
uæ
->
p‹t
,Ö‹à+ 1, 
∑øms
 -Öort - 1);

272 
p‹t
 = 
∑øms
;

275 
tmp
 = 
p‹t
;

277 
tmp
 > 
ho°
 && *tmp != ']')

278 
tmp
--;

280 i‡(*
tmp
 == ']') {

281 
p‹t
 = 
tmp
;

283 
ho°
 < 
p‹t
 && *host != '[')

284 
ho°
++;

286 i‡(
ho°
 >
p‹t
)

287  
OSIP_SYNTAXERROR
;

290 i‡(
p‹t
 - 
ho°
 < 2)

291  
OSIP_SYNTAXERROR
;

293 
uæ
->
ho°
 = (*Ë
	`osù_mÆloc
(
p‹t
 - host);

295 i‡(
uæ
->
ho°
 =
NULL
)

296  
OSIP_NOMEM
;

298 
	`osù_˛∫˝y
(
uæ
->
ho°
, ho° + 1, 
p‹t
 - host - 1);

300  
OSIP_SUCCESS
;

301 
	}
}

303 
	$osù_uri_£t_scheme
(
osù_uri_t
 *
uæ
, *
scheme
) {

304 i‡(
uæ
 =
NULL
)

307 
uæ
->
scheme
 = scheme;

308 
	}
}

310 *
	$osù_uri_gë_scheme
(
osù_uri_t
 *
uæ
) {

311 i‡(
uæ
 =
NULL
)

312  
NULL
;

314  
uæ
->
scheme
;

315 
	}
}

317 
	$osù_uri_£t_u£∫ame
(
osù_uri_t
 *
uæ
, *
u£∫ame
) {

318 i‡(
uæ
 =
NULL
)

321 
uæ
->
u£∫ame
 = username;

322 
	}
}

324 *
	$osù_uri_gë_u£∫ame
(
osù_uri_t
 *
uæ
) {

325 i‡(
uæ
 =
NULL
)

326  
NULL
;

328  
uæ
->
u£∫ame
;

329 
	}
}

331 
	$osù_uri_£t_∑ssw‹d
(
osù_uri_t
 *
uæ
, *
∑ssw‹d
) {

332 i‡(
uæ
 =
NULL
)

335 
uæ
->
∑ssw‹d
 =Öassword;

336 
	}
}

338 *
	$osù_uri_gë_∑ssw‹d
(
osù_uri_t
 *
uæ
) {

339 i‡(
uæ
 =
NULL
)

340  
NULL
;

342  
uæ
->
∑ssw‹d
;

343 
	}
}

345 
	$osù_uri_£t_ho°
(
osù_uri_t
 *
uæ
, *
ho°
) {

346 i‡(
uæ
 =
NULL
)

349 
uæ
->
ho°
 = host;

350 
	}
}

352 *
	$osù_uri_gë_ho°
(
osù_uri_t
 *
uæ
) {

353 i‡(
uæ
 =
NULL
)

354  
NULL
;

356  
uæ
->
ho°
;

357 
	}
}

359 
	$osù_uri_£t_p‹t
(
osù_uri_t
 *
uæ
, *
p‹t
) {

360 i‡(
uæ
 =
NULL
)

363 
uæ
->
p‹t
 =Öort;

364 
	}
}

366 *
	$osù_uri_gë_p‹t
(
osù_uri_t
 *
uæ
) {

367 i‡(
uæ
 =
NULL
)

368  
NULL
;

370  
uæ
->
p‹t
;

371 
	}
}

373 
	$osù_uri_∑r£_hódîs
(
osù_uri_t
 *
uæ
, c⁄° *
hódîs
) {

374 
i
;

375 c⁄° *
_™d
;

376 c⁄° *
equÆ
;

378 i‡(
hódîs
[0] != '?')

379  
OSIP_SYNTAXERROR
;

384 
equÆ
 = 
	`°rchr
(
hódîs
, '=');

385 
_™d
 = 
	`°rchr
(
hódîs
 + 1, '&');

387 i‡(
equÆ
 =
NULL
)

388  
OSIP_SYNTAXERROR
;

391 *
h«me
;

392 *
hvÆue
;

394 
h«me
 = (*Ë
	`osù_mÆloc
(
equÆ
 - 
hódîs
);

396 i‡(
h«me
 =
NULL
)

397  
OSIP_NOMEM
;

399 
	`osù_°∫˝y
(
h«me
, 
hódîs
 + 1, 
equÆ
 - headers - 1);

400 
	`__osù_uri_u√sˇ≥
(
h«me
);

402 i‡(
_™d
 !
NULL
) {

403 i‡(
_™d
 - 
equÆ
 < 2) {

404 
	`osù_‰ì
(
h«me
);

405  
OSIP_SYNTAXERROR
;

408 
hvÆue
 = (*Ë
	`osù_mÆloc
(
_™d
 - 
equÆ
);

410 i‡(
hvÆue
 =
NULL
) {

411 
	`osù_‰ì
(
h«me
);

412  
OSIP_NOMEM
;

415 
	`osù_°∫˝y
(
hvÆue
, 
equÆ
 + 1, 
_™d
 -Équal - 1);

416 
	`__osù_uri_u√sˇ≥
(
hvÆue
);

419 i‡(
hódîs
 + 
	`°æí
(hódîsË- 
equÆ
 + 1 < 2) {

420 
	`osù_‰ì
(
h«me
);

421  
OSIP_SYNTAXERROR
;

424 
hvÆue
 = (*Ë
	`osù_mÆloc
(
hódîs
 + 
	`°æí
(hódîsË- 
equÆ
 + 1);

426 i‡(
hvÆue
 =
NULL
) {

427 
	`osù_‰ì
(
h«me
);

428  
OSIP_NOMEM
;

431 
	`osù_°∫˝y
(
hvÆue
, 
equÆ
 + 1, 
hódîs
 + 
	`°æí
(headers) -Équal);

432 
	`__osù_uri_u√sˇ≥
(
hvÆue
);

435 
i
 = 
	`osù_uri_uhódî_add
(
uæ
, 
h«me
, 
hvÆue
);

437 i‡(
i
 !
OSIP_SUCCESS
) {

438 
	`osù_‰ì
(
h«me
);

439 
	`osù_‰ì
(
hvÆue
);

440  
i
;

443 i‡(
_™d
 =
NULL
)

444 
equÆ
 = 
NULL
;

448 
hódîs
 = 
_™d
;

449 
equÆ
 = 
	`°rchr
(
hódîs
, '=');

450 
_™d
 = 
	`°rchr
(
hódîs
 + 1, '&');

452 i‡(
equÆ
 =
NULL
)

453  
OSIP_SYNTAXERROR
;

455 } 
equÆ
 !
NULL
);

457  
OSIP_SUCCESS
;

458 
	}
}

460 
	$osù_uri_∑r£_∑øms
(
osù_uri_t
 *
uæ
, c⁄° *
∑øms
) {

461 
i
;

462 *
≤ame
;

463 *
pvÆue
;

465 c⁄° *
comma
;

466 c⁄° *
equÆ
;

468 i‡(
∑øms
[0] != ';')

469  
OSIP_SYNTAXERROR
;

474 
equÆ
 = 
	`√xt_£∑øt‹
(
∑øms
 + 1, '=', ';');

475 
comma
 = 
	`°rchr
(
∑øms
 + 1, ';');

477 
comma
 !
NULL
) {

478 i‡(
equÆ
 =
NULL
) {

479 
equÆ
 = 
comma
;

480 
pvÆue
 = 
NULL
;

483 i‡(
comma
 - 
equÆ
 < 2)

484  
OSIP_SYNTAXERROR
;

486 
pvÆue
 = (*Ë
	`osù_mÆloc
(
comma
 - 
equÆ
);

488 i‡(
pvÆue
 =
NULL
)

489  
OSIP_NOMEM
;

491 
	`osù_°∫˝y
(
pvÆue
, 
equÆ
 + 1, 
comma
 -Équal - 1);

492 
	`__osù_uri_u√sˇ≥
(
pvÆue
);

495 i‡(
equÆ
 - 
∑øms
 < 2) {

496 
	`osù_‰ì
(
pvÆue
);

497  
OSIP_SYNTAXERROR
;

500 
≤ame
 = (*Ë
	`osù_mÆloc
(
equÆ
 - 
∑øms
);

502 i‡(
≤ame
 =
NULL
) {

503 
	`osù_‰ì
(
pvÆue
);

504  
OSIP_NOMEM
;

507 
	`osù_°∫˝y
(
≤ame
, 
∑øms
 + 1, 
equÆ
 -Öarams - 1);

508 
	`__osù_uri_u√sˇ≥
(
≤ame
);

510 
i
 = 
	`osù_uri_u∑øm_add
(
uæ
, 
≤ame
, 
pvÆue
);

512 i‡(
i
 !
OSIP_SUCCESS
) {

513 
	`osù_‰ì
(
≤ame
);

514 
	`osù_‰ì
(
pvÆue
);

515  
OSIP_NOMEM
;

518 
∑øms
 = 
comma
;

519 
equÆ
 = 
	`√xt_£∑øt‹
(
∑øms
 + 1, '=', ';');

520 
comma
 = 
	`°rchr
(
∑øms
 + 1, ';');

524 
comma
 = 
∑øms
 + 
	`°æí
(params);

526 i‡(
equÆ
 =
NULL
) {

527 
equÆ
 = 
comma
;

528 
pvÆue
 = 
NULL
;

531 i‡(
comma
 - 
equÆ
 < 2)

532  
OSIP_SYNTAXERROR
;

534 
pvÆue
 = (*Ë
	`osù_mÆloc
(
comma
 - 
equÆ
);

536 i‡(
pvÆue
 =
NULL
)

537  
OSIP_NOMEM
;

539 
	`osù_°∫˝y
(
pvÆue
, 
equÆ
 + 1, 
comma
 -Équal - 1);

540 
	`__osù_uri_u√sˇ≥
(
pvÆue
);

543 i‡(
equÆ
 - 
∑øms
 < 2) {

544 
	`osù_‰ì
(
pvÆue
);

545  
OSIP_SYNTAXERROR
;

548 
≤ame
 = (*Ë
	`osù_mÆloc
(
equÆ
 - 
∑øms
);

550 i‡(
≤ame
 =
NULL
) {

551 
	`osù_‰ì
(
pvÆue
);

552  
OSIP_NOMEM
;

555 
	`osù_°∫˝y
(
≤ame
, 
∑øms
 + 1, 
equÆ
 -Öarams - 1);

556 
	`__osù_uri_u√sˇ≥
(
≤ame
);

558 
i
 = 
	`osù_uri_u∑øm_add
(
uæ
, 
≤ame
, 
pvÆue
);

560 i‡(
i
 !
OSIP_SUCCESS
) {

561 
	`osù_‰ì
(
≤ame
);

562 
	`osù_‰ì
(
pvÆue
);

563  
OSIP_NOMEM
;

566  
OSIP_SUCCESS
;

567 
	}
}

569 
	$osù_uri_to_°r
(c⁄° 
osù_uri_t
 *
uæ
, **
de°
) {

570 *
buf
;

571 
size_t
 
Àn
;

572 
size_t
 
∂í
;

573 *
tmp
;

574 c⁄° *
scheme
;

576 *
de°
 = 
NULL
;

578 i‡(
uæ
 =
NULL
)

579  
OSIP_BADPARAMETER
;

581 i‡(
uæ
->
ho°
 =
NULL
 && uæ->
°rög
 == NULL)

582  
OSIP_BADPARAMETER
;

584 i‡(
uæ
->
scheme
 =
NULL
 && uæ->
°rög
 != NULL)

585  
OSIP_BADPARAMETER
;

587 i‡(
uæ
->
°rög
 =
NULL
 && uæ->
scheme
 == NULL)

588 
scheme
 = "sip";

590 
scheme
 = 
uæ
->scheme;

592 i‡(
uæ
->
°rög
 !
NULL
) {

593 
buf
 = (*Ë
	`osù_mÆloc
(
	`°æí
(
scheme
Ë+ såÀn(
uæ
->
°rög
) + 3);

595 i‡(
buf
 =
NULL
)

596  
OSIP_NOMEM
;

598 *
de°
 = 
buf
;

599 
	`•rötf
(
buf
, "%s:", 
scheme
);

600 
buf
 = bu‡+ 
	`°æí
(
scheme
) + 1;

601 
	`•rötf
(
buf
, "%s", 
uæ
->
°rög
);

602  
OSIP_SUCCESS
;

605 
Àn
 = 
	`°æí
(
scheme
Ë+ 1 + såÀn(
uæ
->
ho°
) + 5;

607 i‡(
uæ
->
u£∫ame
 !
NULL
)

608 
Àn
 =Üí + (
	`°æí
(
uæ
->
u£∫ame
) * 3) + 1;

610 i‡(
uæ
->
∑ssw‹d
 !
NULL
)

611 
Àn
 =Üí + (
	`°æí
(
uæ
->
∑ssw‹d
) * 3) + 1;

613 i‡(
uæ
->
p‹t
 !
NULL
)

614 
Àn
 =Üí + 
	`°æí
(
uæ
->
p‹t
) + 3;

616 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

618 i‡(
buf
 =
NULL
)

619  
OSIP_NOMEM
;

621 
tmp
 = 
buf
;

623 
	`•rötf
(
tmp
, "%s:", 
scheme
);

624 
tmp
 =Åm∞+ 
	`°æí
(tmp);

626 i‡(
uæ
->
u£∫ame
 !
NULL
) {

627 *
tmp2
 = 
	`__osù_uri_esˇ≥_u£röfo
(
uæ
->
u£∫ame
);

629 i‡(
tmp2
 =
NULL
) {

630 
	`osù_‰ì
(
buf
);

631  
OSIP_NOMEM
;

634 
	`•rötf
(
tmp
, "%s", 
tmp2
);

635 
	`osù_‰ì
(
tmp2
);

636 
tmp
 =Åm∞+ 
	`°æí
(tmp);

639 i‡((
uæ
->
∑ssw‹d
 !
NULL
Ë&& (uæ->
u£∫ame
 != NULL)) {

640 *
tmp2
 = 
	`__osù_uri_esˇ≥_∑ssw‹d
(
uæ
->
∑ssw‹d
);

642 i‡(
tmp2
 =
NULL
) {

643 
	`osù_‰ì
(
buf
);

644  
OSIP_NOMEM
;

647 
	`•rötf
(
tmp
, ":%s", 
tmp2
);

648 
	`osù_‰ì
(
tmp2
);

649 
tmp
 =Åm∞+ 
	`°æí
(tmp);

652 i‡(
uæ
->
u£∫ame
 !
NULL
) {

653 
	`•rötf
(
tmp
, "@");

654 
tmp
++;

657 i‡(
	`°rchr
(
uæ
->
ho°
, ':'Ë!
NULL
) {

658 
	`•rötf
(
tmp
, "[%s]", 
uæ
->
ho°
);

659 
tmp
 =Åm∞+ 
	`°æí
(tmp);

662 
	`•rötf
(
tmp
, "%s", 
uæ
->
ho°
);

663 
tmp
 =Åm∞+ 
	`°æí
(tmp);

666 i‡(
uæ
->
p‹t
 !
NULL
) {

667 
	`•rötf
(
tmp
, ":%s", 
uæ
->
p‹t
);

668 
tmp
 =Åm∞+ 
	`°æí
(tmp);

672 
osù_li°_ôî©‹_t
 
ô
;

673 
osù_uri_∑øm_t
 *
u_∑øm
 = (osù_uri_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
uæ
->
uæ_∑øms
, &
ô
);

675 
u_∑øm
 !
OSIP_SUCCESS
) {

676 *
tmp1
;

677 *
tmp2
 = 
NULL
;

678 *
¥evious_buf
;

680 i‡(
	`osù_°rˇ£cmp
(
u_∑øm
->
g«me
, "x-obr") == 0 || osip_strcasecmp(u_param->gname, "x-obp") == 0) {

682 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

686 
tmp1
 = 
	`__osù_uri_esˇ≥_uri_∑øm
(
u_∑øm
->
g«me
);

688 i‡(
tmp1
 =
NULL
) {

689 
	`osù_‰ì
(
buf
);

690  
OSIP_SYNTAXERROR
;

693 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

694 
∂í
 = 
	`°æí
(
tmp1
) + 2;

697 
tmp2
 = 
	`__osù_uri_esˇ≥_uri_∑øm
(
u_∑øm
->
gvÆue
);

699 i‡(
tmp2
 =
NULL
) {

700 
	`osù_‰ì
(
tmp1
);

701 
	`osù_‰ì
(
buf
);

702  
OSIP_SYNTAXERROR
;

705 
∂í
 = 
	`°æí
(
tmp1
Ë+ såÀn(
tmp2
) + 3;

708 
Àn
 =Üí + 
∂í
;

709 
¥evious_buf
 = 
buf
;

710 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

712 i‡(
buf
 =
NULL
) {

713 
	`osù_‰ì
(
¥evious_buf
);

714 
	`osù_‰ì
(
tmp1
);

715 
	`osù_‰ì
(
tmp2
);

716  
OSIP_NOMEM
;

719 
tmp
 = 
buf
;

720 
tmp
 =Åm∞+ 
	`°æí
(tmp);

722 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

723 
	`•rötf
(
tmp
, ";%s", 
tmp1
);

726 
	`•rötf
(
tmp
, ";%s=%s", 
tmp1
, 
tmp2
);

727 
	`osù_‰ì
(
tmp2
);

730 
	`osù_‰ì
(
tmp1
);

731 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

736 
osù_li°_ôî©‹_t
 
ô
;

737 
osù_uri_hódî_t
 *
u_hódî
 = (osù_uri_hódî_à*Ë
	`osù_li°_gë_fú°
(&
uæ
->
uæ_hódîs
, &
ô
);

739 
u_hódî
 !
OSIP_SUCCESS
) {

740 *
tmp1
;

741 *
tmp2
;

742 *
¥evious_buf
;

744 
tmp1
 = 
	`__osù_uri_esˇ≥_hódî_∑øm
(
u_hódî
->
g«me
);

746 i‡(
tmp1
 =
NULL
) {

747 
	`osù_‰ì
(
buf
);

748  
OSIP_SYNTAXERROR
;

751 
tmp2
 = 
	`__osù_uri_esˇ≥_hódî_∑øm
(
u_hódî
->
gvÆue
);

753 i‡(
tmp2
 =
NULL
) {

754 
	`osù_‰ì
(
tmp1
);

755 
	`osù_‰ì
(
buf
);

756  
OSIP_SYNTAXERROR
;

759 
∂í
 = 
	`°æí
(
tmp1
Ë+ såÀn(
tmp2
) + 4;

761 
Àn
 =Üí + 
∂í
;

762 
¥evious_buf
 = 
buf
;

763 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

765 i‡(
buf
 =
NULL
) {

766 
	`osù_‰ì
(
¥evious_buf
);

767 
	`osù_‰ì
(
tmp1
);

768 
	`osù_‰ì
(
tmp2
);

769  
OSIP_NOMEM
;

772 
tmp
 = 
buf
;

773 
tmp
 =Åm∞+ 
	`°æí
(tmp);

775 i‡(
ô
.
pos
 == 0)

776 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), "?%s=%s", 
tmp1
, 
tmp2
);

779 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), "&%s=%s", 
tmp1
, 
tmp2
);

781 
	`osù_‰ì
(
tmp1
);

782 
	`osù_‰ì
(
tmp2
);

783 
u_hódî
 = (
osù_uri_hódî_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

787 *
de°
 = 
buf
;

788  
OSIP_SUCCESS
;

789 
	}
}

791 
	$osù_uri_‰ì
(
osù_uri_t
 *
uæ
) {

792 i‡(
uæ
 =
NULL
)

795 
	`osù_‰ì
(
uæ
->
scheme
);

796 
	`osù_‰ì
(
uæ
->
u£∫ame
);

797 
	`osù_‰ì
(
uæ
->
∑ssw‹d
);

798 
	`osù_‰ì
(
uæ
->
ho°
);

799 
	`osù_‰ì
(
uæ
->
p‹t
);

801 
	`osù_uri_∑øm_‰ìli°
(&
uæ
->
uæ_∑øms
);

804 
osù_uri_hódî_t
 *
u_hódî
;

806 !
	`osù_li°_eﬁ
(&
uæ
->
uæ_hódîs
, 0)) {

807 
u_hódî
 = (
osù_uri_hódî_t
 *Ë
	`osù_li°_gë
(&
uæ
->
uæ_hódîs
, 0);

808 
	`osù_li°_ªmove
(&
uæ
->
uæ_hódîs
, 0);

809 
	`osù_uri_hódî_‰ì
(
u_hódî
);

813 
	`osù_‰ì
(
uæ
->
°rög
);

815 
	`osù_‰ì
(
uæ
);

816 
	}
}

818 
	$osù_uri_˛⁄e
(c⁄° 
osù_uri_t
 *
uæ
, osù_uri_à**
de°
) {

819 
i
;

820 
osù_uri_t
 *
ur
;

822 *
de°
 = 
NULL
;

824 i‡(
uæ
 =
NULL
)

825  
OSIP_BADPARAMETER
;

827 i‡(
uæ
->
ho°
 =
NULL
 && uæ->
°rög
 == NULL)

828  
OSIP_BADPARAMETER
;

830 
i
 = 
	`osù_uri_öô
(&
ur
);

832 i‡(
i
 != 0)

833  
i
;

835 i‡(
uæ
->
scheme
 !
NULL
)

836 
ur
->
scheme
 = 
	`osù_°rdup
(
uæ
->scheme);

838 i‡(
uæ
->
u£∫ame
 !
NULL
)

839 
ur
->
u£∫ame
 = 
	`osù_°rdup
(
uæ
->username);

841 i‡(
uæ
->
∑ssw‹d
 !
NULL
)

842 
ur
->
∑ssw‹d
 = 
	`osù_°rdup
(
uæ
->password);

844 i‡(
uæ
->
ho°
 !
NULL
)

845 
ur
->
ho°
 = 
	`osù_°rdup
(
uæ
->host);

847 i‡(
uæ
->
p‹t
 !
NULL
)

848 
ur
->
p‹t
 = 
	`osù_°rdup
(
uæ
->port);

850 i‡(
uæ
->
°rög
 !
NULL
)

851 
ur
->
°rög
 = 
	`osù_°rdup
(
uæ
->string);

853 
i
 = 
	`osù_li°_˛⁄e
(&
uæ
->
uæ_∑øms
, &
ur
->uæ_∑øms, ((*)(*, **)Ë& 
osù_uri_∑øm_˛⁄e
);

855 i‡(
i
 != 0) {

856 
	`osù_uri_‰ì
(
ur
);

857  
i
;

860 
i
 = 
	`osù_li°_˛⁄e
(&
uæ
->
uæ_hódîs
, &
ur
->uæ_hódîs, ((*)(*, **)Ë& 
osù_uri_∑øm_˛⁄e
);

862 i‡(
i
 != 0) {

863 
	`osù_uri_‰ì
(
ur
);

864  
i
;

867 *
de°
 = 
ur
;

868  
OSIP_SUCCESS
;

869 
	}
}

871 
	$osù_uri_∑øm_öô
(
osù_uri_∑øm_t
 **
uæ_∑øm
) {

872 *
uæ_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_mÆloc
((osip_uri_param_t));

874 i‡(*
uæ_∑øm
 =
NULL
)

875  
OSIP_NOMEM
;

877 (*
uæ_∑øm
)->
g«me
 = 
NULL
;

878 (*
uæ_∑øm
)->
gvÆue
 = 
NULL
;

879  
OSIP_SUCCESS
;

880 
	}
}

882 
	$osù_uri_∑øm_‰ì
(
osù_uri_∑øm_t
 *
uæ_∑øm
) {

883 
	`osù_‰ì
(
uæ_∑øm
->
g«me
);

884 
	`osù_‰ì
(
uæ_∑øm
->
gvÆue
);

885 
	`osù_‰ì
(
uæ_∑øm
);

886 
	}
}

888 
	$osù_uri_∑øm_£t
(
osù_uri_∑øm_t
 *
uæ_∑øm
, *
≤ame
, *
pvÆue
) {

889 
uæ_∑øm
->
g«me
 = 
≤ame
;

891 
	`osù_˛r•a˚
(
uæ_∑øm
->
g«me
);

892 
uæ_∑øm
->
gvÆue
 = 
pvÆue
;

894 i‡(
uæ_∑øm
->
gvÆue
 !
NULL
)

895 
	`osù_˛r•a˚
(
uæ_∑øm
->
gvÆue
);

897  
OSIP_SUCCESS
;

898 
	}
}

900 
	$osù_uri_∑øm_add
(
osù_li°_t
 *
uæ_∑øms
, *
≤ame
, *
pvÆue
) {

901 
i
;

902 
osù_uri_∑øm_t
 *
uæ_∑øm
;

904 
i
 = 
	`osù_uri_∑øm_öô
(&
uæ_∑øm
);

906 i‡(
i
 != 0)

907  
i
;

909 
i
 = 
	`osù_uri_∑øm_£t
(
uæ_∑øm
, 
≤ame
, 
pvÆue
);

911 i‡(
i
 != 0) {

912 
	`osù_uri_∑øm_‰ì
(
uæ_∑øm
);

913  
i
;

916 
	`osù_li°_add
(
uæ_∑øms
, 
uæ_∑øm
, -1);

917  
OSIP_SUCCESS
;

918 
	}
}

920 
	$osù_uri_∑øm_‰ìli°
(
osù_li°_t
 *
∑øms
) {

921 
osù_uri_∑øm_t
 *
u_∑øm
;

923 !
	`osù_li°_eﬁ
(
∑øms
, 0)) {

924 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë
(
∑øms
, 0);

925 
	`osù_li°_ªmove
(
∑øms
, 0);

926 
	`osù_uri_∑øm_‰ì
(
u_∑øm
);

928 
	}
}

930 
	$osù_uri_∑øm_gë_by«me
(
osù_li°_t
 *
∑øms
, *
≤ame
, 
osù_uri_∑øm_t
 **
uæ_∑øm
) {

931 
size_t
 
≤ame_Àn
;

932 
osù_uri_∑øm_t
 *
u_∑øm
;

933 
osù_li°_ôî©‹_t
 
ô
;

935 *
uæ_∑øm
 = 
NULL
;

937 i‡(
≤ame
 =
NULL
)

938  
OSIP_BADPARAMETER
;

940 
≤ame_Àn
 = 
	`°æí
(
≤ame
);

942 i‡(
≤ame_Àn
 <= 0)

943  
OSIP_BADPARAMETER
;

945 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë_fú°
(
∑øms
, &
ô
);

947 
u_∑øm
 !
OSIP_SUCCESS
) {

948 
size_t
 
Àn
;

950 
Àn
 = 
	`°æí
(
u_∑øm
->
g«me
);

952 i‡(
≤ame_Àn
 =
Àn
 && 
	`osù_°∫ˇ£cmp
(
u_∑øm
->
g«me
, 
≤ame
, 
	`°æí
(pname)) == 0) {

953 *
uæ_∑øm
 = 
u_∑øm
;

954  
OSIP_SUCCESS
;

957 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

960  
OSIP_UNDEFINED_ERROR
;

961 
	}
}

963 
	$osù_uri_∑øm_˛⁄e
(c⁄° 
osù_uri_∑øm_t
 *
u∑øm
, osù_uri_∑øm_à**
de°
) {

964 
i
;

965 
osù_uri_∑øm_t
 *
up
;

967 *
de°
 = 
NULL
;

969 i‡(
u∑øm
 =
NULL
)

970  
OSIP_BADPARAMETER
;

972 i‡(
u∑øm
->
g«me
 =
NULL
)

973  
OSIP_BADPARAMETER
;

975 
i
 = 
	`osù_uri_∑øm_öô
(&
up
);

977 i‡(
i
 != 0)

978  
i
;

980 
up
->
g«me
 = 
	`osù_°rdup
(
u∑øm
->gname);

982 i‡(
u∑øm
->
gvÆue
 !
NULL
)

983 
up
->
gvÆue
 = 
	`osù_°rdup
(
u∑øm
->gvalue);

986 
up
->
gvÆue
 = 
NULL
;

988 *
de°
 = 
up
;

989  
OSIP_SUCCESS
;

990 
	}
}

992 
	#_ALPHANUM_
 "abcdefghijklmn›qr°uvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\0"

	)

993 
	#_RESERVED_
 ";/?:@&=+$\0"

	)

994 
	#_MARK_
 "-_.!~*'()\0"

	)

996 
	#_MARK__USER_UNRESERVED_
 "-_.!~*'()&=+$,;?/\0"

	)

997 
	#_MARK__PWORD_UNRESERVED_
 "-_.!~*'()&=+$,\0"

	)

998 
	#_MARK__URI_PARAM_UNRESERVED_
 "-_.!~*'()[]/:&+$\0"

	)

999 
	#_MARK__HEADER_PARAM_UNRESERVED_
 "-_.!~*'()[]/?:+$\0"

	)

1001 
	#osù_is_Æph™um
(
ö
Ë((ö >'a' && i¿<'z'Ë|| (ö >'A' && i¿<'Z'Ë|| (ö >'0' && i¿<'9'))

	)

1003 *
	$__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(c⁄° *
°rög
, c⁄° *
def
) {

1004 
size_t
 
Æloc
 = 
	`°æí
(
°rög
) + 1;

1005 
size_t
 
Àngth
;

1006 *
ns
 = (*Ë
	`osù_mÆloc
(
Æloc
);

1007 
ö
;

1008 
size_t
 
√wÀn
 = 
Æloc
;

1009 
ödex
 = 0;

1010 c⁄° *
tmp
;

1011 
i
;

1013 i‡(
ns
 =
NULL
)

1014  
NULL
;

1016 
Àngth
 = 
Æloc
 - 1;

1018 
Àngth
--) {

1019 
ö
 = *
°rög
;

1021 
i
 = 0;

1022 
tmp
 = 
NULL
;

1024 i‡(
	`osù_is_Æph™um
(
ö
))

1025 
tmp
 = 
°rög
;

1028 ; 
def
[
i
] !'\0' && def[i] !
ö
; i++) {

1031 i‡(
def
[
i
] != '\0')

1032 
tmp
 = 
°rög
;

1035 i‡(
tmp
 =
NULL
) {

1037 
√wÀn
 += 2;

1039 i‡(
√wÀn
 > 
Æloc
) {

1040 *
¥evious_ns
;

1042 
Æloc
 *= 2;

1043 
¥evious_ns
 = 
ns
;

1044 
ns
 = 
	`osù_ªÆloc
“s, 
Æloc
);

1046 i‡(!
ns
) {

1047 
	`osù_‰ì
(
¥evious_ns
);

1048  
NULL
;

1052 
	`•rötf
(&
ns
[
ödex
], "%%%02X", 
ö
);

1053 
ödex
 += 3;

1057 
ns
[
ödex
++] = 
ö
;

1060 
°rög
++;

1063 
ns
[
ödex
] = 0;

1064  
ns
;

1065 
	}
}

1068 c⁄° *
	gu£röfo_def
 = 
_MARK__USER_UNRESERVED_
;

1069 *
	$__osù_uri_esˇ≥_u£röfo
(c⁄° *
°rög
) {

1070  
	`__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(
°rög
, 
u£röfo_def
);

1071 
	}
}

1074 c⁄° *
	g∑ssw‹d_def
 = 
_MARK__PWORD_UNRESERVED_
;

1075 *
	$__osù_uri_esˇ≥_∑ssw‹d
(c⁄° *
°rög
) {

1076  
	`__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(
°rög
, 
∑ssw‹d_def
);

1077 
	}
}

1079 c⁄° *
	guri_∑øm_def
 = 
_MARK__URI_PARAM_UNRESERVED_
;

1080 *
	$__osù_uri_esˇ≥_uri_∑øm
(*
°rög
) {

1081  
	`__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(
°rög
, 
uri_∑øm_def
);

1082 
	}
}

1084 c⁄° *
	ghódî_∑øm_def
 = 
_MARK__HEADER_PARAM_UNRESERVED_
;

1085 *
	$__osù_uri_esˇ≥_hódî_∑øm
(*
°rög
) {

1086  
	`__osù_uri_esˇ≥_n⁄ascii_™d_n⁄def
(
°rög
, 
hódî_∑øm_def
);

1087 
	}
}

1089 
	$__osù_uri_u√sˇ≥
(*
°rög
) {

1090 
size_t
 
Æloc
 = 
	`°æí
(
°rög
) + 1;

1091 
ö
;

1092 
ödex
 = 0;

1093 
hex
;

1094 *
±r
;

1096 
±r
 = 
°rög
;

1098 --
Æloc
 > 0) {

1099 
ö
 = *
±r
;

1101 i‡('%' =
ö
) {

1103 i‡(
Æloc
 > 2 && 
	`ssˇnf
(
±r
 + 1, "%02X", &
hex
) == 1) {

1104 
ö
 = (Ë
hex
;

1106 i‡(*(
±r
 + 2) && ((*(ptr + 2) >= '0' && *(ptr + 2) <= '9') || (*(ptr + 2) >= 'a' && *(ptr + 2) <= 'f') || (*(ptr + 2) >= 'A' && *(ptr + 2) <= 'F'))) {

1107 
Æloc
 -= 2;

1108 
±r
 += 2;

1111 
Æloc
 -= 1;

1112 
±r
 += 1;

1120 
°rög
[
ödex
++] = 
ö
;

1121 
±r
++;

1124 
°rög
[
ödex
] = 0;

1125 
	}
}

1129 
	$osù_uri_to_°r_ˇn⁄iˇl
(c⁄° 
osù_uri_t
 *
uæ
, **
de°
) {

1130 
ªsu…
;

1132 *
de°
 = 
NULL
;

1133 
ªsu…
 = 
	`osù_uri_to_°r
(
uæ
, 
de°
);

1135 i‡(
ªsu…
 == 0) {

1144 
	`__osù_uri_u√sˇ≥
(*
de°
);

1147  
ªsu…
;

1148 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_via.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

31 
	$osù_mesßge_£t_vü
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

32 
osù_vü_t
 *
vü
;

33 
i
;

35 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

36  
OSIP_SUCCESS
;

38 
i
 = 
	`osù_vü_öô
(&
vü
);

40 i‡(
i
 != 0)

41  
i
;

43 
i
 = 
	`osù_vü_∑r£
(
vü
, 
hvÆue
);

45 i‡(
i
 != 0) {

46 
	`osù_vü_‰ì
(
vü
);

47  
i
;

50 
sù
->
mesßge_¥›îty
 = 2;

51 
	`osù_li°_add
(&
sù
->
vüs
, 
vü
, -1);

52  
OSIP_SUCCESS
;

53 
	}
}

59 
	$osù_mesßge_≠≥nd_vü
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

60 
osù_vü_t
 *
vü
;

61 
i
;

63 
i
 = 
	`osù_vü_öô
(&
vü
);

65 i‡(
i
 != 0)

66  
i
;

68 
i
 = 
	`osù_vü_∑r£
(
vü
, 
hvÆue
);

70 i‡(
i
 != 0) {

71 
	`osù_vü_‰ì
(
vü
);

72  
i
;

75 
sù
->
mesßge_¥›îty
 = 2;

76 
	`osù_li°_add
(&
sù
->
vüs
, 
vü
, 0);

77  
OSIP_SUCCESS
;

78 
	}
}

80 #i‚de‡
MINISIZE


86 
	$osù_mesßge_gë_vü
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_vü_t
 **
de°
) {

87 *
de°
 = 
NULL
;

89 i‡(
sù
 =
NULL
)

90  
OSIP_BADPARAMETER
;

92 i‡(
	`osù_li°_size
(&
sù
->
vüs
Ë<
pos
)

93  
OSIP_UNDEFINED_ERROR
;

95 *
de°
 = (
osù_vü_t
 *Ë
	`osù_li°_gë
(&
sù
->
vüs
, 
pos
);

97  
pos
;

98 
	}
}

101 
	$osù_vü_öô
(
osù_vü_t
 **
vü
) {

102 *
vü
 = (
osù_vü_t
 *Ë
	`osù_mÆloc
((osip_via_t));

104 i‡(*
vü
 =
NULL
)

105  
OSIP_NOMEM
;

107 
	`mem£t
(*
vü
, 0, (
osù_vü_t
));

109 
	`osù_li°_öô
(&(*
vü
)->
vü_∑øms
);

111  
OSIP_SUCCESS
;

112 
	}
}

114 
	$osù_vü_‰ì
(
osù_vü_t
 *
vü
) {

115 i‡(
vü
 =
NULL
)

118 
	`osù_‰ì
(
vü
->
vîsi⁄
);

119 
	`osù_‰ì
(
vü
->
¥Ÿocﬁ
);

120 
	`osù_‰ì
(
vü
->
ho°
);

121 
	`osù_‰ì
(
vü
->
p‹t
);

122 
	`osù_‰ì
(
vü
->
commít
);

123 
	`osù_gíîic_∑øm_‰ìli°
(&
vü
->
vü_∑øms
);

125 
	`osù_‰ì
(
vü
);

126 
	}
}

128 
	$osù_vü_∑r£
(
osù_vü_t
 *
vü
, c⁄° *
hvÆue
) {

129 c⁄° *
vîsi⁄
;

130 c⁄° *
¥Ÿocﬁ
;

131 c⁄° *
ho°
;

132 c⁄° *
ùv6ho°
;

133 c⁄° *
p‹t
;

134 c⁄° *
vü_∑øms
;

135 c⁄° *
commít
;

136 
i
;

138 i‡(
hvÆue
 =
NULL
)

139  
OSIP_BADPARAMETER
;

141 
vîsi⁄
 = 
	`°rchr
(
hvÆue
, '/');

143 i‡(
vîsi⁄
 =
NULL
)

144  
OSIP_SYNTAXERROR
;

146 
¥Ÿocﬁ
 = 
	`°rchr
(
vîsi⁄
 + 1, '/');

148 i‡(
¥Ÿocﬁ
 =
NULL
)

149  
OSIP_SYNTAXERROR
;

152 i‡(
¥Ÿocﬁ
 - 
vîsi⁄
 < 2)

153  
OSIP_SYNTAXERROR
;

155 
vü
->
vîsi⁄
 = (*Ë
	`osù_mÆloc
(
¥Ÿocﬁ
 - version);

157 i‡(
vü
->
vîsi⁄
 =
NULL
)

158  
OSIP_NOMEM
;

160 
	`osù_˛∫˝y
(
vü
->
vîsi⁄
, vîsi⁄ + 1, 
¥Ÿocﬁ
 - version - 1);

163 
ho°
 = 
	`°rchr
(
¥Ÿocﬁ
 + 1, ' ');

165 i‡(
ho°
 =
NULL
)

166  
OSIP_SYNTAXERROR
;

168 i‡(
ho°
 =
¥Ÿocﬁ
 + 1) {

169 0 =
	`°∫cmp
(
ho°
, " ", 1)) {

170 
ho°
++;

172 i‡(
	`°æí
(
ho°
) <= 1)

173  
OSIP_SYNTAXERROR
;

177 
ho°
 = 
	`°rchr
(host + 1, ' ');

179 i‡(
ho°
 =
NULL
)

180  
OSIP_SYNTAXERROR
;

184 i‡(
ho°
 - 
¥Ÿocﬁ
 < 2)

185  
OSIP_SYNTAXERROR
;

187 
vü
->
¥Ÿocﬁ
 = (*Ë
	`osù_mÆloc
(
ho°
 -Örotocol);

189 i‡(
vü
->
¥Ÿocﬁ
 =
NULL
)

190  
OSIP_NOMEM
;

192 
	`osù_˛∫˝y
(
vü
->
¥Ÿocﬁ
,ÖrŸocﬁ + 1, 
ho°
 -Örotocol - 1);

195 
commít
 = 
	`°rchr
(
ho°
, '(');

197 i‡(
commít
 !
NULL
) {

198 *
íd_commít
;

200 
íd_commít
 = 
	`°rchr
(
ho°
, ')');

202 i‡(
íd_commít
 =
NULL
)

203  
OSIP_SYNTAXERROR
;

205 i‡(
íd_commít
 - 
commít
 < 2)

206  
OSIP_SYNTAXERROR
;

208 
vü
->
commít
 = (*Ë
	`osù_mÆloc
(
íd_commít
 - comment);

210 i‡(
vü
->
commít
 =
NULL
)

211  
OSIP_NOMEM
;

213 
	`osù_°∫˝y
(
vü
->
commít
, commíà+ 1, 
íd_commít
 - comment - 1);

214 
commít
--;

217 
commít
 = 
ho°
 + 
	`°æí
(host);

219 
vü_∑øms
 = 
	`°rchr
(
ho°
, ';');

221 i‡((
vü_∑øms
 !
NULL
Ë&& (vü_∑øm†< 
commít
))

224 *
tmp
;

226 i‡(
commít
 - 
vü_∑øms
 + 1 < 2)

227  
OSIP_SYNTAXERROR
;

229 
tmp
 = (*Ë
	`osù_mÆloc
(
commít
 - 
vü_∑øms
 + 1);

231 i‡(
tmp
 =
NULL
)

232  
OSIP_NOMEM
;

234 
	`osù_°∫˝y
(
tmp
, 
vü_∑øms
, 
commít
 - via_params);

235 
i
 = 
	`__osù_gíîic_∑øm_∑r£Æl
(&
vü
->
vü_∑øms
, 
tmp
);

237 i‡(
i
 != 0) {

238 
	`osù_‰ì
(
tmp
);

239  
i
;

242 
	`osù_‰ì
(
tmp
);

245 i‡(
vü_∑øms
 =
NULL
)

246 
vü_∑øms
 = 
commít
;

250 
ùv6ho°
 = 
	`°rchr
(
ho°
, '[');

252 i‡(
ùv6ho°
 !
NULL
 && ipv6ho° < 
vü_∑øms
) {

253 
p‹t
 = 
	`°rchr
(
ùv6ho°
, ']');

255 i‡(
p‹t
 =
NULL
 ||Ö‹à> 
vü_∑øms
)

256  
OSIP_SYNTAXERROR
;

258 i‡(
p‹t
 - 
ùv6ho°
 < 2)

259  
OSIP_SYNTAXERROR
;

261 
vü
->
ho°
 = (*Ë
	`osù_mÆloc
(
p‹t
 - 
ùv6ho°
);

263 i‡(
vü
->
ho°
 =
NULL
)

264  
OSIP_NOMEM
;

266 
	`osù_˛∫˝y
(
vü
->
ho°
, 
ùv6ho°
 + 1, 
p‹t
 - ipv6host - 1);

268 
p‹t
 = 
	`°rchr
(port, ':');

271 
p‹t
 = 
	`°rchr
(
ho°
, ':');

272 
ùv6ho°
 = 
NULL
;

275 i‡((
p‹t
 !
NULL
Ë&& (p‹à< 
vü_∑øms
)) {

276 i‡(
vü_∑øms
 - 
p‹t
 < 2)

277  
OSIP_SYNTAXERROR
;

279 
vü
->
p‹t
 = (*Ë
	`osù_mÆloc
(
vü_∑øms
 -Öort);

281 i‡(
vü
->
p‹t
 =
NULL
)

282  
OSIP_NOMEM
;

284 
	`osù_˛∫˝y
(
vü
->
p‹t
,Ö‹à+ 1, 
vü_∑øms
 -Öort - 1);

286 i‡(
	`osù_©oi
(
vü
->
p‹t
) < 0)

287  
OSIP_SYNTAXERROR
;

290 
p‹t
 = 
vü_∑øms
;

293 i‡(
ùv6ho°
 !
NULL
)

294  
OSIP_SUCCESS
;

296 i‡(
p‹t
 - 
ho°
 < 2)

297  
OSIP_SYNTAXERROR
;

299 
vü
->
ho°
 = (*Ë
	`osù_mÆloc
(
p‹t
 - host);

301 i‡(
vü
->
ho°
 =
NULL
)

302  
OSIP_NOMEM
;

304 
	`osù_˛∫˝y
(
vü
->
ho°
, ho° + 1, 
p‹t
 - host - 1);

306  
OSIP_SUCCESS
;

307 
	}
}

312 
	$osù_vü_to_°r
(c⁄° 
osù_vü_t
 *
vü
, **
de°
) {

313 *
buf
;

314 
size_t
 
Àn
;

315 
size_t
 
∂í
;

316 *
tmp
;

318 *
de°
 = 
NULL
;

320 i‡((
vü
 =
NULL
Ë|| (vü->
ho°
 =NULLË|| (vü->
vîsi⁄
 =NULLË|| (vü->
¥Ÿocﬁ
 == NULL))

321  
OSIP_BADPARAMETER
;

323 
Àn
 = 
	`°æí
(
vü
->
vîsi⁄
Ë+ 1 + såÀn(vü->
¥Ÿocﬁ
) + 1 + 3 + 2;

324 
Àn
 =Üí + 
	`°æí
(
vü
->
ho°
) + 3 + 1;

326 i‡(
vü
->
p‹t
 !
NULL
)

327 
Àn
 =Üí + 
	`°æí
(
vü
->
p‹t
) + 2;

329 
buf
 = (*Ë
	`osù_mÆloc
(
Àn
);

331 i‡(
buf
 =
NULL
)

332  
OSIP_NOMEM
;

334 i‡(
	`°rchr
(
vü
->
ho°
, ':'Ë!
NULL
) {

335 i‡(
vü
->
p‹t
 =
NULL
)

336 
	`•rötf
(
buf
, "SIP/%s/%†[%s]", 
vü
->
vîsi⁄
, vü->
¥Ÿocﬁ
, vü->
ho°
);

339 
	`•rötf
(
buf
, "SIP/%s/%†[%s]:%s", 
vü
->
vîsi⁄
, vü->
¥Ÿocﬁ
, vü->
ho°
, vü->
p‹t
);

342 i‡(
vü
->
p‹t
 =
NULL
)

343 
	`•rötf
(
buf
, "SIP/%s/%†%s", 
vü
->
vîsi⁄
, vü->
¥Ÿocﬁ
, vü->
ho°
);

346 
	`•rötf
(
buf
, "SIP/%s/%†%s:%s", 
vü
->
vîsi⁄
, vü->
¥Ÿocﬁ
, vü->
ho°
, vü->
p‹t
);

350 
osù_li°_ôî©‹_t
 
ô
;

351 
osù_gíîic_∑øm_t
 *
u_∑øm
 = (osù_gíîic_∑øm_à*Ë
	`osù_li°_gë_fú°
(&
vü
->
vü_∑øms
, &
ô
);

353 
u_∑øm
 !
OSIP_SUCCESS
) {

354 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

355 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
) + 2;

358 
∂í
 = 
	`°æí
(
u_∑øm
->
g«me
Ë+ såÀn(u_∑øm->
gvÆue
) + 3;

360 
Àn
 =Üí + 
∂í
;

361 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

362 
tmp
 = 
buf
;

363 
tmp
 =Åm∞+ 
	`°æí
(tmp);

365 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

366 
	`•rötf
(
tmp
, ";%s", 
u_∑øm
->
g«me
);

369 
	`•rötf
(
tmp
, ";%s=%s", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

371 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë_√xt
(&
ô
);

375 i‡(
vü
->
commít
 !
NULL
) {

376 
Àn
 =Üí + 
	`°æí
(
vü
->
commít
) + 4;

377 
buf
 = (*Ë
	`osù_ªÆloc
(buf, 
Àn
);

378 
tmp
 = 
buf
;

379 
tmp
 =Åm∞+ 
	`°æí
(tmp);

380 
	`¢¥ötf
(
tmp
, 
Àn
 - (tm∞- 
buf
), " (%s)", 
vü
->
commít
);

383 *
de°
 = 
buf
;

384  
OSIP_SUCCESS
;

385 
	}
}

387 
	$vü_£t_vîsi⁄
(
osù_vü_t
 *
vü
, *
vîsi⁄
) {

388 
vü
->
vîsi⁄
 = version;

389 
	}
}

391 *
	$vü_gë_vîsi⁄
(
osù_vü_t
 *
vü
) {

392 i‡(
vü
 =
NULL
)

393  
NULL
;

395  
vü
->
vîsi⁄
;

396 
	}
}

398 
	$vü_£t_¥Ÿocﬁ
(
osù_vü_t
 *
vü
, *
¥Ÿocﬁ
) {

399 
vü
->
¥Ÿocﬁ
 =Örotocol;

400 
	}
}

402 *
	$vü_gë_¥Ÿocﬁ
(
osù_vü_t
 *
vü
) {

403 i‡(
vü
 =
NULL
)

404  
NULL
;

406  
vü
->
¥Ÿocﬁ
;

407 
	}
}

409 
	$vü_£t_ho°
(
osù_vü_t
 *
vü
, *
ho°
) {

410 
vü
->
ho°
 = host;

411 
	}
}

413 *
	$vü_gë_ho°
(
osù_vü_t
 *
vü
) {

414 i‡(
vü
 =
NULL
)

415  
NULL
;

417  
vü
->
ho°
;

418 
	}
}

420 
	$vü_£t_p‹t
(
osù_vü_t
 *
vü
, *
p‹t
) {

421 
vü
->
p‹t
 =Öort;

422 
	}
}

424 *
	$vü_gë_p‹t
(
osù_vü_t
 *
vü
) {

425 i‡(
vü
 =
NULL
)

426  
NULL
;

428  
vü
->
p‹t
;

429 
	}
}

431 
	$vü_£t_commít
(
osù_vü_t
 *
vü
, *
commít
) {

432 
vü
->
commít
 = comment;

433 
	}
}

435 *
	$vü_gë_commít
(
osù_vü_t
 *
vü
) {

436 i‡(
vü
 =
NULL
)

437  
NULL
;

439  
vü
->
commít
;

440 
	}
}

442 
	$osù_vü_˛⁄e
(c⁄° 
osù_vü_t
 *
vü
, osù_vü_à**
de°
) {

443 
i
;

444 
osù_vü_t
 *
vi
;

446 *
de°
 = 
NULL
;

448 i‡(
vü
 =
NULL
)

449  
OSIP_BADPARAMETER
;

451 i‡(
vü
->
vîsi⁄
 =
NULL
)

452  
OSIP_BADPARAMETER
;

454 i‡(
vü
->
¥Ÿocﬁ
 =
NULL
)

455  
OSIP_BADPARAMETER
;

457 i‡(
vü
->
ho°
 =
NULL
)

458  
OSIP_BADPARAMETER
;

460 
i
 = 
	`osù_vü_öô
(&
vi
);

462 i‡(
i
 != 0)

463  
i
;

465 
vi
->
vîsi⁄
 = 
	`osù_°rdup
(
vü
->version);

467 i‡(
vi
->
vîsi⁄
 =
NULL
 && 
vü
->version != NULL) {

468 
	`osù_vü_‰ì
(
vi
);

469  
OSIP_NOMEM
;

472 
vi
->
¥Ÿocﬁ
 = 
	`osù_°rdup
(
vü
->protocol);

474 i‡(
vi
->
¥Ÿocﬁ
 =
NULL
 && 
vü
->protocol != NULL) {

475 
	`osù_vü_‰ì
(
vi
);

476  
OSIP_NOMEM
;

479 
vi
->
ho°
 = 
	`osù_°rdup
(
vü
->host);

481 i‡(
vi
->
ho°
 =
NULL
 && 
vü
->host != NULL) {

482 
	`osù_vü_‰ì
(
vi
);

483  
OSIP_NOMEM
;

486 i‡(
vü
->
p‹t
 !
NULL
) {

487 
vi
->
p‹t
 = 
	`osù_°rdup
(
vü
->port);

489 i‡(
vi
->
p‹t
 =
NULL
) {

490 
	`osù_vü_‰ì
(
vi
);

491  
OSIP_NOMEM
;

495 i‡(
vü
->
commít
 !
NULL
) {

496 
vi
->
commít
 = 
	`osù_°rdup
(
vü
->comment);

498 i‡(
vi
->
commít
 =
NULL
) {

499 
	`osù_vü_‰ì
(
vi
);

500  
OSIP_NOMEM
;

504 
i
 = 
	`osù_li°_˛⁄e
(&
vü
->
vü_∑øms
, &
vi
->vü_∑øms, ((*)(*, **)Ë& 
osù_gíîic_∑øm_˛⁄e
);

506 i‡(
i
 != 0) {

507 
	`osù_vü_‰ì
(
vi
);

508  
i
;

511 *
de°
 = 
vi
;

512  
OSIP_SUCCESS
;

513 
	}
}

515 
	$osù_vü_m©ch
(
osù_vü_t
 *
vü1
, osù_vü_à*
vü2
) {

521 *
_vü1
;

522 *
_vü2
;

523 
i
;

525 i‡(
vü1
 =
NULL
 || 
vü2
 == NULL)

526  
OSIP_BADPARAMETER
;

528 
i
 = 
	`osù_vü_to_°r
(
vü1
, &
_vü1
);

530 i‡(
i
 != 0)

531  
i
;

533 
i
 = 
	`osù_vü_to_°r
(
vü2
, &
_vü2
);

535 i‡(
i
 != 0) {

536 
	`osù_‰ì
(
_vü1
);

537  
i
;

540 
i
 = 
	`°rcmp
(
_vü1
, 
_vü2
);

541 
	`osù_‰ì
(
_vü1
);

542 
	`osù_‰ì
(
_vü2
);

544 i‡(
i
 != 0)

545  
OSIP_UNDEFINED_ERROR
;

547  
OSIP_SUCCESS
;

548 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_www_authenticate.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_p‹t.h
>

23 
	~<osù∑r£r2/osù_mesßge.h
>

24 
	~<osù∑r£r2/osù_∑r£r.h
>

25 
	~"∑r£r.h
"

27 
	$osù_www_authítiˇã_öô
(
osù_www_authítiˇã_t
 **
de°
) {

28 *
de°
 = (
osù_www_authítiˇã_t
 *Ë
	`osù_mÆloc
((osip_www_authenticate_t));

30 i‡(*
de°
 =
NULL
)

31  
OSIP_NOMEM
;

33 
	`mem£t
(*
de°
, 0, (
osù_www_authítiˇã_t
));

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$osù_mesßge_£t_www_authítiˇã
(
osù_mesßge_t
 *
sù
, c⁄° *
hvÆue
) {

42 
osù_www_authítiˇã_t
 *
www_authítiˇã
;

43 
i
;

45 i‡(
hvÆue
 =
NULL
 || hvalue[0] == '\0')

46  
OSIP_SUCCESS
;

48 i‡(
sù
 =
NULL
)

49  
OSIP_BADPARAMETER
;

51 
i
 = 
	`osù_www_authítiˇã_öô
(&
www_authítiˇã
);

53 i‡(
i
 != 0)

54  
i
;

56 
i
 = 
	`osù_www_authítiˇã_∑r£
(
www_authítiˇã
, 
hvÆue
);

58 i‡(
i
 != 0) {

59 
	`osù_www_authítiˇã_‰ì
(
www_authítiˇã
);

60  
i
;

63 
sù
->
mesßge_¥›îty
 = 2;

64 
	`osù_li°_add
(&
sù
->
www_authítiˇãs
, 
www_authítiˇã
, -1);

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$__osù_quŸed_°rög_£t
(c⁄° *
«me
, c⁄° *
°r
, **
ªsu…
, c⁄° **
√xt
) {

69 *
√xt
 = 
°r
;

71 i‡(*
ªsu…
 !
NULL
)

72  
OSIP_SUCCESS
;

74 *
√xt
 = 
NULL
;

76 (' ' =*
°r
) || ('\t' == *str) || (',' == *str))

77 i‡(*
°r
)

78 
°r
++;

81  
OSIP_SYNTAXERROR
;

83 i‡(
	`osù_°∫ˇ£cmp
(
«me
, 
°r
, 
	`°æí
(name)) == 0) {

84 c⁄° *
quŸe1
;

85 c⁄° *
quŸe2
;

86 c⁄° *
tmp
;

87 c⁄° *
hack
 = 
	`°rchr
(
°r
, '=');

89 i‡(
hack
 =
NULL
)

90  
OSIP_SYNTAXERROR
;

92 ' ' =*(
hack
 - 1))

93 
hack
--;

95 i‡((
size_t
)(
hack
 - 
°r
Ë!
	`°æí
(
«me
)) {

96 *
√xt
 = 
°r
;

97  
OSIP_SUCCESS
;

100 
quŸe1
 = 
	`__osù_quŸe_föd
(
°r
);

102 i‡(
quŸe1
 =
NULL
)

103  
OSIP_SYNTAXERROR
;

105 
quŸe2
 = 
	`__osù_quŸe_föd
(
quŸe1
 + 1);

107 i‡(
quŸe2
 =
NULL
)

108  
OSIP_SYNTAXERROR
;

110 i‡(
quŸe2
 - 
quŸe1
 == 1) {

116 
tmp
 = 
quŸe2
 + 1;

117 
tmp
 +
	`°r•n
(tmp, " \t");

118 
tmp
 +
	`°r•n
(tmp, "\n\r");

119 *
√xt
 = 
NULL
;

121 i‡(*
tmp
 == '\0')

122  
OSIP_SUCCESS
;

124 i‡(*
tmp
 != '\t' && *tmp != ' ')

126 *
√xt
 = 
tmp
;

129 
tmp
 +
	`°r•n
(tmp, " \t");

131 i‡(*
tmp
 == '\0')

132  
OSIP_SUCCESS
;

134 *
√xt
 = 
tmp
;

137  
OSIP_SUCCESS
;

140 *
ªsu…
 = (*Ë
	`osù_mÆloc
(
quŸe2
 - 
quŸe1
 + 3);

142 i‡(*
ªsu…
 =
NULL
)

143  
OSIP_NOMEM
;

145 
	`osù_°∫˝y
(*
ªsu…
, 
quŸe1
, 
quŸe2
 - quote1 + 1);

146 
tmp
 = 
quŸe2
 + 1;

147 
tmp
 +
	`°r•n
(tmp, " \t");

148 
tmp
 +
	`°r•n
(tmp, "\n\r");

149 *
√xt
 = 
NULL
;

151 i‡(*
tmp
 == '\0')

152  
OSIP_SUCCESS
;

154 i‡(*
tmp
 != '\t' && *tmp != ' ')

156 *
√xt
 = 
tmp
;

159 
tmp
 +
	`°r•n
(tmp, " \t");

161 i‡(*
tmp
 == '\0')

162  
OSIP_SUCCESS
;

164 *
√xt
 = 
tmp
;

168 *
√xt
 = 
°r
;

170  
OSIP_SUCCESS
;

171 
	}
}

173 
	$__osù_tokí_£t
(c⁄° *
«me
, c⁄° *
°r
, **
ªsu…
, c⁄° **
√xt
) {

174 c⁄° *
beg
;

175 c⁄° *
tmp
;

177 *
√xt
 = 
°r
;

179 i‡(*
ªsu…
 !
NULL
)

180  
OSIP_SUCCESS
;

182 *
√xt
 = 
NULL
;

184 
beg
 = 
	`°rchr
(
°r
, '=');

186 i‡(
beg
 =
NULL
)

187  
OSIP_SYNTAXERROR
;

189 i‡(
	`°æí
(
°r
) < 6)

190  
OSIP_SUCCESS
;

192 (' ' =*
°r
) || ('\t' == *str) || (',' == *str))

193 i‡(*
°r
)

194 
°r
++;

197  
OSIP_SYNTAXERROR
;

199 i‡(
	`osù_°∫ˇ£cmp
(
«me
, 
°r
, 
	`°æí
(name)) == 0) {

200 c⁄° *
íd
;

202 
íd
 = 
	`°rchr
(
°r
, ',');

204 i‡(
íd
 =
NULL
)

205 
íd
 = 
°r
 + 
	`°æí
(str);

207 i‡(
íd
 - 
beg
 < 2)

208  
OSIP_SYNTAXERROR
;

210 *
ªsu…
 = (*Ë
	`osù_mÆloc
(
íd
 - 
beg
);

212 i‡(*
ªsu…
 =
NULL
)

213  
OSIP_NOMEM
;

215 
	`osù_˛∫˝y
(*
ªsu…
, 
beg
 + 1, 
íd
 - beg - 1);

218 
tmp
 = (*
íd
) ? (end + 1) :Énd;

219 
tmp
 +
	`°r•n
(tmp, " \t");

220 
tmp
 +
	`°r•n
(tmp, "\n\r");

221 *
√xt
 = 
NULL
;

223 i‡(*
tmp
 == '\0')

224  
OSIP_SUCCESS
;

226 i‡(*
tmp
 != '\t' && *tmp != ' ')

228 *
√xt
 = 
tmp
;

231 
tmp
 +
	`°r•n
(tmp, " \t");

233 i‡(*
tmp
 == '\0')

234  
OSIP_SUCCESS
;

236 *
√xt
 = 
tmp
;

240 *
√xt
 = 
°r
;

242  
OSIP_SUCCESS
;

243 
	}
}

253 
	$osù_www_authítiˇã_∑r£
(
osù_www_authítiˇã_t
 *
wwwa
, c⁄° *
hvÆue
) {

254 c⁄° *
•a˚
;

255 c⁄° *
√xt
 = 
NULL
;

256 
i
;

258 
•a˚
 = 
	`°rchr
(
hvÆue
, ' ');

260 i‡(
•a˚
 =
NULL
)

261  
OSIP_SYNTAXERROR
;

263 i‡(
•a˚
 - 
hvÆue
 + 1 < 2)

264  
OSIP_SYNTAXERROR
;

266 
wwwa
->
auth_ty≥
 = (*Ë
	`osù_mÆloc
(
•a˚
 - 
hvÆue
 + 1);

268 i‡(
wwwa
->
auth_ty≥
 =
NULL
)

269  
OSIP_NOMEM
;

271 
	`osù_°∫˝y
(
wwwa
->
auth_ty≥
, 
hvÆue
, 
•a˚
 - hvalue);

274 
∑r£_ok
 = 0;

276 
i
 = 
	`__osù_quŸed_°rög_£t
("ªÆm", 
•a˚
, &(
wwwa
->
ªÆm
), &
√xt
);

278 i‡(
i
 != 0)

279  
i
;

281 i‡(
√xt
 =
NULL
)

282  
OSIP_SUCCESS
;

283 i‡(
√xt
 !
•a˚
) {

284 
•a˚
 = 
√xt
;

285 
∑r£_ok
++;

288 
i
 = 
	`__osù_quŸed_°rög_£t
("domaö", 
•a˚
, &(
wwwa
->
domaö
), &
√xt
);

290 i‡(
i
 != 0)

291  
i
;

293 i‡(
√xt
 =
NULL
)

294  
OSIP_SUCCESS
;

295 i‡(
√xt
 !
•a˚
) {

296 
•a˚
 = 
√xt
;

297 
∑r£_ok
++;

300 
i
 = 
	`__osù_quŸed_°rög_£t
("n⁄˚", 
•a˚
, &(
wwwa
->
n⁄˚
), &
√xt
);

302 i‡(
i
 != 0)

303  
i
;

305 i‡(
√xt
 =
NULL
)

306  
OSIP_SUCCESS
;

307 i‡(
√xt
 !
•a˚
) {

308 
•a˚
 = 
√xt
;

309 
∑r£_ok
++;

312 
i
 = 
	`__osù_quŸed_°rög_£t
("›aque", 
•a˚
, &(
wwwa
->
›aque
), &
√xt
);

314 i‡(
i
 != 0)

315  
i
;

317 i‡(
√xt
 =
NULL
)

318  
OSIP_SUCCESS
;

319 i‡(
√xt
 !
•a˚
) {

320 
•a˚
 = 
√xt
;

321 
∑r£_ok
++;

324 
i
 = 
	`__osù_tokí_£t
("°Æe", 
•a˚
, &(
wwwa
->
°Æe
), &
√xt
);

326 i‡(
i
 != 0)

327  
i
;

329 i‡(
√xt
 =
NULL
)

330  
OSIP_SUCCESS
;

331 i‡(
√xt
 !
•a˚
) {

332 
•a˚
 = 
√xt
;

333 
∑r£_ok
++;

336 
i
 = 
	`__osù_tokí_£t
("Æg‹ôhm", 
•a˚
, &(
wwwa
->
Æg‹ôhm
), &
√xt
);

338 i‡(
i
 != 0)

339  
i
;

341 i‡(
√xt
 =
NULL
)

342  
OSIP_SUCCESS
;

343 i‡(
√xt
 !
•a˚
) {

344 
•a˚
 = 
√xt
;

345 
∑r£_ok
++;

348 
i
 = 
	`__osù_quŸed_°rög_£t
("q›", 
•a˚
, &(
wwwa
->
q›_›ti⁄s
), &
√xt
);

350 i‡(
i
 != 0)

351  
i
;

353 i‡(
√xt
 =
NULL
)

354  
OSIP_SUCCESS
;

355 i‡(
√xt
 !
•a˚
) {

356 
•a˚
 = 
√xt
;

357 
∑r£_ok
++;

360 
i
 = 
	`__osù_tokí_£t
("vîsi⁄", 
•a˚
, &(
wwwa
->
vîsi⁄
), &
√xt
);

362 i‡(
i
 != 0)

363  
i
;

365 i‡(
√xt
 =
NULL
)

366  
OSIP_SUCCESS
;

367 i‡(
√xt
 !
•a˚
) {

368 
•a˚
 = 
√xt
;

369 
∑r£_ok
++;

372 
i
 = 
	`__osù_quŸed_°rög_£t
("èrgë«me", 
•a˚
, &(
wwwa
->
èrgë«me
), &
√xt
);

374 i‡(
i
 != 0)

375  
i
;

377 i‡(
√xt
 =
NULL
)

378  
OSIP_SUCCESS
;

379 i‡(
√xt
 !
•a˚
) {

380 
•a˚
 = 
√xt
;

381 
∑r£_ok
++;

384 
i
 = 
	`__osù_quŸed_°rög_£t
("gsßpi-d©a", 
•a˚
, &(
wwwa
->
gsßpi_d©a
), &
√xt
);

386 i‡(
i
 != 0)

387  
i
;

389 i‡(
√xt
 =
NULL
)

390  
OSIP_SUCCESS
;

391 i‡(
√xt
 !
•a˚
) {

392 
•a˚
 = 
√xt
;

393 
∑r£_ok
++;

396 i‡(0 =
∑r£_ok
) {

397 c⁄° *
quŸe1
, *
quŸe2
, *
tmp
;

402 i‡(
	`°æí
(
•a˚
) < 1)

403  
OSIP_SUCCESS
;

405 
tmp
 = 
	`°rchr
(
•a˚
 + 1, ',');

407 i‡(
tmp
 =
NULL
)

408  
OSIP_SUCCESS
;

410 
quŸe1
 = 
	`__osù_quŸe_föd
(
•a˚
);

412 i‡((
quŸe1
 !
NULL
Ë&& (quŸe1 < 
tmp
)) {

413 
quŸe2
 = 
	`__osù_quŸe_föd
(
quŸe1
 + 1);

415 i‡(
quŸe2
 =
NULL
)

416  
OSIP_SYNTAXERROR
;

418 i‡(
tmp
 < 
quŸe2
)

419 
•a˚
 = 
	`°rchr
(
quŸe2
, ',');

422 
•a˚
 = 
tmp
;

424 i‡(
•a˚
 =
NULL
)

425  
OSIP_SUCCESS
;

428 
•a˚
 = 
tmp
;

434  
OSIP_SUCCESS
;

435 
	}
}

437 #i‚de‡
MINISIZE


441 
	$osù_mesßge_gë_www_authítiˇã
(c⁄° 
osù_mesßge_t
 *
sù
, 
pos
, 
osù_www_authítiˇã_t
 **
de°
) {

442 
osù_www_authítiˇã_t
 *
www_authítiˇã
;

444 *
de°
 = 
NULL
;

446 i‡(
	`osù_li°_size
(&
sù
->
www_authítiˇãs
Ë<
pos
)

447  
OSIP_UNDEFINED_ERROR
;

449 
www_authítiˇã
 = (
osù_www_authítiˇã_t
 *Ë
	`osù_li°_gë
(&
sù
->
www_authítiˇãs
, 
pos
);

451 *
de°
 = 
www_authítiˇã
;

452  
pos
;

453 
	}
}

456 *
	$osù_www_authítiˇã_gë_auth_ty≥
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

457  
www_authítiˇã
->
auth_ty≥
;

458 
	}
}

460 
	$osù_www_authítiˇã_£t_auth_ty≥
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
auth_ty≥
) {

461 
www_authítiˇã
->
auth_ty≥
 = (*)áuth_type;

462 
	}
}

464 *
	$osù_www_authítiˇã_gë_ªÆm
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

465  
www_authítiˇã
->
ªÆm
;

466 
	}
}

468 
	$osù_www_authítiˇã_£t_ªÆm
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
ªÆm
) {

469 
www_authítiˇã
->
ªÆm
 = (*)Ñealm;

470 
	}
}

472 *
	$osù_www_authítiˇã_gë_domaö
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

473  
www_authítiˇã
->
domaö
;

474 
	}
}

476 
	$osù_www_authítiˇã_£t_domaö
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
domaö
) {

477 
www_authítiˇã
->
domaö
 = (*) domain;

478 
	}
}

480 *
	$osù_www_authítiˇã_gë_n⁄˚
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

481  
www_authítiˇã
->
n⁄˚
;

482 
	}
}

484 
	$osù_www_authítiˇã_£t_n⁄˚
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
n⁄˚
) {

485 
www_authítiˇã
->
n⁄˚
 = (*)Çonce;

486 
	}
}

488 *
	$osù_www_authítiˇã_gë_°Æe
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

489  
www_authítiˇã
->
°Æe
;

490 
	}
}

492 
	$osù_www_authítiˇã_£t_°Æe
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
°Æe
) {

493 
www_authítiˇã
->
°Æe
 = (*) stale;

494 
	}
}

496 *
	$osù_www_authítiˇã_gë_›aque
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

497  
www_authítiˇã
->
›aque
;

498 
	}
}

500 
	$osù_www_authítiˇã_£t_›aque
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
›aque
) {

501 
www_authítiˇã
->
›aque
 = (*) opaque;

502 
	}
}

504 *
	$osù_www_authítiˇã_gë_Æg‹ôhm
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

505  
www_authítiˇã
->
Æg‹ôhm
;

506 
	}
}

508 
	$osù_www_authítiˇã_£t_Æg‹ôhm
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
Æg‹ôhm
) {

509 
www_authítiˇã
->
Æg‹ôhm
 = (*)álgorithm;

510 
	}
}

512 *
	$osù_www_authítiˇã_gë_q›_›ti⁄s
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

513  
www_authítiˇã
->
q›_›ti⁄s
;

514 
	}
}

516 
	$osù_www_authítiˇã_£t_q›_›ti⁄s
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
q›_›ti⁄s
) {

517 
www_authítiˇã
->
q›_›ti⁄s
 = (*) qop_options;

518 
	}
}

520 *
	$osù_www_authítiˇã_gë_vîsi⁄
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

521  
www_authítiˇã
->
vîsi⁄
;

522 
	}
}

524 
	$osù_www_authítiˇã_£t_vîsi⁄
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
vîsi⁄
) {

525 
www_authítiˇã
->
vîsi⁄
 = (*) version;

526 
	}
}

528 *
	$osù_www_authítiˇã_gë_èrgë«me
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

529  
www_authítiˇã
->
èrgë«me
;

530 
	}
}

532 
	$osù_www_authítiˇã_£t_èrgë«me
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
èrgë«me
) {

533 
www_authítiˇã
->
èrgë«me
 = (*)Åargetname;

534 
	}
}

536 *
	$osù_www_authítiˇã_gë_gsßpi_d©a
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

537  
www_authítiˇã
->
gsßpi_d©a
;

538 
	}
}

540 
	$osù_www_authítiˇã_£t_gsßpi_d©a
(
osù_www_authítiˇã_t
 *
www_authítiˇã
, *
gsßpi_d©a
) {

541 
www_authítiˇã
->
gsßpi_d©a
 = (*) gssapi_data;

542 
	}
}

547 
	$osù_www_authítiˇã_to_°r
(c⁄° 
osù_www_authítiˇã_t
 *
wwwa
, **
de°
) {

548 
size_t
 
Àn
;

549 *
tmp
;

551 *
de°
 = 
NULL
;

553 i‡((
wwwa
 =
NULL
Ë|| (wwwa->
auth_ty≥
 == NULL))

554  
OSIP_BADPARAMETER
;

556 
Àn
 = 
	`°æí
(
wwwa
->
auth_ty≥
) + 1;

558 i‡(
wwwa
->
ªÆm
 !
NULL
)

559 
Àn
 =Üí + 
	`°æí
(
wwwa
->
ªÆm
) + 7;

561 i‡(
wwwa
->
n⁄˚
 !
NULL
)

562 
Àn
 =Üí + 
	`°æí
(
wwwa
->
n⁄˚
) + 8;

564 
Àn
 =Üen + 2;

566 i‡(
wwwa
->
domaö
 !
NULL
)

567 
Àn
 =Üí + 
	`°æí
(
wwwa
->
domaö
) + 9;

569 i‡(
wwwa
->
›aque
 !
NULL
)

570 
Àn
 =Üí + 
	`°æí
(
wwwa
->
›aque
) + 9;

572 i‡(
wwwa
->
°Æe
 !
NULL
)

573 
Àn
 =Üí + 
	`°æí
(
wwwa
->
°Æe
) + 8;

575 i‡(
wwwa
->
Æg‹ôhm
 !
NULL
)

576 
Àn
 =Üí + 
	`°æí
(
wwwa
->
Æg‹ôhm
) + 12;

578 i‡(
wwwa
->
q›_›ti⁄s
 !
NULL
)

579 
Àn
 =Üí + 
	`°æí
(
wwwa
->
q›_›ti⁄s
) + 6;

581 i‡(
wwwa
->
vîsi⁄
 !
NULL
)

582 
Àn
 =Üí + 
	`°æí
(
wwwa
->
vîsi⁄
) + 10;

584 i‡(
wwwa
->
èrgë«me
 !
NULL
)

585 
Àn
 =Üí + 
	`°æí
(
wwwa
->
èrgë«me
) + 13;

587 i‡(
wwwa
->
gsßpi_d©a
 !
NULL
)

588 
Àn
 =Üí + 
	`°æí
(
wwwa
->
gsßpi_d©a
) + 14;

590 
tmp
 = (*Ë
	`osù_mÆloc
(
Àn
);

592 i‡(
tmp
 =
NULL
)

593  
OSIP_NOMEM
;

595 *
de°
 = 
tmp
;

597 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
auth_ty≥
);

599 i‡(
wwwa
->
ªÆm
 !
NULL
) {

600 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, "Ñealm=", 7);

601 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
ªÆm
);

604 i‡(
wwwa
->
domaö
 !
NULL
) {

605 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", domain=", 9);

606 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
domaö
);

609 i‡(
wwwa
->
n⁄˚
 !
NULL
) {

610 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",Çonce=", 8);

611 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
n⁄˚
);

614 i‡(
wwwa
->
›aque
 !
NULL
) {

615 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", opaque=", 9);

616 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
›aque
);

619 i‡(
wwwa
->
°Æe
 !
NULL
) {

620 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", stale=", 8);

621 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
°Æe
);

624 i‡(
wwwa
->
Æg‹ôhm
 !
NULL
) {

625 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",álgorithm=", 12);

626 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
Æg‹ôhm
);

629 i‡(
wwwa
->
q›_›ti⁄s
 !
NULL
) {

630 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", qop=", 6);

631 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
q›_›ti⁄s
);

634 i‡(
wwwa
->
vîsi⁄
 !
NULL
) {

635 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", version=", 10);

636 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
vîsi⁄
);

639 i‡(
wwwa
->
èrgë«me
 !
NULL
) {

640 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ",Åargetname=", 13);

641 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
èrgë«me
);

644 i‡(
wwwa
->
gsßpi_d©a
 !
NULL
) {

645 
tmp
 = 
	`osù_°∫_≠≥nd
(tmp, ", gssapi-data=", 14);

646 
tmp
 = 
	`osù_°r_≠≥nd
—mp, 
wwwa
->
gsßpi_d©a
);

649 i‡(
wwwa
->
ªÆm
 =
NULL
) {

651 
Àn
 = 
	`°æí
(
wwwa
->
auth_ty≥
);

653 i‡((*
de°
)[
Àn
] == ',')

654 (*
de°
)[
Àn
] = ' ';

657  
OSIP_SUCCESS
;

658 
	}
}

662 
	$osù_www_authítiˇã_‰ì
(
osù_www_authítiˇã_t
 *
www_authítiˇã
) {

663 i‡(
www_authítiˇã
 =
NULL
)

666 
	`osù_‰ì
(
www_authítiˇã
->
auth_ty≥
);

667 
	`osù_‰ì
(
www_authítiˇã
->
ªÆm
);

668 
	`osù_‰ì
(
www_authítiˇã
->
domaö
);

669 
	`osù_‰ì
(
www_authítiˇã
->
n⁄˚
);

670 
	`osù_‰ì
(
www_authítiˇã
->
›aque
);

671 
	`osù_‰ì
(
www_authítiˇã
->
°Æe
);

672 
	`osù_‰ì
(
www_authítiˇã
->
Æg‹ôhm
);

673 
	`osù_‰ì
(
www_authítiˇã
->
q›_›ti⁄s
);

674 
	`osù_‰ì
(
www_authítiˇã
->
vîsi⁄
);

675 
	`osù_‰ì
(
www_authítiˇã
->
èrgë«me
);

676 
	`osù_‰ì
(
www_authítiˇã
->
gsßpi_d©a
);

678 
	`osù_‰ì
(
www_authítiˇã
);

679 
	}
}

681 
	$osù_www_authítiˇã_˛⁄e
(c⁄° 
osù_www_authítiˇã_t
 *
wwwa
, osù_www_authítiˇã_à**
de°
) {

682 
i
;

683 
osù_www_authítiˇã_t
 *
wa
;

685 *
de°
 = 
NULL
;

687 i‡(
wwwa
 =
NULL
)

688  
OSIP_BADPARAMETER
;

690 i‡(
wwwa
->
auth_ty≥
 =
NULL
)

691  
OSIP_BADPARAMETER
;

693 
i
 = 
	`osù_www_authítiˇã_öô
(&
wa
);

695 i‡(
i
 != 0)

696  
i
;

698 
wa
->
auth_ty≥
 = 
	`osù_°rdup
(
wwwa
->auth_type);

700 i‡(
wa
->
auth_ty≥
 =
NULL
 && 
wwwa
->auth_type != NULL) {

701 
	`osù_www_authítiˇã_‰ì
(
wa
);

702  
OSIP_NOMEM
;

705 i‡(
wwwa
->
ªÆm
 !
NULL
)

706 
wa
->
ªÆm
 = 
	`osù_°rdup
(
wwwa
->realm);

708 i‡(
wa
->
ªÆm
 =
NULL
 && 
wwwa
->realm != NULL) {

709 
	`osù_www_authítiˇã_‰ì
(
wa
);

710  
OSIP_NOMEM
;

713 i‡(
wwwa
->
domaö
 !
NULL
)

714 
wa
->
domaö
 = 
	`osù_°rdup
(
wwwa
->domain);

716 i‡(
wa
->
domaö
 =
NULL
 && 
wwwa
->domain != NULL) {

717 
	`osù_www_authítiˇã_‰ì
(
wa
);

718  
OSIP_NOMEM
;

721 i‡(
wwwa
->
n⁄˚
 !
NULL
)

722 
wa
->
n⁄˚
 = 
	`osù_°rdup
(
wwwa
->nonce);

724 i‡(
wa
->
n⁄˚
 =
NULL
 && 
wwwa
->nonce != NULL) {

725 
	`osù_www_authítiˇã_‰ì
(
wa
);

726  
OSIP_NOMEM
;

729 i‡(
wwwa
->
›aque
 !
NULL
)

730 
wa
->
›aque
 = 
	`osù_°rdup
(
wwwa
->opaque);

732 i‡(
wa
->
›aque
 =
NULL
 && 
wwwa
->opaque != NULL) {

733 
	`osù_www_authítiˇã_‰ì
(
wa
);

734  
OSIP_NOMEM
;

737 i‡(
wwwa
->
°Æe
 !
NULL
)

738 
wa
->
°Æe
 = 
	`osù_°rdup
(
wwwa
->stale);

740 i‡(
wa
->
°Æe
 =
NULL
 && 
wwwa
->stale != NULL) {

741 
	`osù_www_authítiˇã_‰ì
(
wa
);

742  
OSIP_NOMEM
;

745 i‡(
wwwa
->
Æg‹ôhm
 !
NULL
)

746 
wa
->
Æg‹ôhm
 = 
	`osù_°rdup
(
wwwa
->algorithm);

748 i‡(
wa
->
Æg‹ôhm
 =
NULL
 && 
wwwa
->algorithm != NULL) {

749 
	`osù_www_authítiˇã_‰ì
(
wa
);

750  
OSIP_NOMEM
;

753 i‡(
wwwa
->
q›_›ti⁄s
 !
NULL
)

754 
wa
->
q›_›ti⁄s
 = 
	`osù_°rdup
(
wwwa
->qop_options);

756 i‡(
wa
->
q›_›ti⁄s
 =
NULL
 && 
wwwa
->qop_options != NULL) {

757 
	`osù_www_authítiˇã_‰ì
(
wa
);

758  
OSIP_NOMEM
;

761 i‡(
wwwa
->
vîsi⁄
 !
NULL
)

762 
wa
->
vîsi⁄
 = 
	`osù_°rdup
(
wwwa
->version);

764 i‡(
wa
->
vîsi⁄
 =
NULL
 && 
wwwa
->version != NULL) {

765 
	`osù_www_authítiˇã_‰ì
(
wa
);

766  
OSIP_NOMEM
;

769 i‡(
wwwa
->
èrgë«me
 !
NULL
)

770 
wa
->
èrgë«me
 = 
	`osù_°rdup
(
wwwa
->targetname);

772 i‡(
wa
->
èrgë«me
 =
NULL
 && 
wwwa
->targetname != NULL) {

773 
	`osù_www_authítiˇã_‰ì
(
wa
);

774  
OSIP_NOMEM
;

777 i‡(
wwwa
->
gsßpi_d©a
 !
NULL
)

778 
wa
->
gsßpi_d©a
 = 
	`osù_°rdup
(
wwwa
->gssapi_data);

780 i‡(
wa
->
gsßpi_d©a
 =
NULL
 && 
wwwa
->gssapi_data != NULL) {

781 
	`osù_www_authítiˇã_‰ì
(
wa
);

782  
OSIP_NOMEM
;

785 *
de°
 = 
wa
;

786  
OSIP_SUCCESS
;

787 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/parser.h

20 #i‚de‡
_MSG_H_


21 
	#_MSG_H_


	)

23 #i‚de‡
DOXYGEN


25 #i‚de‡
MINISIZE


26 
	#NUMBER_OF_HEADERS
 33

	)

28 
	#NUMBER_OF_HEADERS
 22

	)

31 #i‚de‡
NUMBER_OF_HEADERS_COMMASEPARATED


32 
	#NUMBER_OF_HEADERS_COMMASEPARATED
 256

	)

36 
	s___osù_mesßge_c⁄fig_t
 {

37 *
	mh«me
;

38 (*
	m£thódî
)(
	mosù_mesßge_t
 *, const *);

39 
	mign‹ed_whí_övÆid
;

40 } 
	t__osù_mesßge_c⁄fig_t
;

42 
	s___osù_mesßge_c⁄fig_comma£∑øãd_t
 {

43 
	mh«me
[256];

44 } 
	t__osù_mesßge_c⁄fig_comma£∑øãd_t
;

46 
__osù_mesßge_ˇŒ_mëhod
(
i
, 
osù_mesßge_t
 *
de°
, c⁄° *
hvÆue
);

47 
__osù_mesßge_is_hódî_comma_£∑øãd
(c⁄° *
h«me
);

48 
__osù_mesßge_is_known_hódî
(c⁄° *
h«me
);

50 
__osù_föd_√xt_occuªn˚
(c⁄° *
°r
, c⁄° *
buf
, c⁄° **
ödex_of_°r
, c⁄° *
íd_of_buf
);

51 
__osù_föd_√xt_¸lf
(c⁄° *
°¨t_of_hódî
, c⁄° **
íd_of_hódî
);

52 
__osù_föd_√xt_¸lf¸lf
(c⁄° *
°¨t_of_∑π
, c⁄° **
íd_of_∑π
);

54 
__osù_quŸed_°rög_£t
(c⁄° *
«me
, c⁄° *
°r
, **
ªsu…
, c⁄° **
√xt
);

55 
__osù_tokí_£t
(c⁄° *
«me
, c⁄° *
°r
, **
ªsu…
, c⁄° **
√xt
);

57 
__osù_gíîic_∑øm_∑r£Æl
(
osù_li°_t
 *
gí_∑øms
, c⁄° *
∑øms
);

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_accessor.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_c⁄°.h
>

23 
	~<osù∑r£r2/osù_p‹t.h
>

24 
	~<osù∑r£r2/sdp_mesßge.h
>

26 
	$sdp_mesßge_v_vîsi⁄_£t
(
sdp_mesßge_t
 *
sdp
, *
v_vîsi⁄
) {

27 i‡(
sdp
 =
NULL
)

28  
OSIP_BADPARAMETER
;

30 
sdp
->
v_vîsi⁄
 = v_version;

31  
OSIP_SUCCESS
;

32 
	}
}

34 *
	$sdp_mesßge_v_vîsi⁄_gë
(
sdp_mesßge_t
 *
sdp
) {

35 i‡(
sdp
 =
NULL
)

36  
NULL
;

38  
sdp
->
v_vîsi⁄
;

39 
	}
}

41 
	$sdp_mesßge_o_‹igö_£t
(
sdp_mesßge_t
 *
sdp
, *
u£∫ame
, *
£ss_id
, *
£ss_vîsi⁄
, *
√ây≥
, *
addπy≥
, *
addr
) {

42 i‡(
sdp
 =
NULL
)

43  
OSIP_BADPARAMETER
;

45 
sdp
->
o_u£∫ame
 = 
u£∫ame
;

46 
sdp
->
o_£ss_id
 = 
£ss_id
;

47 
sdp
->
o_£ss_vîsi⁄
 = 
£ss_vîsi⁄
;

48 
sdp
->
o_√ây≥
 = 
√ây≥
;

49 
sdp
->
o_addπy≥
 = 
addπy≥
;

50 
sdp
->
o_addr
 = 
addr
;

51  
OSIP_SUCCESS
;

52 
	}
}

54 *
	$sdp_mesßge_o_u£∫ame_gë
(
sdp_mesßge_t
 *
sdp
) {

55 i‡(
sdp
 =
NULL
)

56  
NULL
;

58  
sdp
->
o_u£∫ame
;

59 
	}
}

61 *
	$sdp_mesßge_o_£ss_id_gë
(
sdp_mesßge_t
 *
sdp
) {

62 i‡(
sdp
 =
NULL
)

63  
NULL
;

65  
sdp
->
o_£ss_id
;

66 
	}
}

68 *
	$sdp_mesßge_o_£ss_vîsi⁄_gë
(
sdp_mesßge_t
 *
sdp
) {

69 i‡(
sdp
 =
NULL
)

70  
NULL
;

72  
sdp
->
o_£ss_vîsi⁄
;

73 
	}
}

75 *
	$sdp_mesßge_o_√ây≥_gë
(
sdp_mesßge_t
 *
sdp
) {

76 i‡(
sdp
 =
NULL
)

77  
NULL
;

79  
sdp
->
o_√ây≥
;

80 
	}
}

82 *
	$sdp_mesßge_o_addπy≥_gë
(
sdp_mesßge_t
 *
sdp
) {

83 i‡(
sdp
 =
NULL
)

84  
NULL
;

86  
sdp
->
o_addπy≥
;

87 
	}
}

89 *
	$sdp_mesßge_o_addr_gë
(
sdp_mesßge_t
 *
sdp
) {

90 i‡(
sdp
 =
NULL
)

91  
NULL
;

93  
sdp
->
o_addr
;

94 
	}
}

96 
	$sdp_mesßge_s_«me_£t
(
sdp_mesßge_t
 *
sdp
, *
«me
) {

97 i‡(
sdp
 =
NULL
)

100 
sdp
->
s_«me
 = 
«me
;

101  
OSIP_SUCCESS
;

102 
	}
}

104 *
	$sdp_mesßge_s_«me_gë
(
sdp_mesßge_t
 *
sdp
) {

105 i‡(
sdp
 =
NULL
)

106  
NULL
;

108  
sdp
->
s_«me
;

109 
	}
}

111 
	$sdp_mesßge_i_öfo_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
öfo
) {

112 
sdp_medü_t
 *
med
;

114 i‡(
sdp
 =
NULL
)

115  
OSIP_BADPARAMETER
;

117 i‡(
pos_medü
 == -1) {

118 
sdp
->
i_öfo
 = 
öfo
;

119  
OSIP_SUCCESS
;

122 
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

124 i‡(
med
 =
NULL
)

125  
OSIP_UNDEFINED_ERROR
;

127 
med
->
i_öfo
 = 
öfo
;

128  
OSIP_SUCCESS
;

129 
	}
}

131 *
	$sdp_mesßge_i_öfo_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

132 
sdp_medü_t
 *
med
;

134 i‡(
sdp
 =
NULL
)

135  
NULL
;

137 i‡(
pos_medü
 == -1) {

138  
sdp
->
i_öfo
;

141 
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

143 i‡(
med
 =
NULL
)

144  
NULL
;

146  
med
->
i_öfo
;

147 
	}
}

149 
	$sdp_mesßge_u_uri_£t
(
sdp_mesßge_t
 *
sdp
, *
uri
) {

150 i‡(
sdp
 =
NULL
)

151  
OSIP_BADPARAMETER
;

153 
sdp
->
u_uri
 = 
uri
;

154  
OSIP_SUCCESS
;

155 
	}
}

157 *
	$sdp_mesßge_u_uri_gë
(
sdp_mesßge_t
 *
sdp
) {

158 i‡(
sdp
 =
NULL
)

159  
NULL
;

161  
sdp
->
u_uri
;

162 
	}
}

164 
	$sdp_mesßge_e_emaû_add
(
sdp_mesßge_t
 *
sdp
, *
emaû
) {

165 i‡(
sdp
 =
NULL
)

166  
OSIP_BADPARAMETER
;

168 
	`osù_li°_add
(&
sdp
->
e_emaûs
, 
emaû
, -1);

169  
OSIP_SUCCESS
;

170 
	}
}

172 *
	$sdp_mesßge_e_emaû_gë
(
sdp_mesßge_t
 *
sdp
, 
pos
) {

173 i‡(
sdp
 =
NULL
)

174  
NULL
;

176 i‡(
	`osù_li°_size
(&
sdp
->
e_emaûs
Ë> 
pos
)

177  (*Ë
	`osù_li°_gë
(&
sdp
->
e_emaûs
, 
pos
);

179  
NULL
;

180 
	}
}

182 
	$sdp_mesßge_p_ph⁄e_add
(
sdp_mesßge_t
 *
sdp
, *
ph⁄e
) {

183 i‡(
sdp
 =
NULL
)

184  
OSIP_BADPARAMETER
;

186 
	`osù_li°_add
(&
sdp
->
p_ph⁄es
, 
ph⁄e
, -1);

187  
OSIP_SUCCESS
;

188 
	}
}

190 *
	$sdp_mesßge_p_ph⁄e_gë
(
sdp_mesßge_t
 *
sdp
, 
pos
) {

191 i‡(
sdp
 =
NULL
)

192  
NULL
;

194 i‡(
	`osù_li°_size
(&
sdp
->
p_ph⁄es
Ë> 
pos
)

195  (*Ë
	`osù_li°_gë
(&
sdp
->
p_ph⁄es
, 
pos
);

197  
NULL
;

198 
	}
}

200 
	$sdp_mesßge_c_c⁄√˘i⁄_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
√ây≥
, *
addπy≥
, *
addr
, *
addr_mu…iˇ°_âl
, *
addr_mu…iˇ°_öt
) {

201 
i
;

202 
sdp_medü_t
 *
med
;

203 
sdp_c⁄√˘i⁄_t
 *
c⁄n
;

205 i‡(
sdp
 =
NULL
)

206  
OSIP_BADPARAMETER
;

208 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

211 
i
 = 
	`sdp_c⁄√˘i⁄_öô
(&
c⁄n
);

213 i‡(
i
 != 0)

214  
i
;

216 
c⁄n
->
c_√ây≥
 = 
√ây≥
;

217 
c⁄n
->
c_addπy≥
 = 
addπy≥
;

218 
c⁄n
->
c_addr
 = 
addr
;

219 
c⁄n
->
c_addr_mu…iˇ°_âl
 = 
addr_mu…iˇ°_âl
;

220 
c⁄n
->
c_addr_mu…iˇ°_öt
 = 
addr_mu…iˇ°_öt
;

222 i‡(
pos_medü
 == -1) {

223 
sdp
->
c_c⁄√˘i⁄
 = 
c⁄n
;

224  
OSIP_SUCCESS
;

227 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

228 
	`osù_li°_add
(&
med
->
c_c⁄√˘i⁄s
, 
c⁄n
, -1);

229  
OSIP_SUCCESS
;

230 
	}
}

233 
sdp_c⁄√˘i⁄_t
 *
	$sdp_mesßge_c⁄√˘i⁄_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

234 
sdp_medü_t
 *
med
;

236 i‡(
sdp
 =
NULL
)

237  
NULL
;

239 i‡(
pos_medü
 == -1)

240  
sdp
->
c_c⁄√˘i⁄
;

242 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

244 i‡(
med
 =
NULL
)

245  
NULL
;

247  (
sdp_c⁄√˘i⁄_t
 *Ë
	`osù_li°_gë
(&
med
->
c_c⁄√˘i⁄s
, 
pos
);

248 
	}
}

250 *
	$sdp_mesßge_c_√ây≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

251 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = 
	`sdp_mesßge_c⁄√˘i⁄_gë
(
sdp
, 
pos_medü
, 
pos
);

253 i‡(
c⁄n
 =
NULL
)

254  
NULL
;

256  
c⁄n
->
c_√ây≥
;

257 
	}
}

259 *
	$sdp_mesßge_c_addπy≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

260 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = 
	`sdp_mesßge_c⁄√˘i⁄_gë
(
sdp
, 
pos_medü
, 
pos
);

262 i‡(
c⁄n
 =
NULL
)

263  
NULL
;

265  
c⁄n
->
c_addπy≥
;

266 
	}
}

268 *
	$sdp_mesßge_c_addr_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

269 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = 
	`sdp_mesßge_c⁄√˘i⁄_gë
(
sdp
, 
pos_medü
, 
pos
);

271 i‡(
c⁄n
 =
NULL
)

272  
NULL
;

274  
c⁄n
->
c_addr
;

275 
	}
}

277 *
	$sdp_mesßge_c_addr_mu…iˇ°_âl_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

278 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = 
	`sdp_mesßge_c⁄√˘i⁄_gë
(
sdp
, 
pos_medü
, 
pos
);

280 i‡(
c⁄n
 =
NULL
)

281  
NULL
;

283  
c⁄n
->
c_addr_mu…iˇ°_âl
;

284 
	}
}

286 *
	$sdp_mesßge_c_addr_mu…iˇ°_öt_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

287 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = 
	`sdp_mesßge_c⁄√˘i⁄_gë
(
sdp
, 
pos_medü
, 
pos
);

289 i‡(
c⁄n
 =
NULL
)

290  
NULL
;

292  
c⁄n
->
c_addr_mu…iˇ°_öt
;

293 
	}
}

295 
	$sdp_mesßge_b_b™dwidth_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
bwty≥
, *
b™dwidth
) {

296 
i
;

297 
sdp_medü_t
 *
med
;

298 
sdp_b™dwidth_t
 *
b™d
;

300 i‡(
sdp
 =
NULL
)

301  
OSIP_BADPARAMETER
;

303 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

304  
OSIP_UNDEFINED_ERROR
;

306 
i
 = 
	`sdp_b™dwidth_öô
(&
b™d
);

308 i‡(
i
 != 0)

309  
i
;

311 
b™d
->
b_bwty≥
 = 
bwty≥
;

312 
b™d
->
b_b™dwidth
 = 
b™dwidth
;

314 i‡(
pos_medü
 == -1) {

315 
	`osù_li°_add
(&
sdp
->
b_b™dwidths
, 
b™d
, -1);

316  
OSIP_SUCCESS
;

319 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

320 
	`osù_li°_add
(&
med
->
b_b™dwidths
, 
b™d
, -1);

321  
OSIP_SUCCESS
;

322 
	}
}

324 
sdp_b™dwidth_t
 *
	$sdp_mesßge_b™dwidth_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

325 
sdp_medü_t
 *
med
;

327 i‡(
sdp
 =
NULL
)

328  
NULL
;

330 i‡(
pos_medü
 == -1)

331  (
sdp_b™dwidth_t
 *Ë
	`osù_li°_gë
(&
sdp
->
b_b™dwidths
, 
pos
);

333 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

335 i‡(
med
 =
NULL
)

336  
NULL
;

338  (
sdp_b™dwidth_t
 *Ë
	`osù_li°_gë
(&
med
->
b_b™dwidths
, 
pos
);

339 
	}
}

341 *
	$sdp_mesßge_b_bwty≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

342 
sdp_b™dwidth_t
 *
b™d
 = 
	`sdp_mesßge_b™dwidth_gë
(
sdp
, 
pos_medü
, 
pos
);

344 i‡(
b™d
 =
NULL
)

345  
NULL
;

347  
b™d
->
b_bwty≥
;

348 
	}
}

350 *
	$sdp_mesßge_b_b™dwidth_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

351 
sdp_b™dwidth_t
 *
b™d
 = 
	`sdp_mesßge_b™dwidth_gë
(
sdp
, 
pos_medü
, 
pos
);

353 i‡(
b™d
 =
NULL
)

354  
NULL
;

356  
b™d
->
b_b™dwidth
;

357 
	}
}

359 
	$sdp_mesßge_t_time_des¸_add
(
sdp_mesßge_t
 *
sdp
, *
°¨t
, *
°›
) {

360 
i
;

361 
sdp_time_des¸_t
 *
td
;

363 i‡(
sdp
 =
NULL
)

364  
OSIP_BADPARAMETER
;

366 
i
 = 
	`sdp_time_des¸_öô
(&
td
);

368 i‡(
i
 != 0)

369  
i
;

371 
td
->
t_°¨t_time
 = 
°¨t
;

372 
td
->
t_°›_time
 = 
°›
;

373 
	`osù_li°_add
(&
sdp
->
t_des¸s
, 
td
, -1);

374  
OSIP_SUCCESS
;

375 
	}
}

377 *
	$sdp_mesßge_t_°¨t_time_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_td
) {

378 
sdp_time_des¸_t
 *
td
;

380 i‡(
sdp
 =
NULL
)

381  
NULL
;

383 
td
 = (
sdp_time_des¸_t
 *Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
pos_td
);

385 i‡(
td
 =
NULL
)

386  
NULL
;

388  
td
->
t_°¨t_time
;

389 
	}
}

391 *
	$sdp_mesßge_t_°›_time_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_td
) {

392 
sdp_time_des¸_t
 *
td
;

394 i‡(
sdp
 =
NULL
)

395  
NULL
;

397 
td
 = (
sdp_time_des¸_t
 *Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
pos_td
);

399 i‡(
td
 =
NULL
)

400  
NULL
;

402  
td
->
t_°›_time
;

403 
	}
}

405 
	$sdp_mesßge_r_ª≥©_add
(
sdp_mesßge_t
 *
sdp
, 
pos_time_des¸
, *
fõld
) {

406 
sdp_time_des¸_t
 *
td
;

408 i‡(
sdp
 =
NULL
)

409  
OSIP_BADPARAMETER
;

411 
td
 = (
sdp_time_des¸_t
 *Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
pos_time_des¸
);

413 i‡(
td
 =
NULL
)

414  
OSIP_UNDEFINED_ERROR
;

416 
	`osù_li°_add
(&
td
->
r_ª≥©s
, 
fõld
, -1);

417  
OSIP_SUCCESS
;

418 
	}
}

420 *
	$sdp_mesßge_r_ª≥©_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_time_des¸
, 
pos_ª≥©
) {

421 
sdp_time_des¸_t
 *
td
;

423 i‡(
sdp
 =
NULL
)

424  
NULL
;

426 
td
 = (
sdp_time_des¸_t
 *Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
pos_time_des¸
);

428 i‡(
td
 =
NULL
)

429  
NULL
;

431  (*Ë
	`osù_li°_gë
(&
td
->
r_ª≥©s
, 
pos_ª≥©
);

432 
	}
}

434 
	$sdp_mesßge_z_adju°míts_£t
(
sdp_mesßge_t
 *
sdp
, *
fõld
) {

435 i‡(
sdp
 =
NULL
)

436  
OSIP_BADPARAMETER
;

438 
sdp
->
z_adju°míts
 = 
fõld
;

439  
OSIP_SUCCESS
;

440 
	}
}

442 *
	$sdp_mesßge_z_adju°míts_gë
(
sdp_mesßge_t
 *
sdp
) {

443 i‡(
sdp
 =
NULL
)

444  
NULL
;

446  
sdp
->
z_adju°míts
;

447 
	}
}

449 
	$sdp_mesßge_k_key_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
keyty≥
, *
keyd©a
) {

450 
sdp_key_t
 *
key
;

451 
sdp_medü_t
 *
med
;

452 
i
;

454 i‡(
sdp
 =
NULL
)

455  
OSIP_BADPARAMETER
;

457 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

458  
OSIP_UNDEFINED_ERROR
;

460 
i
 = 
	`sdp_key_öô
(&
key
);

462 i‡(
i
 != 0)

463  
i
;

465 
key
->
k_keyty≥
 = 
keyty≥
;

466 
key
->
k_keyd©a
 = 
keyd©a
;

468 i‡(
pos_medü
 == -1) {

469 
sdp
->
k_key
 = 
key
;

470  
OSIP_SUCCESS
;

473 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

474 
med
->
k_key
 = 
key
;

475  
OSIP_SUCCESS
;

476 
	}
}

478 *
	$sdp_mesßge_k_keyty≥_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

479 
sdp_medü_t
 *
med
;

481 i‡(
sdp
 =
NULL
)

482  
NULL
;

484 i‡(
pos_medü
 == -1) {

485 i‡(
sdp
->
k_key
 =
NULL
)

486  
NULL
;

488  
sdp
->
k_key
->
k_keyty≥
;

491 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

492  
NULL
;

494 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

496 i‡(
med
->
k_key
 =
NULL
)

497  
NULL
;

499  
med
->
k_key
->
k_keyty≥
;

500 
	}
}

502 *
	$sdp_mesßge_k_keyd©a_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

503 
sdp_medü_t
 *
med
;

505 i‡(
sdp
 =
NULL
)

506  
NULL
;

508 i‡(
pos_medü
 == -1) {

509 i‡(
sdp
->
k_key
 =
NULL
)

510  
NULL
;

512  
sdp
->
k_key
->
k_keyd©a
;

515 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

516  
NULL
;

518 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

520 i‡(
med
->
k_key
 =
NULL
)

521  
NULL
;

523  
med
->
k_key
->
k_keyd©a
;

524 
	}
}

526 
	$sdp_mesßge_a_©åibuã_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
, *
©t_vÆue
) {

527 
i
;

528 
sdp_medü_t
 *
med
;

529 
sdp_©åibuã_t
 *
©å
;

531 i‡(
sdp
 =
NULL
)

532  
OSIP_BADPARAMETER
;

534 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

535  
OSIP_UNDEFINED_ERROR
;

537 
i
 = 
	`sdp_©åibuã_öô
(&
©å
);

539 i‡(
i
 != 0)

540  
i
;

542 
©å
->
a_©t_fõld
 = 
©t_fõld
;

543 
©å
->
a_©t_vÆue
 = 
©t_vÆue
;

545 i‡(
pos_medü
 == -1) {

546 
	`osù_li°_add
(&
sdp
->
a_©åibuãs
, 
©å
, -1);

547  
OSIP_SUCCESS
;

550 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

551 
	`osù_li°_add
(&
med
->
a_©åibuãs
, 
©å
, -1);

552  
OSIP_SUCCESS
;

553 
	}
}

555 
	$sdp_mesßge_a_©åibuã_dñ
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
) {

556 
i
;

557 
sdp_medü_t
 *
med
;

558 
sdp_©åibuã_t
 *
©å
;

560 i‡(
sdp
 =
NULL
)

561  
OSIP_BADPARAMETER
;

563 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

564  
OSIP_UNDEFINED_ERROR
;

566 i‡(
pos_medü
 == -1) {

567 
i
 = 0; i < 
	`osù_li°_size
(&
sdp
->
a_©åibuãs
);) {

568 
©å
 = 
	`osù_li°_gë
(&
sdp
->
a_©åibuãs
, 
i
);

570 i‡(
	`°rcmp
(
©å
->
a_©t_fõld
, 
©t_fõld
) == 0) {

571 
	`osù_li°_ªmove
(&
sdp
->
a_©åibuãs
, 
i
);

572 
	`sdp_©åibuã_‰ì
(
©å
);

575 
i
++;

578  
OSIP_SUCCESS
;

581 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

583 i‡(
med
 =
NULL
)

584  
OSIP_UNDEFINED_ERROR
;

586 
i
 = 0; i < 
	`osù_li°_size
(&
med
->
a_©åibuãs
);) {

587 
©å
 = 
	`osù_li°_gë
(&
med
->
a_©åibuãs
, 
i
);

589 i‡(
	`°rcmp
(
©å
->
a_©t_fõld
, 
©t_fõld
) == 0) {

590 
	`osù_li°_ªmove
(&
med
->
a_©åibuãs
, 
i
);

591 
	`sdp_©åibuã_‰ì
(
©å
);

594 
i
++;

597  
OSIP_SUCCESS
;

598 
	}
}

600 
	$sdp_mesßge_a_©åibuã_dñ_©_ödex
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
©t_fõld
, 
pos_©å
) {

601 
sdp_medü_t
 *
med
;

602 
sdp_©åibuã_t
 *
©å
;

604 i‡(
sdp
 =
NULL
)

605  
OSIP_BADPARAMETER
;

607 i‡((
pos_medü
 !-1Ë&& (
	`osù_li°_size
(&
sdp
->
m_medüs
) <Öos_media + 1))

608  
OSIP_BADPARAMETER
;

610 i‡(
pos_©å
 == -1)

611  
	`sdp_mesßge_a_©åibuã_dñ
(
sdp
, 
pos_medü
, 
©t_fõld
);

613 i‡(
pos_medü
 == -1) {

614 i‡((
©å
 = 
	`osù_li°_gë
(&
sdp
->
a_©åibuãs
, 
pos_©å
)Ë!
NULL
) {

615 i‡(
	`°rcmp
(
©å
->
a_©t_fõld
, 
©t_fõld
) == 0) {

616 
	`osù_li°_ªmove
(&
sdp
->
a_©åibuãs
, 
pos_©å
);

617 
	`sdp_©åibuã_‰ì
(
©å
);

618  
OSIP_SUCCESS
;

622  
OSIP_BADPARAMETER
;

625 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

627 i‡(
med
 =
NULL
)

628  
OSIP_UNDEFINED_ERROR
;

630 i‡((
©å
 = 
	`osù_li°_gë
(&
med
->
a_©åibuãs
, 
pos_©å
)Ë!
NULL
) {

631 i‡(
	`°rcmp
(
©å
->
a_©t_fõld
, 
©t_fõld
) == 0) {

632 
	`osù_li°_ªmove
(&
med
->
a_©åibuãs
, 
pos_©å
);

633 
	`sdp_©åibuã_‰ì
(
©å
);

634  
OSIP_SUCCESS
;

638  
OSIP_BADPARAMETER
;

639 
	}
}

641 
sdp_©åibuã_t
 *
	$sdp_mesßge_©åibuã_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

642 
sdp_medü_t
 *
med
;

644 i‡(
sdp
 =
NULL
)

645  
NULL
;

647 i‡(
pos_medü
 == -1)

648  (
sdp_©åibuã_t
 *Ë
	`osù_li°_gë
(&
sdp
->
a_©åibuãs
, 
pos
);

650 
med
 = (
sdp_medü_t
 *Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

652 i‡(
med
 =
NULL
)

653  
NULL
;

655  (
sdp_©åibuã_t
 *Ë
	`osù_li°_gë
(&
med
->
a_©åibuãs
, 
pos
);

656 
	}
}

658 *
	$sdp_mesßge_a_©t_fõld_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

659 
sdp_©åibuã_t
 *
©å
 = 
	`sdp_mesßge_©åibuã_gë
(
sdp
, 
pos_medü
, 
pos
);

661 i‡(
©å
 =
NULL
)

662  
NULL
;

664  
©å
->
a_©t_fõld
;

665 
	}
}

667 *
	$sdp_mesßge_a_©t_vÆue_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

668 
sdp_©åibuã_t
 *
©å
 = 
	`sdp_mesßge_©åibuã_gë
(
sdp
, 
pos_medü
, 
pos
);

670 i‡(
©å
 =
NULL
)

671  
NULL
;

673  
©å
->
a_©t_vÆue
;

674 
	}
}

676 
	$sdp_mesßge_ídof_medü
(
sdp_mesßge_t
 *
sdp
, 
i
) {

677 i‡(
sdp
 =
NULL
)

678  
OSIP_BADPARAMETER
;

680 i‡(
i
 == -1)

681  
OSIP_SUCCESS
;

683 i‡(!
	`osù_li°_eﬁ
(&
sdp
->
m_medüs
, 
i
))

684  
OSIP_SUCCESS
;

686  
OSIP_UNDEFINED_ERROR
;

687 
	}
}

689 
	$sdp_mesßge_m_medü_add
(
sdp_mesßge_t
 *
sdp
, *
medü
, *
p‹t
, *
numbî_of_p‹t
, *
¥Ÿo
) {

690 
i
;

691 
sdp_medü_t
 *
med
;

693 
i
 = 
	`sdp_medü_öô
(&
med
);

695 i‡(
i
 != 0)

696  
i
;

698 
med
->
m_medü
 = 
medü
;

699 
med
->
m_p‹t
 = 
p‹t
;

700 
med
->
m_numbî_of_p‹t
 = 
numbî_of_p‹t
;

701 
med
->
m_¥Ÿo
 = 
¥Ÿo
;

702 
	`osù_li°_add
(&
sdp
->
m_medüs
, 
med
, -1);

703  
OSIP_SUCCESS
;

704 
	}
}

706 *
	$sdp_mesßge_m_medü_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

707 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

709 i‡(
med
 =
NULL
)

710  
NULL
;

712  
med
->
m_medü
;

713 
	}
}

715 *
	$sdp_mesßge_m_p‹t_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

716 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

718 i‡(
med
 =
NULL
)

719  
NULL
;

721  
med
->
m_p‹t
;

722 
	}
}

724 *
	$sdp_mesßge_m_numbî_of_p‹t_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

725 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

727 i‡(
med
 =
NULL
)

728  
NULL
;

730  
med
->
m_numbî_of_p‹t
;

731 
	}
}

733 
	$sdp_mesßge_m_p‹t_£t
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
p‹t
) {

734 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

736 i‡(
med
 =
NULL
)

737  
OSIP_BADPARAMETER
;

739 i‡(
med
->
m_p‹t
)

740 
	`osù_‰ì
(
med
->
m_p‹t
);

742 
med
->
m_p‹t
 = 
p‹t
;

743  
OSIP_SUCCESS
;

744 
	}
}

746 *
	$sdp_mesßge_m_¥Ÿo_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
) {

747 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

749 i‡(
med
 =
NULL
)

750  
NULL
;

752  
med
->
m_¥Ÿo
;

753 
	}
}

755 
	$sdp_mesßge_m_∑ylﬂd_add
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, *
∑ylﬂd
) {

756 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

758 i‡(
med
 =
NULL
)

759  
OSIP_BADPARAMETER
;

761 
	`osù_li°_add
(&
med
->
m_∑ylﬂds
, 
∑ylﬂd
, -1);

762  
OSIP_SUCCESS
;

763 
	}
}

765 *
	$sdp_mesßge_m_∑ylﬂd_gë
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

766 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

768 i‡(
med
 =
NULL
)

769  
NULL
;

771  (*Ë
	`osù_li°_gë
(&
med
->
m_∑ylﬂds
, 
pos
);

772 
	}
}

774 
	$sdp_mesßge_m_∑ylﬂd_dñ
(
sdp_mesßge_t
 *
sdp
, 
pos_medü
, 
pos
) {

775 
sdp_medü_t
 *
med
 = 
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos_medü
);

776 *
∑ylﬂd
;

778 i‡(
med
 =
NULL
)

779  
OSIP_BADPARAMETER
;

781 i‡((
∑ylﬂd
 = 
	`osù_li°_gë
(&
med
->
m_∑ylﬂds
, 
pos
)Ë=
NULL
)

782  
OSIP_UNDEFINED_ERROR
;

784 
	`osù_li°_ªmove
(&
med
->
m_∑ylﬂds
, 
pos
);

785 
	`osù_‰ì
(
∑ylﬂd
);

786  
OSIP_SUCCESS
;

787 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_message.c

20 
	~<osù∑r£r2/öã∫Æ.h
>

22 
	~<osù∑r£r2/osù_c⁄°.h
>

23 
	~<osù∑r£r2/sdp_mesßge.h
>

24 
	~<osù∑r£r2/osù_mesßge.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

27 
	#ERR_ERROR
 -1

	)

28 
	#ERR_DISCARD
 0

	)

29 
	#OSIP_WF
 1

	)

31 
sdp_mesßge_∑r£_v
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

32 
sdp_mesßge_∑r£_o
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

33 
sdp_mesßge_∑r£_s
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

34 
sdp_mesßge_∑r£_i
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

35 
sdp_mesßge_∑r£_u
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

36 
sdp_mesßge_∑r£_e
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

37 
sdp_mesßge_∑r£_p
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

38 
sdp_mesßge_∑r£_c
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

39 
sdp_mesßge_∑r£_b
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

40 
sdp_mesßge_∑r£_t
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

41 
sdp_mesßge_∑r£_r
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

42 
sdp_mesßge_∑r£_z
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

43 
sdp_mesßge_∑r£_k
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

44 
sdp_mesßge_∑r£_a
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

45 
sdp_mesßge_∑r£_m
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
);

47 
sdp_≠≥nd_medü
(**
°rög
, *
size
, *
tmp
, 
sdp_medü_t
 *
medü
, **
√xt_tmp
);

48 
sdp_≠≥nd_©åibuã
(**
°rög
, *
size
, *
tmp
, 
sdp_©åibuã_t
 *
©åibuã
, **
√xt_tmp
);

49 
sdp_≠≥nd_key
(**
°rög
, *
size
, *
tmp
, 
sdp_key_t
 *
key
, **
√xt_tmp
);

50 
sdp_≠≥nd_time_des¸
(**
°rög
, *
size
, *
tmp
, 
sdp_time_des¸_t
 *
time_des¸
, **
√xt_tmp
);

51 
sdp_≠≥nd_b™dwidth
(**
°rög
, *
size
, *
tmp
, 
sdp_b™dwidth_t
 *
b™dwidth
, **
√xt_tmp
);

52 
sdp_≠≥nd_c⁄√˘i⁄
(**
°rög
, *
size
, *
tmp
, 
sdp_c⁄√˘i⁄_t
 *
c⁄n
, **
√xt_tmp
);

54 *
__osù_sdp_≠≥nd_°rög
(**
°rög
, *
size
, *
cur
, *
°rög_osù_to_≠≥nd
);

56 
	$sdp_b™dwidth_öô
(
sdp_b™dwidth_t
 **
b
) {

57 *
b
 = (
sdp_b™dwidth_t
 *Ë
	`osù_mÆloc
((sdp_bandwidth_t));

59 i‡(*
b
 =
NULL
)

60  
OSIP_NOMEM
;

62 (*
b
)->
b_bwty≥
 = 
NULL
;

63 (*
b
)->
b_b™dwidth
 = 
NULL
;

64  
OSIP_SUCCESS
;

65 
	}
}

67 
	$sdp_b™dwidth_‰ì
(
sdp_b™dwidth_t
 *
b
) {

68 i‡(
b
 =
NULL
)

71 
	`osù_‰ì
(
b
->
b_bwty≥
);

72 
	`osù_‰ì
(
b
->
b_b™dwidth
);

73 
	`osù_‰ì
(
b
);

74 
	}
}

76 
	$sdp_time_des¸_öô
(
sdp_time_des¸_t
 **
td
) {

77 *
td
 = (
sdp_time_des¸_t
 *Ë
	`osù_mÆloc
((sdp_time_descr_t));

79 i‡(*
td
 =
NULL
)

80  
OSIP_NOMEM
;

82 (*
td
)->
t_°¨t_time
 = 
NULL
;

83 (*
td
)->
t_°›_time
 = 
NULL
;

84 
	`osù_li°_öô
(&(*
td
)->
r_ª≥©s
);

85  
OSIP_SUCCESS
;

86 
	}
}

88 
	$sdp_time_des¸_‰ì
(
sdp_time_des¸_t
 *
td
) {

89 i‡(
td
 =
NULL
)

92 
	`osù_‰ì
(
td
->
t_°¨t_time
);

93 
	`osù_‰ì
(
td
->
t_°›_time
);

94 
	`osù_li°_ofch¨_‰ì
(&
td
->
r_ª≥©s
);

95 
	`osù_‰ì
(
td
);

96 
	}
}

98 
	$sdp_key_öô
(
sdp_key_t
 **
key
) {

99 *
key
 = (
sdp_key_t
 *Ë
	`osù_mÆloc
((sdp_key_t));

101 i‡(*
key
 =
NULL
)

102  
OSIP_NOMEM
;

104 (*
key
)->
k_keyty≥
 = 
NULL
;

105 (*
key
)->
k_keyd©a
 = 
NULL
;

106  
OSIP_SUCCESS
;

107 
	}
}

109 
	$sdp_key_‰ì
(
sdp_key_t
 *
key
) {

110 i‡(
key
 =
NULL
)

113 
	`osù_‰ì
(
key
->
k_keyty≥
);

114 
	`osù_‰ì
(
key
->
k_keyd©a
);

115 
	`osù_‰ì
(
key
);

116 
	}
}

118 
	$sdp_©åibuã_öô
(
sdp_©åibuã_t
 **
©åibuã
) {

119 *
©åibuã
 = (
sdp_©åibuã_t
 *Ë
	`osù_mÆloc
((sdp_attribute_t));

121 i‡(*
©åibuã
 =
NULL
)

122  
OSIP_NOMEM
;

124 (*
©åibuã
)->
a_©t_fõld
 = 
NULL
;

125 (*
©åibuã
)->
a_©t_vÆue
 = 
NULL
;

126  
OSIP_SUCCESS
;

127 
	}
}

129 
	$sdp_©åibuã_‰ì
(
sdp_©åibuã_t
 *
©åibuã
) {

130 i‡(
©åibuã
 =
NULL
)

133 
	`osù_‰ì
(
©åibuã
->
a_©t_fõld
);

134 
	`osù_‰ì
(
©åibuã
->
a_©t_vÆue
);

135 
	`osù_‰ì
(
©åibuã
);

136 
	}
}

138 
	$sdp_c⁄√˘i⁄_öô
(
sdp_c⁄√˘i⁄_t
 **
c⁄√˘i⁄
) {

139 *
c⁄√˘i⁄
 = (
sdp_c⁄√˘i⁄_t
 *Ë
	`osù_mÆloc
((sdp_connection_t));

141 i‡(*
c⁄√˘i⁄
 =
NULL
)

142  
OSIP_NOMEM
;

144 (*
c⁄√˘i⁄
)->
c_√ây≥
 = 
NULL
;

145 (*
c⁄√˘i⁄
)->
c_addπy≥
 = 
NULL
;

146 (*
c⁄√˘i⁄
)->
c_addr
 = 
NULL
;

147 (*
c⁄√˘i⁄
)->
c_addr_mu…iˇ°_âl
 = 
NULL
;

148 (*
c⁄√˘i⁄
)->
c_addr_mu…iˇ°_öt
 = 
NULL
;

149  
OSIP_SUCCESS
;

150 
	}
}

152 
	$sdp_c⁄√˘i⁄_‰ì
(
sdp_c⁄√˘i⁄_t
 *
c⁄√˘i⁄
) {

153 i‡(
c⁄√˘i⁄
 =
NULL
)

156 
	`osù_‰ì
(
c⁄√˘i⁄
->
c_√ây≥
);

157 
	`osù_‰ì
(
c⁄√˘i⁄
->
c_addπy≥
);

158 
	`osù_‰ì
(
c⁄√˘i⁄
->
c_addr
);

159 
	`osù_‰ì
(
c⁄√˘i⁄
->
c_addr_mu…iˇ°_âl
);

160 
	`osù_‰ì
(
c⁄√˘i⁄
->
c_addr_mu…iˇ°_öt
);

161 
	`osù_‰ì
(
c⁄√˘i⁄
);

162 
	}
}

164 
	$sdp_medü_öô
(
sdp_medü_t
 **
medü
) {

165 
i
;

167 *
medü
 = (
sdp_medü_t
 *Ë
	`osù_mÆloc
((sdp_media_t));

169 i‡(*
medü
 =
NULL
)

170  
OSIP_NOMEM
;

172 (*
medü
)->
m_medü
 = 
NULL
;

173 (*
medü
)->
m_p‹t
 = 
NULL
;

174 (*
medü
)->
m_numbî_of_p‹t
 = 
NULL
;

175 (*
medü
)->
m_¥Ÿo
 = 
NULL
;

176 
i
 = 
	`osù_li°_öô
(&(*
medü
)->
m_∑ylﬂds
);

178 i‡(
i
 != 0) {

179 
	`osù_‰ì
(*
medü
);

180 *
medü
 = 
NULL
;

181  
OSIP_NOMEM
;

184 (*
medü
)->
i_öfo
 = 
NULL
;

185 
i
 = 
	`osù_li°_öô
(&(*
medü
)->
c_c⁄√˘i⁄s
);

187 i‡(
i
 != 0) {

188 
	`osù_li°_ofch¨_‰ì
(&(*
medü
)->
m_∑ylﬂds
);

189 
	`osù_‰ì
(*
medü
);

190 *
medü
 = 
NULL
;

191  
OSIP_NOMEM
;

194 
i
 = 
	`osù_li°_öô
(&(*
medü
)->
b_b™dwidths
);

196 i‡(
i
 != 0) {

197 
	`osù_li°_ofch¨_‰ì
(&(*
medü
)->
m_∑ylﬂds
);

198 
	`osù_li°_•ecül_‰ì
(&(*
medü
)->
c_c⁄√˘i⁄s
, ((*)(*)Ë& 
sdp_c⁄√˘i⁄_‰ì
);

199 
	`osù_‰ì
(*
medü
);

200 *
medü
 = 
NULL
;

201  
OSIP_NOMEM
;

204 
i
 = 
	`osù_li°_öô
(&(*
medü
)->
a_©åibuãs
);

206 i‡(
i
 != 0) {

207 
	`osù_li°_ofch¨_‰ì
(&(*
medü
)->
m_∑ylﬂds
);

208 
	`osù_li°_•ecül_‰ì
(&(*
medü
)->
c_c⁄√˘i⁄s
, ((*)(*)Ë& 
sdp_c⁄√˘i⁄_‰ì
);

209 
	`osù_li°_•ecül_‰ì
(&(*
medü
)->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

210 
	`osù_‰ì
(*
medü
);

211 *
medü
 = 
NULL
;

212  
OSIP_NOMEM
;

215 (*
medü
)->
k_key
 = 
NULL
;

216  
OSIP_SUCCESS
;

217 
	}
}

219 
	$sdp_medü_‰ì
(
sdp_medü_t
 *
medü
) {

220 i‡(
medü
 =
NULL
)

223 
	`osù_‰ì
(
medü
->
m_medü
);

224 
	`osù_‰ì
(
medü
->
m_p‹t
);

225 
	`osù_‰ì
(
medü
->
m_numbî_of_p‹t
);

226 
	`osù_‰ì
(
medü
->
m_¥Ÿo
);

227 
	`osù_li°_ofch¨_‰ì
(&
medü
->
m_∑ylﬂds
);

228 
	`osù_‰ì
(
medü
->
i_öfo
);

229 
	`osù_li°_•ecül_‰ì
(&
medü
->
c_c⁄√˘i⁄s
, ((*)(*)Ë& 
sdp_c⁄√˘i⁄_‰ì
);

230 
	`osù_li°_•ecül_‰ì
(&
medü
->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

231 
	`osù_li°_•ecül_‰ì
(&
medü
->
a_©åibuãs
, ((*)(*)Ë& 
sdp_©åibuã_‰ì
);

232 
	`sdp_key_‰ì
(
medü
->
k_key
);

233 
	`osù_‰ì
(
medü
);

234 
	}
}

237 
	$sdp_mesßge_öô
(
sdp_mesßge_t
 **
sdp
) {

238 
i
;

240 (*
sdp
Ë(
sdp_mesßge_t
 *Ë
	`osù_mÆloc
((sdp_message_t));

242 i‡(*
sdp
 =
NULL
)

243  
OSIP_NOMEM
;

245 (*
sdp
)->
v_vîsi⁄
 = 
NULL
;

246 (*
sdp
)->
o_u£∫ame
 = 
NULL
;

247 (*
sdp
)->
o_£ss_id
 = 
NULL
;

248 (*
sdp
)->
o_£ss_vîsi⁄
 = 
NULL
;

249 (*
sdp
)->
o_√ây≥
 = 
NULL
;

250 (*
sdp
)->
o_addπy≥
 = 
NULL
;

251 (*
sdp
)->
o_addr
 = 
NULL
;

252 (*
sdp
)->
s_«me
 = 
NULL
;

253 (*
sdp
)->
i_öfo
 = 
NULL
;

254 (*
sdp
)->
u_uri
 = 
NULL
;

256 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
e_emaûs
);

258 i‡(
i
 != 0) {

259 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

260 
	`osù_‰ì
(*
sdp
);

261 *
sdp
 = 
NULL
;

262  
OSIP_NOMEM
;

265 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
p_ph⁄es
);

267 i‡(
i
 != 0) {

268 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

269 
	`osù_‰ì
(*
sdp
);

270 *
sdp
 = 
NULL
;

271  
OSIP_NOMEM
;

274 (*
sdp
)->
c_c⁄√˘i⁄
 = 
NULL
;

276 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
b_b™dwidths
);

278 i‡(
i
 != 0) {

279 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

280 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
p_ph⁄es
);

281 
	`osù_‰ì
(*
sdp
);

282 *
sdp
 = 
NULL
;

283  
OSIP_NOMEM
;

286 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
t_des¸s
);

288 i‡(
i
 != 0) {

289 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

290 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
p_ph⁄es
);

291 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

292 
	`osù_‰ì
(*
sdp
);

293 *
sdp
 = 
NULL
;

294  
OSIP_NOMEM
;

297 (*
sdp
)->
z_adju°míts
 = 
NULL
;

298 (*
sdp
)->
k_key
 = 
NULL
;

300 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
a_©åibuãs
);

302 i‡(
i
 != 0) {

303 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

304 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
p_ph⁄es
);

305 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

306 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
t_des¸s
, ((*)(*)Ë& 
sdp_time_des¸_‰ì
);

307 
	`osù_‰ì
(*
sdp
);

308 *
sdp
 = 
NULL
;

309  
OSIP_NOMEM
;

312 
i
 = 
	`osù_li°_öô
(&(*
sdp
)->
m_medüs
);

314 i‡(
i
 != 0) {

315 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
e_emaûs
);

316 
	`osù_li°_ofch¨_‰ì
(&(*
sdp
)->
p_ph⁄es
);

317 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

318 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
t_des¸s
, ((*)(*)Ë& 
sdp_time_des¸_‰ì
);

319 
	`osù_li°_•ecül_‰ì
(&(*
sdp
)->
a_©åibuãs
, ((*)(*)Ë& 
sdp_©åibuã_‰ì
);

320 
	`osù_‰ì
(*
sdp
);

321 *
sdp
 = 
NULL
;

322  
OSIP_NOMEM
;

325  
OSIP_SUCCESS
;

326 
	}
}

331 *
	$__osù_sdp_≠≥nd_°rög
(**
°rög
, *
size
, *
cur
, *
°rög_osù_to_≠≥nd
) {

332 
Àngth
 = (Ë
	`°æí
(
°rög_osù_to_≠≥nd
);

334 i‡(
cur
 - (*
°rög
Ë+ 
Àngth
 + 1 > *
size
) {

335 
Àngth2
;

337 
Àngth2
 = (Ë(
cur
 - *
°rög
);

338 (*
°rög
Ë
	`osù_ªÆloc
((*°rög), *
size
 + 
Àngth
 + 500);

339 *
size
 = *sizê+ 
Àngth
 + 500;

340 
cur
 = (*
°rög
Ë+ 
Àngth2
;

343 
	`osù_°∫˝y
(
cur
, 
°rög_osù_to_≠≥nd
, 
Àngth
);

344  
cur
 + 
	`°æí
(cur);

345 
	}
}

347 
	$sdp_mesßge_∑r£_v
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

348 *
equÆ
;

349 *
¸lf
;

351 *
√xt
 = 
buf
;

353 
equÆ
 = 
buf
;

355 (*
equÆ
 != '=') && (*equal != '\0'))

356 
equÆ
++;

358 i‡(*
equÆ
 == '\0')

359  
ERR_ERROR
;

361 i‡(
equÆ
 =
buf
)

362  
ERR_DISCARD
;

365 i‡(
equÆ
[-1] != 'v')

366  
ERR_DISCARD
;

368 
¸lf
 = 
equÆ
 + 1;

370 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

371 
¸lf
++;

373 i‡(*
¸lf
 == '\0')

374  
ERR_ERROR
;

376 i‡(
¸lf
 =
equÆ
 + 1)

377  
ERR_ERROR
;

379 
sdp
->
v_vîsi⁄
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

381 i‡(
sdp
->
v_vîsi⁄
 =
NULL
)

382  
OSIP_NOMEM
;

384 
	`osù_°∫˝y
(
sdp
->
v_vîsi⁄
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

386 i‡(
¸lf
[1] == '\n')

387 *
√xt
 = 
¸lf
 + 2;

390 *
√xt
 = 
¸lf
 + 1;

392  
OSIP_WF
;

393 
	}
}

395 
	$sdp_mesßge_∑r£_o
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

396 *
equÆ
;

397 *
¸lf
;

398 *
tmp
;

399 *
tmp_√xt
;

400 
i
;

402 *
√xt
 = 
buf
;

404 
equÆ
 = 
buf
;

406 (*
equÆ
 != '=') && (*equal != '\0'))

407 
equÆ
++;

409 i‡(*
equÆ
 == '\0')

410  
ERR_ERROR
;

413 i‡(
equÆ
[-1] != 'o')

414  
ERR_DISCARD
;

416 
¸lf
 = 
equÆ
 + 1;

418 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

419 
¸lf
++;

421 i‡(*
¸lf
 == '\0')

422  
ERR_ERROR
;

424 i‡(
¸lf
 =
equÆ
 + 1)

425  
ERR_ERROR
;

427 
tmp
 = 
equÆ
 + 1;

431 #ifde‡
FIREFLY_BUG_SUPPORT


433 i‡(
tmp
[0] == ' ') {

434 
sdp
->
o_u£∫ame
 = 
	`osù_°rdup
("firefly");

435 
tmp
++;

438 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_u£∫ame
), 
tmp
, ' ', &
tmp_√xt
);

440 i‡(
i
 != 0)

443 
tmp
 = 
tmp_√xt
;

447 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_u£∫ame
), 
tmp
, ' ', &
tmp_√xt
);

449 i‡(
i
 != 0)

452 
tmp
 = 
tmp_√xt
;

456 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_£ss_id
), 
tmp
, ' ', &
tmp_√xt
);

458 i‡(
i
 != 0)

461 
tmp
 = 
tmp_√xt
;

464 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_£ss_vîsi⁄
), 
tmp
, ' ', &
tmp_√xt
);

466 i‡(
i
 != 0)

469 
tmp
 = 
tmp_√xt
;

472 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_√ây≥
), 
tmp
, ' ', &
tmp_√xt
);

474 i‡(
i
 != 0)

477 
tmp
 = 
tmp_√xt
;

480 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_addπy≥
), 
tmp
, ' ', &
tmp_√xt
);

482 i‡(
i
 != 0)

485 
tmp
 = 
tmp_√xt
;

488 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_addr
), 
tmp
, '\r', &
tmp_√xt
);

490 i‡(
i
 != 0) {

491 
i
 = 
	`__osù_£t_√xt_tokí
(&(
sdp
->
o_addr
), 
tmp
, '\n', &
tmp_√xt
);

493 i‡(
i
 != 0)

497 i‡(
¸lf
[1] == '\n')

498 *
√xt
 = 
¸lf
 + 2;

501 *
√xt
 = 
¸lf
 + 1;

503  
OSIP_WF
;

504 
	}
}

506 
	$sdp_mesßge_∑r£_s
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

507 *
equÆ
;

508 *
¸lf
;

510 *
√xt
 = 
buf
;

512 
equÆ
 = 
buf
;

514 (*
equÆ
 != '=') && (*equal != '\0'))

515 
equÆ
++;

517 i‡(*
equÆ
 == '\0')

518  
ERR_ERROR
;

521 i‡(
equÆ
[-1] != 's')

522  
ERR_DISCARD
;

524 
¸lf
 = 
equÆ
 + 1;

526 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

527 
¸lf
++;

529 i‡(*
¸lf
 == '\0')

530  
ERR_ERROR
;

532 #ifde‡
FIREFLY_BUG_SUPPORT


534 i‡(
¸lf
 =
equÆ
 + 1) {

535 
sdp
->
s_«me
 = 
	`osù_°rdup
(" ");

537 i‡(
¸lf
[1] == '\n')

538 *
√xt
 = 
¸lf
 + 2;

541 *
√xt
 = 
¸lf
 + 1;

543  
OSIP_WF
;

548 i‡(
¸lf
 =
equÆ
 + 1)

549  
ERR_ERROR
;

557 
sdp
->
s_«me
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

559 i‡(
sdp
->
s_«me
 =
NULL
)

560  
OSIP_NOMEM
;

562 
	`osù_°∫˝y
(
sdp
->
s_«me
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

564 i‡(
¸lf
[1] == '\n')

565 *
√xt
 = 
¸lf
 + 2;

568 *
√xt
 = 
¸lf
 + 1;

570  
OSIP_WF
;

571 
	}
}

573 
	$sdp_mesßge_∑r£_i
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

574 *
equÆ
;

575 *
¸lf
;

576 
i
;

577 *
i_öfo
;

579 *
√xt
 = 
buf
;

581 
equÆ
 = 
buf
;

583 (*
equÆ
 != '=') && (*equal != '\0'))

584 
equÆ
++;

586 i‡(*
equÆ
 == '\0')

587  
ERR_ERROR
;

590 i‡(
equÆ
[-1] != 'i')

591  
ERR_DISCARD
;

593 
¸lf
 = 
equÆ
 + 1;

595 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

596 
¸lf
++;

598 i‡(*
¸lf
 == '\0')

599  
ERR_ERROR
;

601 i‡(
¸lf
 =
equÆ
 + 1)

602  
ERR_ERROR
;

608 
i_öfo
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

610 i‡(
i_öfo
 =
NULL
)

611  
OSIP_NOMEM
;

613 
	`osù_°∫˝y
(
i_öfo
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

619 
i
 = 
	`osù_li°_size
(&
sdp
->
m_medüs
);

621 i‡(
i
 == 0)

622 
sdp
->
i_öfo
 = i_info;

625 
sdp_medü_t
 *
œ°_sdp_medü
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
i
 - 1);

627 
œ°_sdp_medü
->
i_öfo
 = i_info;

630 i‡(
¸lf
[1] == '\n')

631 *
√xt
 = 
¸lf
 + 2;

634 *
√xt
 = 
¸lf
 + 1;

636  
OSIP_WF
;

637 
	}
}

639 
	$sdp_mesßge_∑r£_u
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

640 *
equÆ
;

641 *
¸lf
;

643 *
√xt
 = 
buf
;

645 
equÆ
 = 
buf
;

647 (*
equÆ
 != '=') && (*equal != '\0'))

648 
equÆ
++;

650 i‡(*
equÆ
 == '\0')

651  
ERR_ERROR
;

654 i‡(
equÆ
[-1] != 'u')

655  
ERR_DISCARD
;

657 
¸lf
 = 
equÆ
 + 1;

659 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

660 
¸lf
++;

662 i‡(*
¸lf
 == '\0')

663  
ERR_ERROR
;

665 i‡(
¸lf
 =
equÆ
 + 1)

666  
ERR_ERROR
;

670 
sdp
->
u_uri
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

672 i‡(
sdp
->
u_uri
 =
NULL
)

673  
OSIP_NOMEM
;

675 
	`osù_°∫˝y
(
sdp
->
u_uri
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

677 i‡(
¸lf
[1] == '\n')

678 *
√xt
 = 
¸lf
 + 2;

681 *
√xt
 = 
¸lf
 + 1;

683  
OSIP_WF
;

684 
	}
}

686 
	$sdp_mesßge_∑r£_e
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

687 *
equÆ
;

688 *
¸lf
;

689 *
e_emaû
;

691 *
√xt
 = 
buf
;

693 
equÆ
 = 
buf
;

695 (*
equÆ
 != '=') && (*equal != '\0'))

696 
equÆ
++;

698 i‡(*
equÆ
 == '\0')

699  
ERR_ERROR
;

702 i‡(
equÆ
[-1] != 'e')

703  
ERR_DISCARD
;

705 
¸lf
 = 
equÆ
 + 1;

707 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

708 
¸lf
++;

710 i‡(*
¸lf
 == '\0')

711  
ERR_ERROR
;

713 i‡(
¸lf
 =
equÆ
 + 1)

714  
ERR_ERROR
;

718 
e_emaû
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

720 i‡(
e_emaû
 =
NULL
)

721  
OSIP_NOMEM
;

723 
	`osù_°∫˝y
(
e_emaû
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

725 
	`osù_li°_add
(&
sdp
->
e_emaûs
, 
e_emaû
, -1);

727 i‡(
¸lf
[1] == '\n')

728 *
√xt
 = 
¸lf
 + 2;

731 *
√xt
 = 
¸lf
 + 1;

733  
OSIP_WF
;

734 
	}
}

736 
	$sdp_mesßge_∑r£_p
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

737 *
equÆ
;

738 *
¸lf
;

739 *
p_ph⁄e
;

741 *
√xt
 = 
buf
;

743 
equÆ
 = 
buf
;

745 (*
equÆ
 != '=') && (*equal != '\0'))

746 
equÆ
++;

748 i‡(*
equÆ
 == '\0')

749  
ERR_ERROR
;

752 i‡(
equÆ
[-1] != 'p')

753  
ERR_DISCARD
;

755 
¸lf
 = 
equÆ
 + 1;

757 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

758 
¸lf
++;

760 i‡(*
¸lf
 == '\0')

761  
ERR_ERROR
;

763 i‡(
¸lf
 =
equÆ
 + 1)

764  
ERR_ERROR
;

768 
p_ph⁄e
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

770 i‡(
p_ph⁄e
 =
NULL
)

771  
OSIP_NOMEM
;

773 
	`osù_°∫˝y
(
p_ph⁄e
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

775 
	`osù_li°_add
(&
sdp
->
p_ph⁄es
, 
p_ph⁄e
, -1);

777 i‡(
¸lf
[1] == '\n')

778 *
√xt
 = 
¸lf
 + 2;

781 *
√xt
 = 
¸lf
 + 1;

783  
OSIP_WF
;

784 
	}
}

786 
	$sdp_mesßge_∑r£_c
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

787 *
equÆ
;

788 *
¸lf
;

789 *
tmp
;

790 *
tmp_√xt
;

791 
sdp_c⁄√˘i⁄_t
 *
c_hódî
;

792 
i
;

794 *
√xt
 = 
buf
;

796 
equÆ
 = 
buf
;

798 (*
equÆ
 != '=') && (*equal != '\0'))

799 
equÆ
++;

801 i‡(*
equÆ
 == '\0')

802  
ERR_ERROR
;

805 i‡(
equÆ
[-1] != 'c')

806  
ERR_DISCARD
;

808 
¸lf
 = 
equÆ
 + 1;

810 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

811 
¸lf
++;

813 i‡(*
¸lf
 == '\0')

814  
ERR_ERROR
;

816 i‡(
¸lf
 =
equÆ
 + 1)

817  
ERR_ERROR
;

819 
tmp
 = 
equÆ
 + 1;

820 
i
 = 
	`sdp_c⁄√˘i⁄_öô
(&
c_hódî
);

822 i‡(
i
 != 0)

823  
ERR_ERROR
;

828 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_√ây≥
), 
tmp
, ' ', &
tmp_√xt
);

830 i‡(
i
 != 0) {

831 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

835 
tmp
 = 
tmp_√xt
;

838 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addπy≥
), 
tmp
, ' ', &
tmp_√xt
);

840 i‡(
i
 != 0) {

841 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

845 
tmp
 = 
tmp_√xt
;

853 *
¶ash
 = 
	`°rchr
(
tmp
, '/');

855 i‡(
¶ash
 !
NULL
 && sœsh < 
¸lf
) {

856 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr
), 
tmp
, '/', &
tmp_√xt
);

858 i‡(
i
 != 0) {

859 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

863 
tmp
 = 
tmp_√xt
;

864 
¶ash
 = 
	`°rchr
(slash + 1, '/');

866 i‡(
¶ash
 !
NULL
 && sœsh < 
¸lf
) {

867 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr_mu…iˇ°_âl
), 
tmp
, '/', &
tmp_√xt
);

869 i‡(
i
 != 0) {

870 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

874 
tmp
 = 
tmp_√xt
;

875 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr_mu…iˇ°_öt
), 
tmp
, '\r', &
tmp_√xt
);

877 i‡(
i
 != 0) {

878 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr_mu…iˇ°_öt
), 
tmp
, '\n', &
tmp_√xt
);

880 i‡(
i
 != 0) {

881 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

887 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr_mu…iˇ°_âl
), 
tmp
, '\r', &
tmp_√xt
);

889 i‡(
i
 != 0) {

890 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr_mu…iˇ°_âl
), 
tmp
, '\n', &
tmp_√xt
);

892 i‡(
i
 != 0) {

893 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

901 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr
), 
tmp
, '\r', &
tmp_√xt
);

903 i‡(
i
 != 0) {

904 
i
 = 
	`__osù_£t_√xt_tokí
(&(
c_hódî
->
c_addr
), 
tmp
, '\n', &
tmp_√xt
);

906 i‡(
i
 != 0) {

907 
	`sdp_c⁄√˘i⁄_‰ì
(
c_hódî
);

918 
i
 = 
	`osù_li°_size
(&
sdp
->
m_medüs
);

920 i‡(
i
 == 0)

921 
sdp
->
c_c⁄√˘i⁄
 = 
c_hódî
;

924 
sdp_medü_t
 *
œ°_sdp_medü
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
i
 - 1);

926 
	`osù_li°_add
(&
œ°_sdp_medü
->
c_c⁄√˘i⁄s
, 
c_hódî
, -1);

929 i‡(
¸lf
[1] == '\n')

930 *
√xt
 = 
¸lf
 + 2;

933 *
√xt
 = 
¸lf
 + 1;

935  
OSIP_WF
;

936 
	}
}

938 
	$sdp_mesßge_∑r£_b
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

939 *
equÆ
;

940 *
¸lf
;

941 *
tmp
;

942 *
tmp_√xt
;

943 
i
;

944 
sdp_b™dwidth_t
 *
b_hódî
;

946 *
√xt
 = 
buf
;

948 
equÆ
 = 
buf
;

950 (*
equÆ
 != '=') && (*equal != '\0'))

951 
equÆ
++;

953 i‡(*
equÆ
 == '\0')

954  
ERR_ERROR
;

957 i‡(
equÆ
[-1] != 'b')

958  
ERR_DISCARD
;

960 
¸lf
 = 
equÆ
 + 1;

962 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

963 
¸lf
++;

965 i‡(*
¸lf
 == '\0')

966  
ERR_ERROR
;

968 i‡(
¸lf
 =
equÆ
 + 1)

969  
ERR_ERROR
;

971 
tmp
 = 
equÆ
 + 1;

973 
i
 = 
	`sdp_b™dwidth_öô
(&
b_hódî
);

975 i‡(
i
 != 0)

976  
ERR_ERROR
;

979 
i
 = 
	`__osù_£t_√xt_tokí
(&(
b_hódî
->
b_bwty≥
), 
tmp
, ':', &
tmp_√xt
);

981 i‡(
i
 != 0) {

982 
	`sdp_b™dwidth_‰ì
(
b_hódî
);

986 
tmp
 = 
tmp_√xt
;

988 
i
 = 
	`__osù_£t_√xt_tokí
(&(
b_hódî
->
b_b™dwidth
), 
tmp
, '\r', &
tmp_√xt
);

990 i‡(
i
 != 0) {

991 
i
 = 
	`__osù_£t_√xt_tokí
(&(
b_hódî
->
b_b™dwidth
), 
tmp
, '\n', &
tmp_√xt
);

993 i‡(
i
 != 0) {

994 
	`sdp_b™dwidth_‰ì
(
b_hódî
);

1003 
i
 = 
	`osù_li°_size
(&
sdp
->
m_medüs
);

1005 i‡(
i
 == 0)

1006 
	`osù_li°_add
(&
sdp
->
b_b™dwidths
, 
b_hódî
, -1);

1009 
sdp_medü_t
 *
œ°_sdp_medü
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
i
 - 1);

1011 
	`osù_li°_add
(&
œ°_sdp_medü
->
b_b™dwidths
, 
b_hódî
, -1);

1014 i‡(
¸lf
[1] == '\n')

1015 *
√xt
 = 
¸lf
 + 2;

1018 *
√xt
 = 
¸lf
 + 1;

1020  
OSIP_WF
;

1021 
	}
}

1023 
	$sdp_mesßge_∑r£_t
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1024 *
equÆ
;

1025 *
¸lf
;

1026 *
tmp
;

1027 *
tmp_√xt
;

1028 
i
;

1029 
sdp_time_des¸_t
 *
t_hódî
;

1031 *
√xt
 = 
buf
;

1033 
equÆ
 = 
buf
;

1035 (*
equÆ
 != '=') && (*equal != '\0'))

1036 
equÆ
++;

1038 i‡(*
equÆ
 == '\0')

1039  
ERR_ERROR
;

1042 i‡(
equÆ
[-1] != 't')

1043  
ERR_DISCARD
;

1045 
¸lf
 = 
equÆ
 + 1;

1047 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1048 
¸lf
++;

1050 i‡(*
¸lf
 == '\0')

1051  
ERR_ERROR
;

1053 i‡(
¸lf
 =
equÆ
 + 1)

1054  
ERR_ERROR
;

1056 
tmp
 = 
equÆ
 + 1;

1058 
i
 = 
	`sdp_time_des¸_öô
(&
t_hódî
);

1060 i‡(
i
 != 0)

1061  
ERR_ERROR
;

1063 
i
 = 
	`__osù_£t_√xt_tokí
(&(
t_hódî
->
t_°¨t_time
), 
tmp
, ' ', &
tmp_√xt
);

1065 i‡(
i
 != 0) {

1066 
	`sdp_time_des¸_‰ì
(
t_hódî
);

1070 
tmp
 = 
tmp_√xt
;

1072 
i
 = 
	`__osù_£t_√xt_tokí
(&(
t_hódî
->
t_°›_time
), 
tmp
, '\r', &
tmp_√xt
);

1074 i‡(
i
 != 0) {

1075 
i
 = 
	`__osù_£t_√xt_tokí
(&(
t_hódî
->
t_°›_time
), 
tmp
, '\n', &
tmp_√xt
);

1077 i‡(
i
 != 0) {

1078 
	`sdp_time_des¸_‰ì
(
t_hódî
);

1084 
	`osù_li°_add
(&
sdp
->
t_des¸s
, 
t_hódî
, -1);

1086 i‡(
¸lf
[1] == '\n')

1087 *
√xt
 = 
¸lf
 + 2;

1090 *
√xt
 = 
¸lf
 + 1;

1092  
OSIP_WF
;

1093 
	}
}

1095 
	$sdp_mesßge_∑r£_r
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1096 *
equÆ
;

1097 *
¸lf
;

1098 
ödex
;

1099 *
r_hódî
;

1100 
sdp_time_des¸_t
 *
t_des¸
;

1102 *
√xt
 = 
buf
;

1104 
equÆ
 = 
buf
;

1106 (*
equÆ
 != '=') && (*equal != '\0'))

1107 
equÆ
++;

1109 i‡(*
equÆ
 == '\0')

1110  
ERR_ERROR
;

1113 i‡(
equÆ
[-1] != 'r')

1114  
ERR_DISCARD
;

1116 
ödex
 = 
	`osù_li°_size
(&
sdp
->
t_des¸s
);

1118 i‡(
ödex
 == 0)

1119  
ERR_ERROR
;

1121 
¸lf
 = 
equÆ
 + 1;

1123 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1124 
¸lf
++;

1126 i‡(*
¸lf
 == '\0')

1127  
ERR_ERROR
;

1129 i‡(
¸lf
 =
equÆ
 + 1)

1130  
ERR_ERROR
;

1133 
r_hódî
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

1135 i‡(
r_hódî
 =
NULL
)

1136  
OSIP_NOMEM
;

1138 
	`osù_°∫˝y
(
r_hódî
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

1141 
t_des¸
 = (
sdp_time_des¸_t
 *Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
ödex
 - 1);

1142 
	`osù_li°_add
(&
t_des¸
->
r_ª≥©s
, 
r_hódî
, -1);

1144 i‡(
¸lf
[1] == '\n')

1145 *
√xt
 = 
¸lf
 + 2;

1148 *
√xt
 = 
¸lf
 + 1;

1150  
OSIP_WF
;

1151 
	}
}

1153 
	$sdp_mesßge_∑r£_z
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1154 *
equÆ
;

1155 *
¸lf
;

1156 *
z_hódî
;

1158 *
√xt
 = 
buf
;

1160 
equÆ
 = 
buf
;

1162 (*
equÆ
 != '=') && (*equal != '\0'))

1163 
equÆ
++;

1165 i‡(*
equÆ
 == '\0')

1166  
ERR_ERROR
;

1169 i‡(
equÆ
[-1] != 'z')

1170  
ERR_DISCARD
;

1172 
¸lf
 = 
equÆ
 + 1;

1174 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1175 
¸lf
++;

1177 i‡(*
¸lf
 == '\0')

1178  
ERR_ERROR
;

1180 i‡(
¸lf
 =
equÆ
 + 1)

1181  
ERR_ERROR
;

1184 
z_hódî
 = 
	`osù_mÆloc
(
¸lf
 - (
equÆ
 + 1) + 1);

1186 i‡(
z_hódî
 =
NULL
)

1187  
OSIP_NOMEM
;

1189 
	`osù_°∫˝y
(
z_hódî
, 
equÆ
 + 1, 
¸lf
 - (equal + 1));

1191 
sdp
->
z_adju°míts
 = 
z_hódî
;

1193 i‡(
¸lf
[1] == '\n')

1194 *
√xt
 = 
¸lf
 + 2;

1197 *
√xt
 = 
¸lf
 + 1;

1199  
OSIP_WF
;

1200 
	}
}

1202 
	$sdp_mesßge_∑r£_k
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1203 *
equÆ
;

1204 *
¸lf
;

1205 
i
;

1206 *
cﬁ⁄
;

1207 
sdp_key_t
 *
k_hódî
;

1208 *
tmp
;

1209 *
tmp_√xt
;

1211 *
√xt
 = 
buf
;

1213 
equÆ
 = 
buf
;

1215 (*
equÆ
 != '=') && (*equal != '\0'))

1216 
equÆ
++;

1218 i‡(*
equÆ
 == '\0')

1219  
ERR_ERROR
;

1222 i‡(
equÆ
[-1] != 'k')

1223  
ERR_DISCARD
;

1225 
¸lf
 = 
equÆ
 + 1;

1227 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1228 
¸lf
++;

1230 i‡(*
¸lf
 == '\0')

1231  
ERR_ERROR
;

1233 i‡(
¸lf
 =
equÆ
 + 1)

1234  
ERR_ERROR
;

1236 
tmp
 = 
equÆ
 + 1;

1238 
i
 = 
	`sdp_key_öô
(&
k_hódî
);

1240 i‡(
i
 != 0)

1241  
ERR_ERROR
;

1246 
cﬁ⁄
 = 
	`°rchr
(
equÆ
 + 1, ':');

1248 i‡((
cﬁ⁄
 !
NULL
Ë&& (cﬁ⁄ < 
¸lf
)) {

1250 
i
 = 
	`__osù_£t_√xt_tokí
(&(
k_hódî
->
k_keyty≥
), 
tmp
, ':', &
tmp_√xt
);

1252 i‡(
i
 != 0) {

1253 
	`sdp_key_‰ì
(
k_hódî
);

1257 
tmp
 = 
tmp_√xt
;

1259 
i
 = 
	`__osù_£t_√xt_tokí
(&(
k_hódî
->
k_keyd©a
), 
tmp
, '\r', &
tmp_√xt
);

1261 i‡(
i
 != 0) {

1262 
i
 = 
	`__osù_£t_√xt_tokí
(&(
k_hódî
->
k_keyd©a
), 
tmp
, '\n', &
tmp_√xt
);

1264 i‡(
i
 != 0) {

1265 
	`sdp_key_‰ì
(
k_hódî
);

1271 
i
 = 
	`__osù_£t_√xt_tokí
(&(
k_hódî
->
k_keyty≥
), 
tmp
, '\r', &
tmp_√xt
);

1273 i‡(
i
 != 0) {

1274 
i
 = 
	`__osù_£t_√xt_tokí
(&(
k_hódî
->
k_keyty≥
), 
tmp
, '\n', &
tmp_√xt
);

1276 i‡(
i
 != 0) {

1277 
	`sdp_key_‰ì
(
k_hódî
);

1287 
i
 = 
	`osù_li°_size
(&
sdp
->
m_medüs
);

1289 i‡(
i
 == 0)

1290 
sdp
->
k_key
 = 
k_hódî
;

1293 
sdp_medü_t
 *
œ°_sdp_medü
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
i
 - 1);

1297 i‡(
œ°_sdp_medü
->
k_key
 !
NULL
) {

1299 
	`sdp_key_‰ì
(
k_hódî
);

1303 
œ°_sdp_medü
->
k_key
 = 
k_hódî
;

1306 i‡(
¸lf
[1] == '\n')

1307 *
√xt
 = 
¸lf
 + 2;

1310 *
√xt
 = 
¸lf
 + 1;

1312  
OSIP_WF
;

1313 
	}
}

1315 
	$sdp_mesßge_∑r£_a
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1316 *
equÆ
;

1317 *
¸lf
;

1318 *
tmp
;

1319 *
tmp_√xt
;

1320 
i
;

1321 
sdp_©åibuã_t
 *
a_©åibuã
;

1322 *
cﬁ⁄
;

1324 *
√xt
 = 
buf
;

1326 
equÆ
 = 
buf
;

1328 (*
equÆ
 != '=') && (*equal != '\0'))

1329 
equÆ
++;

1331 i‡(*
equÆ
 == '\0')

1332  
ERR_ERROR
;

1335 i‡(
equÆ
[-1] != 'a')

1336  
ERR_DISCARD
;

1338 
¸lf
 = 
equÆ
 + 1;

1340 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1341 
¸lf
++;

1343 i‡(*
¸lf
 == '\0')

1344  
ERR_ERROR
;

1346 i‡(
¸lf
 =
equÆ
 + 1)

1347  
ERR_ERROR
;

1349 
tmp
 = 
equÆ
 + 1;

1351 
i
 = 
	`sdp_©åibuã_öô
(&
a_©åibuã
);

1353 i‡(
i
 != 0)

1354  
ERR_ERROR
;

1359 
cﬁ⁄
 = 
	`°rchr
(
equÆ
 + 1, ':');

1361 i‡((
cﬁ⁄
 !
NULL
Ë&& (cﬁ⁄ < 
¸lf
)) {

1363 
i
 = 
	`__osù_£t_√xt_tokí
(&(
a_©åibuã
->
a_©t_fõld
), 
tmp
, ':', &
tmp_√xt
);

1365 i‡(
i
 != 0) {

1366 
	`sdp_©åibuã_‰ì
(
a_©åibuã
);

1370 
tmp
 = 
tmp_√xt
;

1372 
i
 = 
	`__osù_£t_√xt_tokí
(&(
a_©åibuã
->
a_©t_vÆue
), 
tmp
, '\r', &
tmp_√xt
);

1374 i‡(
i
 != 0) {

1375 
i
 = 
	`__osù_£t_√xt_tokí
(&(
a_©åibuã
->
a_©t_vÆue
), 
tmp
, '\n', &
tmp_√xt
);

1377 i‡(
i
 != 0) {

1378 
	`sdp_©åibuã_‰ì
(
a_©åibuã
);

1384 
i
 = 
	`__osù_£t_√xt_tokí
(&(
a_©åibuã
->
a_©t_fõld
), 
tmp
, '\r', &
tmp_√xt
);

1386 i‡(
i
 != 0) {

1387 
i
 = 
	`__osù_£t_√xt_tokí
(&(
a_©åibuã
->
a_©t_fõld
), 
tmp
, '\n', &
tmp_√xt
);

1389 i‡(
i
 != 0) {

1390 
	`sdp_©åibuã_‰ì
(
a_©åibuã
);

1400 
i
 = 
	`osù_li°_size
(&
sdp
->
m_medüs
);

1402 i‡(
i
 == 0)

1403 
	`osù_li°_add
(&
sdp
->
a_©åibuãs
, 
a_©åibuã
, -1);

1406 
sdp_medü_t
 *
œ°_sdp_medü
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
i
 - 1);

1408 
	`osù_li°_add
(&
œ°_sdp_medü
->
a_©åibuãs
, 
a_©åibuã
, -1);

1411 i‡(
¸lf
[1] == '\n')

1412 *
√xt
 = 
¸lf
 + 2;

1415 *
√xt
 = 
¸lf
 + 1;

1417  
OSIP_WF
;

1418 
	}
}

1420 
	$sdp_mesßge_∑r£_m
(
sdp_mesßge_t
 *
sdp
, *
buf
, **
√xt
) {

1421 *
equÆ
;

1422 *
¸lf
;

1423 *
tmp
;

1424 *
tmp_√xt
;

1425 
i
;

1426 
sdp_medü_t
 *
m_hódî
;

1427 *
¶ash
;

1428 *
•a˚
;

1430 *
√xt
 = 
buf
;

1432 
equÆ
 = 
buf
;

1434 (*
equÆ
 != '=') && (*equal != '\0'))

1435 
equÆ
++;

1437 i‡(*
equÆ
 == '\0')

1438  
ERR_ERROR
;

1441 i‡(
equÆ
[-1] != 'm')

1442  
ERR_ERROR
;

1444 
¸lf
 = 
equÆ
 + 1;

1446 (*
¸lf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1447 
¸lf
++;

1449 i‡(*
¸lf
 == '\0')

1450  
ERR_ERROR
;

1452 i‡(
¸lf
 =
equÆ
 + 1)

1453  
ERR_ERROR
;

1455 
tmp
 = 
equÆ
 + 1;

1457 
i
 = 
	`sdp_medü_öô
(&
m_hódî
);

1459 i‡(
i
 != 0)

1460  
ERR_ERROR
;

1465 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_medü
), 
tmp
, ' ', &
tmp_√xt
);

1467 i‡(
i
 != 0) {

1468 
	`sdp_medü_‰ì
(
m_hódî
);

1472 
tmp
 = 
tmp_√xt
;

1474 
¶ash
 = 
	`°rchr
(
tmp
, '/');

1475 
•a˚
 = 
	`°rchr
(
tmp
, ' ');

1477 i‡(
•a˚
 =
NULL
) {

1478 
	`sdp_medü_‰ì
(
m_hódî
);

1479  
ERR_ERROR
;

1482 i‡((
¶ash
 !
NULL
Ë&& (¶ash < 
•a˚
)) {

1483 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_p‹t
), 
tmp
, '/', &
tmp_√xt
);

1485 i‡(
i
 != 0) {

1486 
	`sdp_medü_‰ì
(
m_hódî
);

1490 
tmp
 = 
tmp_√xt
;

1492 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_numbî_of_p‹t
), 
tmp
, ' ', &
tmp_√xt
);

1494 i‡(
i
 != 0) {

1495 
	`sdp_medü_‰ì
(
m_hódî
);

1499 
tmp
 = 
tmp_√xt
;

1502 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_p‹t
), 
tmp
, ' ', &
tmp_√xt
);

1504 i‡(
i
 != 0) {

1505 
	`sdp_medü_‰ì
(
m_hódî
);

1509 
tmp
 = 
tmp_√xt
;

1512 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_¥Ÿo
), 
tmp
, ' ', &
tmp_√xt
);

1514 i‡(
i
 != 0) {

1516 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_¥Ÿo
), 
tmp
, '\r', &
tmp_√xt
);

1518 i‡(
i
 != 0) {

1519 
i
 = 
	`__osù_£t_√xt_tokí
(&(
m_hódî
->
m_¥Ÿo
), 
tmp
, '\n', &
tmp_√xt
);

1521 i‡(
i
 != 0) {

1522 
	`sdp_medü_‰ì
(
m_hódî
);

1528 
tmp
 = 
tmp_√xt
;

1531 *
°r
;

1532 
m‹e_•a˚_bef‹e_¸lf
;

1534 
•a˚
 = 
	`°rchr
(
tmp
 + 1, ' ');

1536 i‡(
•a˚
 =
NULL
)

1537 
m‹e_•a˚_bef‹e_¸lf
 = 1;

1539 i‡((
•a˚
 !
NULL
Ë&& (•a˚ > 
¸lf
))

1540 
m‹e_•a˚_bef‹e_¸lf
 = 1;

1543 
m‹e_•a˚_bef‹e_¸lf
 = 0;

1545 
m‹e_•a˚_bef‹e_¸lf
 == 0) {

1546 
i
 = 
	`__osù_£t_√xt_tokí
(&
°r
, 
tmp
, ' ', &
tmp_√xt
);

1548 i‡(
i
 != 0) {

1549 
	`sdp_medü_‰ì
(
m_hódî
);

1553 
tmp
 = 
tmp_√xt
;

1554 
	`osù_li°_add
(&
m_hódî
->
m_∑ylﬂds
, 
°r
, -1);

1556 
•a˚
 = 
	`°rchr
(
tmp
 + 1, ' ');

1558 i‡(
•a˚
 =
NULL
)

1559 
m‹e_•a˚_bef‹e_¸lf
 = 1;

1561 i‡((
•a˚
 !
NULL
Ë&& (•a˚ > 
¸lf
))

1562 
m‹e_•a˚_bef‹e_¸lf
 = 1;

1565 
m‹e_•a˚_bef‹e_¸lf
 = 0;

1568 i‡(
tmp_√xt
 < 
¸lf
) {

1569 
i
 = 
	`__osù_£t_√xt_tokí
(&
°r
, 
tmp
, '\r', &
tmp_√xt
);

1571 i‡(
i
 != 0) {

1572 
i
 = 
	`__osù_£t_√xt_tokí
(&
°r
, 
tmp
, '\n', &
tmp_√xt
);

1574 i‡(
i
 != 0) {

1575 
	`sdp_medü_‰ì
(
m_hódî
);

1580 
	`osù_li°_add
(&
m_hódî
->
m_∑ylﬂds
, 
°r
, -1);

1584 
	`osù_li°_add
(&
sdp
->
m_medüs
, 
m_hódî
, -1);

1586 i‡(
¸lf
[1] == '\n')

1587 *
√xt
 = 
¸lf
 + 2;

1590 *
√xt
 = 
¸lf
 + 1;

1592  
OSIP_WF
;

1593 
	}
}

1595 
	$sdp_mesßge_∑r£
(
sdp_mesßge_t
 *
sdp
, c⁄° *
buf
) {

1609 *
√xt_buf
;

1610 *
±r
;

1611 
i
;

1613 
±r
 = (*Ë
buf
;

1615 
i
 = 
	`sdp_mesßge_∑r£_v
(
sdp
, 
±r
, &
√xt_buf
);

1617 i‡(
i
 == -1)

1620 i‡(0 =
i
)

1623 
±r
 = 
√xt_buf
;

1626 
i
 = 
	`sdp_mesßge_∑r£_s
(
sdp
, 
±r
, &
√xt_buf
);

1628 i‡(
i
 == -1)

1634 
±r
 = 
√xt_buf
;

1636 
i
 = 
	`sdp_mesßge_∑r£_o
(
sdp
, 
±r
, &
√xt_buf
);

1638 i‡(
i
 == -1)

1641 i‡(0 =
i
)

1644 
±r
 = 
√xt_buf
;

1646 i‡(
sdp
->
s_«me
 =
NULL
) {

1647 
i
 = 
	`sdp_mesßge_∑r£_s
(
sdp
, 
±r
, &
√xt_buf
);

1649 i‡(
i
 == -1)

1652 i‡(0 =
i
) {

1654 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "The \"s\"Öarameter is mandatory, butÅhisÖacket doesÇot containány! -ányway, we don't mindábout it.\n"));

1657 
±r
 = 
√xt_buf
;

1660 
i
 = 
	`sdp_mesßge_∑r£_i
(
sdp
, 
±r
, &
√xt_buf
);

1662 i‡(
i
 == -1)

1665 
±r
 = 
√xt_buf
;

1667 
i
 = 
	`sdp_mesßge_∑r£_u
(
sdp
, 
±r
, &
√xt_buf
);

1669 i‡(
i
 == -1)

1672 
±r
 = 
√xt_buf
;

1674 
i
 = 1;

1676 
i
 == 1) {

1677 
i
 = 
	`sdp_mesßge_∑r£_e
(
sdp
, 
±r
, &
√xt_buf
);

1679 i‡(
i
 == -1)

1682 
±r
 = 
√xt_buf
;

1685 
i
 = 1;

1687 
i
 == 1) {

1688 
i
 = 
	`sdp_mesßge_∑r£_p
(
sdp
, 
±r
, &
√xt_buf
);

1690 i‡(
i
 == -1)

1693 
±r
 = 
√xt_buf
;

1697 i‡(
	`osù_li°_size
(&
sdp
->
e_emaûs
Ë=0 && osù_li°_size(&sdp->
p_ph⁄es
) == 0) {

1698 
	`OSIP_TRACE
(
	`osù_åa˚
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "TheÑfc2327 saysÅhere should beátÜeastánÉmail oráÖhone header!-ányway, we don't mindábout it.\n"));

1701 
i
 = 
	`sdp_mesßge_∑r£_c
(
sdp
, 
±r
, &
√xt_buf
);

1703 i‡(
i
 == -1)

1706 
±r
 = 
√xt_buf
;

1708 
i
 = 1;

1710 
i
 == 1) {

1711 
i
 = 
	`sdp_mesßge_∑r£_b
(
sdp
, 
±r
, &
√xt_buf
);

1713 i‡(
i
 == -1)

1716 
±r
 = 
√xt_buf
;

1720 
i
 = 
	`sdp_mesßge_∑r£_t
(
sdp
, 
±r
, &
√xt_buf
);

1722 i‡(
i
 == -1)

1725 i‡(
i
 =
ERR_DISCARD
)

1728 
±r
 = 
√xt_buf
;

1730 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1731  
OSIP_SUCCESS
;

1733 
i
 = 1;

1735 
i
 == 1) {

1736 
i
 = 
	`sdp_mesßge_∑r£_r
(
sdp
, 
±r
, &
√xt_buf
);

1738 i‡(
i
 == -1)

1741 
±r
 = 
√xt_buf
;

1743 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1744  
OSIP_SUCCESS
;

1748 
m‹e_t_hódî
 = 1;

1750 
i
 = 
	`sdp_mesßge_∑r£_t
(
sdp
, 
±r
, &
√xt_buf
);

1752 i‡(
i
 == -1)

1755 
±r
 = 
√xt_buf
;

1757 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1758  
OSIP_SUCCESS
;

1760 
m‹e_t_hódî
 == 1) {

1761 
i
 = 1;

1763 
i
 == 1) {

1764 
i
 = 
	`sdp_mesßge_∑r£_r
(
sdp
, 
±r
, &
√xt_buf
);

1766 i‡(
i
 == -1)

1769 
±r
 = 
√xt_buf
;

1771 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1772  
OSIP_SUCCESS
;

1775 
i
 = 
	`sdp_mesßge_∑r£_t
(
sdp
, 
±r
, &
√xt_buf
);

1777 i‡(
i
 == -1)

1780 i‡(
i
 =
ERR_DISCARD
)

1781 
m‹e_t_hódî
 = 0;

1784 
m‹e_t_hódî
 = 1;

1786 
±r
 = 
√xt_buf
;

1788 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1789  
OSIP_SUCCESS
;

1793 
i
 = 
	`sdp_mesßge_∑r£_z
(
sdp
, 
±r
, &
√xt_buf
);

1795 i‡(
i
 == -1)

1798 
±r
 = 
√xt_buf
;

1800 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1801  
OSIP_SUCCESS
;

1803 
i
 = 
	`sdp_mesßge_∑r£_k
(
sdp
, 
±r
, &
√xt_buf
);

1805 i‡(
i
 == -1)

1808 
±r
 = 
√xt_buf
;

1810 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1811  
OSIP_SUCCESS
;

1814 
i
 = 1;

1816 
i
 == 1) {

1817 
i
 = 
	`sdp_mesßge_∑r£_a
(
sdp
, 
±r
, &
√xt_buf
);

1819 i‡(
i
 == -1)

1822 
±r
 = 
√xt_buf
;

1824 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1825  
OSIP_SUCCESS
;

1830 
m‹e_m_hódî
 = 1;

1832 
m‹e_m_hódî
 == 1) {

1833 
m‹e_m_hódî
 = 
	`sdp_mesßge_∑r£_m
(
sdp
, 
±r
, &
√xt_buf
);

1835 i‡(
m‹e_m_hódî
 == -1)

1838 
±r
 = 
√xt_buf
;

1840 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1841  
OSIP_SUCCESS
;

1843 
i
 = 
	`sdp_mesßge_∑r£_i
(
sdp
, 
±r
, &
√xt_buf
);

1845 i‡(
i
 == -1)

1848 
±r
 = 
√xt_buf
;

1850 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1851  
OSIP_SUCCESS
;

1853 
i
 = 1;

1855 
i
 == 1) {

1856 
i
 = 
	`sdp_mesßge_∑r£_c
(
sdp
, 
±r
, &
√xt_buf
);

1858 i‡(
i
 == -1)

1861 
±r
 = 
√xt_buf
;

1863 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1864  
OSIP_SUCCESS
;

1867 
i
 = 1;

1869 
i
 == 1) {

1870 
i
 = 
	`sdp_mesßge_∑r£_b
(
sdp
, 
±r
, &
√xt_buf
);

1872 i‡(
i
 == -1)

1875 
±r
 = 
√xt_buf
;

1877 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1878  
OSIP_SUCCESS
;

1881 
i
 = 
	`sdp_mesßge_∑r£_k
(
sdp
, 
±r
, &
√xt_buf
);

1883 i‡(
i
 == -1)

1886 
±r
 = 
√xt_buf
;

1888 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1889  
OSIP_SUCCESS
;

1892 
i
 = 1;

1894 
i
 == 1) {

1895 
i
 = 
	`sdp_mesßge_∑r£_a
(
sdp
, 
±r
, &
√xt_buf
);

1897 i‡(
i
 == -1)

1900 
±r
 = 
√xt_buf
;

1902 i‡(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1903  
OSIP_SUCCESS
;

1908  
OSIP_SUCCESS
;

1909 
	}
}

1911 
	$sdp_≠≥nd_c⁄√˘i⁄
(**
°rög
, *
size
, *
tmp
, 
sdp_c⁄√˘i⁄_t
 *
c⁄n
, **
√xt_tmp
) {

1912 i‡(
c⁄n
->
c_√ây≥
 =
NULL
)

1915 i‡(
c⁄n
->
c_addπy≥
 =
NULL
)

1918 i‡(
c⁄n
->
c_addr
 =
NULL
)

1921 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "c=");

1922 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
c⁄n
->
c_√ây≥
);

1923 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

1924 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
c⁄n
->
c_addπy≥
);

1925 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

1926 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
c⁄n
->
c_addr
);

1928 i‡(
c⁄n
->
c_addr_mu…iˇ°_âl
 !
NULL
) {

1929 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "/");

1930 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
c⁄n
->
c_addr_mu…iˇ°_âl
);

1933 i‡(
c⁄n
->
c_addr_mu…iˇ°_öt
 !
NULL
) {

1934 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "/");

1935 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
c⁄n
->
c_addr_mu…iˇ°_öt
);

1938 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

1939 *
√xt_tmp
 = 
tmp
;

1940  
OSIP_SUCCESS
;

1941 
	}
}

1943 
	$sdp_≠≥nd_b™dwidth
(**
°rög
, *
size
, *
tmp
, 
sdp_b™dwidth_t
 *
b™dwidth
, **
√xt_tmp
) {

1944 i‡(
b™dwidth
->
b_bwty≥
 =
NULL
)

1947 i‡(
b™dwidth
->
b_b™dwidth
 =
NULL
)

1950 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "b=");

1951 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
b™dwidth
->
b_bwty≥
);

1952 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, ":");

1953 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
b™dwidth
->
b_b™dwidth
);

1954 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

1956 *
√xt_tmp
 = 
tmp
;

1957  
OSIP_SUCCESS
;

1958 
	}
}

1960 
	$sdp_≠≥nd_time_des¸
(**
°rög
, *
size
, *
tmp
, 
sdp_time_des¸_t
 *
time_des¸
, **
√xt_tmp
) {

1961 
pos
;

1963 i‡(
time_des¸
->
t_°¨t_time
 =
NULL
)

1966 i‡(
time_des¸
->
t_°›_time
 =
NULL
)

1969 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "t=");

1970 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
time_des¸
->
t_°¨t_time
);

1971 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

1972 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
time_des¸
->
t_°›_time
);

1974 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

1976 
pos
 = 0;

1978 !
	`osù_li°_eﬁ
(&
time_des¸
->
r_ª≥©s
, 
pos
)) {

1979 *
°r
 = (*Ë
	`osù_li°_gë
(&
time_des¸
->
r_ª≥©s
, 
pos
);

1981 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "r=");

1982 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
°r
);

1983 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

1984 
pos
++;

1987 *
√xt_tmp
 = 
tmp
;

1988  
OSIP_SUCCESS
;

1989 
	}
}

1991 
	$sdp_≠≥nd_key
(**
°rög
, *
size
, *
tmp
, 
sdp_key_t
 *
key
, **
√xt_tmp
) {

1992 i‡(
key
->
k_keyty≥
 =
NULL
)

1995 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "k=");

1996 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
key
->
k_keyty≥
);

1998 i‡(
key
->
k_keyd©a
 !
NULL
) {

1999 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, ":");

2000 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
key
->
k_keyd©a
);

2003 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

2004 *
√xt_tmp
 = 
tmp
;

2005  
OSIP_SUCCESS
;

2006 
	}
}

2008 
	$sdp_≠≥nd_©åibuã
(**
°rög
, *
size
, *
tmp
, 
sdp_©åibuã_t
 *
©åibuã
, **
√xt_tmp
) {

2009 i‡(
©åibuã
->
a_©t_fõld
 =
NULL
)

2012 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "a=");

2013 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
©åibuã
->
a_©t_fõld
);

2015 i‡(
©åibuã
->
a_©t_vÆue
 !
NULL
) {

2016 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, ":");

2017 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
©åibuã
->
a_©t_vÆue
);

2020 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

2022 *
√xt_tmp
 = 
tmp
;

2023  
OSIP_SUCCESS
;

2024 
	}
}

2027 
	$sdp_≠≥nd_medü
(**
°rög
, *
size
, *
tmp
, 
sdp_medü_t
 *
medü
, **
√xt_tmp
) {

2028 
pos
;

2030 i‡(
medü
->
m_medü
 =
NULL
)

2033 i‡(
medü
->
m_p‹t
 =
NULL
)

2036 i‡(
medü
->
m_¥Ÿo
 =
NULL
)

2039 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "m=");

2040 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
medü
->
m_medü
);

2041 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

2042 i‡(
medü
->
m_p‹t
[0] == '0')

2043 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "0");

2045 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
medü
->
m_p‹t
);

2047 i‡(
medü
->
m_numbî_of_p‹t
 !
NULL
) {

2048 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "/");

2049 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
medü
->
m_numbî_of_p‹t
);

2052 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

2053 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
medü
->
m_¥Ÿo
);

2054 
pos
 = 0;

2056 !
	`osù_li°_eﬁ
(&
medü
->
m_∑ylﬂds
, 
pos
)) {

2057 *
°r
 = (*Ë
	`osù_li°_gë
(&
medü
->
m_∑ylﬂds
, 
pos
);

2059 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, " ");

2060 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
°r
);

2061 
pos
++;

2064 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

2066 i‡(
medü
->
i_öfo
 !
NULL
) {

2067 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, "i=");

2068 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
medü
->
i_öfo
);

2069 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(
°rög
, 
size
,Åmp, 
OSIP_CRLF
);

2072 
pos
 = 0;

2074 !
	`osù_li°_eﬁ
(&
medü
->
c_c⁄√˘i⁄s
, 
pos
)) {

2075 
sdp_c⁄√˘i⁄_t
 *
c⁄n
 = (sdp_c⁄√˘i⁄_à*Ë
	`osù_li°_gë
(&
medü
->
c_c⁄√˘i⁄s
, 
pos
);

2076 *
√xt_tmp2
;

2077 
i
;

2079 
i
 = 
	`sdp_≠≥nd_c⁄√˘i⁄
(
°rög
, 
size
, 
tmp
, 
c⁄n
, &
√xt_tmp2
);

2081 i‡(
i
 != 0)

2084 
tmp
 = 
√xt_tmp2
;

2085 
pos
++;

2088 
pos
 = 0;

2090 !
	`osù_li°_eﬁ
(&
medü
->
b_b™dwidths
, 
pos
)) {

2091 
sdp_b™dwidth_t
 *
b™d
 = (sdp_b™dwidth_à*Ë
	`osù_li°_gë
(&
medü
->
b_b™dwidths
, 
pos
);

2092 *
√xt_tmp2
;

2093 
i
;

2095 
i
 = 
	`sdp_≠≥nd_b™dwidth
(
°rög
, 
size
, 
tmp
, 
b™d
, &
√xt_tmp2
);

2097 i‡(
i
 != 0)

2100 
tmp
 = 
√xt_tmp2
;

2101 
pos
++;

2104 i‡(
medü
->
k_key
 !
NULL
) {

2105 *
√xt_tmp2
;

2106 
i
;

2108 
i
 = 
	`sdp_≠≥nd_key
(
°rög
, 
size
, 
tmp
, 
medü
->
k_key
, &
√xt_tmp2
);

2110 i‡(
i
 != 0)

2113 
tmp
 = 
√xt_tmp2
;

2116 
pos
 = 0;

2118 !
	`osù_li°_eﬁ
(&
medü
->
a_©åibuãs
, 
pos
)) {

2119 
sdp_©åibuã_t
 *
©å
 = (sdp_©åibuã_à*Ë
	`osù_li°_gë
(&
medü
->
a_©åibuãs
, 
pos
);

2120 *
√xt_tmp2
;

2121 
i
;

2123 
i
 = 
	`sdp_≠≥nd_©åibuã
(
°rög
, 
size
, 
tmp
, 
©å
, &
√xt_tmp2
);

2125 i‡(
i
 != 0)

2128 
tmp
 = 
√xt_tmp2
;

2129 
pos
++;

2132 *
√xt_tmp
 = 
tmp
;

2133  
OSIP_SUCCESS
;

2134 
	}
}

2136 
	$sdp_mesßge_to_°r
(
sdp_mesßge_t
 *
sdp
, **
de°
) {

2137 
size
;

2138 
pos
;

2139 *
tmp
;

2140 *
°rög
;

2142 *
de°
 = 
NULL
;

2144 i‡(!
sdp
 || sdp->
v_vîsi⁄
 =
NULL
)

2147 i‡(
sdp
->
o_u£∫ame
 =
NULL
 || sdp->
o_£ss_id
 =NULL || sdp->
o_£ss_vîsi⁄
 =NULL || sdp->
o_√ây≥
 =NULL || sdp->
o_addπy≥
 =NULL || sdp->
o_addr
 == NULL)

2157 
size
 = 
BODY_MESSAGE_MAX_SIZE
;

2158 
tmp
 = (*Ë
	`osù_mÆloc
(
size
);

2160 i‡(
tmp
 =
NULL
)

2161  
OSIP_NOMEM
;

2163 
°rög
 = 
tmp
;

2165 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "v=");

2166 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
v_vîsi⁄
);

2167 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2168 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "o=");

2169 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_u£∫ame
);

2170 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, " ");

2171 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_£ss_id
);

2172 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, " ");

2173 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_£ss_vîsi⁄
);

2174 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, " ");

2175 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_√ây≥
);

2176 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, " ");

2177 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_addπy≥
);

2178 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, " ");

2179 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
o_addr
);

2180 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2182 i‡(
sdp
->
s_«me
 !
NULL
) {

2183 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "s=");

2184 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
s_«me
);

2185 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2188 i‡(
sdp
->
i_öfo
 !
NULL
) {

2189 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "i=");

2190 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
i_öfo
);

2191 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2194 i‡(
sdp
->
u_uri
 !
NULL
) {

2195 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "u=");

2196 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
u_uri
);

2197 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2200 
pos
 = 0;

2202 !
	`osù_li°_eﬁ
(&
sdp
->
e_emaûs
, 
pos
)) {

2203 *
emaû
 = (*Ë
	`osù_li°_gë
(&
sdp
->
e_emaûs
, 
pos
);

2205 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "e=");

2206 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
emaû
);

2207 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2208 
pos
++;

2211 
pos
 = 0;

2213 !
	`osù_li°_eﬁ
(&
sdp
->
p_ph⁄es
, 
pos
)) {

2214 *
ph⁄e
 = (*Ë
	`osù_li°_gë
(&
sdp
->
p_ph⁄es
, 
pos
);

2216 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "p=");

2217 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
ph⁄e
);

2218 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2219 
pos
++;

2222 i‡(
sdp
->
c_c⁄√˘i⁄
 !
NULL
) {

2223 *
√xt_tmp
;

2224 
i
;

2226 
i
 = 
	`sdp_≠≥nd_c⁄√˘i⁄
(&
°rög
, &
size
, 
tmp
, 
sdp
->
c_c⁄√˘i⁄
, &
√xt_tmp
);

2228 i‡(
i
 != 0) {

2229 
	`osù_‰ì
(
°rög
);

2233 
tmp
 = 
√xt_tmp
;

2236 
pos
 = 0;

2238 !
	`osù_li°_eﬁ
(&
sdp
->
b_b™dwidths
, 
pos
)) {

2239 
sdp_b™dwidth_t
 *
hódî
 = (sdp_b™dwidth_à*Ë
	`osù_li°_gë
(&
sdp
->
b_b™dwidths
, 
pos
);

2240 *
√xt_tmp
;

2241 
i
;

2243 
i
 = 
	`sdp_≠≥nd_b™dwidth
(&
°rög
, &
size
, 
tmp
, 
hódî
, &
√xt_tmp
);

2245 i‡(
i
 != 0) {

2246 
	`osù_‰ì
(
°rög
);

2250 
tmp
 = 
√xt_tmp
;

2251 
pos
++;

2254 
pos
 = 0;

2256 !
	`osù_li°_eﬁ
(&
sdp
->
t_des¸s
, 
pos
)) {

2257 
sdp_time_des¸_t
 *
hódî
 = (sdp_time_des¸_à*Ë
	`osù_li°_gë
(&
sdp
->
t_des¸s
, 
pos
);

2258 *
√xt_tmp
;

2259 
i
;

2261 
i
 = 
	`sdp_≠≥nd_time_des¸
(&
°rög
, &
size
, 
tmp
, 
hódî
, &
√xt_tmp
);

2263 i‡(
i
 != 0) {

2264 
	`osù_‰ì
(
°rög
);

2268 
tmp
 = 
√xt_tmp
;

2269 
pos
++;

2272 i‡(
sdp
->
z_adju°míts
 !
NULL
) {

2273 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, "z=");

2274 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
sdp
->
z_adju°míts
);

2275 
tmp
 = 
	`__osù_sdp_≠≥nd_°rög
(&
°rög
, &
size
,Åmp, 
OSIP_CRLF
);

2278 i‡(
sdp
->
k_key
 !
NULL
) {

2279 *
√xt_tmp
;

2280 
i
;

2282 
i
 = 
	`sdp_≠≥nd_key
(&
°rög
, &
size
, 
tmp
, 
sdp
->
k_key
, &
√xt_tmp
);

2284 i‡(
i
 != 0) {

2285 
	`osù_‰ì
(
°rög
);

2289 
tmp
 = 
√xt_tmp
;

2292 
pos
 = 0;

2294 !
	`osù_li°_eﬁ
(&
sdp
->
a_©åibuãs
, 
pos
)) {

2295 
sdp_©åibuã_t
 *
hódî
 = (sdp_©åibuã_à*Ë
	`osù_li°_gë
(&
sdp
->
a_©åibuãs
, 
pos
);

2296 *
√xt_tmp
;

2297 
i
;

2299 
i
 = 
	`sdp_≠≥nd_©åibuã
(&
°rög
, &
size
, 
tmp
, 
hódî
, &
√xt_tmp
);

2301 i‡(
i
 != 0) {

2302 
	`osù_‰ì
(
°rög
);

2306 
tmp
 = 
√xt_tmp
;

2307 
pos
++;

2310 
pos
 = 0;

2312 !
	`osù_li°_eﬁ
(&
sdp
->
m_medüs
, 
pos
)) {

2313 
sdp_medü_t
 *
hódî
 = (sdp_medü_à*Ë
	`osù_li°_gë
(&
sdp
->
m_medüs
, 
pos
);

2314 *
√xt_tmp
;

2315 
i
;

2317 
i
 = 
	`sdp_≠≥nd_medü
(&
°rög
, &
size
, 
tmp
, 
hódî
, &
√xt_tmp
);

2319 i‡(
i
 != 0) {

2320 
	`osù_‰ì
(
°rög
);

2324 
tmp
 = 
√xt_tmp
;

2325 
pos
++;

2328 *
de°
 = 
°rög
;

2329  
OSIP_SUCCESS
;

2330 
	}
}

2332 
	$sdp_mesßge_‰ì
(
sdp_mesßge_t
 *
sdp
) {

2333 i‡(
sdp
 =
NULL
)

2336 
	`osù_‰ì
(
sdp
->
v_vîsi⁄
);

2337 
	`osù_‰ì
(
sdp
->
o_u£∫ame
);

2338 
	`osù_‰ì
(
sdp
->
o_£ss_id
);

2339 
	`osù_‰ì
(
sdp
->
o_£ss_vîsi⁄
);

2340 
	`osù_‰ì
(
sdp
->
o_√ây≥
);

2341 
	`osù_‰ì
(
sdp
->
o_addπy≥
);

2342 
	`osù_‰ì
(
sdp
->
o_addr
);

2343 
	`osù_‰ì
(
sdp
->
s_«me
);

2344 
	`osù_‰ì
(
sdp
->
i_öfo
);

2345 
	`osù_‰ì
(
sdp
->
u_uri
);

2347 
	`osù_li°_ofch¨_‰ì
(&
sdp
->
e_emaûs
);

2349 
	`osù_li°_ofch¨_‰ì
(&
sdp
->
p_ph⁄es
);

2351 
	`sdp_c⁄√˘i⁄_‰ì
(
sdp
->
c_c⁄√˘i⁄
);

2353 
	`osù_li°_•ecül_‰ì
(&
sdp
->
b_b™dwidths
, ((*)(*)Ë& 
sdp_b™dwidth_‰ì
);

2355 
	`osù_li°_•ecül_‰ì
(&
sdp
->
t_des¸s
, ((*)(*)Ë& 
sdp_time_des¸_‰ì
);

2357 
	`osù_‰ì
(
sdp
->
z_adju°míts
);

2358 
	`sdp_key_‰ì
(
sdp
->
k_key
);

2360 
	`osù_li°_•ecül_‰ì
(&
sdp
->
a_©åibuãs
, ((*)(*)Ë& 
sdp_©åibuã_‰ì
);

2362 
	`osù_li°_•ecül_‰ì
(&
sdp
->
m_medüs
, ((*)(*)Ë& 
sdp_medü_‰ì
);

2364 
	`osù_‰ì
(
sdp
);

2365 
	}
}

2367 
	$sdp_mesßge_˛⁄e
(
sdp_mesßge_t
 *
sdp
, sdp_mesßge_à**
de°
) {

2368 
i
;

2369 *
body
;

2371 
i
 = 
	`sdp_mesßge_öô
(
de°
);

2373 i‡(
i
 != 0)

2376 
i
 = 
	`sdp_mesßge_to_°r
(
sdp
, &
body
);

2378 i‡(
i
 != 0)

2379 
îr‹_sc1
;

2381 
i
 = 
	`sdp_mesßge_∑r£
(*
de°
, 
body
);

2382 
	`osù_‰ì
(
body
);

2384 i‡(
i
 != 0)

2385 
îr‹_sc1
;

2387  
OSIP_SUCCESS
;

2389 
îr‹_sc1
:

2390 
	`sdp_mesßge_‰ì
(*
de°
);

2392 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcallid.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
ˇŒids_fûe
;

31 
osù_ˇŒ_id_t
 *
ˇŒid
;

32 *
a_ˇŒid
;

33 *
de°
;

34 *
ªs
;

36 
ˇŒids_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
ˇŒids_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:ÅˇŒid cÆlids.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_ˇŒid
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_ˇŒid
, 200, 
ˇŒids_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_ˇŒid
 + 
	`°æí
(a_callid) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_ˇŒid
, "#", 1)) {

54 
	`osù_ˇŒ_id_öô
(&
ˇŒid
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("CALLID TO PARSE: |%s|\n", 
a_ˇŒid
);

57 
îrcode
 = 
	`osù_ˇŒ_id_∑r£
(
ˇŒid
, 
a_ˇŒid
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_ˇŒ_id_to_°r
(
ˇŒid
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("Bad cÆlid f‹m©: %s\n", 
a_ˇŒid
);

68 
	`osù_ˇŒ_id_‰ì
(
ˇŒid
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_ˇŒid
, 200, 
ˇŒids_fûe
);

75 
	`osù_‰ì
(
a_ˇŒid
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontact.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
c⁄è˘s_fûe
;

31 
osù_c⁄è˘_t
 *
c⁄è˘
;

32 *
a_c⁄è˘
;

33 *
de°
;

34 *
ªs
;

36 
c⁄è˘s_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
c⁄è˘s_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åc⁄è˘ c⁄è˘s.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_c⁄è˘
 = (*Ë
	`osù_mÆloc
(500);

44 
ªs
 = 
	`fgës
(
a_c⁄è˘
, 500, 
c⁄è˘s_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_c⁄è˘
 + 
	`°æí
(a_contact) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_c⁄è˘
, "#", 1)) {

54 
	`osù_c⁄è˘_öô
(&
c⁄è˘
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("CONTACT TO PARSE: |%s|\n", 
a_c⁄è˘
);

57 
îrcode
 = 
	`osù_c⁄è˘_∑r£
(
c⁄è˘
, 
a_c⁄è˘
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_c⁄è˘_to_°r
(
c⁄è˘
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

64 
pos
 = 0;

65 
osù_gíîic_∑øm_t
 *
u_∑øm
;

67 !
	`osù_li°_eﬁ
(&
c⁄è˘
->
gí_∑øms
, 
pos
)) {

68 
u_∑øm
 = (
osù_gíîic_∑øm_t
 *Ë
	`osù_li°_gë
(&
c⁄è˘
->
gí_∑øms
, 
pos
);

70 i‡(
u_∑øm
->
gvÆue
 =
NULL
)

71 
	`¥ötf
("ªsu…: ;%s\n", 
u_∑øm
->
g«me
);

74 
	`¥ötf
("ªsu…: ;%s=%s\n", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

76 
pos
++;

80 
	`osù_‰ì
(
de°
);

84 
	`¥ötf
("Bad c⁄è˘ f‹m©: %s\n", 
a_c⁄è˘
);

86 
	`osù_c⁄è˘_‰ì
(
c⁄è˘
);

87 
	`¥ötf
("=================================================\n");

90 
ªs
 = 
	`fgës
(
a_c⁄è˘
, 500, 
c⁄è˘s_fûe
);

93 
	`osù_‰ì
(
a_c⁄è˘
);

95 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontentt.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
c⁄ã¡_ty≥s_fûe
;

31 
osù_c⁄ã¡_ty≥_t
 *
c⁄ã¡_ty≥
;

32 *
a_c⁄ã¡_ty≥
;

33 *
de°
;

34 *
ªs
;

36 
c⁄ã¡_ty≥s_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
c⁄ã¡_ty≥s_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åc⁄ã¡_ty≥ c⁄ã¡_ty≥s.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_c⁄ã¡_ty≥
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_c⁄ã¡_ty≥
, 200, 
c⁄ã¡_ty≥s_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_c⁄ã¡_ty≥
 + 
	`°æí
(a_content_type) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_c⁄ã¡_ty≥
, "#", 1)) {

54 
	`osù_c⁄ã¡_ty≥_öô
(&
c⁄ã¡_ty≥
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("CONTENT_TYPE TO PARSE: |%s|\n", 
a_c⁄ã¡_ty≥
);

57 
îrcode
 = 
	`osù_c⁄ã¡_ty≥_∑r£
(
c⁄ã¡_ty≥
, 
a_c⁄ã¡_ty≥
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_c⁄ã¡_ty≥_to_°r
(
c⁄ã¡_ty≥
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("Bad c⁄ã¡_ty≥ f‹m©: %s\n", 
a_c⁄ã¡_ty≥
);

68 
	`osù_c⁄ã¡_ty≥_‰ì
(
c⁄ã¡_ty≥
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_c⁄ã¡_ty≥
, 200, 
c⁄ã¡_ty≥s_fûe
);

75 
	`osù_‰ì
(
a_c⁄ã¡_ty≥
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tfrom.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
‰oms_fûe
;

31 
osù_‰om_t
 *
‰om
;

32 *
a_‰om
;

33 *
de°
;

34 *
ªs
;

36 
‰oms_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
‰oms_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Å‰om froms.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_‰om
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_‰om
, 200, 
‰oms_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_‰om
 + 
	`°æí
(a_from) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_‰om
, "#", 1)) {

54 
	`osù_‰om_öô
(&
‰om
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("FROM TO PARSE: |%s|\n", 
a_‰om
);

57 
îrcode
 = 
	`osù_‰om_∑r£
(
‰om
, 
a_‰om
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_‰om_to_°r
(
‰om
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("Bad from f‹m©: %s\n", 
a_‰om
);

68 
	`osù_‰om_‰ì
(
‰om
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_‰om
, 200, 
‰oms_fûe
);

75 
	`osù_‰ì
(
a_‰om
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/torture.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_∑r£r.h
>

27 
	~<osù∑r£r2/sdp_mesßge.h
>

29 
ã°_mesßge
(*
msg
, 
size_t
 
Àn
, 
vîbo£
, 
˛⁄e
, 
≥rf
);

30 
ußge
();

32 
	$ußge
() {

33 
	`Ârötf
(
°dîr
, "Usage: ./torture_testÅorture_file [-v (verbose)] [-c (clone)] [-p (performance:Üoop 100.000]\n");

34 
	`exô
(1);

35 
	}
}

37 
	$ªad_bö¨y
(**
msg
, *
Àn
, 
FILE
 *
t‹tuª_fûe
) {

38 *
msg
 = (*Ë
	`osù_mÆloc
(100000);

40 *
Àn
 = 
	`‰ód
(*
msg
, 1, 100000, 
t‹tuª_fûe
);

41  
	`„º‹
(
t‹tuª_fûe
) ? -1 : 0;

42 
	}
}

44 
	$maö
(
¨gc
, **
¨gv
) {

45 
suc˚ss
 = 1;

46 
lo›
 = 1;

47 
vîbo£
 = 0;

48 
˛⁄e
 = 0;

49 
FILE
 *
t‹tuª_fûe
;

50 *
msg
;

51 *
±r
;

52 
pos
;

53 
Àn
;

54 
ex≥˘ed_îr‹
 = 
OSIP_SUCCESS
;

56 
pos
 = 2;Öo†< 
¨gc
;Öos++) {

57 i‡(0 =
	`°∫cmp
(
¨gv
[
pos
], "-v", 2))

58 
vîbo£
 = 1;

60 i‡(0 =
	`°∫cmp
(
¨gv
[
pos
], "-c", 2))

61 
˛⁄e
 = 1;

63 i‡(0 =
	`°∫cmp
(
¨gv
[
pos
], "-p", 2))

64 
lo›
 = 100000;

67 
	`ußge
();

70 i‡(
¨gc
 < 2) {

71 
	`ußge
();

74 
t‹tuª_fûe
 = 
	`f›í
(
¨gv
[1], "r");

76 i‡(
t‹tuª_fûe
 =
NULL
) {

77 
	`ußge
();

81 
	`∑r£r_öô
();

83 i‡(
	`ªad_bö¨y
(&
msg
, &
Àn
, 
t‹tuª_fûe
) < 0) {

84 
	`Ârötf
(
°dout
, "ã° %†: ===========================FAILED (ˇ¬ŸÑód fûe)\n", 
¨gv
[1]);

88 
±r
 = 
msg
;

90 i‡(
	`osù_°∫ˇ£cmp
(
msg
, "ex≥˘ed_îr‹:", 
	`°æí
("expected_error:")) == 0) {

91 
±r
 +
	`°æí
("expected_error:");

92 
Àn
 -
	`°æí
("expected_error:");

93 
ex≥˘ed_îr‹
 = 
	`©oi
(
±r
);

95 *
±r
 != '\r' && *ptr != '\n') {

96 
±r
++;

97 
Àn
--;

100 *
±r
 == '\r' || *ptr == '\n') {

101 
±r
++;

102 
Àn
--;

106 
suc˚ss
 = 
	`ã°_mesßge
(
±r
, 
Àn
, 
vîbo£
, 
˛⁄e
, 
lo›
);

108 i‡(
vîbo£
) {

109 
	`Ârötf
(
°dout
, "ã° %†: ===========================\n", 
¨gv
[1]);

110 
	`fwrôe
(
msg
, 1, 
Àn
, 
°dout
);

113 i‡(
suc˚ss
 =
ex≥˘ed_îr‹
)

114 
	`Ârötf
(
°dout
, "ã° %†: ===========================OK (îr‹_code=%i)\n", 
¨gv
[1], 
ex≥˘ed_îr‹
);

117 
	`Ârötf
(
°dout
, "ã° %†: ===========================FAILED (ex≥˘ed=%òîr‹_code=%i)\n", 
¨gv
[1], 
ex≥˘ed_îr‹
, 
suc˚ss
);

119 
	`osù_‰ì
(
msg
);

120 
	`f˛o£
(
t‹tuª_fûe
);

121 #ifde‡
__löux


123 i‡(
suc˚ss
 !
ex≥˘ed_îr‹
)

124 
	`exô
(
EXIT_FAILURE
);

127 
	`exô
(
EXIT_SUCCESS
);

130  
suc˚ss
;

131 
	}
}

133 
	$ã°_mesßge
(*
msg
, 
size_t
 
Àn
, 
vîbo£
, 
˛⁄e
, 
≥rf
) {

134 
osù_mesßge_t
 *
sù
;

135 
îr
 = 0;

136 *
ªsu…
;

138 
j
 = 
≥rf
;

140 i‡(
vîbo£
)

141 
	`Ârötf
(
°dout
, "Tryög %ò£quítül†ˇŒ†tÿosù_mesßge_öô(), osù_mesßge_∑r£(Ë™d osù_mesßge_‰ì()\n", 
j
);

143 
j
 != 0) {

144 
j
--;

145 
	`osù_mesßge_öô
(&
sù
);

146 
îr
 = 
	`osù_mesßge_∑r£
(
sù
, 
msg
, 
Àn
);

148 i‡(
îr
 != 0) {

149 i‡(
vîbo£
)

150 
	`Ârötf
(
°dout
, "ERROR: failed whileÖarsing!\n");

152 
	`osù_mesßge_‰ì
(
sù
);

153  
îr
;

156 
	`osù_mesßge_‰ì
(
sù
);

159 
	`osù_mesßge_öô
(&
sù
);

160 
îr
 = 
	`osù_mesßge_∑r£
(
sù
, 
msg
, 
Àn
);

162 i‡(
îr
 != 0) {

163 i‡(
vîbo£
)

164 
	`Ârötf
(
°dout
, "ERROR: failed whileÖarsing!\n");

166 
	`osù_mesßge_‰ì
(
sù
);

167  
îr
;

170 
size_t
 
Àngth
;

173 
sdp_mesßge_t
 *
sdp
;

174 
osù_body_t
 *
ﬁdbody
;

175 
pos
;

177 
pos
 = 0;

179 !
	`osù_li°_eﬁ
(&
sù
->
bodõs
, 
pos
)) {

180 
ﬁdbody
 = (
osù_body_t
 *Ë
	`osù_li°_gë
(&
sù
->
bodõs
, 
pos
);

181 
pos
++;

182 
	`sdp_mesßge_öô
(&
sdp
);

183 
îr
 = 
	`sdp_mesßge_∑r£
(
sdp
, 
ﬁdbody
->
body
);

184 
	`sdp_mesßge_‰ì
(
sdp
);

185 
sdp
 = 
NULL
;

187 i‡(
îr
 != 0) {

188 i‡(
vîbo£
)

189 
	`Ârötf
(
°dout
, "ERROR: Bad SDP!\n");

193 } i‡(
vîbo£
)

194 
	`Ârötf
(
°dout
, "SUCCESS: Correct SDP!\n");

199 
	`osù_mesßge_f‹˚_upd©e
(
sù
);

200 
îr
 = 
	`osù_mesßge_to_°r
(
sù
, &
ªsu…
, &
Àngth
);

202 i‡(
îr
 !
OSIP_SUCCESS
) {

203 i‡(
vîbo£
)

204 
	`Ârötf
(
°dout
, "ERROR: failed whileÖrinting message!\n");

206 
	`osù_mesßge_‰ì
(
sù
);

207  
îr
;

210 i‡(
vîbo£
)

211 
	`fwrôe
(
ªsu…
, 1, 
Àngth
, 
°dout
);

213 i‡(
˛⁄e
) {

214 
j
 = 
≥rf
;

216 i‡(
vîbo£
)

217 
	`Ârötf
(
°dout
, "Tryög %ò£quítül†ˇŒ†tÿosù_mesßge_˛⁄e(Ë™d osù_mesßge_‰ì()\n", 
j
);

219 
j
 != 0) {

220 
osù_mesßge_t
 *
c›y
;

222 
j
--;

223 
îr
 = 
	`osù_mesßge_˛⁄e
(
sù
, &
c›y
);

225 i‡(
îr
 !
OSIP_SUCCESS
) {

226 i‡(
vîbo£
)

227 
	`Ârötf
(
°dout
, "ERROR: failed while creating copy of message!\n");

232 *
tmp
;

233 
size_t
 
Àngth
;

235 
	`osù_mesßge_f‹˚_upd©e
(
c›y
);

236 
îr
 = 
	`osù_mesßge_to_°r
(
c›y
, &
tmp
, &
Àngth
);

238 i‡(
îr
 !
OSIP_SUCCESS
) {

239 i‡(
vîbo£
)

240 
	`Ârötf
(
°dout
, "ERROR: failed whileÖrinting message!\n");

243 i‡(0 =
	`°rcmp
(
ªsu…
, 
tmp
)) {

244 i‡(
vîbo£
)

245 
	`¥ötf
("The osip_message_clone method worksÖerfectly\n");

248 
	`¥ötf
("ERROR: The osip_message_clone method DOES NOT works\n");

249 
îr
 = -1;

251 i‡(
vîbo£
) {

252 
	`¥ötf
("Here isÅhe copy: \n");

253 
	`fwrôe
(
tmp
, 1, 
Àngth
, 
°dout
);

254 
	`¥ötf
("\n");

258 
	`osù_‰ì
(
tmp
);

261 
	`osù_mesßge_‰ì
(
c›y
);

265 i‡(
vîbo£
)

266 
	`Ârötf
(
°dout
, "sequentials calls: done\n");

269 
	`osù_‰ì
(
ªsu…
);

272 
	`osù_mesßge_‰ì
(
sù
);

275  
îr
;

276 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/trecordr.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
ªc‹d_rouãs_fûe
;

31 
osù_ªc‹d_rouã_t
 *
ªc‹d_rouã
;

32 *
a_ªc‹d_rouã
;

33 *
de°
;

34 *
ªs
;

36 
ªc‹d_rouãs_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
ªc‹d_rouãs_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åªc‹d_rouãÑec‹d_rouãs.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_ªc‹d_rouã
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_ªc‹d_rouã
, 200, 
ªc‹d_rouãs_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_ªc‹d_rouã
 + 
	`°æí
(a_record_route) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_ªc‹d_rouã
, "#", 1)) {

54 
	`osù_ªc‹d_rouã_öô
(&
ªc‹d_rouã
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("RECORD_ROUTE TO PARSE: |%s|\n", 
a_ªc‹d_rouã
);

57 
îrcode
 = 
	`osù_ªc‹d_rouã_∑r£
(
ªc‹d_rouã
, 
a_ªc‹d_rouã
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_ªc‹d_rouã_to_°r
(
ªc‹d_rouã
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("BadÑec‹d_rouã f‹m©: %s\n", 
a_ªc‹d_rouã
);

68 
	`osù_ªc‹d_rouã_‰ì
(
ªc‹d_rouã
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_ªc‹d_rouã
, 200, 
ªc‹d_rouãs_fûe
);

75 
	`osù_‰ì
(
a_ªc‹d_rouã
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/troute.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
rouãs_fûe
;

31 
osù_rouã_t
 *
rouã
;

32 *
a_rouã
;

33 *
de°
;

34 *
ªs
;

36 
rouãs_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
rouãs_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:ÅrouãÑouãs.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_rouã
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_rouã
, 200, 
rouãs_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_rouã
 + 
	`°æí
(a_route) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_rouã
, "#", 1)) {

54 
	`osù_rouã_öô
(&
rouã
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("ROUTE TO PARSE: |%s|\n", 
a_rouã
);

57 
îrcode
 = 
	`osù_rouã_∑r£
(
rouã
, 
a_rouã
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_rouã_to_°r
(
rouã
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("BadÑouã f‹m©: %s\n", 
a_rouã
);

68 
	`osù_rouã_‰ì
(
rouã
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_rouã
, 200, 
rouãs_fûe
);

75 
	`osù_‰ì
(
a_rouã
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tto.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
tos_fûe
;

31 
osù_to_t
 *
to
;

32 *
a_to
;

33 *
de°
;

34 *
ªs
;

36 
tos_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
tos_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åtÿtos.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_to
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_to
, 200, 
tos_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_to
 + 
	`°æí
(a_to) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_to
, "#", 1)) {

54 
	`osù_to_öô
(&
to
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("TO TO PARSE: |%s|\n", 
a_to
);

57 
îrcode
 = 
	`osù_to_∑r£
(
to
, 
a_to
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_to_to_°r
(
to
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("BadÅÿf‹m©: %s\n", 
a_to
);

68 
	`osù_to_‰ì
(
to
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_to
, 200, 
tos_fûe
);

75 
	`osù_‰ì
(
a_to
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/turls.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_uri.h
>

28 
osù_uri_ã°_ac˚ss‹_≠i
(
osù_uri_t
 *
uæ
);

30 
	$maö
(
¨gc
, **
¨gv
) {

31 
FILE
 *
uæs_fûe
;

33 
osù_uri_t
 *
uæ
;

34 *
a_uæ
;

35 *
de°
;

36 *
ªs
;

38 
uæs_fûe
 = 
	`f›í
(
¨gv
[1], "r");

40 i‡(
uæs_fûe
 =
NULL
) {

41 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åuæ†uæs.txt\n", 
¨gv
[1]);

42 
	`exô
(0);

45 
a_uæ
 = (*Ë
	`osù_mÆloc
(200);

46 
ªs
 = 
	`fgës
(
a_uæ
, 200, 
uæs_fûe
);

48 
ªs
 !
NULL
) {

49 
îrcode
;

52 
	`osù_°∫˝y
(
a_uæ
 + 
	`°æí
(a_url) - 1, "\0", 1);

54 i‡(0 !
	`°∫cmp
(
a_uæ
, "#", 1)) {

56 
	`osù_uri_öô
(&
uæ
);

57 
	`¥ötf
("=================================================\n");

58 
	`¥ötf
("URL TO PARSE: |%s|\n", 
a_uæ
);

59 
îrcode
 = 
	`osù_uri_∑r£
(
uæ
, 
a_uæ
);

61 i‡(
îrcode
 != -1) {

62 i‡(
	`osù_uri_to_°r
(
uæ
, &
de°
) != -1) {

63 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

64 
	`osù_uri_ã°_ac˚ss‹_≠i
(
uæ
);

65 
	`osù_‰ì
(
de°
);

69 
	`¥ötf
("Bad uæ f‹m©: %s\n", 
a_uæ
);

71 
	`osù_uri_‰ì
(
uæ
);

72 
	`¥ötf
("=================================================\n");

75 
ªs
 = 
	`fgës
(
a_uæ
, 200, 
uæs_fûe
);

78 
	`osù_‰ì
(
a_uæ
);

80 
	}
}

82 
	$osù_uri_ã°_ac˚ss‹_≠i
(
osù_uri_t
 *
uæ
) {

83 i‡(
uæ
->
scheme
 !
NULL
)

84 
	`Ârötf
(
°dout
, "%s:", 
uæ
->
scheme
);

86 i‡(
uæ
->
°rög
 !
NULL
) {

87 
	`Ârötf
(
°dout
, "|%s", 
uæ
->
°rög
);

88 
	`Ârötf
(
°dout
, "\n");

92 i‡(
uæ
->
u£∫ame
 !
NULL
)

93 
	`Ârötf
(
°dout
, "%s|", 
uæ
->
u£∫ame
);

95 i‡((
uæ
->
∑ssw‹d
 !
NULL
Ë&& (uæ->
u£∫ame
 != NULL))

96 
	`Ârötf
(
°dout
, ":%s|", 
uæ
->
∑ssw‹d
);

98 i‡(
uæ
->
u£∫ame
 !
NULL
)

99 
	`Ârötf
(
°dout
, "@|");

101 i‡(
uæ
->
ho°
 !
NULL
) {

102 i‡(
	`°rchr
(
uæ
->
ho°
, ':'Ë!
NULL
)

103 
	`Ârötf
(
°dout
, "[%s]|", 
uæ
->
ho°
);

106 
	`Ârötf
(
°dout
, "%s|", 
uæ
->
ho°
);

109 i‡(
uæ
->
p‹t
 !
NULL
)

110 
	`Ârötf
(
°dout
, ":%s|", 
uæ
->
p‹t
);

112 
	`Ârötf
(
°dout
, "\nuri-params\n");

115 
pos
 = 0;

116 
osù_uri_∑øm_t
 *
u_∑øm
;

118 !
	`osù_li°_eﬁ
(&
uæ
->
uæ_∑øms
, 
pos
)) {

119 
u_∑øm
 = (
osù_uri_∑øm_t
 *Ë
	`osù_li°_gë
(&
uæ
->
uæ_∑øms
, 
pos
);

121 i‡(
u_∑øm
->
gvÆue
 !
NULL
)

122 
	`Ârötf
(
°dout
, ";%s|=|%s|", 
u_∑øm
->
g«me
, u_∑øm->
gvÆue
);

125 
	`Ârötf
(
°dout
, ";%s|", 
u_∑øm
->
g«me
);

127 
pos
++;

131 
	`Ârötf
(
°dout
, "\nheaders\n");

134 
pos
 = 0;

135 
osù_uri_hódî_t
 *
u_hódî
;

137 !
	`osù_li°_eﬁ
(&
uæ
->
uæ_hódîs
, 
pos
)) {

138 
u_hódî
 = (
osù_uri_hódî_t
 *Ë
	`osù_li°_gë
(&
uæ
->
uæ_hódîs
, 
pos
);

140 i‡(
pos
 == 0)

141 
	`Ârötf
(
°dout
, "?%s|=|%s|", 
u_hódî
->
g«me
, u_hódî->
gvÆue
);

144 
	`Ârötf
(
°dout
, "&%s|=|%s|", 
u_hódî
->
g«me
, u_hódî->
gvÆue
);

146 
pos
++;

149 
	`Ârötf
(
°dout
, "\n");

151 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tvia.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
vüs_fûe
;

31 
osù_vü_t
 *
vü
;

32 *
a_vü
;

33 *
de°
;

34 *
ªs
;

36 
vüs_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
vüs_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åvü vüs.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_vü
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_vü
, 200, 
vüs_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`osù_°∫˝y
(
a_vü
 + 
	`°æí
(a_via) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_vü
, "#", 1)) {

54 
	`osù_vü_öô
(&
vü
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("VIA TO PARSE: |%s|\n", 
a_vü
);

57 
îrcode
 = 
	`osù_vü_∑r£
(
vü
, 
a_vü
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_vü_to_°r
(
vü
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("Bad vü f‹m©: %s\n", 
a_vü
);

68 
	`osù_vü_‰ì
(
vü
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_vü
, 200, 
vüs_fûe
);

75 
	`osù_‰ì
(
a_vü
);

78 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/twwwa.c

20 #ifde‡
ENABLE_MPATROL


21 
	~<m∑åﬁ.h
>

24 
	~<osù∑r£r2/öã∫Æ.h
>

25 
	~<osù∑r£r2/osù_p‹t.h
>

26 
	~<osù∑r£r2/osù_mesßge.h
>

28 
	$maö
(
¨gc
, **
¨gv
) {

29 
FILE
 *
wwwauthítiˇãs_fûe
;

31 
osù_www_authítiˇã_t
 *
wwwauthítiˇã
;

32 *
a_wwwauthítiˇã
;

33 *
de°
;

34 *
ªs
;

36 
wwwauthítiˇãs_fûe
 = 
	`f›í
(
¨gv
[1], "r");

38 i‡(
wwwauthítiˇãs_fûe
 =
NULL
) {

39 
	`Ârötf
(
°dout
, "FaûedÅÿ›í %†fûe.\nUßge:Åwwwauthítiˇã wwwauthítiˇãs.txt\n", 
¨gv
[1]);

40 
	`exô
(0);

43 
a_wwwauthítiˇã
 = (*Ë
	`osù_mÆloc
(200);

44 
ªs
 = 
	`fgës
(
a_wwwauthítiˇã
, 200, 
wwwauthítiˇãs_fûe
);

46 
ªs
 !
NULL
) {

47 
îrcode
;

50 
	`°∫˝y
(
a_wwwauthítiˇã
 + 
	`°æí
(a_wwwauthenticate) - 1, "\0", 1);

52 i‡(0 !
	`°∫cmp
(
a_wwwauthítiˇã
, "#", 1)) {

54 
	`osù_www_authítiˇã_öô
(&
wwwauthítiˇã
);

55 
	`¥ötf
("=================================================\n");

56 
	`¥ötf
("WWWAUTHENTICATE TO PARSE: |%s|\n", 
a_wwwauthítiˇã
);

57 
îrcode
 = 
	`osù_www_authítiˇã_∑r£
(
wwwauthítiˇã
, 
a_wwwauthítiˇã
);

59 i‡(
îrcode
 != -1) {

60 i‡(
	`osù_www_authítiˇã_to_°r
(
wwwauthítiˇã
, &
de°
) != -1) {

61 
	`¥ötf
("ªsu…: |%s|\n", 
de°
);

62 
	`osù_‰ì
(
de°
);

66 
	`¥ötf
("Bad wwwauthítiˇã f‹m©: %s\n", 
a_wwwauthítiˇã
);

68 
	`osù_www_authítiˇã_‰ì
(
wwwauthítiˇã
);

69 
	`¥ötf
("=================================================\n");

72 
ªs
 = 
	`fgës
(
a_wwwauthítiˇã
, 200, 
wwwauthítiˇãs_fûe
);

75 
	`osù_‰ì
(
a_wwwauthítiˇã
);

77 
	}
}

	@
1
.
0
115
8680
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/internal.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_condv.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_dialog.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_fifo.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_mt.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_time.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_encoding.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_language.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_alert_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_allow.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authentication_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authorization.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_id.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_contact.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_disposition.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_encoding.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_length.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_type.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_cseq.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_error_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_from.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_header.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_mime_version.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authenticate.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authentication_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authorization.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_record_route.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_route.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_to.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_via.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_www_authenticate.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/internal.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_body.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_const.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_headers.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_list.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_md5.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_message.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_parser.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_port.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_uri.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/sdp_message.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm_misc.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_dialog.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_event.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_time.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_transaction.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_condv.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_fifo.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_sema.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_thread.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/xixt.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_encoding.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_language.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_alert_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_allow.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authentication_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authorization.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_body.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_id.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_contact.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_disposition.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_encoding.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_length.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_type.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_cseq.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_error_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_from.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_header.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_list.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_md5c.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_parse.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_to_str.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_mime_version.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_parser_cfg.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_port.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authenticate.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authentication_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authorization.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_record_route.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_route.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_to.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_uri.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_via.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_www_authenticate.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/parser.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_accessor.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_message.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcallid.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontact.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontentt.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tfrom.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/torture.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/trecordr.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/troute.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tto.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/turls.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tvia.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/twwwa.c
