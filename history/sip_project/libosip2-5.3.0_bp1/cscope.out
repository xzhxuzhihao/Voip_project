cscope 15 /home/unasaw/sip_project/libosip2-5.3.0_bp -q 0000002889 0000636994
	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/internal.h

20 #iâdeà
_INTERNAL_H_


21 
	#_INTERNAL_H_


	)

23 #ià
defšed
(
HAVE_CONFIG_H
)

24 
	~<os-cÚfig.h
>

27 #ià
defšed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

28 
	#HAVE_CTYPE_H
 1

	)

29 
	#HAVE_STRING_H
 1

	)

30 
	#HAVE_SYS_TYPES_H
 1

	)

31 
	#HAVE_TIME_H
 1

	)

32 
	#HAVE_STDARG_H
 1

	)

34 #–ià
defšed
(
__VXWORKS_OS__
è|| defšed(
__¹ems__
)

35 
	#HAVE_STRING_H
 1

	)

36 
	#HAVE_TIME_H
 1

	)

37 
	#HAVE_SYS_TIME_H
 1

	)

38 
	#HAVE_SYS_TYPES_H
 1

	)

39 
	#HAVE_STDARG_H
 1

	)

41 #–ià
defšed
 
_WIN32_WCE


43 
	#HAVE_CTYPE_H
 1

	)

44 
	#HAVE_STRING_H
 1

	)

45 
	#HAVE_TIME_H
 1

	)

46 
	#HAVE_STDARG_H
 1

	)

48 
	#¢´štf
 
_¢´štf


	)

50 #–ià
defšed
(
WIN32
)

52 
	#HAVE_CTYPE_H
 1

	)

53 
	#HAVE_STRING_H
 1

	)

54 
	#HAVE_SYS_TYPES_H
 1

	)

55 
	#HAVE_TIME_H
 1

	)

56 
	#HAVE_STDARG_H
 1

	)

58 #ià(
_MSC_VER
 < 1900)

59 
	#¢´štf
 
_¢´štf


	)

64 #ià
_MSC_VER
 >= 1300

65 
	#WIN32_USE_CRYPTO
 1

	)

70 #ià
defšed
(
HAVE_STRING_H
)

71 
	~<¡ršg.h
>

72 #–ià
defšed
(
HAVE_STRINGS_H
)

73 
	~<¡ršgs.h
>

75 
	~<¡ršg.h
>

78 
	~<¡dio.h
>

79 
	~<¡dlib.h
>

81 #ià
defšed
(
HAVE_SYS_TYPES_H
)

82 
	~<sys/ty³s.h
>

85 #ifdeà
HAVE_TIME_H


86 
	~<time.h
>

89 #ià
defšed
(
HAVE_SYS_TIME_H
)

90 
	~<sys/time.h
>

93 #ià
defšed
(
__¬c__
)

94 
	~"šşudes_­i.h
"

95 
	~"os_cfg_pub.h
"

96 
	~<posix_time_pub.h
>

99 #ifdeà
__PSOS__


100 
	#VA_START
(
a
, 
f
è
	`va_¡¬t
×, f)

	)

101 
	~"²a.h
"

102 
	~"¡dlib.h
"

103 
	~"time.h
"

104 
	#tim”cmp
(
tvp
, 
uvp
, 
cmp
è(Ñvp)->
tv_£c
 
	`cmp
(uvp)->tv_£ø|| (tvp)->tv_£ø=ğ(uvp)->tv_£ø&& (tvp)->
tv_u£c
 cmp(uvp)->tv_u£c)

	)

105 
	#¢´štf
 
os_¢´štf


	)

106 #iâdeà
INT_MAX


107 
	#INT_MAX
 0x7FFFFFFF

	)

111 #ifdeà
__BORLANDC__


112 
	#_timeb
 
timeb


	)

113 
	#_áime
 
áime


	)

116 #iâdeà
DOXYGEN


118 #ià!(
defšed
(
__¹ems__
è|| defšed(
__PALMOS__
è|| defšed(
HAVE_STRUCT_TIMEVAL
))

120 
	stimev®
 {

121 
	mtv_£c
;

122 
	mtv_u£c
;

126 #iâdeà
OSIP_MONOTHREAD


129 #ià
defšed
(
__¹ems__
)

130 
	~<¹ems.h
>

135 #ià!
defšed
(
__VXWORKS_OS__
è&& !defšed(
__PSOS__
è&& !defšed(
WIN32
è&& !defšed(
_WIN32_WCE
è&& !defšed(
HAVE_PTHREAD_WIN32
è&& !defšed(
HAVE_PTHREAD
è&& !defšed(
HAVE_PTHREAD_H
è&& !defšed(
HAVE_PTH_PTHREAD_H
)

136 #”rÜ 
No
 
th»ad
 
im¶em’tiÚ
 
found
!

142 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTHREAD_H
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

143 #ià
defšed
(
__¬c__
)

144 
	~<ucos_ii_­i.h
>

147 
	~<±h»ad.h
>

148 
±h»ad_t
 
	tos_th»ad_t
;

151 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

152 
	~<wš­içmy.h
>

156 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

157 #ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

158 
	#HAVE_CPP11_THREAD


	)

159 #–ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PC_APP
)

160 
	#HAVE_CPP11_THREAD


	)

164 #ià
defšed
(
HAVE_CPP11_THREAD
)

167 *
	mh
;

168 } 
	tos_th»ad_t
;

170 #–ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

173 
	#_WINSOCKAPI_


	)

174 
	~<wšdows.h
>

175 #undeà
_WINSOCKAPI_


178 
HANDLE
 
	mh
;

179 
	mid
;

180 } 
	tos_th»ad_t
;

183 #ifdeà
__VXWORKS_OS__


184 
	~<skLib.h
>

186 
	mid
;

187 } 
	tos_th»ad_t
;

190 #ifdeà
__PSOS__


191 
	~<psos.h
>

193 
	mtid
;

194 } 
	tos_th»ad_t
;

200 #ià!
defšed
(
HAVE_SEMAPHORE_H
è&& !defšed(
HAVE_SYS_SEM_H
è&& !defšed(
WIN32
è&& !defšed(
_WIN32_WCE
è&& !defšed(
HAVE_PTHREAD_WIN32
è&& !defšed(
__PSOS__
è&& !defšed(
__VXWORKS_OS__
è&& !defšed(
__¬c__
)

201 #”rÜ 
No
 
£m­hÜe
 
im¶em’tiÚ
 
found


205 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTHREAD_H
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

206 
±h»ad_mu‹x_t
 
	tos_mu‹x_t
;

209 #ifdeà
__sun__


210 
	~<£m­hÜe.h
>

211 #undeà
g‘d©e


212 
	~<synch.h
>

215 #ià
defšed
(
__¬c__
)

218 
	m_£m_couÁ”
;

219 
os_mu‹x
 *
	m_£m_mu‹x
;

220 } 
	t£m_t
;

222 
£m_t
 
	tos_£m_t
;

224 #–ià(
defšed
(
HAVE_SEMAPHORE_H
è&& !defšed(
__APPLE_CC__
)è|| defšed(
HAVE_PTHREAD_WIN32
)

225 
	~<£m­hÜe.h
>

226 #ifdeà
__sun__


227 #undeà
g‘d©e


228 
	~<synch.h
>

234 
£m_t
 
	tos_£m_t
;

236 #–ià
defšed
(
__APPLE_CC__
)

237 
	~<mach/sk.h
>

238 
	~<mach/£m­hÜe.h
>

239 
	~<mach/mach_š™.h
>

241 
£m­hÜe_t
 
	m£mid
;

242 } 
	tos_£m_t
;

243 #–ià
defšed
(
HAVE_SYS_SEM_H
)

244 
	~<sys/ty³s.h
>

245 
	~<sys/c.h
>

246 
	~<sys/£m.h
>

248 
	m£mid
;

249 } 
	tos_£m_t
;

253 #ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

255 
	#_WINSOCKAPI_


	)

256 
	~<wšdows.h
>

257 #undeà
_WINSOCKAPI_


259 #ià(
_WIN32_WINNT
 >ğ0x0403è&& (!
defšed
(
_WIN32_WCE
))

261 
	#OSIP_CRITICALSECTION_SPIN
 4000

	)

263 
CRITICAL_SECTION
 
	mh
;

264 } 
	tos_mu‹x_t
;

268 
HANDLE
 
	mh
;

269 } 
	tos_mu‹x_t
;

273 
HANDLE
 
	mh
;

274 } 
	tos_£m_t
;

277 #ifdeà
__VXWORKS_OS__


278 
	~<£m­hÜe.h
>

279 
	~<£mLib.h
>

280 
£m­hÜe
 
	tos_mu‹x_t
;

281 
£m_t
 
	tos_£m_t
;

284 #ifdeà
__PSOS__


285 
	~<Ty³s.h
>

286 
	~<os.h
>

288 
UIÁ32
 
	mid
;

289 } 
	tos_mu‹x_t
;

291 
UIÁ32
 
	mid
;

292 } 
	tos_£m_t
;

301 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

302 
	sos_cÚd
 {

303 
±h»ad_cÚd_t
 
	mcv
;

304 } 
	tos_cÚd_t
;

307 #ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

308 
	sos_cÚd
 {

309 
os_mu‹x
 *
	mmut
;

310 
os_£m
 *
	m£m
;

311 } 
	tos_cÚd_t
;

314 #ià
defšed
(
__PSOS__
è|| defšed(
__VXWORKS_OS__
)

315 
	sos_cÚd
 {

316 
os_£m
 *
	m£m
;

317 } 
	tos_cÚd_t
;

322 #ià
defšed
(
__¹ems__
)

324 
¹ems_id
 
	mtid
;

325 } 
	tos_th»ad_t
;

328 
¹ems_id
 
	mid
;

329 } 
	tos_£m_t
;

332 
¹ems_id
 
	mid
;

333 } 
	tos_mu‹x_t
;

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip.h

20 #iâdeà
_OSIP_H_


21 
	#_OSIP_H_


	)

23 
	~<os·r£r2/os_cÚ¡.h
>

26 
	~<os2/os_time.h
>

28 #ifdeà
__sun


29 
	~<sys/ty³s.h
>

32 
	~<os·r£r2/os_·r£r.h
>

33 
	~<os2/os_fifo.h
>

47 #ifdeà
__ılu¥lus


56 
	e_¡©e_t
 {

58 
ICT_PRE_CALLING
,

59 
ICT_CALLING
,

60 
ICT_PROCEEDING
,

61 
ICT_COMPLETED
,

62 
ICT_TERMINATED
,

65 
IST_PRE_PROCEEDING
,

66 
IST_PROCEEDING
,

67 
IST_COMPLETED
,

68 
IST_CONFIRMED
,

69 
IST_TERMINATED
,

72 
NICT_PRE_TRYING
,

73 
NICT_TRYING
,

74 
NICT_PROCEEDING
,

75 
NICT_COMPLETED
,

76 
NICT_TERMINATED
,

79 
NIST_PRE_TRYING
,

80 
NIST_TRYING
,

81 
NIST_PROCEEDING
,

82 
NIST_COMPLETED
,

83 
NIST_TERMINATED
,

85 #iâdeà
DOXYGEN


86 
DIALOG_EARLY
,

87 
DIALOG_CONFIRMED
,

88 
DIALOG_CLOSE


90 } 
	t¡©e_t
;

109 
	ety³_t
 {

111 
TIMEOUT_A
,

112 
TIMEOUT_B
,

113 
TIMEOUT_D
,

116 
TIMEOUT_E
,

117 
TIMEOUT_F
,

118 
TIMEOUT_K
,

121 
TIMEOUT_G
,

122 
TIMEOUT_H
,

123 
TIMEOUT_I
,

126 
TIMEOUT_J
,

129 
RCV_REQINVITE
,

130 
RCV_REQACK
,

131 
RCV_REQUEST
,

132 
RCV_STATUS_1XX
,

133 
RCV_STATUS_2XX
,

134 
RCV_STATUS_3456XX
,

137 
SND_REQINVITE
,

138 
SND_REQACK
,

139 
SND_REQUEST
,

140 
SND_STATUS_1XX
,

141 
SND_STATUS_2XX
,

142 
SND_STATUS_3456XX
,

144 
KILL_TRANSACTION
,

145 
UNKNOWN_EVT


146 } 
	tty³_t
;

156 
	eos_fsm_ty³_t
 {

157 
ICT
,

158 
IST
,

159 
NICT
,

160 
NIST


161 } 
	tos_fsm_ty³_t
;

163 #iâdeà
DEFAULT_T1


168 
	#DEFAULT_T1
 500

	)

170 #iâdeà
DEFAULT_T1_TCP_PROGRESS


180 
	#DEFAULT_T1_TCP_PROGRESS
 500

	)

182 #iâdeà
DEFAULT_T2


187 
	#DEFAULT_T2
 4000

	)

189 #iâdeà
DEFAULT_T4


194 
	#DEFAULT_T4
 5000

	)

201 
os_iù
 
	tos_iù_t
;

207 
	sos_iù
 {

208 
tim”_a_Ëngth
;

209 
timev®
 
tim”_a_¡¬t
;

210 
tim”_b_Ëngth
;

211 
timev®
 
tim”_b_¡¬t
;

212 
tim”_d_Ëngth
;

213 
timev®
 
tim”_d_¡¬t
;

214 *
de¡š©iÚ
;

215 
pÜt
;

222 
os_niù
 
	tos_niù_t
;

228 
	sos_niù
 {

229 
tim”_e_Ëngth
;

230 
timev®
 
tim”_e_¡¬t
;

231 
tim”_f_Ëngth
;

232 
timev®
 
tim”_f_¡¬t
;

233 
tim”_k_Ëngth
;

234 
timev®
 
tim”_k_¡¬t
;

235 *
de¡š©iÚ
;

236 
pÜt
;

243 
os_i¡
 
	tos_i¡_t
;

249 
	sos_i¡
 {

250 
tim”_g_Ëngth
;

251 
timev®
 
tim”_g_¡¬t
;

252 
tim”_h_Ëngth
;

253 
timev®
 
tim”_h_¡¬t
;

254 
tim”_i_Ëngth
;

255 
timev®
 
tim”_i_¡¬t
;

262 
os_ni¡
 
	tos_ni¡_t
;

268 
	sos_ni¡
 {

269 
tim”_j_Ëngth
;

270 
timev®
 
tim”_j_¡¬t
;

277 
os_¤v_’Œy
 
	tos_¤v_’Œy_t
;

284 
	sos_¤v_’Œy
 {

285 
¤v
[512];

286 
´iÜ™y
;

287 
weight
;

288 
rweight
;

289 
pÜt
;

290 
add»ss
[512];

291 
timev®
 
¤v_is_brok’
;

294 
	#OSIP_SRV_STATE_UNKNOWN
 0

	)

295 
	#OSIP_SRV_STATE_RETRYLATER
 2

	)

296 
	#OSIP_SRV_STATE_COMPLETED
 3

	)

297 
	#OSIP_SRV_STATE_NOTSUPPORTED
 4

	)

303 
os_¤v_»cÜd
 
	tos_¤v_»cÜd_t
;

309 
	sos_¤v_»cÜd
 {

310 
Çme
[1024];

311 
¤v_¡©e
;

312 
æag
[256];

313 
´ÙocŞ
[1024];

314 
»gexp
[1024];

315 
»¶aûm’t
[1024];

316 
Üd”
;

317 
´eã»nû
;

318 
šdex
;

319 
os_¤v_’Œy_t
 
¤v’Œy
[10];

322 
	#OSIP_NAPTR_STATE_UNKNOWN
 0

	)

323 
	#OSIP_NAPTR_STATE_INPROGRESS
 1

	)

324 
	#OSIP_NAPTR_STATE_NAPTRDONE
 2

	)

325 
	#OSIP_NAPTR_STATE_SRVINPROGRESS
 3

	)

326 
	#OSIP_NAPTR_STATE_SRVDONE
 4

	)

327 
	#OSIP_NAPTR_STATE_RETRYLATER
 5

	)

328 
	#OSIP_NAPTR_STATE_NOTSUPPORTED
 6

	)

334 
os_Ç±r
 
	tos_Ç±r_t
;

340 
	sos_Ç±r
 {

341 
domaš
[512];

342 
AUS
[64];

343 
Ç±r_¡©e
;

344 *
¬g
;

345 
k“p_š_ÿche
;

346 
os_¤v_»cÜd
 
sudp_»cÜd
;

347 
os_¤v_»cÜd
 
stı_»cÜd
;

348 
os_¤v_»cÜd
 
ss_»cÜd
;

349 
os_¤v_»cÜd
 
sds_»cÜd
;

350 
os_¤v_»cÜd
 
ssùp_»cÜd
;

351 
os_¤v_»cÜd
 
s’um_»cÜd
;

358 
os_Œª§ùiÚ
 
	tos_Œª§ùiÚ_t
;

364 
	sos_Œª§ùiÚ
 {

365 *
your_š¡ªû
;

366 
Œª§ùiÚid
;

367 
os_fifo_t
 *
Œª§ùiÚff
;

369 
os_vŸ_t
 *
tİvŸ
;

370 
os_äom_t
 *
äom
;

371 
os_to_t
 *
to
;

372 
os_ÿÎ_id_t
 *
ÿÎid
;

373 
os_c£q_t
 *
c£q
;

375 
os_mes§ge_t
 *
Üig_»que¡
;

376 
os_mes§ge_t
 *
Ï¡_»¥Ú£
;

377 
os_mes§ge_t
 *
ack
;

379 
¡©e_t
 
¡©e
;

381 
time_t
 
bœth_time
;

382 
time_t
 
com¶‘ed_time
;

383 
timev®
 
ü—‹d_time
;

384 
timev®
 
de¡royed_time
;

386 
š_sock‘
;

387 
out_sock‘
;

389 *
cÚfig
;

391 
os_fsm_ty³_t
 
ùx_ty³
;

392 
os_iù_t
 *
iù_cÚ‹xt
;

393 
os_i¡_t
 *
i¡_cÚ‹xt
;

394 
os_niù_t
 *
niù_cÚ‹xt
;

395 
os_ni¡_t
 *
ni¡_cÚ‹xt
;

397 
os_¤v_»cÜd_t
 
»cÜd
;

398 
os_Ç±r_t
 *
Ç±r_»cÜd
;

399 *
»£rved1
;

400 *
»£rved2
;

401 *
»£rved3
;

402 *
»£rved4
;

403 *
»£rved5
;

404 *
»£rved6
;

410 
	eos_mes§ge_ÿÎback_ty³
 {

411 
OSIP_ICT_INVITE_SENT
 = 0,

412 
OSIP_ICT_INVITE_SENT_AGAIN
,

413 
OSIP_ICT_ACK_SENT
,

414 
OSIP_ICT_ACK_SENT_AGAIN
,

415 
OSIP_ICT_STATUS_1XX_RECEIVED
,

416 
OSIP_ICT_STATUS_2XX_RECEIVED
,

417 
OSIP_ICT_STATUS_2XX_RECEIVED_AGAIN
,

418 
OSIP_ICT_STATUS_3XX_RECEIVED
,

419 
OSIP_ICT_STATUS_4XX_RECEIVED
,

420 
OSIP_ICT_STATUS_5XX_RECEIVED
,

421 
OSIP_ICT_STATUS_6XX_RECEIVED
,

422 
OSIP_ICT_STATUS_3456XX_RECEIVED_AGAIN
,

424 
OSIP_IST_INVITE_RECEIVED
,

425 
OSIP_IST_INVITE_RECEIVED_AGAIN
,

426 
OSIP_IST_ACK_RECEIVED
,

427 
OSIP_IST_ACK_RECEIVED_AGAIN
,

428 
OSIP_IST_STATUS_1XX_SENT
,

429 
OSIP_IST_STATUS_2XX_SENT
,

430 
OSIP_IST_STATUS_2XX_SENT_AGAIN
,

431 
OSIP_IST_STATUS_3XX_SENT
,

432 
OSIP_IST_STATUS_4XX_SENT
,

433 
OSIP_IST_STATUS_5XX_SENT
,

434 
OSIP_IST_STATUS_6XX_SENT
,

435 
OSIP_IST_STATUS_3456XX_SENT_AGAIN
,

437 
OSIP_NICT_REGISTER_SENT
,

438 
OSIP_NICT_BYE_SENT
,

439 
OSIP_NICT_OPTIONS_SENT
,

440 
OSIP_NICT_INFO_SENT
,

441 
OSIP_NICT_CANCEL_SENT
,

442 
OSIP_NICT_NOTIFY_SENT
,

443 
OSIP_NICT_SUBSCRIBE_SENT
,

444 
OSIP_NICT_UNKNOWN_REQUEST_SENT
,

445 
OSIP_NICT_REQUEST_SENT_AGAIN
,

446 
OSIP_NICT_STATUS_1XX_RECEIVED
,

447 
OSIP_NICT_STATUS_2XX_RECEIVED
,

448 
OSIP_NICT_STATUS_2XX_RECEIVED_AGAIN
,

449 
OSIP_NICT_STATUS_3XX_RECEIVED
,

450 
OSIP_NICT_STATUS_4XX_RECEIVED
,

451 
OSIP_NICT_STATUS_5XX_RECEIVED
,

452 
OSIP_NICT_STATUS_6XX_RECEIVED
,

453 
OSIP_NICT_STATUS_3456XX_RECEIVED_AGAIN
,

455 
OSIP_NIST_REGISTER_RECEIVED
,

456 
OSIP_NIST_BYE_RECEIVED
,

457 
OSIP_NIST_OPTIONS_RECEIVED
,

458 
OSIP_NIST_INFO_RECEIVED
,

459 
OSIP_NIST_CANCEL_RECEIVED
,

460 
OSIP_NIST_NOTIFY_RECEIVED
,

461 
OSIP_NIST_SUBSCRIBE_RECEIVED
,

463 
OSIP_NIST_UNKNOWN_REQUEST_RECEIVED
,

464 
OSIP_NIST_REQUEST_RECEIVED_AGAIN
,

465 
OSIP_NIST_STATUS_1XX_SENT
,

466 
OSIP_NIST_STATUS_2XX_SENT
,

467 
OSIP_NIST_STATUS_2XX_SENT_AGAIN
,

468 
OSIP_NIST_STATUS_3XX_SENT
,

469 
OSIP_NIST_STATUS_4XX_SENT
,

470 
OSIP_NIST_STATUS_5XX_SENT
,

471 
OSIP_NIST_STATUS_6XX_SENT
,

472 
OSIP_NIST_STATUS_3456XX_SENT_AGAIN
,

474 
OSIP_ICT_STATUS_TIMEOUT
,

475 
OSIP_NICT_STATUS_TIMEOUT
,

477 
OSIP_MESSAGE_CALLBACK_COUNT


478 } 
	tos_mes§ge_ÿÎback_ty³_t
;

483 
	eos_kl_ÿÎback_ty³
 {

484 
OSIP_ICT_KILL_TRANSACTION
,

485 
OSIP_IST_KILL_TRANSACTION
,

486 
OSIP_NICT_KILL_TRANSACTION
,

487 
OSIP_NIST_KILL_TRANSACTION
,

489 
OSIP_KILL_CALLBACK_COUNT


490 } 
	tos_kl_ÿÎback_ty³_t
;

495 
	eos_Œª¥Üt_”rÜ_ÿÎback_ty³
 {

496 
OSIP_ICT_TRANSPORT_ERROR
,

497 
OSIP_IST_TRANSPORT_ERROR
,

498 
OSIP_NICT_TRANSPORT_ERROR
,

499 
OSIP_NIST_TRANSPORT_ERROR
,

501 
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT


502 } 
	tos_Œª¥Üt_”rÜ_ÿÎback_ty³_t
;

508 (*
os_mes§ge_cb_t
)(
	tty³
, 
	tos_Œª§ùiÚ_t
 *, 
	tos_mes§ge_t
 *);

513 (*
os_kl_Œª§ùiÚ_cb_t
)(
	tty³
, 
	tos_Œª§ùiÚ_t
 *);

518 (*
os_Œª¥Üt_”rÜ_cb_t
)(
	tty³
, 
	tos_Œª§ùiÚ_t
 *, 
	t”rÜ
);

520 
os_dŸlog
;

526 
ixt
 
	tixt_t
;

532 
	sixt
 {

534 
os_dŸlog
 *
dŸlog
;

535 
os_mes§ge_t
 *
msg2xx
;

536 
os_mes§ge_t
 *
ack
;

537 
timev®
 
¡¬t
;

538 
š‹rv®
;

539 *
de¡
;

540 
pÜt
;

541 
sock
;

542 
couÁ”
;

552 
os
 
	tos_t
;

558 
	sos
 {

559 *
­¶iÿtiÚ_cÚ‹xt
;

561 *
iù_ç¡mu‹x
;

562 *
i¡_ç¡mu‹x
;

563 *
niù_ç¡mu‹x
;

564 *
ni¡_ç¡mu‹x
;

565 *
ixt_ç¡mu‹x
;

566 *
id_mu‹x
;

567 
Œª§ùiÚid
;

570 
os_li¡_t
 
os_iù_Œª§ùiÚs
;

571 
os_li¡_t
 
os_i¡_Œª§ùiÚs
;

572 
os_li¡_t
 
os_niù_Œª§ùiÚs
;

573 
os_li¡_t
 
os_ni¡_Œª§ùiÚs
;

575 
os_li¡_t
 
ixt_»ŒªsmissiÚs
;

577 
os_mes§ge_cb_t
 
msg_ÿÎbacks
[
OSIP_MESSAGE_CALLBACK_COUNT
];

578 
os_kl_Œª§ùiÚ_cb_t
 
kl_ÿÎbacks
[
OSIP_KILL_CALLBACK_COUNT
];

579 
os_Œª¥Üt_”rÜ_cb_t
 
_”rÜ_ÿÎbacks
[
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
];

581 (*
cb_£nd_mes§ge
)(
os_Œª§ùiÚ_t
 *, 
os_mes§ge_t
 *, *, , );

583 *
os_iù_ha¡abË
;

584 *
os_i¡_ha¡abË
;

585 *
os_niù_ha¡abË
;

586 *
os_ni¡_ha¡abË
;

595 
os_£t_mes§ge_ÿÎback
(
os_t
 *
os
, 
ty³
, 
os_mes§ge_cb_t
 
cb
);

603 
os_£t_kl_Œª§ùiÚ_ÿÎback
(
os_t
 *
os
, 
ty³
, 
os_kl_Œª§ùiÚ_cb_t
 
cb
);

611 
os_£t_Œª¥Üt_”rÜ_ÿÎback
(
os_t
 *
os
, 
ty³
, 
os_Œª¥Üt_”rÜ_cb_t
 
cb
);

621 
os_ev’t
 
	tos_ev’t_t
;

627 
	sos_ev’t
 {

628 
ty³_t
 
ty³
;

629 
Œª§ùiÚid
;

630 
os_mes§ge_t
 *
s
;

640 
os_Œª§ùiÚ_š™
(
os_Œª§ùiÚ_t
 **
Œª§ùiÚ
, 
os_fsm_ty³_t
 
ùx_ty³
, 
os_t
 *
os
, 
os_mes§ge_t
 *
»que¡
);

645 
os_Œª§ùiÚ_ä“
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

653 
os_Œª§ùiÚ_ä“2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

662 
os_»¥Ú£_g‘_de¡š©iÚ
(
os_mes§ge_t
 *
»¥Ú£
, **
add»ss
, *
pÜŠum
);

672 
os_iù_£t_de¡š©iÚ
(
os_iù_t
 *
iù
, *
de¡š©iÚ
, 
pÜt
);

683 
os_niù_£t_de¡š©iÚ
(
os_niù_t
 *
niù
, *
de¡š©iÚ
, 
pÜt
);

690 
os_Œª§ùiÚ_add_ev’t
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ev’t_t
 *
evt
);

699 
os_Œª§ùiÚ_execu‹
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ev’t_t
 *
evt
);

712 
os_Œª§ùiÚ_£t_your_š¡ªû
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

725 
os_Œª§ùiÚ_£t_»£rved1
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

732 
os_Œª§ùiÚ_£t_»£rved2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

740 
os_Œª§ùiÚ_£t_»£rved3
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

748 
os_Œª§ùiÚ_£t_»£rved4
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

756 
os_Œª§ùiÚ_£t_»£rved5
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

764 
os_Œª§ùiÚ_£t_»£rved6
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
);

771 *
os_Œª§ùiÚ_g‘_your_š¡ªû
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

777 *
os_Œª§ùiÚ_g‘_»£rved1
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

783 *
os_Œª§ùiÚ_g‘_»£rved2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

789 *
os_Œª§ùiÚ_g‘_»£rved3
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

795 *
os_Œª§ùiÚ_g‘_»£rved4
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

801 *
os_Œª§ùiÚ_g‘_»£rved5
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

807 *
os_Œª§ùiÚ_g‘_»£rved6
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
);

816 
os_Œª§ùiÚ_g‘_de¡š©iÚ
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, **

, *
pÜt
);

824 
os_Œª§ùiÚ_£t_¤v_»cÜd
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_¤v_»cÜd_t
 *
»cÜd
);

832 
os_Œª§ùiÚ_£t_Ç±r_»cÜd
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_Ç±r_t
 *
»cÜd
);

840 
os_Œª§ùiÚ_£t_š_sock‘
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
sock
);

847 
os_Œª§ùiÚ_£t_out_sock‘
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
sock
);

853 
os_š™
(
os_t
 **
os
);

858 
os_»Ëa£
(
os_t
 *
os
);

866 
os_£t_­¶iÿtiÚ_cÚ‹xt
(
os_t
 *
os
, *
poš‹r
);

873 *
os_g‘_­¶iÿtiÚ_cÚ‹xt
(
os_t
 *
os
);

880 
os_»move_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
iù
);

886 
os_iù_execu‹
(
os_t
 *
os
);

891 
os_i¡_execu‹
(
os_t
 *
os
);

896 
os_niù_execu‹
(
os_t
 *
os
);

901 
os_ni¡_execu‹
(
os_t
 *
os
);

911 
os_tim”s_g‘timeout
(
os_t
 *
os
, 
timev®
 *
low”_tv
);

917 
os_tim”s_iù_execu‹
(
os_t
 *
os
);

922 
os_tim”s_i¡_execu‹
(
os_t
 *
os
);

927 
os_tim”s_niù_execu‹
(
os_t
 *
os
);

932 
os_tim”s_ni¡_execu‹
(
os_t
 *
os
);

940 
os_Œª§ùiÚ_t
 *
os_Œª§ùiÚ_fšd
(
os_li¡_t
 *
Œª§ùiÚs
, 
os_ev’t_t
 *
evt
);

942 #iâdeà
DOXYGEN


950 #ifdeà
OSIP_MONOTHREAD


951 
os_Œª§ùiÚ_t
 *
os_fšd_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
);

954 
os_Œª§ùiÚ_t
 *
__os_fšd_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
, 
cÚsume
);

963 
os_fšd_Œª§ùiÚ_ªd_add_ev’t
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
);

970 
os_Œª§ùiÚ_t
 *
os_ü—‹_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
);

977 
os_ev’t_t
 *
os_·r£
(cÚ¡ *
buf
, 
size_t
 
Ëngth
);

983 
os_»ŒªsmissiÚs_execu‹
(
os_t
 *
os
);

992 
os_¡¬t_200ok_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_dŸlog
 *
dŸlog
, 
os_mes§ge_t
 *
msg200ok
, 
sock
);

1003 
os_¡¬t_ack_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_dŸlog
 *
dŸlog
, 
os_mes§ge_t
 *
ack
, *
de¡
, 
pÜt
, 
sock
);

1010 
os_dŸlog
 *
os_¡İ_200ok_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_mes§ge_t
 *
ack
);

1019 
os_¡İ_»ŒªsmissiÚs_äom_dŸlog
(
os_t
 *
os
, 
os_dŸlog
 *
dŸlog
);

1025 
os_ev’t_t
 *
os_Ãw_outgošg_smes§ge
(
os_mes§ge_t
 *
s
);

1031 
os_ev’t_ä“
(
os_ev’t_t
 *
ev’t
);

1038 
os_£t_cb_£nd_mes§ge
(
os_t
 *
cf
, (*
cb
)(
os_Œª§ùiÚ_t
 *, 
os_mes§ge_t
 *, *, , ));

1045 
	#EVT_IS_RCV_INVITE
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_REQINVITE
)

	)

1050 
	#EVT_IS_RCV_ACK
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_REQACK
)

	)

1055 
	#EVT_IS_RCV_REQUEST
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_REQUEST
)

	)

1060 
	#EVT_IS_RCV_STATUS_1XX
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_STATUS_1XX
)

	)

1065 
	#EVT_IS_RCV_STATUS_2XX
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_STATUS_2XX
)

	)

1070 
	#EVT_IS_RCV_STATUS_3456XX
(
ev’t
èÓv’t->
ty³
 =ğ
RCV_STATUS_3456XX
)

	)

1077 
	#EVT_IS_SND_INVITE
(
ev’t
èÓv’t->
ty³
 =ğ
SND_REQINVITE
)

	)

1082 
	#EVT_IS_SND_ACK
(
ev’t
èÓv’t->
ty³
 =ğ
SND_REQACK
)

	)

1087 
	#EVT_IS_SND_REQUEST
(
ev’t
èÓv’t->
ty³
 =ğ
SND_REQUEST
)

	)

1092 
	#EVT_IS_SND_STATUS_1XX
(
ev’t
èÓv’t->
ty³
 =ğ
SND_STATUS_1XX
)

	)

1097 
	#EVT_IS_SND_STATUS_2XX
(
ev’t
èÓv’t->
ty³
 =ğ
SND_STATUS_2XX
)

	)

1102 
	#EVT_IS_SND_STATUS_3456XX
(
ev’t
èÓv’t->
ty³
 =ğ
SND_STATUS_3456XX
)

	)

1107 
	#EVT_IS_INCOMINGMSG
(
ev’t
èÓv’t->
ty³
 >ğ
RCV_REQINVITE
 &&ƒv’t->ty³ <ğ
RCV_STATUS_3456XX
)

	)

1112 
	#EVT_IS_INCOMINGREQ
(
ev’t
è(
	`EVT_IS_RCV_INVITE
Óv’tè|| 
	`EVT_IS_RCV_ACK
Óv’tè|| 
	`EVT_IS_RCV_REQUEST
Óv’t))

	)

1117 
	#EVT_IS_INCOMINGRESP
(
ev’t
è(
	`EVT_IS_RCV_STATUS_1XX
Óv’tè|| 
	`EVT_IS_RCV_STATUS_2XX
Óv’tè|| 
	`EVT_IS_RCV_STATUS_3456XX
Óv’t))

	)

1122 
	#EVT_IS_OUTGOINGMSG
(
ev’t
èÓv’t->
ty³
 >ğ
SND_REQINVITE
 &&ƒv’t->ty³ <ğ
SND_STATUS_3456XX
)

	)

1127 
	#EVT_IS_OUTGOINGREQ
(
ev’t
è(
	`EVT_IS_SND_INVITE
Óv’tè|| 
	`EVT_IS_SND_ACK
Óv’tè|| 
	`EVT_IS_SND_REQUEST
Óv’t))

	)

1132 
	#EVT_IS_OUTGOINGRESP
(
ev’t
è(
	`EVT_IS_SND_STATUS_1XX
Óv’tè|| 
	`EVT_IS_SND_STATUS_2XX
Óv’tè|| 
	`EVT_IS_SND_STATUS_3456XX
Óv’t))

	)

1138 
	#EVT_IS_MSG
(
ev’t
èÓv’t->
ty³
 >ğ
RCV_REQINVITE
 &&ƒv’t->ty³ <ğ
SND_STATUS_3456XX
)

	)

1144 
	#EVT_IS_KILL_TRANSACTION
(
ev’t
èÓv’t->
ty³
 =ğ
KILL_TRANSACTION
)

	)

1146 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_condv.h

20 #iâdeà
__OSIP_CONDV_H__


21 
	#__OSIP_CONDV_H__


	)

23 
	~<¡dio.h
>

25 #iâdeà
OSIP_MONOTHREAD


41 #ifdeà
__ılu¥lus


45 #ià
defšed
(
__PSOS__
)

52 #ià
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)

54 #ià(
_MSC_VER
 < 1900)

55 #iâdeà
HAVE_STRUCT_TIMESPEC


56 
	#HAVE_STRUCT_TIMESPEC
 1

	)

61 
	stime¥ec
 {

62 
tv_£c
;

63 
tv_n£c
;

69 
	gos_cÚd
;

74 
os_cÚd
 *
os_cÚd_š™
();

79 
os_cÚd_de¡roy
(
os_cÚd
 *
cÚd
);

84 
os_cÚd_sigÇl
(
os_cÚd
 *
cÚd
);

91 
os_cÚd_wa™
(
os_cÚd
 *
cÚd
, 
os_mu‹x
 *
mut
);

98 
os_cÚd_timedwa™
(
os_cÚd
 *
cÚd
, 
os_mu‹x
 *
mut
, cÚ¡ 
time¥ec
 *
ab¡ime
);

100 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_dialog.h

20 #iâdeà
_DIALOG_H_


21 
	#_DIALOG_H_


	)

23 
	~<os2/os.h
>

36 #ifdeà
__ılu¥lus


40 #iâdeà
DOXYGEN


41 
	e_os_dŸlog_ty³_t
 { 
CALLER
, 
CALLEE
 } 
	tos_dŸlog_ty³_t
;

48 
os_dŸlog
 
	tos_dŸlog_t
;

54 
	sos_dŸlog
 {

55 *
	gÿÎ_id
;

56 *
	gloÿl_g
;

57 *
	g»mÙe_g
;

58 *
	glše_·¿m
;

59 
os_li¡_t
 
	grou‹_£t
;

60 
	gloÿl_c£q
;

61 
	g»mÙe_c£q
;

62 
os_to_t
 *
	g»mÙe_uri
;

63 
os_äom_t
 *
	gloÿl_uri
;

64 
os_cÚù_t
 *
	g»mÙe_cÚù_uri
;

66 
	g£cu»
;

68 
os_dŸlog_ty³_t
 
	gty³
;

69 
¡©e_t
 
	g¡©e
;

70 *
	gyour_š¡ªû
;

78 
	#os_dŸlog_£t_š¡ªû
(
dŸlog
, 
š¡ªû
è(dŸlog)->
your_š¡ªû
 = (*è(š¡ªû)

	)

85 
	#os_dŸlog_g‘_š¡ªû
(
dŸlog
è(dŸlog)->
your_š¡ªû


	)

98 
os_dŸlog_š™_as_uac
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
);

107 
os_dŸlog_š™_as_uac_w™h_»mÙe_»que¡
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
Ãxt_»que¡
, 
loÿl_c£q
);

117 
os_dŸlog_š™_as_uas
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
šv™e
, os_mes§ge_ˆ*
»¥Ú£
);

122 
os_dŸlog_ä“
(
os_dŸlog_t
 *
dŸlog
);

129 
os_dŸlog_£t_¡©e
(
os_dŸlog_t
 *
dŸlog
, 
¡©e_t
 
ty³
);

140 
os_dŸlog_upd©e_rou‹_£t_as_uas
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
šv™e
);

147 
os_dŸlog_upd©e_os_c£q_as_uas
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»que¡
);

154 
os_dŸlog_m©ch_as_uac
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
);

161 
os_dŸlog_upd©e_g_as_uac
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
);

172 
os_dŸlog_upd©e_rou‹_£t_as_uac
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
);

179 
os_dŸlog_m©ch_as_uas
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»que¡
);

185 
os_dŸlog_is_Üigš©Ü
(
os_dŸlog_t
 *
dŸlog
);

190 
os_dŸlog_is_ÿÎ“
(
os_dŸlog_t
 *
dŸlog
);

192 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_fifo.h

20 #iâdeà
_FIFO_H_


21 
	#_FIFO_H_


	)

23 #iâdeà
OSIP_MONOTHREAD


24 
	~<os2/os_mt.h
>

26 
	~<os·r£r2/os_li¡.h
>

42 #ifdeà
__ılu¥lus


46 #iâdeà
DOXYGEN


48 ’um { 
os_ok
, 
os_em±y
 } 
	tos_fifo_¡©e
;

56 
os_fifo
 
	tos_fifo_t
;

62 
	sos_fifo
 {

63 #iâdeà
OSIP_MONOTHREAD


64 
os_mu‹x
 *
	gqi¦ocked
;

65 
os_£m
 *
	gqi£m±y
;

67 
os_li¡_t
 
	gqueue
;

68 
	gnb_–t
;

69 
os_fifo_¡©e
 
	g¡©e
;

81 
os_fifo_š™
(
os_fifo_t
 *
ff
);

86 
os_fifo_ä“
(
os_fifo_t
 *
ff
);

92 
os_fifo_š£¹
(
os_fifo_t
 *
ff
, *
–em’t
);

98 
os_fifo_add
(
os_fifo_t
 *
ff
, *
–em’t
);

103 
os_fifo_size
(
os_fifo_t
 *
ff
);

104 #iâdeà
OSIP_MONOTHREAD


109 *
os_fifo_g‘
(
os_fifo_t
 *
ff
);

115 *
os_fifo_Œyg‘
(
os_fifo_t
 *
ff
);

119 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_mt.h

20 #iâdeà
_OSIP_MT_H_


21 
	#_OSIP_MT_H_


	)

23 #iâdeà
OSIP_MONOTHREAD


25 
	~<¡dio.h
>

41 #ifdeà
__ılu¥lus


49 
os_th»ad
;

57 
os_th»ad
 *
os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
);

63 
os_th»ad_još
(
os_th»ad
 *
th»ad
);

70 
os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
th»ad
, 
´iÜ™y
);

74 
os_th»ad_ex™
();

76 #ifdeà
__ılu¥lus


84 #ifdeà
__ılu¥lus


92 
os_£m
;

98 
os_£m
 *
os_£m_š™
(
v®ue
);

103 
os_£m_de¡roy
(
os_£m
 *
£m
);

108 
os_£m_po¡
(
os_£m
 *
£m
);

114 
os_£m_wa™
(
os_£m
 *
£m
);

120 
os_£m_Œywa™
(
os_£m
 *
£m
);

122 #ifdeà
__ılu¥lus


130 #ifdeà
__ılu¥lus


138 
os_mu‹x
;

143 
os_mu‹x
 *
os_mu‹x_š™
();

148 
os_mu‹x_de¡roy
(
os_mu‹x
 *
mut
);

153 
os_mu‹x_lock
(
os_mu‹x
 *
mut
);

158 
os_mu‹x_uÆock
(
os_mu‹x
 *
mut
);

160 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_time.h

20 #iâdeà
_OSIP_TIME_H_


21 
	#_OSIP_TIME_H_


	)

23 #ifdeà
__ılu¥lus


29 #ià
defšed
(
_WIN32_WCE
)

30 
	s_timeb
 {

31 
time_t
 
time
;

32 
ml™m
;

33 
timezÚe
;

34 
d¡æag
;

40 
	gtimev®
;

43 
add_g‘timeofday
(
timev®
 *
©v
, 
ms
);

44 
mš_tim”cmp
(
timev®
 *
tv1
, timev® *
tv2
);

47 #ià!
defšed
(
tim”is£t
)

48 
	#os_tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

50 
	#os_tim”is£t
(
tvp
è
	`tim”is£t
Ñvp)

	)

53 #ià!
defšed
(
tim”cmp
)

54 
	#os_tim”cmp
(
a
, 
b
, 
CMP
è((×)->
tv_£c
 =ğ(b)->tv_£cè? (×)->
tv_u£c
 
	`CMP
(b)->tv_u£cè: (×)->tv_£øCMP(b)->tv_£c))

	)

56 
	#os_tim”cmp
(
tvp
, 
uvp
, 
cmp
è
	`tim”cmp
Ñvp, uvp, cmp)

	)

59 #ià!
defšed
(
tim”ş—r
)

60 
	#os_tim”ş—r
(
tvp
èÑvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0

	)

62 
	#os_tim”ş—r
(
tvp
è
	`tim”ş—r
Ñvp)

	)

65 #ià!
defšed
(
tim”sub
)

66 
	#os_tim”sub
(
a
, 
b
, 
»suÉ
) \

68 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

69 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

70 ià((
»suÉ
)->
tv_u£c
 < 0) { \

71 --(
»suÉ
)->
tv_£c
; \

72 (
»suÉ
)->
tv_u£c
 += 1000000; \

74 } 0)

	)

76 
	#os_tim”sub
(
a
, 
b
, 
»suÉ
è
	`tim”sub
×, b,„esuÉ)

	)

79 
os_g‘timeofday
(
timev®
 *

, *
tz
);

80 
time_t
 
os_g‘sy¡emtime
Ñime_ˆ*
t
);

81 
os_com³n§‹time
();

83 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept.h

20 #iâdeà
_OSIP_ACCEPT_H_


21 
	#_OSIP_ACCEPT_H_


	)

23 
	~<os·r£r2/h—d”s/os_cÚ‹Á_ty³.h
>

40 
os_cÚ‹Á_ty³_t
 
	tos_acû±_t
;

42 #ifdeà
__ılu¥lus


50 
	#acû±_š™
(
h—d”
è
	`os_cÚ‹Á_ty³_š™
(h—d”)

	)

55 
	#os_acû±_ä“
 
os_cÚ‹Á_ty³_ä“


	)

61 
	#os_acû±_·r£
(
h—d”
, 
hv®ue
è
	`os_cÚ‹Á_ty³_·r£
(h—d”, hv®ue)

	)

67 
os_acû±_to_¡r
(cÚ¡ 
os_acû±_t
 *
h—d”
, **
de¡
);

73 
	#os_acû±_şÚe
 
os_cÚ‹Á_ty³_şÚe


	)

80 
	#os_acû±_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

87 
	#os_acû±_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

89 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_encoding.h

20 #iâdeà
_OSIP_ACCEPT_ENCONDING_H_


21 
	#_OSIP_ACCEPT_ENCONDING_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

40 
os_acû±_’codšg
 
	tos_acû±_’codšg_t
;

46 
	sos_acû±_’codšg
 {

47 *
	m–em’t
;

48 
os_li¡_t
 
	mg’_·¿ms
;

51 #ifdeà
__ılu¥lus


59 
os_acû±_’codšg_š™
(
os_acû±_’codšg_t
 **
h—d”
);

65 
os_acû±_’codšg_·r£
(
os_acû±_’codšg_t
 *
h—d”
, cÚ¡ *
hv®ue
);

71 
os_acû±_’codšg_to_¡r
(cÚ¡ 
os_acû±_’codšg_t
 *
h—d”
, **
de¡
);

76 
os_acû±_’codšg_ä“
(
os_acû±_’codšg_t
 *
h—d”
);

82 
os_acû±_’codšg_şÚe
(cÚ¡ 
os_acû±_’codšg_t
 *
h—d”
, os_acû±_’codšg_ˆ**
de¡
);

89 
os_acû±_’codšg_£t_–em’t
(
os_acû±_’codšg_t
 *
h—d”
, *
v®ue
);

94 *
os_acû±_’codšg_g‘_–em’t
(cÚ¡ 
os_acû±_’codšg_t
 *
h—d”
);

101 
	#os_acû±_’codšg_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

108 
	#os_acû±_’codšg_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

110 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_language.h

20 #iâdeà
_OSIP_ACCEPT_LANGUAGE_H_


21 
	#_OSIP_ACCEPT_LANGUAGE_H_


	)

23 
	~<os·r£r2/h—d”s/os_acû±_’codšg.h
>

40 
os_acû±_’codšg_t
 
	tos_acû±_Ïnguage_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_acû±_Ïnguage_š™
(
h—d”
è
	`os_acû±_’codšg_š™
(h—d”)

	)

56 
	#os_acû±_Ïnguage_·r£
(
h—d”
, 
hv®ue
è
	`os_acû±_’codšg_·r£
(h—d”, hv®ue)

	)

62 
	#os_acû±_Ïnguage_to_¡r
 
os_acû±_’codšg_to_¡r


	)

67 
	#os_acû±_Ïnguage_ä“
 
os_acû±_’codšg_ä“


	)

73 
	#os_acû±_Ïnguage_şÚe
 
os_acû±_’codšg_şÚe


	)

79 
	#os_acû±_Ïnguage_g‘_–em’t
(
h—d”
è
	`os_acû±_’codšg_g‘_–em’t
(h—d”)

	)

85 
	#os_acû±_Ïnguage_£t_–em’t
(
h—d”
, 
v®ue
è
	`os_acû±_’codšg_£t_–em’t
(h—d”, v®ue)

	)

92 
	#os_acû±_Ïnguage_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

99 
	#os_acû±_Ïnguage_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

101 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_alert_info.h

20 #iâdeà
_OSIP_ALERT_INFO_H_


21 
	#_OSIP_ALERT_INFO_H_


	)

23 
	~<os·r£r2/h—d”s/os_ÿÎ_šfo.h
>

40 
os_ÿÎ_šfo_t
 
	tos_®”t_šfo_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_®”t_šfo_š™
(
h—d”
è
	`os_ÿÎ_šfo_š™
(h—d”)

	)

55 
	#os_®”t_šfo_ä“
 
os_ÿÎ_šfo_ä“


	)

61 
	#os_®”t_šfo_·r£
(
h—d”
, 
hv®ue
è
	`os_ÿÎ_šfo_·r£
(h—d”, hv®ue)

	)

67 
	#os_®”t_šfo_to_¡r
(
h—d”
, 
de¡
è
	`os_ÿÎ_šfo_to_¡r
(h—d”, de¡)

	)

73 
	#os_®”t_šfo_şÚe
 
os_ÿÎ_šfo_şÚe


	)

78 
	#os_®”t_šfo_g‘_uri
(
h—d”
è
	`os_ÿÎ_šfo_g‘_uri
(h—d”)

	)

84 
	#os_®”t_šfo_£t_uri
(
h—d”
, 
uri
è
	`os_ÿÎ_šfo_£t_uri
(h—d”, uri)

	)

86 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_allow.h

20 #iâdeà
_OSIP_ALLOW_H_


21 
	#_OSIP_ALLOW_H_


	)

23 
	~<os·r£r2/h—d”s/os_cÚ‹Á_Ëngth.h
>

40 
os_cÚ‹Á_Ëngth_t
 
	tos_®low_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_®low_š™
(
h—d”
è
	`os_cÚ‹Á_Ëngth_š™
(h—d”)

	)

56 
	#os_®low_·r£
(
h—d”
, 
hv®ue
è
	`os_cÚ‹Á_Ëngth_·r£
(h—d”, hv®ue)

	)

62 
	#os_®low_to_¡r
 
os_cÚ‹Á_Ëngth_to_¡r


	)

67 
	#os_®low_ä“
 
os_cÚ‹Á_Ëngth_ä“


	)

73 
	#os_®low_şÚe
 
os_cÚ‹Á_Ëngth_şÚe


	)

75 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authentication_info.h

20 #iâdeà
_OSIP_AUTHENTICATION_INFO_H_


21 
	#_OSIP_AUTHENTICATION_INFO_H_


	)

38 
os_auth’tiÿtiÚ_šfo
 
	tos_auth’tiÿtiÚ_šfo_t
;

44 
	sos_auth’tiÿtiÚ_šfo
 {

45 *
	mauth_ty³
;

46 *
	mÃxŠÚû
;

47 *
	mqİ_İtiÚs
;

48 *
	mr¥auth
;

49 *
	múÚû
;

50 *
	mnÚû_couÁ
;

51 *
	m¢um
;

52 *
	m¤ªd
;

53 *
	m»®m
;

54 *
	mrg‘Çme
;

55 *
	mİaque
;

58 #ifdeà
__ılu¥lus


66 
os_auth’tiÿtiÚ_šfo_š™
(
os_auth’tiÿtiÚ_šfo_t
 **
h—d”
);

72 
os_auth’tiÿtiÚ_šfo_·r£
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, cÚ¡ *
hv®ue
);

78 
os_auth’tiÿtiÚ_šfo_to_¡r
(cÚ¡ 
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, **
de¡
);

83 
os_auth’tiÿtiÚ_šfo_ä“
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

89 
os_auth’tiÿtiÚ_šfo_şÚe
(cÚ¡ 
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, os_auth’tiÿtiÚ_šfo_ˆ**
de¡
);

95 *
os_auth’tiÿtiÚ_šfo_g‘_auth_ty³
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

101 
os_auth’tiÿtiÚ_šfo_£t_auth_ty³
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

106 *
os_auth’tiÿtiÚ_šfo_g‘_ÃxŠÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

112 
os_auth’tiÿtiÚ_šfo_£t_ÃxŠÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

117 *
os_auth’tiÿtiÚ_šfo_g‘_úÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

123 
os_auth’tiÿtiÚ_šfo_£t_úÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

128 *
os_auth’tiÿtiÚ_šfo_g‘_qİ_İtiÚs
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

134 
os_auth’tiÿtiÚ_šfo_£t_qİ_İtiÚs
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

139 *
os_auth’tiÿtiÚ_šfo_g‘_r¥auth
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

145 
os_auth’tiÿtiÚ_šfo_£t_r¥auth
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

150 *
os_auth’tiÿtiÚ_šfo_g‘_nÚû_couÁ
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

156 
os_auth’tiÿtiÚ_šfo_£t_nÚû_couÁ
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

161 *
os_auth’tiÿtiÚ_šfo_g‘_¢um
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

167 
os_auth’tiÿtiÚ_šfo_£t_¢um
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

172 *
os_auth’tiÿtiÚ_šfo_g‘_¤ªd
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

178 
os_auth’tiÿtiÚ_šfo_£t_¤ªd
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

183 *
os_auth’tiÿtiÚ_šfo_g‘_rg‘Çme
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

189 
os_auth’tiÿtiÚ_šfo_£t_rg‘Çme
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

194 *
os_auth’tiÿtiÚ_šfo_g‘_»®m
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

200 
os_auth’tiÿtiÚ_šfo_£t_»®m
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

205 *
os_auth’tiÿtiÚ_šfo_g‘_İaque
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
);

211 
os_auth’tiÿtiÚ_šfo_£t_İaque
(
os_auth’tiÿtiÚ_šfo_t
 *
h—d”
, *
v®ue
);

213 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authorization.h

20 #iâdeà
_OSIP_AUTHORIZATION_H_


21 
	#_OSIP_AUTHORIZATION_H_


	)

38 
os_authÜiz©iÚ
 
	tos_authÜiz©iÚ_t
;

44 
	sos_authÜiz©iÚ
 {

45 *
	mauth_ty³
;

46 *
	mu£ºame
;

47 *
	m»®m
;

48 *
	mnÚû
;

49 *
	muri
;

50 *
	m»¥Ú£
;

51 *
	mdige¡
;

52 *
	m®gÜ™hm
;

53 *
	múÚû
;

54 *
	mİaque
;

55 *
	mmes§ge_qİ
;

56 *
	mnÚû_couÁ
;

57 *
	mv”siÚ
;

58 *
	mrg‘Çme
;

59 *
	mgs§pi_d©a
;

60 *
	müªd
;

61 *
	múum
;

62 *
	mauth_·¿m
;

65 #ifdeà
__ılu¥lus


73 
os_authÜiz©iÚ_š™
(
os_authÜiz©iÚ_t
 **
h—d”
);

79 
os_authÜiz©iÚ_·r£
(
os_authÜiz©iÚ_t
 *
h—d”
, cÚ¡ *
hv®ue
);

85 
os_authÜiz©iÚ_to_¡r
(cÚ¡ 
os_authÜiz©iÚ_t
 *
h—d”
, **
de¡
);

90 
os_authÜiz©iÚ_ä“
(
os_authÜiz©iÚ_t
 *
h—d”
);

96 
os_authÜiz©iÚ_şÚe
(cÚ¡ 
os_authÜiz©iÚ_t
 *
h—d”
, os_authÜiz©iÚ_ˆ**
de¡
);

102 *
os_authÜiz©iÚ_g‘_auth_ty³
(cÚ¡ 
os_authÜiz©iÚ_t
 *
h—d”
);

108 
os_authÜiz©iÚ_£t_auth_ty³
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

113 *
os_authÜiz©iÚ_g‘_u£ºame
(
os_authÜiz©iÚ_t
 *
h—d”
);

119 
os_authÜiz©iÚ_£t_u£ºame
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

124 *
os_authÜiz©iÚ_g‘_»®m
(
os_authÜiz©iÚ_t
 *
h—d”
);

130 
os_authÜiz©iÚ_£t_»®m
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

135 *
os_authÜiz©iÚ_g‘_nÚû
(
os_authÜiz©iÚ_t
 *
h—d”
);

141 
os_authÜiz©iÚ_£t_nÚû
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

146 *
os_authÜiz©iÚ_g‘_uri
(
os_authÜiz©iÚ_t
 *
h—d”
);

152 
os_authÜiz©iÚ_£t_uri
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

157 *
os_authÜiz©iÚ_g‘_»¥Ú£
(
os_authÜiz©iÚ_t
 *
h—d”
);

163 
os_authÜiz©iÚ_£t_»¥Ú£
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

168 *
os_authÜiz©iÚ_g‘_dige¡
(
os_authÜiz©iÚ_t
 *
h—d”
);

174 
os_authÜiz©iÚ_£t_dige¡
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

179 *
os_authÜiz©iÚ_g‘_®gÜ™hm
(
os_authÜiz©iÚ_t
 *
h—d”
);

185 
os_authÜiz©iÚ_£t_®gÜ™hm
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

190 *
os_authÜiz©iÚ_g‘_úÚû
(
os_authÜiz©iÚ_t
 *
h—d”
);

196 
os_authÜiz©iÚ_£t_úÚû
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

201 *
os_authÜiz©iÚ_g‘_İaque
(
os_authÜiz©iÚ_t
 *
h—d”
);

207 
os_authÜiz©iÚ_£t_İaque
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

212 *
os_authÜiz©iÚ_g‘_mes§ge_qİ
(
os_authÜiz©iÚ_t
 *
h—d”
);

218 
os_authÜiz©iÚ_£t_mes§ge_qİ
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

223 *
os_authÜiz©iÚ_g‘_nÚû_couÁ
(
os_authÜiz©iÚ_t
 *
h—d”
);

229 
os_authÜiz©iÚ_£t_nÚû_couÁ
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

234 *
os_authÜiz©iÚ_g‘_v”siÚ
(
os_authÜiz©iÚ_t
 *
h—d”
);

240 
os_authÜiz©iÚ_£t_v”siÚ
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

245 *
os_authÜiz©iÚ_g‘_rg‘Çme
(
os_authÜiz©iÚ_t
 *
h—d”
);

251 
os_authÜiz©iÚ_£t_rg‘Çme
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

256 *
os_authÜiz©iÚ_g‘_gs§pi_d©a
(
os_authÜiz©iÚ_t
 *
h—d”
);

262 
os_authÜiz©iÚ_£t_gs§pi_d©a
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

267 *
os_authÜiz©iÚ_g‘_üªd
(
os_authÜiz©iÚ_t
 *
h—d”
);

273 
os_authÜiz©iÚ_£t_üªd
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

278 *
os_authÜiz©iÚ_g‘_úum
(
os_authÜiz©iÚ_t
 *
h—d”
);

284 
os_authÜiz©iÚ_£t_úum
(
os_authÜiz©iÚ_t
 *
h—d”
, *
v®ue
);

286 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_id.h

20 #iâdeà
_OSIP_CALL_ID_H_


21 
	#_OSIP_CALL_ID_H_


	)

38 
os_ÿÎ_id
 
	tos_ÿÎ_id_t
;

44 
	sos_ÿÎ_id
 {

45 *
	mnumb”
;

46 *
	mho¡
;

49 #ifdeà
__ılu¥lus


57 
os_ÿÎ_id_š™
(
os_ÿÎ_id_t
 **
h—d”
);

62 
os_ÿÎ_id_ä“
(
os_ÿÎ_id_t
 *
h—d”
);

68 
os_ÿÎ_id_·r£
(
os_ÿÎ_id_t
 *
h—d”
, cÚ¡ *
hv®ue
);

74 
os_ÿÎ_id_to_¡r
(cÚ¡ 
os_ÿÎ_id_t
 *
h—d”
, **
de¡
);

80 
os_ÿÎ_id_şÚe
(cÚ¡ 
os_ÿÎ_id_t
 *
h—d”
, os_ÿÎ_id_ˆ**
de¡
);

86 
os_ÿÎ_id_£t_numb”
(
os_ÿÎ_id_t
 *
h—d”
, *
v®ue
);

91 *
os_ÿÎ_id_g‘_numb”
(
os_ÿÎ_id_t
 *
h—d”
);

97 
os_ÿÎ_id_£t_ho¡
(
os_ÿÎ_id_t
 *
h—d”
, *
v®ue
);

102 *
os_ÿÎ_id_g‘_ho¡
(
os_ÿÎ_id_t
 *
h—d”
);

110 
os_ÿÎ_id_m©ch
(
os_ÿÎ_id_t
 *
ÿÎid1
, os_ÿÎ_id_ˆ*
ÿÎid2
);

112 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_info.h

20 #iâdeà
_OSIP_CALL_INFO_H_


21 
	#_OSIP_CALL_INFO_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

40 
os_ÿÎ_šfo
 
	tos_ÿÎ_šfo_t
;

46 
	sos_ÿÎ_šfo
 {

47 *
	m–em’t
;

48 
os_li¡_t
 
	mg’_·¿ms
;

51 #ifdeà
__ılu¥lus


59 
os_ÿÎ_šfo_š™
(
os_ÿÎ_šfo_t
 **
h—d”
);

64 
os_ÿÎ_šfo_ä“
(
os_ÿÎ_šfo_t
 *
h—d”
);

70 
os_ÿÎ_šfo_·r£
(
os_ÿÎ_šfo_t
 *
h—d”
, cÚ¡ *
hv®ue
);

76 
os_ÿÎ_šfo_to_¡r
(cÚ¡ 
os_ÿÎ_šfo_t
 *
h—d”
, **
de¡
);

82 
os_ÿÎ_šfo_şÚe
(cÚ¡ 
os_ÿÎ_šfo_t
 *
h—d”
, os_ÿÎ_šfo_ˆ**
de¡
);

87 *
os_ÿÎ_šfo_g‘_uri
(
os_ÿÎ_šfo_t
 *
h—d”
);

93 
os_ÿÎ_šfo_£t_uri
(
os_ÿÎ_šfo_t
 *
h—d”
, *
uri
);

95 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_contact.h

20 #iâdeà
_OSIP_CONTACT_H_


21 
	#_OSIP_CONTACT_H_


	)

23 
	~<os·r£r2/h—d”s/os_äom.h
>

40 
os_äom_t
 
	tos_cÚù_t
;

42 #ifdeà
__ılu¥lus


46 #iâdeà
MINISIZE


51 
os_cÚù_š™
(
os_cÚù_t
 **
h—d”
);

56 
os_cÚù_ä“
(
os_cÚù_t
 *
h—d”
);

63 
os_cÚù_·r£
(
os_cÚù_t
 *
h—d”
, cÚ¡ *
hv®ue
);

69 
os_cÚù_to_¡r
(cÚ¡ 
os_cÚù_t
 *
h—d”
, **
de¡
);

70 #iâdeà
MINISIZE


76 
os_cÚù_şÚe
(cÚ¡ 
os_cÚù_t
 *
h—d”
, os_cÚù_ˆ**
de¡
);

78 
	#os_cÚù_š™
 
os_äom_š™


	)

79 
	#os_cÚù_ä“
 
os_äom_ä“


	)

80 
	#os_cÚù_şÚe
 
os_äom_şÚe


	)

86 
	#os_cÚù_g‘_di¥ÏyÇme
(
h—d”
è
	`os_äom_g‘_di¥ÏyÇme
((
os_äom_t
 *èh—d”)

	)

92 
	#os_cÚù_£t_di¥ÏyÇme
(
h—d”
, 
v®ue
è
	`os_äom_£t_di¥ÏyÇme
((
os_äom_t
 *èh—d”, v®ue)

	)

97 
	#os_cÚù_g‘_u¾
(
h—d”
è
	`os_äom_g‘_u¾
((
os_äom_t
 *èh—d”)

	)

103 
	#os_cÚù_£t_u¾
(
h—d”
, 
u¾
è
	`os_äom_£t_u¾
((
os_äom_t
 *èh—d”, u¾)

	)

110 
	#os_cÚù_·¿m_g‘
(
h—d”
, 
pos
, 
de¡
è
	`os_äom_·¿m_g‘
((
os_äom_t
 *èh—d”,…os, de¡)

	)

117 
	#os_cÚù_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

124 
	#os_cÚù_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

126 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_disposition.h

20 #iâdeà
_OSIP_CONTENT_DISPOSITION_H_


21 
	#_OSIP_CONTENT_DISPOSITION_H_


	)

23 
	~<os·r£r2/h—d”s/os_ÿÎ_šfo.h
>

40 
os_ÿÎ_šfo_t
 
	tos_cÚ‹Á_di¥os™iÚ_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_cÚ‹Á_di¥os™iÚ_š™
(
h—d”
è
	`os_ÿÎ_šfo_š™
(h—d”)

	)

55 
	#os_cÚ‹Á_di¥os™iÚ_ä“
(
h—d”
è
	`os_ÿÎ_šfo_ä“
(h—d”)

	)

61 
os_cÚ‹Á_di¥os™iÚ_·r£
(
os_cÚ‹Á_di¥os™iÚ_t
 *
h—d”
, cÚ¡ *
hv®ue
);

67 
	#os_cÚ‹Á_di¥os™iÚ_to_¡r
(
h—d”
, 
de¡
è
	`os_ÿÎ_šfo_to_¡r
(h—d”, de¡)

	)

73 
	#os_cÚ‹Á_di¥os™iÚ_şÚe
 
os_ÿÎ_šfo_şÚe


	)

81 
	#os_cÚ‹Á_di¥os™iÚ_£t_ty³
(
h—d”
, 
v®ue
è
	`os_ÿÎ_šfo_£t_uri
(h—d”, v®ue)

	)

86 
	#os_cÚ‹Á_di¥os™iÚ_g‘_ty³
(
h—d”
è
	`os_ÿÎ_šfo_g‘_uri
(h—d”)

	)

88 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_encoding.h

20 #iâdeà
_OSIP_CONTENT_ENCODING_H_


21 
	#_OSIP_CONTENT_ENCODING_H_


	)

23 
	~<os·r£r2/h—d”s/os_cÚ‹Á_Ëngth.h
>

40 
os_cÚ‹Á_Ëngth_t
 
	tos_cÚ‹Á_’codšg_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_cÚ‹Á_’codšg_š™
(
h—d”
è
	`os_cÚ‹Á_Ëngth_š™
(h—d”)

	)

56 
	#os_cÚ‹Á_’codšg_·r£
(
h—d”
, 
hv®ue
è
	`os_cÚ‹Á_Ëngth_·r£
(h—d”, hv®ue)

	)

62 
	#os_cÚ‹Á_’codšg_to_¡r
 
os_cÚ‹Á_Ëngth_to_¡r


	)

67 
	#os_cÚ‹Á_’codšg_ä“
 
os_cÚ‹Á_Ëngth_ä“


	)

73 
	#os_cÚ‹Á_’codšg_şÚe
 
os_cÚ‹Á_Ëngth_şÚe


	)

75 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_length.h

20 #iâdeà
_OSIP_CONTENT_LENGTH_H_


21 
	#_OSIP_CONTENT_LENGTH_H_


	)

38 
os_cÚ‹Á_Ëngth
 
	tos_cÚ‹Á_Ëngth_t
;

44 
	sos_cÚ‹Á_Ëngth
 {

45 *
	mv®ue
;

48 #ifdeà
__ılu¥lus


56 
os_cÚ‹Á_Ëngth_š™
(
os_cÚ‹Á_Ëngth_t
 **
h—d”
);

61 
os_cÚ‹Á_Ëngth_ä“
(
os_cÚ‹Á_Ëngth_t
 *
h—d”
);

67 
os_cÚ‹Á_Ëngth_·r£
(
os_cÚ‹Á_Ëngth_t
 *
h—d”
, cÚ¡ *
hv®ue
);

73 
os_cÚ‹Á_Ëngth_to_¡r
(cÚ¡ 
os_cÚ‹Á_Ëngth_t
 *
h—d”
, **
de¡
);

79 
os_cÚ‹Á_Ëngth_şÚe
(cÚ¡ 
os_cÚ‹Á_Ëngth_t
 *
h—d”
, os_cÚ‹Á_Ëngth_ˆ**
de¡
);

81 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_type.h

20 #iâdeà
_OSIP_CONTENT_TYPE_H_


21 
	#_OSIP_CONTENT_TYPE_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

40 
os_cÚ‹Á_ty³
 
	tos_cÚ‹Á_ty³_t
;

46 
	sos_cÚ‹Á_ty³
 {

47 *
	mty³
;

48 *
	msubty³
;

49 
os_li¡_t
 
	mg’_·¿ms
;

52 #ifdeà
__ılu¥lus


60 
os_cÚ‹Á_ty³_š™
(
os_cÚ‹Á_ty³_t
 **
h—d”
);

65 
os_cÚ‹Á_ty³_ä“
(
os_cÚ‹Á_ty³_t
 *
h—d”
);

71 
os_cÚ‹Á_ty³_·r£
(
os_cÚ‹Á_ty³_t
 *
h—d”
, cÚ¡ *
hv®ue
);

77 
os_cÚ‹Á_ty³_to_¡r
(cÚ¡ 
os_cÚ‹Á_ty³_t
 *
h—d”
, **
de¡
);

83 
os_cÚ‹Á_ty³_şÚe
(cÚ¡ 
os_cÚ‹Á_ty³_t
 *
h—d”
, os_cÚ‹Á_ty³_ˆ**
de¡
);

91 
	#os_cÚ‹Á_ty³_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

98 
	#os_cÚ‹Á_ty³_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

100 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_cseq.h

20 #iâdeà
_OSIP_CSEQ_H_


21 
	#_OSIP_CSEQ_H_


	)

38 
os_c£q
 
	tos_c£q_t
;

44 
	sos_c£q
 {

45 *
	mm‘hod
;

46 *
	mnumb”
;

49 #ifdeà
__ılu¥lus


57 
os_c£q_š™
(
os_c£q_t
 **
h—d”
);

62 
os_c£q_ä“
(
os_c£q_t
 *
h—d”
);

68 
os_c£q_·r£
(
os_c£q_t
 *
h—d”
, cÚ¡ *
hv®ue
);

74 
os_c£q_to_¡r
(cÚ¡ 
os_c£q_t
 *
h—d”
, **
de¡
);

80 
os_c£q_şÚe
(cÚ¡ 
os_c£q_t
 *
h—d”
, os_c£q_ˆ**
de¡
);

86 
os_c£q_£t_numb”
(
os_c£q_t
 *
h—d”
, *
v®ue
);

91 *
os_c£q_g‘_numb”
(
os_c£q_t
 *
h—d”
);

97 
os_c£q_£t_m‘hod
(
os_c£q_t
 *
h—d”
, *
v®ue
);

102 *
os_c£q_g‘_m‘hod
(
os_c£q_t
 *
h—d”
);

110 
os_c£q_m©ch
(
os_c£q_t
 *
c£q1
, os_c£q_ˆ*
c£q2
);

112 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_error_info.h

20 #iâdeà
_OSIP_ERROR_INFO_H_


21 
	#_OSIP_ERROR_INFO_H_


	)

23 
	~<os·r£r2/h—d”s/os_ÿÎ_šfo.h
>

40 
os_ÿÎ_šfo_t
 
	tos_”rÜ_šfo_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_”rÜ_šfo_š™
(
h—d”
è
	`os_ÿÎ_šfo_š™
(h—d”)

	)

55 
	#os_”rÜ_šfo_ä“
 
os_ÿÎ_šfo_ä“


	)

61 
	#os_”rÜ_šfo_·r£
(
h—d”
, 
hv®ue
è
	`os_ÿÎ_šfo_·r£
(h—d”, hv®ue)

	)

67 
	#os_”rÜ_šfo_to_¡r
(
h—d”
, 
de¡
è
	`os_ÿÎ_šfo_to_¡r
(h—d”, de¡)

	)

73 
	#os_”rÜ_šfo_şÚe
 
os_ÿÎ_šfo_şÚe


	)

80 
	#os_”rÜ_šfo_£t_uri
(
h—d”
, 
uri
è
	`os_ÿÎ_šfo_£t_uri
(h—d”, uri)

	)

85 
	#os_”rÜ_šfo_g‘_uri
(
h—d”
è
	`os_ÿÎ_šfo_g‘_uri
(h—d”)

	)

87 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_from.h

20 #iâdeà
_OSIP_FROM_H_


21 
	#_OSIP_FROM_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

24 
	~<os·r£r2/os_uri.h
>

41 
os_äom
 
	tos_äom_t
;

47 
	sos_äom
 {

48 *
	mdi¥ÏyÇme
;

49 
os_uri_t
 *
	mu¾
;

50 
os_li¡_t
 
	mg’_·¿ms
;

53 #ifdeà
__ılu¥lus


61 
os_äom_š™
(
os_äom_t
 **
h—d”
);

66 
os_äom_ä“
(
os_äom_t
 *
h—d”
);

72 
os_äom_·r£
(
os_äom_t
 *
h—d”
, cÚ¡ *
hv®ue
);

78 
os_äom_to_¡r
(cÚ¡ 
os_äom_t
 *
h—d”
, **
de¡
);

84 
os_äom_şÚe
(cÚ¡ 
os_äom_t
 *
h—d”
, os_äom_ˆ**
de¡
);

90 
os_äom_£t_di¥ÏyÇme
(
os_äom_t
 *
h—d”
, *
v®ue
);

95 *
os_äom_g‘_di¥ÏyÇme
(
os_äom_t
 *
h—d”
);

101 
os_äom_£t_u¾
(
os_äom_t
 *
h—d”
, 
os_uri_t
 *
u¾
);

106 
os_uri_t
 *
os_äom_g‘_u¾
(
os_äom_t
 *
h—d”
);

113 
os_äom_·¿m_g‘
(
os_äom_t
 *
h—d”
, 
pos
, 
os_g’”ic_·¿m_t
 **
de¡
);

120 
	#os_äom_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

127 
	#os_äom_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

134 
	#os_äom_g‘_g
(
h—d”
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
), "g", de¡)

	)

140 
	#os_äom_£t_g
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
), 
	`os_¡rdup
("g"), v®ue)

	)

142 #iâdeà
DOXYGEN


144 
os_äom_com·»
(
os_äom_t
 *
h—d”1
, os_äom_ˆ*
h—d”2
);

153 
os_äom_g_m©ch
(
os_äom_t
 *
äom1
, os_äom_ˆ*
äom2
);

155 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_header.h

20 #iâdeà
_OSIP_HEADER_H_


21 
	#_OSIP_HEADER_H_


	)

23 
	~<os·r£r2/os_uri.h
>

45 
os_h—d”
 
	tos_h—d”_t
;

51 
	sos_h—d”
 {

52 *
	mhÇme
;

53 *
	mhv®ue
;

63 
os_uri_·¿m_t
 
	tos_g’”ic_·¿m_t
;

65 #ifdeà
__ılu¥lus


73 
os_h—d”_š™
(
os_h—d”_t
 **
h—d”
);

78 
os_h—d”_ä“
(
os_h—d”_t
 *
h—d”
);

84 
os_h—d”_to_¡r
(cÚ¡ 
os_h—d”_t
 *
h—d”
, **
de¡
);

89 *
os_h—d”_g‘_Çme
(cÚ¡ 
os_h—d”_t
 *
h—d”
);

95 
os_h—d”_£t_Çme
(
os_h—d”_t
 *
h—d”
, *
²ame
);

100 *
os_h—d”_g‘_v®ue
(cÚ¡ 
os_h—d”_t
 *
h—d”
);

106 
os_h—d”_£t_v®ue
(
os_h—d”_t
 *
h—d”
, *
pv®ue
);

112 
os_h—d”_şÚe
(cÚ¡ 
os_h—d”_t
 *
h—d”
, os_h—d”_ˆ**
de¡
);

114 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_mime_version.h

20 #iâdeà
_OSIP_MIME_VERSION_H_


21 
	#_OSIP_MIME_VERSION_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

24 
	~<os·r£r2/os_uri.h
>

41 
os_cÚ‹Á_Ëngth_t
 
	tos_mime_v”siÚ_t
;

43 #ifdeà
__ılu¥lus


51 
	#os_mime_v”siÚ_š™
(
h—d”
è
	`os_cÚ‹Á_Ëngth_š™
(h—d”)

	)

57 
	#os_mime_v”siÚ_·r£
(
h—d”
, 
hv®ue
è
	`os_cÚ‹Á_Ëngth_·r£
(h—d”, hv®ue)

	)

63 
	#os_mime_v”siÚ_to_¡r
(
h—d”
, 
de¡
è
	`os_cÚ‹Á_Ëngth_to_¡r
(h—d”, de¡)

	)

68 
	#os_mime_v”siÚ_ä“
(
h—d”
è
	`os_cÚ‹Á_Ëngth_ä“
(h—d”)

	)

74 
	#os_mime_v”siÚ_şÚe
 
os_cÚ‹Á_Ëngth_şÚe


	)

76 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authenticate.h

20 #iâdeà
_OSIP_PROXY_AUHTHENTICATE_H_


21 
	#_OSIP_PROXY_AUHTHENTICATE_H_


	)

23 
	~<os·r£r2/h—d”s/os_www_auth’tiÿ‹.h
>

40 
os_www_auth’tiÿ‹_t
 
	tos_´oxy_auth’tiÿ‹_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_´oxy_auth’tiÿ‹_š™
(
h—d”
è
	`os_www_auth’tiÿ‹_š™
(h—d”)

	)

56 
	#os_´oxy_auth’tiÿ‹_·r£
(
h—d”
, 
hv®ue
è
	`os_www_auth’tiÿ‹_·r£
(h—d”, hv®ue)

	)

62 
	#os_´oxy_auth’tiÿ‹_to_¡r
(
h—d”
, 
de¡
è
	`os_www_auth’tiÿ‹_to_¡r
(h—d”, de¡)

	)

67 
	#os_´oxy_auth’tiÿ‹_ä“
 
os_www_auth’tiÿ‹_ä“


	)

73 
	#os_´oxy_auth’tiÿ‹_şÚe
 
os_www_auth’tiÿ‹_şÚe


	)

79 
	#os_´oxy_auth’tiÿ‹_g‘_auth_ty³
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_auth_ty³
(h—d”)

	)

85 
	#os_´oxy_auth’tiÿ‹_£t_auth_ty³
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_auth_ty³
(h—d”, v®ue)

	)

90 
	#os_´oxy_auth’tiÿ‹_g‘_»®m
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_»®m
(h—d”)

	)

96 
	#os_´oxy_auth’tiÿ‹_£t_»®m
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_»®m
(h—d”, v®ue)

	)

101 
	#os_´oxy_auth’tiÿ‹_g‘_domaš
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_domaš
(h—d”)

	)

107 
	#os_´oxy_auth’tiÿ‹_£t_domaš
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_domaš
(h—d”, v®ue)

	)

112 
	#os_´oxy_auth’tiÿ‹_g‘_nÚû
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_nÚû
(h—d”)

	)

118 
	#os_´oxy_auth’tiÿ‹_£t_nÚû
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_nÚû
(h—d”, v®ue)

	)

123 
	#os_´oxy_auth’tiÿ‹_g‘_İaque
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_İaque
(h—d”)

	)

129 
	#os_´oxy_auth’tiÿ‹_£t_İaque
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_İaque
(h—d”, v®ue)

	)

134 
	#os_´oxy_auth’tiÿ‹_g‘_¡®e
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_¡®e
(h—d”)

	)

140 
	#os_´oxy_auth’tiÿ‹_£t_¡®e
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_¡®e
(h—d”, v®ue)

	)

145 
	#os_´oxy_auth’tiÿ‹_£t_¡®e_Œue
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_¡®e
(h—d”, 
	`os_¡rdup
("Œue"))

	)

150 
	#os_´oxy_auth’tiÿ‹_£t_¡®e_çl£
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_¡®e
(h—d”, 
	`os_¡rdup
("çl£"))

	)

155 
	#os_´oxy_auth’tiÿ‹_g‘_®gÜ™hm
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_®gÜ™hm
(h—d”)

	)

161 
	#os_´oxy_auth’tiÿ‹_£t_®gÜ™hm
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_®gÜ™hm
(h—d”, v®ue)

	)

166 
	#os_´oxy_auth’tiÿ‹_£t_®gÜ™hm_MD5
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_®gÜ™hm
(h—d”, 
	`os_¡rdup
("MD5"))

	)

171 
	#os_´oxy_auth’tiÿ‹_g‘_qİ_İtiÚs
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_qİ_İtiÚs
(h—d”)

	)

177 
	#os_´oxy_auth’tiÿ‹_£t_qİ_İtiÚs
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_qİ_İtiÚs
(h—d”, v®ue)

	)

182 
	#os_´oxy_auth’tiÿ‹_g‘_v”siÚ
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_v”siÚ
(h—d”)

	)

188 
	#os_´oxy_auth’tiÿ‹_£t_v”siÚ
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_v”siÚ
(h—d”, v®ue)

	)

193 
	#os_´oxy_auth’tiÿ‹_g‘_rg‘Çme
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_rg‘Çme
(h—d”)

	)

199 
	#os_´oxy_auth’tiÿ‹_£t_rg‘Çme
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_rg‘Çme
(h—d”, v®ue)

	)

204 
	#os_´oxy_auth’tiÿ‹_g‘_gs§pi_d©a
(
h—d”
è
	`os_www_auth’tiÿ‹_g‘_gs§pi_d©a
(h—d”)

	)

210 
	#os_´oxy_auth’tiÿ‹_£t_gs§pi_d©a
(
h—d”
, 
v®ue
è
	`os_www_auth’tiÿ‹_£t_gs§pi_d©a
(h—d”, v®ue)

	)

212 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authentication_info.h

20 #iâdeà
_OSIP_PROXY_AUTHENTICATION_INFO_H_


21 
	#_OSIP_PROXY_AUTHENTICATION_INFO_H_


	)

23 
	~<os·r£r2/h—d”s/os_auth’tiÿtiÚ_šfo.h
>

40 
os_auth’tiÿtiÚ_šfo_t
 
	tos_´oxy_auth’tiÿtiÚ_šfo_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_´oxy_auth’tiÿtiÚ_šfo_š™
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_š™
(h—d”)

	)

56 
	#os_´oxy_auth’tiÿtiÚ_šfo_·r£
(
h—d”
, 
hv®ue
è
	`os_auth’tiÿtiÚ_šfo_·r£
(h—d”, hv®ue)

	)

62 
	#os_´oxy_auth’tiÿtiÚ_šfo_to_¡r
(
h—d”
, 
de¡
è
	`os_auth’tiÿtiÚ_šfo_to_¡r
(h—d”, de¡)

	)

67 
	#os_´oxy_auth’tiÿtiÚ_šfo_ä“
 
os_auth’tiÿtiÚ_šfo_ä“


	)

73 
	#os_´oxy_auth’tiÿtiÚ_šfo_şÚe
 
os_auth’tiÿtiÚ_šfo_şÚe


	)

79 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_ÃxŠÚû
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_ÃxŠÚû
(h—d”)

	)

85 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_ÃxŠÚû
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_ÃxŠÚû
(h—d”, v®ue)

	)

90 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_úÚû
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_úÚû
(h—d”)

	)

96 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_úÚû
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_úÚû
(h—d”, v®ue)

	)

101 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_qİ_İtiÚs
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_qİ_İtiÚs
(h—d”)

	)

107 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_qİ_İtiÚs
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_qİ_İtiÚs
(h—d”, v®ue)

	)

112 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_r¥auth
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_r¥auth
(h—d”)

	)

118 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_r¥auth
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_r¥auth
(h—d”, v®ue)

	)

123 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_nÚû_couÁ
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_nÚû_couÁ
(h—d”)

	)

129 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_nÚû_couÁ
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_nÚû_couÁ
(h—d”, v®ue)

	)

134 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_¢um
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_¢um
(h—d”)

	)

140 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_¢um
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_¢um
(h—d”, v®ue)

	)

145 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_¤ªd
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_¤ªd
(h—d”)

	)

151 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_¤ªd
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_¤ªd
(h—d”, v®ue)

	)

156 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_rg‘Çme
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_rg‘Çme
(h—d”)

	)

162 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_rg‘Çme
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_rg‘Çme
(h—d”, v®ue)

	)

167 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_»®m
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_»®m
(h—d”)

	)

173 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_»®m
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_»®m
(h—d”, v®ue)

	)

178 
	#os_´oxy_auth’tiÿtiÚ_šfo_g‘_İaque
(
h—d”
è
	`os_auth’tiÿtiÚ_šfo_g‘_İaque
(h—d”)

	)

184 
	#os_´oxy_auth’tiÿtiÚ_šfo_£t_İaque
(
h—d”
, 
v®ue
è
	`os_auth’tiÿtiÚ_šfo_£t_İaque
(h—d”, v®ue)

	)

186 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authorization.h

20 #iâdeà
_OSIP_PROXY_AUHTHORIZATION_H_


21 
	#_OSIP_PROXY_AUHTHORIZATION_H_


	)

23 
	~<os·r£r2/h—d”s/os_authÜiz©iÚ.h
>

40 
os_authÜiz©iÚ_t
 
	tos_´oxy_authÜiz©iÚ_t
;

42 #ifdeà
__ılu¥lus


50 
	#os_´oxy_authÜiz©iÚ_š™
(
h—d”
è
	`os_authÜiz©iÚ_š™
(h—d”)

	)

56 
	#os_´oxy_authÜiz©iÚ_·r£
(
h—d”
, 
hv®ue
è
	`os_authÜiz©iÚ_·r£
(h—d”, hv®ue)

	)

62 
	#os_´oxy_authÜiz©iÚ_to_¡r
(
h—d”
, 
de¡
è
	`os_authÜiz©iÚ_to_¡r
(h—d”, de¡)

	)

67 
	#os_´oxy_authÜiz©iÚ_ä“
 
os_authÜiz©iÚ_ä“


	)

73 
	#os_´oxy_authÜiz©iÚ_şÚe
 
os_authÜiz©iÚ_şÚe


	)

79 
	#os_´oxy_authÜiz©iÚ_g‘_auth_ty³
(
h—d”
è
	`os_authÜiz©iÚ_g‘_auth_ty³
(h—d”)

	)

85 
	#os_´oxy_authÜiz©iÚ_£t_auth_ty³
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_auth_ty³
(h—d”, v®ue)

	)

90 
	#os_´oxy_authÜiz©iÚ_g‘_u£ºame
(
h—d”
è
	`os_authÜiz©iÚ_g‘_u£ºame
(h—d”)

	)

96 
	#os_´oxy_authÜiz©iÚ_£t_u£ºame
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_u£ºame
(h—d”, v®ue)

	)

101 
	#os_´oxy_authÜiz©iÚ_g‘_»®m
(
h—d”
è
	`os_authÜiz©iÚ_g‘_»®m
(h—d”)

	)

107 
	#os_´oxy_authÜiz©iÚ_£t_»®m
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_»®m
(h—d”, v®ue)

	)

112 
	#os_´oxy_authÜiz©iÚ_g‘_nÚû
(
h—d”
è
	`os_authÜiz©iÚ_g‘_nÚû
(h—d”)

	)

118 
	#os_´oxy_authÜiz©iÚ_£t_nÚû
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_nÚû
(h—d”, v®ue)

	)

123 
	#os_´oxy_authÜiz©iÚ_g‘_uri
(
h—d”
è
	`os_authÜiz©iÚ_g‘_uri
(h—d”)

	)

129 
	#os_´oxy_authÜiz©iÚ_£t_uri
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_uri
(h—d”, v®ue)

	)

134 
	#os_´oxy_authÜiz©iÚ_g‘_»¥Ú£
(
h—d”
è
	`os_authÜiz©iÚ_g‘_»¥Ú£
(h—d”)

	)

140 
	#os_´oxy_authÜiz©iÚ_£t_»¥Ú£
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_»¥Ú£
(h—d”, v®ue)

	)

145 
	#os_´oxy_authÜiz©iÚ_g‘_dige¡
(
h—d”
è
	`os_authÜiz©iÚ_g‘_dige¡
(h—d”)

	)

151 
	#os_´oxy_authÜiz©iÚ_£t_dige¡
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_dige¡
(h—d”, v®ue)

	)

156 
	#os_´oxy_authÜiz©iÚ_g‘_®gÜ™hm
(
h—d”
è
	`os_authÜiz©iÚ_g‘_®gÜ™hm
(h—d”)

	)

162 
	#os_´oxy_authÜiz©iÚ_£t_®gÜ™hm
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_®gÜ™hm
(h—d”, v®ue)

	)

167 
	#os_´oxy_authÜiz©iÚ_g‘_úÚû
(
h—d”
è
	`os_authÜiz©iÚ_g‘_úÚû
(h—d”)

	)

173 
	#os_´oxy_authÜiz©iÚ_£t_úÚû
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_úÚû
(h—d”, v®ue)

	)

178 
	#os_´oxy_authÜiz©iÚ_g‘_İaque
(
h—d”
è
	`os_authÜiz©iÚ_g‘_İaque
(h—d”)

	)

184 
	#os_´oxy_authÜiz©iÚ_£t_İaque
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_İaque
(h—d”, v®ue)

	)

189 
	#os_´oxy_authÜiz©iÚ_g‘_mes§ge_qİ
(
h—d”
è
	`os_authÜiz©iÚ_g‘_mes§ge_qİ
(h—d”)

	)

195 
	#os_´oxy_authÜiz©iÚ_£t_mes§ge_qİ
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_mes§ge_qİ
(h—d”, v®ue)

	)

200 
	#os_´oxy_authÜiz©iÚ_g‘_nÚû_couÁ
(
h—d”
è
	`os_authÜiz©iÚ_g‘_nÚû_couÁ
(h—d”)

	)

206 
	#os_´oxy_authÜiz©iÚ_£t_nÚû_couÁ
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_nÚû_couÁ
(h—d”, v®ue)

	)

211 
	#os_´oxy_authÜiz©iÚ_g‘_v”siÚ
(
h—d”
è
	`os_authÜiz©iÚ_g‘_v”siÚ
(h—d”)

	)

217 
	#os_´oxy_authÜiz©iÚ_£t_v”siÚ
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_v”siÚ
(h—d”, v®ue)

	)

222 
	#os_´oxy_authÜiz©iÚ_g‘_rg‘Çme
(
h—d”
è
	`os_authÜiz©iÚ_g‘_rg‘Çme
(h—d”)

	)

228 
	#os_´oxy_authÜiz©iÚ_£t_rg‘Çme
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_rg‘Çme
(h—d”, v®ue)

	)

233 
	#os_´oxy_authÜiz©iÚ_g‘_gs§pi_d©a
(
h—d”
è
	`os_authÜiz©iÚ_g‘_gs§pi_d©a
(h—d”)

	)

239 
	#os_´oxy_authÜiz©iÚ_£t_gs§pi_d©a
(
h—d”
, 
v®ue
è
	`os_authÜiz©iÚ_£t_gs§pi_d©a
(h—d”, v®ue)

	)

241 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_record_route.h

20 #iâdeà
_OSIP_RECORD_ROUTE_H_


21 
	#_OSIP_RECORD_ROUTE_H_


	)

23 
	~<os·r£r2/h—d”s/os_äom.h
>

40 
os_äom_t
 
	tos_»cÜd_rou‹_t
;

42 #ifdeà
__ılu¥lus


46 #iâdeà
MINISIZE


51 
os_»cÜd_rou‹_š™
(
os_»cÜd_rou‹_t
 **
h—d”
);

56 
os_»cÜd_rou‹_ä“
(
os_»cÜd_rou‹_t
 *
h—d”
);

62 
os_»cÜd_rou‹_·r£
(
os_»cÜd_rou‹_t
 *
h—d”
, cÚ¡ *
hv®ue
);

68 
os_»cÜd_rou‹_to_¡r
(cÚ¡ 
os_»cÜd_rou‹_t
 *
h—d”
, **
de¡
);

74 
	#os_»cÜd_rou‹_şÚe
 
os_äom_şÚe


	)

76 
	#os_»cÜd_rou‹_š™
 
os_äom_š™


	)

77 
	#os_»cÜd_rou‹_ä“
 
os_äom_ä“


	)

78 
	#os_»cÜd_rou‹_·r£
 
os_äom_·r£


	)

79 
	#os_»cÜd_rou‹_to_¡r
 
os_äom_to_¡r


	)

80 
	#os_»cÜd_rou‹_şÚe
 
os_äom_şÚe


	)

87 
	#os_»cÜd_rou‹_£t_u¾
(
h—d”
, 
u¾
è
	`os_äom_£t_u¾
((
os_äom_t
 *èh—d”, u¾)

	)

92 
	#os_»cÜd_rou‹_g‘_u¾
(
h—d”
è
	`os_äom_g‘_u¾
((
os_äom_t
 *èh—d”)

	)

99 
	#os_»cÜd_rou‹_·¿m_g‘
(
h—d”
, 
pos
, 
de¡
è
	`os_äom_·¿m_g‘
((
os_äom_t
 *èh—d”,…os, de¡)

	)

106 
	#os_»cÜd_rou‹_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

113 
	#os_»cÜd_rou‹_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

115 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_route.h

20 #iâdeà
_OSIP_RECORD_H_


21 
	#_OSIP_RECORD_H_


	)

23 
	~<os·r£r2/h—d”s/os_äom.h
>

40 
os_äom_t
 
	tos_rou‹_t
;

42 #ifdeà
__ılu¥lus


46 #iâdeà
MINISIZE


51 
os_rou‹_š™
(
os_rou‹_t
 **
h—d”
);

56 
os_rou‹_ä“
(
os_rou‹_t
 *
h—d”
);

62 
os_rou‹_·r£
(
os_rou‹_t
 *
h—d”
, cÚ¡ *
hv®ue
);

68 
os_rou‹_to_¡r
(cÚ¡ 
os_rou‹_t
 *
h—d”
, **
de¡
);

74 
	#os_rou‹_şÚe
 
os_äom_şÚe


	)

76 
	#os_rou‹_š™
 
os_äom_š™


	)

77 
	#os_rou‹_ä“
 
os_äom_ä“


	)

78 
	#os_rou‹_·r£
 
os_äom_·r£


	)

79 
	#os_rou‹_to_¡r
 
os_äom_to_¡r


	)

80 
	#os_rou‹_şÚe
 
os_äom_şÚe


	)

87 
	#os_rou‹_£t_u¾
(
h—d”
, 
u¾
è
	`os_äom_£t_u¾
((
os_äom_t
 *èh—d”, u¾)

	)

92 
	#os_rou‹_g‘_u¾
(
h—d”
è
	`os_äom_g‘_u¾
((
os_äom_t
 *èh—d”)

	)

99 
	#os_rou‹_·¿m_g‘
(
h—d”
, 
pos
, 
de¡
è
	`os_äom_·¿m_g‘
((
os_äom_t
 *èh—d”,…os, de¡)

	)

106 
	#os_rou‹_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

113 
	#os_rou‹_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

115 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_to.h

20 #iâdeà
_OSIP_TO_H_


21 
	#_OSIP_TO_H_


	)

23 
	~<os·r£r2/h—d”s/os_äom.h
>

40 
os_äom_t
 
	tos_to_t
;

42 #ifdeà
__ılu¥lus


46 #iâdeà
MINISIZE


51 
os_to_š™
(
os_to_t
 **
h—d”
);

56 
os_to_ä“
(
os_to_t
 *
h—d”
);

62 
os_to_·r£
(
os_to_t
 *
h—d”
, cÚ¡ *
hv®ue
);

68 
os_to_to_¡r
(cÚ¡ 
os_to_t
 *
h—d”
, **
de¡
);

74 
os_to_şÚe
(cÚ¡ 
os_to_t
 *
h—d”
, os_to_ˆ**
de¡
);

81 
os_to_g_m©ch
(
os_to_t
 *
to1
, os_to_ˆ*
to2
);

83 
	#os_to_š™
 
os_äom_š™


	)

84 
	#os_to_ä“
 
os_äom_ä“


	)

85 
	#os_to_·r£
 
os_äom_·r£


	)

86 
	#os_to_to_¡r
 
os_äom_to_¡r


	)

87 
	#os_to_şÚe
 
os_äom_şÚe


	)

88 
	#os_to_g_m©ch
 
os_äom_g_m©ch


	)

95 
	#os_to_£t_di¥ÏyÇme
(
h—d”
, 
v®ue
è
	`os_äom_£t_di¥ÏyÇme
((
os_äom_t
 *èh—d”, v®ue)

	)

100 
	#os_to_g‘_di¥ÏyÇme
(
h—d”
è
	`os_äom_g‘_di¥ÏyÇme
((
os_äom_t
 *èh—d”)

	)

106 
	#os_to_£t_u¾
(
h—d”
, 
u¾
è
	`os_äom_£t_u¾
((
os_äom_t
 *èh—d”, u¾)

	)

111 
	#os_to_g‘_u¾
(
h—d”
è
	`os_äom_g‘_u¾
((
os_äom_t
 *èh—d”)

	)

118 
	#os_to_·¿m_g‘
(
h—d”
, 
pos
, 
de¡
è
	`os_äom_·¿m_g‘
((
os_äom_t
 *èh—d”,…os, de¡)

	)

125 
	#os_to_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
),‚ame, de¡)

	)

132 
	#os_to_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
),‚ame, v®ue)

	)

139 
	#os_to_£t_g
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
g’_·¿ms
), 
	`os_¡rdup
("g"), v®ue)

	)

145 
	#os_to_g‘_g
(
h—d”
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
g’_·¿ms
), "g", de¡)

	)

147 #iâdeà
DOXYGEN


149 
	#os_to_com·»
(
h—d”1
, 
h—d”2
è
	`os_äom_com·»
((
os_äom_t
 *èh—d”1, (os_äom_ˆ*èh—d”2)

	)

152 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_via.h

20 #iâdeà
_OSIP_VIA_H_


21 
	#_OSIP_VIA_H_


	)

23 
	~<os·r£r2/os_li¡.h
>

40 
os_vŸ
 
	tos_vŸ_t
;

46 
	sos_vŸ
 {

47 *
	mv”siÚ
;

48 *
	m´ÙocŞ
;

49 *
	mho¡
;

50 *
	mpÜt
;

51 *
	mcomm’t
;

52 
os_li¡_t
 
	mvŸ_·¿ms
;

55 #ifdeà
__ılu¥lus


63 
os_vŸ_š™
(
os_vŸ_t
 **
h—d”
);

68 
os_vŸ_ä“
(
os_vŸ_t
 *
h—d”
);

74 
os_vŸ_·r£
(
os_vŸ_t
 *
h—d”
, cÚ¡ *
hv®ue
);

80 
os_vŸ_to_¡r
(cÚ¡ 
os_vŸ_t
 *
h—d”
, **
de¡
);

86 
os_vŸ_şÚe
(cÚ¡ 
os_vŸ_t
 *
h—d”
, os_vŸ_ˆ**
de¡
);

92 
vŸ_£t_v”siÚ
(
os_vŸ_t
 *
h—d”
, *
v®ue
);

93 
	#os_vŸ_£t_v”siÚ
 
vŸ_£t_v”siÚ


	)

98 *
vŸ_g‘_v”siÚ
(
os_vŸ_t
 *
h—d”
);

99 
	#os_vŸ_g‘_v”siÚ
 
vŸ_g‘_v”siÚ


	)

105 
vŸ_£t_´ÙocŞ
(
os_vŸ_t
 *
h—d”
, *
v®ue
);

106 
	#os_vŸ_£t_´ÙocŞ
 
vŸ_£t_´ÙocŞ


	)

111 *
vŸ_g‘_´ÙocŞ
(
os_vŸ_t
 *
h—d”
);

112 
	#os_vŸ_g‘_´ÙocŞ
 
vŸ_g‘_´ÙocŞ


	)

118 
vŸ_£t_ho¡
(
os_vŸ_t
 *
h—d”
, *
v®ue
);

119 
	#os_vŸ_£t_ho¡
 
vŸ_£t_ho¡


	)

124 *
vŸ_g‘_ho¡
(
os_vŸ_t
 *
h—d”
);

125 
	#os_vŸ_g‘_ho¡
 
vŸ_g‘_ho¡


	)

131 
vŸ_£t_pÜt
(
os_vŸ_t
 *
h—d”
, *
v®ue
);

132 
	#os_vŸ_£t_pÜt
 
vŸ_£t_pÜt


	)

137 *
vŸ_g‘_pÜt
(
os_vŸ_t
 *
h—d”
);

138 
	#os_vŸ_g‘_pÜt
 
vŸ_g‘_pÜt


	)

144 
vŸ_£t_comm’t
(
os_vŸ_t
 *
h—d”
, *
v®ue
);

145 
	#os_vŸ_£t_comm’t
 
vŸ_£t_comm’t


	)

150 *
vŸ_g‘_comm’t
(
os_vŸ_t
 *
h—d”
);

151 
	#os_vŸ_g‘_comm’t
 
vŸ_g‘_comm’t


	)

157 
	#os_vŸ_£t_hidd’
(
h—d”
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
), 
	`os_¡rdup
("hidd’"), 
NULL
)

	)

163 
	#os_vŸ_£t_‰l
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
), 
	`os_¡rdup
("‰l"), v®ue)

	)

169 
	#os_vŸ_£t_maddr
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
), 
	`os_¡rdup
("maddr"), v®ue)

	)

175 
	#os_vŸ_£t_»ûived
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
), 
	`os_¡rdup
("»ûived"), v®ue)

	)

181 
	#os_vŸ_£t_b¿nch
(
h—d”
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
), 
	`os_¡rdup
("b¿nch"), v®ue)

	)

189 
	#os_vŸ_·¿m_add
(
h—d”
, 
Çme
, 
v®ue
è
	`os_g’”ic_·¿m_add
((&(h—d”)->
vŸ_·¿ms
),‚ame, v®ue)

	)

196 
	#os_vŸ_·¿m_g‘_byÇme
(
h—d”
, 
Çme
, 
de¡
è
	`os_g’”ic_·¿m_g‘_byÇme
((&(h—d”)->
vŸ_·¿ms
),‚ame, de¡)

	)

204 
os_vŸ_m©ch
(
os_vŸ_t
 *
vŸ1
, os_vŸ_ˆ*
vŸ2
);

206 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_www_authenticate.h

20 #iâdeà
_OSIP_WWW_AUTHENTICATE_H_


21 
	#_OSIP_WWW_AUTHENTICATE_H_


	)

38 
os_www_auth’tiÿ‹
 
	tos_www_auth’tiÿ‹_t
;

44 
	sos_www_auth’tiÿ‹
 {

45 *
	mauth_ty³
;

46 *
	m»®m
;

47 *
	mdomaš
;

48 *
	mnÚû
;

49 *
	mİaque
;

50 *
	m¡®e
;

51 *
	m®gÜ™hm
;

52 *
	mqİ_İtiÚs
;

53 *
	mv”siÚ
;

54 *
	mrg‘Çme
;

55 *
	mgs§pi_d©a
;

56 *
	mauth_·¿m
;

59 #ifdeà
__ılu¥lus


67 
os_www_auth’tiÿ‹_š™
(
os_www_auth’tiÿ‹_t
 **
h—d”
);

73 
os_www_auth’tiÿ‹_·r£
(
os_www_auth’tiÿ‹_t
 *
h—d”
, cÚ¡ *
hv®ue
);

79 
os_www_auth’tiÿ‹_to_¡r
(cÚ¡ 
os_www_auth’tiÿ‹_t
 *
h—d”
, **
de¡
);

84 
os_www_auth’tiÿ‹_ä“
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

90 
os_www_auth’tiÿ‹_şÚe
(cÚ¡ 
os_www_auth’tiÿ‹_t
 *
h—d”
, os_www_auth’tiÿ‹_ˆ**
de¡
);

96 *
os_www_auth’tiÿ‹_g‘_auth_ty³
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

102 
os_www_auth’tiÿ‹_£t_auth_ty³
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

107 *
os_www_auth’tiÿ‹_g‘_»®m
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

113 
os_www_auth’tiÿ‹_£t_»®m
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

118 *
os_www_auth’tiÿ‹_g‘_domaš
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

124 
os_www_auth’tiÿ‹_£t_domaš
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

129 *
os_www_auth’tiÿ‹_g‘_nÚû
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

135 
os_www_auth’tiÿ‹_£t_nÚû
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

140 *
os_www_auth’tiÿ‹_g‘_İaque
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

146 
os_www_auth’tiÿ‹_£t_İaque
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

151 *
os_www_auth’tiÿ‹_g‘_¡®e
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

157 
os_www_auth’tiÿ‹_£t_¡®e
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

162 
	#os_www_auth’tiÿ‹_£t_¡®e_Œue
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_¡®e
(h—d”, 
	`os_¡rdup
("Œue"))

	)

167 
	#os_www_auth’tiÿ‹_£t_¡®e_çl£
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_¡®e
(h—d”, 
	`os_¡rdup
("çl£"))

	)

172 *
os_www_auth’tiÿ‹_g‘_®gÜ™hm
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

178 
os_www_auth’tiÿ‹_£t_®gÜ™hm
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

183 
	#os_www_auth’tiÿ‹_£t_®gÜ™hm_MD5
(
h—d”
è
	`os_www_auth’tiÿ‹_£t_®gÜ™hm
(h—d”, 
	`os_¡rdup
("MD5"))

	)

188 *
os_www_auth’tiÿ‹_g‘_qİ_İtiÚs
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

194 
os_www_auth’tiÿ‹_£t_qİ_İtiÚs
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

199 *
os_www_auth’tiÿ‹_g‘_v”siÚ
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

205 
os_www_auth’tiÿ‹_£t_v”siÚ
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

210 *
os_www_auth’tiÿ‹_g‘_rg‘Çme
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

216 
os_www_auth’tiÿ‹_£t_rg‘Çme
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

221 *
os_www_auth’tiÿ‹_g‘_gs§pi_d©a
(
os_www_auth’tiÿ‹_t
 *
h—d”
);

227 
os_www_auth’tiÿ‹_£t_gs§pi_d©a
(
os_www_auth’tiÿ‹_t
 *
h—d”
, *
v®ue
);

229 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/internal.h

20 #iâdeà
_INTERNALOSIPPARSER_H_


21 
	#_INTERNALOSIPPARSER_H_


	)

23 #ià
defšed
(
HAVE_CONFIG_H
)

24 
	~<os-cÚfig.h
>

27 #ià
defšed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

28 
	#HAVE_CTYPE_H
 1

	)

29 
	#HAVE_STRING_H
 1

	)

30 
	#HAVE_SYS_TYPES_H
 1

	)

31 
	#HAVE_TIME_H
 1

	)

32 
	#HAVE_STDARG_H
 1

	)

34 #–ià
defšed
(
__VXWORKS_OS__
è|| defšed(
__¹ems__
)

35 
	#HAVE_STRING_H
 1

	)

36 
	#HAVE_TIME_H
 1

	)

37 
	#HAVE_SYS_TIME_H
 1

	)

38 
	#HAVE_SYS_TYPES_H
 1

	)

39 
	#HAVE_STDARG_H
 1

	)

41 #–ià
defšed
 
_WIN32_WCE


43 
	#HAVE_CTYPE_H
 1

	)

44 
	#HAVE_STRING_H
 1

	)

45 
	#HAVE_TIME_H
 1

	)

46 
	#HAVE_STDARG_H
 1

	)

48 
	#¢´štf
 
_¢´štf


	)

49 
	#v¢´štf
 
_v¢´štf


	)

50 #–ià
defšed
(
WIN32
)

52 
	#HAVE_CTYPE_H
 1

	)

53 
	#HAVE_STRING_H
 1

	)

54 
	#HAVE_SYS_TYPES_H
 1

	)

55 
	#HAVE_TIME_H
 1

	)

56 
	#HAVE_STDARG_H
 1

	)

58 
	#HAVE_LOCALTIME
 1

	)

60 #ià(
_MSC_VER
 < 1900)

61 
	#¢´štf
 
_¢´štf


	)

62 
	#v¢´štf
 
_v¢´štf


	)

64 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

65 
	~<wš­içmy.h
>

70 #ià
_MSC_VER
 >= 1300

71 
	#WIN32_USE_CRYPTO
 1

	)

72 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

73 #ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

74 #undeà
WIN32_USE_CRYPTO


75 #–ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PC_APP
)

76 #undeà
WIN32_USE_CRYPTO


83 #ià
defšed
(
HAVE_STRING_H
)

84 
	~<¡ršg.h
>

85 #–ià
defšed
(
HAVE_STRINGS_H
)

86 
	~<¡ršgs.h
>

88 
	~<¡ršg.h
>

91 
	~<¡dio.h
>

92 
	~<¡dlib.h
>

94 #ià
defšed
(
HAVE_SYS_TYPES_H
)

95 
	~<sys/ty³s.h
>

98 #ifdeà
HAVE_TIME_H


99 
	~<time.h
>

102 #ià
defšed
(
HAVE_SYS_TIME_H
)

103 
	~<sys/time.h
>

106 #ià
defšed
(
__¬c__
)

107 
	~"šşudes_­i.h
"

108 
	~"os_cfg_pub.h
"

109 
	~<posix_time_pub.h
>

112 #ifdeà
__PSOS__


113 
	#VA_START
(
a
, 
f
è
	`va_¡¬t
×, f)

	)

114 
	~"²a.h
"

115 
	~"¡dlib.h
"

116 
	~"time.h
"

117 
	#tim”cmp
(
tvp
, 
uvp
, 
cmp
è(Ñvp)->
tv_£c
 
	`cmp
(uvp)->tv_£ø|| (tvp)->tv_£ø=ğ(uvp)->tv_£ø&& (tvp)->
tv_u£c
 cmp(uvp)->tv_u£c)

	)

118 
	#¢´štf
 
os_¢´štf


	)

119 #iâdeà
INT_MAX


120 
	#INT_MAX
 0x7FFFFFFF

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_body.h

20 #iâdeà
_OSIP_BODY_H_


21 
	#_OSIP_BODY_H_


	)

23 
	~<os·r£r2/h—d”s/os_cÚ‹Á_ty³.h
>

41 
os_body
 
	tos_body_t
;

47 
	sos_body
 {

48 *
	mbody
;

49 
size_t
 
	mËngth
;

50 
os_li¡_t
 *
	mh—d”s
;

51 
os_cÚ‹Á_ty³_t
 *
	mcÚ‹Á_ty³
;

55 #ifdeà
__ılu¥lus


63 
os_body_š™
(
os_body_t
 **
body
);

68 
os_body_ä“
(
os_body_t
 *
body
);

75 
os_body_·r£
(
os_body_t
 *
body
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

81 
os_body_şÚe
(cÚ¡ 
os_body_t
 *
body
, os_body_ˆ**
de¡
);

88 
os_body_·r£_mime
(
os_body_t
 *
body
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

95 
os_body_to_¡r
(cÚ¡ 
os_body_t
 *
body
, **
de¡
, 
size_t
 *
Ëngth
);

102 
os_body_£t_cÚ‹Áty³
(
os_body_t
 *
body
, cÚ¡ *
hv®ue
);

110 
os_body_£t_h—d”
(
os_body_t
 *
body
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
);

112 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_const.h

20 #iâdeà
_OSIP_CONST_H_


21 
	#_OSIP_CONST_H_


	)

23 #ifdeà
ENABLE_MPATROL


24 
	~<m·ŒŞ.h
>

27 
	#OSIP_CRLF
 "\r\n\0"

	)

28 
	#OSIP_CR
 "\r\0"

	)

29 
	#OSIP_LF
 "\n\0"

	)

30 
	#OSIP_SP
 " \0"

	)

32 
	#ACCEPT
 "acû±"

	)

33 
	#ACCEPT_ENCODING
 "acû±-’codšg"

	)

34 
	#ACCEPT_LANGUAGE
 "acû±-Ïnguage"

	)

35 
	#ALERT_INFO
 "®”t-šfo"

	)

36 
	#ALLOW
 "®low"

	)

37 
	#AUTHENTICATION_INFO
 "auth’tiÿtiÚ-šfo"

	)

38 
	#AUTHORIZATION
 "authÜiz©iÚ"

	)

39 
	#CALL_ID
 "ÿÎ-id"

	)

40 
	#CALL_ID_SHORT
 "i"

	)

41 
	#CALL_INFO
 "ÿÎ-šfo"

	)

42 
	#CONTACT
 "cÚù"

	)

43 
	#CONTACT_SHORT
 "m"

	)

44 
	#CONTENT_DISPOSITION
 "cÚ‹Á-di¥os™iÚ"

	)

45 
	#CONTENT_ENCODING_SHORT
 "e"

	)

46 
	#CONTENT_ENCODING
 "cÚ‹Á-’codšg"

	)

47 
	#CONTENT_LANGUAGE
 "cÚ‹Á-Ïnguage"

	)

48 
	#CONTENT_LENGTH_SHORT
 "l"

	)

49 
	#CONTENT_LENGTH
 "cÚ‹Á-Ëngth"

	)

50 
	#CONTENT_TYPE_SHORT
 "c"

	)

51 
	#CONTENT_TYPE
 "cÚ‹Á-ty³"

	)

52 
	#CSEQ
 "c£q"

	)

53 
	#SIPDATE
 "d©e"

	)

54 
	#ERROR_INFO
 "”rÜ-šfo"

	)

55 
	#EXPIRES
 "expœes"

	)

56 
	#FROM
 "äom"

	)

57 
	#FROM_SHORT
 "f"

	)

58 
	#IN_REPLY_TO
 "š-»¶y-to"

	)

59 
	#MAX_FORWARDS
 "max-fÜw¬ds"

	)

60 
	#MIME_VERSION
 "mime-v”siÚ"

	)

61 
	#MIN_EXPIRES
 "mš-expœes"

	)

62 
	#ORGANIZATION
 "Ügªiz©iÚ"

	)

63 
	#PRIORITY
 "´iÜ™y"

	)

64 
	#PROXY_AUTHENTICATE
 "´oxy-auth’tiÿ‹"

	)

65 
	#PROXY_AUTHENTICATION_INFO
 "´oxy-auth’tiÿtiÚ-šfo"

	)

66 
	#PROXY_AUTHORIZATION
 "´oxy-authÜiz©iÚ"

	)

67 
	#PROXY_REQUIRE
 "´oxy-»quœe"

	)

68 
	#RECORD_ROUTE
 "»cÜd-rou‹"

	)

69 
	#REPLY_TO
 "»¶y-to"

	)

70 
	#REQUIRE
 "»quœe"

	)

71 
	#RETRY_AFTER
 "»Œy-aá”"

	)

72 
	#ROUTE
 "rou‹"

	)

73 
	#SERVER
 "£rv”"

	)

74 
	#SUBJECT
 "subjeù"

	)

75 
	#SUBJECT_SHORT
 "s"

	)

76 
	#SUPPORTED
 "suµÜ‹d"

	)

77 
	#TIMESTAMP
 "time¡amp"

	)

78 
	#TO
 "to"

	)

79 
	#TO_SHORT
 "t"

	)

80 
	#UNSUPPORTED
 "unsuµÜ‹d"

	)

81 
	#USER_AGENT
 "u£r-ag’t"

	)

82 
	#VIA
 "vŸ"

	)

83 
	#VIA_SHORT
 "v"

	)

84 
	#WARNING
 "w¬nšg"

	)

85 
	#WWW_AUTHENTICATE
 "www-auth’tiÿ‹"

	)

87 
	#RESPONSE_CODES
 51

	)

89 
	#SIP_TRYING
 100

	)

90 
	#SIP_RINGING
 180

	)

91 
	#SIP_CALL_IS_BEING_FORWARDED
 181

	)

92 
	#SIP_QUEUED
 182

	)

93 
	#SIP_SESSION_PROGRESS
 183

	)

94 
	#SIP_OK
 200

	)

95 
	#SIP_ACCEPTED
 202

	)

96 
	#SIP_MULTIPLE_CHOICES
 300

	)

97 
	#SIP_MOVED_PERMANENTLY
 301

	)

98 
	#SIP_MOVED_TEMPORARILY
 302

	)

99 
	#SIP_USE_PROXY
 305

	)

100 
	#SIP_ALTERNATIVE_SERVICE
 380

	)

101 
	#SIP_BAD_REQUEST
 400

	)

102 
	#SIP_UNAUTHORIZED
 401

	)

103 
	#SIP_PAYMENT_REQUIRED
 402

	)

104 
	#SIP_FORBIDDEN
 403

	)

105 
	#SIP_NOT_FOUND
 404

	)

106 
	#SIP_METHOD_NOT_ALLOWED
 405

	)

107 
	#SIP_406_NOT_ACCEPTABLE
 406

	)

108 
	#SIP_PROXY_AUTHENTICATION_REQUIRED
 407

	)

109 
	#SIP_REQUEST_TIME_OUT
 408

	)

110 
	#SIP_GONE
 410

	)

111 
	#SIP_REQUEST_ENTITY_TOO_LARGE
 413

	)

112 
	#SIP_REQUEST_URI_TOO_LARGE
 414

	)

113 
	#SIP_UNSUPPORTED_MEDIA_TYPE
 415

	)

114 
	#SIP_UNSUPPORTED_URI_SCHEME
 416

	)

115 
	#SIP_BAD_EXTENSION
 420

	)

116 
	#SIP_EXTENSION_REQUIRED
 421

	)

117 
	#SIP_INTERVAL_TOO_BRIEF
 423

	)

118 
	#SIP_TEMPORARILY_UNAVAILABLE
 480

	)

119 
	#SIP_CALL_TRANSACTION_DOES_NOT_EXIST
 481

	)

120 
	#SIP_LOOP_DETECTED
 482

	)

121 
	#SIP_TOO_MANY_HOPS
 483

	)

122 
	#SIP_ADDRESS_INCOMPLETE
 484

	)

123 
	#SIP_AMBIGUOUS
 485

	)

124 
	#SIP_BUSY_HERE
 486

	)

125 
	#SIP_REQUEST_TERMINATED
 487

	)

126 
	#SIP_NOT_ACCEPTABLE_HERE
 488

	)

127 
	#SIP_BAD_EVENT
 489

	)

128 
	#SIP_REQUEST_PENDING
 491

	)

129 
	#SIP_UNDECIPHERABLE
 493

	)

130 
	#SIP_INTERNAL_SERVER_ERROR
 500

	)

131 
	#SIP_NOT_IMPLEMENTED
 501

	)

132 
	#SIP_BAD_GATEWAY
 502

	)

133 
	#SIP_SERVICE_UNAVAILABLE
 503

	)

134 
	#SIP_SERVER_TIME_OUT
 504

	)

135 
	#SIP_VERSION_NOT_SUPPORTED
 505

	)

136 
	#SIP_MESSAGE_TOO_LARGE
 513

	)

137 
	#SIP_BUSY_EVRYWHERE
 600

	)

138 
	#SIP_DECLINE
 603

	)

139 
	#SIP_DOES_NOT_EXIST_ANYWHERE
 604

	)

140 
	#SIP_606_NOT_ACCEPTABLE
 606

	)

143 
	#OSIP_IS_SIP_INFO
(
x
è(((xè>ğ100è&& ((xè< 200))

	)

145 
	#OSIP_IS_SIP_SUCCESS
(
x
è(((xè>ğ200è&& ((xè< 300))

	)

147 
	#OSIP_IS_SIP_REDIRECT
(
x
è(((xè>ğ300è&& ((xè< 400))

	)

149 
	#OSIP_IS_SIP_ERROR
(
x
è(((xè>ğ400è&& ((xè< 600))

	)

151 
	#OSIP_IS_SIP_CLIENT_ERROR
(
x
è(((xè>ğ400è&& ((xè< 500))

	)

153 
	#OSIP_IS_SIP_SERVER_ERROR
(
x
è(((xè>ğ500è&& ((xè< 600))

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_headers.h

20 #iâdeà
_OSIP_HEADERS_H_


21 
	#_OSIP_HEADERS_H_


	)

23 
	~<os·r£r2/os_pÜt.h
>

24 
	~<os·r£r2/os_cÚ¡.h
>

25 
	~<os·r£r2/os_uri.h
>

27 
	~<os·r£r2/h—d”s/os_h—d”.h
>

28 
	~<os·r£r2/h—d”s/os_acû±.h
>

29 
	~<os·r£r2/h—d”s/os_acû±_’codšg.h
>

30 
	~<os·r£r2/h—d”s/os_acû±_Ïnguage.h
>

31 
	~<os·r£r2/h—d”s/os_®”t_šfo.h
>

32 
	~<os·r£r2/h—d”s/os_®low.h
>

33 
	~<os·r£r2/h—d”s/os_auth’tiÿtiÚ_šfo.h
>

34 
	~<os·r£r2/h—d”s/os_authÜiz©iÚ.h
>

35 
	~<os·r£r2/h—d”s/os_ÿÎ_id.h
>

36 
	~<os·r£r2/h—d”s/os_ÿÎ_šfo.h
>

37 
	~<os·r£r2/h—d”s/os_cÚù.h
>

38 
	~<os·r£r2/h—d”s/os_cÚ‹Á_di¥os™iÚ.h
>

39 
	~<os·r£r2/h—d”s/os_cÚ‹Á_’codšg.h
>

40 
	~<os·r£r2/h—d”s/os_cÚ‹Á_Ëngth.h
>

41 
	~<os·r£r2/h—d”s/os_cÚ‹Á_ty³.h
>

42 
	~<os·r£r2/h—d”s/os_c£q.h
>

43 
	~<os·r£r2/h—d”s/os_”rÜ_šfo.h
>

44 
	~<os·r£r2/h—d”s/os_äom.h
>

45 
	~<os·r£r2/h—d”s/os_mime_v”siÚ.h
>

46 
	~<os·r£r2/h—d”s/os_´oxy_auth’tiÿ‹.h
>

47 
	~<os·r£r2/h—d”s/os_´oxy_auth’tiÿtiÚ_šfo.h
>

48 
	~<os·r£r2/h—d”s/os_´oxy_authÜiz©iÚ.h
>

49 
	~<os·r£r2/h—d”s/os_»cÜd_rou‹.h
>

50 
	~<os·r£r2/h—d”s/os_rou‹.h
>

51 
	~<os·r£r2/h—d”s/os_to.h
>

52 
	~<os·r£r2/h—d”s/os_vŸ.h
>

53 
	~<os·r£r2/h—d”s/os_www_auth’tiÿ‹.h
>

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_list.h

20 #iâdeà
_LIST_H_


21 
	#_LIST_H_


	)

23 #ifdeà
ENABLE_MPATROL


24 
	~<m·ŒŞ.h
>

39 #ifdeà
__ılu¥lus


43 #iâdeà
DOXYGEN


48 
__node
 
	t__node_t
;

54 
	s__node
 {

55 
__node_t
 *
	mÃxt
;

56 *
	m–em’t
;

64 
os_li¡
 
	tos_li¡_t
;

70 
os_li¡_™”©Ü
 
	tos_li¡_™”©Ü_t
;

76 
	sos_li¡_™”©Ü
 {

77 
__node_t
 *
	gaùu®
;

78 
__node_t
 **
	g´ev
;

79 
os_li¡_t
 *
	gli
;

80 
	gpos
;

87 
	sos_li¡
 {

88 
	gnb_–t
;

89 
__node_t
 *
	gnode
;

101 
os_li¡_š™
(
os_li¡_t
 *
li
);

108 
os_li¡_¥ecŸl_ä“
(
os_li¡_t
 *
li
, (*
ä“_func
)(*));

116 
os_li¡_şÚe
(cÚ¡ 
os_li¡_t
 *
¤c
, os_li¡_ˆ*
d¡
, (*
şÚe_func
)(*, **));

121 
os_li¡_ofch¬_ä“
(
os_li¡_t
 *
li
);

126 
os_li¡_size
(cÚ¡ 
os_li¡_t
 *
li
);

132 
os_li¡_eŞ
(cÚ¡ 
os_li¡_t
 *
li
, 
pos
);

139 
os_li¡_add
(
os_li¡_t
 *
li
, *
–em’t
, 
pos
);

145 *
os_li¡_g‘
(cÚ¡ 
os_li¡_t
 *
li
, 
pos
);

151 
os_li¡_»move
(
os_li¡_t
 *
li
, 
pos
);

157 
	#os_li¡_™”©Ü_has_–em
(
™
è(0 !ğ(™).
aùu®
 && (™).
pos
 < (™).
li
->
nb_–t
)

	)

163 *
os_li¡_g‘_fœ¡
(cÚ¡ 
os_li¡_t
 *
li
, 
os_li¡_™”©Ü_t
 *
™
);

168 *
os_li¡_g‘_Ãxt
(
os_li¡_™”©Ü_t
 *
™
);

173 *
os_li¡_™”©Ü_»move
(
os_li¡_™”©Ü_t
 *
™
);

175 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_md5.h

26 #iâdeà
_MD5_H_


27 
	#_MD5_H_


	)

29 #iâdeà
DOXYGEN


31 #ifdeà
__ılu¥lus


36 
	#PROTOTYPES
 1

	)

38 #iâdeà
PROTOTYPES


39 
	#PROTOTYPES
 0

	)

43 *
	tPOINTER
;

46 
	tUINT2
;

49 
	tUINT4
;

55 #ià
PROTOTYPES


56 
	#PROTO_LIST
(
li¡
è
	)
list

58 
	#PROTO_LIST
(
li¡
è()

	)

66 
UINT4
 
¡©e
[4];

67 
UINT4
 
couÁ
[2];

68 
bufãr
[64];

69 } 
	tos_MD5_CTX
;

71 
os_MD5In™
 
PROTO_LIST
((
os_MD5_CTX
 *) );

72 
os_MD5Upd©e
 
PROTO_LIST
((
os_MD5_CTX
 *, *, ) );

73 
os_MD5Fš®
 
PROTO_LIST
(([16], 
os_MD5_CTX
 *) );

75 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_message.h

20 #iâdeà
_OSIP_MESSAGE_H_


21 
	#_OSIP_MESSAGE_H_


	)

23 
	~<os·r£r2/os_cÚ¡.h
>

24 
	~<os·r£r2/os_h—d”s.h
>

25 
	~<os·r£r2/os_body.h
>

40 #ifdeà
__ılu¥lus


48 
os_mes§ge
 
	tos_mes§ge_t
;

54 
	sos_mes§ge
 {

55 *
s_v”siÚ
;

56 
os_uri_t
 *
»q_uri
;

57 *
s_m‘hod
;

59 
¡©us_code
;

60 *
»asÚ_ph¿£
;

62 #iâdeà
MINISIZE


63 
os_li¡_t
 
acû±s
;

64 
os_li¡_t
 
acû±_’codšgs
;

65 
os_li¡_t
 
acû±_Ïnguages
;

66 
os_li¡_t
 
®”t_šfos
;

67 
os_li¡_t
 
®lows
;

68 
os_li¡_t
 
auth’tiÿtiÚ_šfos
;

70 
os_li¡_t
 
authÜiz©iÚs
;

71 
os_ÿÎ_id_t
 *
ÿÎ_id
;

72 
os_li¡_t
 
ÿÎ_šfos
;

73 
os_li¡_t
 
cÚùs
;

74 #iâdeà
MINISIZE


75 
os_li¡_t
 
cÚ‹Á_’codšgs
;

77 
os_cÚ‹Á_Ëngth_t
 *
cÚ‹Á_Ëngth
;

78 
os_cÚ‹Á_ty³_t
 *
cÚ‹Á_ty³
;

79 
os_c£q_t
 *
c£q
;

80 #iâdeà
MINISIZE


81 
os_li¡_t
 
”rÜ_šfos
;

83 
os_äom_t
 *
äom
;

84 
os_mime_v”siÚ_t
 *
mime_v”siÚ
;

85 
os_li¡_t
 
´oxy_auth’tiÿ‹s
;

86 #iâdeà
MINISIZE


87 
os_li¡_t
 
´oxy_auth’tiÿtiÚ_šfos
;

89 
os_li¡_t
 
´oxy_authÜiz©iÚs
;

90 
os_li¡_t
 
»cÜd_rou‹s
;

91 
os_li¡_t
 
rou‹s
;

92 
os_to_t
 *
to
;

93 
os_li¡_t
 
vŸs
;

94 
os_li¡_t
 
www_auth’tiÿ‹s
;

96 
os_li¡_t
 
h—d”s
;

98 
os_li¡_t
 
bod›s
;

104 
mes§ge_´İ”ty
;

105 *
mes§ge
;

106 
size_t
 
mes§ge_Ëngth
;

108 *
­¶iÿtiÚ_d©a
;

111 #iâdeà
SIP_MESSAGE_MAX_LENGTH


115 
	#SIP_MESSAGE_MAX_LENGTH
 8000

	)

118 #iâdeà
BODY_MESSAGE_MAX_SIZE


122 
	#BODY_MESSAGE_MAX_SIZE
 4000

	)

129 
os_mes§ge_š™
(
os_mes§ge_t
 **
s
);

134 
os_mes§ge_ä“
(
os_mes§ge_t
 *
s
);

141 
os_mes§ge_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

148 
os_mes§ge_·r£_säag
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

157 
os_mes§ge_to_¡r
(
os_mes§ge_t
 *
s
, **
de¡
, 
size_t
 *
mes§ge_Ëngth
);

167 
os_mes§ge_to_¡r_säag
(
os_mes§ge_t
 *
s
, **
de¡
, 
size_t
 *
mes§ge_Ëngth
);

173 
os_mes§ge_şÚe
(cÚ¡ 
os_mes§ge_t
 *
s
, os_mes§ge_ˆ**
de¡
);

180 
os_mes§ge_£t_»asÚ_ph¿£
(
os_mes§ge_t
 *
s
, *
»asÚ
);

185 *
os_mes§ge_g‘_»asÚ_ph¿£
(cÚ¡ 
os_mes§ge_t
 *
s
);

191 
os_mes§ge_£t_¡©us_code
(
os_mes§ge_t
 *
s
, 
¡©uscode
);

196 
os_mes§ge_g‘_¡©us_code
(cÚ¡ 
os_mes§ge_t
 *
s
);

202 
os_mes§ge_£t_m‘hod
(
os_mes§ge_t
 *
s
, *
m‘hod
);

207 *
os_mes§ge_g‘_m‘hod
(cÚ¡ 
os_mes§ge_t
 *
s
);

213 
os_mes§ge_£t_v”siÚ
(
os_mes§ge_t
 *
s
, *
v”siÚ
);

218 *
os_mes§ge_g‘_v”siÚ
(cÚ¡ 
os_mes§ge_t
 *
s
);

224 
os_mes§ge_£t_uri
(
os_mes§ge_t
 *
s
, 
os_uri_t
 *
uri
);

229 
os_uri_t
 *
os_mes§ge_g‘_uri
(cÚ¡ 
os_mes§ge_t
 *
s
);

238 
	#MSG_IS_RESPONSE
(
msg
è((msg)->
¡©us_code
 !ğ0)

	)

243 
	#MSG_IS_REQUEST
(
msg
è((msg)->
¡©us_code
 =ğ0)

	)

249 
	#MSG_IS_INVITE
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "INVITE"))

	)

254 
	#MSG_IS_ACK
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "ACK"))

	)

259 
	#MSG_IS_REGISTER
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "REGISTER"))

	)

264 
	#MSG_IS_BYE
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "BYE"))

	)

269 
	#MSG_IS_OPTIONS
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "OPTIONS"))

	)

274 
	#MSG_IS_INFO
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "INFO"))

	)

279 
	#MSG_IS_CANCEL
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "CANCEL"))

	)

284 
	#MSG_IS_REFER
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "REFER"))

	)

289 
	#MSG_IS_NOTIFY
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "NOTIFY"))

	)

295 
	#MSG_IS_SUBSCRIBE
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "SUBSCRIBE"))

	)

300 
	#MSG_IS_MESSAGE
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "MESSAGE"))

	)

305 
	#MSG_IS_PRACK
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "PRACK"))

	)

311 
	#MSG_IS_UPDATE
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "UPDATE"))

	)

317 
	#MSG_IS_PUBLISH
(
msg
è(
	`MSG_IS_REQUEST
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
s_m‘hod
, "PUBLISH"))

	)

323 
	#MSG_IS_STATUS_1XX
(
msg
è((msg)->
¡©us_code
 >ğ100 && (msg)->¡©us_cod< 200)

	)

328 
	#MSG_IS_STATUS_2XX
(
msg
è((msg)->
¡©us_code
 >ğ200 && (msg)->¡©us_cod< 300)

	)

333 
	#MSG_IS_STATUS_3XX
(
msg
è((msg)->
¡©us_code
 >ğ300 && (msg)->¡©us_cod< 400)

	)

338 
	#MSG_IS_STATUS_4XX
(
msg
è((msg)->
¡©us_code
 >ğ400 && (msg)->¡©us_cod< 500)

	)

343 
	#MSG_IS_STATUS_5XX
(
msg
è((msg)->
¡©us_code
 >ğ500 && (msg)->¡©us_cod< 600)

	)

348 
	#MSG_IS_STATUS_6XX
(
msg
è((msg)->
¡©us_code
 >ğ600 && (msg)->¡©us_cod< 700)

	)

354 
	#MSG_TEST_CODE
(
msg
, 
code
è(
	`MSG_IS_RESPONSE
(msgè&& (codeè=ğ(msg)->
¡©us_code
)

	)

360 
	#MSG_IS_RESPONSE_FOR
(
msg
, 
»que¡Çme
è(
	`MSG_IS_RESPONSE
(msgè&& 0 =ğ
	`¡rcmp
((msg)->
c£q
->
m‘hod
, (»que¡Çme)))

	)

366 
	#os_g’”ic_·¿m_š™
(
GP
è
	`os_uri_·¿m_š™
(GP)

	)

371 
	#os_g’”ic_·¿m_ä“
(
GP
è
	`os_uri_·¿m_ä“
(GP)

	)

378 
	#os_g’”ic_·¿m_£t
(
GP
, 
NAME
, 
VALUE
è
	`os_uri_·¿m_£t
(GP, NAME, VALUE)

	)

384 
	#os_g’”ic_·¿m_şÚe
 
os_uri_·¿m_şÚe


	)

385 #iâdeà
DOXYGEN


390 
	#os_g’”ic_·¿m_ä“li¡
(
LIST
è
	`os_uri_·¿m_ä“li¡
(LIST)

	)

398 
	#os_g’”ic_·¿m_add
(
LIST
, 
NAME
, 
VALUE
è
	`os_uri_·¿m_add
(LIST, NAME, VALUE)

	)

405 
	#os_g’”ic_·¿m_g‘_byÇme
(
LIST
, 
NAME
, 
DEST
è
	`os_uri_·¿m_g‘_byÇme
(LIST, NAME, DEST)

	)

412 
os_g’”ic_·¿m_£t_Çme
(
os_g’”ic_·¿m_t
 *
g’”ic_·¿m
, *
Çme
);

417 *
os_g’”ic_·¿m_g‘_Çme
(cÚ¡ 
os_g’”ic_·¿m_t
 *
g’”ic_·¿m
);

423 
os_g’”ic_·¿m_£t_v®ue
(
os_g’”ic_·¿m_t
 *
g’”ic_·¿m
, *
v®ue
);

428 *
os_g’”ic_·¿m_g‘_v®ue
(cÚ¡ 
os_g’”ic_·¿m_t
 *
g’”ic_·¿m
);

436 
os_mes§ge_g‘_knownh—d”li¡
(
os_li¡_t
 *
h—d”_li¡
, 
pos
, **
de¡
);

440 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_parser.h

20 #iâdeà
_OSIP_PARSER_H_


21 
	#_OSIP_PARSER_H_


	)

23 
	~<os·r£r2/os_mes§ge.h
>

37 #ifdeà
__ılu¥lus


44 
·r£r_š™
();

78 
·r£r_add_comma_£·¿‹d_h—d”
(cÚ¡ *
hÇme
);

84 
os_mes§ge_fix_Ï¡_vŸ_h—d”
(
os_mes§ge_t
 *
»que¡
, cÚ¡ *
_addr
, 
pÜt
);

96 
os_mes§ge_g‘__´İ”ty
(cÚ¡ 
os_mes§ge_t
 *
s
);

102 
os_mes§ge_fÜû_upd©e
(
os_mes§ge_t
 *
s
);

108 cÚ¡ *
os_mes§ge_g‘_»asÚ
(
¡©us_code
);

115 #iâdeà
MINISIZE


116 
os_mes§ge_£t_acû±
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

118 
	#os_mes§ge_£t_acû±
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Acû±", v®ue)

	)

126 #iâdeà
MINISIZE


127 
os_mes§ge_g‘_acû±
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_t
 **
de¡
);

129 
	#os_mes§ge_g‘_acû±
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"acû±",…os, (
os_h—d”_t
 **ède¡)

	)

136 #iâdeà
MINISIZE


137 
os_mes§ge_£t_acû±_’codšg
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

139 
	#os_mes§ge_£t_acû±_’codšg
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Acû±-Encodšg", v®ue)

	)

147 #iâdeà
MINISIZE


148 
os_mes§ge_g‘_acû±_’codšg
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_’codšg_t
 **
de¡
);

150 
	#os_mes§ge_g‘_acû±_’codšg
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"acû±-’codšg",…os, (
os_h—d”_t
 **ède¡)

	)

157 #iâdeà
MINISIZE


158 
os_mes§ge_£t_acû±_Ïnguage
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

160 
	#os_mes§ge_£t_acû±_Ïnguage
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Acû±-Lªguage", v®ue)

	)

168 #iâdeà
MINISIZE


169 
os_mes§ge_g‘_acû±_Ïnguage
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_Ïnguage_t
 **
de¡
);

171 
	#os_mes§ge_g‘_acû±_Ïnguage
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"acû±-Ïnguage",…os, (
os_h—d”_t
 **ède¡)

	)

178 #iâdeà
MINISIZE


179 
os_mes§ge_£t_®”t_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

181 
	#os_mes§ge_£t_®”t_šfo
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"AË¹-Info", v®ue)

	)

189 #iâdeà
MINISIZE


190 
os_mes§ge_g‘_®”t_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_®”t_šfo_t
 **
de¡
);

192 
	#os_mes§ge_g‘_®”t_šfo
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"®”t-šfo",…os, (
os_h—d”_t
 **ède¡)

	)

199 #iâdeà
MINISIZE


200 
os_mes§ge_£t_®low
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

202 
	#os_mes§ge_£t_®low
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"AÎow", v®ue)

	)

210 #iâdeà
MINISIZE


211 
os_mes§ge_g‘_®low
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_®low_t
 **
de¡
);

213 
	#os_mes§ge_g‘_®low
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"®low",…os, (
os_h—d”_t
 **ède¡)

	)

220 #iâdeà
MINISIZE


221 
os_mes§ge_£t_auth’tiÿtiÚ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

223 
	#os_mes§ge_£t_auth’tiÿtiÚ_šfo
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Auth’tiÿtiÚ-Info", v®ue)

	)

231 #iâdeà
MINISIZE


232 
os_mes§ge_g‘_auth’tiÿtiÚ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_auth’tiÿtiÚ_šfo_t
 **
de¡
);

234 
	#os_mes§ge_g‘_auth’tiÿtiÚ_šfo
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"auth’tiÿtiÚ-šfo",…os, (
os_h—d”_t
 **ède¡)

	)

241 
os_mes§ge_£t_authÜiz©iÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

248 #iâdeà
MINISIZE


249 
os_mes§ge_g‘_authÜiz©iÚ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_authÜiz©iÚ_t
 **
de¡
);

251 
	#os_mes§ge_g‘_authÜiz©iÚ
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
authÜiz©iÚs
),…os, (**è(de¡))

	)

258 
os_mes§ge_£t_ÿÎ_id
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

263 #iâdeà
MINISIZE


264 
os_ÿÎ_id_t
 *
os_mes§ge_g‘_ÿÎ_id
(cÚ¡ 
os_mes§ge_t
 *
s
);

266 
	#os_mes§ge_g‘_ÿÎ_id
(
s
è((s)->
ÿÎ_id
)

	)

273 
os_mes§ge_£t_ÿÎ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

280 
os_mes§ge_g‘_ÿÎ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_ÿÎ_šfo_t
 **
de¡
);

286 
os_mes§ge_£t_cÚù
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

293 #iâdeà
MINISIZE


294 
os_mes§ge_g‘_cÚù
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_cÚù_t
 **
de¡
);

296 
	#os_mes§ge_g‘_cÚù
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
cÚùs
),…os, (**è(de¡))

	)

303 #iâdeà
MINISIZE


304 
os_mes§ge_£t_cÚ‹Á_’codšg
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

306 
	#os_mes§ge_£t_cÚ‹Á_’codšg
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"CÚ‹Á-Encodšg", v®ue)

	)

314 #iâdeà
MINISIZE


315 
os_mes§ge_g‘_cÚ‹Á_’codšg
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_cÚ‹Á_’codšg_t
 **
de¡
);

317 
	#os_mes§ge_g‘_cÚ‹Á_’codšg
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"cÚ‹Á-’codšg",…os, (
os_h—d”_t
 **ède¡)

	)

324 
os_mes§ge_£t_cÚ‹Á_Ëngth
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

329 #iâdeà
MINISIZE


330 
os_cÚ‹Á_Ëngth_t
 *
os_mes§ge_g‘_cÚ‹Á_Ëngth
(cÚ¡ 
os_mes§ge_t
 *
s
);

332 
	#os_mes§ge_g‘_cÚ‹Á_Ëngth
(
s
è((s)->
cÚ‹Á_Ëngth
)

	)

339 
os_mes§ge_£t_cÚ‹Á_ty³
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

344 #iâdeà
MINISIZE


345 
os_cÚ‹Á_ty³_t
 *
os_mes§ge_g‘_cÚ‹Á_ty³
(cÚ¡ 
os_mes§ge_t
 *
s
);

347 
	#os_mes§ge_g‘_cÚ‹Á_ty³
(
s
è((s)->
cÚ‹Á_ty³
)

	)

354 
os_mes§ge_£t_c£q
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

359 #iâdeà
MINISIZE


360 
os_c£q_t
 *
os_mes§ge_g‘_c£q
(cÚ¡ 
os_mes§ge_t
 *
s
);

362 
	#os_mes§ge_g‘_c£q
(
s
è((s)->
c£q
)

	)

369 #iâdeà
MINISIZE


370 
os_mes§ge_£t_”rÜ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

372 
	#os_mes§ge_£t_”rÜ_šfo
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"E¼Ü-Info", v®ue)

	)

380 #iâdeà
MINISIZE


381 
os_mes§ge_g‘_”rÜ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_”rÜ_šfo_t
 **
de¡
);

383 
	#os_mes§ge_g‘_”rÜ_šfo
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"”rÜ-šfo",…os, (
os_h—d”_t
 **ède¡)

	)

390 
os_mes§ge_£t_äom
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

395 #iâdeà
MINISIZE


396 
os_äom_t
 *
os_mes§ge_g‘_äom
(cÚ¡ 
os_mes§ge_t
 *
s
);

398 
	#os_mes§ge_g‘_äom
(
s
è((s)->
äom
)

	)

405 
os_mes§ge_£t_mime_v”siÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

410 #iâdeà
MINISIZE


411 
os_mime_v”siÚ_t
 *
os_mes§ge_g‘_mime_v”siÚ
(cÚ¡ 
os_mes§ge_t
 *
s
);

413 
	#os_mes§ge_g‘_mime_v”siÚ
(
s
è((s)->
mime_v”siÚ
)

	)

420 
os_mes§ge_£t_´oxy_auth’tiÿ‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

427 #iâdeà
MINISIZE


428 
os_mes§ge_g‘_´oxy_auth’tiÿ‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_auth’tiÿ‹_t
 **
de¡
);

430 
	#os_mes§ge_g‘_´oxy_auth’tiÿ‹
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
´oxy_auth’tiÿ‹s
),…os, (**è(de¡))

	)

437 
os_mes§ge_£t_´oxy_authÜiz©iÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

444 #iâdeà
MINISIZE


445 
os_mes§ge_g‘_´oxy_authÜiz©iÚ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_authÜiz©iÚ_t
 **
de¡
);

447 
	#os_mes§ge_g‘_´oxy_authÜiz©iÚ
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
´oxy_authÜiz©iÚs
),…os, (**è(de¡))

	)

454 #iâdeà
MINISIZE


455 
os_mes§ge_£t_´oxy_auth’tiÿtiÚ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

457 
	#os_mes§ge_£t_´oxy_auth’tiÿtiÚ_šfo
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Proxy-Auth’tiÿtiÚ-Info", v®ue)

	)

465 #iâdeà
MINISIZE


466 
os_mes§ge_g‘_´oxy_auth’tiÿtiÚ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_auth’tiÿtiÚ_šfo_t
 **
de¡
);

468 
	#os_mes§ge_g‘_´oxy_auth’tiÿtiÚ_šfo
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"´oxy-auth’tiÿtiÚ-šfo",…os, (
os_h—d”_t
 **ède¡)

	)

475 
os_mes§ge_£t_»cÜd_rou‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

482 #iâdeà
MINISIZE


483 
os_mes§ge_g‘_»cÜd_rou‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_»cÜd_rou‹_t
 **
de¡
);

485 
	#os_mes§ge_g‘_»cÜd_rou‹
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
»cÜd_rou‹s
),…os, (**è(de¡))

	)

492 
os_mes§ge_£t_rou‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

499 #iâdeà
MINISIZE


500 
os_mes§ge_g‘_rou‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_rou‹_t
 **
de¡
);

502 
	#os_mes§ge_g‘_rou‹
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
rou‹s
),…os, (**è(de¡))

	)

509 
os_mes§ge_£t_to
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

514 #iâdeà
MINISIZE


515 
os_to_t
 *
os_mes§ge_g‘_to
(cÚ¡ 
os_mes§ge_t
 *
s
);

517 
	#os_mes§ge_g‘_to
(
s
è((s)->
to
)

	)

524 
os_mes§ge_£t_vŸ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

530 
os_mes§ge_­³nd_vŸ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

537 #iâdeà
MINISIZE


538 
os_mes§ge_g‘_vŸ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_vŸ_t
 **
de¡
);

540 
	#os_mes§ge_g‘_vŸ
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
vŸs
),…os, (**è(de¡))

	)

547 
os_mes§ge_£t_www_auth’tiÿ‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
);

554 #iâdeà
MINISIZE


555 
os_mes§ge_g‘_www_auth’tiÿ‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_www_auth’tiÿ‹_t
 **
de¡
);

557 
	#os_mes§ge_g‘_www_auth’tiÿ‹
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
www_auth’tiÿ‹s
),…os, (**è(de¡))

	)

559 #iâdeà
DOXYGEN


566 
os_mes§ge_£t_muÉË_h—d”
(
os_mes§ge_t
 *
s
, *
hÇme
, *
hv®ue
);

574 
os_mes§ge_£t_h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
);

581 
os_mes§ge_»¶aû_h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
);

582 #iâdeà
MINISIZE


590 
os_mes§ge_£t_tİh—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
);

599 
os_mes§ge_h—d”_g‘_byÇme
(cÚ¡ 
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, 
pos
, 
os_h—d”_t
 **
de¡
);

606 #iâdeà
MINISZE


607 
os_mes§ge_g‘_h—d”
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_h—d”_t
 **
de¡
);

609 
	#os_mes§ge_g‘_h—d”
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
h—d”s
),…os, (**è(de¡))

	)

617 
os_mes§ge_£t_body
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

624 
os_mes§ge_£t_body_mime
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
);

631 #iâdeà
MINISIZE


632 
os_mes§ge_g‘_body
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_body_t
 **
de¡
);

634 
	#os_mes§ge_g‘_body
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_g‘_knownh—d”li¡
((&(s)->
bod›s
),…os, (**è(de¡))

	)

638 #iâdeà
DOXYGEN


639 #ifdeà
ENABLE_TRACE


640 
msg_log»que¡
(
os_mes§ge_t
 *
s
, *
fmt
);

641 
msg_log»¥Ú£
(
os_mes§ge_t
 *
s
, *
fmt
);

643 
	#msg_log»que¡
(
P
, 
Q
è;

	)

644 
	#msg_log»¥Ú£
(
P
, 
Q
è;

	)

653 
	#os_mes§ge_£t_d©e
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"D©e", v®ue)

	)

660 
	#os_mes§ge_g‘_d©e
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"d©e",…os, (
os_h—d”_t
 **ède¡)

	)

666 
	#os_mes§ge_£t_’üy±iÚ
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Enüy±iÚ", v®ue)

	)

673 
	#os_mes§ge_g‘_’üy±iÚ
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"’üy±iÚ",…os, (
os_h—d”_t
 **ède¡)

	)

679 
	#os_mes§ge_£t_Ügªiz©iÚ
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Orgªiz©iÚ", v®ue)

	)

686 
	#os_mes§ge_g‘_Ügªiz©iÚ
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Ügªiz©iÚ",…os, (
os_h—d”_t
 **ède¡)

	)

692 
	#os_mes§ge_£t_»quœe
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Requœe", v®ue)

	)

699 
	#os_mes§ge_g‘_»quœe
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"»quœe",…os, (
os_h—d”_t
 **ède¡)

	)

705 
	#os_mes§ge_£t_suµÜ‹d
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"SuµÜ‹d", v®ue)

	)

712 
	#os_mes§ge_g‘_suµÜ‹d
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"suµÜ‹d",…os, (
os_h—d”_t
 **ède¡)

	)

718 
	#os_mes§ge_£t_time¡amp
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Time¡amp", v®ue)

	)

725 
	#os_mes§ge_g‘_time¡amp
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"time¡amp",…os, (
os_h—d”_t
 **ède¡)

	)

731 
	#os_mes§ge_£t_u£r_ag’t
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"U£r-Ag’t", v®ue)

	)

738 
	#os_mes§ge_g‘_u£r_ag’t
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"u£r-ag’t",…os, (
os_h—d”_t
 **ède¡)

	)

744 
	#os_mes§ge_£t_cÚ‹Á_Ïnguage
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"CÚ‹Á-Lªguage", v®ue)

	)

751 
	#os_mes§ge_g‘_cÚ‹Á_Ïnguage
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"cÚ‹Á-Ïnguage",…os, (
os_h—d”_t
 **ède¡)

	)

757 
	#os_mes§ge_£t_expœes
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Expœes", v®ue)

	)

764 
	#os_mes§ge_g‘_expœes
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"expœes",…os, (
os_h—d”_t
 **ède¡)

	)

770 
	#os_mes§ge_£t_š_»¶y_to
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"In-R•ly-To", v®ue)

	)

777 
	#os_mes§ge_g‘_š_»¶y_to
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"š-»¶y-to",…os, (
os_h—d”_t
 **ède¡)

	)

783 
	#os_mes§ge_£t_max_fÜw¬ds
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Max-FÜw¬ds", v®ue)

	)

790 
	#os_mes§ge_g‘_max_fÜw¬ds
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"max-fÜw¬ds",…os, (
os_h—d”_t
 **ède¡)

	)

796 
	#os_mes§ge_£t_´iÜ™y
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"PriÜ™y", v®ue)

	)

803 
	#os_mes§ge_g‘_´iÜ™y
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"´iÜ™y",…os, (
os_h—d”_t
 **ède¡)

	)

809 
	#os_mes§ge_£t_´oxy_»quœe
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Proxy-Requœe", v®ue)

	)

816 
	#os_mes§ge_g‘_´oxy_»quœe
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"´oxy-»quœe",…os, (
os_h—d”_t
 **ède¡)

	)

822 
	#os_mes§ge_£t_»¥Ú£_key
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Re¥Ú£-Key", v®ue)

	)

829 
	#os_mes§ge_g‘_»¥Ú£_key
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"»¥Ú£-key",…os, (
os_h—d”_t
 **ède¡)

	)

835 
	#os_mes§ge_£t_subjeù
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"Subjeù", v®ue)

	)

842 
	#os_mes§ge_g‘_subjeù
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"subjeù",…os, (
os_h—d”_t
 **ède¡)

	)

848 
	#os_mes§ge_£t_»Œy_aá”
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"R‘ry-Aá”", v®ue)

	)

855 
	#os_mes§ge_g‘_»Œy_aá”
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"»Œy-aá”",…os, (
os_h—d”_t
 **ède¡)

	)

861 
	#os_mes§ge_£t_£rv”
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"S”v”", v®ue)

	)

868 
	#os_mes§ge_g‘_£rv”
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"£rv”",…os, (
os_h—d”_t
 **ède¡)

	)

874 
	#os_mes§ge_£t_unsuµÜ‹d
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"UnsuµÜ‹d", v®ue)

	)

881 
	#os_mes§ge_g‘_unsuµÜ‹d
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"unsuµÜ‹d",…os, (
os_h—d”_t
 **ède¡)

	)

887 
	#os_mes§ge_£t_w¬nšg
(
s
, 
v®ue
è
	`os_mes§ge_£t_h—d”
((
os_mes§ge_t
 *ès, (cÚ¡ *è"W¬nšg", v®ue)

	)

894 
	#os_mes§ge_g‘_w¬nšg
(
s
, 
pos
, 
de¡
è
	`os_mes§ge_h—d”_g‘_byÇme
((
os_mes§ge_t
 *ès, (cÚ¡ *è"w¬nšg",…os, (
os_h—d”_t
 **ède¡)

	)

898 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_port.h

20 #iâdeà
_OSIP_PORT_H_


21 
	#_OSIP_PORT_H_


	)

23 
	~<¡dio.h
>

27 #ià
defšed
(
HAVE_STDARG_H
)

28 
	~<¡d¬g.h
>

30 #ià
defšed
(
HAVE_VARARGS_H
)

31 
	~<v¬¬gs.h
>

33 
	~<¡d¬g.h
>

37 #ià
defšed
(
__VXWORKS_OS__
)

39 
os_v¢´štf
(*
buf
, 
max
, cÚ¡ *
fmt
, 
va_li¡
 
­
);

40 
os_¢´štf
(*
buf
, 
max
, cÚ¡ *
fmt
, ...);

42 
	#¢´štf
 
os_¢´štf


	)

43 
	#v¢´štf
 
os_v¢´štf


	)

46 
	~<os·r£r2/os_cÚ¡.h
>

48 
	~<os·r£r2/os_li¡.h
>

50 
	#SIP_SYNTAX_ERROR
 (-1)

	)

51 
	#SIP_NETWORK_ERROR
 (-2)

	)

52 
	#SIP_ECONNREFUSED
 (-3)

	)

53 
	#SIP_RESSOURCE_ERROR
 (-4)

	)

54 
	#SIP_GLOBAL_ERROR
 (-5)

	)

56 #ifdeà
__ılu¥lus


64 #ià!
defšed
(
WIN32
è&& !defšed(
_WIN32_WCE
)

66 #iâdeà
MINISIZE


67 *
	tos_m®loc_func_t
(
	tsize_t
 
	tsize
);

68 
	tos_ä“_func_t
(*
	t±r
);

69 *
	tos_»®loc_func_t
(*
	t±r
, 
	tsize_t
 
	tsize
);

71 
os_m®loc_func_t
 *
os_m®loc_func
;

72 
os_»®loc_func_t
 *
os_»®loc_func
;

73 
os_ä“_func_t
 *
os_ä“_func
;

75 
os_£t_®loÿtÜs
(
os_m®loc_func_t
 *
m®loc_func
, 
os_»®loc_func_t
 *
»®loc_func
, 
os_ä“_func_t
 *
ä“_func
);

78 #ifdeà
DEBUG_MEM


80 *
_os_m®loc
(
size_t
 
size
, *
fe
, 
lše
);

81 
_os_ä“
(*
±r
);

82 *
_os_»®loc
(*
±r
, 
size_t
 
size
, *
fe
, 
lše
);

84 #iâdeà
os_m®loc


85 
	#os_m®loc
(
S
è
	`_os_m®loc
(S, 
__FILE__
, 
__LINE__
)

	)

87 #iâdeà
os_»®loc


88 
	#os_»®loc
(
P
, 
S
è
	`_os_»®loc
(P, S, 
__FILE__
, 
__LINE__
)

	)

90 #iâdeà
os_ä“


91 
	#os_ä“
(
P
) \

93 ià(
P
 !ğ
NULL
) { \

94 
	`_os_ä“
(
P
); \

96 }

	)

101 #iâdeà
MINISIZE


102 #iâdeà
os_m®loc


103 
	#os_m®loc
(
S
è(
os_m®loc_func
 ? 
	`os_m®loc_func
(Sè: 
	`m®loc
(S))

	)

105 #iâdeà
os_»®loc


106 
	#os_»®loc
(
P
, 
S
è(
os_»®loc_func
 ? 
	`os_»®loc_func
(P, Sè: 
	`»®loc
(P, S))

	)

108 #iâdeà
os_ä“


109 
	#os_ä“
(
P
) \

111 ià(
P
 !ğ
NULL
) { \

112 ià(
os_ä“_func
) \

113 
	`os_ä“_func
(
P
); \

115 
	`ä“
(
P
); \

117 }

	)

122 #iâdeà
os_m®loc


123 
	#os_m®loc
(
S
è
	`m®loc
(S)

	)

125 #iâdeà
os_»®loc


126 
	#os_»®loc
(
P
, 
S
è
	`»®loc
(P, S)

	)

128 #iâdeà
os_ä“


129 
	#os_ä“
(
P
) \

131 ià(
P
 !ğ
NULL
) { \

132 
	`ä“
(
P
); \

134 }

	)

144 #ià
defšed
(
_DEBUG
è&& defšed(
WIN32
)

145 
	#OSIP_MEMORY_DEBUG


	)

148 #ifdeà
OSIP_MEMORY_DEBUG


150 #iâdeà
os_m®loc


151 
	#os_m®loc
(
S
è
	`_os_m®loc
(S, 
__FILE__
, 
__LINE__
)

	)

153 #iâdeà
os_»®loc


154 
	#os_»®loc
(
P
, 
S
è
	`_os_»®loc
(P, S, 
__FILE__
, 
__LINE__
)

	)

156 #iâdeà
os_ä“


157 
	#os_ä“
(
P
) \

159 ià(
P
 !ğ
NULL
) { \

160 
	`_os_ä“
(
P
); \

162 }

	)

165 *
_os_m®loc
(
size_t
 
size
, *
fe
, 
lše
);

166 
_os_ä“
(*
±r
);

167 *
_os_»®loc
(*
±r
, 
size_t
 
size
, *
fe
, 
lše
);

169 *
os_m®loc
(
size_t
 
size
);

170 *
os_»®loc
(*, 
size_t
 
size
);

171 
os_ä“
(*);

176 #ià
defšed
(
WIN32
è&& !defšed(
__GNUC__
)

177 
	#®loÿ
 
_®loÿ


	)

184 
os_bud_¿ndom_numb”
();

190 
	#SP
 " \0"

	)

192 
os_u¦“p
(
u£cÚds
);

194 #iâdeà
MINISIZE


195 
os_©oi
(cÚ¡ *
numb”
);

196 
os_¡rÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
);

197 
os_¡ºÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
, 
size_t
 
Ën
);

200 
	#os_©oi
 
©oi


	)

201 
	#os_¡rÿ£cmp
 
¡rÿ£cmp


	)

202 
	#os_¡ºÿ£cmp
 
¡ºÿ£cmp


	)

205 *
os_¡rÿ£¡r
(cÚ¡ *
hay¡ack
, cÚ¡ *
ÃedË
);

211 *
os_¡ºıy
(*
de¡
, cÚ¡ *
¤c
, 
size_t
 
Ëngth
);

212 *
os_¡rdup
(cÚ¡ *
ch
);

213 *
os_¡rdup_w™hout_quÙe
(cÚ¡ *
ch
);

214 
os_tŞow”
(*
wÜd
);

215 
os_şr¥aû
(*
wÜd
);

216 
__os_£t_Ãxt_tok’
(**
de¡
, *
buf
, 
’d_£·¿tÜ
, **
Ãxt
);

218 cÚ¡ *
__os_quÙe_fšd
(cÚ¡ *
q¡ršg
);

219 *
os_’quÙe
(cÚ¡ *
s
);

220 
os_dequÙe
(*
s
);

222 
os_hash
(cÚ¡ *
¡r
);

223 *
os_¡r_­³nd
(*
d¡
, cÚ¡ *
¤c
);

224 *
os_¡º_­³nd
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
);

225 *
os_şºıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
);

231 
	#LOG_TRUE
 1

	)

232 
	#LOG_FALSE
 0

	)

234 
	e_Œaû_Ëv–
 {

235 
	gTRACE_LEVEL0
 = 0,

236 
	#OSIP_FATAL
 
TRACE_LEVEL0


	)

237 
	gTRACE_LEVEL1
 = 1,

238 
	#OSIP_BUG
 
TRACE_LEVEL1


	)

239 
	gTRACE_LEVEL2
 = 2,

240 
	#OSIP_ERROR
 
TRACE_LEVEL2


	)

241 
	gTRACE_LEVEL3
 = 3,

242 
	#OSIP_WARNING
 
TRACE_LEVEL3


	)

243 
	gTRACE_LEVEL4
 = 4,

244 
	#OSIP_INFO1
 
TRACE_LEVEL4


	)

245 
	gTRACE_LEVEL5
 = 5,

246 
	#OSIP_INFO2
 
TRACE_LEVEL5


	)

247 
	gTRACE_LEVEL6
 = 6,

248 
	#OSIP_INFO3
 
TRACE_LEVEL6


	)

249 
	gTRACE_LEVEL7
 = 7,

250 
	#OSIP_INFO4
 
TRACE_LEVEL7


	)

251 
	gEND_TRACE_LEVEL
 = 8

252 } 
	tos_Œaû_Ëv–_t
;

254 
	tos_Œaû_func_t
(cÚ¡ *
	tfi
, 
	tli
, 
	tos_Œaû_Ëv–_t
 
	tËv–
, cÚ¡ *
	tchä
, 
	tva_li¡
 
	t­
);

258 
os_Œaû_š™Ÿlize_func
(
os_Œaû_Ëv–_t
 
Ëv–
, 
os_Œaû_func_t
 *
func
);

259 
os_Œaû_š™Ÿlize_sy¦og
(
os_Œaû_Ëv–_t
 
Ëv–
, *
id’t
);

260 
os_Œaû_š™Ÿlize
(
os_Œaû_Ëv–_t
 
Ëv–
, 
FILE
 *
fe
);

261 
os_Œaû_’abË_uÁ_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
);

262 
os_Œaû_’abË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
);

263 
os_Œaû_di§bË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
);

264 
os_is_Œaû_Ëv–_aùiv©e
(
os_Œaû_Ëv–_t
 
Ëv–
);

266 #iâdeà
ENABLE_TRACE


268 
	#TRACE_INITIALIZE
(
Ëv–
, 
fe
) \

270 } 0)

	)

271 
	#TRACE_ENABLE_LEVEL
(
Ëv–
) \

273 } 0)

	)

274 
	#TRACE_DISABLE_LEVEL
(
Ëv–
) \

276 } 0)

	)

277 
	#IS_TRACE_LEVEL_ACTIVATE
(
Ëv–
è(-1)

	)

281 
	#TRACE_INITIALIZE
(
Ëv–
, 
fe
è
	`os_Œaû_š™Ÿlize
Öev–, fe)

	)

282 
	#TRACE_ENABLE_LEVEL
(
Ëv–
è
	`os_Œaû_’abË_Ëv–
Öev–)

	)

283 
	#TRACE_DISABLE_LEVEL
(
Ëv–
è
	`os_Œaû_di§bË_Ëv–
Öev–)

	)

284 
	#IS_TRACE_LEVEL_ACTIVATE
(
Ëv–
è
	`os_is_Œaû_Ëv–_aùiv©e
Öev–)

	)

293 
os_Œaû
(cÚ¡ *
fi
, 
li
, 
os_Œaû_Ëv–_t
 
Ëv–
, 
FILE
 *
f
, cÚ¡ *
chä
, ...);

295 #ifdeà
ENABLE_TRACE


296 
	#OSIP_TRACE
(
P
è
	)
P

298 
	#OSIP_TRACE
(
P
) \

300 } 0)

	)

303 
	#REMOVE_ELEMENT
(
fœ¡_–em’t
, 
–em’t
) \

304 ià(
–em’t
->
·»Á
 =ğ
NULL
) { \

305 
fœ¡_–em’t
 = 
–em’t
->
Ãxt
; \

306 ià(
fœ¡_–em’t
 !ğ
NULL
) \

307 
fœ¡_–em’t
->
·»Á
 = 
NULL
; \

309 
–em’t
->
·»Á
->
Ãxt
 =ƒlement->next; \

310 ià(
–em’t
->
Ãxt
 !ğ
NULL
) \

311 
–em’t
->
Ãxt
->
·»Á
 =ƒlement->parent; \

312 
–em’t
->
Ãxt
 = 
NULL
; \

313 
–em’t
->
·»Á
 = 
NULL
; \

314 }

	)

316 
	#ADD_ELEMENT
(
fœ¡_–em’t
, 
–em’t
) \

317 ià(
fœ¡_–em’t
 =ğ
NULL
) { \

318 
fœ¡_–em’t
 = 
–em’t
; \

319 
–em’t
->
Ãxt
 = 
NULL
; \

320 
–em’t
->
·»Á
 = 
NULL
; \

322 
–em’t
->
Ãxt
 = 
fœ¡_–em’t
; \

323 
–em’t
->
·»Á
 = 
NULL
; \

324 
–em’t
->
Ãxt
->
·»Á
 =ƒlement; \

325 
fœ¡_–em’t
 = 
–em’t
; \

326 }

	)

328 
	#APPEND_ELEMENT
(
ty³_of_–em’t_t
, 
fœ¡_–em’t
, 
–em’t
) \

329 ià(
fœ¡_–em’t
 =ğ
NULL
) { \

330 
fœ¡_–em’t
 = 
–em’t
; \

331 
–em’t
->
Ãxt
 = 
NULL
; \

332 
–em’t
->
·»Á
 = 
NULL
; \

334 
ty³_of_–em’t_t
 *
f
; \

335 
f
 = 
fœ¡_–em’t
; f->
Ãxt
 !ğ
NULL
; f = f->next) { \

337 
f
->
Ãxt
 = 
–em’t
; \

338 
–em’t
->
·»Á
 = 
f
; \

339 
–em’t
->
Ãxt
 = 
NULL
; \

340 }

	)

342 cÚ¡ *
os_¡»¼Ü
(
”r
);

344 #ifdeà
__ılu¥lus


347 
	#OSIP_SUCCESS
 0

	)

348 
	#OSIP_UNDEFINED_ERROR
 -1

	)

349 
	#OSIP_BADPARAMETER
 -2

	)

350 
	#OSIP_WRONG_STATE
 -3

	)

351 
	#OSIP_NOMEM
 -4

	)

352 
	#OSIP_SYNTAXERROR
 -5

	)

353 
	#OSIP_NOTFOUND
 -6

	)

354 
	#OSIP_API_NOT_INITIALIZED
 -7

	)

355 
	#OSIP_NO_NETWORK
 -10

	)

356 
	#OSIP_PORT_BUSY
 -11

	)

357 
	#OSIP_UNKNOWN_HOST
 -12

	)

358 
	#OSIP_DISK_FULL
 -30

	)

359 
	#OSIP_NO_RIGHTS
 -31

	)

360 
	#OSIP_FILE_NOT_EXIST
 -32

	)

361 
	#OSIP_TIMEOUT
 -50

	)

362 
	#OSIP_TOOMUCHCALL
 -51

	)

363 
	#OSIP_WRONG_FORMAT
 -52

	)

364 
	#OSIP_NOCOMMONCODEC
 -53

	)

365 
	#OSIP_RETRY_LIMIT
 -60

	)

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_uri.h

20 #iâdeà
_URLS_H_


21 
	#_URLS_H_


	)

23 
	~<os·r£r2/os_cÚ¡.h
>

24 
	~<os·r£r2/os_li¡.h
>

41 #ifdeà
__ılu¥lus


49 
os_uri_·¿m
 
	tos_uri_·¿m_t
;

55 
	sos_uri_·¿m
 {

56 *
gÇme
;

57 *
gv®ue
;

65 
os_uri_·¿m_t
 
	tos_uri_h—d”_t
;

71 
os_uri_·¿m_š™
(
os_uri_·¿m_t
 **
u¾_·¿m
);

76 
os_uri_·¿m_ä“
(
os_uri_·¿m_t
 *
u¾_·¿m
);

83 
os_uri_·¿m_£t
(
os_uri_·¿m_t
 *
u¾_·¿m
, *
Çme
, *
v®ue
);

89 
os_uri_·¿m_şÚe
(cÚ¡ 
os_uri_·¿m_t
 *
u¾_·¿m
, os_uri_·¿m_ˆ**
de¡
);

90 #iâdeà
DOXYGEN


95 
os_uri_·¿m_ä“li¡
(
os_li¡_t
 *
u¾_·¿ms
);

103 
os_uri_·¿m_add
(
os_li¡_t
 *
u¾_·¿ms
, *
Çme
, *
v®ue
);

110 
os_uri_·¿m_g‘_byÇme
(
os_li¡_t
 *
u¾_·¿ms
, *
Çme
, 
os_uri_·¿m_t
 **
de¡
);

116 
	#os_uri_h—d”_š™
(
u¾_h—d”
è
	`os_uri_·¿m_š™
(u¾_h—d”)

	)

121 
	#os_uri_h—d”_ä“
(
u¾_h—d”
è
	`os_uri_·¿m_ä“
(u¾_h—d”)

	)

128 
	#os_uri_h—d”_£t
(
u¾_h—d”
, 
Çme
, 
v®ue
è
	`os_uri_·¿m_£t
(u¾_h—d”,‚ame, v®ue)

	)

134 
	#os_uri_h—d”_şÚe
(
u¾_h—d”
, 
de¡
è
	`os_uri_·¿m_şÚe
(u¾_h—d”, de¡)

	)

135 #iâdeà
DOXYGEN


140 
	#os_uri_h—d”_ä“li¡
(
LIST
è
	`os_uri_·¿m_ä“li¡
(LIST)

	)

148 
	#os_uri_h—d”_add
(
u¾_h—d”s
, 
Çme
, 
v®ue
è
	`os_uri_·¿m_add
(u¾_h—d”s,‚ame, v®ue)

	)

155 
	#os_uri_h—d”_g‘_byÇme
(
u¾_h—d”s
, 
Çme
, 
de¡
è
	`os_uri_·¿m_g‘_byÇme
(u¾_h—d”s,‚ame, de¡)

	)

161 
os_uri
 
	tos_uri_t
;

167 
	sos_uri
 {

168 *
scheme
;

169 *
u£ºame
;

170 *
·sswÜd
;

171 *
ho¡
;

172 *
pÜt
;

173 
os_li¡_t
 
u¾_·¿ms
;

174 
os_li¡_t
 
u¾_h—d”s
;

177 *
¡ršg
;

185 
os_uri_š™
(
os_uri_t
 **
u¾
);

190 
os_uri_ä“
(
os_uri_t
 *
u¾
);

196 
os_uri_·r£
(
os_uri_t
 *
u¾
, cÚ¡ *
buf
);

197 #iâdeà
DOXYGEN


203 
os_uri_·r£_h—d”s
(
os_uri_t
 *
u¾
, cÚ¡ *
buf
);

209 
os_uri_·r£_·¿ms
(
os_uri_t
 *
u¾
, cÚ¡ *
buf
);

216 
os_uri_to_¡r
(cÚ¡ 
os_uri_t
 *
u¾
, **
de¡
);

222 
os_uri_şÚe
(cÚ¡ 
os_uri_t
 *
u¾
, os_uri_ˆ**
de¡
);

229 
os_uri_to_¡r_ÿnÚiÿl
(cÚ¡ 
os_uri_t
 *
u¾
, **
de¡
);

236 
os_uri_£t_scheme
(
os_uri_t
 *
u¾
, *
v®ue
);

241 *
os_uri_g‘_scheme
(
os_uri_t
 *
u¾
);

247 
os_uri_£t_ho¡
(
os_uri_t
 *
u¾
, *
v®ue
);

252 *
os_uri_g‘_ho¡
(
os_uri_t
 *
u¾
);

258 
os_uri_£t_u£ºame
(
os_uri_t
 *
u¾
, *
v®ue
);

263 *
os_uri_g‘_u£ºame
(
os_uri_t
 *
u¾
);

269 
os_uri_£t_·sswÜd
(
os_uri_t
 *
u¾
, *
v®ue
);

274 *
os_uri_g‘_·sswÜd
(
os_uri_t
 *
u¾
);

280 
os_uri_£t_pÜt
(
os_uri_t
 *
u¾
, *
v®ue
);

285 *
os_uri_g‘_pÜt
(
os_uri_t
 *
u¾
);

291 
	#os_uri_£t_Œª¥Üt_udp
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("Œª¥Üt"), os_¡rdup("udp"))

	)

296 
	#os_uri_£t_Œª¥Üt_tı
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("Œª¥Üt"), os_¡rdup("tı"))

	)

301 
	#os_uri_£t_Œª¥Üt_sùp
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("Œª¥Üt"), os_¡rdup("sùp"))

	)

306 
	#os_uri_£t_Œª¥Üt_s
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("Œª¥Üt"), os_¡rdup("s"))

	)

312 
	#os_uri_£t_Œª¥Üt
(
u¾
, 
v®ue
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("Œª¥Üt"), v®ue)

	)

318 
	#os_uri_£t_u£r_phÚe
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("u£r"), os_¡rdup("phÚe"))

	)

323 
	#os_uri_£t_u£r_
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("u£r"), os_¡rdup(""))

	)

328 
	#os_uri_£t_m‘hod_šv™e
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("INVITE"))

	)

333 
	#os_uri_£t_m‘hod_ack
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("ACK"))

	)

338 
	#os_uri_£t_m‘hod_İtiÚs
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("OPTIONS"))

	)

343 
	#os_uri_£t_m‘hod_bye
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("BYE"))

	)

348 
	#os_uri_£t_m‘hod_ÿnûl
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("CANCEL"))

	)

353 
	#os_uri_£t_m‘hod_»gi¡”
(
u¾
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), os_¡rdup("REGISTER"))

	)

359 
	#os_uri_£t_m‘hod
(
u¾
, 
v®ue
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("m‘hod"), v®ue)

	)

365 
	#os_uri_£t_‰l
(
u¾
, 
v®ue
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("‰l"), v®ue)

	)

371 
	#os_uri_£t_maddr
(
u¾
, 
v®ue
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
), 
	`os_¡rdup
("maddr"), v®ue)

	)

379 
	#os_uri_u·¿m_add
(
u¾
, 
Çme
, 
v®ue
è
	`os_uri_·¿m_add
((&(u¾)->
u¾_·¿ms
),‚ame, v®ue)

	)

386 
	#os_uri_u·¿m_g‘_byÇme
(
u¾
, 
Çme
, 
de¡
è
	`os_uri_·¿m_g‘_byÇme
((&(u¾)->
u¾_·¿ms
),‚ame, de¡)

	)

394 
	#os_uri_uh—d”_add
(
u¾
, 
Çme
, 
v®ue
è
	`os_uri_h—d”_add
((&(u¾)->
u¾_h—d”s
),‚ame, v®ue)

	)

401 
	#os_uri_uh—d”_g‘_byÇme
(
u¾
, 
Çme
, 
de¡
è
	`os_uri_h—d”_g‘_byÇme
((&(u¾)->
u¾_h—d”s
),‚ame, de¡)

	)

403 #iâdeà
DOXYGEN


405 cÚ¡ *
Ãxt_£·¿tÜ
(cÚ¡ *
ch
, 
£·¿tÜ_os_to_fšd
, 
befÜe_£·¿tÜ
);

407 *
__os_uri_esÿ³_nÚascii_ªd_nÚdef
(cÚ¡ *
¡ršg
, cÚ¡ *
def
);

408 *
__os_uri_esÿ³_u£ršfo
(cÚ¡ *
¡ršg
);

409 *
__os_uri_esÿ³_·sswÜd
(cÚ¡ *
¡ršg
);

410 *
__os_uri_esÿ³_uri_·¿m
(*
¡ršg
);

411 *
__os_uri_esÿ³_h—d”_·¿m
(*
¡ršg
);

412 
__os_uri_uÃsÿ³
(*
¡ršg
);

418 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/sdp_message.h

20 #iâdeà
_SDP_H_


21 
	#_SDP_H_


	)

23 #ifdeà
ENABLE_MPATROL


24 
	~<m·ŒŞ.h
>

27 
	~<os·r£r2/os_li¡.h
>

42 #ifdeà
__ılu¥lus


50 
sdp_bªdwidth
 
	tsdp_bªdwidth_t
;

56 
	ssdp_bªdwidth
 {

57 *
b_bwty³
;

58 *
b_bªdwidth
;

65 
sdp_bªdwidth_š™
(
sdp_bªdwidth_t
 **
–em
);

70 
sdp_bªdwidth_ä“
(
sdp_bªdwidth_t
 *
–em
);

76 
sdp_time_desü
 
	tsdp_time_desü_t
;

82 
	ssdp_time_desü
 {

83 *
t_¡¬t_time
;

84 *
t_¡İ_time
;

85 
os_li¡_t
 
r_»³©s
;

92 
sdp_time_desü_š™
(
sdp_time_desü_t
 **
–em
);

97 
sdp_time_desü_ä“
(
sdp_time_desü_t
 *
–em
);

103 
sdp_key
 
	tsdp_key_t
;

109 
	ssdp_key
 {

110 *
k_keyty³
;

111 *
k_keyd©a
;

118 
sdp_key_š™
(
sdp_key_t
 **
–em
);

123 
sdp_key_ä“
(
sdp_key_t
 *
–em
);

129 
sdp_©Œibu‹
 
	tsdp_©Œibu‹_t
;

135 
	ssdp_©Œibu‹
 {

136 *
a_©t_f›ld
;

137 *
a_©t_v®ue
;

144 
sdp_©Œibu‹_š™
(
sdp_©Œibu‹_t
 **
–em
);

149 
sdp_©Œibu‹_ä“
(
sdp_©Œibu‹_t
 *
–em
);

155 
sdp_cÚÃùiÚ
 
	tsdp_cÚÃùiÚ_t
;

161 
	ssdp_cÚÃùiÚ
 {

162 *
c_Ã‰y³
;

163 *
c_add¹y³
;

164 *
c_addr
;

165 *
c_addr_muÉiÿ¡_‰l
;

167 *
c_addr_muÉiÿ¡_št
;

175 
sdp_cÚÃùiÚ_š™
(
sdp_cÚÃùiÚ_t
 **
–em
);

180 
sdp_cÚÃùiÚ_ä“
(
sdp_cÚÃùiÚ_t
 *
–em
);

186 
sdp_medŸ
 
	tsdp_medŸ_t
;

192 
	ssdp_medŸ
 {

193 *
m_medŸ
;

194 *
m_pÜt
;

195 *
m_numb”_of_pÜt
;

196 *
m_´Ùo
;

197 
os_li¡_t
 
m_·ylßds
;

199 *
i_šfo
;

200 
os_li¡_t
 
c_cÚÃùiÚs
;

202 
os_li¡_t
 
b_bªdwidths
;

204 
os_li¡_t
 
a_©Œibu‹s
;

206 
sdp_key_t
 *
k_key
;

213 
sdp_medŸ_š™
(
sdp_medŸ_t
 **
–em
);

218 
sdp_medŸ_ä“
(
sdp_medŸ_t
 *
–em
);

224 
sdp_mes§ge
 
	tsdp_mes§ge_t
;

230 
	ssdp_mes§ge
 {

231 *
v_v”siÚ
;

232 *
o_u£ºame
;

233 *
o_£ss_id
;

234 *
o_£ss_v”siÚ
;

235 *
o_Ã‰y³
;

236 *
o_add¹y³
;

237 *
o_addr
;

238 *
s_Çme
;

239 *
i_šfo
;

240 *
u_uri
;

241 
os_li¡_t
 
e_emas
;

242 
os_li¡_t
 
p_phÚes
;

243 
sdp_cÚÃùiÚ_t
 *
c_cÚÃùiÚ
;

245 
os_li¡_t
 
b_bªdwidths
;

247 
os_li¡_t
 
t_desüs
;

248 *
z_adju¡m’ts
;

249 
sdp_key_t
 *
k_key
;

250 
os_li¡_t
 
a_©Œibu‹s
;

252 
os_li¡_t
 
m_medŸs
;

259 
sdp_mes§ge_š™
(
sdp_mes§ge_t
 **
sdp
);

265 
sdp_mes§ge_·r£
(
sdp_mes§ge_t
 *
sdp
, cÚ¡ *
buf
);

271 
sdp_mes§ge_to_¡r
(
sdp_mes§ge_t
 *
sdp
, **
de¡
);

276 
sdp_mes§ge_ä“
(
sdp_mes§ge_t
 *
sdp
);

282 
sdp_mes§ge_şÚe
(
sdp_mes§ge_t
 *
sdp
, sdp_mes§ge_ˆ**
de¡
);

289 
sdp_mes§ge_v_v”siÚ_£t
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

294 *
sdp_mes§ge_v_v”siÚ_g‘
(
sdp_mes§ge_t
 *
sdp
);

305 
sdp_mes§ge_o_Üigš_£t
(
sdp_mes§ge_t
 *
sdp
, *
u£ºame
, *
£ss_id
, *
£ss_v”siÚ
, *
Ã‰y³
, *
add¹y³
, *
addr
);

310 *
sdp_mes§ge_o_u£ºame_g‘
(
sdp_mes§ge_t
 *
sdp
);

315 *
sdp_mes§ge_o_£ss_id_g‘
(
sdp_mes§ge_t
 *
sdp
);

320 *
sdp_mes§ge_o_£ss_v”siÚ_g‘
(
sdp_mes§ge_t
 *
sdp
);

325 *
sdp_mes§ge_o_Ã‰y³_g‘
(
sdp_mes§ge_t
 *
sdp
);

330 *
sdp_mes§ge_o_add¹y³_g‘
(
sdp_mes§ge_t
 *
sdp
);

335 *
sdp_mes§ge_o_addr_g‘
(
sdp_mes§ge_t
 *
sdp
);

341 
sdp_mes§ge_s_Çme_£t
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

346 *
sdp_mes§ge_s_Çme_g‘
(
sdp_mes§ge_t
 *
sdp
);

353 
sdp_mes§ge_i_šfo_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
v®ue
);

359 *
sdp_mes§ge_i_šfo_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

365 
sdp_mes§ge_u_uri_£t
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

370 *
sdp_mes§ge_u_uri_g‘
(
sdp_mes§ge_t
 *
sdp
);

376 
sdp_mes§ge_e_ema_add
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

381 
	#sdp_e_ema_g‘
 
sdp_mes§ge_e_ema_g‘


	)

387 *
sdp_mes§ge_e_ema_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos
);

393 
sdp_mes§ge_p_phÚe_add
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

399 *
sdp_mes§ge_p_phÚe_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos
);

410 
sdp_mes§ge_c_cÚÃùiÚ_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
Ã‰y³
, *
add¹y³
, *
addr
, *
addr_muÉiÿ¡_‰l
, *
addr_muÉiÿ¡_št
);

411 #iâdeà
DOXYGEN


413 
sdp_cÚÃùiÚ_t
 *
sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

421 *
sdp_mes§ge_c_Ã‰y³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

428 *
sdp_mes§ge_c_add¹y³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

435 *
sdp_mes§ge_c_addr_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

442 *
sdp_mes§ge_c_addr_muÉiÿ¡_‰l_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

449 *
sdp_mes§ge_c_addr_muÉiÿ¡_št_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

457 
sdp_mes§ge_b_bªdwidth_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
bwty³
, *
bªdwidth
);

464 
sdp_bªdwidth_t
 *
sdp_mes§ge_bªdwidth_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

471 *
sdp_mes§ge_b_bwty³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

478 *
sdp_mes§ge_b_bªdwidth_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

485 
sdp_mes§ge_t_time_desü_add
(
sdp_mes§ge_t
 *
sdp
, *
¡¬t
, *
¡İ
);

491 *
sdp_mes§ge_t_¡¬t_time_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_td
);

497 *
sdp_mes§ge_t_¡İ_time_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_td
);

504 
sdp_mes§ge_r_»³©_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_time_desü
, *
v®ue
);

511 *
sdp_mes§ge_r_»³©_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_time_desü
, 
pos_»³©
);

517 
sdp_mes§ge_z_adju¡m’ts_£t
(
sdp_mes§ge_t
 *
sdp
, *
v®ue
);

522 *
sdp_mes§ge_z_adju¡m’ts_g‘
(
sdp_mes§ge_t
 *
sdp
);

530 
sdp_mes§ge_k_key_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
keyty³
, *
keyd©a
);

536 *
sdp_mes§ge_k_keyty³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

542 *
sdp_mes§ge_k_keyd©a_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

550 
sdp_mes§ge_a_©Œibu‹_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
, *
©t_v®ue
);

557 
sdp_mes§ge_a_©Œibu‹_d–
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
);

565 
sdp_mes§ge_a_©Œibu‹_d–_©_šdex
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
, 
pos_©Œ
);

572 
sdp_©Œibu‹_t
 *
sdp_mes§ge_©Œibu‹_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

579 *
sdp_mes§ge_a_©t_f›ld_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

586 *
sdp_mes§ge_a_©t_v®ue_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

592 
sdp_mes§ge_’dof_medŸ
(
sdp_mes§ge_t
 *
sdp
, 
pos
);

601 
sdp_mes§ge_m_medŸ_add
(
sdp_mes§ge_t
 *
sdp
, *
medŸ
, *
pÜt
, *
numb”_of_pÜt
, *
´Ùo
);

607 *
sdp_mes§ge_m_medŸ_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

613 *
sdp_mes§ge_m_pÜt_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

620 
sdp_mes§ge_m_pÜt_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
pÜt
);

626 *
sdp_mes§ge_m_numb”_of_pÜt_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

632 *
sdp_mes§ge_m_´Ùo_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
);

639 
sdp_mes§ge_m_·ylßd_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
·ylßd
);

646 *
sdp_mes§ge_m_·ylßd_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

653 
sdp_mes§ge_m_·ylßd_d–
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
);

657 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm.h

20 #iâdeà
_FSM_H_


21 
	#_FSM_H_


	)

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os2/os.h
>

26 
	~"xixt.h
"

28 #iâdeà
DOXYGEN


30 
os_¡©emachše
 
	tos_¡©emachše_t
;

32 
	sos_¡©emachše
 {

33 
_Œªs™iÚ_t
 *
	mŒªs™iÚs
;

42 
os_ev’t_t
 *
__os_ev’t_Ãw
(
ty³_t
 
ty³
, 
Œª§ùiÚid
);

45 
ty³_t
 
evt_£t_ty³_šcomšg_smes§ge
(
os_mes§ge_t
 *
s
);

46 
ty³_t
 
evt_£t_ty³_outgošg_smes§ge
(
os_mes§ge_t
 *
s
);

48 
_Œªs™iÚ_t
 
	tŒªs™iÚ_t
;

50 
	s_Œªs™iÚ_t
 {

51 
¡©e_t
 
	m¡©e
;

52 
ty³_t
 
	mty³
;

53 (*
	mm‘hod
)(*, *);

54 
_Œªs™iÚ_t
 *
	mÃxt
;

55 
_Œªs™iÚ_t
 *
	m·»Á
;

58 
fsm_ÿÎm‘hod
(
ty³_t
 
ty³
, 
¡©e_t
 
¡©e
, 
os_¡©emachše_t
 *
¡©emachše
, *
sev’t
, *
Œª§ùiÚ
);

68 
iù_¢d_šv™e
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

69 
os_iù_timeout_a_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

70 
os_iù_timeout_b_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

71 
os_iù_timeout_d_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

72 
iù_rcv_1xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

73 
iù_rcv_2xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

74 
os_mes§ge_t
 *
iù_ü—‹_ack
(
os_Œª§ùiÚ_t
 *
iù
, os_mes§ge_ˆ*
»¥Ú£
);

75 
iù_rcv_3456xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

76 
iù_»Œªsm™_ack
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
);

82 
i¡_rcv_šv™e
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

83 
os_i¡_timeout_g_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

84 
os_i¡_timeout_h_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

85 
os_i¡_timeout_i_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

86 
i¡_¢d_1xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

87 
i¡_¢d_2xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

88 
i¡_¢d_3456xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

89 
i¡_rcv_ack
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
);

95 
niù_¢d_»que¡
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

96 
os_niù_timeout_e_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

97 
os_niù_timeout_f_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

98 
os_niù_timeout_k_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

99 
niù_rcv_1xx
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

100 
niù_rcv_23456xx
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
);

108 
ni¡_rcv_»que¡
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
);

109 
ni¡_¢d_1xx
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
);

110 
ni¡_¢d_23456xx
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
);

111 
os_ni¡_timeout_j_ev’t
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
);

117 
__os_mes§ge_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *, 
os_mes§ge_t
 *);

118 
__os_kl_Œª§ùiÚ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *);

119 
__os_Œª¥Üt_”rÜ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *, 
”rÜ
);

127 
__os_Œª§ùiÚ_£t_¡©e
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
¡©e_t
 
¡©e
);

135 
__os_Œª§ùiÚ_m©chšg_»¥Ú£_os_to_xiù_17_1_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»¥
);

143 
__os_Œª§ùiÚ_m©chšg_»que¡_os_to_xi¡_17_2_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»que¡
);

145 
os_ev’t_t
 *
__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(*
xixt
, 
timev®
 *
tim”
, 
cÚd_¡©e
, 
Œª§ùiÚid
, 
TIMER_VAL
);

147 
__os_Œª§ùiÚ_¢d_xxx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_mes§ge_t
 *
msg
);

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm_misc.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os_fifo.h
>

22 
	~<os2/os.h
>

23 
	~"fsm.h
"

25 
Œªs™iÚ_t
 *
fsm_fšdm‘hod
(
ty³_t
 
ty³
, 
¡©e_t
 
¡©e
, 
os_¡©emachše_t
 *
¡©emachše
);

29 
Œªs™iÚ_t
 *
	$fsm_fšdm‘hod
(
ty³_t
 
ty³
, 
¡©e_t
 
¡©e
, 
os_¡©emachše_t
 *
¡©emachše
) {

30 
Œªs™iÚ_t
 *
Œªs™iÚ
;

32 
Œªs™iÚ
 = 
¡©emachše
->
Œªs™iÚs
;¿ns™iÚ !ğ
NULL
;¿ns™iÚ =¿ns™iÚ->
Ãxt
) {

33 ià(
Œªs™iÚ
->
ty³
 =ğty³ &&¿ns™iÚ->
¡©e
 == state)

34  
Œªs™iÚ
;

37  
NULL
;

38 
	}
}

42 
	$fsm_ÿÎm‘hod
(
ty³_t
 
ty³
, 
¡©e_t
 
¡©e
, 
os_¡©emachše_t
 *
¡©emachše
, *
sev’t
, *
Œª§ùiÚ
) {

43 
Œªs™iÚ_t
 *
Œªs™iÚ
;

45 
Œªs™iÚ
 = 
	`fsm_fšdm‘hod
(
ty³
, 
¡©e
, 
¡©emachše
);

47 ià(
Œªs™iÚ
 =ğ
NULL
) {

49  
OSIP_UNDEFINED_ERROR
;

52 
Œªs™iÚ
->
	`m‘hod
(
Œª§ùiÚ
, 
sev’t
);

53  
OSIP_SUCCESS
;

54 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__os_iù_š™
(
os_iù_t
 **
iù
, 
os_t
 *
os
, 
os_mes§ge_t
 *
šv™e
) {

27 
os_rou‹_t
 *
rou‹
;

28 
i
;

30 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating ICT context\n"));

32 *
iù
 = (
os_iù_t
 *è
	`os_m®loc
((osip_ict_t));

34 ià(*
iù
 =ğ
NULL
)

35  
OSIP_NOMEM
;

37 
	`mem£t
(*
iù
, 0, (
os_iù_t
));

40 
os_vŸ_t
 *
vŸ
;

41 *
´Ùo
;

43 
i
 = 
	`os_mes§ge_g‘_vŸ
(
šv™e
, 0, &
vŸ
);

45 ià(
i
 < 0) {

46 
	`os_ä“
(*
iù
);

47  
i
;

50 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

52 ià(
´Ùo
 =ğ
NULL
) {

53 
	`os_ä“
(*
iù
);

54  
OSIP_SYNTAXERROR
;

57 #ifdeà
USE_BLOCKINGSOCKET


59 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

62 (*
iù
)->
tim”_a_Ëngth
 = 
DEFAULT_T1
;

64 ià(64 * 
DEFAULT_T1
 < 32000)

65 (*
iù
)->
tim”_d_Ëngth
 = 32000;

68 (*
iù
)->
tim”_d_Ëngth
 = 64 * 
DEFAULT_T1
;

70 
	`os_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, 
NULL
);

71 
	`add_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, (*iù)->
tim”_a_Ëngth
);

72 (*
iù
)->
tim”_d_¡¬t
.
tv_£c
 = -1;

75 (*
iù
)->
tim”_a_Ëngth
 = -1;

76 (*
iù
)->
tim”_d_Ëngth
 = 0;

77 (*
iù
)->
tim”_a_¡¬t
.
tv_£c
 = -1;

78 (*
iù
)->
tim”_d_¡¬t
.
tv_£c
 = -1;

83 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

86 (*
iù
)->
tim”_a_Ëngth
 = 
DEFAULT_T1
;

88 ià(64 * 
DEFAULT_T1
 < 32000)

89 (*
iù
)->
tim”_d_Ëngth
 = 32000;

92 (*
iù
)->
tim”_d_Ëngth
 = 64 * 
DEFAULT_T1
;

94 
	`os_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, 
NULL
);

95 
	`add_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, (*iù)->
tim”_a_Ëngth
);

96 (*
iù
)->
tim”_d_¡¬t
.
tv_£c
 = -1;

99 (*
iù
)->
tim”_a_Ëngth
 = 
DEFAULT_T1
;

100 (*
iù
)->
tim”_d_Ëngth
 = 0;

101 
	`os_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, 
NULL
);

102 
	`add_g‘timeofday
(&(*
iù
)->
tim”_a_¡¬t
, (*iù)->
tim”_a_Ëngth
);

103 (*
iù
)->
tim”_d_¡¬t
.
tv_£c
 = -1;

110 
	`os_mes§ge_g‘_rou‹
(
šv™e
, 0, &
rou‹
);

112 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

113 
os_uri_·¿m_t
 *
Ì_·¿m
;

115 
	`os_uri_u·¿m_g‘_byÇme
(
rou‹
->
u¾
, "Ì", &
Ì_·¿m
);

117 ià(
Ì_·¿m
 =ğ
NULL
) {

119 
rou‹
 = 
NULL
;

123 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

124 
pÜt
 = 5060;

126 ià(
rou‹
->
u¾
->
pÜt
 !ğ
NULL
)

127 
pÜt
 = 
	`os_©oi
(
rou‹
->
u¾
->port);

129 
	`os_iù_£t_de¡š©iÚ
((*
iù
), 
	`os_¡rdup
(
rou‹
->
u¾
->
ho¡
), 
pÜt
);

132 
pÜt
 = 5060;

135 
os_uri_·¿m_t
 *
maddr_·¿m
 = 
NULL
;

136 
os_uri_·¿m_t
 *
obr_·¿m
 = 
NULL
;

137 
os_uri_·¿m_t
 *
obp_·¿m
 = 
NULL
;

139 
pÜt
 = 5060;

141 ià(
šv™e
->
»q_uri
->
pÜt
 !ğ
NULL
)

142 
pÜt
 = 
	`os_©oi
(
šv™e
->
»q_uri
->port);

146 
	`os_uri_u·¿m_g‘_byÇme
(
šv™e
->
»q_uri
, "x-obr", &
obr_·¿m
);

147 
	`os_uri_u·¿m_g‘_byÇme
(
šv™e
->
»q_uri
, "x-obp", &
obp_·¿m
);

149 
	`os_uri_u·¿m_g‘_byÇme
(
šv™e
->
»q_uri
, "maddr", &
maddr_·¿m
);

151 ià(
maddr_·¿m
 !ğ
NULL
 && maddr_·¿m->
gv®ue
 != NULL)

152 
	`os_iù_£t_de¡š©iÚ
((*
iù
), 
	`os_¡rdup
(
maddr_·¿m
->
gv®ue
), 
pÜt
);

154 ià(
obr_·¿m
 !ğ
NULL
 && obr_·¿m->
gv®ue
 !ğNULL && 
obp_·¿m
 != NULL && obp_param->gvalue != NULL)

155 
	`os_iù_£t_de¡š©iÚ
((*
iù
), 
	`os_¡rdup
(
obr_·¿m
->
gv®ue
), 
	`os_©oi
(
obp_·¿m
->gvalue));

158 
	`os_iù_£t_de¡š©iÚ
((*
iù
), 
	`os_¡rdup
(
šv™e
->
»q_uri
->
ho¡
), 
pÜt
);

161 (*
iù
)->
tim”_b_Ëngth
 = 64 * 
DEFAULT_T1
;

162 
	`os_g‘timeofday
(&(*
iù
)->
tim”_b_¡¬t
, 
NULL
);

163 
	`add_g‘timeofday
(&(*
iù
)->
tim”_b_¡¬t
, (*iù)->
tim”_b_Ëngth
);

168  
OSIP_SUCCESS
;

169 
	}
}

171 
	$__os_iù_ä“
(
os_iù_t
 *
iù
) {

172 ià(
iù
 =ğ
NULL
)

173  
OSIP_SUCCESS
;

175 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free ict„esource\n"));

177 
	`os_ä“
(
iù
->
de¡š©iÚ
);

178 
	`os_ä“
(
iù
);

179  
OSIP_SUCCESS
;

180 
	}
}

182 
	$os_iù_£t_de¡š©iÚ
(
os_iù_t
 *
iù
, *
de¡š©iÚ
, 
pÜt
) {

183 ià(
iù
 =ğ
NULL
)

184  
OSIP_BADPARAMETER
;

186 ià(
iù
->
de¡š©iÚ
 !ğ
NULL
)

187 
	`os_ä“
(
iù
->
de¡š©iÚ
);

189 
iù
->
de¡š©iÚ
 = destination;

190 
iù
->
pÜt
 =…ort;

191  
OSIP_SUCCESS
;

192 
	}
}

194 
os_ev’t_t
 *
	$__os_iù_Ãed_tim”_a_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

195  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
iù
, &iù->
tim”_a_¡¬t
, 
¡©e
 =ğ
ICT_CALLING
, 
Œª§ùiÚid
, 
TIMEOUT_A
);

196 
	}
}

198 
os_ev’t_t
 *
	$__os_iù_Ãed_tim”_b_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

199  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
iù
, &iù->
tim”_b_¡¬t
, 
¡©e
 =ğ
ICT_CALLING
, 
Œª§ùiÚid
, 
TIMEOUT_B
);

200 
	}
}

202 
os_ev’t_t
 *
	$__os_iù_Ãed_tim”_d_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

203  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
iù
, &iù->
tim”_d_¡¬t
, 
¡©e
 =ğ
ICT_COMPLETED
, 
Œª§ùiÚid
, 
TIMEOUT_D
);

204 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict_fsm.c

20 
	~<os2/š‹º®.h
>

22 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
Œªs™iÚ_t
 
	giù_Œªs™iÚ
[11] = {{
ICT_PRE_CALLING
, 
SND_REQINVITE
, ((*)(*, *)è& 
iù_¢d_šv™e
, &
iù_Œªs™iÚ
[1], 
NULL
},

27 {
ICT_CALLING
, 
TIMEOUT_A
, ((*)(*, *)è& 
os_iù_timeout_a_ev’t
, &
iù_Œªs™iÚ
[2], 
NULL
},

28 {
ICT_CALLING
, 
TIMEOUT_B
, ((*)(*, *)è& 
os_iù_timeout_b_ev’t
, &
iù_Œªs™iÚ
[3], 
NULL
},

29 {
ICT_CALLING
, 
RCV_STATUS_1XX
, ((*)(*, *)è& 
iù_rcv_1xx
, &
iù_Œªs™iÚ
[4], 
NULL
},

30 {
ICT_CALLING
, 
RCV_STATUS_2XX
, ((*)(*, *)è& 
iù_rcv_2xx
, &
iù_Œªs™iÚ
[5], 
NULL
},

31 {
ICT_CALLING
, 
RCV_STATUS_3456XX
, ((*)(*, *)è& 
iù_rcv_3456xx
, &
iù_Œªs™iÚ
[6], 
NULL
},

32 {
ICT_PROCEEDING
, 
RCV_STATUS_1XX
, ((*)(*, *)è& 
iù_rcv_1xx
, &
iù_Œªs™iÚ
[7], 
NULL
},

33 {
ICT_PROCEEDING
, 
RCV_STATUS_2XX
, ((*)(*, *)è& 
iù_rcv_2xx
, &
iù_Œªs™iÚ
[8], 
NULL
},

34 {
ICT_PROCEEDING
, 
RCV_STATUS_3456XX
, ((*)(*, *)è& 
iù_rcv_3456xx
, &
iù_Œªs™iÚ
[9], 
NULL
},

35 {
ICT_COMPLETED
, 
RCV_STATUS_3456XX
, ((*)(*, *)è& 
iù_»Œªsm™_ack
, &
iù_Œªs™iÚ
[10], 
NULL
},

36 {
ICT_COMPLETED
, 
TIMEOUT_D
, ((*)(*, *)è& 
os_iù_timeout_d_ev’t
, 
NULL
, NULL}};

38 
os_¡©emachše_t
 
	giù_fsm
 = {
iù_Œªs™iÚ
};

40 
	$iù_hªdË_Œª¥Üt_”rÜ
(
os_Œª§ùiÚ_t
 *
iù
, 
”r
) {

41 
	`__os_Œª¥Üt_”rÜ_ÿÎback
(
OSIP_ICT_TRANSPORT_ERROR
, 
iù
, 
”r
);

42 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_TERMINATED
);

43 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_ICT_KILL_TRANSACTION
, 
iù
);

45 
	}
}

47 
	$iù_¢d_šv™e
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

48 
i
;

49 
os_t
 *
os
 = (os_ˆ*è
iù
->
cÚfig
;

52 
iù
->
Üig_»que¡
 = 
evt
->
s
;

54 
i
 = 
os
->
	`cb_£nd_mes§ge
(
iù
, 
evt
->
s
, iù->
iù_cÚ‹xt
->
de¡š©iÚ
, iù->iù_cÚ‹xt->
pÜt
, iù->
out_sock‘
);

56 ià(
i
 < 0) {

57 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

61 #iâdeà
USE_BLOCKINGSOCKET


67 ià(
i
 == 0) {

68 
os_vŸ_t
 *
vŸ
;

69 *
´Ùo
;

71 
i
 = 
	`os_mes§ge_g‘_vŸ
(
iù
->
Üig_»que¡
, 0, &
vŸ
);

73 ià(
i
 < 0) {

74 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

78 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

80 ià(
´Ùo
 =ğ
NULL
) {

81 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

85 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

87 
iù
->
iù_cÚ‹xt
->
tim”_a_Ëngth
 = -1;

88 
iù
->
iù_cÚ‹xt
->
tim”_a_¡¬t
.
tv_£c
 = -1;

94 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_INVITE_SENT
, 
iù
, iù->
Üig_»que¡
);

95 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_CALLING
);

96 
	}
}

98 
	$os_iù_timeout_a_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

99 
os_t
 *
os
 = (os_ˆ*è
iù
->
cÚfig
;

100 
i
;

103 
iù
->
iù_cÚ‹xt
->
tim”_a_Ëngth
 = ict->ict_context->timer_a_length * 2;

104 
	`os_g‘timeofday
(&
iù
->
iù_cÚ‹xt
->
tim”_a_¡¬t
, 
NULL
);

105 
	`add_g‘timeofday
(&
iù
->
iù_cÚ‹xt
->
tim”_a_¡¬t
, iù->iù_cÚ‹xt->
tim”_a_Ëngth
);

108 
i
 = 
os
->
	`cb_£nd_mes§ge
(
iù
, iù->
Üig_»que¡
, iù->
iù_cÚ‹xt
->
de¡š©iÚ
, iù->iù_cÚ‹xt->
pÜt
, iù->
out_sock‘
);

110 ià(
i
 < 0) {

111 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

115 #iâdeà
USE_BLOCKINGSOCKET


121 ià(
i
 == 0) {

122 
os_vŸ_t
 *
vŸ
;

123 *
´Ùo
;

125 
i
 = 
	`os_mes§ge_g‘_vŸ
(
iù
->
Üig_»que¡
, 0, &
vŸ
);

127 ià(
i
 < 0) {

128 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

132 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

134 ià(
´Ùo
 =ğ
NULL
) {

135 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

139 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

141 
iù
->
iù_cÚ‹xt
->
tim”_a_Ëngth
 = -1;

142 
iù
->
iù_cÚ‹xt
->
tim”_a_¡¬t
.
tv_£c
 = -1;

148 ià(
i
 == 0)

149 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_INVITE_SENT_AGAIN
, 
iù
, iù->
Üig_»que¡
);

150 
	}
}

152 
	$os_iù_timeout_b_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

153 
iù
->
iù_cÚ‹xt
->
tim”_b_Ëngth
 = -1;

154 
iù
->
iù_cÚ‹xt
->
tim”_b_¡¬t
.
tv_£c
 = -1;

156 ià(
iù
->
out_sock‘
 == -999) {

157 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, -1);

159 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_TIMEOUT
, 
iù
, 
evt
->
s
);

160 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_TERMINATED
);

161 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_ICT_KILL_TRANSACTION
, 
iù
);

163 
	}
}

165 
	$iù_rcv_1xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

168 ià(
iù
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

169 
	`os_mes§ge_ä“
(
iù
->
Ï¡_»¥Ú£
);

172 
iù
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

173 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_1XX_RECEIVED
, 
iù
, 
evt
->
s
);

174 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_PROCEEDING
);

175 
	}
}

177 
	$iù_rcv_2xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

180 ià(
iù
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

181 
	`os_mes§ge_ä“
(
iù
->
Ï¡_»¥Ú£
);

184 
iù
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

186 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_2XX_RECEIVED
, 
iù
, 
evt
->
s
);

188 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_TERMINATED
);

189 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_ICT_KILL_TRANSACTION
, 
iù
);

190 
	}
}

192 
os_mes§ge_t
 *
	$iù_ü—‹_ack
(
os_Œª§ùiÚ_t
 *
iù
, 
os_mes§ge_t
 *
»¥Ú£
) {

193 
i
;

194 
os_mes§ge_t
 *
ack
;

196 
i
 = 
	`os_mes§ge_š™
(&
ack
);

198 ià(
i
 != 0)

199  
NULL
;

202 
i
 = 
	`os_äom_şÚe
(
»¥Ú£
->
äom
, &(
ack
->from));

204 ià(
i
 != 0) {

205 
	`os_mes§ge_ä“
(
ack
);

206  
NULL
;

209 
i
 = 
	`os_to_şÚe
(
»¥Ú£
->
to
, &(
ack
->to));

211 ià(
i
 != 0) {

212 
	`os_mes§ge_ä“
(
ack
);

213  
NULL
;

216 
i
 = 
	`os_ÿÎ_id_şÚe
(
»¥Ú£
->
ÿÎ_id
, &(
ack
->call_id));

218 ià(
i
 != 0) {

219 
	`os_mes§ge_ä“
(
ack
);

220  
NULL
;

223 
i
 = 
	`os_c£q_şÚe
(
»¥Ú£
->
c£q
, &(
ack
->cseq));

225 ià(
i
 != 0) {

226 
	`os_mes§ge_ä“
(
ack
);

227  
NULL
;

230 
	`os_ä“
(
ack
->
c£q
->
m‘hod
);

231 
ack
->
c£q
->
m‘hod
 = 
	`os_¡rdup
("ACK");

233 ià(
ack
->
c£q
->
m‘hod
 =ğ
NULL
) {

234 
	`os_mes§ge_ä“
(
ack
);

235  
NULL
;

238 
ack
->
s_m‘hod
 = (*è
	`os_m®loc
(5);

240 ià(
ack
->
s_m‘hod
 =ğ
NULL
) {

241 
	`os_mes§ge_ä“
(
ack
);

242  
NULL
;

245 
	`¥rštf
(
ack
->
s_m‘hod
, "ACK");

246 
ack
->
s_v”siÚ
 = 
	`os_¡rdup
(
iù
->
Üig_»que¡
->sip_version);

248 ià(
ack
->
s_v”siÚ
 =ğ
NULL
) {

249 
	`os_mes§ge_ä“
(
ack
);

250  
NULL
;

253 
ack
->
¡©us_code
 = 0;

254 
ack
->
»asÚ_ph¿£
 = 
NULL
;

257 
i
 = 
	`os_uri_şÚe
(
iù
->
Üig_»que¡
->
»q_uri
, &(
ack
->req_uri));

259 ià(
i
 != 0) {

260 
	`os_mes§ge_ä“
(
ack
);

261  
NULL
;

266 
os_vŸ_t
 *
vŸ
;

267 
os_vŸ_t
 *
Üig_vŸ
;

269 
	`os_mes§ge_g‘_vŸ
(
iù
->
Üig_»que¡
, 0, &
Üig_vŸ
);

271 ià(
Üig_vŸ
 =ğ
NULL
) {

272 
	`os_mes§ge_ä“
(
ack
);

273  
NULL
;

276 
i
 = 
	`os_vŸ_şÚe
(
Üig_vŸ
, &
vŸ
);

278 ià(
i
 != 0) {

279 
	`os_mes§ge_ä“
(
ack
);

280  
NULL
;

283 
	`os_li¡_add
(&
ack
->
vŸs
, 
vŸ
, -1);

291 
pos
 = 0;

292 
os_rou‹_t
 *
rou‹
;

293 
os_rou‹_t
 *
Üig_rou‹
;

295 !
	`os_li¡_eŞ
(&
iù
->
Üig_»que¡
->
rou‹s
, 
pos
)) {

296 
Üig_rou‹
 = (
os_rou‹_t
 *è
	`os_li¡_g‘
(&
iù
->
Üig_»que¡
->
rou‹s
, 
pos
);

297 
i
 = 
	`os_rou‹_şÚe
(
Üig_rou‹
, &
rou‹
);

299 ià(
i
 != 0) {

300 
	`os_mes§ge_ä“
(
ack
);

301  
NULL
;

304 
	`os_li¡_add
(&
ack
->
rou‹s
, 
rou‹
, -1);

305 
pos
++;

309 ià(
»¥Ú£
->
¡©us_code
 != 401 &&„esponse->status_code != 407) {

311 ià(
	`os_li¡_size
(&
iù
->
Üig_»que¡
->
authÜiz©iÚs
) > 0) {

312 
i
 = 
	`os_li¡_şÚe
(&
iù
->
Üig_»que¡
->
authÜiz©iÚs
, &
ack
->authÜiz©iÚs, ((*)(*, **)è& 
os_authÜiz©iÚ_şÚe
);

314 ià(
i
 != 0) {

315 
	`os_mes§ge_ä“
(
ack
);

316  
NULL
;

321 ià(
	`os_li¡_size
(&
iù
->
Üig_»que¡
->
´oxy_authÜiz©iÚs
) > 0) {

322 
i
 = 
	`os_li¡_şÚe
(&
iù
->
Üig_»que¡
->
´oxy_authÜiz©iÚs
, &
ack
->´oxy_authÜiz©iÚs, ((*)(*, **)è& 
os_´oxy_authÜiz©iÚ_şÚe
);

324 ià(
i
 != 0) {

325 
	`os_mes§ge_ä“
(
ack
);

326  
NULL
;

334  
ack
;

335 
	}
}

337 
	$iù_rcv_3456xx
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

338 
os_rou‹_t
 *
rou‹
;

339 
i
;

340 
os_t
 *
os
 = (os_ˆ*è
iù
->
cÚfig
;

344 ià(
iù
->
Ï¡_»¥Ú£
 !ğ
NULL
)

345 
	`os_mes§ge_ä“
(
iù
->
Ï¡_»¥Ú£
);

347 
iù
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

349 ià(
iù
->
¡©e
 !ğ
ICT_COMPLETED
) {

351 
os_mes§ge_t
 *
ack
 = 
	`iù_ü—‹_ack
(
iù
, 
evt
->
s
);

353 
iù
->
ack
 =‡ck;

355 ià(
iù
->
ack
 =ğ
NULL
) {

356 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_TERMINATED
);

357 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_ICT_KILL_TRANSACTION
, 
iù
);

363 ià(
iù
->
iù_cÚ‹xt
->
de¡š©iÚ
 =ğ
NULL
) {

364 
	`os_mes§ge_g‘_rou‹
(
ack
, 0, &
rou‹
);

366 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

367 
os_uri_·¿m_t
 *
Ì_·¿m
;

369 
	`os_uri_u·¿m_g‘_byÇme
(
rou‹
->
u¾
, "Ì", &
Ì_·¿m
);

371 ià(
Ì_·¿m
 =ğ
NULL
) {

373 
rou‹
 = 
NULL
;

377 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

378 
pÜt
 = 5060;

380 ià(
rou‹
->
u¾
->
pÜt
 !ğ
NULL
)

381 
pÜt
 = 
	`os_©oi
(
rou‹
->
u¾
->port);

383 
	`os_iù_£t_de¡š©iÚ
(
iù
->
iù_cÚ‹xt
, 
	`os_¡rdup
(
rou‹
->
u¾
->
ho¡
), 
pÜt
);

386 
pÜt
 = 5060;

389 
os_uri_·¿m_t
 *
maddr_·¿m
 = 
NULL
;

390 
os_uri_·¿m_t
 *
obr_·¿m
 = 
NULL
;

391 
os_uri_·¿m_t
 *
obp_·¿m
 = 
NULL
;

393 
pÜt
 = 5060;

395 ià(
ack
->
»q_uri
->
pÜt
 !ğ
NULL
)

396 
pÜt
 = 
	`os_©oi
(
ack
->
»q_uri
->port);

400 
	`os_uri_u·¿m_g‘_byÇme
(
ack
->
»q_uri
, "x-obr", &
obr_·¿m
);

401 
	`os_uri_u·¿m_g‘_byÇme
(
ack
->
»q_uri
, "x-obp", &
obp_·¿m
);

403 
	`os_uri_u·¿m_g‘_byÇme
(
ack
->
»q_uri
, "maddr", &
maddr_·¿m
);

405 ià(
maddr_·¿m
 !ğ
NULL
 && maddr_·¿m->
gv®ue
 != NULL)

406 
	`os_iù_£t_de¡š©iÚ
(
iù
->
iù_cÚ‹xt
, 
	`os_¡rdup
(
maddr_·¿m
->
gv®ue
), 
pÜt
);

408 ià(
obr_·¿m
 !ğ
NULL
 && obr_·¿m->
gv®ue
 !ğNULL && 
obp_·¿m
 != NULL && obp_param->gvalue != NULL)

409 
	`os_iù_£t_de¡š©iÚ
(
iù
->
iù_cÚ‹xt
, 
	`os_¡rdup
(
obr_·¿m
->
gv®ue
), 
	`os_©oi
(
obp_·¿m
->gvalue));

412 
	`os_iù_£t_de¡š©iÚ
(
iù
->
iù_cÚ‹xt
, 
	`os_¡rdup
(
ack
->
»q_uri
->
ho¡
), 
pÜt
);

416 
i
 = 
os
->
	`cb_£nd_mes§ge
(
iù
, 
ack
, iù->
iù_cÚ‹xt
->
de¡š©iÚ
, iù->iù_cÚ‹xt->
pÜt
, iù->
out_sock‘
);

418 ià(
i
 != 0) {

419 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

423 ià(
	`MSG_IS_STATUS_3XX
(
evt
->
s
))

424 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_3XX_RECEIVED
, 
iù
, 
evt
->
s
);

426 ià(
	`MSG_IS_STATUS_4XX
(
evt
->
s
))

427 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_4XX_RECEIVED
, 
iù
, 
evt
->
s
);

429 ià(
	`MSG_IS_STATUS_5XX
(
evt
->
s
))

430 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_5XX_RECEIVED
, 
iù
, 
evt
->
s
);

433 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_6XX_RECEIVED
, 
iù
, 
evt
->
s
);

435 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_ACK_SENT
, 
iù
, 
ack
);

439 
	`os_g‘timeofday
(&
iù
->
iù_cÚ‹xt
->
tim”_d_¡¬t
, 
NULL
);

440 
	`add_g‘timeofday
(&
iù
->
iù_cÚ‹xt
->
tim”_d_¡¬t
, iù->iù_cÚ‹xt->
tim”_d_Ëngth
);

441 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_COMPLETED
);

442 
	}
}

444 
	$os_iù_timeout_d_ev’t
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

445 
iù
->
iù_cÚ‹xt
->
tim”_d_Ëngth
 = -1;

446 
iù
->
iù_cÚ‹xt
->
tim”_d_¡¬t
.
tv_£c
 = -1;

448 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_TERMINATED
);

449 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_ICT_KILL_TRANSACTION
, 
iù
);

450 
	}
}

452 
	$iù_»Œªsm™_ack
(
os_Œª§ùiÚ_t
 *
iù
, 
os_ev’t_t
 *
evt
) {

453 
i
;

454 
os_t
 *
os
 = (os_ˆ*è
iù
->
cÚfig
;

460 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_STATUS_3456XX_RECEIVED_AGAIN
, 
iù
, 
evt
->
s
);

462 
	`os_mes§ge_ä“
(
evt
->
s
);

464 
i
 = 
os
->
	`cb_£nd_mes§ge
(
iù
, iù->
ack
, iù->
iù_cÚ‹xt
->
de¡š©iÚ
, iù->iù_cÚ‹xt->
pÜt
, iù->
out_sock‘
);

466 ià(
i
 == 0) {

467 
	`__os_mes§ge_ÿÎback
(
OSIP_ICT_ACK_SENT_AGAIN
, 
iù
, iù->
ack
);

468 
	`__os_Œª§ùiÚ_£t_¡©e
(
iù
, 
ICT_COMPLETED
);

471 
	`iù_hªdË_Œª¥Üt_”rÜ
(
iù
, 
i
);

473 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

25 
	$__os_i¡_š™
(
os_i¡_t
 **
i¡
, 
os_t
 *
os
, 
os_mes§ge_t
 *
šv™e
) {

26 
i
;

28 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating IST context\n"));

30 *
i¡
 = (
os_i¡_t
 *è
	`os_m®loc
((osip_ist_t));

32 ià(*
i¡
 =ğ
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
i¡
, 0, (
os_i¡_t
));

38 
os_vŸ_t
 *
vŸ
;

39 *
´Ùo
;

41 
i
 = 
	`os_mes§ge_g‘_vŸ
(
šv™e
, 0, &
vŸ
);

43 ià(
i
 < 0) {

44 
	`os_ä“
(*
i¡
);

45 *
i¡
 = 
NULL
;

46  
i
;

49 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

51 ià(
´Ùo
 =ğ
NULL
) {

52 
	`os_ä“
(*
i¡
);

53 *
i¡
 = 
NULL
;

54  
OSIP_UNDEFINED_ERROR
;

57 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

60 (*
i¡
)->
tim”_g_Ëngth
 = 
DEFAULT_T1
;

61 (*
i¡
)->
tim”_i_Ëngth
 = 
DEFAULT_T4
;

62 (*
i¡
)->
tim”_g_¡¬t
.
tv_£c
 = -1;

63 (*
i¡
)->
tim”_i_¡¬t
.
tv_£c
 = -1;

66 (*
i¡
)->
tim”_g_Ëngth
 = -1;

67 (*
i¡
)->
tim”_i_Ëngth
 = 0;

68 (*
i¡
)->
tim”_g_¡¬t
.
tv_£c
 = -1;

69 (*
i¡
)->
tim”_i_¡¬t
.
tv_£c
 = -1;

73 (*
i¡
)->
tim”_h_Ëngth
 = 64 * 
DEFAULT_T1
;

74 (*
i¡
)->
tim”_h_¡¬t
.
tv_£c
 = -1;

76  
OSIP_SUCCESS
;

77 
	}
}

79 
	$__os_i¡_ä“
(
os_i¡_t
 *
i¡
) {

80 ià(
i¡
 =ğ
NULL
)

81  
OSIP_SUCCESS
;

83 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free ist„esource\n"));

84 
	`os_ä“
(
i¡
);

85  
OSIP_SUCCESS
;

86 
	}
}

88 
os_ev’t_t
 *
	$__os_i¡_Ãed_tim”_g_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

89  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
i¡
, &i¡->
tim”_g_¡¬t
, 
¡©e
 =ğ
IST_COMPLETED
, 
Œª§ùiÚid
, 
TIMEOUT_G
);

90 
	}
}

92 
os_ev’t_t
 *
	$__os_i¡_Ãed_tim”_h_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

93  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
i¡
, &i¡->
tim”_h_¡¬t
, 
¡©e
 =ğ
IST_COMPLETED
, 
Œª§ùiÚid
, 
TIMEOUT_H
);

94 
	}
}

96 
os_ev’t_t
 *
	$__os_i¡_Ãed_tim”_i_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

97  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
i¡
, &i¡->
tim”_i_¡¬t
, 
¡©e
 =ğ
IST_CONFIRMED
, 
Œª§ùiÚid
, 
TIMEOUT_I
);

98 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist_fsm.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

25 
Œªs™iÚ_t
 
	gi¡_Œªs™iÚ
[11] = {{
IST_PRE_PROCEEDING
, 
RCV_REQINVITE
, ((*)(*, *)è& 
i¡_rcv_šv™e
, &
i¡_Œªs™iÚ
[1], 
NULL
},

26 {
IST_PROCEEDING
, 
RCV_REQINVITE
, ((*)(*, *)è& 
i¡_rcv_šv™e
, &
i¡_Œªs™iÚ
[2], 
NULL
},

27 {
IST_COMPLETED
, 
RCV_REQINVITE
, ((*)(*, *)è& 
i¡_rcv_šv™e
, &
i¡_Œªs™iÚ
[3], 
NULL
},

28 {
IST_COMPLETED
, 
TIMEOUT_G
, ((*)(*, *)è& 
os_i¡_timeout_g_ev’t
, &
i¡_Œªs™iÚ
[4], 
NULL
},

29 {
IST_COMPLETED
, 
TIMEOUT_H
, ((*)(*, *)è& 
os_i¡_timeout_h_ev’t
, &
i¡_Œªs™iÚ
[5], 
NULL
},

30 {
IST_PROCEEDING
, 
SND_STATUS_1XX
, ((*)(*, *)è& 
i¡_¢d_1xx
, &
i¡_Œªs™iÚ
[6], 
NULL
},

31 {
IST_PROCEEDING
, 
SND_STATUS_2XX
, ((*)(*, *)è& 
i¡_¢d_2xx
, &
i¡_Œªs™iÚ
[7], 
NULL
},

32 {
IST_PROCEEDING
, 
SND_STATUS_3456XX
, ((*)(*, *)è& 
i¡_¢d_3456xx
, &
i¡_Œªs™iÚ
[8], 
NULL
},

33 {
IST_COMPLETED
, 
RCV_REQACK
, ((*)(*, *)è& 
i¡_rcv_ack
, &
i¡_Œªs™iÚ
[9], 
NULL
},

34 {
IST_CONFIRMED
, 
RCV_REQACK
, ((*)(*, *)è& 
i¡_rcv_ack
, &
i¡_Œªs™iÚ
[10], 
NULL
},

35 {
IST_CONFIRMED
, 
TIMEOUT_I
, ((*)(*, *)è& 
os_i¡_timeout_i_ev’t
, 
NULL
, NULL}};

37 
os_¡©emachše_t
 
	gi¡_fsm
 = {
i¡_Œªs™iÚ
};

39 
	$i¡_hªdË_Œª¥Üt_”rÜ
(
os_Œª§ùiÚ_t
 *
i¡
, 
”r
) {

40 
	`__os_Œª¥Üt_”rÜ_ÿÎback
(
OSIP_IST_TRANSPORT_ERROR
, 
i¡
, 
”r
);

41 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_TERMINATED
);

42 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_IST_KILL_TRANSACTION
, 
i¡
);

44 
	}
}

46 
	$i¡_rcv_šv™e
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

47 
i
;

49 ià(
i¡
->
¡©e
 =ğ
IST_PRE_PROCEEDING
) {

51 
i¡
->
Üig_»que¡
 = 
evt
->
s
;

53 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_INVITE_RECEIVED
, 
i¡
, 
evt
->
s
);

58 
	`os_mes§ge_ä“
(
evt
->
s
);

60 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_INVITE_RECEIVED_AGAIN
, 
i¡
, i¡->
Üig_»que¡
);

62 ià(
i¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

63 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
i¡
, i¡->
Ï¡_»¥Ú£
);

65 ià(
i
 != 0) {

66 
	`i¡_hªdË_Œª¥Üt_”rÜ
(
i¡
, 
i
);

70 ià(
	`MSG_IS_STATUS_1XX
(
i¡
->
Ï¡_»¥Ú£
))

71 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_1XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

73 ià(
	`MSG_IS_STATUS_2XX
(
i¡
->
Ï¡_»¥Ú£
))

74 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_2XX_SENT_AGAIN
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

77 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_3456XX_SENT_AGAIN
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

85 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_PROCEEDING
);

86 
	}
}

88 
	$os_i¡_timeout_g_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

89 
i
;

91 
i¡
->
i¡_cÚ‹xt
->
tim”_g_Ëngth
 = ist->ist_context->timer_g_length * 2;

93 ià(
i¡
->
i¡_cÚ‹xt
->
tim”_g_Ëngth
 > 
DEFAULT_T2
)

94 
i¡
->
i¡_cÚ‹xt
->
tim”_g_Ëngth
 = 
DEFAULT_T2
;

96 
	`os_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_g_¡¬t
, 
NULL
);

97 
	`add_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_g_¡¬t
, i¡->i¡_cÚ‹xt->
tim”_g_Ëngth
);

99 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
i¡
, i¡->
Ï¡_»¥Ú£
);

101 ià(
i
 != 0) {

102 
	`i¡_hªdË_Œª¥Üt_”rÜ
(
i¡
, 
i
);

106 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_3456XX_SENT_AGAIN
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

107 
	}
}

109 
	$os_i¡_timeout_h_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

110 
i¡
->
i¡_cÚ‹xt
->
tim”_h_Ëngth
 = -1;

111 
i¡
->
i¡_cÚ‹xt
->
tim”_h_¡¬t
.
tv_£c
 = -1;

113 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_TERMINATED
);

114 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_IST_KILL_TRANSACTION
, 
i¡
);

115 
	}
}

117 
	$os_i¡_timeout_i_ev’t
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

118 
i¡
->
i¡_cÚ‹xt
->
tim”_i_Ëngth
 = -1;

119 
i¡
->
i¡_cÚ‹xt
->
tim”_i_¡¬t
.
tv_£c
 = -1;

121 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_TERMINATED
);

122 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_IST_KILL_TRANSACTION
, 
i¡
);

123 
	}
}

125 
	$i¡_¢d_1xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

126 
i
;

128 ià(
i¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

129 
	`os_mes§ge_ä“
(
i¡
->
Ï¡_»¥Ú£
);

132 
i¡
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

134 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
i¡
, 
evt
->
s
);

136 ià(
i
 != 0) {

137 
	`i¡_hªdË_Œª¥Üt_”rÜ
(
i¡
, 
i
);

141 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_1XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

145 
	}
}

147 
	$i¡_¢d_2xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

148 
i
;

150 ià(
i¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

151 
	`os_mes§ge_ä“
(
i¡
->
Ï¡_»¥Ú£
);

154 
i¡
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

156 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
i¡
, 
evt
->
s
);

158 ià(
i
 != 0) {

159 
	`i¡_hªdË_Œª¥Üt_”rÜ
(
i¡
, 
i
);

163 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_2XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

164 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_TERMINATED
);

165 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_IST_KILL_TRANSACTION
, 
i¡
);

169 
	}
}

171 
	$i¡_¢d_3456xx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

172 
i
;

174 ià(
i¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

175 
	`os_mes§ge_ä“
(
i¡
->
Ï¡_»¥Ú£
);

178 
i¡
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

180 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
i¡
, 
evt
->
s
);

182 ià(
i
 != 0) {

183 
	`i¡_hªdË_Œª¥Üt_”rÜ
(
i¡
, 
i
);

187 ià(
	`MSG_IS_STATUS_3XX
(
i¡
->
Ï¡_»¥Ú£
))

188 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_3XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

190 ià(
	`MSG_IS_STATUS_4XX
(
i¡
->
Ï¡_»¥Ú£
))

191 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_4XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

193 ià(
	`MSG_IS_STATUS_5XX
(
i¡
->
Ï¡_»¥Ú£
))

194 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_5XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

197 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_STATUS_6XX_SENT
, 
i¡
, i¡->
Ï¡_»¥Ú£
);

200 ià(
i¡
->
i¡_cÚ‹xt
->
tim”_g_Ëngth
 != -1) {

201 
	`os_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_g_¡¬t
, 
NULL
);

202 
	`add_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_g_¡¬t
, i¡->i¡_cÚ‹xt->
tim”_g_Ëngth
);

205 
	`os_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_h_¡¬t
, 
NULL
);

206 
	`add_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_h_¡¬t
, i¡->i¡_cÚ‹xt->
tim”_h_Ëngth
);

207 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_COMPLETED
);

209 
	}
}

211 
	$i¡_rcv_ack
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_ev’t_t
 *
evt
) {

212 ià(
i¡
->
ack
 !ğ
NULL
) {

213 
	`os_mes§ge_ä“
(
i¡
->
ack
);

216 
i¡
->
ack
 = 
evt
->
s
;

218 ià(
i¡
->
¡©e
 =ğ
IST_COMPLETED
)

219 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_ACK_RECEIVED
, 
i¡
, i¡->
ack
);

222 
	`__os_mes§ge_ÿÎback
(
OSIP_IST_ACK_RECEIVED_AGAIN
, 
i¡
, i¡->
ack
);

225 
	`os_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_i_¡¬t
, 
NULL
);

226 
	`add_g‘timeofday
(&
i¡
->
i¡_cÚ‹xt
->
tim”_i_¡¬t
, i¡->i¡_cÚ‹xt->
tim”_i_Ëngth
);

227 
	`__os_Œª§ùiÚ_£t_¡©e
(
i¡
, 
IST_CONFIRMED
);

228 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__os_niù_š™
(
os_niù_t
 **
niù
, 
os_t
 *
os
, 
os_mes§ge_t
 *
»que¡
) {

27 
os_rou‹_t
 *
rou‹
;

28 
i
;

30 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating NICT context\n"));

32 *
niù
 = (
os_niù_t
 *è
	`os_m®loc
((osip_nict_t));

34 ià(*
niù
 =ğ
NULL
)

35  
OSIP_NOMEM
;

37 
	`mem£t
(*
niù
, 0, (
os_niù_t
));

40 
os_vŸ_t
 *
vŸ
;

41 *
´Ùo
;

43 
i
 = 
	`os_mes§ge_g‘_vŸ
(
»que¡
, 0, &
vŸ
);

45 ià(
i
 < 0) {

46 
	`os_ä“
(*
niù
);

47 *
niù
 = 
NULL
;

48  
i
;

51 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

53 ià(
´Ùo
 =ğ
NULL
) {

54 
	`os_ä“
(*
niù
);

55 *
niù
 = 
NULL
;

56  
OSIP_UNDEFINED_ERROR
;

59 #ifdeà
USE_BLOCKINGSOCKET


61 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

62 (*
niù
)->
tim”_e_Ëngth
 = 
DEFAULT_T1
;

63 (*
niù
)->
tim”_k_Ëngth
 = 
DEFAULT_T4
;

64 (*
niù
)->
tim”_e_¡¬t
.
tv_£c
 = -1;

65 (*
niù
)->
tim”_k_¡¬t
.
tv_£c
 = -1;

68 (*
niù
)->
tim”_e_Ëngth
 = -1;

69 (*
niù
)->
tim”_k_Ëngth
 = 0;

70 (*
niù
)->
tim”_e_¡¬t
.
tv_£c
 = -1;

71 (*
niù
)->
tim”_k_¡¬t
.
tv_£c
 = -1;

76 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

77 (*
niù
)->
tim”_e_Ëngth
 = 
DEFAULT_T1
;

78 (*
niù
)->
tim”_k_Ëngth
 = 
DEFAULT_T4
;

79 (*
niù
)->
tim”_e_¡¬t
.
tv_£c
 = -1;

80 (*
niù
)->
tim”_k_¡¬t
.
tv_£c
 = -1;

83 (*
niù
)->
tim”_e_Ëngth
 = 
DEFAULT_T1
;

84 (*
niù
)->
tim”_k_Ëngth
 = 0;

85 (*
niù
)->
tim”_e_¡¬t
.
tv_£c
 = -1;

86 (*
niù
)->
tim”_k_¡¬t
.
tv_£c
 = -1;

92 
	`os_mes§ge_g‘_rou‹
(
»que¡
, 0, &
rou‹
);

94 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

95 
os_uri_·¿m_t
 *
Ì_·¿m
;

97 
	`os_uri_u·¿m_g‘_byÇme
(
rou‹
->
u¾
, "Ì", &
Ì_·¿m
);

99 ià(
Ì_·¿m
 =ğ
NULL
) {

101 
rou‹
 = 
NULL
;

105 ià(
rou‹
 !ğ
NULL
 &&„ou‹->
u¾
 != NULL) {

106 
pÜt
 = 5060;

108 ià(
rou‹
->
u¾
->
pÜt
 !ğ
NULL
)

109 
pÜt
 = 
	`os_©oi
(
rou‹
->
u¾
->port);

111 
	`os_niù_£t_de¡š©iÚ
((*
niù
), 
	`os_¡rdup
(
rou‹
->
u¾
->
ho¡
), 
pÜt
);

114 
pÜt
 = 5060;

117 
os_uri_·¿m_t
 *
maddr_·¿m
 = 
NULL
;

118 
os_uri_·¿m_t
 *
obr_·¿m
 = 
NULL
;

119 
os_uri_·¿m_t
 *
obp_·¿m
 = 
NULL
;

121 
pÜt
 = 5060;

123 ià(
»que¡
->
»q_uri
->
pÜt
 !ğ
NULL
)

124 
pÜt
 = 
	`os_©oi
(
»que¡
->
»q_uri
->port);

128 
	`os_uri_u·¿m_g‘_byÇme
(
»que¡
->
»q_uri
, "x-obr", &
obr_·¿m
);

129 
	`os_uri_u·¿m_g‘_byÇme
(
»que¡
->
»q_uri
, "x-obp", &
obp_·¿m
);

131 
	`os_uri_u·¿m_g‘_byÇme
(
»que¡
->
»q_uri
, "maddr", &
maddr_·¿m
);

133 ià(
maddr_·¿m
 !ğ
NULL
 && maddr_·¿m->
gv®ue
 != NULL)

134 
	`os_niù_£t_de¡š©iÚ
((*
niù
), 
	`os_¡rdup
(
maddr_·¿m
->
gv®ue
), 
pÜt
);

136 ià(
obr_·¿m
 !ğ
NULL
 && obr_·¿m->
gv®ue
 !ğNULL && 
obp_·¿m
 != NULL && obp_param->gvalue != NULL)

137 
	`os_niù_£t_de¡š©iÚ
((*
niù
), 
	`os_¡rdup
(
obr_·¿m
->
gv®ue
), 
	`os_©oi
(
obp_·¿m
->gvalue));

140 
	`os_niù_£t_de¡š©iÚ
((*
niù
), 
	`os_¡rdup
(
»que¡
->
»q_uri
->
ho¡
), 
pÜt
);

143 (*
niù
)->
tim”_f_Ëngth
 = 64 * 
DEFAULT_T1
;

144 
	`os_g‘timeofday
(&(*
niù
)->
tim”_f_¡¬t
, 
NULL
);

145 
	`add_g‘timeofday
(&(*
niù
)->
tim”_f_¡¬t
, (*niù)->
tim”_f_Ëngth
);

150  
OSIP_SUCCESS
;

151 
	}
}

153 
	$__os_niù_ä“
(
os_niù_t
 *
niù
) {

154 ià(
niù
 =ğ
NULL
)

155  
OSIP_SUCCESS
;

157 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free‚ict„esource\n"));

159 
	`os_ä“
(
niù
->
de¡š©iÚ
);

160 
	`os_ä“
(
niù
);

161  
OSIP_SUCCESS
;

162 
	}
}

164 
	$os_niù_£t_de¡š©iÚ
(
os_niù_t
 *
niù
, *
de¡š©iÚ
, 
pÜt
) {

165 ià(
niù
 =ğ
NULL
)

166  
OSIP_BADPARAMETER
;

168 ià(
niù
->
de¡š©iÚ
 !ğ
NULL
)

169 
	`os_ä“
(
niù
->
de¡š©iÚ
);

171 
niù
->
de¡š©iÚ
 = destination;

172 
niù
->
pÜt
 =…ort;

173  
OSIP_SUCCESS
;

174 
	}
}

176 
os_ev’t_t
 *
	$__os_niù_Ãed_tim”_e_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

177  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
niù
, &niù->
tim”_e_¡¬t
, 
¡©e
 =ğ
NICT_PROCEEDING
 || s‹ =ğ
NICT_TRYING
, 
Œª§ùiÚid
, 
TIMEOUT_E
);

178 
	}
}

180 
os_ev’t_t
 *
	$__os_niù_Ãed_tim”_f_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

181  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
niù
, &niù->
tim”_f_¡¬t
, 
¡©e
 =ğ
NICT_PROCEEDING
 || s‹ =ğ
NICT_TRYING
, 
Œª§ùiÚid
, 
TIMEOUT_F
);

182 
	}
}

184 
os_ev’t_t
 *
	$__os_niù_Ãed_tim”_k_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

185  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
niù
, &niù->
tim”_k_¡¬t
, 
¡©e
 =ğ
NICT_COMPLETED
, 
Œª§ùiÚid
, 
TIMEOUT_K
);

186 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict_fsm.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

25 
Œªs™iÚ_t
 
	gniù_Œªs™iÚ
[12] = {

26 {
NICT_PRE_TRYING
, 
SND_REQUEST
, ((*)(*, *)è& 
niù_¢d_»que¡
, &
niù_Œªs™iÚ
[1], 
NULL
}, {
NICT_TRYING
, 
TIMEOUT_F
, ((*)(*, *)è& 
os_niù_timeout_f_ev’t
, &nict_transition[2], NULL},

27 {
NICT_TRYING
, 
TIMEOUT_E
, ((*)(*, *)è& 
os_niù_timeout_e_ev’t
, &
niù_Œªs™iÚ
[3], 
NULL
}, {NICT_TRYING, 
RCV_STATUS_1XX
, ((*)(*, *)è& 
niù_rcv_1xx
, &nict_transition[4], NULL},

28 {
NICT_TRYING
, 
RCV_STATUS_2XX
, ((*)(*, *)è& 
niù_rcv_23456xx
, &
niù_Œªs™iÚ
[5], 
NULL
}, {NICT_TRYING, 
RCV_STATUS_3456XX
, ((*)(*, *)) &‚ict_rcv_23456xx, &nict_transition[6], NULL},

29 {
NICT_PROCEEDING
, 
TIMEOUT_F
, ((*)(*, *)è& 
os_niù_timeout_f_ev’t
, &
niù_Œªs™iÚ
[7], 
NULL
}, {NICT_PROCEEDING, 
TIMEOUT_E
, ((*)(*, *)è& 
os_niù_timeout_e_ev’t
, &nict_transition[8], NULL},

30 {
NICT_PROCEEDING
, 
RCV_STATUS_1XX
, ((*)(*, *)è& 
niù_rcv_1xx
, &
niù_Œªs™iÚ
[9], 
NULL
}, {NICT_PROCEEDING, 
RCV_STATUS_2XX
, ((*)(*, *)è& 
niù_rcv_23456xx
, &nict_transition[10], NULL},

31 {
NICT_PROCEEDING
, 
RCV_STATUS_3456XX
, ((*)(*, *)è& 
niù_rcv_23456xx
, &
niù_Œªs™iÚ
[11], 
NULL
}, {
NICT_COMPLETED
, 
TIMEOUT_K
, ((*)(*, *)è& 
os_niù_timeout_k_ev’t
, NULL, NULL}};

33 
os_¡©emachše_t
 
	gniù_fsm
 = {
niù_Œªs™iÚ
};

35 
	$niù_hªdË_Œª¥Üt_”rÜ
(
os_Œª§ùiÚ_t
 *
niù
, 
”r
) {

36 
	`__os_Œª¥Üt_”rÜ_ÿÎback
(
OSIP_NICT_TRANSPORT_ERROR
, 
niù
, 
”r
);

37 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_TERMINATED
);

38 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_NICT_KILL_TRANSACTION
, 
niù
);

40 
	}
}

42 
	$niù_¢d_»que¡
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

43 
i
;

44 
os_t
 *
os
 = (os_ˆ*è
niù
->
cÚfig
;

47 
niù
->
Üig_»que¡
 = 
evt
->
s
;

49 
i
 = 
os
->
	`cb_£nd_mes§ge
(
niù
, 
evt
->
s
,‚iù->
niù_cÚ‹xt
->
de¡š©iÚ
,‚iù->niù_cÚ‹xt->
pÜt
,‚iù->
out_sock‘
);

51 ià(
i
 >= 0) {

53 ià(
	`MSG_IS_REGISTER
(
evt
->
s
))

54 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_REGISTER_SENT
, 
niù
,‚iù->
Üig_»que¡
);

56 ià(
	`MSG_IS_BYE
(
evt
->
s
))

57 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_BYE_SENT
, 
niù
,‚iù->
Üig_»que¡
);

59 ià(
	`MSG_IS_OPTIONS
(
evt
->
s
))

60 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_OPTIONS_SENT
, 
niù
,‚iù->
Üig_»que¡
);

62 ià(
	`MSG_IS_INFO
(
evt
->
s
))

63 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_INFO_SENT
, 
niù
,‚iù->
Üig_»que¡
);

65 ià(
	`MSG_IS_CANCEL
(
evt
->
s
))

66 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_CANCEL_SENT
, 
niù
,‚iù->
Üig_»que¡
);

68 ià(
	`MSG_IS_NOTIFY
(
evt
->
s
))

69 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_NOTIFY_SENT
, 
niù
,‚iù->
Üig_»que¡
);

71 ià(
	`MSG_IS_SUBSCRIBE
(
evt
->
s
))

72 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_SUBSCRIBE_SENT
, 
niù
,‚iù->
Üig_»que¡
);

75 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_UNKNOWN_REQUEST_SENT
, 
niù
,‚iù->
Üig_»que¡
);

77 #iâdeà
USE_BLOCKINGSOCKET


83 
os_vŸ_t
 *
vŸ
;

84 *
´Ùo
;

85 
k
;

87 
k
 = 
	`os_mes§ge_g‘_vŸ
(
niù
->
Üig_»que¡
, 0, &
vŸ
);

89 ià(
k
 < 0) {

90 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, -1);

94 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

96 ià(
´Ùo
 =ğ
NULL
) {

97 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, -1);

101 ià(
i
 == 0) {

102 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

104 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = -1;

105 
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
.
tv_£c
 = -1;

109 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

111 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 
DEFAULT_T1_TCP_PROGRESS
;

117 ià(
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 > 0) {

118 
	`os_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
, 
NULL
);

119 
	`add_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
,‚iù->niù_cÚ‹xt->
tim”_e_Ëngth
);

122 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_TRYING
);

125 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, 
i
);

127 
	}
}

129 
	$os_niù_timeout_e_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

130 
os_t
 *
os
 = (os_ˆ*è
niù
->
cÚfig
;

131 
i
;

134 ià(
niù
->
¡©e
 =ğ
NICT_TRYING
) {

135 
timev®
 
now
;

136 
timev®
 
du¿tiÚ
;

137 
–­£d
;

139 
	`os_g‘timeofday
(&
now
, 
NULL
);

140 
	`os_tim”sub
(&
now
, &
niù
->
ü—‹d_time
, &
du¿tiÚ
);

141 
–­£d
 = 
du¿tiÚ
.
tv_£c
 * 1000 + du¿tiÚ.
tv_u£c
 / 1000;

143 ià(
–­£d
 < 
DEFAULT_T1
)

144 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 
DEFAULT_T1
;

145 ià(
–­£d
 < 2 * 
DEFAULT_T1
)

146 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 2 * 
DEFAULT_T1
;

147 ià(
–­£d
 < 4 * 
DEFAULT_T1
)

148 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 4 * 
DEFAULT_T1
;

150 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 =‚ict->nict_context->timer_e_length * 2;

152 ià(
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 > 
DEFAULT_T2
)

153 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 
DEFAULT_T2
;

156 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 
DEFAULT_T2
;

158 
	`os_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
, 
NULL
);

159 
	`add_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
,‚iù->niù_cÚ‹xt->
tim”_e_Ëngth
);

162 
i
 = 
os
->
	`cb_£nd_mes§ge
(
niù
,‚iù->
Üig_»que¡
,‚iù->
niù_cÚ‹xt
->
de¡š©iÚ
,‚iù->niù_cÚ‹xt->
pÜt
,‚iù->
out_sock‘
);

164 ià(
i
 < 0) {

165 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, 
i
);

169 #iâdeà
USE_BLOCKINGSOCKET


175 ià(
i
 == 0) {

176 
os_vŸ_t
 *
vŸ
;

177 *
´Ùo
;

179 
i
 = 
	`os_mes§ge_g‘_vŸ
(
niù
->
Üig_»que¡
, 0, &
vŸ
);

181 ià(
i
 < 0) {

182 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, -1);

186 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

188 ià(
´Ùo
 =ğ
NULL
) {

189 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, -1);

193 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

195 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = -1;

196 
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
.
tv_£c
 = -1;

202 ià(
i
 == 0)

203 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_REQUEST_SENT_AGAIN
, 
niù
,‚iù->
Üig_»que¡
);

204 
	}
}

206 
	$os_niù_timeout_f_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

207 
niù
->
niù_cÚ‹xt
->
tim”_f_Ëngth
 = -1;

208 
niù
->
niù_cÚ‹xt
->
tim”_f_¡¬t
.
tv_£c
 = -1;

210 ià(
niù
->
out_sock‘
 == -999) {

211 
	`niù_hªdË_Œª¥Üt_”rÜ
(
niù
, -1);

213 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_TIMEOUT
, 
niù
, 
evt
->
s
);

214 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_TERMINATED
);

215 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_NICT_KILL_TRANSACTION
, 
niù
);

217 
	}
}

219 
	$os_niù_timeout_k_ev’t
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

220 
niù
->
niù_cÚ‹xt
->
tim”_k_Ëngth
 = -1;

221 
niù
->
niù_cÚ‹xt
->
tim”_k_¡¬t
.
tv_£c
 = -1;

223 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_TERMINATED
);

224 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_NICT_KILL_TRANSACTION
, 
niù
);

225 
	}
}

227 
	$niù_rcv_1xx
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

230 ià(
niù
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

231 
	`os_mes§ge_ä“
(
niù
->
Ï¡_»¥Ú£
);

234 
niù
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

237 ià(
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 > 0) {

238 
niù
->
niù_cÚ‹xt
->
tim”_e_Ëngth
 = 
DEFAULT_T2
;

239 
	`os_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
, 
NULL
);

240 
	`add_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_e_¡¬t
,‚iù->niù_cÚ‹xt->
tim”_e_Ëngth
);

243 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_1XX_RECEIVED
, 
niù
, 
evt
->
s
);

244 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_PROCEEDING
);

245 
	}
}

247 
	$niù_rcv_23456xx
(
os_Œª§ùiÚ_t
 *
niù
, 
os_ev’t_t
 *
evt
) {

250 ià(
niù
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

251 
	`os_mes§ge_ä“
(
niù
->
Ï¡_»¥Ú£
);

254 
niù
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

256 ià(
	`EVT_IS_RCV_STATUS_2XX
(
evt
))

257 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_2XX_RECEIVED
, 
niù
,‚iù->
Ï¡_»¥Ú£
);

259 ià(
	`MSG_IS_STATUS_3XX
(
niù
->
Ï¡_»¥Ú£
))

260 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_3XX_RECEIVED
, 
niù
,‚iù->
Ï¡_»¥Ú£
);

262 ià(
	`MSG_IS_STATUS_4XX
(
niù
->
Ï¡_»¥Ú£
))

263 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_4XX_RECEIVED
, 
niù
,‚iù->
Ï¡_»¥Ú£
);

265 ià(
	`MSG_IS_STATUS_5XX
(
niù
->
Ï¡_»¥Ú£
))

266 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_5XX_RECEIVED
, 
niù
,‚iù->
Ï¡_»¥Ú£
);

269 
	`__os_mes§ge_ÿÎback
(
OSIP_NICT_STATUS_6XX_RECEIVED
, 
niù
,‚iù->
Ï¡_»¥Ú£
);

271 ià(
niù
->
¡©e
 !ğ
NICT_COMPLETED
) {

272 
	`os_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_k_¡¬t
, 
NULL
);

273 
	`add_g‘timeofday
(&
niù
->
niù_cÚ‹xt
->
tim”_k_¡¬t
,‚iù->niù_cÚ‹xt->
tim”_k_Ëngth
);

276 
	`__os_Œª§ùiÚ_£t_¡©e
(
niù
, 
NICT_COMPLETED
);

277 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	$__os_ni¡_š™
(
os_ni¡_t
 **
ni¡
, 
os_t
 *
os
, 
os_mes§ge_t
 *
šv™e
) {

27 
i
;

29 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "allocating NIST context\n"));

31 *
ni¡
 = (
os_ni¡_t
 *è
	`os_m®loc
((osip_nist_t));

33 ià(*
ni¡
 =ğ
NULL
)

34  
OSIP_NOMEM
;

36 
	`mem£t
(*
ni¡
, 0, (
os_ni¡_t
));

39 
os_vŸ_t
 *
vŸ
;

40 *
´Ùo
;

42 
i
 = 
	`os_mes§ge_g‘_vŸ
(
šv™e
, 0, &
vŸ
);

44 ià(
i
 < 0) {

45 
	`os_ä“
(*
ni¡
);

46 *
ni¡
 = 
NULL
;

47  
i
;

50 
´Ùo
 = 
	`vŸ_g‘_´ÙocŞ
(
vŸ
);

52 ià(
´Ùo
 =ğ
NULL
) {

53 
	`os_ä“
(*
ni¡
);

54 *
ni¡
 = 
NULL
;

55  
OSIP_UNDEFINED_ERROR
;

58 ià(
	`os_¡rÿ£cmp
(
´Ùo
, "TCP") != 0 && osip_strcasecmp(proto, "TLS") != 0 && osip_strcasecmp(proto, "SCTP") != 0) {

59 (*
ni¡
)->
tim”_j_Ëngth
 = 64 * 
DEFAULT_T1
;

60 (*
ni¡
)->
tim”_j_¡¬t
.
tv_£c
 = -1;

63 (*
ni¡
)->
tim”_j_Ëngth
 = 0;

64 (*
ni¡
)->
tim”_j_¡¬t
.
tv_£c
 = -1;

68  
OSIP_SUCCESS
;

69 
	}
}

71 
	$__os_ni¡_ä“
(
os_ni¡_t
 *
ni¡
) {

72 ià(
ni¡
 =ğ
NULL
)

73  
OSIP_SUCCESS
;

75 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "free‚ist„esource\n"));

77 
	`os_ä“
(
ni¡
);

78  
OSIP_SUCCESS
;

79 
	}
}

81 
os_ev’t_t
 *
	$__os_ni¡_Ãed_tim”_j_ev’t
(
os_ni¡_t
 *
ni¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
) {

82  
	`__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(
ni¡
, &ni¡->
tim”_j_¡¬t
, 
¡©e
 =ğ
NIST_COMPLETED
, 
Œª§ùiÚid
, 
TIMEOUT_J
);

83 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist_fsm.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

25 
Œªs™iÚ_t
 
	gni¡_Œªs™iÚ
[10] = {

26 {
NIST_PRE_TRYING
, 
RCV_REQUEST
, ((*)(*, *)è& 
ni¡_rcv_»que¡
, &
ni¡_Œªs™iÚ
[1], 
NULL
}, {
NIST_TRYING
, 
SND_STATUS_1XX
, ((*)(*, *)è& 
ni¡_¢d_1xx
, &nist_transition[2], NULL},

27 {
NIST_TRYING
, 
SND_STATUS_2XX
, ((*)(*, *)è& 
ni¡_¢d_23456xx
, &
ni¡_Œªs™iÚ
[3], 
NULL
}, {NIST_TRYING, 
SND_STATUS_3456XX
, ((*)(*, *)) &‚ist_snd_23456xx, &nist_transition[4], NULL},

28 {
NIST_PROCEEDING
, 
SND_STATUS_1XX
, ((*)(*, *)è& 
ni¡_¢d_1xx
, &
ni¡_Œªs™iÚ
[5], 
NULL
}, {NIST_PROCEEDING, 
SND_STATUS_2XX
, ((*)(*, *)è& 
ni¡_¢d_23456xx
, &nist_transition[6], NULL},

29 {
NIST_PROCEEDING
, 
SND_STATUS_3456XX
, ((*)(*, *)è& 
ni¡_¢d_23456xx
, &
ni¡_Œªs™iÚ
[7], 
NULL
}, {NIST_PROCEEDING, 
RCV_REQUEST
, ((*)(*, *)è& 
ni¡_rcv_»que¡
, &nist_transition[8], NULL},

30 {
NIST_COMPLETED
, 
TIMEOUT_J
, ((*)(*, *)è& 
os_ni¡_timeout_j_ev’t
, &
ni¡_Œªs™iÚ
[9], 
NULL
}, {NIST_COMPLETED, 
RCV_REQUEST
, ((*)(*, *)è& 
ni¡_rcv_»que¡
, NULL, NULL}};

32 
os_¡©emachše_t
 
	gni¡_fsm
 = {
ni¡_Œªs™iÚ
};

34 
	$ni¡_hªdË_Œª¥Üt_”rÜ
(
os_Œª§ùiÚ_t
 *
ni¡
, 
”r
) {

35 
	`__os_Œª¥Üt_”rÜ_ÿÎback
(
OSIP_NIST_TRANSPORT_ERROR
, 
ni¡
, 
”r
);

36 
	`__os_Œª§ùiÚ_£t_¡©e
(
ni¡
, 
NIST_TERMINATED
);

37 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_NIST_KILL_TRANSACTION
, 
ni¡
);

39 
	}
}

41 
	$ni¡_rcv_»que¡
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
) {

42 
i
;

44 ià(
ni¡
->
¡©e
 =ğ
NIST_PRE_TRYING
) {

46 
ni¡
->
Üig_»que¡
 = 
evt
->
s
;

48 ià(
	`MSG_IS_REGISTER
(
evt
->
s
))

49 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_REGISTER_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

51 ià(
	`MSG_IS_BYE
(
evt
->
s
))

52 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_BYE_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

54 ià(
	`MSG_IS_OPTIONS
(
evt
->
s
))

55 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_OPTIONS_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

57 ià(
	`MSG_IS_INFO
(
evt
->
s
))

58 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_INFO_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

60 ià(
	`MSG_IS_CANCEL
(
evt
->
s
))

61 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_CANCEL_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

63 ià(
	`MSG_IS_NOTIFY
(
evt
->
s
))

64 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_NOTIFY_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

66 ià(
	`MSG_IS_SUBSCRIBE
(
evt
->
s
))

67 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_SUBSCRIBE_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

70 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_UNKNOWN_REQUEST_RECEIVED
, 
ni¡
,‚i¡->
Üig_»que¡
);

75 
	`os_mes§ge_ä“
(
evt
->
s
);

77 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_REQUEST_RECEIVED_AGAIN
, 
ni¡
,‚i¡->
Üig_»que¡
);

79 ià(
ni¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

80 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

82 ià(
i
 != 0) {

83 
	`ni¡_hªdË_Œª¥Üt_”rÜ
(
ni¡
, 
i
);

87 ià(
	`MSG_IS_STATUS_1XX
(
ni¡
->
Ï¡_»¥Ú£
))

88 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_1XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

90 ià(
	`MSG_IS_STATUS_2XX
(
ni¡
->
Ï¡_»¥Ú£
))

91 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_2XX_SENT_AGAIN
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

94 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_3456XX_SENT_AGAIN
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

105 
	`__os_Œª§ùiÚ_£t_¡©e
(
ni¡
, 
NIST_TRYING
);

106 
	}
}

108 
	$ni¡_¢d_1xx
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
) {

109 
i
;

111 ià(
ni¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

112 
	`os_mes§ge_ä“
(
ni¡
->
Ï¡_»¥Ú£
);

115 
ni¡
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

117 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

119 ià(
i
 != 0) {

120 
	`ni¡_hªdË_Œª¥Üt_”rÜ
(
ni¡
, 
i
);

124 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_1XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

126 
	`__os_Œª§ùiÚ_£t_¡©e
(
ni¡
, 
NIST_PROCEEDING
);

127 
	}
}

129 
	$ni¡_¢d_23456xx
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
) {

130 
i
;

132 ià(
ni¡
->
Ï¡_»¥Ú£
 !ğ
NULL
) {

133 
	`os_mes§ge_ä“
(
ni¡
->
Ï¡_»¥Ú£
);

136 
ni¡
->
Ï¡_»¥Ú£
 = 
evt
->
s
;

138 
i
 = 
	`__os_Œª§ùiÚ_¢d_xxx
(
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

140 ià(
i
 != 0) {

141 
	`ni¡_hªdË_Œª¥Üt_”rÜ
(
ni¡
, 
i
);

145 ià(
	`EVT_IS_SND_STATUS_2XX
(
evt
))

146 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_2XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

148 ià(
	`MSG_IS_STATUS_3XX
(
ni¡
->
Ï¡_»¥Ú£
))

149 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_3XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

151 ià(
	`MSG_IS_STATUS_4XX
(
ni¡
->
Ï¡_»¥Ú£
))

152 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_4XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

154 ià(
	`MSG_IS_STATUS_5XX
(
ni¡
->
Ï¡_»¥Ú£
))

155 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_5XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

158 
	`__os_mes§ge_ÿÎback
(
OSIP_NIST_STATUS_6XX_SENT
, 
ni¡
,‚i¡->
Ï¡_»¥Ú£
);

161 ià(
ni¡
->
¡©e
 !ğ
NIST_COMPLETED
) {

162 
	`os_g‘timeofday
(&
ni¡
->
ni¡_cÚ‹xt
->
tim”_j_¡¬t
, 
NULL
);

163 
	`add_g‘timeofday
(&
ni¡
->
ni¡_cÚ‹xt
->
tim”_j_¡¬t
,‚i¡->ni¡_cÚ‹xt->
tim”_j_Ëngth
);

166 
	`__os_Œª§ùiÚ_£t_¡©e
(
ni¡
, 
NIST_COMPLETED
);

167 
	}
}

169 
	$os_ni¡_timeout_j_ev’t
(
os_Œª§ùiÚ_t
 *
ni¡
, 
os_ev’t_t
 *
evt
) {

170 
ni¡
->
ni¡_cÚ‹xt
->
tim”_j_Ëngth
 = -1;

171 
ni¡
->
ni¡_cÚ‹xt
->
tim”_j_¡¬t
.
tv_£c
 = -1;

173 
	`__os_Œª§ùiÚ_£t_¡©e
(
ni¡
, 
NIST_TERMINATED
);

174 
	`__os_kl_Œª§ùiÚ_ÿÎback
(
OSIP_NIST_KILL_TRANSACTION
, 
ni¡
);

175 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
	~<os2/os_dŸlog.h
>

28 #ià
defšed
(
HAVE_DICT_DICT_H
)

29 
	~<diù/diù.h
>

32 
	$os_»¥Ú£_g‘_de¡š©iÚ
(
os_mes§ge_t
 *
»¥Ú£
, **
add»ss
, *
pÜŠum
) {

33 
os_vŸ_t
 *
vŸ
;

34 *
ho¡
 = 
NULL
;

35 
pÜt
 = 0;

37 
vŸ
 = (
os_vŸ_t
 *è
	`os_li¡_g‘
(&
»¥Ú£
->
vŸs
, 0);

39 ià(
vŸ
) {

40 
os_g’”ic_·¿m_t
 *
maddr
;

41 
os_g’”ic_·¿m_t
 *
»ûived
;

42 
os_g’”ic_·¿m_t
 *
½Üt
;

44 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "maddr", &
maddr
);

45 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "»ûived", &
»ûived
);

46 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "½Üt", &
½Üt
);

53 ià(
maddr
 !ğ
NULL
)

54 
ho¡
 = 
maddr
->
gv®ue
;

59 ià(
»ûived
 !ğ
NULL
)

60 
ho¡
 = 
»ûived
->
gv®ue
;

63 
ho¡
 = 
vŸ
->host;

65 ià(
½Üt
 =ğ
NULL
 ||„pÜt->
gv®ue
 == NULL) {

66 ià(
vŸ
->
pÜt
 !ğ
NULL
)

67 
pÜt
 = 
	`os_©oi
(
vŸ
->port);

70 
pÜt
 = 5060;

73 
pÜt
 = 
	`os_©oi
(
½Üt
->
gv®ue
);

76 *
pÜŠum
 = 
pÜt
;

78 ià(
ho¡
 !ğ
NULL
)

79 *
add»ss
 = 
	`os_¡rdup
(
ho¡
);

82 *
add»ss
 = 
NULL
;

83 
	}
}

85 
	$os_ixt_lock
(
os_t
 *
os
) {

86 #iâdeà
OSIP_MONOTHREAD


87  
	`os_mu‹x_lock
(
os
->
ixt_ç¡mu‹x
);

89  
OSIP_SUCCESS
;

91 
	}
}

93 
	$os_ixt_uÆock
(
os_t
 *
os
) {

94 #iâdeà
OSIP_MONOTHREAD


95  
	`os_mu‹x_uÆock
(
os
->
ixt_ç¡mu‹x
);

97  
OSIP_SUCCESS
;

99 
	}
}

101 
os_id_mu‹x_lock
(
os_t
 *
os
);

102 
os_id_mu‹x_uÆock
(
os_t
 *
os
);

104 
	$os_id_mu‹x_lock
(
os_t
 *
os
) {

105 #iâdeà
OSIP_MONOTHREAD


106  
	`os_mu‹x_lock
(
os
->
id_mu‹x
);

108  
OSIP_SUCCESS
;

110 
	}
}

112 
	$os_id_mu‹x_uÆock
(
os_t
 *
os
) {

113 #iâdeà
OSIP_MONOTHREAD


114  
	`os_mu‹x_uÆock
(
os
->
id_mu‹x
);

116  
OSIP_SUCCESS
;

118 
	}
}

121 
	$os_add_ixt
(
os_t
 *
os
, 
ixt_t
 *
ixt
) {

123 
	`os_ixt_lock
(
os
);

124 
	`os_li¡_add
(&
os
->
ixt_»ŒªsmissiÚs
, (*è
ixt
, 0);

125 
	`os_ixt_uÆock
(
os
);

126 
	}
}

128 
	$ixt_š™
(
ixt_t
 **
ixt
) {

129 
ixt_t
 *
pixt
;

131 *
ixt
 = 
pixt
 = (
ixt_t
 *è
	`os_m®loc
((ixt_t));

133 ià(
pixt
 =ğ
NULL
)

134  
OSIP_NOMEM
;

136 
pixt
->
dŸlog
 = 
NULL
;

137 
pixt
->
msg2xx
 = 
NULL
;

138 
pixt
->
ack
 = 
NULL
;

139 
pixt
->
š‹rv®
 = 
DEFAULT_T1
;

140 
	`os_g‘timeofday
(&
pixt
->
¡¬t
, 
NULL
);

141 
	`add_g‘timeofday
(&
pixt
->
¡¬t
,…ixt->
š‹rv®
 + 10);

142 
pixt
->
couÁ”
 = 10;

143 
pixt
->
de¡
 = 
NULL
;

144 
pixt
->
pÜt
 = 5060;

145 
pixt
->
sock
 = -1;

146  
OSIP_SUCCESS
;

147 
	}
}

149 
	$ixt_ä“
(
ixt_t
 *
ixt
) {

150 
	`os_mes§ge_ä“
(
ixt
->
ack
);

151 
	`os_mes§ge_ä“
(
ixt
->
msg2xx
);

152 
	`os_ä“
(
ixt
->
de¡
);

153 
	`os_ä“
(
ixt
);

154 
	}
}

157 
	$os_¡¬t_200ok_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
msg200ok
, 
sock
) {

158 
i
;

159 
ixt_t
 *
ixt
;

161 
i
 = 
	`ixt_š™
(&
ixt
);

163 ià(
i
 != 0)

166 
ixt
->
dŸlog
 = dialog;

167 
	`os_mes§ge_şÚe
(
msg200ok
, &
ixt
->
msg2xx
);

168 
ixt
->
sock
 = sock;

169 
	`os_»¥Ú£_g‘_de¡š©iÚ
(
msg200ok
, &
ixt
->
de¡
, &ixt->
pÜt
);

170 
	`os_add_ixt
(
os
, 
ixt
);

171 
	}
}

173 
	$os_¡¬t_ack_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
ack
, *
de¡
, 
pÜt
, 
sock
) {

174 
i
;

175 
ixt_t
 *
ixt
;

177 
i
 = 
	`ixt_š™
(&
ixt
);

179 ià(
i
 != 0)

182 
ixt
->
dŸlog
 = dialog;

183 
	`os_mes§ge_şÚe
(
ack
, &
ixt
->ack);

184 
ixt
->
de¡
 = 
	`os_¡rdup
(dest);

185 
ixt
->
pÜt
 =…ort;

186 
ixt
->
sock
 = sock;

187 
	`os_add_ixt
(
os
, 
ixt
);

188 
	}
}

191 
os_dŸlog
 *
	$os_¡İ_200ok_»ŒªsmissiÚs
(
os_t
 *
os
, 
os_mes§ge_t
 *
ack
) {

192 
os_dŸlog_t
 *
dŸlog
 = 
NULL
;

193 
i
;

194 
ixt_t
 *
ixt
;

196 ià(
ack
 =ğ
NULL
 ||‡ck->
c£q
 =ğNULL ||‡ck->c£q->
numb”
 == NULL)

197  
NULL
;

199 
	`os_ixt_lock
(
os
);

201 
i
 = 0; !
	`os_li¡_eŞ
(&
os
->
ixt_»ŒªsmissiÚs
, i); i++) {

202 
ixt
 = (
ixt_t
 *è
	`os_li¡_g‘
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

204 ià(
ixt
->
msg2xx
 =ğ
NULL
 || ixt->msg2xx->
c£q
 =ğNULL || ixt->msg2xx->c£q->
numb”
 == NULL)

207 ià(
	`os_dŸlog_m©ch_as_uas
(
ixt
->
dŸlog
, 
ack
è=ğ0 && 
	`¡rcmp
(ixt->
msg2xx
->
c£q
->
numb”
,‡ck->cseq->number) == 0) {

208 
	`os_li¡_»move
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

209 
dŸlog
 = 
ixt
->dialog;

210 
	`ixt_ä“
(
ixt
);

215 
	`os_ixt_uÆock
(
os
);

216  
dŸlog
;

217 
	}
}

221 
	$os_¡İ_»ŒªsmissiÚs_äom_dŸlog
(
os_t
 *
os
, 
os_dŸlog_t
 *
dŸlog
) {

222 
i
;

223 
ixt_t
 *
ixt
;

225 
	`os_ixt_lock
(
os
);

227 
i
 = 0; !
	`os_li¡_eŞ
(&
os
->
ixt_»ŒªsmissiÚs
, i); i++) {

228 
ixt
 = (
ixt_t
 *è
	`os_li¡_g‘
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

230 ià(
ixt
->
dŸlog
 == dialog) {

231 
	`os_li¡_»move
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

232 
	`ixt_ä“
(
ixt
);

233 
i
--;

237 
	`os_ixt_uÆock
(
os
);

238 
	}
}

240 
	$ixt_»Œªsm™
(
os_t
 *
os
, 
ixt_t
 *
ixt
, 
timev®
 *
cu¼’t
) {

241 ià(
	`os_tim”cmp
(
cu¼’t
, &
ixt
->
¡¬t
, >=)) {

242 
ixt
->
š‹rv®
 = ixt->interval * 2;

244 ià(
ixt
->
š‹rv®
 > 
DEFAULT_T2
)

245 
ixt
->
š‹rv®
 = 
DEFAULT_T2
;

247 
	`add_g‘timeofday
(&
ixt
->
¡¬t
, ixt->
š‹rv®
);

249 ià(
ixt
->
ack
 !ğ
NULL
)

250 
os
->
	`cb_£nd_mes§ge
(
NULL
, 
ixt
->
ack
, ixt->
de¡
, ixt->
pÜt
, ixt->
sock
);

252 ià(
ixt
->
msg2xx
 !ğ
NULL
)

253 
os
->
	`cb_£nd_mes§ge
(
NULL
, 
ixt
->
msg2xx
, ixt->
de¡
, ixt->
pÜt
, ixt->
sock
);

255 
ixt
->
couÁ”
--;

257 
	}
}

259 
	$os_»ŒªsmissiÚs_execu‹
(
os_t
 *
os
) {

260 
i
;

261 
ixt_t
 *
ixt
;

262 
timev®
 
cu¼’t
;

264 
	`os_g‘timeofday
(&
cu¼’t
, 
NULL
);

266 
	`os_ixt_lock
(
os
);

268 
i
 = 0; !
	`os_li¡_eŞ
(&
os
->
ixt_»ŒªsmissiÚs
, i); i++) {

269 
ixt
 = (
ixt_t
 *è
	`os_li¡_g‘
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

270 
	`ixt_»Œªsm™
(
os
, 
ixt
, &
cu¼’t
);

272 ià(
ixt
->
couÁ”
 == 0) {

274 
	`os_li¡_»move
(&
os
->
ixt_»ŒªsmissiÚs
, 
i
);

275 
	`ixt_ä“
(
ixt
);

276 
i
--;

280 
	`os_ixt_uÆock
(
os
);

281 
	}
}

283 
	$os_iù_lock
(
os_t
 *
os
) {

284 #iâdeà
OSIP_MONOTHREAD


285  
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

287  
OSIP_SUCCESS
;

289 
	}
}

291 
	$os_iù_uÆock
(
os_t
 *
os
) {

292 #iâdeà
OSIP_MONOTHREAD


293  
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

295  
OSIP_SUCCESS
;

297 
	}
}

299 
	$os_i¡_lock
(
os_t
 *
os
) {

300 #iâdeà
OSIP_MONOTHREAD


301  
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

303  
OSIP_SUCCESS
;

305 
	}
}

307 
	$os_i¡_uÆock
(
os_t
 *
os
) {

308 #iâdeà
OSIP_MONOTHREAD


309  
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

311  
OSIP_SUCCESS
;

313 
	}
}

315 
	$os_niù_lock
(
os_t
 *
os
) {

316 #iâdeà
OSIP_MONOTHREAD


317  
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

319  
OSIP_SUCCESS
;

321 
	}
}

323 
	$os_niù_uÆock
(
os_t
 *
os
) {

324 #iâdeà
OSIP_MONOTHREAD


325  
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

327  
OSIP_SUCCESS
;

329 
	}
}

331 
	$os_ni¡_lock
(
os_t
 *
os
) {

332 #iâdeà
OSIP_MONOTHREAD


333  
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

335  
OSIP_SUCCESS
;

337 
	}
}

339 
	$os_ni¡_uÆock
(
os_t
 *
os
) {

340 #iâdeà
OSIP_MONOTHREAD


341  
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

343  
OSIP_SUCCESS
;

345 
	}
}

347 #ià
defšed
(
HAVE_DICT_DICT_H
)

348 
	#HSIZE
 200

	)

350 
s_hash
(cÚ¡ *
p
);

352 
	$s_hash
(cÚ¡ *
p
) {

353 
hash
 = 0;

355 *
p
) {

356 
hash
 *= 31;

357 
hash
 ^ğ*
p
++;

360  
hash
;

361 
	}
}

364 
	$__os_add_iù
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
iù
) {

365 #iâdeà
OSIP_MONOTHREAD


366 
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

368 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

370 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

371 
rv
 = -99;

373 
	`os_vŸ_·¿m_g‘_byÇme
(
iù
->
tİvŸ
, "b¿nch", &
b_»que¡
);

375 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL)

376 
rv
 = 
	`diù_š£¹
((
diù
 *è
os
->
os_iù_ha¡abË
, 
b_»que¡
->
gv®ue
, (*è
iù
, 
FALSE
);

378 ià(
rv
 == 0) {

379 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£¹ed iÀiù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

381 } ià(
rv
 != -99) {

382 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "®»ady in£¹ed `%s'\n", 
b_»que¡
->
gv®ue
));

386 
	`os_li¡_add
(&
os
->
os_iù_Œª§ùiÚs
, 
iù
, -1);

387 #iâdeà
OSIP_MONOTHREAD


388 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

390  
OSIP_SUCCESS
;

391 
	}
}

393 
	$__os_add_i¡
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
i¡
) {

394 #iâdeà
OSIP_MONOTHREAD


395 
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

397 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

399 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

400 
rv
 = -99;

402 
	`os_vŸ_·¿m_g‘_byÇme
(
i¡
->
tİvŸ
, "b¿nch", &
b_»que¡
);

404 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL)

405 
rv
 = 
	`diù_š£¹
((
diù
 *è
os
->
os_i¡_ha¡abË
, 
b_»que¡
->
gv®ue
, (*è
i¡
, 
FALSE
);

407 ià(
rv
 == 0) {

408 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£¹ed iÀi¡ ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

410 } ià(
rv
 != -99) {

411 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "®»ady in£¹ed `%s'\n", 
b_»que¡
->
gv®ue
));

415 
	`os_li¡_add
(&
os
->
os_i¡_Œª§ùiÚs
, 
i¡
, -1);

416 #iâdeà
OSIP_MONOTHREAD


417 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

419  
OSIP_SUCCESS
;

420 
	}
}

422 
	$__os_add_niù
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
niù
) {

423 #iâdeà
OSIP_MONOTHREAD


424 
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

426 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

428 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

429 
rv
 = -99;

431 
	`os_vŸ_·¿m_g‘_byÇme
(
niù
->
tİvŸ
, "b¿nch", &
b_»que¡
);

433 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL)

434 
rv
 = 
	`diù_š£¹
((
diù
 *è
os
->
os_niù_ha¡abË
, 
b_»que¡
->
gv®ue
, (*è
niù
, 
FALSE
);

436 ià(
rv
 == 0) {

437 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£¹ed iÀniù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

439 } ià(
rv
 != -99) {

440 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "®»ady in£¹ed `%s'\n", 
b_»que¡
->
gv®ue
));

444 
	`os_li¡_add
(&
os
->
os_niù_Œª§ùiÚs
, 
niù
, -1);

445 #iâdeà
OSIP_MONOTHREAD


446 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

448  
OSIP_SUCCESS
;

449 
	}
}

451 
	$__os_add_ni¡
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
ni¡
) {

452 #iâdeà
OSIP_MONOTHREAD


453 
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

455 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

457 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

458 
rv
 = -99;

460 
	`os_vŸ_·¿m_g‘_byÇme
(
ni¡
->
tİvŸ
, "b¿nch", &
b_»que¡
);

462 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL)

463 
rv
 = 
	`diù_š£¹
((
diù
 *è
os
->
os_ni¡_ha¡abË
, 
b_»que¡
->
gv®ue
, (*è
ni¡
, 
FALSE
);

465 ià(
rv
 == 0) {

466 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key in£¹ed iÀiù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

468 } ià(
rv
 != -99) {

469 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "®»ady in£¹ed `%s'\n", 
b_»que¡
->
gv®ue
));

473 
	`os_li¡_add
(&
os
->
os_ni¡_Œª§ùiÚs
, 
ni¡
, -1);

474 #iâdeà
OSIP_MONOTHREAD


475 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

477  
OSIP_SUCCESS
;

478 
	}
}

480 
	$os_»move_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
Œ
) {

481 
i
 = -1;

483 ià(
Œ
 =ğ
NULL
)

484  
OSIP_BADPARAMETER
;

486 ià(
Œ
->
ùx_ty³
 =ğ
ICT
)

487 
i
 = 
	`__os_»move_iù_Œª§ùiÚ
(
os
, 
Œ
);

489 ià(
Œ
->
ùx_ty³
 =ğ
IST
)

490 
i
 = 
	`__os_»move_i¡_Œª§ùiÚ
(
os
, 
Œ
);

492 ià(
Œ
->
ùx_ty³
 =ğ
NICT
)

493 
i
 = 
	`__os_»move_niù_Œª§ùiÚ
(
os
, 
Œ
);

495 ià(
Œ
->
ùx_ty³
 =ğ
NIST
)

496 
i
 = 
	`__os_»move_ni¡_Œª§ùiÚ
(
os
, 
Œ
);

499  
OSIP_BADPARAMETER
;

501  
i
;

502 
	}
}

504 
	$__os_»move_iù_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
iù
) {

505 
os_li¡_™”©Ü_t
 
™”©Ü
;

506 
os_Œª§ùiÚ_t
 *
tmp
;

508 #iâdeà
OSIP_MONOTHREAD


509 
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

512 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

514 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

515 
rv
;

517 
	`os_vŸ_·¿m_g‘_byÇme
(
iù
->
tİvŸ
, "b¿nch", &
b_»que¡
);

519 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

520 
rv
 = 
	`diù_»move
((
diù
 *è
os
->
os_iù_ha¡abË
, 
b_»que¡
->
gv®ue
, 
TRUE
);

522 ià(
rv
 == 0) {

523 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key d–‘ed iÀiù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

526 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "key‚Ù„emoved `%s'\n", 
b_»que¡
->
gv®ue
));

532 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_iù_Œª§ùiÚs
, &
™”©Ü
);

534 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

535 ià(
tmp
->
Œª§ùiÚid
 =ğ
iù
->transactionid) {

536 
	`os_li¡_™”©Ü_»move
(&
™”©Ü
);

537 #iâdeà
OSIP_MONOTHREAD


538 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

540  
OSIP_SUCCESS
;

543 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

546 #iâdeà
OSIP_MONOTHREAD


547 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

549  
OSIP_UNDEFINED_ERROR
;

550 
	}
}

552 
	$__os_»move_i¡_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
i¡
) {

553 
os_li¡_™”©Ü_t
 
™”©Ü
;

554 
os_Œª§ùiÚ_t
 *
tmp
;

556 #iâdeà
OSIP_MONOTHREAD


557 
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

560 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

562 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

563 
rv
;

565 
	`os_vŸ_·¿m_g‘_byÇme
(
i¡
->
tİvŸ
, "b¿nch", &
b_»que¡
);

567 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

568 
rv
 = 
	`diù_»move
((
diù
 *è
os
->
os_i¡_ha¡abË
, 
b_»que¡
->
gv®ue
, 
TRUE
);

570 ià(
rv
 == 0) {

571 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key d–‘ed iÀi¡ ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

574 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "key‚Ù„emoved `%s'\n", 
b_»que¡
->
gv®ue
));

580 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_i¡_Œª§ùiÚs
, &
™”©Ü
);

582 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

583 ià(
tmp
->
Œª§ùiÚid
 =ğ
i¡
->transactionid) {

584 
	`os_li¡_™”©Ü_»move
(&
™”©Ü
);

585 #iâdeà
OSIP_MONOTHREAD


586 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

588  
OSIP_SUCCESS
;

591 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

594 #iâdeà
OSIP_MONOTHREAD


595 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

597  
OSIP_UNDEFINED_ERROR
;

598 
	}
}

600 
	$__os_»move_niù_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
niù
) {

601 
os_li¡_™”©Ü_t
 
™”©Ü
;

602 
os_Œª§ùiÚ_t
 *
tmp
;

604 #iâdeà
OSIP_MONOTHREAD


605 
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

608 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

610 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

611 
rv
;

613 
	`os_vŸ_·¿m_g‘_byÇme
(
niù
->
tİvŸ
, "b¿nch", &
b_»que¡
);

615 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

616 
rv
 = 
	`diù_»move
((
diù
 *è
os
->
os_niù_ha¡abË
, 
b_»que¡
->
gv®ue
, 
TRUE
);

618 ià(
rv
 == 0) {

619 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key d–‘ed iÀniù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

622 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "key‚Ù„emoved `%s'\n", 
b_»que¡
->
gv®ue
));

628 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_niù_Œª§ùiÚs
, &
™”©Ü
);

630 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

631 ià(
tmp
->
Œª§ùiÚid
 =ğ
niù
->transactionid) {

632 
	`os_li¡_™”©Ü_»move
(&
™”©Ü
);

633 #iâdeà
OSIP_MONOTHREAD


634 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

636  
OSIP_SUCCESS
;

639 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

642 #iâdeà
OSIP_MONOTHREAD


643 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

645  
OSIP_UNDEFINED_ERROR
;

646 
	}
}

648 
	$__os_»move_ni¡_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
ni¡
) {

649 
os_li¡_™”©Ü_t
 
™”©Ü
;

650 
os_Œª§ùiÚ_t
 *
tmp
;

652 #iâdeà
OSIP_MONOTHREAD


653 
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

656 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

658 
os_g’”ic_·¿m_t
 *
b_»que¡
 = 
NULL
;

659 
rv
;

661 
	`os_vŸ_·¿m_g‘_byÇme
(
ni¡
->
tİvŸ
, "b¿nch", &
b_»que¡
);

663 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

664 
rv
 = 
	`diù_»move
((
diù
 *è
os
->
os_ni¡_ha¡abË
, 
b_»que¡
->
gv®ue
, 
TRUE
);

666 ià(
rv
 == 0) {

667 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "New key d–‘ed iÀiù ha¡abË `%s'\n", 
b_»que¡
->
gv®ue
));

670 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "key‚Ù„emoved `%s'\n", 
b_»que¡
->
gv®ue
));

676 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_ni¡_Œª§ùiÚs
, &
™”©Ü
);

678 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

679 ià(
tmp
->
Œª§ùiÚid
 =ğ
ni¡
->transactionid) {

680 
	`os_li¡_™”©Ü_»move
(&
™”©Ü
);

681 #iâdeà
OSIP_MONOTHREAD


682 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

684  
OSIP_SUCCESS
;

687 
tmp
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

690 #iâdeà
OSIP_MONOTHREAD


691 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

693  
OSIP_UNDEFINED_ERROR
;

694 
	}
}

696 
	$os_fšd_Œª§ùiÚ_ªd_add_ev’t
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
) {

697 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
 = 
	`__os_fšd_Œª§ùiÚ
(
os
, 
evt
, 1);

699 ià(
Œª§ùiÚ
 =ğ
NULL
)

700  
OSIP_UNDEFINED_ERROR
;

702  
OSIP_SUCCESS
;

703 
	}
}

705 #ifdeà
OSIP_MONOTHREAD


706 
os_Œª§ùiÚ_t
 *
	$os_fšd_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
) {

707  
	`__os_fšd_Œª§ùiÚ
(
os
, 
evt
, 0);

708 
	}
}

711 
os_Œª§ùiÚ_t
 *
	$__os_fšd_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
, 
cÚsume
) {

712 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
 = 
NULL
;

713 
os_li¡_t
 *
Œª§ùiÚs
 = 
NULL
;

715 #iâdeà
OSIP_MONOTHREAD


716 
os_mu‹x
 *
mut
 = 
NULL
;

719 ià(
evt
 =ğ
NULL
 ||ƒvt->
s
 =ğNULL ||ƒvt->s->
c£q
 == NULL)

720  
NULL
;

722 ià(
	`EVT_IS_INCOMINGMSG
(
evt
)) {

723 ià(
	`MSG_IS_REQUEST
(
evt
->
s
)) {

724 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE") || 0 == strcmp(evt->sip->cseq->method, "ACK")) {

725 
Œª§ùiÚs
 = &
os
->
os_i¡_Œª§ùiÚs
;

726 #iâdeà
OSIP_MONOTHREAD


727 
mut
 = 
os
->
i¡_ç¡mu‹x
;

731 
Œª§ùiÚs
 = &
os
->
os_ni¡_Œª§ùiÚs
;

732 #iâdeà
OSIP_MONOTHREAD


733 
mut
 = 
os
->
ni¡_ç¡mu‹x
;

738 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE")) {

739 
Œª§ùiÚs
 = &
os
->
os_iù_Œª§ùiÚs
;

740 #iâdeà
OSIP_MONOTHREAD


741 
mut
 = 
os
->
iù_ç¡mu‹x
;

745 
Œª§ùiÚs
 = &
os
->
os_niù_Œª§ùiÚs
;

746 #iâdeà
OSIP_MONOTHREAD


747 
mut
 = 
os
->
niù_ç¡mu‹x
;

752 } ià(
	`EVT_IS_OUTGOINGMSG
(
evt
)) {

753 ià(
	`MSG_IS_RESPONSE
(
evt
->
s
)) {

754 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE")) {

755 
Œª§ùiÚs
 = &
os
->
os_i¡_Œª§ùiÚs
;

756 #iâdeà
OSIP_MONOTHREAD


757 
mut
 = 
os
->
i¡_ç¡mu‹x
;

761 
Œª§ùiÚs
 = &
os
->
os_ni¡_Œª§ùiÚs
;

762 #iâdeà
OSIP_MONOTHREAD


763 
mut
 = 
os
->
ni¡_ç¡mu‹x
;

768 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE") || 0 == strcmp(evt->sip->cseq->method, "ACK")) {

769 
Œª§ùiÚs
 = &
os
->
os_iù_Œª§ùiÚs
;

770 #iâdeà
OSIP_MONOTHREAD


771 
mut
 = 
os
->
iù_ç¡mu‹x
;

775 
Œª§ùiÚs
 = &
os
->
os_niù_Œª§ùiÚs
;

776 #iâdeà
OSIP_MONOTHREAD


777 
mut
 = 
os
->
niù_ç¡mu‹x
;

783 ià(
Œª§ùiÚs
 =ğ
NULL
)

784  
NULL
;

786 #iâdeà
OSIP_MONOTHREAD


787 
	`os_mu‹x_lock
(
mut
);

789 
Œª§ùiÚ
 = 
	`os_Œª§ùiÚ_fšd
(
Œª§ùiÚs
, 
evt
);

791 ià(
cÚsume
 == 1) {

792 ià(
Œª§ùiÚ
 !ğ
NULL
) {

793 
	`os_Œª§ùiÚ_add_ev’t
(
Œª§ùiÚ
, 
evt
);

794 #iâdeà
OSIP_MONOTHREAD


795 
	`os_mu‹x_uÆock
(
mut
);

797  
Œª§ùiÚ
;

801 #iâdeà
OSIP_MONOTHREAD


802 
	`os_mu‹x_uÆock
(
mut
);

805  
Œª§ùiÚ
;

806 
	}
}

808 
os_Œª§ùiÚ_t
 *
	$os_ü—‹_Œª§ùiÚ
(
os_t
 *
os
, 
os_ev’t_t
 *
evt
) {

809 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

810 
i
;

811 
os_fsm_ty³_t
 
ùx_ty³
;

813 ià(
evt
 =ğ
NULL
)

814  
NULL
;

816 ià(
evt
->
s
 =ğ
NULL
)

817  
NULL
;

820 ià(
	`MSG_IS_REQUEST
(
evt
->
s
)) {

823 ià(
evt
->
s
->
c£q
 =ğ
NULL
 ||ƒvt->s->c£q->
m‘hod
 =ğNULL ||ƒvt->s->
s_m‘hod
 == NULL) {

824  
NULL
;

827 ià(0 !ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
,ƒvt->s->
s_m‘hod
)) {

828 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "core module: Discard invalid message with method!=cseq!\n"));

829  
NULL
;

833 ià(
	`MSG_IS_ACK
(
evt
->
s
))

834  
NULL
;

836 ià(
	`EVT_IS_INCOMINGREQ
(
evt
)) {

838 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE"))

839 
ùx_ty³
 = 
IST
;

842 
ùx_ty³
 = 
NIST
;

844 } ià(
	`EVT_IS_OUTGOINGREQ
(
evt
)) {

845 ià(0 =ğ
	`¡rcmp
(
evt
->
s
->
c£q
->
m‘hod
, "INVITE"))

846 
ùx_ty³
 = 
ICT
;

849 
ùx_ty³
 = 
NICT
;

852 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Cannot build‡ransaction forhis message!\n"));

853  
NULL
;

856 
i
 = 
	`os_Œª§ùiÚ_š™
(&
Œª§ùiÚ
, 
ùx_ty³
, 
os
, 
evt
->
s
);

858 ià(
i
 != 0) {

859  
NULL
;

862 
evt
->
Œª§ùiÚid
 = 
Œª§ùiÚ
->transactionid;

863  
Œª§ùiÚ
;

864 
	}
}

866 
os_Œª§ùiÚ_t
 *
	$os_Œª§ùiÚ_fšd
(
os_li¡_t
 *
Œª§ùiÚs
, 
os_ev’t_t
 *
evt
) {

867 
os_li¡_™”©Ü_t
 
™”©Ü
;

868 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

869 
os_t
 *
os
 = 
NULL
;

871 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(
Œª§ùiÚs
, &
™”©Ü
);

873 ià(
Œª§ùiÚ
 !ğ
NULL
)

874 
os
 = (
os_t
 *è
Œª§ùiÚ
->
cÚfig
;

876 ià(
os
 =ğ
NULL
)

877  
NULL
;

879 ià(
	`EVT_IS_INCOMINGREQ
(
evt
)) {

880 #ifdeà
HAVE_DICT_DICT_H


882 
os_g’”ic_·¿m_t
 *
b_»que¡
;

883 
os_vŸ_t
 *
tİvŸ_»que¡
;

885 
tİvŸ_»que¡
 = 
	`os_li¡_g‘
(&
evt
->
s
->
vŸs
, 0);

887 ià(
tİvŸ_»que¡
 =ğ
NULL
) {

888 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA is‚ot compliant: missing‡ Via header!\n"));

889  
NULL
;

892 
	`os_vŸ_·¿m_g‘_byÇme
(
tİvŸ_»que¡
, "b¿nch", &
b_»que¡
);

894 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

895 ià(
	`MSG_IS_INVITE
(
evt
->
s
è|| 
	`MSG_IS_ACK
(evt->sip)) {

896 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`diù_£¬ch
((
diù
 *è
os
->
os_i¡_ha¡abË
, 
b_»que¡
->
gv®ue
);

897 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for INVITE(ACK) REQUEST!\n"));

899 ià(
Œª§ùiÚ
 !ğ
NULL
)

900  
Œª§ùiÚ
;

903 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`diù_£¬ch
((
diù
 *è
os
->
os_ni¡_ha¡abË
, 
b_»que¡
->
gv®ue
);

904 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for NON-INVITE REQUEST!\n"));

906 ià(
Œª§ùiÚ
 !ğ
NULL
)

907  
Œª§ùiÚ
;

913 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(
Œª§ùiÚs
, &
™”©Ü
);

915 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

916 ià(0 =ğ
	`__os_Œª§ùiÚ_m©chšg_»que¡_os_to_xi¡_17_2_3
(
Œª§ùiÚ
, 
evt
->
s
))

917  
Œª§ùiÚ
;

919 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

922 } ià(
	`EVT_IS_INCOMINGRESP
(
evt
)) {

923 #ifdeà
HAVE_DICT_DICT_H


925 
os_g’”ic_·¿m_t
 *
b_»que¡
;

926 
os_vŸ_t
 *
tİvŸ_»que¡
;

928 
tİvŸ_»que¡
 = 
	`os_li¡_g‘
(&
evt
->
s
->
vŸs
, 0);

930 ià(
tİvŸ_»que¡
 =ğ
NULL
) {

931 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA is‚ot compliant: missing‡ Via header!\n"));

932  
NULL
;

935 
	`os_vŸ_·¿m_g‘_byÇme
(
tİvŸ_»que¡
, "b¿nch", &
b_»que¡
);

937 ià(
b_»que¡
 !ğ
NULL
 && b_»que¡->
gv®ue
 != NULL) {

938 ià(
	`MSG_IS_RESPONSE_FOR
(
evt
->
s
, "INVITE")) {

939 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`diù_£¬ch
((
diù
 *è
os
->
os_iù_ha¡abË
, 
b_»que¡
->
gv®ue
);

940 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for INVITE ANSWER!\n"));

942 ià(
Œª§ùiÚ
 !ğ
NULL
)

943  
Œª§ùiÚ
;

946 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`diù_£¬ch
((
diù
 *è
os
->
os_niù_ha¡abË
, 
b_»que¡
->
gv®ue
);

947 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "Find matching Via header for NON-INVITE ANSWER!\n"));

949 ià(
Œª§ùiÚ
 !ğ
NULL
)

950  
Œª§ùiÚ
;

956 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(
Œª§ùiÚs
, &
™”©Ü
);

958 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

959 ià(0 =ğ
	`__os_Œª§ùiÚ_m©chšg_»¥Ú£_os_to_xiù_17_1_3
(
Œª§ùiÚ
, 
evt
->
s
))

960  
Œª§ùiÚ
;

962 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

967 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(
Œª§ùiÚs
, &
™”©Ü
);

969 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

970 ià(
Œª§ùiÚ
->
Œª§ùiÚid
 =ğ
evt
->transactionid)

971  
Œª§ùiÚ
;

973 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

977  
NULL
;

978 
	}
}

980 
	$os_š™
(
os_t
 **
os
) {

981 
»f_couÁ
 = 0;

983 ià(
»f_couÁ
 == 0) {

984 
»f_couÁ
++;

986 
	`·r£r_š™
();

989 *
os
 = (
os_t
 *è
	`os_m®loc
((osip_t));

991 ià(*
os
 =ğ
NULL
)

992  
OSIP_NOMEM
;

994 
	`mem£t
(*
os
, 0, (
os_t
));

996 #iâdeà
OSIP_MONOTHREAD


997 (*
os
)->
iù_ç¡mu‹x
 = 
	`os_mu‹x_š™
();

998 (*
os
)->
i¡_ç¡mu‹x
 = 
	`os_mu‹x_š™
();

999 (*
os
)->
niù_ç¡mu‹x
 = 
	`os_mu‹x_š™
();

1000 (*
os
)->
ni¡_ç¡mu‹x
 = 
	`os_mu‹x_š™
();

1002 (*
os
)->
ixt_ç¡mu‹x
 = 
	`os_mu‹x_š™
();

1003 (*
os
)->
id_mu‹x
 = 
	`os_mu‹x_š™
();

1006 
	`os_li¡_š™
(&(*
os
)->
os_iù_Œª§ùiÚs
);

1007 
	`os_li¡_š™
(&(*
os
)->
os_i¡_Œª§ùiÚs
);

1008 
	`os_li¡_š™
(&(*
os
)->
os_niù_Œª§ùiÚs
);

1009 
	`os_li¡_š™
(&(*
os
)->
os_ni¡_Œª§ùiÚs
);

1010 
	`os_li¡_š™
(&(*
os
)->
ixt_»ŒªsmissiÚs
);

1012 (*
os
)->
Œª§ùiÚid
 = 1;

1014 #ià
	`defšed
(
HAVE_DICT_DICT_H
)

1015 (*
os
)->
os_iù_ha¡abË
 = (
diù
 *è
	`hashbË_diù_Ãw
((
diù_cmp_func
è
¡rcmp
, (
diù_hsh_func
è
s_hash
, 
NULL
, NULL, 
HSIZE
);

1016 (*
os
)->
os_i¡_ha¡abË
 = (
diù
 *è
	`hashbË_diù_Ãw
((
diù_cmp_func
è
¡rcmp
, (
diù_hsh_func
è
s_hash
, 
NULL
, NULL, 
HSIZE
);

1017 (*
os
)->
os_niù_ha¡abË
 = (
diù
 *è
	`hashbË_diù_Ãw
((
diù_cmp_func
è
¡rcmp
, (
diù_hsh_func
è
s_hash
, 
NULL
, NULL, 
HSIZE
);

1018 (*
os
)->
os_ni¡_ha¡abË
 = (
diù
 *è
	`hashbË_diù_Ãw
((
diù_cmp_func
è
¡rcmp
, (
diù_hsh_func
è
s_hash
, 
NULL
, NULL, 
HSIZE
);

1021  
OSIP_SUCCESS
;

1022 
	}
}

1024 
	$os_»Ëa£
(
os_t
 *
os
) {

1025 #iâdeà
OSIP_MONOTHREAD


1026 
	`os_mu‹x_de¡roy
(
os
->
iù_ç¡mu‹x
);

1027 
	`os_mu‹x_de¡roy
(
os
->
i¡_ç¡mu‹x
);

1028 
	`os_mu‹x_de¡roy
(
os
->
niù_ç¡mu‹x
);

1029 
	`os_mu‹x_de¡roy
(
os
->
ni¡_ç¡mu‹x
);

1031 
	`os_mu‹x_de¡roy
(
os
->
ixt_ç¡mu‹x
);

1032 
	`os_mu‹x_de¡roy
(
os
->
id_mu‹x
);

1035 
	`os_ä“
(
os
);

1036 
	}
}

1038 
	$os_£t_­¶iÿtiÚ_cÚ‹xt
(
os_t
 *
os
, *
poš‹r
) {

1039 
os
->
­¶iÿtiÚ_cÚ‹xt
 = 
poš‹r
;

1040 
	}
}

1042 *
	$os_g‘_­¶iÿtiÚ_cÚ‹xt
(
os_t
 *
os
) {

1043 ià(
os
 =ğ
NULL
)

1044  
NULL
;

1046  
os
->
­¶iÿtiÚ_cÚ‹xt
;

1047 
	}
}

1049 
	$os_iù_execu‹
(
os_t
 *
os
) {

1050 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

1051 
os_ev’t_t
 *
£
;

1052 
mÜe_ev’t
;

1053 
os_li¡_™”©Ü_t
 
™”©Ü
;

1054 **
¬¿y
;

1055 
Ën
;

1056 
šdex
 = 0;

1059 #iâdeà
OSIP_MONOTHREAD


1060 
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

1062 
Ën
 = 
	`os_li¡_size
(&
os
->
os_iù_Œª§ùiÚs
);

1064 ià(0 >ğ
Ën
) {

1065 #iâdeà
OSIP_MONOTHREAD


1066 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1068  
OSIP_SUCCESS
;

1071 
¬¿y
 = 
	`os_m®loc
((*è* 
Ën
);

1073 ià(
¬¿y
 =ğ
NULL
) {

1074 #iâdeà
OSIP_MONOTHREAD


1075 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1077  
OSIP_NOMEM
;

1080 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_iù_Œª§ùiÚs
, &
™”©Ü
);

1082 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1083 
¬¿y
[
šdex
++] = 
Œª§ùiÚ
;

1084 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1087 #iâdeà
OSIP_MONOTHREAD


1088 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1091 
šdex
 = 0; index < 
Ën
; ++index) {

1092 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
¬¿y
[
šdex
];

1093 
mÜe_ev’t
 = 1;

1096 
£
 = (
os_ev’t_t
 *è
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

1098 ià(
£
 =ğ
NULL
)

1099 
mÜe_ev’t
 = 0;

1102 
	`os_Œª§ùiÚ_execu‹
(
Œª§ùiÚ
, 
£
);

1103 } 
mÜe_ev’t
 == 1);

1106 
	`os_ä“
(
¬¿y
);

1108  
OSIP_SUCCESS
;

1109 
	}
}

1111 
	$os_i¡_execu‹
(
os_t
 *
os
) {

1112 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

1113 
os_ev’t_t
 *
£
;

1114 
mÜe_ev’t
;

1115 
os_li¡_™”©Ü_t
 
™”©Ü
;

1116 **
¬¿y
;

1117 
Ën
;

1118 
šdex
 = 0;

1121 #iâdeà
OSIP_MONOTHREAD


1122 
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

1124 
Ën
 = 
	`os_li¡_size
(&
os
->
os_i¡_Œª§ùiÚs
);

1126 ià(0 >ğ
Ën
) {

1127 #iâdeà
OSIP_MONOTHREAD


1128 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1130  
OSIP_SUCCESS
;

1133 
¬¿y
 = 
	`os_m®loc
((*è* 
Ën
);

1135 ià(
¬¿y
 =ğ
NULL
) {

1136 #iâdeà
OSIP_MONOTHREAD


1137 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1139  
OSIP_NOMEM
;

1142 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_i¡_Œª§ùiÚs
, &
™”©Ü
);

1144 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1145 
¬¿y
[
šdex
++] = 
Œª§ùiÚ
;

1146 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1149 #iâdeà
OSIP_MONOTHREAD


1150 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1153 
šdex
 = 0; index < 
Ën
; ++index) {

1154 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
¬¿y
[
šdex
];

1155 
mÜe_ev’t
 = 1;

1158 
£
 = (
os_ev’t_t
 *è
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

1160 ià(
£
 =ğ
NULL
)

1161 
mÜe_ev’t
 = 0;

1164 
	`os_Œª§ùiÚ_execu‹
(
Œª§ùiÚ
, 
£
);

1165 } 
mÜe_ev’t
 == 1);

1168 
	`os_ä“
(
¬¿y
);

1170  
OSIP_SUCCESS
;

1171 
	}
}

1173 
	$os_niù_execu‹
(
os_t
 *
os
) {

1174 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

1175 
os_ev’t_t
 *
£
;

1176 
mÜe_ev’t
;

1177 
os_li¡_™”©Ü_t
 
™”©Ü
;

1178 **
¬¿y
;

1179 
Ën
;

1180 
šdex
 = 0;

1183 #iâdeà
OSIP_MONOTHREAD


1184 
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

1186 
Ën
 = 
	`os_li¡_size
(&
os
->
os_niù_Œª§ùiÚs
);

1188 ià(0 >ğ
Ën
) {

1189 #iâdeà
OSIP_MONOTHREAD


1190 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1192  
OSIP_SUCCESS
;

1195 
¬¿y
 = 
	`os_m®loc
((*è* 
Ën
);

1197 ià(
¬¿y
 =ğ
NULL
) {

1198 #iâdeà
OSIP_MONOTHREAD


1199 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1201  
OSIP_NOMEM
;

1204 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_niù_Œª§ùiÚs
, &
™”©Ü
);

1206 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1207 
¬¿y
[
šdex
++] = 
Œª§ùiÚ
;

1208 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1211 #iâdeà
OSIP_MONOTHREAD


1212 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1215 
šdex
 = 0; index < 
Ën
; ++index) {

1216 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
¬¿y
[
šdex
];

1217 
mÜe_ev’t
 = 1;

1220 
£
 = (
os_ev’t_t
 *è
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

1222 ià(
£
 =ğ
NULL
)

1223 
mÜe_ev’t
 = 0;

1226 
	`os_Œª§ùiÚ_execu‹
(
Œª§ùiÚ
, 
£
);

1227 } 
mÜe_ev’t
 == 1);

1230 
	`os_ä“
(
¬¿y
);

1232  
OSIP_SUCCESS
;

1233 
	}
}

1235 
	$os_ni¡_execu‹
(
os_t
 *
os
) {

1236 
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
;

1237 
os_ev’t_t
 *
£
;

1238 
mÜe_ev’t
;

1239 
os_li¡_™”©Ü_t
 
™”©Ü
;

1240 **
¬¿y
;

1241 
Ën
;

1242 
šdex
 = 0;

1245 #iâdeà
OSIP_MONOTHREAD


1246 
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

1248 
Ën
 = 
	`os_li¡_size
(&
os
->
os_ni¡_Œª§ùiÚs
);

1250 ià(0 >ğ
Ën
) {

1251 #iâdeà
OSIP_MONOTHREAD


1252 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1254  
OSIP_SUCCESS
;

1257 
¬¿y
 = 
	`os_m®loc
((*è* 
Ën
);

1259 ià(
¬¿y
 =ğ
NULL
) {

1260 #iâdeà
OSIP_MONOTHREAD


1261 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1263  
OSIP_NOMEM
;

1266 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_ni¡_Œª§ùiÚs
, &
™”©Ü
);

1268 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1269 
¬¿y
[
šdex
++] = 
Œª§ùiÚ
;

1270 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1273 #iâdeà
OSIP_MONOTHREAD


1274 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1277 
šdex
 = 0; index < 
Ën
; ++index) {

1278 
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
¬¿y
[
šdex
];

1279 
mÜe_ev’t
 = 1;

1282 
£
 = (
os_ev’t_t
 *è
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

1284 ià(
£
 =ğ
NULL
)

1285 
mÜe_ev’t
 = 0;

1288 
	`os_Œª§ùiÚ_execu‹
(
Œª§ùiÚ
, 
£
);

1289 } 
mÜe_ev’t
 == 1);

1292 
	`os_ä“
(
¬¿y
);

1294  
OSIP_SUCCESS
;

1295 
	}
}

1297 
	$os_tim”s_g‘timeout
(
os_t
 *
os
, 
timev®
 *
low”_tv
) {

1298 
timev®
 
now
;

1299 
os_Œª§ùiÚ_t
 *
Œ
;

1300 
os_li¡_™”©Ü_t
 
™”©Ü
;

1302 
	`os_g‘timeofday
(&
now
, 
NULL
);

1303 
low”_tv
->
tv_£c
 = 
now
.tv_sec + 3600 * 24 * 365;

1304 
low”_tv
->
tv_u£c
 = 
now
.tv_usec;

1306 #iâdeà
OSIP_MONOTHREAD


1307 
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

1310 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_iù_Œª§ùiÚs
, &
™”©Ü
);

1312 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1313 ià(1 <ğ
	`os_fifo_size
(
Œ
->
Œª§ùiÚff
)) {

1314 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "1 Pendingƒvent‡lready inransaction !\n"));

1315 
low”_tv
->
tv_£c
 = 0;

1316 
low”_tv
->
tv_u£c
 = 0;

1317 #iâdeà
OSIP_MONOTHREAD


1318 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1323 ià(
Œ
->
¡©e
 =ğ
ICT_CALLING
)

1324 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
iù_cÚ‹xt
->
tim”_b_¡¬t
);

1326 ià(
Œ
->
¡©e
 =ğ
ICT_CALLING
)

1327 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
iù_cÚ‹xt
->
tim”_a_¡¬t
);

1329 ià(
Œ
->
¡©e
 =ğ
ICT_COMPLETED
)

1330 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
iù_cÚ‹xt
->
tim”_d_¡¬t
);

1332 ià(
	`os_tim”cmp
(&
now
, 
low”_tv
, >=)) {

1333 
low”_tv
->
tv_£c
 = 0;

1334 
low”_tv
->
tv_u£c
 = 0;

1335 #iâdeà
OSIP_MONOTHREAD


1336 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1342 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1345 #iâdeà
OSIP_MONOTHREAD


1346 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1349 #iâdeà
OSIP_MONOTHREAD


1350 
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

1353 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_i¡_Œª§ùiÚs
, &
™”©Ü
);

1355 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1356 ià(
Œ
->
¡©e
 =ğ
IST_CONFIRMED
)

1357 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
i¡_cÚ‹xt
->
tim”_i_¡¬t
);

1359 ià(
Œ
->
¡©e
 =ğ
IST_COMPLETED
)

1360 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
i¡_cÚ‹xt
->
tim”_h_¡¬t
);

1362 ià(
Œ
->
¡©e
 =ğ
IST_COMPLETED
)

1363 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
i¡_cÚ‹xt
->
tim”_g_¡¬t
);

1365 ià(
	`os_tim”cmp
(&
now
, 
low”_tv
, >=)) {

1366 
low”_tv
->
tv_£c
 = 0;

1367 
low”_tv
->
tv_u£c
 = 0;

1368 #iâdeà
OSIP_MONOTHREAD


1369 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1374 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1377 #iâdeà
OSIP_MONOTHREAD


1378 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1381 #iâdeà
OSIP_MONOTHREAD


1382 
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

1385 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_niù_Œª§ùiÚs
, &
™”©Ü
);

1387 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1388 ià(
Œ
->
¡©e
 =ğ
NICT_COMPLETED
)

1389 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
niù_cÚ‹xt
->
tim”_k_¡¬t
);

1391 ià(
Œ
->
¡©e
 =ğ
NICT_PROCEEDING
 ||r->¡©=ğ
NICT_TRYING
)

1392 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
niù_cÚ‹xt
->
tim”_f_¡¬t
);

1394 ià(
Œ
->
¡©e
 =ğ
NICT_PROCEEDING
 ||r->¡©=ğ
NICT_TRYING
)

1395 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
niù_cÚ‹xt
->
tim”_e_¡¬t
);

1397 ià(
	`os_tim”cmp
(&
now
, 
low”_tv
, >=)) {

1398 
low”_tv
->
tv_£c
 = 0;

1399 
low”_tv
->
tv_u£c
 = 0;

1400 #iâdeà
OSIP_MONOTHREAD


1401 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1406 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1409 #iâdeà
OSIP_MONOTHREAD


1410 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1413 #iâdeà
OSIP_MONOTHREAD


1414 
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

1417 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_ni¡_Œª§ùiÚs
, &
™”©Ü
);

1419 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1420 ià(
Œ
->
¡©e
 =ğ
NIST_COMPLETED
)

1421 
	`mš_tim”cmp
(
low”_tv
, &
Œ
->
ni¡_cÚ‹xt
->
tim”_j_¡¬t
);

1423 ià(
	`os_tim”cmp
(&
now
, 
low”_tv
, >=)) {

1424 
low”_tv
->
tv_£c
 = 0;

1425 
low”_tv
->
tv_u£c
 = 0;

1426 #iâdeà
OSIP_MONOTHREAD


1427 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1432 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1435 #iâdeà
OSIP_MONOTHREAD


1436 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1439 #iâdeà
OSIP_MONOTHREAD


1440 
	`os_mu‹x_lock
(
os
->
ixt_ç¡mu‹x
);

1443 
ixt_t
 *
ixt
;

1445 
ixt
 = (
ixt_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
ixt_»ŒªsmissiÚs
, &
™”©Ü
);

1447 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1448 
	`mš_tim”cmp
(
low”_tv
, &
ixt
->
¡¬t
);

1450 ià(
	`os_tim”cmp
(&
now
, 
low”_tv
, >=)) {

1451 
low”_tv
->
tv_£c
 = 0;

1452 
low”_tv
->
tv_u£c
 = 0;

1453 #iâdeà
OSIP_MONOTHREAD


1454 
	`os_mu‹x_uÆock
(
os
->
ixt_ç¡mu‹x
);

1459 
ixt
 = (
ixt_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1462 #iâdeà
OSIP_MONOTHREAD


1463 
	`os_mu‹x_uÆock
(
os
->
ixt_ç¡mu‹x
);

1466 
low”_tv
->
tv_£c
 =†ow”_tv->tv_£ø- 
now
.tv_sec;

1467 
low”_tv
->
tv_u£c
 =†ow”_tv->tv_u£ø- 
now
.tv_usec;

1470 ià(
low”_tv
->
tv_u£c
 < 0) {

1471 
low”_tv
->
tv_u£c
 =†ower_tv->tv_usec + 1000000;

1472 
low”_tv
->
tv_£c
--;

1475 ià(
low”_tv
->
tv_£c
 < 0) {

1476 
low”_tv
->
tv_£c
 = 0;

1477 
low”_tv
->
tv_u£c
 = 0;

1480 ià(
low”_tv
->
tv_u£c
 > 1000000) {

1481 
low”_tv
->
tv_u£c
 =†ower_tv->tv_usec - 1000000;

1482 
low”_tv
->
tv_£c
++;

1486 
	}
}

1488 
	$os_tim”s_iù_execu‹
(
os_t
 *
os
) {

1489 
os_Œª§ùiÚ_t
 *
Œ
;

1490 
os_li¡_™”©Ü_t
 
™”©Ü
;

1492 #iâdeà
OSIP_MONOTHREAD


1493 
	`os_mu‹x_lock
(
os
->
iù_ç¡mu‹x
);

1496 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_iù_Œª§ùiÚs
, &
™”©Ü
);

1498 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1499 
os_ev’t_t
 *
evt
;

1501 ià(1 <ğ
	`os_fifo_size
(
Œ
->
Œª§ùiÚff
)) {

1502 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "1 Pendingƒvent‡lready inransaction !\n"));

1505 
evt
 = 
	`__os_iù_Ãed_tim”_b_ev’t
(
Œ
->
iù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1507 ià(
evt
 !ğ
NULL
)

1508 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1511 
evt
 = 
	`__os_iù_Ãed_tim”_a_ev’t
(
Œ
->
iù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1513 ià(
evt
 !ğ
NULL
)

1514 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1517 
evt
 = 
	`__os_iù_Ãed_tim”_d_ev’t
(
Œ
->
iù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1519 ià(
evt
 !ğ
NULL
)

1520 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1525 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1528 #iâdeà
OSIP_MONOTHREAD


1529 
	`os_mu‹x_uÆock
(
os
->
iù_ç¡mu‹x
);

1531 
	}
}

1533 
	$os_tim”s_i¡_execu‹
(
os_t
 *
os
) {

1534 
os_Œª§ùiÚ_t
 *
Œ
;

1535 
os_li¡_™”©Ü_t
 
™”©Ü
;

1537 #iâdeà
OSIP_MONOTHREAD


1538 
	`os_mu‹x_lock
(
os
->
i¡_ç¡mu‹x
);

1541 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_i¡_Œª§ùiÚs
, &
™”©Ü
);

1543 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1544 
os_ev’t_t
 *
evt
;

1546 
evt
 = 
	`__os_i¡_Ãed_tim”_i_ev’t
(
Œ
->
i¡_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1548 ià(
evt
 !ğ
NULL
)

1549 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1552 
evt
 = 
	`__os_i¡_Ãed_tim”_h_ev’t
(
Œ
->
i¡_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1554 ià(
evt
 !ğ
NULL
)

1555 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1558 
evt
 = 
	`__os_i¡_Ãed_tim”_g_ev’t
(
Œ
->
i¡_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1560 ià(
evt
 !ğ
NULL
)

1561 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1565 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1568 #iâdeà
OSIP_MONOTHREAD


1569 
	`os_mu‹x_uÆock
(
os
->
i¡_ç¡mu‹x
);

1571 
	}
}

1573 
	$os_tim”s_niù_execu‹
(
os_t
 *
os
) {

1574 
os_Œª§ùiÚ_t
 *
Œ
;

1575 
os_li¡_™”©Ü_t
 
™”©Ü
;

1577 #iâdeà
OSIP_MONOTHREAD


1578 
	`os_mu‹x_lock
(
os
->
niù_ç¡mu‹x
);

1581 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_niù_Œª§ùiÚs
, &
™”©Ü
);

1583 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1584 
os_ev’t_t
 *
evt
;

1586 
evt
 = 
	`__os_niù_Ãed_tim”_k_ev’t
(
Œ
->
niù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1588 ià(
evt
 !ğ
NULL
)

1589 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1592 
evt
 = 
	`__os_niù_Ãed_tim”_f_ev’t
(
Œ
->
niù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1594 ià(
evt
 !ğ
NULL
)

1595 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1598 
evt
 = 
	`__os_niù_Ãed_tim”_e_ev’t
(
Œ
->
niù_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1600 ià(
evt
 !ğ
NULL
)

1601 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1605 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1608 #iâdeà
OSIP_MONOTHREAD


1609 
	`os_mu‹x_uÆock
(
os
->
niù_ç¡mu‹x
);

1611 
	}
}

1613 
	$os_tim”s_ni¡_execu‹
(
os_t
 *
os
) {

1614 
os_Œª§ùiÚ_t
 *
Œ
;

1615 
os_li¡_™”©Ü_t
 
™”©Ü
;

1617 #iâdeà
OSIP_MONOTHREAD


1618 
	`os_mu‹x_lock
(
os
->
ni¡_ç¡mu‹x
);

1621 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_fœ¡
(&
os
->
os_ni¡_Œª§ùiÚs
, &
™”©Ü
);

1623 
	`os_li¡_™”©Ü_has_–em
(
™”©Ü
)) {

1624 
os_ev’t_t
 *
evt
;

1626 
evt
 = 
	`__os_ni¡_Ãed_tim”_j_ev’t
(
Œ
->
ni¡_cÚ‹xt
,r->
¡©e
,r->
Œª§ùiÚid
);

1628 ià(
evt
 !ğ
NULL
)

1629 
	`os_fifo_add
(
Œ
->
Œª§ùiÚff
, 
evt
);

1631 
Œ
 = (
os_Œª§ùiÚ_t
 *è
	`os_li¡_g‘_Ãxt
(&
™”©Ü
);

1634 #iâdeà
OSIP_MONOTHREAD


1635 
	`os_mu‹x_uÆock
(
os
->
ni¡_ç¡mu‹x
);

1637 
	}
}

1639 
	$os_£t_cb_£nd_mes§ge
(
os_t
 *
cf
, (*
cb
)(
os_Œª§ùiÚ_t
 *, 
os_mes§ge_t
 *, *, , )) {

1640 
cf
->
cb_£nd_mes§ge
 = 
cb
;

1641 
	}
}

1643 
	$__os_mes§ge_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
msg
) {

1644 
os_t
 *
cÚfig
 = 
Œ
->config;

1646 ià(
ty³
 >ğ
OSIP_MESSAGE_CALLBACK_COUNT
) {

1647 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1651 ià(
cÚfig
->
msg_ÿÎbacks
[
ty³
] =ğ
NULL
)

1654 
cÚfig
->
msg_ÿÎbacks
[
ty³
]Ñy³, 
Œ
, 
msg
);

1655 
	}
}

1657 
	$__os_kl_Œª§ùiÚ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *
Œ
) {

1658 
os_t
 *
cÚfig
 = 
Œ
->config;

1660 ià(
ty³
 >ğ
OSIP_KILL_CALLBACK_COUNT
) {

1661 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1665 
Œ
->
com¶‘ed_time
 = 
	`os_g‘sy¡emtime
(
NULL
);

1666 
	`os_g‘timeofday
(&
Œ
->
de¡royed_time
, 
NULL
);

1668 ià(
cÚfig
->
kl_ÿÎbacks
[
ty³
] =ğ
NULL
)

1671 
cÚfig
->
kl_ÿÎbacks
[
ty³
]Ñy³, 
Œ
);

1672 
	}
}

1674 
	$__os_Œª¥Üt_”rÜ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *
Œ
, 
”rÜ
) {

1675 
os_t
 *
cÚfig
 = 
Œ
->config;

1677 ià(
ty³
 >ğ
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
) {

1678 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1682 ià(
cÚfig
->
_”rÜ_ÿÎbacks
[
ty³
] =ğ
NULL
)

1685 
cÚfig
->
_”rÜ_ÿÎbacks
[
ty³
]Ñy³, 
Œ
, 
”rÜ
);

1686 
	}
}

1688 
	$os_£t_mes§ge_ÿÎback
(
os_t
 *
cÚfig
, 
ty³
, 
os_mes§ge_cb_t
 
cb
) {

1689 ià(
ty³
 >ğ
OSIP_MESSAGE_CALLBACK_COUNT
) {

1690 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1691  
OSIP_BADPARAMETER
;

1694 
cÚfig
->
msg_ÿÎbacks
[
ty³
] = 
cb
;

1696  
OSIP_SUCCESS
;

1697 
	}
}

1699 
	$os_£t_kl_Œª§ùiÚ_ÿÎback
(
os_t
 *
cÚfig
, 
ty³
, 
os_kl_Œª§ùiÚ_cb_t
 
cb
) {

1700 ià(
ty³
 >ğ
OSIP_KILL_CALLBACK_COUNT
) {

1701 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1702  
OSIP_BADPARAMETER
;

1705 
cÚfig
->
kl_ÿÎbacks
[
ty³
] = 
cb
;

1706  
OSIP_SUCCESS
;

1707 
	}
}

1709 
	$os_£t_Œª¥Üt_”rÜ_ÿÎback
(
os_t
 *
cÚfig
, 
ty³
, 
os_Œª¥Üt_”rÜ_cb_t
 
cb
) {

1710 ià(
ty³
 >ğ
OSIP_TRANSPORT_ERROR_CALLBACK_COUNT
) {

1711 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "šv®id c®lbacky³ %d\n", 
ty³
));

1712  
OSIP_BADPARAMETER
;

1715 
cÚfig
->
_”rÜ_ÿÎbacks
[
ty³
] = 
cb
;

1716  
OSIP_SUCCESS
;

1717 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_dialog.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~<os2/os_dŸlog.h
>

26 
	$os_dŸlog_£t_¡©e
(
os_dŸlog_t
 *
dŸlog
, 
¡©e_t
 
¡©e
) {

27 ià(
dŸlog
 =ğ
NULL
)

30 
dŸlog
->
¡©e
 = state;

31 
	}
}

33 
	$os_dŸlog_upd©e_rou‹_£t_as_uas
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
šv™e
) {

34 
os_cÚù_t
 *
cÚù
;

35 
i
;

37 ià(
dŸlog
 =ğ
NULL
)

38  
OSIP_BADPARAMETER
;

40 ià(
šv™e
 =ğ
NULL
)

41  
OSIP_BADPARAMETER
;

43 ià(
	`os_li¡_eŞ
(&
šv™e
->
cÚùs
, 0)) {

44 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "missing‡ contact in invite!\n"));

47 ià(
dŸlog
->
»mÙe_cÚù_uri
 !ğ
NULL
) {

48 
	`os_cÚù_ä“
(
dŸlog
->
»mÙe_cÚù_uri
);

51 
dŸlog
->
»mÙe_cÚù_uri
 = 
NULL
;

52 
cÚù
 = 
	`os_li¡_g‘
(&
šv™e
->
cÚùs
, 0);

53 
i
 = 
	`os_cÚù_şÚe
(
cÚù
, &(
dŸlog
->
»mÙe_cÚù_uri
));

55 ià(
i
 != 0)

56  
i
;

59  
OSIP_SUCCESS
;

60 
	}
}

62 
	$os_dŸlog_upd©e_os_c£q_as_uas
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
šv™e
) {

63 ià(
dŸlog
 =ğ
NULL
)

64  
OSIP_BADPARAMETER
;

66 ià(
šv™e
 =ğ
NULL
 || inv™e->
c£q
 =ğNULL || inv™e->c£q->
numb”
 == NULL)

67  
OSIP_BADPARAMETER
;

69 
dŸlog
->
»mÙe_c£q
 = 
	`os_©oi
(
šv™e
->
c£q
->
numb”
);

70  
OSIP_SUCCESS
;

71 
	}
}

73 
	$os_dŸlog_upd©e_rou‹_£t_as_uac
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
) {

75 
os_cÚù_t
 *
cÚù
;

76 
i
;

78 ià(
dŸlog
 =ğ
NULL
)

79  
OSIP_BADPARAMETER
;

81 ià(
»¥Ú£
 =ğ
NULL
)

82  
OSIP_BADPARAMETER
;

84 ià(
	`os_li¡_eŞ
(&
»¥Ú£
->
cÚùs
, 0)) {

85 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "missing‡ contact in„esponse!\n"));

90 ià(
dŸlog
->
»mÙe_cÚù_uri
 !ğ
NULL
) {

91 
	`os_cÚù_ä“
(
dŸlog
->
»mÙe_cÚù_uri
);

94 
dŸlog
->
»mÙe_cÚù_uri
 = 
NULL
;

95 
cÚù
 = 
	`os_li¡_g‘
(&
»¥Ú£
->
cÚùs
, 0);

96 
i
 = 
	`os_cÚù_şÚe
(
cÚù
, &(
dŸlog
->
»mÙe_cÚù_uri
));

98 ià(
i
 != 0)

99  
i
;

102 ià(
dŸlog
->
¡©e
 =ğ
DIALOG_EARLY
 && 
	`os_li¡_size
(&dŸlog->
rou‹_£t
) > 0) {

103 
	`os_li¡_¥ecŸl_ä“
(&
dŸlog
->
rou‹_£t
, ((*)(*)è& 
os_»cÜd_rou‹_ä“
);

104 
	`os_li¡_š™
(&
dŸlog
->
rou‹_£t
);

107 ià(
dŸlog
->
¡©e
 =ğ
DIALOG_EARLY
 && 
	`os_li¡_size
(&dŸlog->
rou‹_£t
) == 0) {

108 
pos
 = 0;

110 !
	`os_li¡_eŞ
(&
»¥Ú£
->
»cÜd_rou‹s
, 
pos
)) {

111 
os_»cÜd_rou‹_t
 *
¼
;

112 
os_»cÜd_rou‹_t
 *
¼2
;

114 
¼
 = (
os_»cÜd_rou‹_t
 *è
	`os_li¡_g‘
(&
»¥Ú£
->
»cÜd_rou‹s
, 
pos
);

115 
i
 = 
	`os_»cÜd_rou‹_şÚe
(
¼
, &
¼2
);

117 ià(
i
 != 0)

118  
i
;

120 
	`os_li¡_add
(&
dŸlog
->
rou‹_£t
, 
¼2
, 0);

121 
pos
++;

125 ià(
	`MSG_IS_STATUS_2XX
(
»¥Ú£
))

126 
dŸlog
->
¡©e
 = 
DIALOG_CONFIRMED
;

128  
OSIP_SUCCESS
;

129 
	}
}

131 
	$os_dŸlog_upd©e_g_as_uac
(
os_dŸlog_t
 *
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
) {

132 
os_g’”ic_·¿m_t
 *
g
;

133 
i
;

135 ià(
dŸlog
 =ğ
NULL
)

136  
OSIP_BADPARAMETER
;

138 ià(
»¥Ú£
 =ğ
NULL
 ||„e¥Ú£->
to
 == NULL)

139  
OSIP_BADPARAMETER
;

141 ià(
dŸlog
->
»mÙe_g
 !ğ
NULL
) {

142 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "This dialog‡lready have‡„emoteag: it can't be changed!\n"));

143  
OSIP_WRONG_STATE
;

146 
i
 = 
	`os_to_g‘_g
(
»¥Ú£
->
to
, &
g
);

148 ià(
i
 !ğ0 || 
g
 =ğ
NULL
 ||ag->
gv®ue
 == NULL) {

149 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA is‚ot compliant: missing‡ag in„esponse!\n"));

150 
dŸlog
->
»mÙe_g
 = 
NULL
;

153 
dŸlog
->
»mÙe_g
 = 
	`os_¡rdup
(
g
->
gv®ue
);

155  
OSIP_SUCCESS
;

156 
	}
}

158 
	$os_dŸlog_m©ch_as_uac
(
os_dŸlog_t
 *
dlg
, 
os_mes§ge_t
 *
ªsw”
) {

159 
os_g’”ic_·¿m_t
 *
g_·¿m_loÿl
;

160 
os_g’”ic_·¿m_t
 *
g_·¿m_»mÙe
;

161 *
tmp
;

162 
i
;

164 ià(
dlg
 =ğ
NULL
 || dlg->
ÿÎ_id
 == NULL)

165  
OSIP_BADPARAMETER
;

167 ià(
ªsw”
 =ğ
NULL
 ||‡nsw”->
ÿÎ_id
 =ğNULL ||‡nsw”->
äom
 =ğNULL ||‡nsw”->
to
 == NULL)

168  
OSIP_BADPARAMETER
;

170 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Usinghis method is discouraged. See source codeƒxplanations!\n"));

183 
i
 = 
	`os_ÿÎ_id_to_¡r
(
ªsw”
->
ÿÎ_id
, &
tmp
);

185 ià(
i
 != 0)

186  
i
;

188 ià(0 !ğ
	`¡rcmp
(
dlg
->
ÿÎ_id
, 
tmp
)) {

189 
	`os_ä“
(
tmp
);

190  
OSIP_UNDEFINED_ERROR
;

193 
	`os_ä“
(
tmp
);

199 
i
 = 
	`os_äom_g‘_g
(
ªsw”
->
äom
, &
g_·¿m_loÿl
);

201 ià(
i
 != 0)

202  
OSIP_SYNTAXERROR
;

204 ià(
dlg
->
loÿl_g
 =ğ
NULL
)

206  
OSIP_SYNTAXERROR
;

208 ià(0 !ğ
	`¡rcmp
(
g_·¿m_loÿl
->
gv®ue
, 
dlg
->
loÿl_g
))

209  
OSIP_UNDEFINED_ERROR
;

211 
i
 = 
	`os_to_g‘_g
(
ªsw”
->
to
, &
g_·¿m_»mÙe
);

213 ià(
i
 !ğ0 && 
dlg
->
»mÙe_g
 !ğ
NULL
)

214  
OSIP_SYNTAXERROR
;

216 ià(
i
 !ğ0 && 
dlg
->
»mÙe_g
 =ğ
NULL
) {

217 ià(0 =ğ
	`os_äom_com·»
((
os_äom_t
 *è
dlg
->
loÿl_uri
, (os_äom_ˆ*è
ªsw”
->
äom
è&& 0 =ğos_äom_com·»(dlg->
»mÙe_uri
,‡nsw”->
to
))

218  
OSIP_SUCCESS
;

220  
OSIP_UNDEFINED_ERROR
;

223 ià(
dlg
->
»mÙe_g
 =ğ
NULL
) {

224 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA is‚ot compliant: missing‡ag in To fields!\n"));

226 ià(0 =ğ
	`os_äom_com·»
((
os_äom_t
 *è
dlg
->
loÿl_uri
, (os_äom_ˆ*è
ªsw”
->
äom
è&& 0 =ğos_äom_com·»(dlg->
»mÙe_uri
,‡nsw”->
to
))

227  
OSIP_SUCCESS
;

229  
OSIP_UNDEFINED_ERROR
;

236 ià(0 =ğ
	`¡rcmp
(
g_·¿m_»mÙe
->
gv®ue
, 
dlg
->
»mÙe_g
))

237  
OSIP_SUCCESS
;

239  
OSIP_UNDEFINED_ERROR
;

240 
	}
}

242 
	$os_dŸlog_m©ch_as_uas
(
os_dŸlog_t
 *
dlg
, 
os_mes§ge_t
 *
»que¡
) {

243 
os_g’”ic_·¿m_t
 *
g_·¿m_»mÙe
;

244 
i
;

245 *
tmp
;

247 ià(
dlg
 =ğ
NULL
 || dlg->
ÿÎ_id
 == NULL)

248  
OSIP_BADPARAMETER
;

250 ià(
»que¡
 =ğ
NULL
 ||„eque¡->
ÿÎ_id
 =ğNULL ||„eque¡->
äom
 =ğNULL ||„eque¡->
to
 == NULL)

251  
OSIP_BADPARAMETER
;

253 
i
 = 
	`os_ÿÎ_id_to_¡r
(
»que¡
->
ÿÎ_id
, &
tmp
);

255 ià(
i
 != 0)

256  
i
;

258 ià(0 !ğ
	`¡rcmp
(
dlg
->
ÿÎ_id
, 
tmp
)) {

259 
	`os_ä“
(
tmp
);

260  
OSIP_UNDEFINED_ERROR
;

263 
	`os_ä“
(
tmp
);

270 ià(
dlg
->
loÿl_g
 =ğ
NULL
)

272  
OSIP_SYNTAXERROR
;

277 ià(
dlg
->
lše_·¿m
) {

278 
os_uri_·¿m_t
 *
lše_·¿m
;

280 
i
 = 
	`os_uri_·¿m_g‘_byÇme
(&
»que¡
->
»q_uri
->
u¾_·¿ms
, "lše", &
lše_·¿m
);

282 ià(
i
 =ğ0 && 
	`¡rcmp
(
dlg
->
lše_·¿m
,†še_·¿m->
gv®ue
))

283  
OSIP_UNDEFINED_ERROR
;

288 
i
 = 
	`os_äom_g‘_g
(
»que¡
->
äom
, &
g_·¿m_»mÙe
);

290 ià(
i
 !ğ0 && 
dlg
->
»mÙe_g
 !ğ
NULL
)

291  
OSIP_SYNTAXERROR
;

293 ià(
i
 !ğ0 && 
dlg
->
»mÙe_g
 =ğ
NULL
) {

294 ià(0 =ğ
	`os_äom_com·»
((
os_äom_t
 *è
dlg
->
»mÙe_uri
, (os_äom_ˆ*è
»que¡
->
äom
è&& 0 =ğos_äom_com·»(dlg->
loÿl_uri
,„eque¡->
to
))

295  
OSIP_SUCCESS
;

297  
OSIP_UNDEFINED_ERROR
;

300 ià(
dlg
->
»mÙe_g
 =ğ
NULL
) {

301 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA is‚ot compliant: missing‡ag in To feilds!\n"));

303 ià(0 =ğ
	`os_äom_com·»
((
os_äom_t
 *è
dlg
->
»mÙe_uri
, (os_äom_ˆ*è
»que¡
->
äom
è&& 0 =ğos_äom_com·»(dlg->
loÿl_uri
,„eque¡->
to
))

304  
OSIP_SUCCESS
;

306  
OSIP_UNDEFINED_ERROR
;

313 ià(0 =ğ
	`¡rcmp
(
g_·¿m_»mÙe
->
gv®ue
, 
dlg
->
»mÙe_g
))

314  
OSIP_SUCCESS
;

316  
OSIP_UNDEFINED_ERROR
;

317 
	}
}

319 
	$__os_dŸlog_š™
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
šv™e
, os_mes§ge_ˆ*
»¥Ú£
, 
os_äom_t
 *
loÿl
, 
os_to_t
 *
»mÙe
, os_mes§ge_ˆ*
»mÙe_msg
) {

320 
i
;

321 
pos
;

322 
os_g’”ic_·¿m_t
 *
g
;

324 *
dŸlog
 = 
NULL
;

326 ià(
»¥Ú£
 =ğ
NULL
)

327  
OSIP_BADPARAMETER
;

329 ià(
»¥Ú£
->
c£q
 =ğ
NULL
 || 
loÿl
 =ğNULL || 
»mÙe
 == NULL)

330  
OSIP_SYNTAXERROR
;

332 (*
dŸlog
èğ(
os_dŸlog_t
 *è
	`os_m®loc
((osip_dialog_t));

334 ià(*
dŸlog
 =ğ
NULL
)

335  
OSIP_NOMEM
;

337 
	`mem£t
(*
dŸlog
, 0, (
os_dŸlog_t
));

338 (*
dŸlog
)->
your_š¡ªû
 = 
NULL
;

340 ià(
	`MSG_IS_STATUS_2XX
(
»¥Ú£
))

341 (*
dŸlog
)->
¡©e
 = 
DIALOG_CONFIRMED
;

344 (*
dŸlog
)->
¡©e
 = 
DIALOG_EARLY
;

346 
i
 = 
	`os_ÿÎ_id_to_¡r
(
»¥Ú£
->
ÿÎ_id
, &((*
dŸlog
)->call_id));

348 ià(
i
 != 0) {

349 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

350 
	`os_dŸlog_ä“
(*
dŸlog
);

351 *
dŸlog
 = 
NULL
;

352  
i
;

355 
i
 = 
	`os_to_g‘_g
(
loÿl
, &
g
);

357 ià(
i
 != 0) {

358 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

359 
	`os_dŸlog_ä“
(*
dŸlog
);

360 *
dŸlog
 = 
NULL
;

361  
i
;

364 (*
dŸlog
)->
loÿl_g
 = 
	`os_¡rdup
(
g
->
gv®ue
);

366 
i
 = 
	`os_äom_g‘_g
(
»mÙe
, &
g
);

368 ià(
i
 == 0)

369 (*
dŸlog
)->
»mÙe_g
 = 
	`os_¡rdup
(
g
->
gv®ue
);

372 ià(
šv™e
) {

373 
os_uri_·¿m_t
 *
lše_·¿m
;

375 
i
 = 
	`os_uri_·¿m_g‘_byÇme
(&
šv™e
->
»q_uri
->
u¾_·¿ms
, "lše", &
lše_·¿m
);

377 ià(
i
 =ğ0 && 
lše_·¿m
 !ğ
NULL
 &&†še_·¿m->
gv®ue
 != NULL)

378 (*
dŸlog
)->
lše_·¿m
 = 
	`os_¡rdup
Öše_·¿m->
gv®ue
);

381 
	`os_li¡_š™
(&(*
dŸlog
)->
rou‹_£t
);

383 
pos
 = 0;

385 !
	`os_li¡_eŞ
(&
»¥Ú£
->
»cÜd_rou‹s
, 
pos
)) {

386 
os_»cÜd_rou‹_t
 *
¼
;

387 
os_»cÜd_rou‹_t
 *
¼2
;

389 
¼
 = (
os_»cÜd_rou‹_t
 *è
	`os_li¡_g‘
(&
»¥Ú£
->
»cÜd_rou‹s
, 
pos
);

390 
i
 = 
	`os_»cÜd_rou‹_şÚe
(
¼
, &
¼2
);

392 ià(
i
 != 0) {

393 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

394 
	`os_dŸlog_ä“
(*
dŸlog
);

395 *
dŸlog
 = 
NULL
;

396  
i
;

399 ià(
šv™e
 =ğ
NULL
)

400 
	`os_li¡_add
(&(*
dŸlog
)->
rou‹_£t
, 
¼2
, 0);

403 
	`os_li¡_add
(&(*
dŸlog
)->
rou‹_£t
, 
¼2
, -1);

405 
pos
++;

410 (*
dŸlog
)->
loÿl_c£q
 = 
	`os_©oi
(
»¥Ú£
->
c£q
->
numb”
);

412 
i
 = 
	`os_äom_şÚe
(
»mÙe
, &((*
dŸlog
)->
»mÙe_uri
));

414 ià(
i
 != 0) {

415 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

416 
	`os_dŸlog_ä“
(*
dŸlog
);

417 *
dŸlog
 = 
NULL
;

418  
i
;

421 
i
 = 
	`os_to_şÚe
(
loÿl
, &((*
dŸlog
)->
loÿl_uri
));

423 ià(
i
 != 0) {

424 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

425 
	`os_dŸlog_ä“
(*
dŸlog
);

426 *
dŸlog
 = 
NULL
;

427  
i
;

431 
os_cÚù_t
 *
cÚù
;

433 ià(!
	`os_li¡_eŞ
(&
»mÙe_msg
->
cÚùs
, 0)) {

434 
cÚù
 = 
	`os_li¡_g‘
(&
»mÙe_msg
->
cÚùs
, 0);

435 
i
 = 
	`os_cÚù_şÚe
(
cÚù
, &((*
dŸlog
)->
»mÙe_cÚù_uri
));

437 ià(
i
 != 0) {

438 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚otƒstablish dialog!\n"));

439 
	`os_dŸlog_ä“
(*
dŸlog
);

440 *
dŸlog
 = 
NULL
;

441  
i
;

445 (*
dŸlog
)->
»mÙe_cÚù_uri
 = 
NULL
;

446 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Remote UA is‚ot compliant: missing‡ contact in„emote message!\n"));

450 (*
dŸlog
)->
£cu»
 = -1;

452  
OSIP_SUCCESS
;

453 
	}
}

455 
	$os_dŸlog_š™_as_uac
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
»¥Ú£
) {

456 
i
;

458 
i
 = 
	`__os_dŸlog_š™
(
dŸlog
, 
NULL
, 
»¥Ú£
,„e¥Ú£->
äom
,„e¥Ú£->
to
,„esponse);

460 ià(
i
 != 0) {

461 *
dŸlog
 = 
NULL
;

462  
i
;

465 (*
dŸlog
)->
ty³
 = 
CALLER
;

466 (*
dŸlog
)->
»mÙe_c£q
 = -1;

468  
OSIP_SUCCESS
;

469 
	}
}

472 
	$os_dŸlog_š™_as_uac_w™h_»mÙe_»que¡
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
Ãxt_»que¡
, 
loÿl_c£q
) {

473 
i
;

475 *
dŸlog
 = 
NULL
;

477 ià(
Ãxt_»que¡
->
c£q
 =ğ
NULL
)

478  
OSIP_BADPARAMETER
;

480 
i
 = 
	`__os_dŸlog_š™
(
dŸlog
, 
Ãxt_»que¡
,‚ext_»que¡,‚ext_»que¡->
to
,‚ext_»que¡->
äom
,‚ext_request);

482 ià(
i
 != 0) {

483 *
dŸlog
 = 
NULL
;

484  
i
;

487 (*
dŸlog
)->
ty³
 = 
CALLER
;

488 (*
dŸlog
)->
¡©e
 = 
DIALOG_CONFIRMED
;

490 (*
dŸlog
)->
loÿl_c£q
 =†ocal_cseq;

491 (*
dŸlog
)->
»mÙe_c£q
 = 
	`os_©oi
(
Ãxt_»que¡
->
c£q
->
numb”
);

493  
OSIP_SUCCESS
;

494 
	}
}

496 
	$os_dŸlog_š™_as_uas
(
os_dŸlog_t
 **
dŸlog
, 
os_mes§ge_t
 *
šv™e
, os_mes§ge_ˆ*
»¥Ú£
) {

497 
i
;

499 *
dŸlog
 = 
NULL
;

501 ià(
»¥Ú£
->
c£q
 =ğ
NULL
)

502  
OSIP_SYNTAXERROR
;

504 
i
 = 
	`__os_dŸlog_š™
(
dŸlog
, 
šv™e
, 
»¥Ú£
,„e¥Ú£->
to
,„e¥Ú£->
äom
, invite);

506 ià(
i
 != 0) {

507 *
dŸlog
 = 
NULL
;

508  
i
;

511 (*
dŸlog
)->
ty³
 = 
CALLEE
;

512 (*
dŸlog
)->
»mÙe_c£q
 = 
	`os_©oi
(
»¥Ú£
->
c£q
->
numb”
);

514  
OSIP_SUCCESS
;

515 
	}
}

517 
	$os_dŸlog_ä“
(
os_dŸlog_t
 *
dŸlog
) {

518 ià(
dŸlog
 =ğ
NULL
)

521 
	`os_cÚù_ä“
(
dŸlog
->
»mÙe_cÚù_uri
);

522 
	`os_äom_ä“
(
dŸlog
->
loÿl_uri
);

523 
	`os_to_ä“
(
dŸlog
->
»mÙe_uri
);

524 
	`os_li¡_¥ecŸl_ä“
(&
dŸlog
->
rou‹_£t
, ((*)(*)è& 
os_»cÜd_rou‹_ä“
);

525 
	`os_ä“
(
dŸlog
->
lše_·¿m
);

526 
	`os_ä“
(
dŸlog
->
»mÙe_g
);

527 
	`os_ä“
(
dŸlog
->
loÿl_g
);

528 
	`os_ä“
(
dŸlog
->
ÿÎ_id
);

529 
	`os_ä“
(
dŸlog
);

530 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_event.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

28 
os_ev’t_t
 *
	$os_·r£
(cÚ¡ *
buf
, 
size_t
 
Ëngth
) {

29 
i
;

30 
os_ev’t_t
 *
£
 = 
	`__os_ev’t_Ãw
(
UNKNOWN_EVT
, 0);

32 ià(
£
 =ğ
NULL
)

33  
NULL
;

36 
i
 = 
	`os_mes§ge_š™
(&(
£
->
s
));

38 ià(
i
 != 0) {

39 
	`os_ä“
(
£
);

40  
NULL
;

43 ià(
	`os_mes§ge_·r£
(
£
->
s
, 
buf
, 
Ëngth
) != 0) {

44 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "could‚ot…arse message\n"));

45 
	`os_mes§ge_ä“
(
£
->
s
);

46 
	`os_ä“
(
£
);

47  
NULL
;

50 ià(
£
->
s
->
ÿÎ_id
 !ğ
NULL
 && se->s->ÿÎ_id->
numb”
 != NULL) {

51 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO3
, 
NULL
, "MESSAGE REC. CALLID:%s\n", 
£
->
s
->
ÿÎ_id
->
numb”
));

54 ià(
	`MSG_IS_REQUEST
(
£
->
s
)) {

55 ià(
£
->
s
->
s_m‘hod
 =ğ
NULL
 || se->s->
»q_uri
 == NULL) {

56 
	`os_mes§ge_ä“
(
£
->
s
);

57 
	`os_ä“
(
£
);

58  
NULL
;

62 
£
->
ty³
 = 
	`evt_£t_ty³_šcomšg_smes§ge
(£->
s
);

63  
£
;

65 
	}
}

72 
os_ev’t_t
 *
	$__os_ev’t_Ãw
(
ty³_t
 
ty³
, 
Œª§ùiÚid
) {

73 
os_ev’t_t
 *
sev’t
;

75 
sev’t
 = (
os_ev’t_t
 *è
	`os_m®loc
((osip_event_t));

77 ià(
sev’t
 =ğ
NULL
)

78  
NULL
;

80 
sev’t
->
ty³
 =ype;

81 
sev’t
->
s
 = 
NULL
;

82 
sev’t
->
Œª§ùiÚid
 =ransactionid;

83  
sev’t
;

84 
	}
}

90 
os_ev’t_t
 *
	$os_Ãw_outgošg_smes§ge
(
os_mes§ge_t
 *
s
) {

91 
os_ev’t_t
 *
sev’t
;

93 ià(
s
 =ğ
NULL
)

94  
NULL
;

96 ià(
	`MSG_IS_REQUEST
(
s
)) {

97 ià(
s
->
s_m‘hod
 =ğ
NULL
)

98  
NULL
;

100 ià(
s
->
»q_uri
 =ğ
NULL
)

101  
NULL
;

104 
sev’t
 = (
os_ev’t_t
 *è
	`os_m®loc
((osip_event_t));

106 ià(
sev’t
 =ğ
NULL
)

107  
NULL
;

109 
sev’t
->
s
 = sip;

110 
sev’t
->
ty³
 = 
	`evt_£t_ty³_outgošg_smes§ge
(
s
);

111 
sev’t
->
Œª§ùiÚid
 = 0;

112  
sev’t
;

113 
	}
}

115 
ty³_t
 
	$evt_£t_ty³_šcomšg_smes§ge
(
os_mes§ge_t
 *
s
) {

116 ià(
	`MSG_IS_REQUEST
(
s
)) {

117 ià(
	`MSG_IS_INVITE
(
s
))

118  
RCV_REQINVITE
;

120 ià(
	`MSG_IS_ACK
(
s
))

121  
RCV_REQACK
;

123  
RCV_REQUEST
;

126 ià(
	`MSG_IS_STATUS_1XX
(
s
))

127  
RCV_STATUS_1XX
;

129 ià(
	`MSG_IS_STATUS_2XX
(
s
))

130  
RCV_STATUS_2XX
;

132  
RCV_STATUS_3456XX
;

134 
	}
}

136 
ty³_t
 
	$evt_£t_ty³_outgošg_smes§ge
(
os_mes§ge_t
 *
s
) {

137 ià(
	`MSG_IS_REQUEST
(
s
)) {

138 ià(
	`MSG_IS_INVITE
(
s
))

139  
SND_REQINVITE
;

141 ià(
	`MSG_IS_ACK
(
s
))

142  
SND_REQACK
;

144  
SND_REQUEST
;

147 ià(
	`MSG_IS_STATUS_1XX
(
s
))

148  
SND_STATUS_1XX
;

150 ià(
	`MSG_IS_STATUS_2XX
(
s
))

151  
SND_STATUS_2XX
;

153  
SND_STATUS_3456XX
;

155 
	}
}

157 
	$os_ev’t_ä“
(
os_ev’t_t
 *
ev’t
) {

158 ià(
ev’t
 !ğ
NULL
) {

159 
	`os_mes§ge_ä“
(
ev’t
->
s
);

160 
	`os_ä“
(
ev’t
);

162 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_time.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os_time.h
>

22 
	~<os·r£r2/os_pÜt.h
>

24 #ifdeà
__APPLE__


25 
	~<mach/şock.h
>

26 
	~<mach/mach.h
>

29 
timev®
 
	goff£t
 = {0, 0};

31 
	$add_g‘timeofday
(
timev®
 *
©v
, 
ms
) {

32 
m
;

34 ià(
ms
 >= 1000000) {

35 
©v
->
tv_u£c
 = 0;

36 
m
 = 
ms
 / 1000;

39 
©v
->
tv_u£c
 +ğ
ms
 * 1000;

40 
m
 = 
©v
->
tv_u£c
 / 1000000;

41 
©v
->
tv_u£c
 =‡tv->tv_usec % 1000000;

44 
©v
->
tv_£c
 +ğ
m
;

45 
	}
}

47 
	$mš_tim”cmp
(
timev®
 *
tv1
, timev® *
tv2
) {

48 ià(
tv2
->
tv_£c
 == -1)

51 ià(
	`os_tim”cmp
(
tv1
, 
tv2
, >)) {

53 
tv1
->
tv_£c
 = 
tv2
->tv_sec;

54 
tv1
->
tv_u£c
 = 
tv2
->tv_usec;

56 
	}
}

58 #ià!
defšed
(
__PALMOS__
è&& defšed(
_WIN32_WCE
)

60 
	~<time.h
>

62 
	$os_g‘timeofday
(
timev®
 *

, *
tz
) {

63 
DWORD
 
timemlis
 = 
	`G‘TickCouÁ
();

65 

->
tv_£c
 = (
timemlis
 / 1000è+ 
off£t
.tv_sec;

66 

->
tv_u£c
 = (
timemlis
 - (->
tv_£c
 * 1000)) * 1000;

68 
	}
}

70 
	$_os_g‘timeofday_»®time
(
timev®
 *

, *
tz
) {

71 

->
tv_£c
 = 0;

72 

->
tv_u£c
 = 0;

74 
	}
}

76 
time_t
 
	$time
(
time_t
 *
t
) {

77 
DWORD
 
timemlis
 = 
	`G‘TickCouÁ
();

79 ià(
timemlis
 > 0) {

80 ià(
t
 !ğ
NULL
)

81 *
t
 = 
timemlis
 / 1000;

84  
timemlis
 / 1000;

85 
	}
}

87 #–ià!
defšed
(
__PALMOS__
è&& defšed(
WIN32
)

89 
	~<time.h
>

90 
	~<sys/timeb.h
>

91 
	~<wšdows.h
>

93 
	$os_g‘timeofday
(
timev®
 *

, *
tz
) {

94 
_timeb
 
timebufãr
;

96 
	`_áime
(&
timebufãr
);

97 

->
tv_£c
 = (è
timebufãr
.
time
 + 
off£t
.tv_sec;

98 

->
tv_u£c
 = 
timebufãr
.
ml™m
 * 1000;

100 
	}
}

102 
	$_os_g‘timeofday_»®time
(
timev®
 *

, *
tz
) {

103 
FILETIME
 
lSy¡emTimeAsFeTime
;

104 
LONGLONG
 
Î_now
;

106 
	`G‘Sy¡emTimeAsFeTime
(&
lSy¡emTimeAsFeTime
);

107 
Î_now
 = (
LONGLONG
è
lSy¡emTimeAsFeTime
.
dwLowD©eTime
 + ((LONGLONG)ÖSy¡emTimeAsFeTime.
dwHighD©eTime
) << 32LL);

108 
Î_now
 =†l_now / 10;

109 

->
tv_£c
 = (è
Î_now
 / 1000000;

110 

->
tv_u£c
 = (è
Î_now
 % 1000000;

112 
	}
}

114 #–ià
defšed
(
__lšux
è|| defšed(
__lšux__
è|| defšed(
HAVE_CLOCK_GETTIME_MONOTONIC
)

116 
	$os_g‘timeofday
(
timev®
 *

, *
tz
) {

117 
time¥ec
 
ts
;

119 ià(
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
ts
) < 0) {

120 
	`g‘timeofday
(

, 
tz
);

124 

->
tv_£c
 = 
ts
.tv_£ø+ 
off£t
.tv_sec;

125 

->
tv_u£c
 = 
ts
.
tv_n£c
 / 1000;

127 
	}
}

129 
	$_os_g‘timeofday_»®time
(
timev®
 *

, *
tz
) {

130 
time¥ec
 
ts
;

132 ià(
	`şock_g‘time
(
CLOCK_REALTIME
, &
ts
) < 0) {

133 
	`g‘timeofday
(

, 
tz
);

137 

->
tv_£c
 = 
ts
.tv_sec;

138 

->
tv_u£c
 = 
ts
.
tv_n£c
 / 1000;

140 
	}
}

142 #–ià
defšed
(
__APPLE__
)

144 
	$os_g‘timeofday
(
timev®
 *

, *
tz
) {

145 
şock_£rv_t
 
cşock
;

146 
mach_time¥ec_t
 
mts
;

148 
	`ho¡_g‘_şock_£rviû
(
	`mach_ho¡_£lf
(), 
SYSTEM_CLOCK
, &
cşock
);

149 
	`şock_g‘_time
(
cşock
, &
mts
);

150 
	`mach_pÜt_d—Îoÿ‹
(
	`mach_sk_£lf
(), 
cşock
);

151 

->
tv_£c
 = 
mts
.tv_£ø+ 
off£t
.tv_sec;

152 

->
tv_u£c
 = 
mts
.
tv_n£c
 / 1000;

154 
	}
}

156 
	$_os_g‘timeofday_»®time
(
timev®
 *

, *
tz
) {

158 

->
tv_£c
 = 0;

159 

->
tv_u£c
 = 0;

161 
	}
}

166 
	$os_g‘timeofday
(
timev®
 *

, *
tz
) {

167 
	`g‘timeofday
(

, 
tz
);

168 

->
tv_£c
 +ğ
off£t
.tv_sec;

170 
	}
}

172 
	$_os_g‘timeofday_»®time
(
timev®
 *

, *
tz
) {

173 

->
tv_£c
 = 0;

174 

->
tv_u£c
 = 0;

176 
	}
}

180 #ià
defšed
(
__¬c__
)

182 
time_t
 
	$time
(
time_t
 *
t
) {

183 
timev®
 
now
;

185 
	`os_g‘timeofday
(&
now
, 
NULL
);

187 ià(
t
 !ğ
NULL
) {

188 *
t
 = 
now
.
tv_£c
;

191  
now
.
tv_£c
;

192 
	}
}

196 
	$os_com³n§‹time
() {

197 #iâdeà
ANDROID


200 
timev®
 
Ï¡_now_mÚÙÚic
 = {0, 0};

201 
timev®
 
Ï¡_now_»®
 = {0, 0};

202 
timev®
 
now_mÚÙÚic
;

203 
timev®
 
now_»®
;

204 
timev®
 
diff_mÚÙÚic
;

205 
timev®
 
diff_»®
;

207 
	`_os_g‘timeofday_»®time
(&
now_»®
, 
NULL
);

208 
	`os_g‘timeofday
(&
now_mÚÙÚic
, 
NULL
);

209 
now_mÚÙÚic
.
tv_£c
 -ğ
off£t
.tv_sec;

211 ià(
now_»®
.
tv_£c
 == 0)

218 ià(
Ï¡_now_mÚÙÚic
.
tv_£c
 == 0) {

219 
	`_os_g‘timeofday_»®time
(&
Ï¡_now_»®
, 
NULL
);

220 
	`os_g‘timeofday
(&
Ï¡_now_mÚÙÚic
, 
NULL
);

221 
Ï¡_now_mÚÙÚic
.
tv_£c
 -ğ
off£t
.tv_sec;

226 
diff_mÚÙÚic
.
tv_£c
 = 
now_mÚÙÚic
.tv_£ø- 
Ï¡_now_mÚÙÚic
.tv_sec;

227 
diff_»®
.
tv_£c
 = 
now_»®
.tv_£ø- 
Ï¡_now_»®
.tv_sec;

229 ià(
diff_»®
.
tv_£c
 < 5)

232 ià(
diff_»®
.
tv_£c
 > 3600)

235 ià(
diff_»®
.
tv_£c
 < 
diff_mÚÙÚic
.tv_sec + 2)

238 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "adju¡šgƒxos mÚÙÚiøtim(%i)!\n", 
diff_»®
.
tv_£c
 - 
diff_mÚÙÚic
.tv_sec));

239 
off£t
.
tv_£c
 +ğ
diff_»®
.tv_£ø- 
diff_mÚÙÚic
.tv_sec;

242 
	`_os_g‘timeofday_»®time
(&
Ï¡_now_»®
, 
NULL
);

243 
	`os_g‘timeofday
(&
Ï¡_now_mÚÙÚic
, 
NULL
);

244 
Ï¡_now_mÚÙÚic
.
tv_£c
 -ğ
off£t
.tv_sec;

246 
	}
}

248 
time_t
 
	$os_g‘sy¡emtime
(
time_t
 *
t
) {

249 
timev®
 
now_mÚÙÚic
;

251 #ifdeà
ANDROID


252 
	`os_com³n§‹time
();

255 
	`os_g‘timeofday
(&
now_mÚÙÚic
, 
NULL
);

257 ià(
t
 !ğ
NULL
) {

258 *
t
 = 
now_mÚÙÚic
.
tv_£c
;

261  
now_mÚÙÚic
.
tv_£c
;

262 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_transaction.c

20 
	~<os2/š‹º®.h
>

21 
	~<os2/os.h
>

23 
	~"fsm.h
"

24 
	~"xixt.h
"

26 
os_¡©emachše_t
 
iù_fsm
;

27 
os_¡©emachše_t
 
i¡_fsm
;

28 
os_¡©emachše_t
 
niù_fsm
;

29 
os_¡©emachše_t
 
ni¡_fsm
;

31 
os_id_mu‹x_lock
(
os_t
 *
os
);

32 
os_id_mu‹x_uÆock
(
os_t
 *
os
);

34 
__os_Œª§ùiÚ_£t_tİvŸ
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_vŸ_t
 *
tİvŸ
);

35 
__os_Œª§ùiÚ_£t_äom
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_äom_t
 *
äom
);

36 
__os_Œª§ùiÚ_£t_to
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_to_t
 *
to
);

37 
__os_Œª§ùiÚ_£t_ÿÎ_id
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ÿÎ_id_t
 *
ÿÎ_id
);

38 
__os_Œª§ùiÚ_£t_c£q
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_c£q_t
 *
c£q
);

40 
	$__os_Œª§ùiÚ_£t_tİvŸ
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_vŸ_t
 *
tİvŸ
) {

41 
i
;

43 ià(
Œª§ùiÚ
 =ğ
NULL
)

44  
OSIP_BADPARAMETER
;

46 
i
 = 
	`os_vŸ_şÚe
(
tİvŸ
, &(
Œª§ùiÚ
->topvia));

48 ià(
i
 == 0)

49  
OSIP_SUCCESS
;

51 
Œª§ùiÚ
->
tİvŸ
 = 
NULL
;

52  
i
;

53 
	}
}

55 
	$__os_Œª§ùiÚ_£t_äom
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_äom_t
 *
äom
) {

56 
i
;

58 ià(
Œª§ùiÚ
 =ğ
NULL
)

59  
OSIP_BADPARAMETER
;

61 
i
 = 
	`os_äom_şÚe
(
äom
, &(
Œª§ùiÚ
->from));

63 ià(
i
 == 0)

64  
OSIP_SUCCESS
;

66 
Œª§ùiÚ
->
äom
 = 
NULL
;

67  
i
;

68 
	}
}

70 
	$__os_Œª§ùiÚ_£t_to
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_to_t
 *
to
) {

71 
i
;

73 ià(
Œª§ùiÚ
 =ğ
NULL
)

74  
OSIP_BADPARAMETER
;

76 
i
 = 
	`os_to_şÚe
(
to
, &(
Œª§ùiÚ
->to));

78 ià(
i
 == 0)

79  
OSIP_SUCCESS
;

81 
Œª§ùiÚ
->
to
 = 
NULL
;

82  
i
;

83 
	}
}

85 
	$__os_Œª§ùiÚ_£t_ÿÎ_id
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ÿÎ_id_t
 *
ÿÎ_id
) {

86 
i
;

88 ià(
Œª§ùiÚ
 =ğ
NULL
)

89  
OSIP_BADPARAMETER
;

91 
i
 = 
	`os_ÿÎ_id_şÚe
(
ÿÎ_id
, &(
Œª§ùiÚ
->
ÿÎid
));

93 ià(
i
 == 0)

94  
OSIP_SUCCESS
;

96 
Œª§ùiÚ
->
ÿÎid
 = 
NULL
;

97  
i
;

98 
	}
}

100 
	$__os_Œª§ùiÚ_£t_c£q
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_c£q_t
 *
c£q
) {

101 
i
;

103 ià(
Œª§ùiÚ
 =ğ
NULL
)

104  
OSIP_BADPARAMETER
;

106 
i
 = 
	`os_c£q_şÚe
(
c£q
, &(
Œª§ùiÚ
->cseq));

108 ià(
i
 == 0)

109  
OSIP_SUCCESS
;

111 
Œª§ùiÚ
->
c£q
 = 
NULL
;

112  
i
;

113 
	}
}

115 
	$os_Œª§ùiÚ_š™
(
os_Œª§ùiÚ_t
 **
Œª§ùiÚ
, 
os_fsm_ty³_t
 
ùx_ty³
, 
os_t
 *
os
, 
os_mes§ge_t
 *
»que¡
) {

116 
os_vŸ_t
 *
tİvŸ
;

118 
i
;

120 *
Œª§ùiÚ
 = 
NULL
;

122 ià(
»que¡
 =ğ
NULL
)

123  
OSIP_BADPARAMETER
;

125 ià(
»que¡
->
ÿÎ_id
 =ğ
NULL
)

126  
OSIP_BADPARAMETER
;

128 ià(
»que¡
->
ÿÎ_id
->
numb”
 =ğ
NULL
)

129  
OSIP_BADPARAMETER
;

131 *
Œª§ùiÚ
 = (
os_Œª§ùiÚ_t
 *è
	`os_m®loc
((osip_transaction_t));

133 ià(*
Œª§ùiÚ
 =ğ
NULL
)

134  
OSIP_NOMEM
;

136 
	`mem£t
(*
Œª§ùiÚ
, 0, (
os_Œª§ùiÚ_t
));

138 (*
Œª§ùiÚ
)->
bœth_time
 = 
	`os_g‘sy¡emtime
(
NULL
);

139 
	`os_g‘timeofday
(&((*
Œª§ùiÚ
)->
ü—‹d_time
), 
NULL
);

140 
	`os_id_mu‹x_lock
(
os
);

141 (*
Œª§ùiÚ
)->
Œª§ùiÚid
 = 
os
->transactionid++;

142 
	`os_id_mu‹x_uÆock
(
os
);

143 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "®loÿtšg¿n§ùiÚ„esourû %˜%s\n", (*
Œª§ùiÚ
)->
Œª§ùiÚid
, 
»que¡
->
ÿÎ_id
->
numb”
));

146 (*
Œª§ùiÚ
)->
ùx_ty³
 = ctx_type;

147 (*
Œª§ùiÚ
)->
iù_cÚ‹xt
 = 
NULL
;

148 (*
Œª§ùiÚ
)->
i¡_cÚ‹xt
 = 
NULL
;

149 (*
Œª§ùiÚ
)->
niù_cÚ‹xt
 = 
NULL
;

150 (*
Œª§ùiÚ
)->
ni¡_cÚ‹xt
 = 
NULL
;

151 (*
Œª§ùiÚ
)->
cÚfig
 = 
os
;

153 
tİvŸ
 = 
	`os_li¡_g‘
(&
»que¡
->
vŸs
, 0);

155 ià(
tİvŸ
 =ğ
NULL
) {

156 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

157 *
Œª§ùiÚ
 = 
NULL
;

158  
OSIP_SYNTAXERROR
;

161 
i
 = 
	`__os_Œª§ùiÚ_£t_tİvŸ
(*
Œª§ùiÚ
, 
tİvŸ
);

163 ià(
i
 != 0) {

164 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

165 *
Œª§ùiÚ
 = 
NULL
;

166  
i
;

172 
i
 = 
	`__os_Œª§ùiÚ_£t_äom
(*
Œª§ùiÚ
, 
»que¡
->
äom
);

174 ià(
i
 != 0) {

175 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

176 *
Œª§ùiÚ
 = 
NULL
;

177  
i
;

180 
i
 = 
	`__os_Œª§ùiÚ_£t_to
(*
Œª§ùiÚ
, 
»que¡
->
to
);

182 ià(
i
 != 0) {

183 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

184 *
Œª§ùiÚ
 = 
NULL
;

185  
i
;

188 
i
 = 
	`__os_Œª§ùiÚ_£t_ÿÎ_id
(*
Œª§ùiÚ
, 
»que¡
->
ÿÎ_id
);

190 ià(
i
 != 0) {

191 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

192 *
Œª§ùiÚ
 = 
NULL
;

193  
i
;

196 
i
 = 
	`__os_Œª§ùiÚ_£t_c£q
(*
Œª§ùiÚ
, 
»que¡
->
c£q
);

198 ià(
i
 != 0) {

199 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

200 *
Œª§ùiÚ
 = 
NULL
;

201  
i
;

206 (*
Œª§ùiÚ
)->
Üig_»que¡
 = 
NULL
;

208 (*
Œª§ùiÚ
)->
Œª§ùiÚff
 = (
os_fifo_t
 *è
	`os_m®loc
((osip_fifo_t));

210 ià((*
Œª§ùiÚ
)->
Œª§ùiÚff
 =ğ
NULL
) {

211 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

212 *
Œª§ùiÚ
 = 
NULL
;

213  
OSIP_NOMEM
;

216 
	`os_fifo_š™
((*
Œª§ùiÚ
)->
Œª§ùiÚff
);

218 ià(
ùx_ty³
 =ğ
ICT
) {

219 (*
Œª§ùiÚ
)->
¡©e
 = 
ICT_PRE_CALLING
;

220 
i
 = 
	`__os_iù_š™
(&((*
Œª§ùiÚ
)->
iù_cÚ‹xt
), 
os
, 
»que¡
);

222 ià(
i
 != 0) {

223 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

224 *
Œª§ùiÚ
 = 
NULL
;

225  
i
;

228 
	`__os_add_iù
(
os
, *
Œª§ùiÚ
);

230 } ià(
ùx_ty³
 =ğ
IST
) {

231 (*
Œª§ùiÚ
)->
¡©e
 = 
IST_PRE_PROCEEDING
;

232 
i
 = 
	`__os_i¡_š™
(&((*
Œª§ùiÚ
)->
i¡_cÚ‹xt
), 
os
, 
»que¡
);

234 ià(
i
 != 0) {

235 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

236 *
Œª§ùiÚ
 = 
NULL
;

237  
i
;

240 
	`__os_add_i¡
(
os
, *
Œª§ùiÚ
);

242 } ià(
ùx_ty³
 =ğ
NICT
) {

243 (*
Œª§ùiÚ
)->
¡©e
 = 
NICT_PRE_TRYING
;

244 
i
 = 
	`__os_niù_š™
(&((*
Œª§ùiÚ
)->
niù_cÚ‹xt
), 
os
, 
»que¡
);

246 ià(
i
 != 0) {

247 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

248 *
Œª§ùiÚ
 = 
NULL
;

249  
i
;

252 
	`__os_add_niù
(
os
, *
Œª§ùiÚ
);

255 (*
Œª§ùiÚ
)->
¡©e
 = 
NIST_PRE_TRYING
;

256 
i
 = 
	`__os_ni¡_š™
(&((*
Œª§ùiÚ
)->
ni¡_cÚ‹xt
), 
os
, 
»que¡
);

258 ià(
i
 != 0) {

259 
	`os_Œª§ùiÚ_ä“
(*
Œª§ùiÚ
);

260 *
Œª§ùiÚ
 = 
NULL
;

261  
i
;

264 
	`__os_add_ni¡
(
os
, *
Œª§ùiÚ
);

267  
OSIP_SUCCESS
;

268 
	}
}

284 
	$os_Œª§ùiÚ_ä“
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

285 
i
;

287 ià(
Œª§ùiÚ
 =ğ
NULL
)

288  
OSIP_BADPARAMETER
;

290 
i
 = 
	`os_»move_Œª§ùiÚ
(
Œª§ùiÚ
->
cÚfig
,ransaction);

292 ià(
i
 != 0) {

293 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "Œª§ùiÚ‡Ì—dy„emoved from†i¡ %i!\n", 
Œª§ùiÚ
->
Œª§ùiÚid
));

296  
	`os_Œª§ùiÚ_ä“2
(
Œª§ùiÚ
);

297 
	}
}

301 
	$os_Œª§ùiÚ_ä“2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

302 
os_ev’t_t
 *
evt
;

304 ià(
Œª§ùiÚ
 =ğ
NULL
)

305  
OSIP_BADPARAMETER
;

307 ià(
Œª§ùiÚ
->
Üig_»que¡
 !ğ
NULL
 &&¿n§ùiÚ->Üig_»que¡->
ÿÎ_id
 !ğNULL &&¿n§ùiÚ->Üig_»que¡->ÿÎ_id->
numb”
 != NULL) {

308 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO2
, 
NULL
, "ä“¿n§ùiÚ„esourû %˜%s\n", 
Œª§ùiÚ
->
Œª§ùiÚid
,¿n§ùiÚ->
Üig_»que¡
->
ÿÎ_id
->
numb”
));

311 ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
ICT
) {

312 
	`__os_iù_ä“
(
Œª§ùiÚ
->
iù_cÚ‹xt
);

314 } ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
IST
) {

315 
	`__os_i¡_ä“
(
Œª§ùiÚ
->
i¡_cÚ‹xt
);

317 } ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
NICT
) {

318 
	`__os_niù_ä“
(
Œª§ùiÚ
->
niù_cÚ‹xt
);

321 
	`__os_ni¡_ä“
(
Œª§ùiÚ
->
ni¡_cÚ‹xt
);

325 ià(
Œª§ùiÚ
->
Œª§ùiÚff
 !ğ
NULL
) {

326 
evt
 = 
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

328 
evt
 !ğ
NULL
) {

329 
	`os_mes§ge_ä“
(
evt
->
s
);

330 
	`os_ä“
(
evt
);

331 
evt
 = 
	`os_fifo_Œyg‘
(
Œª§ùiÚ
->
Œª§ùiÚff
);

334 
	`os_fifo_ä“
(
Œª§ùiÚ
->
Œª§ùiÚff
);

337 
	`os_mes§ge_ä“
(
Œª§ùiÚ
->
Üig_»que¡
);

338 
	`os_mes§ge_ä“
(
Œª§ùiÚ
->
Ï¡_»¥Ú£
);

339 
	`os_mes§ge_ä“
(
Œª§ùiÚ
->
ack
);

341 
	`os_vŸ_ä“
(
Œª§ùiÚ
->
tİvŸ
);

342 
	`os_äom_ä“
(
Œª§ùiÚ
->
äom
);

343 
	`os_to_ä“
(
Œª§ùiÚ
->
to
);

344 
	`os_ÿÎ_id_ä“
(
Œª§ùiÚ
->
ÿÎid
);

345 
	`os_c£q_ä“
(
Œª§ùiÚ
->
c£q
);

347 
	`os_ä“
(
Œª§ùiÚ
);

348  
OSIP_SUCCESS
;

349 
	}
}

351 
	$os_Œª§ùiÚ_add_ev’t
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ev’t_t
 *
evt
) {

352 ià(
evt
 =ğ
NULL
)

353  
OSIP_BADPARAMETER
;

355 ià(
Œª§ùiÚ
 =ğ
NULL
)

356  
OSIP_BADPARAMETER
;

358 
evt
->
Œª§ùiÚid
 = 
Œª§ùiÚ
->transactionid;

359 
	`os_fifo_add
(
Œª§ùiÚ
->
Œª§ùiÚff
, 
evt
);

360  
OSIP_SUCCESS
;

361 
	}
}

363 
	$os_Œª§ùiÚ_execu‹
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_ev’t_t
 *
evt
) {

364 
os_¡©emachše_t
 *
¡©emachše
;

367 ià(
	`EVT_IS_KILL_TRANSACTION
(
evt
)) {

373 
	`os_ä“
(
evt
);

374  
OSIP_SUCCESS
;

377 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sev’ˆŒ->Œª§ùiÚid: %i\n", 
Œª§ùiÚ
->
Œª§ùiÚid
));

378 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sev’ˆŒ->¡©e: %i\n", 
Œª§ùiÚ
->
¡©e
));

379 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sev’ˆevt->ty³: %i\n", 
evt
->
ty³
));

380 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sev’ˆevt->s: %x\n", 
evt
->
s
));

382 ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
ICT
)

383 
¡©emachše
 = &
iù_fsm
;

385 ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
IST
)

386 
¡©emachše
 = &
i¡_fsm
;

388 ià(
Œª§ùiÚ
->
ùx_ty³
 =ğ
NICT
)

389 
¡©emachše
 = &
niù_fsm
;

392 
¡©emachše
 = &
ni¡_fsm
;

394 ià(0 !ğ
	`fsm_ÿÎm‘hod
(
evt
->
ty³
, 
Œª§ùiÚ
->
¡©e
, 
¡©emachše
,ƒvt,ransaction)) {

395 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO3
, 
NULL
, "USELESSƒvent!\n"));

398 ià(
	`EVT_IS_MSG
(
evt
)) {

399 ià(
evt
->
s
 !ğ
NULL
) {

400 
	`os_mes§ge_ä“
(
evt
->
s
);

405 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "sipeventƒvt: method called!\n"));

408 
	`os_ä“
(
evt
);

410 
	}
}

412 
	$os_Œª§ùiÚ_g‘_de¡š©iÚ
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, **

, *
pÜt
) {

413 *

 = 
NULL
;

414 *
pÜt
 = 0;

416 ià(
Œª§ùiÚ
 =ğ
NULL
)

417  
OSIP_BADPARAMETER
;

419 ià(
Œª§ùiÚ
->
iù_cÚ‹xt
 !ğ
NULL
) {

420 *

 = 
Œª§ùiÚ
->
iù_cÚ‹xt
->
de¡š©iÚ
;

421 *
pÜt
 = 
Œª§ùiÚ
->
iù_cÚ‹xt
->port;

422  
OSIP_SUCCESS
;

424 } ià(
Œª§ùiÚ
->
niù_cÚ‹xt
 !ğ
NULL
) {

425 *

 = 
Œª§ùiÚ
->
niù_cÚ‹xt
->
de¡š©iÚ
;

426 *
pÜt
 = 
Œª§ùiÚ
->
niù_cÚ‹xt
->port;

427  
OSIP_SUCCESS
;

430  
OSIP_UNDEFINED_ERROR
;

431 
	}
}

433 
	$os_Œª§ùiÚ_£t_¤v_»cÜd
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_¤v_»cÜd_t
 *
»cÜd
) {

434 ià(
Œª§ùiÚ
 =ğ
NULL
)

435  
OSIP_BADPARAMETER
;

437 
	`memıy
(&
Œª§ùiÚ
->
»cÜd
,„ecÜd, (
os_¤v_»cÜd_t
));

438  
OSIP_SUCCESS
;

439 
	}
}

441 
	$os_Œª§ùiÚ_£t_Ç±r_»cÜd
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
os_Ç±r_t
 *
»cÜd
) {

442 ià(
Œª§ùiÚ
 =ğ
NULL
)

443  
OSIP_BADPARAMETER
;

445 
Œª§ùiÚ
->
Ç±r_»cÜd
 = 
»cÜd
;

446  
OSIP_SUCCESS
;

447 
	}
}

449 
	$os_Œª§ùiÚ_£t_your_š¡ªû
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

450 ià(
Œª§ùiÚ
 =ğ
NULL
)

451  
OSIP_BADPARAMETER
;

453 
Œª§ùiÚ
->
»£rved1
 = 
±r
;

454  
OSIP_SUCCESS
;

455 
	}
}

457 
	$os_Œª§ùiÚ_£t_»£rved1
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

458 ià(
Œª§ùiÚ
 =ğ
NULL
)

459  
OSIP_BADPARAMETER
;

461 
Œª§ùiÚ
->
»£rved1
 = 
±r
;

462  
OSIP_SUCCESS
;

463 
	}
}

465 
	$os_Œª§ùiÚ_£t_»£rved2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

466 ià(
Œª§ùiÚ
 =ğ
NULL
)

467  
OSIP_BADPARAMETER
;

469 
Œª§ùiÚ
->
»£rved2
 = 
±r
;

470  
OSIP_SUCCESS
;

471 
	}
}

473 
	$os_Œª§ùiÚ_£t_»£rved3
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

474 ià(
Œª§ùiÚ
 =ğ
NULL
)

475  
OSIP_BADPARAMETER
;

477 
Œª§ùiÚ
->
»£rved3
 = 
±r
;

478  
OSIP_SUCCESS
;

479 
	}
}

481 
	$os_Œª§ùiÚ_£t_»£rved4
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

482 ià(
Œª§ùiÚ
 =ğ
NULL
)

483  
OSIP_BADPARAMETER
;

485 
Œª§ùiÚ
->
»£rved4
 = 
±r
;

486  
OSIP_SUCCESS
;

487 
	}
}

489 
	$os_Œª§ùiÚ_£t_»£rved5
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

490 ià(
Œª§ùiÚ
 =ğ
NULL
)

491  
OSIP_BADPARAMETER
;

493 
Œª§ùiÚ
->
»£rved5
 = 
±r
;

494  
OSIP_SUCCESS
;

495 
	}
}

497 
	$os_Œª§ùiÚ_£t_»£rved6
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, *
±r
) {

498 ià(
Œª§ùiÚ
 =ğ
NULL
)

499  
OSIP_BADPARAMETER
;

501 
Œª§ùiÚ
->
»£rved6
 = 
±r
;

502  
OSIP_SUCCESS
;

503 
	}
}

505 *
	$os_Œª§ùiÚ_g‘_your_š¡ªû
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

506 ià(
Œª§ùiÚ
 =ğ
NULL
)

507  
NULL
;

509  
Œª§ùiÚ
->
»£rved1
;

510 
	}
}

512 *
	$os_Œª§ùiÚ_g‘_»£rved1
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

513 ià(
Œª§ùiÚ
 =ğ
NULL
)

514  
NULL
;

516  
Œª§ùiÚ
->
»£rved1
;

517 
	}
}

519 *
	$os_Œª§ùiÚ_g‘_»£rved2
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

520 ià(
Œª§ùiÚ
 =ğ
NULL
)

521  
NULL
;

523  
Œª§ùiÚ
->
»£rved2
;

524 
	}
}

526 *
	$os_Œª§ùiÚ_g‘_»£rved3
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

527 ià(
Œª§ùiÚ
 =ğ
NULL
)

528  
NULL
;

530  
Œª§ùiÚ
->
»£rved3
;

531 
	}
}

533 *
	$os_Œª§ùiÚ_g‘_»£rved4
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

534 ià(
Œª§ùiÚ
 =ğ
NULL
)

535  
NULL
;

537  
Œª§ùiÚ
->
»£rved4
;

538 
	}
}

540 *
	$os_Œª§ùiÚ_g‘_»£rved5
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

541 ià(
Œª§ùiÚ
 =ğ
NULL
)

542  
NULL
;

544  
Œª§ùiÚ
->
»£rved5
;

545 
	}
}

547 *
	$os_Œª§ùiÚ_g‘_»£rved6
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
) {

548 ià(
Œª§ùiÚ
 =ğ
NULL
)

549  
NULL
;

551  
Œª§ùiÚ
->
»£rved6
;

552 
	}
}

554 
	$__os_Œª§ùiÚ_£t_¡©e
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
¡©e_t
 
¡©e
) {

555 ià(
Œª§ùiÚ
 =ğ
NULL
)

556  
OSIP_BADPARAMETER
;

558 
Œª§ùiÚ
->
¡©e
 = state;

559  
OSIP_SUCCESS
;

560 
	}
}

562 
	$os_Œª§ùiÚ_£t_š_sock‘
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
sock
) {

563 ià(
Œª§ùiÚ
 =ğ
NULL
)

564  
OSIP_BADPARAMETER
;

566 
Œª§ùiÚ
->
š_sock‘
 = 
sock
;

567  
OSIP_SUCCESS
;

568 
	}
}

570 
	$os_Œª§ùiÚ_£t_out_sock‘
(
os_Œª§ùiÚ_t
 *
Œª§ùiÚ
, 
sock
) {

571 ià(
Œª§ùiÚ
 =ğ
NULL
)

572  
OSIP_BADPARAMETER
;

574 
Œª§ùiÚ
->
out_sock‘
 = 
sock
;

575  
OSIP_SUCCESS
;

576 
	}
}

578 
	$__os_Œª§ùiÚ_m©chšg_»¥Ú£_os_to_xiù_17_1_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»¥Ú£
) {

579 
os_g’”ic_·¿m_t
 *
b_»que¡
;

580 
os_g’”ic_·¿m_t
 *
b_»¥Ú£
;

581 
os_vŸ_t
 *
tİvŸ_»¥Ú£
;

584 ià(
Œ
 =ğ
NULL
 || (Œ->
iù_cÚ‹xt
 =ğNULL &&r->
niù_cÚ‹xt
 == NULL) ||

586 
»¥Ú£
 =ğ
NULL
 ||„e¥Ú£->
c£q
 =ğNULL ||„e¥Ú£->c£q->
m‘hod
 == NULL)

587  
OSIP_BADPARAMETER
;

589 
tİvŸ_»¥Ú£
 = 
	`os_li¡_g‘
(&
»¥Ú£
->
vŸs
, 0);

591 ià(
tİvŸ_»¥Ú£
 =ğ
NULL
) {

592 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA is‚ot compliant: missing‡ Via header!\n"));

593  
OSIP_SYNTAXERROR
;

596 
	`os_vŸ_·¿m_g‘_byÇme
(
Œ
->
tİvŸ
, "b¿nch", &
b_»que¡
);

598 ià(
b_»que¡
 =ğ
NULL
) {

599 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "You created‡ransaction without‡ny branch! THIS IS NOT ALLOWED\n"));

600  
OSIP_SYNTAXERROR
;

603 
	`os_vŸ_·¿m_g‘_byÇme
(
tİvŸ_»¥Ú£
, "b¿nch", &
b_»¥Ú£
);

605 ià(
b_»¥Ú£
 =ğ
NULL
) {

606 #ifdeà
FWDSUPPORT


609 ià(
	`äom_g_m©ch
(
Œ
->
äom
, 
»¥Ú£
->from) != 0)

610  
OSIP_UNDEFINED_ERROR
;

613 ià(
	`c£q_m©ch
(
Œ
->
c£q
, 
»¥Ú£
->cseq) != 0)

614  
OSIP_UNDEFINED_ERROR
;

617 ià(
»¥Ú£
->
to
->
u¾
->
u£ºame
 =ğ
NULL
 && 
Œ
->
äom
->url->username != NULL)

618  
OSIP_UNDEFINED_ERROR
;

620 ià(
»¥Ú£
->
to
->
u¾
->
u£ºame
 !ğ
NULL
 && 
Œ
->
äom
->url->username == NULL)

621  
OSIP_UNDEFINED_ERROR
;

623 ià(
»¥Ú£
->
to
->
u¾
->
u£ºame
 !ğ
NULL
 && 
Œ
->
äom
->url->username != NULL) {

624 ià(
	`¡rcmp
(
»¥Ú£
->
to
->
u¾
->
ho¡
, 
Œ
->
äom
->u¾->ho¡è|| sŒcmpÔe¥Ú£->to->u¾->
u£ºame
,r->from->url->username))

625  
OSIP_UNDEFINED_ERROR
;

628 ià(
	`¡rcmp
(
»¥Ú£
->
to
->
u¾
->
ho¡
, 
Œ
->
äom
->url->host))

629  
OSIP_UNDEFINED_ERROR
;

633 ià(
	`ÿÎ_id_m©ch
(
Œ
->
ÿÎid
, 
»¥Ú£
->
ÿÎ_id
) != 0)

634  
OSIP_UNDEFINED_ERROR
;

636  
OSIP_SUCCESS
;

638 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "Remote UA is‚ot compliant: missing‡ branch…arameter in Via header!\n"));

639  
OSIP_SYNTAXERROR
;

643 ià((
b_»que¡
->
gv®ue
 =ğ
NULL
è|| (
b_»¥Ú£
->gvalue == NULL)) {

644 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "Remote UA is‚ot compliant: missing‡ branch…arameter in Via header!\n"));

645  
OSIP_SYNTAXERROR
;

657 ià(0 !ğ
	`¡rcmp
(
b_»que¡
->
gv®ue
, 
b_»¥Ú£
->gvalue))

658  
OSIP_UNDEFINED_ERROR
;

668 ià(0 =ğ
	`¡rcmp
(
»¥Ú£
->
c£q
->
m‘hod
, 
Œ
->cseq->method))

669  
OSIP_SUCCESS
;

671  
OSIP_UNDEFINED_ERROR
;

672 
	}
}

674 
	$__os_Œª§ùiÚ_m©chšg_»que¡_os_to_xi¡_17_2_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»que¡
) {

675 
os_g’”ic_·¿m_t
 *
b_Üig»que¡
;

676 
os_g’”ic_·¿m_t
 *
b_»que¡
;

677 
os_vŸ_t
 *
tİvŸ_»que¡
;

678 
size_t
 
Ëngth_br
;

679 
size_t
 
Ëngth_br2
;

682 ià(
Œ
 =ğ
NULL
 || (Œ->
i¡_cÚ‹xt
 =ğNULL &&r->
ni¡_cÚ‹xt
 == NULL) ||

684 
»que¡
 =ğ
NULL
 ||„eque¡->
c£q
 =ğNULL ||„eque¡->c£q->
m‘hod
 == NULL)

685  
OSIP_BADPARAMETER
;

687 
tİvŸ_»que¡
 = 
	`os_li¡_g‘
(&
»que¡
->
vŸs
, 0);

689 ià(
tİvŸ_»que¡
 =ğ
NULL
) {

690 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Remote UA is‚ot compliant: missing‡ Via header!\n"));

691  
OSIP_SYNTAXERROR
;

694 
	`os_vŸ_·¿m_g‘_byÇme
(
tİvŸ_»que¡
, "b¿nch", &
b_»que¡
);

695 
	`os_vŸ_·¿m_g‘_byÇme
(
Œ
->
tİvŸ
, "b¿nch", &
b_Üig»que¡
);

697 ià((
b_Üig»que¡
 =ğ
NULL
 && 
b_»que¡
 != NULL) || (b_origrequest != NULL && b_request == NULL))

698  
OSIP_SYNTAXERROR
;

707 ià(
b_Üig»que¡
 !ğ
NULL
 && 
b_»que¡
 != NULL)

710 ià(!
b_Üig»que¡
->
gv®ue
)

711  
OSIP_UNDEFINED_ERROR
;

713 ià(!
b_»que¡
->
gv®ue
)

714  
OSIP_UNDEFINED_ERROR
;

716 
Ëngth_br
 = 
	`¡¾’
(
b_Üig»que¡
->
gv®ue
);

717 
Ëngth_br2
 = 
	`¡¾’
(
b_»que¡
->
gv®ue
);

719 ià(
Ëngth_br
 !ğ
Ëngth_br2
)

720  
OSIP_UNDEFINED_ERROR
;

723 ià(0 =ğ
	`¡ºcmp
(
b_Üig»que¡
->
gv®ue
, "z9hG4bK", 7è&& 0 =ğ¡ºcmp(
b_»que¡
->gvalue, "z9hG4bK", 7)) {

733 ià(0 !ğ
	`¡rcmp
(
b_Üig»que¡
->
gv®ue
, 
b_»que¡
->gvalue))

734  
OSIP_UNDEFINED_ERROR
;

738 *
b_pÜt
 = 
	`vŸ_g‘_pÜt
(
tİvŸ_»que¡
);

739 *
b_ÜigpÜt
 = 
	`vŸ_g‘_pÜt
(
Œ
->
tİvŸ
);

740 *
b_ho¡
 = 
	`vŸ_g‘_ho¡
(
tİvŸ_»que¡
);

741 *
b_Üigho¡
 = 
	`vŸ_g‘_ho¡
(
Œ
->
tİvŸ
);

743 ià((
b_ho¡
 =ğ
NULL
 || 
b_Üigho¡
 == NULL))

744  
OSIP_UNDEFINED_ERROR
;

746 ià(0 !ğ
	`¡rcmp
(
b_Üigho¡
, 
b_ho¡
))

747  
OSIP_UNDEFINED_ERROR
;

749 ià(
b_pÜt
 !ğ
NULL
 && 
b_ÜigpÜt
 =ğNULL && 0 !ğ
	`¡rcmp
(b_port, "5060"))

750  
OSIP_UNDEFINED_ERROR
;

752 ià(
b_ÜigpÜt
 !ğ
NULL
 && 
b_pÜt
 =ğNULL && 0 !ğ
	`¡rcmp
(b_origport, "5060"))

753  
OSIP_UNDEFINED_ERROR
;

755 ià(
b_ÜigpÜt
 !ğ
NULL
 && 
b_pÜt
 !ğNULL && 0 !ğ
	`¡rcmp
(b_origport, b_port))

756  
OSIP_UNDEFINED_ERROR
;

758 #ifdeà
AC_BUG


761 ià(0 !ğ
	`os_äom_g_m©ch
(
Œ
->
äom
, 
»que¡
->from))

762  
OSIP_UNDEFINED_ERROR
;

768 (!(0 =ğ
	`¡rcmp
(
Œ
->
c£q
->
m‘hod
, "INVITE"è&& 0 =ğ¡rcmp(
»que¡
->cseq->method, "ACK"))) && 0 != strcmp(tr->cseq->method,„equest->cseq->method))

769  
OSIP_UNDEFINED_ERROR
;

771  
OSIP_SUCCESS
;

776 ià(0 !ğ
	`os_ÿÎ_id_m©ch
(
Œ
->
ÿÎid
, 
»que¡
->
ÿÎ_id
))

777  
OSIP_UNDEFINED_ERROR
;

779 ià(
	`MSG_IS_ACK
(
»que¡
)) {

780 
os_g’”ic_·¿m_t
 *
g_äom1
;

781 
os_g’”ic_·¿m_t
 *
g_äom2
;

783 
	`os_äom_·¿m_g‘_byÇme
(
Œ
->
to
, "g", &
g_äom1
);

784 
	`os_äom_·¿m_g‘_byÇme
(
»que¡
->
to
, "g", &
g_äom2
);

786 ià(
g_äom1
 =ğ
NULL
 && 
g_äom2
 != NULL) {

789 } ià(
g_äom1
 !ğ
NULL
 && 
g_äom2
 == NULL) {

790  
OSIP_UNDEFINED_ERROR
;

793 ià(0 !ğ
	`os_to_g_m©ch
(
Œ
->
to
, 
»que¡
->to))

794  
OSIP_UNDEFINED_ERROR
;

798 ià(
Œ
->
Üig_»que¡
 =ğ
NULL
 ||r->Üig_»que¡->
to
 == NULL)

799  
OSIP_UNDEFINED_ERROR
;

801 ià(0 !ğ
	`os_to_g_m©ch
(
Œ
->
Üig_»que¡
->
to
, 
»que¡
->to))

802  
OSIP_UNDEFINED_ERROR
;

805 ià(0 !ğ
	`os_äom_g_m©ch
(
Œ
->
äom
, 
»que¡
->from))

806  
OSIP_UNDEFINED_ERROR
;

808 ià(0 !ğ
	`os_c£q_m©ch
(
Œ
->
c£q
, 
»que¡
->cseq))

809  
OSIP_UNDEFINED_ERROR
;

811 ià(0 !ğ
	`os_vŸ_m©ch
(
Œ
->
tİvŸ
, 
tİvŸ_»que¡
))

812  
OSIP_UNDEFINED_ERROR
;

814  
OSIP_SUCCESS
;

815 
	}
}

817 
os_ev’t_t
 *
	$__os_Œª§ùiÚ_Ãed_tim”_x_ev’t
(*
xixt
, 
timev®
 *
tim”
, 
cÚd_¡©e
, 
Œª§ùiÚid
, 
TIMER_VAL
) {

818 
timev®
 
now
;

820 
	`os_g‘timeofday
(&
now
, 
NULL
);

822 ià(
xixt
 =ğ
NULL
)

823  
NULL
;

825 ià(
cÚd_¡©e
) {

826 ià(
tim”
->
tv_£c
 == -1)

827  
NULL
;

829 ià(
	`os_tim”cmp
(&
now
, 
tim”
, >=))

830  
	`__os_ev’t_Ãw
(
TIMER_VAL
, 
Œª§ùiÚid
);

833  
NULL
;

834 
	}
}

836 
	$__os_Œª§ùiÚ_¢d_xxx
(
os_Œª§ùiÚ_t
 *
i¡
, 
os_mes§ge_t
 *
msg
) {

837 
os_t
 *
os
 = (os_ˆ*è
i¡
->
cÚfig
;

838 
os_vŸ_t
 *
vŸ
;

839 *
ho¡
;

840 
pÜt
;

841 
os_g’”ic_·¿m_t
 *
maddr
;

842 
os_g’”ic_·¿m_t
 *
»ûived
;

843 
os_g’”ic_·¿m_t
 *
½Üt
;

845 
vŸ
 = (
os_vŸ_t
 *è
	`os_li¡_g‘
(&
msg
->
vŸs
, 0);

847 ià(!
vŸ
)

848  
OSIP_SYNTAXERROR
;

850 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "maddr", &
maddr
);

851 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "»ûived", &
»ûived
);

852 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "½Üt", &
½Üt
);

859 ià(
maddr
 !ğ
NULL
)

860 
ho¡
 = 
maddr
->
gv®ue
;

865 ià(
»ûived
 !ğ
NULL
)

866 
ho¡
 = 
»ûived
->
gv®ue
;

869 
ho¡
 = 
vŸ
->host;

871 ià(
½Üt
 =ğ
NULL
 ||„pÜt->
gv®ue
 == NULL) {

872 ià(
vŸ
->
pÜt
 !ğ
NULL
)

873 
pÜt
 = 
	`os_©oi
(
vŸ
->port);

876 
pÜt
 = 5060;

879 
pÜt
 = 
	`os_©oi
(
½Üt
->
gv®ue
);

881  
os
->
	`cb_£nd_mes§ge
(
i¡
, 
msg
, 
ho¡
, 
pÜt
, i¡->
out_sock‘
);

882 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_condv.c

20 
	~<os2/š‹º®.h
>

22 #iâdeà
OSIP_MONOTHREAD


24 
	~<os·r£r2/os_pÜt.h
>

25 
	~<os2/os_mt.h
>

26 
	~<os2/os_cÚdv.h
>

28 #ià!
defšed
(
__¹ems__
è&& !defšed(
__VXWORKS_OS__
è&& !defšed(
__PSOS__
è&& !defšed(
WIN32
è&& !defšed(
_WIN32_WCE
è&& !defšed(
HAVE_PTHREAD_WIN32
è&& !defšed(
HAVE_PTHREAD
è&& !defšed(
HAVE_PTH_PTHREAD_H
)

29 #”rÜ 
No
 
th»ad
 
im¶em’tiÚ
 
found
!

32 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

37 
	~<±h»ad.h
>

39 
os_cÚd
 *
	$os_cÚd_š™
() {

40 
os_cÚd_t
 *
cÚd
 = (os_cÚd_ˆ*è
	`os_m®loc
((osip_cond_t));

42 ià(
cÚd
 && (
	`±h»ad_cÚd_š™
(&cÚd->
cv
, 
NULL
) == 0)) {

43  (
os_cÚd
 *è(
cÚd
);

46 
	`os_ä“
(
cÚd
);

48  
NULL
;

49 
	}
}

51 
	$os_cÚd_de¡roy
(
os_cÚd
 *
_cÚd
) {

52 
»t
;

54 ià(!
_cÚd
)

55  
OSIP_BADPARAMETER
;

57 
»t
 = 
	`±h»ad_cÚd_de¡roy
(&
_cÚd
->
cv
);

58 
	`os_ä“
(
_cÚd
);

59  
»t
;

60 
	}
}

62 
	$os_cÚd_sigÇl
(
os_cÚd
 *
_cÚd
) {

63 ià(!
_cÚd
)

64  
OSIP_BADPARAMETER
;

66  
	`±h»ad_cÚd_sigÇl
(&
_cÚd
->
cv
);

67 
	}
}

69 
	$os_cÚd_wa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
) {

70 ià(!
_cÚd
)

71  
OSIP_BADPARAMETER
;

73  
	`±h»ad_cÚd_wa™
(&
_cÚd
->
cv
, (
±h»ad_mu‹x_t
 *è
_mut
);

74 
	}
}

76 
	$os_cÚd_timedwa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
, cÚ¡ 
time¥ec
 *
ab¡ime
) {

77 ià(!
_cÚd
)

78  
OSIP_BADPARAMETER
;

80  
	`±h»ad_cÚd_timedwa™
(&
_cÚd
->
cv
, (
±h»ad_mu‹x_t
 *è
_mut
, (cÚ¡ 
time¥ec
 *è
ab¡ime
);

81 
	}
}

85 #ià
defšed
(
_WIN32_WCE
)

89 #ià
defšed
(
WIN32
è&& !defšed(
_WIN32_WCE
è&& !defšed(
HAVE_PTHREAD_WIN32
)

91 
	~<sys/ty³s.h
>

92 
	~<sys/timeb.h
>

94 
os_cÚd
 *
	$os_cÚd_š™
() {

95 
os_cÚd_t
 *
cÚd
 = (os_cÚd_ˆ*è
	`os_m®loc
((osip_cond_t));

97 ià(
cÚd
 && (cÚd->
mut
 = 
	`os_mu‹x_š™
()è!ğ
NULL
) {

98 
cÚd
->
£m
 = 
	`os_£m_š™
(0);

99  (
os_cÚd
 *è(
cÚd
);

102 
	`os_ä“
(
cÚd
);

104  
NULL
;

105 
	}
}

107 
	$os_cÚd_de¡roy
(
os_cÚd
 *
_cÚd
) {

108 ià(!
_cÚd
)

109  
OSIP_SUCCESS
;

111 ià(
_cÚd
->
£m
 =ğ
NULL
)

112  
OSIP_SUCCESS
;

114 
	`os_£m_de¡roy
(
_cÚd
->
£m
);

116 ià(
_cÚd
->
mut
 =ğ
NULL
)

117  
OSIP_SUCCESS
;

119 
	`os_mu‹x_de¡roy
(
_cÚd
->
mut
);

120 
	`os_ä“
(
_cÚd
);

122 
	}
}

124 
	$os_cÚd_sigÇl
(
os_cÚd
 *
_cÚd
) {

125 ià(!
_cÚd
)

126  
OSIP_BADPARAMETER
;

128  
	`os_£m_po¡
(
_cÚd
->
£m
);

129 
	}
}

131 
	$os_cÚd_wa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
) {

132 
»t1
 = 0, 
»t2
 = 0, 
»t3
 = 0;

133 
i
;

135 ià(!
_cÚd
)

136  
OSIP_BADPARAMETER
;

138 
i
 = 
	`os_mu‹x_lock
(
_cÚd
->
mut
);

140 ià(
i
 != 0)

141  
i
;

143 
i
 = 
	`os_mu‹x_uÆock
(
_mut
);

145 ià(
i
 != 0)

146  
i
;

148 
»t1
 = 
	`os_£m_wa™
(
_cÚd
->
£m
);

150 
»t2
 = 
	`os_mu‹x_lock
(
_mut
);

152 
»t3
 = 
	`os_mu‹x_uÆock
(
_cÚd
->
mut
);

154 ià(
»t1
)

155  
»t1
;

157 ià(
»t2
)

158  
»t2
;

160 ià(
»t3
)

161  
»t3
;

163  
OSIP_SUCCESS
;

164 
	}
}

166 
	#OSIP_CLOCK_REALTIME
 4002

	)

168 
	$__os_şock_g‘time
(
şock_id
, 
time¥ec
 *

) {

169 
_timeb
 
time_v®
;

171 ià(
şock_id
 !ğ
OSIP_CLOCK_REALTIME
)

172  
OSIP_BADPARAMETER
;

174 ià(

 =ğ
NULL
)

175  
OSIP_BADPARAMETER
;

177 
	`_áime
(&
time_v®
);

178 

->
tv_£c
 = (è
time_v®
.
time
;

179 

->
tv_n£c
 = 
time_v®
.
ml™m
 * 1000000;

180  
OSIP_SUCCESS
;

181 
	}
}

183 
	$_d–_time
(cÚ¡ 
time¥ec
 *
¡¬t
, cÚ¡ time¥eø*
’d
) {

184 
difx
;

186 ià(
¡¬t
 =ğ
NULL
 || 
’d
 == NULL)

187  
OSIP_SUCCESS
;

189 
difx
 = ((
’d
->
tv_£c
 - 
¡¬t
->tv_£cè* 1000è+ (Ónd->
tv_n£c
 - start->tv_nsec) / 1000000);

191  
difx
;

192 
	}
}

194 
	$os_cÚd_timedwa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
, cÚ¡ 
time¥ec
 *
ab¡ime
) {

195 
DWORD
 
dwR‘
;

196 
time¥ec
 
now
;

197 
timeout_ms
;

198 
HANDLE
 
£m
;

199 
i
;

201 ià(!
_cÚd
)

202  
OSIP_BADPARAMETER
;

204 
£m
 = *((
HANDLE
 *è
_cÚd
->sem);

206 ià(
£m
 =ğ
NULL
)

207  
OSIP_UNDEFINED_ERROR
;

209 ià(
ab¡ime
 =ğ
NULL
)

210  
OSIP_BADPARAMETER
;

212 
	`__os_şock_g‘time
(
OSIP_CLOCK_REALTIME
, &
now
);

214 
timeout_ms
 = 
	`_d–_time
(&
now
, 
ab¡ime
);

216 ià(
timeout_ms
 <= 0)

219 
i
 = 
	`os_mu‹x_uÆock
(
_mut
);

221 ià(
i
 != 0)

222  
i
;

224 
dwR‘
 = 
	`Wa™FÜSšgËObjeùEx
(
£m
, 
timeout_ms
, 
FALSE
);

226 
i
 = 
	`os_mu‹x_lock
(
_mut
);

228 ià(
i
 != 0)

229  
i
;

231 
dwR‘
) {

232 
WAIT_OBJECT_0
:

233  
OSIP_SUCCESS
;

236 
WAIT_TIMEOUT
:

241  
OSIP_UNDEFINED_ERROR
;

244 
	}
}

247 #ifdeà
__PSOS__


251 #ifdeà
__VXWORKS_OS__


252 
os_cÚd
 *
	$os_cÚd_š™
() {

253 
os_cÚd_t
 *
cÚd
 = (os_cÚd_ˆ*è
	`os_m®loc
((osip_cond_t));

255 ià((
cÚd
->
£m
 = 
	`os_£m_š™
(0)è!ğ
NULL
) {

256  (
os_cÚd
 *è(
cÚd
);

259 
	`os_ä“
(
cÚd
);

261  
NULL
;

262 
	}
}

264 
	$os_cÚd_de¡roy
(
os_cÚd
 *
_cÚd
) {

265 ià(
_cÚd
->
£m
 =ğ
NULL
)

266  
OSIP_SUCCESS
;

268 
	`os_£m_de¡roy
(
_cÚd
->
£m
);

269 
	`os_ä“
(
_cÚd
);

271 
	}
}

273 
	$os_cÚd_sigÇl
(
os_cÚd
 *
_cÚd
) {

274  
	`os_£m_po¡
(
_cÚd
->
£m
);

275 
	}
}

277 + 
	$_cÚd_wa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
, 
ticks
) {

278 
»t
;

280 ià(
_cÚd
 =ğ
NULL
)

281  
OSIP_BADPARAMETER
;

283 
»t
 = 
	`os_mu‹x_uÆock
(
_mut
);

285 ià(
»t
 != 0) {

286  
»t
;

289 
»t
 = 
	`£mTake
(((
os_£m_t
 *è
_cÚd
->
£m
)->
£mId
, 
ticks
);

291 ià(
»t
 !ğ
OK
) {

292 
”ºo
) {

293 
S_objLib_OBJ_ID_ERROR
:

296 
S_objLib_OBJ_UNAVAILABLE
:

299 
S_štLib_NOT_ISR_CALLABLE
:

301 
»t
 = 
OSIP_UNDEFINED_ERROR
;

304 
S_objLib_OBJ_TIMEOUT
:

305 
»t
 = 1;

309 
»t
 = 1;

314 
i
 = 
	`os_mu‹x_lock
(
_mut
);

316 ià(
i
 != 0) {

317 
»t
 = 
i
;

320  
»t
;

321 
	}
}

323 
	$os_cÚd_wa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
) {

324  
	`_cÚd_wa™
(
_cÚd
, 
_mut
, 
WAIT_FOREVER
);

325 
	}
}

327 
	$os_cÚd_timedwa™
(
os_cÚd
 *
_cÚd
, 
os_mu‹x
 *
_mut
, cÚ¡ 
time¥ec
 *
ab¡ime
) {

328 
¿‹
 = 
	`sysClkR©eG‘
();

329 
time¥ec
 
now
;

330 
£c
, 
n£c
;

331 
ticks
;

332 
SEM_ID
 
£m
;

334 ià(
_cÚd
 =ğ
NULL
)

335  
OSIP_BADPARAMETER
;

337 
£m
 = ((
os_£m_t
 *è
_cÚd
->£m)->
£mId
;

339 ià(
£m
 =ğ
NULL
)

340  
OSIP_UNDEFINED_ERROR
;

342 ià(
ab¡ime
 =ğ
NULL
)

343  
OSIP_BADPARAMETER
;

345 
	`şock_g‘time
(
CLOCK_REALTIME
, &
now
);

347 
£c
 = 
ab¡ime
->
tv_£c
 - 
now
.tv_sec;

348 
n£c
 = 
ab¡ime
->
tv_n£c
 - 
now
.tv_nsec;

350 (
£c
 > 0è&& (
n£c
 < 0)) {

351 --
£c
;

352 
n£c
 += 1000000000;

355 ià(
n£c
 < 0)

358 
ticks
 = (
£c
 * 
¿‹
è+ (
n£c
 / 1000 *„ate / 1000000);

360  
	`_cÚd_wa™
(
_cÚd
, 
_mut
, 
ticks
);

361 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_fifo.c

20 
	~<os2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os2/os_fifo.h
>

27 
	$os_fifo_š™
(
os_fifo_t
 *
ff
) {

28 #iâdeà
OSIP_MONOTHREAD


29 
ff
->
qi¦ocked
 = 
	`os_mu‹x_š™
();

31 
ff
->
qi£m±y
 = 
	`os_£m_š™
(0);

33 
	`os_li¡_š™
(&
ff
->
queue
);

35 
ff
->
¡©e
 = 
os_em±y
;

36 
	}
}

38 
	$os_fifo_add
(
os_fifo_t
 *
ff
, *
–
) {

39 #iâdeà
OSIP_MONOTHREAD


40 
	`os_mu‹x_lock
(
ff
->
qi¦ocked
);

43 
	`os_li¡_add
(&
ff
->
queue
, 
–
, -1);

44 
ff
->
¡©e
 = 
os_ok
;

46 #iâdeà
OSIP_MONOTHREAD


47 
	`os_£m_po¡
(
ff
->
qi£m±y
);

48 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$os_fifo_š£¹
(
os_fifo_t
 *
ff
, *
–
) {

54 #iâdeà
OSIP_MONOTHREAD


55 
	`os_mu‹x_lock
(
ff
->
qi¦ocked
);

58 
	`os_li¡_add
(&
ff
->
queue
, 
–
, 0);

59 
ff
->
¡©e
 = 
os_ok
;

61 #iâdeà
OSIP_MONOTHREAD


62 
	`os_£m_po¡
(
ff
->
qi£m±y
);

63 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$os_fifo_size
(
os_fifo_t
 *
ff
) {

69 
i
;

71 #iâdeà
OSIP_MONOTHREAD


72 
	`os_mu‹x_lock
(
ff
->
qi¦ocked
);

75 
i
 = 
	`os_li¡_size
(&
ff
->
queue
);

76 #iâdeà
OSIP_MONOTHREAD


77 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

79  
i
;

80 
	}
}

82 *
	$os_fifo_g‘
(
os_fifo_t
 *
ff
) {

83 *
–
 = 
NULL
;

85 #iâdeà
OSIP_MONOTHREAD


86 
i
 = 
	`os_£m_wa™
(
ff
->
qi£m±y
);

88 ià(
i
 != 0)

89  
NULL
;

91 
	`os_mu‹x_lock
(
ff
->
qi¦ocked
);

94 ià(
ff
->
¡©e
 !ğ
os_em±y
) {

95 
–
 = 
	`os_li¡_g‘
(&
ff
->
queue
, 0);

96 
	`os_li¡_»move
(&
ff
->
queue
, 0);

100 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "noƒlement in fifo.\n"));

101 #iâdeà
OSIP_MONOTHREAD


102 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

104  
OSIP_SUCCESS
;

108 ià(
	`os_li¡_size
(&
ff
->
queue
) <= 0)

109 
ff
->
¡©e
 = 
os_em±y
;

112 
ff
->
¡©e
 = 
os_ok
;

114 #iâdeà
OSIP_MONOTHREAD


115 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

117  
–
;

118 
	}
}

120 *
	$os_fifo_Œyg‘
(
os_fifo_t
 *
ff
) {

121 *
–
 = 
NULL
;

123 #iâdeà
OSIP_MONOTHREAD


125 ià(0 !ğ
	`os_£m_Œywa™
(
ff
->
qi£m±y
)) {

126  
NULL
;

129 
	`os_mu‹x_lock
(
ff
->
qi¦ocked
);

132 ià(
ff
->
¡©e
 =ğ
os_em±y
)

133  
NULL
;

137 ià(
ff
->
¡©e
 !ğ
os_em±y
) {

138 
–
 = 
	`os_li¡_g‘
(&
ff
->
queue
, 0);

139 
	`os_li¡_»move
(&
ff
->
queue
, 0);

143 #iâdeà
OSIP_MONOTHREAD


146 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "noƒlement in fifo.\n"));

147 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

148  
OSIP_SUCCESS
;

154 ià(
	`os_li¡_size
(&
ff
->
queue
) <= 0)

155 
ff
->
¡©e
 = 
os_em±y
;

158 
ff
->
¡©e
 = 
os_ok
;

160 #iâdeà
OSIP_MONOTHREAD


161 
	`os_mu‹x_uÆock
(
ff
->
qi¦ocked
);

163  
–
;

164 
	}
}

166 
	$os_fifo_ä“
(
os_fifo_t
 *
ff
) {

167 ià(
ff
 =ğ
NULL
)

170 #iâdeà
OSIP_MONOTHREAD


171 
	`os_mu‹x_de¡roy
(
ff
->
qi¦ocked
);

173 
	`os_£m_de¡roy
(
ff
->
qi£m±y
);

175 
	`os_ä“
(
ff
);

176 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_sema.c

20 
	~<os2/š‹º®.h
>

22 #iâdeà
OSIP_MONOTHREAD


24 
	~<os·r£r2/os_pÜt.h
>

25 
	~<os2/os_mt.h
>

27 #ià
defšed
(
__¹ems__
)

28 
	~<¹ems.h
>

31 #ià!
defšed
(
__VXWORKS_OS__
è&& !defšed(
__PSOS__
è&& !defšed(
WIN32
è&& !defšed(
_WIN32_WCE
è&& !defšed(
HAVE_PTHREAD_WIN32
è&& !defšed(
HAVE_PTHREAD
è&& !defšed(
HAVE_PTH_PTHREAD_H
è&& !defšed(
__¹ems__
)

32 #”rÜ 
No
 
th»ad
 
im¶em’tiÚ
 
found
!

35 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

37 
os_mu‹x
 *
	$os_mu‹x_š™
() {

38 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
	`os_m®loc
((osip_mutex_t));

40 ià(
mut
 =ğ
NULL
)

41  
NULL
;

43 
	`±h»ad_mu‹x_š™
(
mut
, 
NULL
);

44  (
os_mu‹x
 *è
mut
;

45 
	}
}

47 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

48 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

50 ià(
mut
 =ğ
NULL
)

53 
	`±h»ad_mu‹x_de¡roy
(
mut
);

54 
	`os_ä“
(
mut
);

55 
	}
}

57 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

58 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

60 ià(
mut
 =ğ
NULL
)

61  
OSIP_BADPARAMETER
;

63  
	`±h»ad_mu‹x_lock
(
mut
);

64 
	}
}

66 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

67 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

69 ià(
mut
 =ğ
NULL
)

70  
OSIP_BADPARAMETER
;

72  
	`±h»ad_mu‹x_uÆock
(
mut
);

73 
	}
}

77 #ià
defšed
(
__¬c__
)

80 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

81 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

83 ià(
£m
 =ğ
NULL
)

84  
NULL
;

86 
£m
->
_£m_couÁ”
 = 0;

87 
£m
->
_£m_mu‹x
 = 
	`os_mu‹x_š™
();

89 ià(
£m
->
_£m_mu‹x
 !ğ
NULL
)

90  (
os_£m
 *è
£m
;

92 
	`os_ä“
(
£m
);

93  
NULL
;

94 
	}
}

96 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

97 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

99 ià(
£m
 =ğ
NULL
)

100  
OSIP_SUCCESS
;

102 
	`os_mu‹x_de¡roy
(
£m
->
_£m_mu‹x
);

103 
	`os_ä“
(
£m
);

104  
OSIP_SUCCESS
;

105 
	}
}

107 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

108 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

110 ià(
£m
 =ğ
NULL
)

111  
OSIP_BADPARAMETER
;

113 
	`os_mu‹x_lock
(
£m
->
_£m_mu‹x
);

114 
£m
->
_£m_couÁ”
++;

115 
	`os_mu‹x_uÆock
(
£m
->
_£m_mu‹x
);

116  
OSIP_SUCCESS
;

117 
	}
}

119 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

120 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

122 ià(
£m
 =ğ
NULL
)

123  
OSIP_BADPARAMETER
;

127 
	`os_mu‹x_lock
(
£m
->
_£m_mu‹x
);

129 ià(
£m
->
_£m_couÁ”
 > 0) {

130 
£m
->
_£m_couÁ”
--;

131 
	`os_mu‹x_uÆock
(
£m
->
_£m_mu‹x
);

132  
OSIP_SUCCESS
;

135 
	`os_mu‹x_uÆock
(
£m
->
_£m_mu‹x
);

136 
	`os_u¦“p
(1000);

139  
OSIP_UNDEFINED_ERROR
;

140 
	}
}

142 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

143 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

145 ià(
£m
 =ğ
NULL
)

146  
OSIP_BADPARAMETER
;

148 
	`os_mu‹x_lock
(
£m
->
_£m_mu‹x
);

150 ià(
£m
->
_£m_couÁ”
 > 0) {

151 
£m
->
_£m_couÁ”
--;

152 
	`os_mu‹x_uÆock
(
£m
->
_£m_mu‹x
);

153  
OSIP_SUCCESS
;

156 
	`os_mu‹x_uÆock
(
£m
->
_£m_mu‹x
);

157  
OSIP_UNDEFINED_ERROR
;

158 
	}
}

160 #–ià(
defšed
(
HAVE_SEMAPHORE_H
è&& !defšed(
__APPLE_CC__
)è|| defšed(
HAVE_PTHREAD_WIN32
)

163 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

164 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

166 ià(
£m
 =ğ
NULL
)

167  
NULL
;

169 ià(
	`£m_š™
(
£m
, 0, 
v®ue
) == 0)

170  (
os_£m
 *è
£m
;

172 
	`os_ä“
(
£m
);

173  
NULL
;

174 
	}
}

176 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

177 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

179 ià(
£m
 =ğ
NULL
)

180  
OSIP_SUCCESS
;

182 
	`£m_de¡roy
(
£m
);

183 
	`os_ä“
(
£m
);

184  
OSIP_SUCCESS
;

185 
	}
}

187 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

188 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

190 ià(
£m
 =ğ
NULL
)

191  
OSIP_BADPARAMETER
;

193  
	`£m_po¡
(
£m
);

194 
	}
}

196 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

197 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

199 ià(
£m
 =ğ
NULL
)

200  
OSIP_BADPARAMETER
;

202  
	`£m_wa™
(
£m
);

203 
	}
}

205 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

206 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

208 ià(
£m
 =ğ
NULL
)

209  
OSIP_BADPARAMETER
;

211  
	`£m_Œywa™
(
£m
);

212 
	}
}

214 #–ià
defšed
(
__APPLE_CC__
)

215 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

216 
sk_t
 
sk
 = 
	`mach_sk_£lf
();

217 
pŞicy
 = 
SYNC_POLICY_FIFO
;

218 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

220 ià(
£m
 =ğ
NULL
)

221  
NULL
;

223 ià(
	`£m­hÜe_ü—‹
(
sk
, &
£m
->
£mid
, 
pŞicy
, 
v®ue
è=ğ
KERN_SUCCESS
)

224  (
os_£m
 *è
£m
;

226 
	`os_ä“
(
£m
);

227  
NULL
;

228 
	}
}

230 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

231 
sk_t
 
sk
 = 
	`mach_sk_£lf
();

232 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

234 ià(
£m
 =ğ
NULL
)

235  
OSIP_SUCCESS
;

237 ià(
	`£m­hÜe_de¡roy
(
sk
, 
£m
->
£mid
è=ğ
KERN_SUCCESS
) {

238 
	`os_ä“
(
£m
);

239  
OSIP_SUCCESS
;

242 
	`os_ä“
(
£m
);

243  
OSIP_SUCCESS
;

244 
	}
}

246 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

247 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

249 ià(
£m
 =ğ
NULL
)

250  
OSIP_BADPARAMETER
;

252 ià(
	`£m­hÜe_sigÇl
(
£m
->
£mid
è=ğ
KERN_SUCCESS
)

253  
OSIP_SUCCESS
;

255  
OSIP_UNDEFINED_ERROR
;

256 
	}
}

258 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

259 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

261 ià(
£m
 =ğ
NULL
)

262  
OSIP_BADPARAMETER
;

264 ià(
	`£m­hÜe_wa™
(
£m
->
£mid
è=ğ
KERN_SUCCESS
)

265  
OSIP_SUCCESS
;

267  
OSIP_UNDEFINED_ERROR
;

268 
	}
}

270 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

271 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

273 ià(
£m
 =ğ
NULL
)

274  
OSIP_BADPARAMETER
;

276 
mach_time¥ec_t
 
wa™_time
 = {0, 0};

278 ià(
	`£m­hÜe_timedwa™
(
£m
->
£mid
, 
wa™_time
è=ğ
KERN_SUCCESS
)

279  
OSIP_SUCCESS
;

281  
OSIP_UNDEFINED_ERROR
;

282 
	}
}

284 #–ià
defšed
(
HAVE_SYS_SEM_H
)

287 
	#SEM_PERM
 0600

	)

289 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

290 
£mun
 
v®
;

291 
i
;

292 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

294 ià(
£m
 =ğ
NULL
)

295  
NULL
;

297 
£m
->
£mid
 = 
	`£mg‘
(
IPC_PRIVATE
, 1, 
IPC_CREAT
 | 
SEM_PERM
);

299 ià(
£m
->
£mid
 == -1) {

300 
	`³¼Ü
("semgetƒrror");

301 
	`os_ä“
(
£m
);

302  
NULL
;

305 
v®
.v® = (è
v®ue
;

306 
i
 = 
	`£mùl
(
£m
->
£mid
, 0, 
SETVAL
, 
v®
);

308 ià(
i
 != 0) {

309 
	`³¼Ü
("semctlƒrror");

310 
	`os_ä“
(
£m
);

311  
NULL
;

314  (
os_£m
 *è
£m
;

315 
	}
}

317 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

318 
£mun
 
v®
;

319 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

321 ià(
£m
 =ğ
NULL
)

322  
OSIP_SUCCESS
;

324 
v®
.val = 0;

325 
	`£mùl
(
£m
->
£mid
, 0, 
IPC_RMID
, 
v®
);

326 
	`os_ä“
(
£m
);

327  
OSIP_SUCCESS
;

328 
	}
}

330 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

331 
£mbuf
 
sb
;

332 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

334 ià(
£m
 =ğ
NULL
)

335  
OSIP_BADPARAMETER
;

337 
sb
.
£m_num
 = 0;

338 
sb
.
£m_İ
 = 1;

339 
sb
.
£m_æg
 = 0;

340  
	`£mİ
(
£m
->
£mid
, &
sb
, 1);

341 
	}
}

343 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

344 
£mbuf
 
sb
;

345 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

347 ià(
£m
 =ğ
NULL
)

348  
OSIP_BADPARAMETER
;

350 
sb
.
£m_num
 = 0;

351 
sb
.
£m_İ
 = -1;

352 
sb
.
£m_æg
 = 0;

353  
	`£mİ
(
£m
->
£mid
, &
sb
, 1);

354 
	}
}

356 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

357 
£mbuf
 
sb
;

358 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

360 ià(
£m
 =ğ
NULL
)

361  
OSIP_BADPARAMETER
;

363 
sb
.
£m_num
 = 0;

364 
sb
.
£m_İ
 = -1;

365 
sb
.
£m_æg
 = 
IPC_NOWAIT
;

366  
	`£mİ
(
£m
->
£mid
, &
sb
, 1);

367 
	}
}

372 #ifdeà
__VXWORKS_OS__


374 
os_mu‹x
 *
	$os_mu‹x_š™
() {

375  (
os_mu‹x
 *è
	`£mMC»©e
(
SEM_Q_FIFO
 | 
SEM_DELETE_SAFE
);

376 
	}
}

378 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

379 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

381 ià(
mut
 =ğ
NULL
)

384 
	`£mD–‘e
(
mut
);

385 
	}
}

387 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

388 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

390 ià(
mut
 =ğ
NULL
)

391  
OSIP_BADPARAMETER
;

393  
	`£mTake
(
mut
, 
WAIT_FOREVER
);

394 
	}
}

396 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

397 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

399 ià(
mut
 =ğ
NULL
)

400  
OSIP_BADPARAMETER
;

402  
	`£mGive
(
mut
);

403 
	}
}

405 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

406 
SEM_ID
 
š™£m
;

407 
os_£m_t
 *
x
;

409 
x
 = (
os_£m_t
 *è
	`os_m®loc
((osip_sem_t));

411 ià(
x
 =ğ
NULL
)

412  
NULL
;

414 
š™£m
 = 
	`£mCC»©e
(
SEM_Q_FIFO
, 
v®ue
);

415 
x
->
£mId
 = 
š™£m
;

416 
x
->
»fCÁ
 = 
v®ue
;

417 
x
->
£m_Çme
 = 
NULL
;

418  (
os_£m
 *è
x
;

419 
	}
}

421 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

422 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

424 ià(
£m
 =ğ
NULL
)

425  
OSIP_SUCCESS
;

427 
	`£mD–‘e
(
£m
->
£mId
);

428 
	`os_ä“
(
£m
);

429  
OSIP_SUCCESS
;

430 
	}
}

432 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

433 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

435 ià(
£m
 =ğ
NULL
)

436  
OSIP_BADPARAMETER
;

438  
	`£mGive
(
£m
->
£mId
);

439 
	}
}

441 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

442 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

444 ià(
£m
 =ğ
NULL
)

445  
OSIP_BADPARAMETER
;

447  
	`£mTake
(
£m
->
£mId
, 
WAIT_FOREVER
);

448 
	}
}

450 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

451 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

453 ià(
£m
 =ğ
NULL
)

454  
OSIP_BADPARAMETER
;

456  
	`£mTake
(
£m
->
£mId
, 
NO_WAIT
);

457 
	}
}

461 #ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

462 
	~<lim™s.h
>

464 #ià(
_WIN32_WINNT
 >ğ0x0403è&& !
defšed
(
_WIN32_WCE
)

465 
os_mu‹x
 *
	$os_mu‹x_š™
() {

466 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
	`os_m®loc
((osip_mutex_t));

468 ià(
mut
 =ğ
NULL
)

469  
NULL
;

471 #ià
	`defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

473 ià(
	`In™ŸlizeCr™iÿlSeùiÚEx
(&
mut
->
h
, 
OSIP_CRITICALSECTION_SPIN
, 
CRITICAL_SECTION_NO_DEBUG_INFO
) != 0) {

474  (
os_mu‹x
 *è(
mut
);

479 ià(
	`In™ŸlizeCr™iÿlSeùiÚAndSpšCouÁ
(&
mut
->
h
, 
OSIP_CRITICALSECTION_SPIN
) != 0)

480  (
os_mu‹x
 *è(
mut
);

483 
	`os_ä“
(
mut
);

484  (
NULL
);

485 
	}
}

487 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

488 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

490 ià(
mut
 =ğ
NULL
)

493 
	`D–‘eCr™iÿlSeùiÚ
(&
mut
->
h
);

494 
	`os_ä“
(
mut
);

495 
	}
}

497 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

498 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

500 ià(
mut
 =ğ
NULL
)

501  
OSIP_BADPARAMETER
;

503 
	`EÁ”Cr™iÿlSeùiÚ
(&
mut
->
h
);

506 
	}
}

508 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

509 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

511 ià(
mut
 =ğ
NULL
)

512  
OSIP_BADPARAMETER
;

514 
	`L—veCr™iÿlSeùiÚ
(&
mut
->
h
);

516 
	}
}

519 
os_mu‹x
 *
	$os_mu‹x_š™
() {

520 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
	`os_m®loc
((osip_mutex_t));

522 ià(
mut
 =ğ
NULL
)

523  
NULL
;

525 ià((
mut
->
h
 = 
	`C»©eMu‹x
(
NULL
, 
FALSE
, NULL)) != NULL)

526  (
os_mu‹x
 *è(
mut
);

528 
	`os_ä“
(
mut
);

529  (
NULL
);

530 
	}
}

532 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

533 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

535 ià(
mut
 =ğ
NULL
)

538 
	`Clo£HªdË
(
mut
->
h
);

539 
	`os_ä“
(
mut
);

540 
	}
}

542 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

543 
DWORD
 
”r
;

544 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

546 ià(
mut
 =ğ
NULL
)

547  
OSIP_BADPARAMETER
;

549 ià((
”r
 = 
	`Wa™FÜSšgËObjeù
(
mut
->
h
, 
INFINITE
)è=ğ
WAIT_OBJECT_0
)

553 
	}
}

555 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

556 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

558 ià(
mut
 =ğ
NULL
)

559  
OSIP_BADPARAMETER
;

561 
	`R–—£Mu‹x
(
mut
->
h
);

563 
	}
}

566 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

567 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

569 ià(
£m
 =ğ
NULL
)

570  
NULL
;

572 #ià
	`defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

574 ià((
£m
->
h
 = 
	`C»©eSem­hÜeExW
(
NULL
, 
v®ue
, 
LONG_MAX
, NULL, 0, (
STANDARD_RIGHTS_REQUIRED
 | 
SYNCHRONIZE
 | 
SEMAPHORE_MODIFY_STATE
))) != NULL)

575  (
os_£m
 *è(
£m
);

579 ià((
£m
->
h
 = 
	`C»©eSem­hÜe
(
NULL
, 
v®ue
, 
LONG_MAX
, NULL)) != NULL)

580  (
os_£m
 *è(
£m
);

583 
	`os_ä“
(
£m
);

584  (
NULL
);

585 
	}
}

587 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

588 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

590 ià(
£m
 =ğ
NULL
)

591  
OSIP_SUCCESS
;

593 
	`Clo£HªdË
(
£m
->
h
);

594 
	`os_ä“
(
£m
);

596 
	}
}

598 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

599 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

601 ià(
£m
 =ğ
NULL
)

602  
OSIP_BADPARAMETER
;

604 
	`R–—£Sem­hÜe
(
£m
->
h
, 1, 
NULL
);

606 
	}
}

608 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

609 
DWORD
 
”r
;

610 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

612 ià(
£m
 =ğ
NULL
)

613  
OSIP_BADPARAMETER
;

615 ià((
”r
 = 
	`Wa™FÜSšgËObjeùEx
(
£m
->
h
, 
INFINITE
, 
FALSE
)è=ğ
WAIT_OBJECT_0
)

618 ià(
”r
 =ğ
WAIT_TIMEOUT
)

622 
	}
}

624 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

625 
DWORD
 
”r
;

626 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

628 ià(
£m
 =ğ
NULL
)

629  
OSIP_BADPARAMETER
;

631 ià((
”r
 = 
	`Wa™FÜSšgËObjeùEx
(
£m
->
h
, 0, 
FALSE
)è=ğ
WAIT_OBJECT_0
)

635 
	}
}

638 #ifdeà
__PSOS__


639 
os_mu‹x
 *
	$os_mu‹x_š™
() {

640 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
	`os_m®loc
((osip_mutex_t));

642 ià(
	`sm_ü—‹
("mut", 1, 0, &
mut
->
id
) == 0)

643  (
os_mu‹x
 *è(
mut
);

645 
	`os_ä“
(
mut
);

646  (
NULL
);

647 
	}
}

649 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

650 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

652 ià(
mut
) {

653 
	`sm_d–‘e
(
mut
->
id
);

654 
	`os_ä“
(
mut
);

656 
	}
}

658 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

659 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

661 ià(
mut
) {

662 ià(
	`sm_p
(
mut
->
id
, 
SM_WAIT
, 0) != 0)

663  
OSIP_UNDEFINED_ERROR
;

667 
	}
}

669 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

670 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

672 ià(
mut
) {

673 
	`sm_v
(
mut
->
id
);

677 
	}
}

679 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

680 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

682 ià(
	`sm_ü—‹
("£m", 
v®ue
, 0, &
£m
->
id
) == 0)

683  (
os_£m
 *è(
£m
);

685 
	`os_ä“
(
£m
);

686  (
NULL
);

687 
	}
}

689 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

690 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

692 ià(
£m
 =ğ
NULL
)

693  
OSIP_SUCCESS
;

695 
	`sm_d–‘e
(
£m
->
id
);

696 
	`os_ä“
(
£m
);

698 
	}
}

700 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

701 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

703 ià(
£m
 =ğ
NULL
)

704  
OSIP_BADPARAMETER
;

706  (
	`sm_v
(
£m
->
id
));

707 
	}
}

709 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

710 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

712 ià(
£m
 =ğ
NULL
)

713  
OSIP_BADPARAMETER
;

715 ià(
	`sm_p
(
£m
->
id
, 
SM_WAIT
, 0) != 0)

719 
	}
}

721 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

722 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

724 ià(
£m
 =ğ
NULL
)

725  
OSIP_BADPARAMETER
;

727 ià(
	`sm_p
(
£m
->
id
, 
SM_NOWAIT
, 0) != 0)

728  
OSIP_UNDEFINED_ERROR
;

731 
	}
}

735 #ià
defšed
(
__¹ems__
)

737 
os_mu‹x
 *
	$os_mu‹x_š™
() {

738 
¹ems_¡©us_code
 
¡©us
;

739 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
	`os_m®loc
((osip_mutex_t));

741 
¡©us
 = 
	`¹ems_£m­hÜe_ü—‹
(
	`¹ems_bud_Çme
('s', 'i', 'p', 'M'), 1,

742 
RTEMS_SIMPLE_BINARY_SEMAPHORE
, 0, &
mut
->
id
);

744 ià(
¡©us
 =ğ
RTEMS_SUCCESSFUL
) {

745  (
os_mu‹x
 *è(
mut
);

748 
	`os_ä“
(
mut
);

749  (
NULL
);

750 
	}
}

752 
	$os_mu‹x_de¡roy
(
os_mu‹x
 *
_mut
) {

753 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

755 ià(
mut
 !ğ
NULL
) {

756 
	`¹ems_£m­hÜe_d–‘e
(
mut
->
id
);

757 
	`os_ä“
(
mut
);

759 
	}
}

761 
	$os_mu‹x_lock
(
os_mu‹x
 *
_mut
) {

762 
¹ems_¡©us_code
 
¡©us
;

763 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

765 ià(
mut
 !ğ
NULL
) {

766 
¡©us
 = 
	`¹ems_£m­hÜe_obš
(
mut
->
id
, 
RTEMS_WAIT
, 
RTEMS_NO_TIMEOUT
);

768 ià(
¡©us
 !ğ
RTEMS_SUCCESSFUL
) {

769  
OSIP_UNDEFINED_ERROR
;

773  
OSIP_SUCCESS
;

774 
	}
}

776 
	$os_mu‹x_uÆock
(
os_mu‹x
 *
_mut
) {

777 
os_mu‹x_t
 *
mut
 = (os_mu‹x_ˆ*è
_mut
;

779 ià(
mut
 !ğ
NULL
) {

780 (è
	`¹ems_£m­hÜe_»Ëa£
(
mut
->
id
);

784 
	}
}

786 
os_£m
 *
	$os_£m_š™
(
v®ue
) {

787 
¹ems_¡©us_code
 
¡©us
;

789 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
	`os_m®loc
((osip_sem_t));

791 
¡©us
 = 
	`¹ems_£m­hÜe_ü—‹
(
	`¹ems_bud_Çme
('s', 'i', 'p', 'S'), 
v®ue
, 
RTEMS_COUNTING_SEMAPHORE
, 0, &
£m
->
id
);

793 ià(
¡©us
 =ğ
RTEMS_SUCCESSFUL
) {

794  (
os_£m
 *è(
£m
);

797 
	`os_ä“
(
£m
);

798  (
NULL
);

799 
	}
}

801 
	$os_£m_de¡roy
(
os_£m
 *
_£m
) {

802 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

804 ià(
£m
 =ğ
NULL
) {

805  
OSIP_SUCCESS
;

808 
	`¹ems_£m­hÜe_d–‘e
(
£m
->
id
);

809 
	`os_ä“
(
£m
);

811 
	}
}

813 
	$os_£m_po¡
(
os_£m
 *
_£m
) {

814 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

816 ià(
£m
 =ğ
NULL
) {

817  
OSIP_UNDEFINED_ERROR
;

820  
	`¹ems_£m­hÜe_»Ëa£
(
£m
->
id
);

821 
	}
}

823 
	$os_£m_wa™
(
os_£m
 *
_£m
) {

824 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

826 ià(
£m
 =ğ
NULL
) {

827  
OSIP_BADPARAMETER
;

830 ià(
	`¹ems_£m­hÜe_obš
(
£m
->
id
, 
RTEMS_WAIT
, 
RTEMS_NO_TIMEOUT
è!ğ
RTEMS_SUCCESSFUL
) {

831  
OSIP_UNDEFINED_ERROR
;

835 
	}
}

837 
	$os_£m_Œywa™
(
os_£m
 *
_£m
) {

838 
os_£m_t
 *
£m
 = (os_£m_ˆ*è
_£m
;

840 ià(
£m
 =ğ
NULL
) {

841  
OSIP_BADPARAMETER
;

844 ià(
	`¹ems_£m­hÜe_obš
(
£m
->
id
, 
RTEMS_NO_WAIT
, 0è!ğ
RTEMS_SUCCESSFUL
) {

845  
OSIP_UNDEFINED_ERROR
;

849 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_thread.c

20 
	~<os2/š‹º®.h
>

22 #iâdeà
OSIP_MONOTHREAD


24 
	~<os·r£r2/os_pÜt.h
>

25 
	~<os2/os_mt.h
>

27 #ià
defšed
(
__¹ems__
)

28 
	~<¹ems.h
>

31 #ià!
defšed
(
__¹ems__
)

32 #ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

33 #ià
defšed
 
_WIN32_WCE


34 
	#_begšth»adex
 
C»©eTh»ad


	)

35 
	#_’dth»adex
 
Ex™Th»ad


	)

36 #–ià
defšed
 
WIN32


37 
	~<´oûss.h
>

43 #iâdeà
__VXWORKS_OS__


44 #ià
defšed
(
HAVE_PTHREAD
è|| defšed(
HAVE_PTH_PTHREAD_H
è|| defšed(
HAVE_PTHREAD_WIN32
)

46 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

47 
i
;

48 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

50 ià(
th»ad
 =ğ
NULL
)

51  
NULL
;

53 
i
 = 
	`±h»ad_ü—‹
(
th»ad
, 
NULL
, 
func
, (*è
¬g
);

55 ià(
i
 != 0) {

56 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Error while creating‡‚ewhread\n"));

57 
	`os_ä“
(
th»ad
);

58  
NULL
;

61  (
os_th»ad
 *è
th»ad
;

62 
	}
}

64 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
th»ad
, 
´iÜ™y
) {

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

69 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

71 ià(
th»ad
 =ğ
NULL
)

72  
OSIP_BADPARAMETER
;

74  
	`±h»ad_još
(*
th»ad
, 
NULL
);

75 
	}
}

77 
	$os_th»ad_ex™
() {

78 #ià!
	`defšed
(
__¬c__
)

79 
	`±h»ad_ex™
(
NULL
);

81 
	}
}

86 #ià(
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)è&& !defšed(
HAVE_PTHREAD_WIN32
)

88 #ià
defšed
(
HAVE_CPP11_THREAD
)

89 
	~<io¡»am
>

90 
	~<th»ad
>

92 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

93 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

95 ià(
th»ad
 =ğ
NULL
)

96  
NULL
;

98 
th»ad
->
h
 = 
Ãw
 
¡d
::
	`th»ad
(
func
, 
¬g
);

100 ià(
th»ad
->
h
 == 0) {

101 
	`os_ä“
(
th»ad
);

102  
NULL
;

105  (
os_th»ad
 *è
th»ad
;

106 
	}
}

108 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

109 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

111 
¡d
::
th»ad
 *
th
;

113 ià(
th»ad
 =ğ
NULL
)

114  
OSIP_BADPARAMETER
;

116 
th
 = (
¡d
::
th»ad
 *èth»ad->
h
;

117 
th
->
	`još
();

118 
d–‘e
 
th
;

120 
th»ad
->
h
 = 
NULL
;

122 
	}
}

124 
	$os_th»ad_ex™
() {

125 
	}
}

127 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
th»ad
, 
´iÜ™y
) {

128  
OSIP_SUCCESS
;

129 
	}
}

133 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

134 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

136 ià(
th»ad
 =ğ
NULL
)

137  
NULL
;

139 
th»ad
->
h
 = (
HANDLE
è
	`_begšth»adex
(
NULL
,

141 ((
__¡dÿÎ
 *)(*)è
func
, 
¬g
, 0, &(
th»ad
->
id
));

143 ià(
th»ad
->
h
 == 0) {

144 
	`os_ä“
(
th»ad
);

145  
NULL
;

148  (
os_th»ad
 *è
th»ad
;

149 
	}
}

151 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

152 
i
;

153 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

155 ià(
th»ad
 =ğ
NULL
)

156  
OSIP_BADPARAMETER
;

158 
i
 = 
	`Wa™FÜSšgËObjeù
(
th»ad
->
h
, 
INFINITE
);

160 ià(
i
 =ğ
WAIT_OBJECT_0
) {

164  
OSIP_UNDEFINED_ERROR
;

167 
	`Clo£HªdË
(
th»ad
->
h
);

169 
	}
}

171 
	$os_th»ad_ex™
() {

173 
	`_’dth»adex
(0);

174 
	}
}

176 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
th»ad
, 
´iÜ™y
) {

177  
OSIP_SUCCESS
;

178 
	}
}

184 #iâdeà
__VXWORKS_OS__


185 #ifdeà
__PSOS__


186 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

187 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

189 ià(
th»ad
 =ğ
NULL
)

190  (
NULL
);

192 ià(
	`t_ü—‹
("s", 150, 
¡acksize
, 0, 0, &
th»ad
->
tid
) != 0) {

193 
	`os_ä“
(
th»ad
);

194  (
NULL
);

197 ià(
	`t_¡¬t
(
th»ad
->
tid
, 
T_PREEMPT
 | 
T_ISR
, 
func
, 0) != 0) {

198 
	`os_ä“
(
th»ad
);

199  (
NULL
);

202  (
os_th»ad
 *è
th»ad
;

203 
	}
}

205 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
_th»ad
, 
´iÜ™y
) {

206 
Şd´io
;

207 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

209 ià(
th»ad
 =ğ
NULL
)

210  
OSIP_BADPARAMETER
;

212 
	`t_£t_´i
(
th»ad
->
tid
, 
´iÜ™y
, &
Şd´io
);

213  
OSIP_SUCCESS
;

214 
	}
}

216 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

217 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

219 ià(
th»ad
 =ğ
NULL
)

220  
OSIP_BADPARAMETER
;

222 
	`t_d–‘e
(
th»ad
->
tid
);

225 
	}
}

227 
	$os_th»ad_ex™
() {

228 
	`t_d–‘e
(0);

229 
	}
}

233 #ifdeà
__VXWORKS_OS__


234 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

235 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

237 ià(
th»ad
 =ğ
NULL
)

238  
NULL
;

240 
th»ad
->
id
 = 
	`skS·wn
(
NULL
, 5, 0, 
¡acksize
, (
FUNCPTR
è
func
, (è
¬g
, 0, 0, 0, 0, 0, 0, 0, 0, 0);

242 ià(
th»ad
->
id
 < 0)

243 
	`os_ä“
(
th»ad
);

245  (
os_th»ad
 *è
th»ad
;

246 
	}
}

248 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
_th»ad
, 
´iÜ™y
) {

249 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

251 ià(
th»ad
 =ğ
NULL
)

252  
OSIP_BADPARAMETER
;

254 
	`skPriÜ™yS‘
(
th»ad
->
id
, 1);

255  
OSIP_SUCCESS
;

256 
	}
}

258 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

259 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

261 ià(
th»ad
 =ğ
NULL
)

262  
OSIP_BADPARAMETER
;

264  
	`skD–‘e
(
th»ad
->
id
);

265 
	}
}

267 
	$os_th»ad_ex™
() {

269 
	}
}

274 #ià
defšed
(
__¹ems__
)

275 
os_th»ad
 *
	$os_th»ad_ü—‹
(
¡acksize
, *(*
func
)(*), *
¬g
) {

276 
¹ems_¡©us_code
 
¡©us
;

277 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
	`os_m®loc
((osip_thread_t));

279 ià(
th»ad
 =ğ
NULL
)

280  
NULL
;

282 
¡©us
 = 
	`¹ems_sk_ü—‹
(
	`¹ems_bud_Çme
('S', 'I', 'P', 'T'), 100, 
¡acksize
, 
RTEMS_DEFAULT_MODES
, 
RTEMS_DEFAULT_ATTRIBUTES
, &
th»ad
->
tid
);

284 ià(
¡©us
 =ğ
RTEMS_SUCCESSFUL
) {

285 
¡©us
 = 
	`¹ems_sk_¡¬t
(
th»ad
->
tid
, (
¹ems_sk_’Œy
è
func
, (
¹ems_sk_¬gum’t
è
¬g
);

288 ià(
¡©us
 !ğ
RTEMS_SUCCESSFUL
) {

289 
	`os_ä“
(
th»ad
);

290 
th»ad
 = 
NULL
;

293  (
os_th»ad
 *è
th»ad
;

294 
	}
}

296 
	$os_th»ad_£t_´iÜ™y
(
os_th»ad
 *
_th»ad
, 
´iÜ™y
) {

297 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

299 
¹ems_sk_´iÜ™y
 
Şd
;

301 ià(
th»ad
 !ğ
NULL
) {

302  
	`¹ems_sk_£t_´iÜ™y
(
th»ad
->
tid
, 
´iÜ™y
, &
Şd
);

305  
OSIP_SUCCESS
;

306 
	}
}

308 
	$os_th»ad_još
(
os_th»ad
 *
_th»ad
) {

309 
os_th»ad_t
 *
th»ad
 = (os_th»ad_ˆ*è
_th»ad
;

311 ià(
th»ad
 =ğ
NULL
) {

312  
OSIP_BADPARAMETER
;

315  
	`¹ems_sk_d–‘e
(
th»ad
->
tid
);

316 
	}
}

318 
	$os_th»ad_ex™
() {

319 
	`¹ems_sk_d–‘e
(
RTEMS_SELF
);

320 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/xixt.h

20 #iâdeà
_XIXT_H_


21 
	#_XIXT_H_


	)

23 
	~<os·r£r2/os_cÚ¡.h
>

24 
	~<os·r£r2/os_pÜt.h
>

26 #ifdeà
__ılu¥lus


30 
__os_mes§ge_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *, 
os_mes§ge_t
 *);

31 
__os_kl_Œª§ùiÚ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *);

32 
__os_Œª¥Üt_”rÜ_ÿÎback
(
ty³
, 
os_Œª§ùiÚ_t
 *, 
”rÜ
);

41 
__os_iù_š™
(
os_iù_t
 **
iù
, 
os_t
 *
os
, 
os_mes§ge_t
 *
šv™e
);

47 
__os_iù_ä“
(
os_iù_t
 *
iù
);

56 
os_ev’t_t
 *
__os_iù_Ãed_tim”_a_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

64 
os_ev’t_t
 *
__os_iù_Ãed_tim”_b_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

72 
os_ev’t_t
 *
__os_iù_Ãed_tim”_d_ev’t
(
os_iù_t
 *
iù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

81 
__os_niù_š™
(
os_niù_t
 **
niù
, 
os_t
 *
os
, 
os_mes§ge_t
 *
»que¡
);

87 
__os_niù_ä“
(
os_niù_t
 *
niù
);

96 
os_ev’t_t
 *
__os_niù_Ãed_tim”_e_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

104 
os_ev’t_t
 *
__os_niù_Ãed_tim”_f_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

112 
os_ev’t_t
 *
__os_niù_Ãed_tim”_k_ev’t
(
os_niù_t
 *
niù
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

121 
__os_i¡_š™
(
os_i¡_t
 **
i¡
, 
os_t
 *
os
, 
os_mes§ge_t
 *
šv™e
);

127 
__os_i¡_ä“
(
os_i¡_t
 *
i¡
);

136 
os_ev’t_t
 *
__os_i¡_Ãed_tim”_g_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

144 
os_ev’t_t
 *
__os_i¡_Ãed_tim”_h_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

152 
os_ev’t_t
 *
__os_i¡_Ãed_tim”_i_ev’t
(
os_i¡_t
 *
i¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

161 
__os_ni¡_š™
(
os_ni¡_t
 **
ni¡
, 
os_t
 *
os
, 
os_mes§ge_t
 *
»que¡
);

168 
__os_ni¡_ä“
(
os_ni¡_t
 *
ni¡
);

176 
os_ev’t_t
 *
__os_ni¡_Ãed_tim”_j_ev’t
(
os_ni¡_t
 *
ni¡
, 
¡©e_t
 
¡©e
, 
Œª§ùiÚid
);

184 
__os_Œª§ùiÚ_m©chšg_»¥Ú£_os_to_xiù_17_1_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»¥
);

192 
__os_Œª§ùiÚ_m©chšg_»que¡_os_to_xi¡_17_2_3
(
os_Œª§ùiÚ_t
 *
Œ
, 
os_mes§ge_t
 *
»que¡
);

199 
os_iù_lock
(
os_t
 *
os
);

205 
os_iù_uÆock
(
os_t
 *
os
);

211 
os_i¡_lock
(
os_t
 *
os
);

217 
os_i¡_uÆock
(
os_t
 *
os
);

223 
os_niù_lock
(
os_t
 *
os
);

229 
os_niù_uÆock
(
os_t
 *
os
);

235 
os_ni¡_lock
(
os_t
 *
os
);

241 
os_ni¡_uÆock
(
os_t
 *
os
);

249 
__os_add_iù
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
iù
);

256 
__os_add_i¡
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
i¡
);

263 
__os_add_niù
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
niù
);

270 
__os_add_ni¡
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
ni¡
);

277 
__os_»move_iù_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
iù
);

283 
__os_»move_i¡_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
i¡
);

289 
__os_»move_niù_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
niù
);

295 
__os_»move_ni¡_Œª§ùiÚ
(
os_t
 *
os
, 
os_Œª§ùiÚ_t
 *
ni¡
);

303 
os_ev’t_t
 *
__os_ev’t_Ãw
(
ty³_t
 
ty³
, 
Œª§ùiÚid
);

309 
os_ev’t_t
 *
os_Ãw_outgošg_smes§ge
(
os_mes§ge_t
 *
s
);

311 #ifdeà
__ılu¥lus


	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 #iâdeà
MINISIZE


32 
	$os_mes§ge_£t_acû±
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

33 
os_acû±_t
 *
acû±
;

34 
i
;

36 
i
 = 
	`acû±_š™
(&
acû±
);

38 ià(
i
 != 0)

39  
i
;

41 
i
 = 
	`os_acû±_·r£
(
acû±
, 
hv®ue
);

43 ià(
i
 != 0) {

44 
	`os_acû±_ä“
(
acû±
);

45  
i
;

48 
s
->
mes§ge_´İ”ty
 = 2;

50 
	`os_li¡_add
(&
s
->
acû±s
, 
acû±
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

54 
	$os_mes§ge_g‘_acû±
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_t
 **
de¡
) {

55 
os_acû±_t
 *
acû±
;

57 *
de¡
 = 
NULL
;

59 ià(
	`os_li¡_size
(&
s
->
acû±s
è<ğ
pos
)

60  
OSIP_UNDEFINED_ERROR
;

62 
acû±
 = (
os_acû±_t
 *è
	`os_li¡_g‘
(&
s
->
acû±s
, 
pos
);

63 *
de¡
 = 
acû±
;

64  
pos
;

65 
	}
}

70 
	$os_acû±_to_¡r
(cÚ¡ 
os_acû±_t
 *
acû±
, **
de¡
) {

71 *
buf
;

72 *
tmp
;

73 
size_t
 
Ën
 = 0;

75 *
de¡
 = 
NULL
;

77 ià(
acû±
 =ğ
NULL
)

78  
OSIP_BADPARAMETER
;

80 ià(
acû±
->
ty³
 !ğ
NULL
)

81 
Ën
 +ğ
	`¡¾’
(
acû±
->
ty³
);

83 ià(
acû±
->
subty³
 !ğ
NULL
)

84 
Ën
 +ğ
	`¡¾’
(
acû±
->
subty³
);

86 ià(
Ën
 == 0) {

88 
buf
 = (*è
	`os_m®loc
(2);

90 ià(
buf
 =ğ
NULL
)

91  
OSIP_NOMEM
;

93 
buf
[0] = ' ';

94 
buf
[1] = '\0';

95 *
de¡
 = 
buf
;

96  
OSIP_SUCCESS
;

100 
Ën
 += 4

101 + 10 * 
	`os_li¡_size
(&
acû±
->
g’_·¿ms
);

103 
buf
 = (*è
	`os_m®loc
(
Ën
);

105 ià(
buf
 =ğ
NULL
)

106  
OSIP_NOMEM
;

108 
tmp
 = 
buf
;

110 
	`¥rštf
(
tmp
, "%s/%s", 
acû±
->
ty³
,‡cû±->
subty³
);

112 
tmp
 =m°+ 
	`¡¾’
(tmp);

114 
os_li¡_™”©Ü_t
 
™
;

115 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
acû±
->
g’_·¿ms
, &
™
);

117 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

118 
size_t
 
tmp_Ën
;

120 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
) {

121 
	`os_ä“
(
buf
);

122  
OSIP_SYNTAXERROR
;

125 
tmp_Ën
 = 
	`¡¾’
(
buf
è+ 4 + sŒËn(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 1;

127 ià(
Ën
 < 
tmp_Ën
) {

128 
buf
 = 
	`os_»®loc
(buf, 
tmp_Ën
);

129 
Ën
 = 
tmp_Ën
;

130 
tmp
 = 
buf
 + 
	`¡¾’
(buf);

133 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), "; %s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

134 
tmp
 =m°+ 
	`¡¾’
(tmp);

135 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

138 *
de¡
 = 
buf
;

139  
OSIP_SUCCESS
;

140 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_encoding.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


32 
	$os_mes§ge_£t_acû±_’codšg
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

33 
os_acû±_’codšg_t
 *
acû±_’codšg
;

34 
i
;

36 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`os_acû±_’codšg_š™
(&
acû±_’codšg
);

41 ià(
i
 != 0)

42  
i
;

44 
i
 = 
	`os_acû±_’codšg_·r£
(
acû±_’codšg
, 
hv®ue
);

46 ià(
i
 != 0) {

47 
	`os_acû±_’codšg_ä“
(
acû±_’codšg
);

48  
i
;

51 
s
->
mes§ge_´İ”ty
 = 2;

52 
	`os_li¡_add
(&
s
->
acû±_’codšgs
, 
acû±_’codšg
, -1);

53  
OSIP_SUCCESS
;

54 
	}
}

56 
	$os_mes§ge_g‘_acû±_’codšg
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_’codšg_t
 **
de¡
) {

57 
os_acû±_’codšg_t
 *
acû±_’codšg
;

59 *
de¡
 = 
NULL
;

61 ià(
	`os_li¡_size
(&
s
->
acû±_’codšgs
è<ğ
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
acû±_’codšg
 = (
os_acû±_’codšg_t
 *è
	`os_li¡_g‘
(&
s
->
acû±_’codšgs
, 
pos
);

65 *
de¡
 = 
acû±_’codšg
;

66  
pos
;

67 
	}
}

69 
	$os_acû±_’codšg_š™
(
os_acû±_’codšg_t
 **
acû±_’codšg
) {

70 *
acû±_’codšg
 = (
os_acû±_’codšg_t
 *è
	`os_m®loc
((osip_accept_encoding_t));

72 ià(*
acû±_’codšg
 =ğ
NULL
)

73  
OSIP_NOMEM
;

75 (*
acû±_’codšg
)->
–em’t
 = 
NULL
;

77 
	`os_li¡_š™
(&(*
acû±_’codšg
)->
g’_·¿ms
);

79  
OSIP_SUCCESS
;

80 
	}
}

82 
	$os_acû±_’codšg_·r£
(
os_acû±_’codšg_t
 *
acû±_’codšg
, cÚ¡ *
hv®ue
) {

83 
i
;

84 cÚ¡ *
os_acû±_’codšg_·¿ms
;

86 
os_acû±_’codšg_·¿ms
 = 
	`¡rchr
(
hv®ue
, ';');

88 ià(
os_acû±_’codšg_·¿ms
 !ğ
NULL
) {

89 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
acû±_’codšg
->
g’_·¿ms
, 
os_acû±_’codšg_·¿ms
);

91 ià(
i
 != 0)

92  
i
;

95 
os_acû±_’codšg_·¿ms
 = 
hv®ue
 + 
	`¡¾’
(hvalue);

97 ià(
os_acû±_’codšg_·¿ms
 - 
hv®ue
 + 1 < 2)

98  
OSIP_SYNTAXERROR
;

100 
acû±_’codšg
->
–em’t
 = (*è
	`os_m®loc
(
os_acû±_’codšg_·¿ms
 - 
hv®ue
 + 1);

102 ià(
acû±_’codšg
->
–em’t
 =ğ
NULL
)

103  
OSIP_NOMEM
;

105 
	`os_şºıy
(
acû±_’codšg
->
–em’t
, 
hv®ue
, 
os_acû±_’codšg_·¿ms
 - hvalue);

107  
OSIP_SUCCESS
;

108 
	}
}

113 
	$os_acû±_’codšg_to_¡r
(cÚ¡ 
os_acû±_’codšg_t
 *
acû±_’codšg
, **
de¡
) {

114 *
buf
;

115 *
tmp
;

116 
size_t
 
Ën
;

118 *
de¡
 = 
NULL
;

120 ià((
acû±_’codšg
 =ğ
NULL
è|| (acû±_’codšg->
–em’t
 == NULL))

121  
OSIP_BADPARAMETER
;

123 
Ën
 = 
	`¡¾’
(
acû±_’codšg
->
–em’t
) + 2;

124 
buf
 = (*è
	`os_m®loc
(
Ën
);

126 ià(
buf
 =ğ
NULL
)

127  
OSIP_NOMEM
;

129 
	`¥rštf
(
buf
, "%s", 
acû±_’codšg
->
–em’t
);

131 
size_t
 
¶’
;

132 
os_li¡_™”©Ü_t
 
™
;

133 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
acû±_’codšg
->
g’_·¿ms
, &
™
);

135 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

136 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

137 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
) + 2;

140 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 3;

142 
Ën
 =†’ + 
¶’
;

143 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

144 
tmp
 = 
buf
;

145 
tmp
 =m°+ 
	`¡¾’
(tmp);

147 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

148 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s", 
u_·¿m
->
gÇme
);

151 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

153 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

156 *
de¡
 = 
buf
;

157  
OSIP_SUCCESS
;

158 
	}
}

162 
	$os_acû±_’codšg_ä“
(
os_acû±_’codšg_t
 *
acû±_’codšg
) {

163 ià(
acû±_’codšg
 =ğ
NULL
)

166 
	`os_ä“
(
acû±_’codšg
->
–em’t
);

168 
	`os_g’”ic_·¿m_ä“li¡
(&
acû±_’codšg
->
g’_·¿ms
);

170 
acû±_’codšg
->
–em’t
 = 
NULL
;

171 
	`os_ä“
(
acû±_’codšg
);

172 
	}
}

174 
	$os_acû±_’codšg_şÚe
(cÚ¡ 
os_acû±_’codšg_t
 *
ùt
, os_acû±_’codšg_ˆ**
de¡
) {

175 
i
;

176 
os_acû±_’codšg_t
 *
ù
;

178 *
de¡
 = 
NULL
;

180 ià(
ùt
 =ğ
NULL
)

181  
OSIP_BADPARAMETER
;

183 ià(
ùt
->
–em’t
 =ğ
NULL
)

184  
OSIP_BADPARAMETER
;

186 
i
 = 
	`os_acû±_’codšg_š™
(&
ù
);

188 ià(
i
 != 0)

189  
i
;

191 
ù
->
–em’t
 = 
	`os_¡rdup
(
ùt
->element);

193 ià(
ù
->
–em’t
 =ğ
NULL
) {

194 
	`os_acû±_’codšg_ä“
(
ù
);

195  
OSIP_NOMEM
;

199 
os_g’”ic_·¿m_t
 *
de¡_·¿m
;

200 
os_li¡_™”©Ü_t
 
™
;

201 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
ùt
->
g’_·¿ms
, &
™
);

203 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

204 
i
 = 
	`os_g’”ic_·¿m_şÚe
(
u_·¿m
, &
de¡_·¿m
);

206 ià(
i
 != 0) {

207 
	`os_acû±_’codšg_ä“
(
ù
);

208  
i
;

211 
	`os_li¡_add
(&
ù
->
g’_·¿ms
, 
de¡_·¿m
, -1);

212 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

216 *
de¡
 = 
ù
;

217  
OSIP_SUCCESS
;

218 
	}
}

220 *
	$os_acû±_’codšg_g‘_–em’t
(cÚ¡ 
os_acû±_’codšg_t
 *
«
) {

221  
«
->
–em’t
;

222 
	}
}

224 
	$os_acû±_’codšg_£t_–em’t
(
os_acû±_’codšg_t
 *
«
, *
–em’t
) {

225 
«
->
–em’t
 =ƒlement;

226 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_language.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


29 
	$os_mes§ge_£t_acû±_Ïnguage
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

30 
os_acû±_Ïnguage_t
 *
acû±_Ïnguage
;

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`os_acû±_Ïnguage_š™
(&
acû±_Ïnguage
);

38 ià(
i
 != 0)

39  
i
;

41 
i
 = 
	`os_acû±_Ïnguage_·r£
(
acû±_Ïnguage
, 
hv®ue
);

43 ià(
i
 != 0) {

44 
	`os_acû±_Ïnguage_ä“
(
acû±_Ïnguage
);

45  
i
;

48 
s
->
mes§ge_´İ”ty
 = 2;

49 
	`os_li¡_add
(&
s
->
acû±_Ïnguages
, 
acû±_Ïnguage
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$os_mes§ge_g‘_acû±_Ïnguage
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_acû±_Ïnguage_t
 **
de¡
) {

54 
os_acû±_Ïnguage_t
 *
acû±_Ïnguage
;

56 *
de¡
 = 
NULL
;

58 ià(
	`os_li¡_size
(&
s
->
acû±_Ïnguages
è<ğ
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
acû±_Ïnguage
 = (
os_acû±_Ïnguage_t
 *è
	`os_li¡_g‘
(&
s
->
acû±_Ïnguages
, 
pos
);

62 *
de¡
 = 
acû±_Ïnguage
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_alert_info.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


29 
	$os_mes§ge_£t_®”t_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

30 
os_®”t_šfo_t
 *
®”t_šfo
;

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`os_®”t_šfo_š™
(&
®”t_šfo
);

38 ià(
i
 != 0)

39  
i
;

41 
i
 = 
	`os_®”t_šfo_·r£
(
®”t_šfo
, 
hv®ue
);

43 ià(
i
 != 0) {

44 
	`os_®”t_šfo_ä“
(
®”t_šfo
);

45  
i
;

48 
s
->
mes§ge_´İ”ty
 = 2;

49 
	`os_li¡_add
(&
s
->
®”t_šfos
, 
®”t_šfo
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$os_mes§ge_g‘_®”t_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_®”t_šfo_t
 **
de¡
) {

54 
os_®”t_šfo_t
 *
®”t_šfo
;

56 *
de¡
 = 
NULL
;

58 ià(
	`os_li¡_size
(&
s
->
®”t_šfos
è<ğ
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
®”t_šfo
 = (
os_®”t_šfo_t
 *è
	`os_li¡_g‘
(&
s
->
®”t_šfos
, 
pos
);

62 *
de¡
 = 
®”t_šfo
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_allow.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


29 
	$os_mes§ge_£t_®low
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

30 
os_®low_t
 *
®low
;

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`os_®low_š™
(&
®low
);

38 ià(
i
 != 0)

39  
i
;

41 
i
 = 
	`os_®low_·r£
(
®low
, 
hv®ue
);

43 ià(
i
 != 0) {

44 
	`os_®low_ä“
(
®low
);

45  
i
;

48 
s
->
mes§ge_´İ”ty
 = 2;

49 
	`os_li¡_add
(&
s
->
®lows
, 
®low
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$os_mes§ge_g‘_®low
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_®low_t
 **
de¡
) {

54 
os_®low_t
 *
®low
;

56 *
de¡
 = 
NULL
;

58 ià(
	`os_li¡_size
(&
s
->
®lows
è<ğ
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
®low
 = (
os_®low_t
 *è
	`os_li¡_g‘
(&
s
->
®lows
, 
pos
);

62 *
de¡
 = 
®low
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authentication_info.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


29 
	$os_auth’tiÿtiÚ_šfo_š™
(
os_auth’tiÿtiÚ_šfo_t
 **
de¡
) {

30 *
de¡
 = (
os_auth’tiÿtiÚ_šfo_t
 *è
	`os_m®loc
((osip_authentication_info_t));

32 ià(*
de¡
 =ğ
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
de¡
, 0, (
os_auth’tiÿtiÚ_šfo_t
));

36  
OSIP_SUCCESS
;

37 
	}
}

43 
	$os_mes§ge_£t_auth’tiÿtiÚ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

44 
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
;

45 
i
;

47 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

48  
OSIP_SUCCESS
;

50 ià(
s
 =ğ
NULL
)

51  
OSIP_BADPARAMETER
;

53 
i
 = 
	`os_auth’tiÿtiÚ_šfo_š™
(&
auth’tiÿtiÚ_šfo
);

55 ià(
i
 != 0)

56  
i
;

58 
i
 = 
	`os_auth’tiÿtiÚ_šfo_·r£
(
auth’tiÿtiÚ_šfo
, 
hv®ue
);

60 ià(
i
 != 0) {

61 
	`os_auth’tiÿtiÚ_šfo_ä“
(
auth’tiÿtiÚ_šfo
);

62  
i
;

65 
s
->
mes§ge_´İ”ty
 = 2;

67 
	`os_li¡_add
(&
s
->
auth’tiÿtiÚ_šfos
, 
auth’tiÿtiÚ_šfo
, -1);

68  
OSIP_SUCCESS
;

69 
	}
}

79 
	$os_auth’tiÿtiÚ_šfo_·r£
(
os_auth’tiÿtiÚ_šfo_t
 *
ašfo
, cÚ¡ *
hv®ue
) {

80 cÚ¡ *
¥aû
, *
hack
;

81 cÚ¡ *
Ãxt
 = 
NULL
;

82 
i
;

84 
¥aû
 = 
	`¡rchr
(
hv®ue
, ' ');

85 
hack
 = 
	`¡rchr
(
hv®ue
, '=');

87 ià(
¥aû
 && 
hack
 && hack > space) {

88 
ašfo
->
auth_ty³
 = (*è
	`os_m®loc
(
¥aû
 - 
hv®ue
 + 1);

90 ià(
ašfo
->
auth_ty³
 =ğ
NULL
)

91  
OSIP_NOMEM
;

93 
	`os_¡ºıy
(
ašfo
->
auth_ty³
, 
hv®ue
, 
¥aû
 - hvalue);

96 
¥aû
 = 
hv®ue
;

99 
·r£_ok
 = 0;

101 
i
 = 
	`__os_quÙed_¡ršg_£t
("ÃxŠÚû", 
¥aû
, &(
ašfo
->
ÃxŠÚû
), &
Ãxt
);

103 ià(
i
 != 0)

104  
i
;

106 ià(
Ãxt
 =ğ
NULL
)

107  
OSIP_SUCCESS
;

108 ià(
Ãxt
 !ğ
¥aû
) {

109 
¥aû
 = 
Ãxt
;

110 
·r£_ok
++;

113 
i
 = 
	`__os_quÙed_¡ršg_£t
("úÚû", 
¥aû
, &(
ašfo
->
úÚû
), &
Ãxt
);

115 ià(
i
 != 0)

116  
i
;

118 ià(
Ãxt
 =ğ
NULL
)

119  
OSIP_SUCCESS
;

120 ià(
Ãxt
 !ğ
¥aû
) {

121 
¥aû
 = 
Ãxt
;

122 
·r£_ok
++;

125 
i
 = 
	`__os_quÙed_¡ršg_£t
("r¥auth", 
¥aû
, &(
ašfo
->
r¥auth
), &
Ãxt
);

127 ià(
i
 != 0)

128  
i
;

130 ià(
Ãxt
 =ğ
NULL
)

131  
OSIP_SUCCESS
;

132 ià(
Ãxt
 !ğ
¥aû
) {

133 
¥aû
 = 
Ãxt
;

134 
·r£_ok
++;

137 
i
 = 
	`__os_tok’_£t
("nc", 
¥aû
, &(
ašfo
->
nÚû_couÁ
), &
Ãxt
);

139 ià(
i
 != 0)

140  
i
;

142 ià(
Ãxt
 =ğ
NULL
)

143  
OSIP_SUCCESS
;

144 ià(
Ãxt
 !ğ
¥aû
) {

145 
¥aû
 = 
Ãxt
;

146 
·r£_ok
++;

149 
i
 = 
	`__os_tok’_£t
("qİ", 
¥aû
, &(
ašfo
->
qİ_İtiÚs
), &
Ãxt
);

151 ià(
i
 != 0)

152  
i
;

154 ià(
Ãxt
 =ğ
NULL
)

155  
OSIP_SUCCESS
;

156 ià(
Ãxt
 !ğ
¥aû
) {

157 
¥aû
 = 
Ãxt
;

158 
·r£_ok
++;

161 
i
 = 
	`__os_quÙed_¡ršg_£t
("¢um", 
¥aû
, &(
ašfo
->
¢um
), &
Ãxt
);

163 ià(
i
 != 0)

164  
i
;

166 ià(
Ãxt
 =ğ
NULL
)

167  
OSIP_SUCCESS
;

168 ià(
Ãxt
 !ğ
¥aû
) {

169 
¥aû
 = 
Ãxt
;

170 
·r£_ok
++;

173 
i
 = 
	`__os_quÙed_¡ršg_£t
("¤ªd", 
¥aû
, &(
ašfo
->
¤ªd
), &
Ãxt
);

175 ià(
i
 != 0)

176  
i
;

178 ià(
Ãxt
 =ğ
NULL
)

179  
OSIP_SUCCESS
;

180 ià(
Ãxt
 !ğ
¥aû
) {

181 
¥aû
 = 
Ãxt
;

182 
·r£_ok
++;

185 
i
 = 
	`__os_quÙed_¡ršg_£t
("rg‘Çme", 
¥aû
, &(
ašfo
->
rg‘Çme
), &
Ãxt
);

187 ià(
i
 != 0)

188  
i
;

190 ià(
Ãxt
 =ğ
NULL
)

191  
OSIP_SUCCESS
;

192 ià(
Ãxt
 !ğ
¥aû
) {

193 
¥aû
 = 
Ãxt
;

194 
·r£_ok
++;

197 
i
 = 
	`__os_quÙed_¡ršg_£t
("»®m", 
¥aû
, &(
ašfo
->
»®m
), &
Ãxt
);

199 ià(
i
 != 0)

200  
i
;

202 ià(
Ãxt
 =ğ
NULL
)

203  
OSIP_SUCCESS
;

204 ià(
Ãxt
 !ğ
¥aû
) {

205 
¥aû
 = 
Ãxt
;

206 
·r£_ok
++;

209 
i
 = 
	`__os_quÙed_¡ršg_£t
("İaque", 
¥aû
, &(
ašfo
->
İaque
), &
Ãxt
);

211 ià(
i
 != 0)

212  
i
;

214 ià(
Ãxt
 =ğ
NULL
)

215  
OSIP_SUCCESS
;

216 ià(
Ãxt
 !ğ
¥aû
) {

217 
¥aû
 = 
Ãxt
;

218 
·r£_ok
++;

221 ià(0 =ğ
·r£_ok
) {

222 cÚ¡ *
quÙe1
, *
quÙe2
, *
tmp
;

227 ià(
	`¡¾’
(
¥aû
) < 1)

228  
OSIP_SUCCESS
;

230 
tmp
 = 
	`¡rchr
(
¥aû
 + 1, ',');

232 ià(
tmp
 =ğ
NULL
)

233  
OSIP_SUCCESS
;

235 
quÙe1
 = 
	`__os_quÙe_fšd
(
¥aû
);

237 ià((
quÙe1
 !ğ
NULL
è&& (quÙe1 < 
tmp
)) {

238 
quÙe2
 = 
	`__os_quÙe_fšd
(
quÙe1
 + 1);

240 ià(
quÙe2
 =ğ
NULL
)

241  
OSIP_SYNTAXERROR
;

243 ià(
tmp
 < 
quÙe2
)

244 
¥aû
 = 
	`¡rchr
(
quÙe2
, ',');

247 
¥aû
 = 
tmp
;

249 ià(
¥aû
 =ğ
NULL
)

250  
OSIP_SUCCESS
;

253 
¥aû
 = 
tmp
;

259  
OSIP_SUCCESS
;

260 
	}
}

265 
	$os_mes§ge_g‘_auth’tiÿtiÚ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_auth’tiÿtiÚ_šfo_t
 **
de¡
) {

266 
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
;

268 *
de¡
 = 
NULL
;

270 ià(
	`os_li¡_size
(&
s
->
auth’tiÿtiÚ_šfos
è<ğ
pos
)

271  
OSIP_UNDEFINED_ERROR
;

273 
auth’tiÿtiÚ_šfo
 = (
os_auth’tiÿtiÚ_šfo_t
 *è
	`os_li¡_g‘
(&
s
->
auth’tiÿtiÚ_šfos
, 
pos
);

275 *
de¡
 = 
auth’tiÿtiÚ_šfo
;

276  
pos
;

277 
	}
}

279 *
	$os_auth’tiÿtiÚ_šfo_g‘_auth_ty³
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

280  
auth’tiÿtiÚ_šfo
->
auth_ty³
;

281 
	}
}

283 
	$os_auth’tiÿtiÚ_šfo_£t_auth_ty³
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
auth_ty³
) {

284 
auth’tiÿtiÚ_šfo
->
auth_ty³
 = (*)‡uth_type;

285 
	}
}

287 *
	$os_auth’tiÿtiÚ_šfo_g‘_ÃxŠÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

288  
auth’tiÿtiÚ_šfo
->
ÃxŠÚû
;

289 
	}
}

291 
	$os_auth’tiÿtiÚ_šfo_£t_ÃxŠÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
ÃxŠÚû
) {

292 
auth’tiÿtiÚ_šfo
->
ÃxŠÚû
 = (*)‚extnonce;

293 
	}
}

295 *
	$os_auth’tiÿtiÚ_šfo_g‘_úÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

296  
auth’tiÿtiÚ_šfo
->
úÚû
;

297 
	}
}

299 
	$os_auth’tiÿtiÚ_šfo_£t_úÚû
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
úÚû
) {

300 
auth’tiÿtiÚ_šfo
->
úÚû
 = (*) cnonce;

301 
	}
}

303 *
	$os_auth’tiÿtiÚ_šfo_g‘_r¥auth
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

304  
auth’tiÿtiÚ_šfo
->
r¥auth
;

305 
	}
}

307 
	$os_auth’tiÿtiÚ_šfo_£t_r¥auth
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
r¥auth
) {

308 
auth’tiÿtiÚ_šfo
->
r¥auth
 = (*)„spauth;

309 
	}
}

311 *
	$os_auth’tiÿtiÚ_šfo_g‘_nÚû_couÁ
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

312  
auth’tiÿtiÚ_šfo
->
nÚû_couÁ
;

313 
	}
}

315 
	$os_auth’tiÿtiÚ_šfo_£t_nÚû_couÁ
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
nÚû_couÁ
) {

316 
auth’tiÿtiÚ_šfo
->
nÚû_couÁ
 = (*)‚once_count;

317 
	}
}

319 *
	$os_auth’tiÿtiÚ_šfo_g‘_qİ_İtiÚs
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

320  
auth’tiÿtiÚ_šfo
->
qİ_İtiÚs
;

321 
	}
}

323 
	$os_auth’tiÿtiÚ_šfo_£t_qİ_İtiÚs
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
qİ_İtiÚs
) {

324 
auth’tiÿtiÚ_šfo
->
qİ_İtiÚs
 = (*) qop_options;

325 
	}
}

327 *
	$os_auth’tiÿtiÚ_šfo_g‘_¢um
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

328  
auth’tiÿtiÚ_šfo
->
¢um
;

329 
	}
}

331 
	$os_auth’tiÿtiÚ_šfo_£t_¢um
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
¢um
) {

332 
auth’tiÿtiÚ_šfo
->
¢um
 = (*) snum;

333 
	}
}

335 *
	$os_auth’tiÿtiÚ_šfo_g‘_¤ªd
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

336  
auth’tiÿtiÚ_šfo
->
¤ªd
;

337 
	}
}

339 
	$os_auth’tiÿtiÚ_šfo_£t_¤ªd
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
¤ªd
) {

340 
auth’tiÿtiÚ_šfo
->
¤ªd
 = (*) srand;

341 
	}
}

343 *
	$os_auth’tiÿtiÚ_šfo_g‘_rg‘Çme
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

344  
auth’tiÿtiÚ_šfo
->
rg‘Çme
;

345 
	}
}

347 
	$os_auth’tiÿtiÚ_šfo_£t_rg‘Çme
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
rg‘Çme
) {

348 
auth’tiÿtiÚ_šfo
->
rg‘Çme
 = (*)argetname;

349 
	}
}

351 *
	$os_auth’tiÿtiÚ_šfo_g‘_»®m
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

352  
auth’tiÿtiÚ_šfo
->
»®m
;

353 
	}
}

355 
	$os_auth’tiÿtiÚ_šfo_£t_»®m
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
»®m
) {

356 
auth’tiÿtiÚ_šfo
->
»®m
 = (*)„ealm;

357 
	}
}

359 *
	$os_auth’tiÿtiÚ_šfo_g‘_İaque
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

360  
auth’tiÿtiÚ_šfo
->
İaque
;

361 
	}
}

363 
	$os_auth’tiÿtiÚ_šfo_£t_İaque
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
, *
İaque
) {

364 
auth’tiÿtiÚ_šfo
->
İaque
 = (*) opaque;

365 
	}
}

370 
	$os_auth’tiÿtiÚ_šfo_to_¡r
(cÚ¡ 
os_auth’tiÿtiÚ_šfo_t
 *
ašfo
, **
de¡
) {

371 
size_t
 
Ën
;

372 *
tmp
, *
¡¬t
;

374 *
de¡
 = 
NULL
;

376 ià(
ašfo
 =ğ
NULL
)

377  
OSIP_BADPARAMETER
;

379 
Ën
 = 0;

381 ià(
ašfo
->
auth_ty³
 !ğ
NULL
)

382 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
auth_ty³
) + 1;

384 ià(
ašfo
->
ÃxŠÚû
 !ğ
NULL
)

385 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
ÃxŠÚû
) + 12;

387 ià(
ašfo
->
r¥auth
 !ğ
NULL
)

388 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
r¥auth
) + 10;

390 ià(
ašfo
->
úÚû
 !ğ
NULL
)

391 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
úÚû
) + 9;

393 ià(
ašfo
->
nÚû_couÁ
 !ğ
NULL
)

394 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
nÚû_couÁ
) + 5;

396 ià(
ašfo
->
qİ_İtiÚs
 !ğ
NULL
)

397 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
qİ_İtiÚs
) + 6;

399 ià(
ašfo
->
¢um
 !ğ
NULL
)

400 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
¢um
) + 7;

402 ià(
ašfo
->
¤ªd
 !ğ
NULL
)

403 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
¤ªd
) + 8;

405 ià(
ašfo
->
rg‘Çme
 !ğ
NULL
)

406 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
rg‘Çme
) + 13;

408 ià(
ašfo
->
»®m
 !ğ
NULL
)

409 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
»®m
) + 8;

411 ià(
ašfo
->
İaque
 !ğ
NULL
)

412 
Ën
 =†’ + 
	`¡¾’
(
ašfo
->
İaque
) + 9;

414 ià(
Ën
 == 0)

415  
OSIP_BADPARAMETER
;

417 
Ën
++;

418 
tmp
 = (*è
	`os_m®loc
(
Ën
);

420 ià(
tmp
 =ğ
NULL
)

421  
OSIP_NOMEM
;

423 *
de¡
 = 
tmp
;

425 
¡¬t
 = 
tmp
;

427 ià(
ašfo
->
auth_ty³
 !ğ
NULL
) {

428 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
auth_ty³
);

429 
tmp
 = 
	`os_¡r_­³nd
(tmp, " ");

430 
¡¬t
 = 
tmp
;

433 ià(
ašfo
->
qİ_İtiÚs
 !ğ
NULL
) {

434 ià(
tmp
 !ğ
¡¬t
) {

435 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

438 
tmp
 = 
	`os_¡º_­³nd
(tmp, "qop=", 4);

439 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
qİ_İtiÚs
);

442 ià(
ašfo
->
ÃxŠÚû
 !ğ
NULL
) {

443 ià(
tmp
 !ğ
¡¬t
) {

444 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

447 
tmp
 = 
	`os_¡º_­³nd
(tmp, "nextnonce=", 10);

448 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
ÃxŠÚû
);

451 ià(
ašfo
->
r¥auth
 !ğ
NULL
) {

452 ià(
tmp
 !ğ
¡¬t
) {

453 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

456 
tmp
 = 
	`os_¡º_­³nd
(tmp, "rspauth=", 8);

457 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
r¥auth
);

460 ià(
ašfo
->
úÚû
 !ğ
NULL
) {

461 ià(
tmp
 !ğ
¡¬t
) {

462 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

465 
tmp
 = 
	`os_¡º_­³nd
(tmp, "cnonce=", 7);

466 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
úÚû
);

469 ià(
ašfo
->
nÚû_couÁ
 !ğ
NULL
) {

470 ià(
tmp
 !ğ
¡¬t
) {

471 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

474 
tmp
 = 
	`os_¡º_­³nd
(tmp, "nc=", 3);

475 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
nÚû_couÁ
);

478 ià(
ašfo
->
¢um
 !ğ
NULL
) {

479 ià(
tmp
 !ğ
¡¬t
) {

480 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

483 
tmp
 = 
	`os_¡º_­³nd
(tmp, "snum=", 5);

484 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
¢um
);

487 ià(
ašfo
->
¤ªd
 !ğ
NULL
) {

488 ià(
tmp
 !ğ
¡¬t
) {

489 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

492 
tmp
 = 
	`os_¡º_­³nd
(tmp, "srand=", 6);

493 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
¤ªd
);

496 ià(
ašfo
->
rg‘Çme
 !ğ
NULL
) {

497 ià(
tmp
 !ğ
¡¬t
) {

498 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

501 
tmp
 = 
	`os_¡º_­³nd
(tmp, "targetname=", 11);

502 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
rg‘Çme
);

505 ià(
ašfo
->
»®m
 !ğ
NULL
) {

506 ià(
tmp
 !ğ
¡¬t
) {

507 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

510 
tmp
 = 
	`os_¡º_­³nd
(tmp, "realm=", 6);

511 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
»®m
);

514 ià(
ašfo
->
İaque
 !ğ
NULL
) {

515 ià(
tmp
 !ğ
¡¬t
) {

516 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", ", 2);

519 
tmp
 = 
	`os_¡º_­³nd
(tmp, "opaque=", 7);

520 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
ašfo
->
İaque
);

523  
OSIP_SUCCESS
;

524 
	}
}

528 
	$os_auth’tiÿtiÚ_šfo_ä“
(
os_auth’tiÿtiÚ_šfo_t
 *
auth’tiÿtiÚ_šfo
) {

529 ià(
auth’tiÿtiÚ_šfo
 =ğ
NULL
)

532 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
auth_ty³
);

533 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
ÃxŠÚû
);

534 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
r¥auth
);

535 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
úÚû
);

536 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
nÚû_couÁ
);

537 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
qİ_İtiÚs
);

538 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
¢um
);

539 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
¤ªd
);

540 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
rg‘Çme
);

541 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
»®m
);

542 
	`os_ä“
(
auth’tiÿtiÚ_šfo
->
İaque
);

543 
	`os_ä“
(
auth’tiÿtiÚ_šfo
);

544 
	}
}

546 
	$os_auth’tiÿtiÚ_šfo_şÚe
(cÚ¡ 
os_auth’tiÿtiÚ_šfo_t
 *
ašfo
, os_auth’tiÿtiÚ_šfo_ˆ**
de¡
) {

547 
i
;

548 
os_auth’tiÿtiÚ_šfo_t
 *
wa
;

550 *
de¡
 = 
NULL
;

552 ià(
ašfo
 =ğ
NULL
)

553  
OSIP_BADPARAMETER
;

555 
i
 = 
	`os_auth’tiÿtiÚ_šfo_š™
(&
wa
);

557 ià(
i
 != 0)

558  
i
;

560 ià(
ašfo
->
auth_ty³
 !ğ
NULL
)

561 
wa
->
auth_ty³
 = 
	`os_¡rdup
(
ašfo
->auth_type);

563 ià(
ašfo
->
ÃxŠÚû
 !ğ
NULL
)

564 
wa
->
ÃxŠÚû
 = 
	`os_¡rdup
(
ašfo
->nextnonce);

566 ià(
ašfo
->
úÚû
 !ğ
NULL
)

567 
wa
->
úÚû
 = 
	`os_¡rdup
(
ašfo
->cnonce);

569 ià(
ašfo
->
r¥auth
 !ğ
NULL
)

570 
wa
->
r¥auth
 = 
	`os_¡rdup
(
ašfo
->rspauth);

572 ià(
ašfo
->
nÚû_couÁ
 !ğ
NULL
)

573 
wa
->
nÚû_couÁ
 = 
	`os_¡rdup
(
ašfo
->nonce_count);

575 ià(
ašfo
->
qİ_İtiÚs
 !ğ
NULL
)

576 
wa
->
qİ_İtiÚs
 = 
	`os_¡rdup
(
ašfo
->qop_options);

578 ià(
ašfo
->
¢um
 !ğ
NULL
)

579 
wa
->
¢um
 = 
	`os_¡rdup
(
ašfo
->snum);

581 ià(
ašfo
->
¤ªd
 !ğ
NULL
)

582 
wa
->
¤ªd
 = 
	`os_¡rdup
(
ašfo
->srand);

584 ià(
ašfo
->
rg‘Çme
 !ğ
NULL
)

585 
wa
->
rg‘Çme
 = 
	`os_¡rdup
(
ašfo
->targetname);

587 ià(
ašfo
->
»®m
 !ğ
NULL
)

588 
wa
->
»®m
 = 
	`os_¡rdup
(
ašfo
->realm);

590 ià(
ašfo
->
İaque
 !ğ
NULL
)

591 
wa
->
İaque
 = 
	`os_¡rdup
(
ašfo
->opaque);

593 *
de¡
 = 
wa
;

594  
OSIP_SUCCESS
;

595 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authorization.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 
	$os_authÜiz©iÚ_š™
(
os_authÜiz©iÚ_t
 **
de¡
) {

28 *
de¡
 = (
os_authÜiz©iÚ_t
 *è
	`os_m®loc
((osip_authorization_t));

30 ià(*
de¡
 =ğ
NULL
)

31  
OSIP_NOMEM
;

33 
	`mem£t
(*
de¡
, 0, (
os_authÜiz©iÚ_t
));

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$os_mes§ge_£t_authÜiz©iÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

42 
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
;

43 
i
;

45 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

46  
OSIP_SUCCESS
;

48 ià(
s
 =ğ
NULL
)

49  
OSIP_BADPARAMETER
;

51 
i
 = 
	`os_authÜiz©iÚ_š™
(&
authÜiz©iÚ
);

53 ià(
i
 != 0)

54  
i
;

56 
i
 = 
	`os_authÜiz©iÚ_·r£
(
authÜiz©iÚ
, 
hv®ue
);

58 ià(
i
 != 0) {

59 
	`os_authÜiz©iÚ_ä“
(
authÜiz©iÚ
);

60  
i
;

63 
s
->
mes§ge_´İ”ty
 = 2;

64 
	`os_li¡_add
(&
s
->
authÜiz©iÚs
, 
authÜiz©iÚ
, -1);

65  
OSIP_SUCCESS
;

66 
	}
}

76 
	$os_authÜiz©iÚ_·r£
(
os_authÜiz©iÚ_t
 *
auth
, cÚ¡ *
hv®ue
) {

77 cÚ¡ *
¥aû
;

78 cÚ¡ *
Ãxt
 = 
NULL
;

79 
i
;

81 
¥aû
 = 
	`¡rchr
(
hv®ue
, ' ');

83 ià(
¥aû
 =ğ
NULL
)

84  
OSIP_SYNTAXERROR
;

86 ià(
¥aû
 - 
hv®ue
 < 1)

87  
OSIP_SYNTAXERROR
;

89 
auth
->
auth_ty³
 = (*è
	`os_m®loc
(
¥aû
 - 
hv®ue
 + 1);

91 ià(
auth
->
auth_ty³
 =ğ
NULL
)

92  
OSIP_NOMEM
;

94 
	`os_¡ºıy
(
auth
->
auth_ty³
, 
hv®ue
, 
¥aû
 - hvalue);

97 
·r£_ok
 = 0;

99 
i
 = 
	`__os_quÙed_¡ršg_£t
("u£ºame", 
¥aû
, &(
auth
->
u£ºame
), &
Ãxt
);

101 ià(
i
 != 0)

102  
i
;

104 ià(
Ãxt
 =ğ
NULL
)

105  
OSIP_SUCCESS
;

106 ià(
Ãxt
 !ğ
¥aû
) {

107 
¥aû
 = 
Ãxt
;

108 
·r£_ok
++;

111 
i
 = 
	`__os_quÙed_¡ršg_£t
("»®m", 
¥aû
, &(
auth
->
»®m
), &
Ãxt
);

113 ià(
i
 != 0)

114  
i
;

116 ià(
Ãxt
 =ğ
NULL
)

117  
OSIP_SUCCESS
;

119 ià(
Ãxt
 !ğ
¥aû
) {

120 
¥aû
 = 
Ãxt
;

121 
·r£_ok
++;

124 
i
 = 
	`__os_quÙed_¡ršg_£t
("nÚû", 
¥aû
, &(
auth
->
nÚû
), &
Ãxt
);

126 ià(
i
 != 0)

127  
i
;

129 ià(
Ãxt
 =ğ
NULL
)

130  
OSIP_SUCCESS
;

131 ià(
Ãxt
 !ğ
¥aû
) {

132 
¥aû
 = 
Ãxt
;

133 
·r£_ok
++;

136 
i
 = 
	`__os_quÙed_¡ršg_£t
("uri", 
¥aû
, &(
auth
->
uri
), &
Ãxt
);

138 ià(
i
 != 0)

139  
i
;

141 ià(
Ãxt
 =ğ
NULL
)

142  
OSIP_SUCCESS
;

143 ià(
Ãxt
 !ğ
¥aû
) {

144 
¥aû
 = 
Ãxt
;

145 
·r£_ok
++;

148 
i
 = 
	`__os_quÙed_¡ršg_£t
("»¥Ú£", 
¥aû
, &(
auth
->
»¥Ú£
), &
Ãxt
);

150 ià(
i
 != 0)

151  
i
;

153 ià(
Ãxt
 =ğ
NULL
)

154  
OSIP_SUCCESS
;

155 ià(
Ãxt
 !ğ
¥aû
) {

156 
¥aû
 = 
Ãxt
;

157 
·r£_ok
++;

160 
i
 = 
	`__os_quÙed_¡ršg_£t
("dige¡", 
¥aû
, &(
auth
->
dige¡
), &
Ãxt
);

162 ià(
i
 != 0)

163  
i
;

165 ià(
Ãxt
 =ğ
NULL
)

166  
OSIP_SUCCESS
;

167 ià(
Ãxt
 !ğ
¥aû
) {

168 
¥aû
 = 
Ãxt
;

169 
·r£_ok
++;

172 
i
 = 
	`__os_tok’_£t
("®gÜ™hm", 
¥aû
, &(
auth
->
®gÜ™hm
), &
Ãxt
);

174 ià(
i
 != 0)

175  
i
;

177 ià(
Ãxt
 =ğ
NULL
)

178  
OSIP_SUCCESS
;

179 ià(
Ãxt
 !ğ
¥aû
) {

180 
¥aû
 = 
Ãxt
;

181 
·r£_ok
++;

184 
i
 = 
	`__os_quÙed_¡ršg_£t
("úÚû", 
¥aû
, &(
auth
->
úÚû
), &
Ãxt
);

186 ià(
i
 != 0)

187  
i
;

189 ià(
Ãxt
 =ğ
NULL
)

190  
OSIP_SUCCESS
;

191 ià(
Ãxt
 !ğ
¥aû
) {

192 
¥aû
 = 
Ãxt
;

193 
·r£_ok
++;

196 
i
 = 
	`__os_quÙed_¡ršg_£t
("İaque", 
¥aû
, &(
auth
->
İaque
), &
Ãxt
);

198 ià(
i
 != 0)

199  
i
;

201 ià(
Ãxt
 =ğ
NULL
)

202  
OSIP_SUCCESS
;

203 ià(
Ãxt
 !ğ
¥aû
) {

204 
¥aû
 = 
Ãxt
;

205 
·r£_ok
++;

208 
i
 = 
	`__os_tok’_£t
("qİ", 
¥aû
, &(
auth
->
mes§ge_qİ
), &
Ãxt
);

210 ià(
i
 != 0)

211  
i
;

213 ià(
Ãxt
 =ğ
NULL
)

214  
OSIP_SUCCESS
;

215 ià(
Ãxt
 !ğ
¥aû
) {

216 
¥aû
 = 
Ãxt
;

217 
·r£_ok
++;

220 
i
 = 
	`__os_tok’_£t
("nc", 
¥aû
, &(
auth
->
nÚû_couÁ
), &
Ãxt
);

222 ià(
i
 != 0)

223  
i
;

225 ià(
Ãxt
 =ğ
NULL
)

226  
OSIP_SUCCESS
;

227 ià(
Ãxt
 !ğ
¥aû
) {

228 
¥aû
 = 
Ãxt
;

229 
·r£_ok
++;

232 
i
 = 
	`__os_tok’_£t
("v”siÚ", 
¥aû
, &(
auth
->
v”siÚ
), &
Ãxt
);

234 ià(
i
 != 0)

235  
i
;

237 ià(
Ãxt
 =ğ
NULL
)

238  
OSIP_SUCCESS
;

239 ià(
Ãxt
 !ğ
¥aû
) {

240 
¥aû
 = 
Ãxt
;

241 
·r£_ok
++;

244 
i
 = 
	`__os_quÙed_¡ršg_£t
("rg‘Çme", 
¥aû
, &(
auth
->
rg‘Çme
), &
Ãxt
);

246 ià(
i
 != 0)

247  
i
;

249 ià(
Ãxt
 =ğ
NULL
)

250  
OSIP_SUCCESS
;

251 ià(
Ãxt
 !ğ
¥aû
) {

252 
¥aû
 = 
Ãxt
;

253 
·r£_ok
++;

256 
i
 = 
	`__os_quÙed_¡ršg_£t
("gs§pi-d©a", 
¥aû
, &(
auth
->
gs§pi_d©a
), &
Ãxt
);

258 ià(
i
 != 0)

259  
i
;

261 ià(
Ãxt
 =ğ
NULL
)

262  
OSIP_SUCCESS
;

263 ià(
Ãxt
 !ğ
¥aû
) {

264 
¥aû
 = 
Ãxt
;

265 
·r£_ok
++;

268 
i
 = 
	`__os_quÙed_¡ršg_£t
("üªd", 
¥aû
, &(
auth
->
üªd
), &
Ãxt
);

270 ià(
i
 != 0)

271  
i
;

273 ià(
Ãxt
 =ğ
NULL
)

274  
OSIP_SUCCESS
;

275 ià(
Ãxt
 !ğ
¥aû
) {

276 
¥aû
 = 
Ãxt
;

277 
·r£_ok
++;

280 
i
 = 
	`__os_quÙed_¡ršg_£t
("úum", 
¥aû
, &(
auth
->
úum
), &
Ãxt
);

282 ià(
i
 != 0)

283  
i
;

285 ià(
Ãxt
 =ğ
NULL
)

286  
OSIP_SUCCESS
;

287 ià(
Ãxt
 !ğ
¥aû
) {

288 
¥aû
 = 
Ãxt
;

289 
·r£_ok
++;

297 ià(0 =ğ
·r£_ok
) {

298 cÚ¡ *
quÙe1
, *
quÙe2
, *
tmp
;

303 ià(
	`¡¾’
(
¥aû
) < 1)

304  
OSIP_SUCCESS
;

306 
tmp
 = 
	`¡rchr
(
¥aû
 + 1, ',');

308 ià(
tmp
 =ğ
NULL
)

309  
OSIP_SUCCESS
;

311 
quÙe1
 = 
	`__os_quÙe_fšd
(
¥aû
);

313 ià((
quÙe1
 !ğ
NULL
è&& (quÙe1 < 
tmp
)) {

314 
quÙe2
 = 
	`__os_quÙe_fšd
(
quÙe1
 + 1);

316 ià(
quÙe2
 =ğ
NULL
)

317  
OSIP_SYNTAXERROR
;

319 ià(
tmp
 < 
quÙe2
)

320 
¥aû
 = 
	`¡rchr
(
quÙe2
, ',');

323 
¥aû
 = 
tmp
;

325 ià(
¥aû
 =ğ
NULL
)

326  
OSIP_SUCCESS
;

329 
¥aû
 = 
tmp
;

335  
OSIP_SUCCESS
;

336 
	}
}

338 #iâdeà
MINISIZE


342 
	$os_mes§ge_g‘_authÜiz©iÚ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_authÜiz©iÚ_t
 **
de¡
) {

343 
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
;

345 *
de¡
 = 
NULL
;

347 ià(
	`os_li¡_size
(&
s
->
authÜiz©iÚs
è<ğ
pos
)

348  
OSIP_UNDEFINED_ERROR
;

350 
authÜiz©iÚ
 = (
os_authÜiz©iÚ_t
 *è
	`os_li¡_g‘
(&
s
->
authÜiz©iÚs
, 
pos
);

351 *
de¡
 = 
authÜiz©iÚ
;

352  
pos
;

353 
	}
}

356 *
	$os_authÜiz©iÚ_g‘_auth_ty³
(cÚ¡ 
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

357  
authÜiz©iÚ
->
auth_ty³
;

358 
	}
}

360 
	$os_authÜiz©iÚ_£t_auth_ty³
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
auth_ty³
) {

361 
authÜiz©iÚ
->
auth_ty³
 = (*)‡uth_type;

362 
	}
}

364 *
	$os_authÜiz©iÚ_g‘_u£ºame
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

365  
authÜiz©iÚ
->
u£ºame
;

366 
	}
}

368 
	$os_authÜiz©iÚ_£t_u£ºame
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
u£ºame
) {

369 
authÜiz©iÚ
->
u£ºame
 = (*) username;

370 
	}
}

372 *
	$os_authÜiz©iÚ_g‘_»®m
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

373  
authÜiz©iÚ
->
»®m
;

374 
	}
}

376 
	$os_authÜiz©iÚ_£t_»®m
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
»®m
) {

377 
authÜiz©iÚ
->
»®m
 = (*)„ealm;

378 
	}
}

380 *
	$os_authÜiz©iÚ_g‘_nÚû
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

381  
authÜiz©iÚ
->
nÚû
;

382 
	}
}

384 
	$os_authÜiz©iÚ_£t_nÚû
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
nÚû
) {

385 
authÜiz©iÚ
->
nÚû
 = (*)‚once;

386 
	}
}

388 *
	$os_authÜiz©iÚ_g‘_uri
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

389  
authÜiz©iÚ
->
uri
;

390 
	}
}

392 
	$os_authÜiz©iÚ_£t_uri
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
uri
) {

393 
authÜiz©iÚ
->
uri
 = (*) uri;

394 
	}
}

396 *
	$os_authÜiz©iÚ_g‘_»¥Ú£
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

397  
authÜiz©iÚ
->
»¥Ú£
;

398 
	}
}

400 
	$os_authÜiz©iÚ_£t_»¥Ú£
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
»¥Ú£
) {

401 
authÜiz©iÚ
->
»¥Ú£
 = (*)„esponse;

402 
	}
}

404 *
	$os_authÜiz©iÚ_g‘_dige¡
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

405  
authÜiz©iÚ
->
dige¡
;

406 
	}
}

408 
	$os_authÜiz©iÚ_£t_dige¡
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
dige¡
) {

409 
authÜiz©iÚ
->
dige¡
 = (*) digest;

410 
	}
}

412 *
	$os_authÜiz©iÚ_g‘_®gÜ™hm
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

413  
authÜiz©iÚ
->
®gÜ™hm
;

414 
	}
}

416 
	$os_authÜiz©iÚ_£t_®gÜ™hm
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
®gÜ™hm
) {

417 
authÜiz©iÚ
->
®gÜ™hm
 = (*)‡lgorithm;

418 
	}
}

420 *
	$os_authÜiz©iÚ_g‘_úÚû
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

421  
authÜiz©iÚ
->
úÚû
;

422 
	}
}

424 
	$os_authÜiz©iÚ_£t_úÚû
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
úÚû
) {

425 
authÜiz©iÚ
->
úÚû
 = (*) cnonce;

426 
	}
}

428 *
	$os_authÜiz©iÚ_g‘_İaque
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

429  
authÜiz©iÚ
->
İaque
;

430 
	}
}

432 
	$os_authÜiz©iÚ_£t_İaque
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
İaque
) {

433 
authÜiz©iÚ
->
İaque
 = (*) opaque;

434 
	}
}

436 *
	$os_authÜiz©iÚ_g‘_mes§ge_qİ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

437  
authÜiz©iÚ
->
mes§ge_qİ
;

438 
	}
}

440 
	$os_authÜiz©iÚ_£t_mes§ge_qİ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
mes§ge_qİ
) {

441 
authÜiz©iÚ
->
mes§ge_qİ
 = (*) message_qop;

442 
	}
}

444 *
	$os_authÜiz©iÚ_g‘_nÚû_couÁ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

445  
authÜiz©iÚ
->
nÚû_couÁ
;

446 
	}
}

448 
	$os_authÜiz©iÚ_£t_nÚû_couÁ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
nÚû_couÁ
) {

449 
authÜiz©iÚ
->
nÚû_couÁ
 = (*)‚once_count;

450 
	}
}

452 *
	$os_authÜiz©iÚ_g‘_v”siÚ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

453  
authÜiz©iÚ
->
v”siÚ
;

454 
	}
}

456 
	$os_authÜiz©iÚ_£t_v”siÚ
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
v”siÚ
) {

457 
authÜiz©iÚ
->
v”siÚ
 = (*) version;

458 
	}
}

460 *
	$os_authÜiz©iÚ_g‘_rg‘Çme
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

461  
authÜiz©iÚ
->
rg‘Çme
;

462 
	}
}

464 
	$os_authÜiz©iÚ_£t_rg‘Çme
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
rg‘Çme
) {

465 
authÜiz©iÚ
->
rg‘Çme
 = (*)argetname;

466 
	}
}

468 *
	$os_authÜiz©iÚ_g‘_gs§pi_d©a
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

469  
authÜiz©iÚ
->
gs§pi_d©a
;

470 
	}
}

472 
	$os_authÜiz©iÚ_£t_gs§pi_d©a
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
gs§pi_d©a
) {

473 
authÜiz©iÚ
->
gs§pi_d©a
 = (*) gssapi_data;

474 
	}
}

476 *
	$os_authÜiz©iÚ_g‘_üªd
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

477  
authÜiz©iÚ
->
üªd
;

478 
	}
}

480 
	$os_authÜiz©iÚ_£t_üªd
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
üªd
) {

481 
authÜiz©iÚ
->
üªd
 = (*) crand;

482 
	}
}

484 *
	$os_authÜiz©iÚ_g‘_úum
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

485  
authÜiz©iÚ
->
úum
;

486 
	}
}

488 
	$os_authÜiz©iÚ_£t_úum
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
, *
úum
) {

489 
authÜiz©iÚ
->
úum
 = (*) cnum;

490 
	}
}

495 
	$os_authÜiz©iÚ_to_¡r
(cÚ¡ 
os_authÜiz©iÚ_t
 *
auth
, **
de¡
) {

496 
size_t
 
Ën
;

497 *
tmp
;

498 
fœ¡
 = 1;

500 *
de¡
 = 
NULL
;

504 ià((
auth
 =ğ
NULL
è|| (auth->
auth_ty³
 =ğNULLè|| (auth->
»®m
 == NULL)

505 || (
auth
->
nÚû
 =ğ
NULL
))

506  
OSIP_BADPARAMETER
;

513 ià((
auth
 =ğ
NULL
è|| (auth->
auth_ty³
 == NULL))

514  
OSIP_BADPARAMETER
;

518 
Ën
 = 
	`¡¾’
(
auth
->
auth_ty³
) + 1;

520 ià(
auth
->
u£ºame
 !ğ
NULL
)

521 
Ën
 =†’ + 10 + 
	`¡¾’
(
auth
->
u£ºame
);

523 ià(
auth
->
»®m
 !ğ
NULL
)

524 
Ën
 =†’ + 8 + 
	`¡¾’
(
auth
->
»®m
);

526 ià(
auth
->
nÚû
 !ğ
NULL
)

527 
Ën
 =†’ + 8 + 
	`¡¾’
(
auth
->
nÚû
);

529 ià(
auth
->
uri
 !ğ
NULL
)

530 
Ën
 =†’ + 6 + 
	`¡¾’
(
auth
->
uri
);

532 ià(
auth
->
»¥Ú£
 !ğ
NULL
)

533 
Ën
 =†’ + 11 + 
	`¡¾’
(
auth
->
»¥Ú£
);

535 
Ën
 =†en + 2;

537 ià(
auth
->
dige¡
 !ğ
NULL
)

538 
Ën
 =†’ + 
	`¡¾’
(
auth
->
dige¡
) + 9;

540 ià(
auth
->
®gÜ™hm
 !ğ
NULL
)

541 
Ën
 =†’ + 
	`¡¾’
(
auth
->
®gÜ™hm
) + 12;

543 ià(
auth
->
úÚû
 !ğ
NULL
)

544 
Ën
 =†’ + 
	`¡¾’
(
auth
->
úÚû
) + 9;

546 ià(
auth
->
İaque
 !ğ
NULL
)

547 
Ën
 =†’ + 9 + 
	`¡¾’
(
auth
->
İaque
);

549 ià(
auth
->
nÚû_couÁ
 !ğ
NULL
)

550 
Ën
 =†’ + 
	`¡¾’
(
auth
->
nÚû_couÁ
) + 5;

552 ià(
auth
->
mes§ge_qİ
 !ğ
NULL
)

553 
Ën
 =†’ + 
	`¡¾’
(
auth
->
mes§ge_qİ
) + 6;

555 ià(
auth
->
v”siÚ
 !ğ
NULL
)

556 
Ën
 =†’ + 
	`¡¾’
(
auth
->
v”siÚ
) + 10;

558 ià(
auth
->
rg‘Çme
 !ğ
NULL
)

559 
Ën
 =†’ + 
	`¡¾’
(
auth
->
rg‘Çme
) + 13;

561 ià(
auth
->
gs§pi_d©a
 !ğ
NULL
)

562 
Ën
 =†’ + 
	`¡¾’
(
auth
->
gs§pi_d©a
) + 14;

564 ià(
auth
->
üªd
 !ğ
NULL
)

565 
Ën
 =†’ + 
	`¡¾’
(
auth
->
üªd
) + 8;

567 ià(
auth
->
úum
 !ğ
NULL
)

568 
Ën
 =†’ + 
	`¡¾’
(
auth
->
úum
) + 7;

570 
tmp
 = (*è
	`os_m®loc
(
Ën
);

572 ià(
tmp
 =ğ
NULL
)

573  
OSIP_NOMEM
;

575 *
de¡
 = 
tmp
;

577 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
auth_ty³
);

579 ià(
auth
->
u£ºame
 !ğ
NULL
) {

580 ià(!
fœ¡
)

581 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

583 
fœ¡
 = 0;

584 
tmp
 = 
	`os_¡º_­³nd
(tmp, " username=", 10);

586 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
u£ºame
);

589 ià(
auth
->
»®m
 !ğ
NULL
) {

590 ià(!
fœ¡
)

591 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

593 
fœ¡
 = 0;

594 
tmp
 = 
	`os_¡º_­³nd
(tmp, "„ealm=", 7);

596 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
»®m
);

599 ià(
auth
->
nÚû
 !ğ
NULL
) {

600 ià(!
fœ¡
)

601 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

603 
fœ¡
 = 0;

604 
tmp
 = 
	`os_¡º_­³nd
(tmp, "‚once=", 7);

606 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
nÚû
);

609 ià(
auth
->
uri
 !ğ
NULL
) {

610 ià(!
fœ¡
)

611 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

613 
fœ¡
 = 0;

614 
tmp
 = 
	`os_¡º_­³nd
(tmp, " uri=", 5);

616 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
uri
);

619 ià(
auth
->
»¥Ú£
 !ğ
NULL
) {

620 ià(!
fœ¡
)

621 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

623 
fœ¡
 = 0;

624 
tmp
 = 
	`os_¡º_­³nd
(tmp, "„esponse=", 10);

626 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
»¥Ú£
);

629 ià(
auth
->
dige¡
 !ğ
NULL
) {

630 ià(!
fœ¡
)

631 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

633 
fœ¡
 = 0;

634 
tmp
 = 
	`os_¡º_­³nd
(tmp, " digest=", 8);

636 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
dige¡
);

639 ià(
auth
->
®gÜ™hm
 !ğ
NULL
) {

640 ià(!
fœ¡
)

641 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

643 
fœ¡
 = 0;

644 
tmp
 = 
	`os_¡º_­³nd
(tmp, "‡lgorithm=", 11);

645 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
®gÜ™hm
);

648 ià(
auth
->
úÚû
 !ğ
NULL
) {

649 ià(!
fœ¡
)

650 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

652 
fœ¡
 = 0;

653 
tmp
 = 
	`os_¡º_­³nd
(tmp, " cnonce=", 8);

654 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
úÚû
);

657 ià(
auth
->
İaque
 !ğ
NULL
) {

658 ià(!
fœ¡
)

659 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

661 
fœ¡
 = 0;

662 
tmp
 = 
	`os_¡º_­³nd
(tmp, " opaque=", 8);

663 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
İaque
);

666 ià(
auth
->
mes§ge_qİ
 !ğ
NULL
) {

667 ià(!
fœ¡
)

668 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

670 
fœ¡
 = 0;

671 
tmp
 = 
	`os_¡º_­³nd
(tmp, " qop=", 5);

672 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
mes§ge_qİ
);

675 ià(
auth
->
nÚû_couÁ
 !ğ
NULL
) {

676 ià(!
fœ¡
)

677 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

679 
fœ¡
 = 0;

680 
tmp
 = 
	`os_¡º_­³nd
(tmp, "‚c=", 4);

681 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
nÚû_couÁ
);

684 ià(
auth
->
v”siÚ
 !ğ
NULL
) {

685 ià(!
fœ¡
)

686 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

688 
fœ¡
 = 0;

689 
tmp
 = 
	`os_¡º_­³nd
(tmp, " version=", 9);

690 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
v”siÚ
);

693 ià(
auth
->
rg‘Çme
 !ğ
NULL
) {

694 ià(!
fœ¡
)

695 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

697 
fœ¡
 = 0;

698 
tmp
 = 
	`os_¡º_­³nd
(tmp, "argetname=", 12);

699 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
rg‘Çme
);

702 ià(
auth
->
gs§pi_d©a
 !ğ
NULL
) {

703 ià(!
fœ¡
)

704 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

706 
fœ¡
 = 0;

707 
tmp
 = 
	`os_¡º_­³nd
(tmp, " gssapi-data=", 13);

708 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
gs§pi_d©a
);

711 ià(
auth
->
üªd
 !ğ
NULL
) {

712 ià(!
fœ¡
)

713 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

715 
fœ¡
 = 0;

716 
tmp
 = 
	`os_¡º_­³nd
(tmp, " crand=", 7);

717 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
üªd
);

720 ià(
auth
->
úum
 !ğ
NULL
) {

721 ià(!
fœ¡
)

722 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",", 1);

724 
fœ¡
 = 0;

725 
tmp
 = 
	`os_¡º_­³nd
(tmp, " cnum=", 6);

726 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
auth
->
úum
);

729  
OSIP_SUCCESS
;

730 
	}
}

734 
	$os_authÜiz©iÚ_ä“
(
os_authÜiz©iÚ_t
 *
authÜiz©iÚ
) {

735 ià(
authÜiz©iÚ
 =ğ
NULL
)

738 
	`os_ä“
(
authÜiz©iÚ
->
auth_ty³
);

739 
	`os_ä“
(
authÜiz©iÚ
->
u£ºame
);

740 
	`os_ä“
(
authÜiz©iÚ
->
»®m
);

741 
	`os_ä“
(
authÜiz©iÚ
->
nÚû
);

742 
	`os_ä“
(
authÜiz©iÚ
->
uri
);

743 
	`os_ä“
(
authÜiz©iÚ
->
»¥Ú£
);

744 
	`os_ä“
(
authÜiz©iÚ
->
dige¡
);

745 
	`os_ä“
(
authÜiz©iÚ
->
®gÜ™hm
);

746 
	`os_ä“
(
authÜiz©iÚ
->
úÚû
);

747 
	`os_ä“
(
authÜiz©iÚ
->
İaque
);

748 
	`os_ä“
(
authÜiz©iÚ
->
mes§ge_qİ
);

749 
	`os_ä“
(
authÜiz©iÚ
->
nÚû_couÁ
);

750 
	`os_ä“
(
authÜiz©iÚ
->
v”siÚ
);

751 
	`os_ä“
(
authÜiz©iÚ
->
rg‘Çme
);

752 
	`os_ä“
(
authÜiz©iÚ
->
gs§pi_d©a
);

753 
	`os_ä“
(
authÜiz©iÚ
->
üªd
);

754 
	`os_ä“
(
authÜiz©iÚ
->
úum
);

755 
	`os_ä“
(
authÜiz©iÚ
);

756 
	}
}

758 
	$os_authÜiz©iÚ_şÚe
(cÚ¡ 
os_authÜiz©iÚ_t
 *
auth
, os_authÜiz©iÚ_ˆ**
de¡
) {

759 
i
;

760 
os_authÜiz©iÚ_t
 *
au
;

762 *
de¡
 = 
NULL
;

764 ià(
auth
 =ğ
NULL
)

765  
OSIP_BADPARAMETER
;

777 
i
 = 
	`os_authÜiz©iÚ_š™
(&
au
);

779 ià(
i
 != 0)

780  
i
;

782 ià(
auth
->
auth_ty³
 !ğ
NULL
) {

783 
au
->
auth_ty³
 = 
	`os_¡rdup
(
auth
->auth_type);

785 ià(
au
->
auth_ty³
 =ğ
NULL
) {

786 
	`os_authÜiz©iÚ_ä“
(
au
);

787  
OSIP_NOMEM
;

791 ià(
auth
->
u£ºame
 !ğ
NULL
) {

792 
au
->
u£ºame
 = 
	`os_¡rdup
(
auth
->username);

794 ià(
au
->
u£ºame
 =ğ
NULL
) {

795 
	`os_authÜiz©iÚ_ä“
(
au
);

796  
OSIP_NOMEM
;

800 ià(
auth
->
»®m
 !ğ
NULL
) {

801 
au
->
»®m
 = 
	`os_¡rdup
(
auth
->realm);

803 ià(
auth
->
»®m
 =ğ
NULL
) {

804 
	`os_authÜiz©iÚ_ä“
(
au
);

805  
OSIP_NOMEM
;

809 ià(
auth
->
nÚû
 !ğ
NULL
) {

810 
au
->
nÚû
 = 
	`os_¡rdup
(
auth
->nonce);

812 ià(
auth
->
nÚû
 =ğ
NULL
) {

813 
	`os_authÜiz©iÚ_ä“
(
au
);

814  
OSIP_NOMEM
;

818 ià(
auth
->
uri
 !ğ
NULL
) {

819 
au
->
uri
 = 
	`os_¡rdup
(
auth
->uri);

821 ià(
au
->
uri
 =ğ
NULL
) {

822 
	`os_authÜiz©iÚ_ä“
(
au
);

823  
OSIP_NOMEM
;

827 ià(
auth
->
»¥Ú£
 !ğ
NULL
) {

828 
au
->
»¥Ú£
 = 
	`os_¡rdup
(
auth
->response);

830 ià(
auth
->
»¥Ú£
 =ğ
NULL
) {

831 
	`os_authÜiz©iÚ_ä“
(
au
);

832  
OSIP_NOMEM
;

836 ià(
auth
->
dige¡
 !ğ
NULL
) {

837 
au
->
dige¡
 = 
	`os_¡rdup
(
auth
->digest);

839 ià(
au
->
dige¡
 =ğ
NULL
) {

840 
	`os_authÜiz©iÚ_ä“
(
au
);

841  
OSIP_NOMEM
;

845 ià(
auth
->
®gÜ™hm
 !ğ
NULL
) {

846 
au
->
®gÜ™hm
 = 
	`os_¡rdup
(
auth
->algorithm);

848 ià(
auth
->
®gÜ™hm
 =ğ
NULL
) {

849 
	`os_authÜiz©iÚ_ä“
(
au
);

850  
OSIP_NOMEM
;

854 ià(
auth
->
úÚû
 !ğ
NULL
) {

855 
au
->
úÚû
 = 
	`os_¡rdup
(
auth
->cnonce);

857 ià(
au
->
úÚû
 =ğ
NULL
) {

858 
	`os_authÜiz©iÚ_ä“
(
au
);

859  
OSIP_NOMEM
;

863 ià(
auth
->
İaque
 !ğ
NULL
) {

864 
au
->
İaque
 = 
	`os_¡rdup
(
auth
->opaque);

866 ià(
auth
->
İaque
 =ğ
NULL
) {

867 
	`os_authÜiz©iÚ_ä“
(
au
);

868  
OSIP_NOMEM
;

872 ià(
auth
->
mes§ge_qİ
 !ğ
NULL
) {

873 
au
->
mes§ge_qİ
 = 
	`os_¡rdup
(
auth
->message_qop);

875 ià(
auth
->
mes§ge_qİ
 =ğ
NULL
) {

876 
	`os_authÜiz©iÚ_ä“
(
au
);

877  
OSIP_NOMEM
;

881 ià(
auth
->
nÚû_couÁ
 !ğ
NULL
) {

882 
au
->
nÚû_couÁ
 = 
	`os_¡rdup
(
auth
->nonce_count);

884 ià(
auth
->
nÚû_couÁ
 =ğ
NULL
) {

885 
	`os_authÜiz©iÚ_ä“
(
au
);

886  
OSIP_NOMEM
;

890 ià(
auth
->
v”siÚ
 !ğ
NULL
) {

891 
au
->
v”siÚ
 = 
	`os_¡rdup
(
auth
->version);

893 ià(
auth
->
v”siÚ
 =ğ
NULL
) {

894 
	`os_authÜiz©iÚ_ä“
(
au
);

895  
OSIP_NOMEM
;

899 ià(
auth
->
rg‘Çme
 !ğ
NULL
) {

900 
au
->
rg‘Çme
 = 
	`os_¡rdup
(
auth
->targetname);

902 ià(
auth
->
rg‘Çme
 =ğ
NULL
) {

903 
	`os_authÜiz©iÚ_ä“
(
au
);

904  
OSIP_NOMEM
;

908 ià(
auth
->
gs§pi_d©a
 !ğ
NULL
) {

909 
au
->
gs§pi_d©a
 = 
	`os_¡rdup
(
auth
->gssapi_data);

911 ià(
auth
->
gs§pi_d©a
 =ğ
NULL
) {

912 
	`os_authÜiz©iÚ_ä“
(
au
);

913  
OSIP_NOMEM
;

917 ià(
auth
->
üªd
 !ğ
NULL
) {

918 
au
->
üªd
 = 
	`os_¡rdup
(
auth
->crand);

920 ià(
auth
->
üªd
 =ğ
NULL
) {

921 
	`os_authÜiz©iÚ_ä“
(
au
);

922  
OSIP_NOMEM
;

926 ià(
auth
->
úum
 !ğ
NULL
) {

927 
au
->
úum
 = 
	`os_¡rdup
(
auth
->cnum);

929 ià(
auth
->
úum
 =ğ
NULL
) {

930 
	`os_authÜiz©iÚ_ä“
(
au
);

931  
OSIP_NOMEM
;

935 *
de¡
 = 
au
;

936  
OSIP_SUCCESS
;

937 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_body.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~<os·r£r2/os_body.h
>

26 
	~"·r£r.h
"

28 
os_body_·r£_h—d”
(
os_body_t
 *
body
, cÚ¡ *
¡¬t_of_os_body_h—d”
, cÚ¡ **
Ãxt_body
);

30 
	$os_body_š™
(
os_body_t
 **
body
) {

31 *
body
 = (
os_body_t
 *è
	`os_m®loc
((osip_body_t));

33 ià(*
body
 =ğ
NULL
)

34  
OSIP_NOMEM
;

36 (*
body
)->body = 
NULL
;

37 (*
body
)->
cÚ‹Á_ty³
 = 
NULL
;

38 (*
body
)->
Ëngth
 = 0;

40 (*
body
)->
h—d”s
 = (
os_li¡_t
 *è
	`os_m®loc
((osip_list_t));

42 ià((*
body
)->
h—d”s
 =ğ
NULL
) {

43 
	`os_ä“
(*
body
);

44 *
body
 = 
NULL
;

45  
OSIP_NOMEM
;

48 
	`os_li¡_š™
((*
body
)->
h—d”s
);

49  
OSIP_SUCCESS
;

50 
	}
}

52 
	$os_mes§ge_£t_body
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
) {

53 
os_body_t
 *
body
;

54 
i
;

56 
i
 = 
	`os_body_š™
(&
body
);

58 ià(
i
 != 0)

59  
i
;

61 
i
 = 
	`os_body_·r£
(
body
, 
buf
, 
Ëngth
);

63 ià(
i
 != 0) {

64 
	`os_body_ä“
(
body
);

65  
i
;

68 
s
->
mes§ge_´İ”ty
 = 2;

69 
	`os_li¡_add
(&
s
->
bod›s
, 
body
, -1);

70  
OSIP_SUCCESS
;

71 
	}
}

73 
	$os_body_şÚe
(cÚ¡ 
os_body_t
 *
body
, os_body_ˆ**
de¡
) {

74 
i
;

75 
os_body_t
 *
cİy
;

77 ià(
body
 =ğ
NULL
 || body->
Ëngth
 <= 0)

78  
OSIP_BADPARAMETER
;

80 
i
 = 
	`os_body_š™
(&
cİy
);

82 ià(
i
 != 0)

83  
i
;

85 
cİy
->
body
 = (*è
	`os_m®loc
(body->
Ëngth
 + 2);

87 ià(
cİy
->
body
 =ğ
NULL
) {

88 
	`os_body_ä“
(
cİy
);

89  
OSIP_NOMEM
;

92 
cİy
->
Ëngth
 = 
body
->length;

93 
	`memıy
(
cİy
->
body
, body->body, body->
Ëngth
);

94 
cİy
->
body
[body->
Ëngth
] = '\0';

96 ià(
body
->
cÚ‹Á_ty³
 !ğ
NULL
) {

97 
i
 = 
	`os_cÚ‹Á_ty³_şÚe
(
body
->
cÚ‹Á_ty³
, &(
cİy
->content_type));

99 ià(
i
 != 0) {

100 
	`os_body_ä“
(
cİy
);

101  
i
;

105 
i
 = 
	`os_li¡_şÚe
(
body
->
h—d”s
, 
cİy
->h—d”s, ((*)(*, **)è& 
os_h—d”_şÚe
);

107 ià(
i
 != 0) {

108 
	`os_body_ä“
(
cİy
);

109  
i
;

112 *
de¡
 = 
cİy
;

113  
OSIP_SUCCESS
;

114 
	}
}

116 #iâdeà
MINISIZE


122 
	$os_mes§ge_g‘_body
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_body_t
 **
de¡
) {

123 
os_body_t
 *
body
;

125 *
de¡
 = 
NULL
;

127 ià(
	`os_li¡_size
(&
s
->
bod›s
è<ğ
pos
)

128  
OSIP_UNDEFINED_ERROR
;

130 
body
 = (
os_body_t
 *è
	`os_li¡_g‘
(&
s
->
bod›s
, 
pos
);

131 *
de¡
 = 
body
;

132  
pos
;

133 
	}
}

136 
	$os_body_£t_cÚ‹Áty³
(
os_body_t
 *
body
, cÚ¡ *
hv®ue
) {

137 
i
;

139 ià(
body
 =ğ
NULL
)

140  
OSIP_BADPARAMETER
;

142 ià(
hv®ue
 =ğ
NULL
)

143  
OSIP_BADPARAMETER
;

145 
i
 = 
	`os_cÚ‹Á_ty³_š™
(&(
body
->
cÚ‹Á_ty³
));

147 ià(
i
 != 0)

148  
i
;

150 
i
 = 
	`os_cÚ‹Á_ty³_·r£
(
body
->
cÚ‹Á_ty³
, 
hv®ue
);

152 ià(
i
 != 0) {

153 
	`os_cÚ‹Á_ty³_ä“
(
body
->
cÚ‹Á_ty³
);

154 
body
->
cÚ‹Á_ty³
 = 
NULL
;

155  
i
;

158  
OSIP_SUCCESS
;

159 
	}
}

161 
	$os_body_£t_h—d”
(
os_body_t
 *
body
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
) {

162 
os_h—d”_t
 *
h
;

163 
i
;

165 ià(
body
 =ğ
NULL
)

166  
OSIP_BADPARAMETER
;

168 ià(
hÇme
 =ğ
NULL
)

169  
OSIP_BADPARAMETER
;

171 ià(
hv®ue
 =ğ
NULL
)

172  
OSIP_BADPARAMETER
;

174 
i
 = 
	`os_h—d”_š™
(&
h
);

176 ià(
i
 != 0)

177  
i
;

179 
h
->
hÇme
 = 
	`os_¡rdup
(hname);

181 ià(
h
->
hÇme
 =ğ
NULL
) {

182 
	`os_h—d”_ä“
(
h
);

183  
OSIP_NOMEM
;

186 
h
->
hv®ue
 = 
	`os_¡rdup
(hvalue);

188 ià(
h
->
hv®ue
 =ğ
NULL
) {

189 
	`os_h—d”_ä“
(
h
);

190  
OSIP_NOMEM
;

193 
	`os_li¡_add
(
body
->
h—d”s
, 
h
, -1);

194  
OSIP_SUCCESS
;

195 
	}
}

201 
	$os_mes§ge_£t_body_mime
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
) {

202 
os_body_t
 *
body
;

203 
i
;

205 ià(
s
 =ğ
NULL
)

206  
OSIP_BADPARAMETER
;

208 
i
 = 
	`os_body_š™
(&
body
);

210 ià(
i
 != 0)

211  
i
;

213 
i
 = 
	`os_body_·r£_mime
(
body
, 
buf
, 
Ëngth
);

215 ià(
i
 != 0) {

216 
	`os_body_ä“
(
body
);

217  
i
;

220 
s
->
mes§ge_´İ”ty
 = 2;

221 
	`os_li¡_add
(&
s
->
bod›s
, 
body
, -1);

222  
OSIP_SUCCESS
;

223 
	}
}

225 
	$os_body_·r£_h—d”
(
os_body_t
 *
body
, cÚ¡ *
¡¬t_of_os_body_h—d”
, cÚ¡ **
Ãxt_body
) {

226 cÚ¡ *
¡¬t_of_lše
;

227 cÚ¡ *
’d_of_lše
;

228 cÚ¡ *
cŞÚ_šdex
;

229 *
hÇme
;

230 *
hv®ue
;

231 
i
;

233 *
Ãxt_body
 = 
NULL
;

234 
¡¬t_of_lše
 = 
¡¬t_of_os_body_h—d”
;

237 
i
 = 
	`__os_fšd_Ãxt_ülf
(
¡¬t_of_lše
, &
’d_of_lše
);

239 ià(
i
 == -2) {

240 } ià(
i
 != 0)

241  
i
;

244 
cŞÚ_šdex
 = 
	`¡rchr
(
¡¬t_of_lše
, ':');

246 ià(
cŞÚ_šdex
 =ğ
NULL
)

247  
OSIP_SYNTAXERROR
;

249 ià(
cŞÚ_šdex
 - 
¡¬t_of_lše
 + 1 < 2)

250  
OSIP_SYNTAXERROR
;

252 
hÇme
 = (*è
	`os_m®loc
(
cŞÚ_šdex
 - 
¡¬t_of_lše
 + 1);

254 ià(
hÇme
 =ğ
NULL
)

255  
OSIP_NOMEM
;

257 
	`os_şºıy
(
hÇme
, 
¡¬t_of_lše
, 
cŞÚ_šdex
 - start_of_line);

259 ià((
’d_of_lše
 - 2è- 
cŞÚ_šdex
 < 2) {

260 
	`os_ä“
(
hÇme
);

261  
OSIP_SYNTAXERROR
;

264 
hv®ue
 = (*è
	`os_m®loc
((
’d_of_lše
 - 2è- 
cŞÚ_šdex
);

266 ià(
hv®ue
 =ğ
NULL
) {

267 
	`os_ä“
(
hÇme
);

268  
OSIP_NOMEM
;

271 
	`os_şºıy
(
hv®ue
, 
cŞÚ_šdex
 + 1, (
’d_of_lše
 - 2) - colon_index - 1);

274 ià(
	`os_¡ºÿ£cmp
(
hÇme
, "content-type", 12) == 0)

275 
i
 = 
	`os_body_£t_cÚ‹Áty³
(
body
, 
hv®ue
);

278 
i
 = 
	`os_body_£t_h—d”
(
body
, 
hÇme
, 
hv®ue
);

280 
	`os_ä“
(
hÇme
);

281 
	`os_ä“
(
hv®ue
);

283 ià(
i
 != 0)

284  
i
;

286 ià(
	`¡ºcmp
(
’d_of_lše
, 
OSIP_CRLF
, 2) == 0 || strncmp(end_of_line, "\n", 1) == 0 || strncmp(end_of_line, "\r", 1) == 0) {

287 *
Ãxt_body
 = 
’d_of_lše
;

288  
OSIP_SUCCESS
;

291 
¡¬t_of_lše
 = 
’d_of_lše
;

293 
	}
}

295 
	$os_body_·r£
(
os_body_t
 *
body
, cÚ¡ *
¡¬t_of_body
, 
size_t
 
Ëngth
) {

296 ià(
body
 =ğ
NULL
)

297  
OSIP_BADPARAMETER
;

299 ià(
¡¬t_of_body
 =ğ
NULL
)

300  
OSIP_BADPARAMETER
;

302 ià(
body
->
h—d”s
 =ğ
NULL
)

303  
OSIP_BADPARAMETER
;

305 
body
->body = (*è
	`os_m®loc
(
Ëngth
 + 1);

307 ià(
body
->body =ğ
NULL
)

308  
OSIP_NOMEM
;

310 
	`memıy
(
body
->body, 
¡¬t_of_body
, 
Ëngth
);

311 
body
->body[
Ëngth
] = '\0';

312 
body
->
Ëngth
 =†ength;

313  
OSIP_SUCCESS
;

314 
	}
}

316 
	$os_body_·r£_mime
(
os_body_t
 *
body
, cÚ¡ *
¡¬t_of_body
, 
size_t
 
Ëngth
) {

317 cÚ¡ *
’d_of_os_body_h—d”
;

318 cÚ¡ *
¡¬t_of_os_body_h—d”
;

319 
i
;

321 ià(
body
 =ğ
NULL
)

322  
OSIP_BADPARAMETER
;

324 ià(
¡¬t_of_body
 =ğ
NULL
)

325  
OSIP_BADPARAMETER
;

327 ià(
body
->
h—d”s
 =ğ
NULL
)

328  
OSIP_BADPARAMETER
;

330 
¡¬t_of_os_body_h—d”
 = 
¡¬t_of_body
;

332 
i
 = 
	`os_body_·r£_h—d”
(
body
, 
¡¬t_of_os_body_h—d”
, &
’d_of_os_body_h—d”
);

334 ià(
i
 != 0)

335  
i
;

337 
¡¬t_of_os_body_h—d”
 = 
’d_of_os_body_h—d”
;

340 ià(
	`¡ºcmp
(
¡¬t_of_os_body_h—d”
, 
OSIP_CRLF
, 2) == 0)

341 
¡¬t_of_os_body_h—d”
 = start_of_osip_body_header + 2;

344 ià((
	`¡ºcmp
(
¡¬t_of_os_body_h—d”
, "\n", 1) == 0) || (strncmp(start_of_osip_body_header, "\r", 1) == 0))

345 
¡¬t_of_os_body_h—d”
 = start_of_osip_body_header + 1;

348  
OSIP_SYNTAXERROR
;

351 
’d_of_os_body_h—d”
 = 
¡¬t_of_body
 + 
Ëngth
;

353 ià(
’d_of_os_body_h—d”
 - 
¡¬t_of_os_body_h—d”
 <= 0)

354  
OSIP_SYNTAXERROR
;

356 
body
->body = (*è
	`os_m®loc
(
’d_of_os_body_h—d”
 - 
¡¬t_of_os_body_h—d”
 + 1);

358 ià(
body
->body =ğ
NULL
)

359  
OSIP_NOMEM
;

361 
	`memıy
(
body
->body, 
¡¬t_of_os_body_h—d”
, 
’d_of_os_body_h—d”
 - start_of_osip_body_header);

362 
body
->
Ëngth
 = 
’d_of_os_body_h—d”
 - 
¡¬t_of_os_body_h—d”
;

364 
body
->body[body->
Ëngth
] = '\0';

366  
OSIP_SUCCESS
;

367 
	}
}

372 
	$os_body_to_¡r
(cÚ¡ 
os_body_t
 *
body
, **
de¡
, 
size_t
 *
¡r_Ëngth
) {

373 *
tmp_body
;

374 *
tmp
;

375 *
±r
;

376 
i
;

377 
size_t
 
Ëngth
;

379 ià(
de¡
)

380 *
de¡
 = 
NULL
;

382 ià(
¡r_Ëngth
)

383 *
¡r_Ëngth
 = 0;

385 ià(
body
 =ğ
NULL
)

386  
OSIP_BADPARAMETER
;

388 ià(
body
->body =ğ
NULL
)

389  
OSIP_BADPARAMETER
;

391 ià(
body
->
h—d”s
 =ğ
NULL
)

392  
OSIP_BADPARAMETER
;

394 ià(
body
->
Ëngth
 <= 0)

395  
OSIP_BADPARAMETER
;

397 
Ëngth
 = 15 + 
body
->Ëngth + (
	`os_li¡_size
(body->
h—d”s
) * 40);

398 
tmp_body
 = (*è
	`os_m®loc
(
Ëngth
);

400 ià(
tmp_body
 =ğ
NULL
)

401  
OSIP_NOMEM
;

403 
±r
 = 
tmp_body
;

405 ià(
body
->
cÚ‹Á_ty³
 !ğ
NULL
) {

406 
tmp_body
 = 
	`os_¡º_­³nd
(tmp_body, "content-type: ", 14);

407 
i
 = 
	`os_cÚ‹Á_ty³_to_¡r
(
body
->
cÚ‹Á_ty³
, &
tmp
);

409 ià(
i
 != 0) {

410 
	`os_ä“
(
±r
);

411  
i
;

414 ià(
Ëngth
 < 
tmp_body
 - 
±r
 + 
	`¡¾’
(
tmp
) + 4) {

415 
size_t
 
Ën
;

417 
Ën
 = 
tmp_body
 - 
±r
;

418 
Ëngth
 =†’gth + 
	`¡¾’
(
tmp
) + 4;

419 
±r
 = 
	`os_»®loc
ÕŒ, 
Ëngth
);

420 
tmp_body
 = 
±r
 + 
Ën
;

423 
tmp_body
 = 
	`os_¡r_­³nd
Ñmp_body, 
tmp
);

424 
	`os_ä“
(
tmp
);

425 
tmp_body
 = 
	`os_¡º_­³nd
Ñmp_body, 
OSIP_CRLF
, 2);

429 
os_li¡_™”©Ü_t
 
™
;

430 
os_h—d”_t
 *
h—d”
 = (os_h—d”_ˆ*è
	`os_li¡_g‘_fœ¡
(
body
->
h—d”s
, &
™
);

432 
h—d”
 !ğ
OSIP_SUCCESS
) {

433 
i
 = 
	`os_h—d”_to_¡r
(
h—d”
, &
tmp
);

435 ià(
i
 != 0) {

436 
	`os_ä“
(
±r
);

437  
i
;

440 ià(
Ëngth
 < 
tmp_body
 - 
±r
 + 
	`¡¾’
(
tmp
) + 4) {

441 
size_t
 
Ën
;

443 
Ën
 = 
tmp_body
 - 
±r
;

444 
Ëngth
 =†’gth + 
	`¡¾’
(
tmp
) + 4;

445 
±r
 = 
	`os_»®loc
ÕŒ, 
Ëngth
);

446 
tmp_body
 = 
±r
 + 
Ën
;

449 
tmp_body
 = 
	`os_¡r_­³nd
Ñmp_body, 
tmp
);

450 
	`os_ä“
(
tmp
);

451 
tmp_body
 = 
	`os_¡º_­³nd
Ñmp_body, 
OSIP_CRLF
, 2);

452 
h—d”
 = (
os_h—d”_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

456 ià((
	`os_li¡_size
(
body
->
h—d”s
è> 0è|| (body->
cÚ‹Á_ty³
 !ğ
NULL
)) {

457 ià(
Ëngth
 < (
size_t
)(
tmp_body
 - 
±r
 + 3)) {

458 
size_t
 
Ën
;

460 
Ën
 = 
tmp_body
 - 
±r
;

461 
Ëngth
 =†’gth + 3 + 
body
->length;

462 
±r
 = 
	`os_»®loc
ÕŒ, 
Ëngth
);

463 
tmp_body
 = 
±r
 + 
Ën
;

466 
tmp_body
 = 
	`os_¡º_­³nd
Ñmp_body, 
OSIP_CRLF
, 2);

469 ià(
Ëngth
 < 
tmp_body
 - 
±r
 + 
body
->length + 4) {

470 
size_t
 
Ën
;

472 
Ën
 = 
tmp_body
 - 
±r
;

473 
Ëngth
 =†’gth + 
body
->length + 4;

474 
±r
 = 
	`os_»®loc
ÕŒ, 
Ëngth
);

475 
tmp_body
 = 
±r
 + 
Ën
;

478 
	`memıy
(
tmp_body
, 
body
->body, body->
Ëngth
);

479 
tmp_body
 =mp_body + 
body
->
Ëngth
;

482 ià(
¡r_Ëngth
 !ğ
NULL
)

483 *
¡r_Ëngth
 = 
tmp_body
 - 
±r
;

485 *
de¡
 = 
±r
;

486  
OSIP_SUCCESS
;

487 
	}
}

491 
	$os_body_ä“
(
os_body_t
 *
body
) {

492 ià(
body
 =ğ
NULL
)

495 
	`os_ä“
(
body
->body);

497 ià(
body
->
cÚ‹Á_ty³
 !ğ
NULL
) {

498 
	`os_cÚ‹Á_ty³_ä“
(
body
->
cÚ‹Á_ty³
);

501 
	`os_li¡_¥ecŸl_ä“
(
body
->
h—d”s
, ((*)(*)è& 
os_h—d”_ä“
);

502 
	`os_ä“
(
body
->
h—d”s
);

503 
	`os_ä“
(
body
);

504 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_id.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

30 
	$os_mes§ge_£t_ÿÎ_id
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 ià(
s
->
ÿÎ_id
 !ğ
NULL
)

37  
OSIP_SYNTAXERROR
;

39 
i
 = 
	`os_ÿÎ_id_š™
(&(
s
->
ÿÎ_id
));

41 ià(
i
 != 0)

42  
i
;

44 
s
->
mes§ge_´İ”ty
 = 2;

45 
i
 = 
	`os_ÿÎ_id_·r£
(
s
->
ÿÎ_id
, 
hv®ue
);

47 ià(
i
 != 0) {

48 
	`os_ÿÎ_id_ä“
(
s
->
ÿÎ_id
);

49 
s
->
ÿÎ_id
 = 
NULL
;

50  
i
;

53  
OSIP_SUCCESS
;

54 
	}
}

56 #iâdeà
MINISIZE


59 
os_ÿÎ_id_t
 *
	$os_mes§ge_g‘_ÿÎ_id
(cÚ¡ 
os_mes§ge_t
 *
s
) {

60  
s
->
ÿÎ_id
;

61 
	}
}

64 
	$os_ÿÎ_id_š™
(
os_ÿÎ_id_t
 **
ÿÎid
) {

65 *
ÿÎid
 = (
os_ÿÎ_id_t
 *è
	`os_m®loc
((osip_call_id_t));

67 ià(*
ÿÎid
 =ğ
NULL
)

68  
OSIP_NOMEM
;

70 (*
ÿÎid
)->
numb”
 = 
NULL
;

71 (*
ÿÎid
)->
ho¡
 = 
NULL
;

72  
OSIP_SUCCESS
;

73 
	}
}

77 
	$os_ÿÎ_id_ä“
(
os_ÿÎ_id_t
 *
ÿÎid
) {

78 ià(
ÿÎid
 =ğ
NULL
)

81 
	`os_ä“
(
ÿÎid
->
numb”
);

82 
	`os_ä“
(
ÿÎid
->
ho¡
);

84 
ÿÎid
->
numb”
 = 
NULL
;

85 
ÿÎid
->
ho¡
 = 
NULL
;

87 
	`os_ä“
(
ÿÎid
);

88 
	}
}

94 
	$os_ÿÎ_id_·r£
(
os_ÿÎ_id_t
 *
ÿÎid
, cÚ¡ *
hv®ue
) {

95 cÚ¡ *
ho¡
;

96 cÚ¡ *
’d
;

98 
ÿÎid
->
numb”
 = 
NULL
;

99 
ÿÎid
->
ho¡
 = 
NULL
;

101 
ho¡
 = 
	`¡rchr
(
hv®ue
, '@');

102 
’d
 = 
hv®ue
 + 
	`¡¾’
(hvalue);

104 ià(
ho¡
 =ğ
NULL
)

105 
ho¡
 = 
’d
;

108 ià(
’d
 - 
ho¡
 + 1 < 2)

109  
OSIP_SYNTAXERROR
;

111 
ÿÎid
->
ho¡
 = (*è
	`os_m®loc
(
’d
 - host);

113 ià(
ÿÎid
->
ho¡
 =ğ
NULL
)

114  
OSIP_NOMEM
;

116 
	`os_şºıy
(
ÿÎid
->
ho¡
, ho¡ + 1, 
’d
 - host - 1);

119 ià(
ho¡
 - 
hv®ue
 + 1 < 2)

120  
OSIP_SYNTAXERROR
;

122 
ÿÎid
->
numb”
 = (*è
	`os_m®loc
(
ho¡
 - 
hv®ue
 + 1);

124 ià(
ÿÎid
->
numb”
 =ğ
NULL
)

125  
OSIP_NOMEM
;

127 
	`os_şºıy
(
ÿÎid
->
numb”
, 
hv®ue
, 
ho¡
 - hvalue);

129  
OSIP_SUCCESS
;

130 
	}
}

135 
	$os_ÿÎ_id_to_¡r
(cÚ¡ 
os_ÿÎ_id_t
 *
ÿÎid
, **
de¡
) {

136 *
de¡
 = 
NULL
;

138 ià((
ÿÎid
 =ğ
NULL
è|| (ÿÎid->
numb”
 == NULL))

139  
OSIP_BADPARAMETER
;

141 ià(
ÿÎid
->
ho¡
 =ğ
NULL
) {

142 *
de¡
 = (*è
	`os_m®loc
(
	`¡¾’
(
ÿÎid
->
numb”
) + 1);

144 ià(*
de¡
 =ğ
NULL
)

145  
OSIP_NOMEM
;

147 
	`¥rštf
(*
de¡
, "%s", 
ÿÎid
->
numb”
);

150 *
de¡
 = (*è
	`os_m®loc
(
	`¡¾’
(
ÿÎid
->
numb”
è+ sŒËn(ÿÎid->
ho¡
) + 2);

152 ià(*
de¡
 =ğ
NULL
)

153  
OSIP_NOMEM
;

155 
	`¥rštf
(*
de¡
, "%s@%s", 
ÿÎid
->
numb”
, c®lid->
ho¡
);

158  
OSIP_SUCCESS
;

159 
	}
}

161 *
	$os_ÿÎ_id_g‘_numb”
(
os_ÿÎ_id_t
 *
ÿÎid
) {

162 ià(
ÿÎid
 =ğ
NULL
)

163  
NULL
;

165  
ÿÎid
->
numb”
;

166 
	}
}

168 *
	$os_ÿÎ_id_g‘_ho¡
(
os_ÿÎ_id_t
 *
ÿÎid
) {

169 ià(
ÿÎid
 =ğ
NULL
)

170  
NULL
;

172  
ÿÎid
->
ho¡
;

173 
	}
}

175 
	$os_ÿÎ_id_£t_numb”
(
os_ÿÎ_id_t
 *
ÿÎid
, *
numb”
) {

176 
ÿÎid
->
numb”
 =‚umber;

177 
	}
}

179 
	$os_ÿÎ_id_£t_ho¡
(
os_ÿÎ_id_t
 *
ÿÎid
, *
ho¡
) {

180 
ÿÎid
->
ho¡
 = host;

181 
	}
}

183 
	$os_ÿÎ_id_şÚe
(cÚ¡ 
os_ÿÎ_id_t
 *
ÿÎid
, os_ÿÎ_id_ˆ**
de¡
) {

184 
i
;

185 
os_ÿÎ_id_t
 *
ci
;

187 *
de¡
 = 
NULL
;

189 ià(
ÿÎid
 =ğ
NULL
)

190  
OSIP_BADPARAMETER
;

192 ià(
ÿÎid
->
numb”
 =ğ
NULL
)

193  
OSIP_BADPARAMETER
;

195 
i
 = 
	`os_ÿÎ_id_š™
(&
ci
);

197 ià(
i
 != 0)

198  
i
;

200 
ci
->
numb”
 = 
	`os_¡rdup
(
ÿÎid
->number);

202 ià(
ÿÎid
->
ho¡
 !ğ
NULL
)

203 
ci
->
ho¡
 = 
	`os_¡rdup
(
ÿÎid
->host);

205 *
de¡
 = 
ci
;

206  
OSIP_SUCCESS
;

207 
	}
}

209 
	$os_ÿÎ_id_m©ch
(
os_ÿÎ_id_t
 *
ÿÎid1
, os_ÿÎ_id_ˆ*
ÿÎid2
) {

210 ià(
ÿÎid1
 =ğ
NULL
 || 
ÿÎid2
 == NULL)

211  
OSIP_BADPARAMETER
;

213 ià(
ÿÎid1
->
numb”
 =ğ
NULL
 || 
ÿÎid2
->number == NULL)

214  
OSIP_BADPARAMETER
;

216 ià(0 !ğ
	`¡rcmp
(
ÿÎid1
->
numb”
, 
ÿÎid2
->number))

217  
OSIP_UNDEFINED_ERROR
;

219 ià((
ÿÎid1
->
ho¡
 =ğ
NULL
è&& (
ÿÎid2
->host == NULL))

220  
OSIP_SUCCESS
;

222 ià((
ÿÎid1
->
ho¡
 =ğ
NULL
è&& (
ÿÎid2
->host != NULL))

223  
OSIP_UNDEFINED_ERROR
;

225 ià((
ÿÎid1
->
ho¡
 !ğ
NULL
è&& (
ÿÎid2
->host == NULL))

226  
OSIP_UNDEFINED_ERROR
;

228 ià(0 !ğ
	`¡rcmp
(
ÿÎid1
->
ho¡
, 
ÿÎid2
->host))

229  
OSIP_UNDEFINED_ERROR
;

231  
OSIP_SUCCESS
;

232 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_info.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 
	$os_mes§ge_£t_ÿÎ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

28 
os_ÿÎ_šfo_t
 *
ÿÎ_šfo
;

29 
i
;

31 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

32  
OSIP_SUCCESS
;

34 
i
 = 
	`os_ÿÎ_šfo_š™
(&
ÿÎ_šfo
);

36 ià(
i
 != 0)

37  
i
;

39 
i
 = 
	`os_ÿÎ_šfo_·r£
(
ÿÎ_šfo
, 
hv®ue
);

41 ià(
i
 != 0) {

42 
	`os_ÿÎ_šfo_ä“
(
ÿÎ_šfo
);

43  
i
;

46 
s
->
mes§ge_´İ”ty
 = 2;

47 
	`os_li¡_add
(&
s
->
ÿÎ_šfos
, 
ÿÎ_šfo
, -1);

48  
OSIP_SUCCESS
;

49 
	}
}

51 
	$os_mes§ge_g‘_ÿÎ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_ÿÎ_šfo_t
 **
de¡
) {

52 
os_ÿÎ_šfo_t
 *
ÿÎ_šfo
;

54 *
de¡
 = 
NULL
;

56 ià(
	`os_li¡_size
(&
s
->
ÿÎ_šfos
è<ğ
pos
)

57  
OSIP_UNDEFINED_ERROR
;

59 
ÿÎ_šfo
 = (
os_ÿÎ_šfo_t
 *è
	`os_li¡_g‘
(&
s
->
ÿÎ_šfos
, 
pos
);

60 *
de¡
 = 
ÿÎ_šfo
;

61  
pos
;

62 
	}
}

64 
	$os_ÿÎ_šfo_š™
(
os_ÿÎ_šfo_t
 **
ÿÎ_šfo
) {

65 *
ÿÎ_šfo
 = (
os_ÿÎ_šfo_t
 *è
	`os_m®loc
((osip_call_info_t));

67 ià(*
ÿÎ_šfo
 =ğ
NULL
)

68  
OSIP_NOMEM
;

70 (*
ÿÎ_šfo
)->
–em’t
 = 
NULL
;

72 
	`os_li¡_š™
(&(*
ÿÎ_šfo
)->
g’_·¿ms
);

74  
OSIP_SUCCESS
;

75 
	}
}

77 
	$os_ÿÎ_šfo_·r£
(
os_ÿÎ_šfo_t
 *
ÿÎ_šfo
, cÚ¡ *
hv®ue
) {

78 cÚ¡ *
os_ÿÎ_šfo_·¿ms
;

79 
i
;

81 
os_ÿÎ_šfo_·¿ms
 = 
	`¡rchr
(
hv®ue
, '<');

83 ià(
os_ÿÎ_šfo_·¿ms
 =ğ
NULL
)

84  
OSIP_SYNTAXERROR
;

86 
os_ÿÎ_šfo_·¿ms
 = 
	`¡rchr
(osip_call_info_params + 1, '>');

88 ià(
os_ÿÎ_šfo_·¿ms
 =ğ
NULL
)

89  
OSIP_SYNTAXERROR
;

91 
os_ÿÎ_šfo_·¿ms
 = 
	`¡rchr
(osip_call_info_params + 1, ';');

93 ià(
os_ÿÎ_šfo_·¿ms
 !ğ
NULL
) {

94 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
ÿÎ_šfo
->
g’_·¿ms
, 
os_ÿÎ_šfo_·¿ms
);

96 ià(
i
 != 0)

97  
i
;

100 
os_ÿÎ_šfo_·¿ms
 = 
hv®ue
 + 
	`¡¾’
(hvalue);

102 ià(
os_ÿÎ_šfo_·¿ms
 - 
hv®ue
 + 1 < 2)

103  
OSIP_SYNTAXERROR
;

105 
ÿÎ_šfo
->
–em’t
 = (*è
	`os_m®loc
(
os_ÿÎ_šfo_·¿ms
 - 
hv®ue
 + 1);

107 ià(
ÿÎ_šfo
->
–em’t
 =ğ
NULL
)

108  
OSIP_NOMEM
;

110 
	`os_şºıy
(
ÿÎ_šfo
->
–em’t
, 
hv®ue
, 
os_ÿÎ_šfo_·¿ms
 - hvalue);

112  
OSIP_SUCCESS
;

113 
	}
}

118 
	$os_ÿÎ_šfo_to_¡r
(cÚ¡ 
os_ÿÎ_šfo_t
 *
ÿÎ_šfo
, **
de¡
) {

119 *
buf
;

120 *
tmp
;

121 
size_t
 
Ën
;

122 
size_t
 
¶’
;

124 *
de¡
 = 
NULL
;

126 ià((
ÿÎ_šfo
 =ğ
NULL
è|| (ÿÎ_šfo->
–em’t
 == NULL))

127  
OSIP_BADPARAMETER
;

129 
Ën
 = 
	`¡¾’
(
ÿÎ_šfo
->
–em’t
) + 2;

130 
buf
 = (*è
	`os_m®loc
(
Ën
);

132 ià(
buf
 =ğ
NULL
)

133  
OSIP_NOMEM
;

135 *
de¡
 = 
buf
;

137 
	`¥rštf
(
buf
, "%s", 
ÿÎ_šfo
->
–em’t
);

140 
os_li¡_™”©Ü_t
 
™
;

141 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
ÿÎ_šfo
->
g’_·¿ms
, &
™
);

143 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

144 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

145 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
) + 2;

148 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 3;

150 
Ën
 =†’ + 
¶’
;

151 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

152 
tmp
 = 
buf
;

153 
tmp
 =m°+ 
	`¡¾’
(tmp);

155 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

156 
	`¥rštf
(
tmp
, ";%s", 
u_·¿m
->
gÇme
);

159 
	`¥rštf
(
tmp
, ";%s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

161 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

164 *
de¡
 = 
buf
;

165  
OSIP_SUCCESS
;

166 
	}
}

170 
	$os_ÿÎ_šfo_ä“
(
os_ÿÎ_šfo_t
 *
ÿÎ_šfo
) {

171 ià(
ÿÎ_šfo
 =ğ
NULL
)

174 
	`os_ä“
(
ÿÎ_šfo
->
–em’t
);

176 
	`os_g’”ic_·¿m_ä“li¡
(&
ÿÎ_šfo
->
g’_·¿ms
);

178 
ÿÎ_šfo
->
–em’t
 = 
NULL
;

180 
	`os_ä“
(
ÿÎ_šfo
);

181 
	}
}

183 
	$os_ÿÎ_šfo_şÚe
(cÚ¡ 
os_ÿÎ_šfo_t
 *
ùt
, os_ÿÎ_šfo_ˆ**
de¡
) {

184 
i
;

185 
os_ÿÎ_šfo_t
 *
ù
;

187 *
de¡
 = 
NULL
;

189 ià(
ùt
 =ğ
NULL
)

190  
OSIP_BADPARAMETER
;

192 ià(
ùt
->
–em’t
 =ğ
NULL
)

193  
OSIP_BADPARAMETER
;

195 
i
 = 
	`os_ÿÎ_šfo_š™
(&
ù
);

197 ià(
i
 != 0)

198  
i
;

200 
ù
->
–em’t
 = 
	`os_¡rdup
(
ùt
->element);

202 ià(
ù
->
–em’t
 =ğ
NULL
) {

203 
	`os_ÿÎ_šfo_ä“
(
ù
);

204  
OSIP_NOMEM
;

207 
i
 = 
	`os_li¡_şÚe
(&
ùt
->
g’_·¿ms
, &
ù
->g’_·¿ms, ((*)(*, **)è& 
os_g’”ic_·¿m_şÚe
);

209 ià(
i
 != 0) {

210 
	`os_ÿÎ_šfo_ä“
(
ù
);

211  
i
;

214 *
de¡
 = 
ù
;

215  
OSIP_SUCCESS
;

216 
	}
}

218 *
	$os_ÿÎ_šfo_g‘_uri
(
os_ÿÎ_šfo_t
 *
«
) {

219  
«
->
–em’t
;

220 
	}
}

222 
	$os_ÿÎ_šfo_£t_uri
(
os_ÿÎ_šfo_t
 *
«
, *
uri
) {

223 
«
->
–em’t
 = 
uri
;

224 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_contact.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

30 
	$os_mes§ge_£t_cÚù
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

31 
i
;

32 
os_cÚù_t
 *
cÚù
;

34 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 
i
 = 
	`os_cÚù_š™
(&
cÚù
);

39 ià(
i
 != 0)

40  
i
;

42 
i
 = 
	`os_cÚù_·r£
(
cÚù
, 
hv®ue
);

44 ià(
i
 != 0) {

45 
	`os_cÚù_ä“
(
cÚù
);

46  
i
;

49 
s
->
mes§ge_´İ”ty
 = 2;

50 
	`os_li¡_add
(&
s
->
cÚùs
, 
cÚù
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

58 
	$os_cÚù_·r£
(
os_cÚù_t
 *
cÚù
, cÚ¡ *
hv®ue
) {

59 ià(
cÚù
 =ğ
NULL
)

60  
OSIP_BADPARAMETER
;

62 ià(
	`¡ºcmp
(
hv®ue
, "*", 1) == 0) {

63 
cÚù
->
di¥ÏyÇme
 = 
	`os_¡rdup
(
hv®ue
);

65 ià(
cÚù
->
di¥ÏyÇme
 =ğ
NULL
) {

66  
OSIP_NOMEM
;

69  
OSIP_SUCCESS
;

72  
	`os_äom_·r£
((
os_äom_t
 *è
cÚù
, 
hv®ue
);

73 
	}
}

75 #iâdeà
MINISIZE


76 
	$os_cÚù_š™
(
os_cÚù_t
 **
cÚù
) {

77  
	`os_äom_š™
((
os_äom_t
 **è
cÚù
);

78 
	}
}

81 #iâdeà
MINISIZE


87 
	$os_mes§ge_g‘_cÚù
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_cÚù_t
 **
de¡
) {

88 *
de¡
 = 
NULL
;

90 ià(
s
 =ğ
NULL
)

91  
OSIP_BADPARAMETER
;

93 ià(
	`os_li¡_size
(&
s
->
cÚùs
è<ğ
pos
)

94  
OSIP_UNDEFINED_ERROR
;

96 *
de¡
 = (
os_cÚù_t
 *è
	`os_li¡_g‘
(&
s
->
cÚùs
, 
pos
);

97  
pos
;

98 
	}
}

104 
	$os_cÚù_to_¡r
(cÚ¡ 
os_cÚù_t
 *
cÚù
, **
de¡
) {

105 ià(
cÚù
 =ğ
NULL
)

106  
OSIP_BADPARAMETER
;

108 ià(
cÚù
->
di¥ÏyÇme
 !ğ
NULL
) {

109 ià(
	`¡ºcmp
(
cÚù
->
di¥ÏyÇme
, "*", 1) == 0) {

110 *
de¡
 = 
	`os_¡rdup
("*");

112 ià(*
de¡
 =ğ
NULL
)

113  
OSIP_NOMEM
;

115  
OSIP_SUCCESS
;

119  
	`os_äom_to_¡r
((
os_äom_t
 *è
cÚù
, 
de¡
);

120 
	}
}

122 #iâdeà
MINISIZE


125 
	$os_cÚù_ä“
(
os_cÚù_t
 *
cÚù
) {

126 
	`os_äom_ä“
((
os_äom_t
 *è
cÚù
);

127 
	}
}

129 
	$os_cÚù_şÚe
(cÚ¡ 
os_cÚù_t
 *
cÚù
, os_cÚù_ˆ**
de¡
) {

130  
	`os_äom_şÚe
((
os_äom_t
 *è
cÚù
, (os_äom_ˆ**è
de¡
);

131 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_disposition.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 
	$os_cÚ‹Á_di¥os™iÚ_·r£
(
os_cÚ‹Á_di¥os™iÚ_t
 *
cd
, cÚ¡ *
hv®ue
) {

28 cÚ¡ *
cd_·¿ms
;

29 
i
;

31 
cd_·¿ms
 = 
	`¡rchr
(
hv®ue
, ';');

33 ià(
cd_·¿ms
 !ğ
NULL
) {

34 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
cd
->
g’_·¿ms
, 
cd_·¿ms
);

36 ià(
i
 != 0)

37  
i
;

40 
cd_·¿ms
 = 
hv®ue
 + 
	`¡¾’
(hvalue);

42 ià(
cd_·¿ms
 - 
hv®ue
 + 1 < 2)

43  
OSIP_SYNTAXERROR
;

45 
cd
->
–em’t
 = (*è
	`os_m®loc
(
cd_·¿ms
 - 
hv®ue
 + 1);

47 ià(
cd
->
–em’t
 =ğ
NULL
)

48  
OSIP_NOMEM
;

50 
	`os_şºıy
(
cd
->
–em’t
, 
hv®ue
, 
cd_·¿ms
 - hvalue);

52  
OSIP_SUCCESS
;

53 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_encoding.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


32 
	$os_mes§ge_£t_cÚ‹Á_’codšg
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

33 
os_cÚ‹Á_’codšg_t
 *
cÚ‹Á_’codšg
;

34 
i
;

36 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`os_cÚ‹Á_’codšg_š™
(&
cÚ‹Á_’codšg
);

41 ià(
i
 != 0)

42  
i
;

44 
i
 = 
	`os_cÚ‹Á_’codšg_·r£
(
cÚ‹Á_’codšg
, 
hv®ue
);

46 ià(
i
 != 0) {

47 
	`os_cÚ‹Á_’codšg_ä“
(
cÚ‹Á_’codšg
);

48  
i
;

51 
s
->
mes§ge_´İ”ty
 = 2;

52 
	`os_li¡_add
(&
s
->
cÚ‹Á_’codšgs
, 
cÚ‹Á_’codšg
, -1);

53  
OSIP_SUCCESS
;

54 
	}
}

56 
	$os_mes§ge_g‘_cÚ‹Á_’codšg
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_cÚ‹Á_’codšg_t
 **
de¡
) {

57 
os_cÚ‹Á_’codšg_t
 *
û
;

59 *
de¡
 = 
NULL
;

61 ià(
	`os_li¡_size
(&
s
->
cÚ‹Á_’codšgs
è<ğ
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
û
 = (
os_cÚ‹Á_’codšg_t
 *è
	`os_li¡_g‘
(&
s
->
cÚ‹Á_’codšgs
, 
pos
);

65 *
de¡
 = 
û
;

66  
pos
;

67 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_length.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 
	$os_cÚ‹Á_Ëngth_š™
(
os_cÚ‹Á_Ëngth_t
 **
ş
) {

27 *
ş
 = (
os_cÚ‹Á_Ëngth_t
 *è
	`os_m®loc
((osip_content_length_t));

29 ià(*
ş
 =ğ
NULL
)

30  
OSIP_NOMEM
;

32 (*
ş
)->
v®ue
 = 
NULL
;

33  
OSIP_SUCCESS
;

34 
	}
}

40 
	$os_mes§ge_£t_cÚ‹Á_Ëngth
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

41 
i
;

43 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

44  
OSIP_SUCCESS
;

46 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
)

47  
OSIP_SYNTAXERROR
;

49 
i
 = 
	`os_cÚ‹Á_Ëngth_š™
(&(
s
->
cÚ‹Á_Ëngth
));

51 ià(
i
 != 0)

52  
i
;

54 
s
->
mes§ge_´İ”ty
 = 2;

55 
i
 = 
	`os_cÚ‹Á_Ëngth_·r£
(
s
->
cÚ‹Á_Ëngth
, 
hv®ue
);

57 ià(
i
 != 0) {

58 
	`os_cÚ‹Á_Ëngth_ä“
(
s
->
cÚ‹Á_Ëngth
);

59 
s
->
cÚ‹Á_Ëngth
 = 
NULL
;

60  
i
;

63  
OSIP_SUCCESS
;

64 
	}
}

66 
	$os_cÚ‹Á_Ëngth_·r£
(
os_cÚ‹Á_Ëngth_t
 *
cÚ‹Á_Ëngth
, cÚ¡ *
hv®ue
) {

67 
size_t
 
Ën
;

69 ià(
hv®ue
 =ğ
NULL
)

70  
OSIP_BADPARAMETER
;

72 
Ën
 = 
	`¡¾’
(
hv®ue
);

74 ià(
Ën
 + 1 < 2)

75  
OSIP_SYNTAXERROR
;

77 
cÚ‹Á_Ëngth
->
v®ue
 = (*è
	`os_m®loc
(
Ën
 + 1);

79 ià(
cÚ‹Á_Ëngth
->
v®ue
 =ğ
NULL
)

80  
OSIP_NOMEM
;

82 
	`os_¡ºıy
(
cÚ‹Á_Ëngth
->
v®ue
, 
hv®ue
, 
Ën
);

83  
OSIP_SUCCESS
;

84 
	}
}

86 #iâdeà
MINISIZE


90 
os_cÚ‹Á_Ëngth_t
 *
	$os_mes§ge_g‘_cÚ‹Á_Ëngth
(cÚ¡ 
os_mes§ge_t
 *
s
) {

91  
s
->
cÚ‹Á_Ëngth
;

92 
	}
}

98 
	$os_cÚ‹Á_Ëngth_to_¡r
(cÚ¡ 
os_cÚ‹Á_Ëngth_t
 *
ş
, **
de¡
) {

99 ià(
ş
 =ğ
NULL
)

100  
OSIP_BADPARAMETER
;

102 *
de¡
 = 
	`os_¡rdup
(
ş
->
v®ue
);

104 ià(*
de¡
 =ğ
NULL
)

105  
OSIP_NOMEM
;

107  
OSIP_SUCCESS
;

108 
	}
}

112 
	$os_cÚ‹Á_Ëngth_ä“
(
os_cÚ‹Á_Ëngth_t
 *
cÚ‹Á_Ëngth
) {

113 ià(
cÚ‹Á_Ëngth
 =ğ
NULL
)

116 
	`os_ä“
(
cÚ‹Á_Ëngth
->
v®ue
);

117 
	`os_ä“
(
cÚ‹Á_Ëngth
);

118 
	}
}

120 
	$os_cÚ‹Á_Ëngth_şÚe
(cÚ¡ 
os_cÚ‹Á_Ëngth_t
 *
ùl
, os_cÚ‹Á_Ëngth_ˆ**
de¡
) {

121 
i
;

122 
os_cÚ‹Á_Ëngth_t
 *
ş
;

124 *
de¡
 = 
NULL
;

126 ià(
ùl
 =ğ
NULL
)

127  
OSIP_BADPARAMETER
;

133 
i
 = 
	`os_cÚ‹Á_Ëngth_š™
(&
ş
);

135 ià(
i
 != 0)

136  
i
;

138 ià(
ùl
->
v®ue
 !ğ
NULL
) {

139 
ş
->
v®ue
 = 
	`os_¡rdup
(
ùl
->value);

141 ià(
ş
->
v®ue
 =ğ
NULL
) {

142 
	`os_cÚ‹Á_Ëngth_ä“
(
ş
);

143  
OSIP_NOMEM
;

147 *
de¡
 = 
ş
;

148  
OSIP_SUCCESS
;

149 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_type.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 
	$os_cÚ‹Á_ty³_š™
(
os_cÚ‹Á_ty³_t
 **
cÚ‹Á_ty³
) {

28 *
cÚ‹Á_ty³
 = (
os_cÚ‹Á_ty³_t
 *è
	`os_m®loc
((osip_content_type_t));

30 ià(*
cÚ‹Á_ty³
 =ğ
NULL
)

31  
OSIP_NOMEM
;

33 (*
cÚ‹Á_ty³
)->
ty³
 = 
NULL
;

34 (*
cÚ‹Á_ty³
)->
subty³
 = 
NULL
;

36 
	`os_li¡_š™
(&(*
cÚ‹Á_ty³
)->
g’_·¿ms
);

38  
OSIP_SUCCESS
;

39 
	}
}

45 
	$os_mes§ge_£t_cÚ‹Á_ty³
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

46 
i
;

48 ià(
s
->
cÚ‹Á_ty³
 !ğ
NULL
)

49  
OSIP_BADPARAMETER
;

51 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

52  
OSIP_SUCCESS
;

54 
i
 = 
	`os_cÚ‹Á_ty³_š™
(&(
s
->
cÚ‹Á_ty³
));

56 ià(
i
 != 0)

57  
i
;

59 
s
->
mes§ge_´İ”ty
 = 2;

60 
i
 = 
	`os_cÚ‹Á_ty³_·r£
(
s
->
cÚ‹Á_ty³
, 
hv®ue
);

62 ià(
i
 != 0) {

63 
	`os_cÚ‹Á_ty³_ä“
(
s
->
cÚ‹Á_ty³
);

64 
s
->
cÚ‹Á_ty³
 = 
NULL
;

65  
i
;

68  
OSIP_SUCCESS
;

69 
	}
}

71 #iâdeà
MINISIZE


75 
os_cÚ‹Á_ty³_t
 *
	$os_mes§ge_g‘_cÚ‹Á_ty³
(cÚ¡ 
os_mes§ge_t
 *
s
) {

76  
s
->
cÚ‹Á_ty³
;

77 
	}
}

84 
	$os_cÚ‹Á_ty³_·r£
(
os_cÚ‹Á_ty³_t
 *
cÚ‹Á_ty³
, cÚ¡ *
hv®ue
) {

85 *
subty³
;

86 *
os_cÚ‹Á_ty³_·¿ms
;

87 
i
;

100 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

101  
OSIP_SUCCESS
;

103 
subty³
 = 
	`¡rchr
(
hv®ue
, '/');

104 
os_cÚ‹Á_ty³_·¿ms
 = 
	`¡rchr
(
hv®ue
, ';');

106 ià(
subty³
 =ğ
NULL
)

107  
OSIP_SYNTAXERROR
;

109 ià(
os_cÚ‹Á_ty³_·¿ms
 !ğ
NULL
) {

110 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
cÚ‹Á_ty³
->
g’_·¿ms
, 
os_cÚ‹Á_ty³_·¿ms
);

112 ià(
i
 != 0)

113  
i
;

116 
os_cÚ‹Á_ty³_·¿ms
 = 
subty³
 + 
	`¡¾’
(subtype);

118 ià(
subty³
 - 
hv®ue
 + 1 < 2)

119  
OSIP_SYNTAXERROR
;

121 
cÚ‹Á_ty³
->
ty³
 = (*è
	`os_m®loc
(
subty³
 - 
hv®ue
 + 1);

123 ià(
cÚ‹Á_ty³
->
ty³
 =ğ
NULL
)

124  
OSIP_NOMEM
;

126 
	`os_şºıy
(
cÚ‹Á_ty³
->
ty³
, 
hv®ue
, 
subty³
 - hvalue);

128 ià(
os_cÚ‹Á_ty³_·¿ms
 - 
subty³
 < 2)

129  
OSIP_SYNTAXERROR
;

131 
cÚ‹Á_ty³
->
subty³
 = (*è
	`os_m®loc
(
os_cÚ‹Á_ty³_·¿ms
 - subtype);

133 ià(
cÚ‹Á_ty³
->
subty³
 =ğ
NULL
)

134  
OSIP_NOMEM
;

136 
	`os_şºıy
(
cÚ‹Á_ty³
->
subty³
, subty³ + 1, 
os_cÚ‹Á_ty³_·¿ms
 - subtype - 1);

138  
OSIP_SUCCESS
;

139 
	}
}

144 
	$os_cÚ‹Á_ty³_to_¡r
(cÚ¡ 
os_cÚ‹Á_ty³_t
 *
cÚ‹Á_ty³
, **
de¡
) {

145 *
buf
;

146 *
tmp
;

147 
size_t
 
Ën
;

149 *
de¡
 = 
NULL
;

151 ià((
cÚ‹Á_ty³
 =ğ
NULL
è|| (cÚ‹Á_ty³->
ty³
 =ğNULLè|| (cÚ‹Á_ty³->
subty³
 == NULL))

152  
OSIP_BADPARAMETER
;

155 
Ën
 = 
	`¡¾’
(
cÚ‹Á_ty³
->
ty³
è+ sŒËn(cÚ‹Á_ty³->
subty³
) + 4

156 + 10 * 
	`os_li¡_size
(&
cÚ‹Á_ty³
->
g’_·¿ms
);

158 
buf
 = (*è
	`os_m®loc
(
Ën
);

160 ià(
buf
 =ğ
NULL
)

161  
OSIP_NOMEM
;

163 
tmp
 = 
buf
;

165 
	`¥rštf
(
tmp
, "%s/%s", 
cÚ‹Á_ty³
->
ty³
, cÚ‹Á_ty³->
subty³
);

167 
tmp
 =m°+ 
	`¡¾’
(tmp);

169 
os_li¡_™”©Ü_t
 
™
;

170 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
cÚ‹Á_ty³
->
g’_·¿ms
, &
™
);

172 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

173 
size_t
 
tmp_Ën
;

175 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
) {

176 
	`os_ä“
(
buf
);

177  
OSIP_SYNTAXERROR
;

180 
tmp_Ën
 = 
	`¡¾’
(
buf
è+ 4 + sŒËn(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 1;

182 ià(
Ën
 < 
tmp_Ën
) {

183 
buf
 = 
	`os_»®loc
(buf, 
tmp_Ën
);

184 
Ën
 = 
tmp_Ën
;

185 
tmp
 = 
buf
 + 
	`¡¾’
(buf);

188 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), "; %s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

189 
tmp
 =m°+ 
	`¡¾’
(tmp);

190 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

193 *
de¡
 = 
buf
;

194  
OSIP_SUCCESS
;

195 
	}
}

199 
	$os_cÚ‹Á_ty³_ä“
(
os_cÚ‹Á_ty³_t
 *
cÚ‹Á_ty³
) {

200 ià(
cÚ‹Á_ty³
 =ğ
NULL
)

203 
	`os_ä“
(
cÚ‹Á_ty³
->
ty³
);

204 
	`os_ä“
(
cÚ‹Á_ty³
->
subty³
);

206 
	`os_g’”ic_·¿m_ä“li¡
(&
cÚ‹Á_ty³
->
g’_·¿ms
);

208 
cÚ‹Á_ty³
->
ty³
 = 
NULL
;

209 
cÚ‹Á_ty³
->
subty³
 = 
NULL
;

211 
	`os_ä“
(
cÚ‹Á_ty³
);

212 
	}
}

214 
	$os_cÚ‹Á_ty³_şÚe
(cÚ¡ 
os_cÚ‹Á_ty³_t
 *
ùt
, os_cÚ‹Á_ty³_ˆ**
de¡
) {

215 
i
;

216 
os_cÚ‹Á_ty³_t
 *
ù
;

218 *
de¡
 = 
NULL
;

220 ià(
ùt
 =ğ
NULL
)

221  
OSIP_BADPARAMETER
;

223 
i
 = 
	`os_cÚ‹Á_ty³_š™
(&
ù
);

225 ià(
i
 != 0)

226  
i
;

228 ià(
ùt
->
ty³
 !ğ
NULL
)

229 
ù
->
ty³
 = 
	`os_¡rdup
(
ùt
->type);

231 ià(
ùt
->
subty³
 !ğ
NULL
)

232 
ù
->
subty³
 = 
	`os_¡rdup
(
ùt
->subtype);

235 
os_g’”ic_·¿m_t
 *
de¡_·¿m
;

236 
os_li¡_™”©Ü_t
 
™
;

237 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
ùt
->
g’_·¿ms
, &
™
);

239 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

240 
i
 = 
	`os_g’”ic_·¿m_şÚe
(
u_·¿m
, &
de¡_·¿m
);

242 ià(
i
 != 0) {

243 
	`os_cÚ‹Á_ty³_ä“
(
ù
);

244  
i
;

247 
	`os_li¡_add
(&
ù
->
g’_·¿ms
, 
de¡_·¿m
, -1);

248 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

251 *
de¡
 = 
ù
;

252  
OSIP_SUCCESS
;

253 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_cseq.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 
	$os_c£q_š™
(
os_c£q_t
 **
c£q
) {

27 *
c£q
 = (
os_c£q_t
 *è
	`os_m®loc
((osip_cseq_t));

29 ià(*
c£q
 =ğ
NULL
)

30  
OSIP_NOMEM
;

32 (*
c£q
)->
m‘hod
 = 
NULL
;

33 (*
c£q
)->
numb”
 = 
NULL
;

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$os_mes§ge_£t_c£q
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

42 
i
;

44 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

45  
OSIP_SUCCESS
;

47 ià(
s
->
c£q
 !ğ
NULL
)

48  
OSIP_BADPARAMETER
;

50 
i
 = 
	`os_c£q_š™
(&(
s
->
c£q
));

52 ià(
i
 != 0)

53  
i
;

55 
s
->
mes§ge_´İ”ty
 = 2;

56 
i
 = 
	`os_c£q_·r£
(
s
->
c£q
, 
hv®ue
);

58 ià(
i
 != 0) {

59 
	`os_c£q_ä“
(
s
->
c£q
);

60 
s
->
c£q
 = 
NULL
;

61  
i
;

64  
OSIP_SUCCESS
;

65 
	}
}

71 
	$os_c£q_·r£
(
os_c£q_t
 *
c£q
, cÚ¡ *
hv®ue
) {

72 *
m‘hod
 = 
NULL
;

73 cÚ¡ *
’d
 = 
NULL
;

75 ià(
c£q
 =ğ
NULL
 || 
hv®ue
 == NULL)

76  
OSIP_BADPARAMETER
;

78 
c£q
->
numb”
 = 
NULL
;

79 
c£q
->
m‘hod
 = 
NULL
;

81 
m‘hod
 = 
	`¡rchr
(
hv®ue
, ' ');

83 ià(
m‘hod
 =ğ
NULL
)

84  
OSIP_SYNTAXERROR
;

86 
’d
 = 
hv®ue
 + 
	`¡¾’
(hvalue);

88 ià(
m‘hod
 - 
hv®ue
 + 1 < 2)

89  
OSIP_SYNTAXERROR
;

91 
c£q
->
numb”
 = (*è
	`os_m®loc
(
m‘hod
 - 
hv®ue
 + 1);

93 ià(
c£q
->
numb”
 =ğ
NULL
)

94  
OSIP_NOMEM
;

96 
	`os_şºıy
(
c£q
->
numb”
, 
hv®ue
, 
m‘hod
 - hvalue);

98 ià(
’d
 - 
m‘hod
 + 1 < 2)

99  
OSIP_SYNTAXERROR
;

101 
c£q
->
m‘hod
 = (*è
	`os_m®loc
(
’d
 - method + 1);

103 ià(
c£q
->
m‘hod
 =ğ
NULL
)

104  
OSIP_NOMEM
;

106 
	`os_şºıy
(
c£q
->
m‘hod
, m‘hod + 1, 
’d
 - method);

108  
OSIP_SUCCESS
;

109 
	}
}

111 #iâdeà
MINISIZE


115 
os_c£q_t
 *
	$os_mes§ge_g‘_c£q
(cÚ¡ 
os_mes§ge_t
 *
s
) {

116  
s
->
c£q
;

117 
	}
}

120 *
	$os_c£q_g‘_numb”
(
os_c£q_t
 *
c£q
) {

121  
c£q
->
numb”
;

122 
	}
}

124 *
	$os_c£q_g‘_m‘hod
(
os_c£q_t
 *
c£q
) {

125  
c£q
->
m‘hod
;

126 
	}
}

128 
	$os_c£q_£t_numb”
(
os_c£q_t
 *
c£q
, *
numb”
) {

129 
c£q
->
numb”
 = (*)‚umber;

130 
	}
}

132 
	$os_c£q_£t_m‘hod
(
os_c£q_t
 *
c£q
, *
m‘hod
) {

133 
c£q
->
m‘hod
 = (*) method;

134 
	}
}

139 
	$os_c£q_to_¡r
(cÚ¡ 
os_c£q_t
 *
c£q
, **
de¡
) {

140 
size_t
 
Ën
;

142 *
de¡
 = 
NULL
;

144 ià((
c£q
 =ğ
NULL
è|| (c£q->
numb”
 =ğNULLè|| (c£q->
m‘hod
 == NULL))

145  
OSIP_BADPARAMETER
;

147 
Ën
 = 
	`¡¾’
(
c£q
->
m‘hod
è+ sŒËn(c£q->
numb”
) + 2;

148 *
de¡
 = (*è
	`os_m®loc
(
Ën
);

150 ià(*
de¡
 =ğ
NULL
)

151  
OSIP_NOMEM
;

153 
	`¢´štf
(*
de¡
, 
Ën
, "% %s", 
c£q
->
numb”
, c£q->
m‘hod
);

154  
OSIP_SUCCESS
;

155 
	}
}

159 
	$os_c£q_ä“
(
os_c£q_t
 *
c£q
) {

160 ià(
c£q
 =ğ
NULL
)

163 
	`os_ä“
(
c£q
->
m‘hod
);

164 
	`os_ä“
(
c£q
->
numb”
);

165 
	`os_ä“
(
c£q
);

166 
	}
}

168 
	$os_c£q_şÚe
(cÚ¡ 
os_c£q_t
 *
c£q
, os_c£q_ˆ**
de¡
) {

169 
i
;

170 
os_c£q_t
 *
cs
;

172 *
de¡
 = 
NULL
;

174 ià(
c£q
 =ğ
NULL
)

175  
OSIP_BADPARAMETER
;

177 ià(
c£q
->
m‘hod
 =ğ
NULL
)

178  
OSIP_BADPARAMETER
;

180 ià(
c£q
->
numb”
 =ğ
NULL
)

181  
OSIP_BADPARAMETER
;

183 
i
 = 
	`os_c£q_š™
(&
cs
);

185 ià(
i
 != 0) {

186 
	`os_c£q_ä“
(
cs
);

187  
i
;

190 
cs
->
m‘hod
 = 
	`os_¡rdup
(
c£q
->method);

191 
cs
->
numb”
 = 
	`os_¡rdup
(
c£q
->number);

193 *
de¡
 = 
cs
;

194  
OSIP_SUCCESS
;

195 
	}
}

197 
	$os_c£q_m©ch
(
os_c£q_t
 *
c£q1
, os_c£q_ˆ*
c£q2
) {

198 ià(
c£q1
 =ğ
NULL
 || 
c£q2
 == NULL)

199  
OSIP_BADPARAMETER
;

201 ià(
c£q1
->
numb”
 =ğ
NULL
 || 
c£q2
->numb” =ğNULL || c£q1->
m‘hod
 == NULL || cseq2->method == NULL)

202  
OSIP_BADPARAMETER
;

204 ià(0 =ğ
	`¡rcmp
(
c£q1
->
numb”
, 
c£q2
->number)) {

205 ià(0 =ğ
	`¡rcmp
(
c£q2
->
m‘hod
, "INVITE") || 0 == strcmp(cseq2->method, "ACK")) {

206 ià(0 =ğ
	`¡rcmp
(
c£q1
->
m‘hod
, "INVITE") || 0 == strcmp(cseq1->method, "ACK"))

207  
OSIP_SUCCESS
;

210 ià(0 =ğ
	`¡rcmp
(
c£q1
->
m‘hod
, 
c£q2
->method))

211  
OSIP_SUCCESS
;

215  
OSIP_UNDEFINED_ERROR
;

216 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_error_info.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 #iâdeà
MINISIZE


29 
	$os_mes§ge_£t_”rÜ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

30 
os_”rÜ_šfo_t
 *
”rÜ_šfo
;

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 
i
 = 
	`os_”rÜ_šfo_š™
(&
”rÜ_šfo
);

38 ià(
i
 != 0)

39  
i
;

41 
i
 = 
	`os_”rÜ_šfo_·r£
(
”rÜ_šfo
, 
hv®ue
);

43 ià(
i
 != 0) {

44 
	`os_”rÜ_šfo_ä“
(
”rÜ_šfo
);

45  
i
;

48 
s
->
mes§ge_´İ”ty
 = 2;

49 
	`os_li¡_add
(&
s
->
”rÜ_šfos
, 
”rÜ_šfo
, -1);

50  
OSIP_SUCCESS
;

51 
	}
}

53 
	$os_mes§ge_g‘_”rÜ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_”rÜ_šfo_t
 **
de¡
) {

54 
os_”rÜ_šfo_t
 *
”rÜ_šfo
;

56 *
de¡
 = 
NULL
;

58 ià(
	`os_li¡_size
(&
s
->
”rÜ_šfos
è<ğ
pos
)

59  
OSIP_UNDEFINED_ERROR
;

61 
”rÜ_šfo
 = (
os_”rÜ_šfo_t
 *è
	`os_li¡_g‘
(&
s
->
”rÜ_šfos
, 
pos
);

62 *
de¡
 = 
”rÜ_šfo
;

63  
pos
;

64 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_from.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

31 
	$os_mes§ge_£t_äom
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

32 
i
;

34 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 ià(
s
->
äom
 !ğ
NULL
)

38  
OSIP_SYNTAXERROR
;

40 
i
 = 
	`os_äom_š™
(&(
s
->
äom
));

42 ià(
i
 != 0)

43  
i
;

45 
s
->
mes§ge_´İ”ty
 = 2;

46 
i
 = 
	`os_äom_·r£
(
s
->
äom
, 
hv®ue
);

48 ià(
i
 != 0) {

49 
	`os_äom_ä“
(
s
->
äom
);

50 
s
->
äom
 = 
NULL
;

51  
i
;

54  
OSIP_SUCCESS
;

55 
	}
}

57 #iâdeà
MINISIZE


61 
os_äom_t
 *
	$os_mes§ge_g‘_äom
(cÚ¡ 
os_mes§ge_t
 *
s
) {

62  
s
->
äom
;

63 
	}
}

66 
	$os_äom_š™
(
os_äom_t
 **
äom
) {

67 *
äom
 = (
os_äom_t
 *è
	`os_m®loc
((osip_from_t));

69 ià(*
äom
 =ğ
NULL
)

70  
OSIP_NOMEM
;

72 (*
äom
)->
di¥ÏyÇme
 = 
NULL
;

73 (*
äom
)->
u¾
 = 
NULL
;

75 
	`os_li¡_š™
(&(*
äom
)->
g’_·¿ms
);

77  
OSIP_SUCCESS
;

78 
	}
}

82 
	$os_äom_ä“
(
os_äom_t
 *
äom
) {

83 ià(
äom
 =ğ
NULL
)

86 ià(
äom
->
u¾
 !ğ
NULL
) {

87 
	`os_uri_ä“
(
äom
->
u¾
);

90 
	`os_ä“
(
äom
->
di¥ÏyÇme
);

92 
	`os_g’”ic_·¿m_ä“li¡
(&
äom
->
g’_·¿ms
);

94 
	`os_ä“
(
äom
);

95 
	}
}

101 
	$os_äom_·r£
(
os_äom_t
 *
äom
, cÚ¡ *
hv®ue
) {

102 cÚ¡ *
di¥ÏyÇme
 = 
NULL
;

103 cÚ¡ *
u¾
 = 
NULL
;

104 cÚ¡ *
u¾_’d
 = 
NULL
;

105 cÚ¡ *
g’_·¿ms
;

106 cÚ¡ *
±r
;

107 
i
;

109 ià(
äom
 =ğ
NULL
 || 
hv®ue
 == NULL)

110  
OSIP_BADPARAMETER
;

129 
±r
 = 
hv®ue
;

131 
±r
[0] != '\0') {

132 ià(
±r
[0] == ' ') {

133 
±r
++;

137 ià(
±r
[0] == '"') {

138 
di¥ÏyÇme
 = 
±r
;

145 ià(
±r
[0] == '\0')

146  
OSIP_SUCCESS
;

148 ià(
di¥ÏyÇme
 !ğ
NULL
) {

150 cÚ¡ *
£cÚd
 = 
NULL
;

153 
£cÚd
 = 
	`__os_quÙe_fšd
(
di¥ÏyÇme
 + 1);

155 ià(
£cÚd
 =ğ
NULL
)

156  
OSIP_SYNTAXERROR
;

158 ià(
£cÚd
 - 
di¥ÏyÇme
 + 2 >= 2) {

159 
äom
->
di¥ÏyÇme
 = (*è
	`os_m®loc
(
£cÚd
 - displayname + 2);

161 ià(
äom
->
di¥ÏyÇme
 =ğ
NULL
)

162  
OSIP_NOMEM
;

164 
	`os_¡ºıy
(
äom
->
di¥ÏyÇme
, di¥ÏyÇme, 
£cÚd
 - displayname + 1);

170 
±r
 = 
£cÚd
 + 1;

172 
±r
[0] != '\0') {

173 ià(
±r
[0] == ' ') {

174 
±r
++;

178 ià(
±r
[0] == '<') {

179 
u¾
 = 
±r
;

186 ià(
u¾
 =ğ
NULL
)

187  
OSIP_SYNTAXERROR
;

189 ià(
±r
[1] == '\0')

190  
OSIP_SYNTAXERROR
;

195 cÚ¡ *
beg
 = 
±r
;

197 
±r
[0] != '\0') {

198 ià(
±r
[0] == ' ') {

199 
±r
++;

203 ià(
±r
[0] >= 'a' &&…tr[0] <= 'z') {

204 
±r
++;

208 ià(
±r
[0] >= 'A' &&…tr[0] <= 'Z') {

209 
±r
++;

213 ià(
±r
[0] >= '0' &&…tr[0] <= '9') {

214 
±r
++;

218 ià(
±r
[0] == '-' ||…tr[0] == '.' ||…tr[0] == '!' ||…tr[0] == '%' ||…tr[0] == '*' ||…tr[0] == '_' ||…tr[0] == '+' ||…tr[0] == '`' ||…tr[0] == '\'' ||…tr[0] == '~') {

219 
±r
++;

223 
u¾
 = 
±r
;

227 ià(
±r
[0] =ğ'\0' || 
u¾
 =ğ
NULL
)

228  
OSIP_SYNTAXERROR
;

230 ià(
±r
[0] == '<') {

232 ià(
±r
[1] == '\0')

233  
OSIP_SYNTAXERROR
;

235 ià(
u¾
 - 
beg
 > 0) {

236 
äom
->
di¥ÏyÇme
 = (*è
	`os_m®loc
(
u¾
 - 
beg
 + 1);

238 ià(
äom
->
di¥ÏyÇme
 =ğ
NULL
)

239  
OSIP_NOMEM
;

241 
	`os_şºıy
(
äom
->
di¥ÏyÇme
, 
hv®ue
, 
u¾
 - 
beg
);

244 } ià(
±r
[0] == ':') {

246 
u¾
 = 
beg
;

250 
u¾
 = 
beg
;

255 ià(
u¾
[0] == '<') {

256 
u¾
++;

257 
±r
 = 
u¾
;

259 
u¾_’d
 = 
	`¡rchr
(
±r
, '>');

261 ià(
u¾_’d
 =ğ
NULL
)

262  
OSIP_SYNTAXERROR
;

264 
u¾_’d
--;

265 
g’_·¿ms
 = 
	`¡rchr
(
u¾_’d
, ';');

269 ià(
u¾_’d
 =ğ
NULL
) {

276 
g’_·¿ms
 = 
	`¡rchr
(
u¾
, ';');

278 ià(
g’_·¿ms
 !ğ
NULL
)

279 
u¾_’d
 = 
g’_·¿ms
 - 1;

282 
u¾_’d
 = 
u¾
 + 
	`¡¾’
(url);

285 ià(
g’_·¿ms
 !ğ
NULL
) {

286 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
äom
->
g’_·¿ms
, gen_params);

288 ià(
i
 != 0) {

289  
i
;

295 *
tmp
;

297 ià(
u¾_’d
 - 
u¾
 + 2 < 7)

298  
OSIP_SYNTAXERROR
;

300 
i
 = 
	`os_uri_š™
(&(
äom
->
u¾
));

302 ià(
i
 != 0)

303  
i
;

305 
tmp
 = (*è
	`os_m®loc
(
u¾_’d
 - 
u¾
 + 2);

307 ià(
tmp
 =ğ
NULL
)

308  
OSIP_NOMEM
;

310 
	`os_¡ºıy
(
tmp
, 
u¾
, 
u¾_’d
 - url + 1);

311 
i
 = 
	`os_uri_·r£
(
äom
->
u¾
, 
tmp
);

312 
	`os_ä“
(
tmp
);

314 ià(
i
 != 0)

315  
i
;

317  
OSIP_SUCCESS
;

318 
	}
}

323 
	$os_äom_to_¡r
(cÚ¡ 
os_äom_t
 *
äom
, **
de¡
) {

324 *
u¾
;

325 *
buf
;

326 
i
;

327 
size_t
 
Ën
;

329 *
de¡
 = 
NULL
;

331 ià((
äom
 =ğ
NULL
è|| (äom->
u¾
 == NULL))

332  
OSIP_BADPARAMETER
;

334 
i
 = 
	`os_uri_to_¡r
(
äom
->
u¾
, &url);

336 ià(
i
 != 0)

337  
i
;

339 ià(
äom
->
di¥ÏyÇme
 =ğ
NULL
)

340 
Ën
 = 
	`¡¾’
(
u¾
) + 5;

343 
Ën
 = 
	`¡¾’
(
u¾
è+ sŒËn(
äom
->
di¥ÏyÇme
) + 5;

345 
buf
 = (*è
	`os_m®loc
(
Ën
);

347 ià(
buf
 =ğ
NULL
) {

348 
	`os_ä“
(
u¾
);

349  
OSIP_NOMEM
;

352 ià(
äom
->
di¥ÏyÇme
 !ğ
NULL
)

353 
	`¥rštf
(
buf
, "% <%s>", 
äom
->
di¥ÏyÇme
, 
u¾
);

359 
	`¥rštf
(
buf
, "<%s>", 
u¾
);

361 
	`os_ä“
(
u¾
);

364 
size_t
 
¶’
;

365 *
tmp
;

366 
os_li¡_™”©Ü_t
 
™
;

367 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
äom
->
g’_·¿ms
, &
™
);

369 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

370 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

371 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
) + 2;

374 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 3;

376 
Ën
 =†’ + 
¶’
;

377 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

378 
tmp
 = 
buf
;

379 
tmp
 =m°+ 
	`¡¾’
(tmp);

381 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

382 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s", 
u_·¿m
->
gÇme
);

385 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

387 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

390 *
de¡
 = 
buf
;

391  
OSIP_SUCCESS
;

392 
	}
}

394 *
	$os_äom_g‘_di¥ÏyÇme
(
os_äom_t
 *
äom
) {

395 ià(
äom
 =ğ
NULL
)

396  
NULL
;

398  
äom
->
di¥ÏyÇme
;

399 
	}
}

401 
	$os_äom_£t_di¥ÏyÇme
(
os_äom_t
 *
äom
, *
di¥ÏyÇme
) {

402 
äom
->
di¥ÏyÇme
 = displayname;

403 
	}
}

405 
os_uri_t
 *
	$os_äom_g‘_u¾
(
os_äom_t
 *
äom
) {

406 ià(
äom
 =ğ
NULL
)

407  
NULL
;

409  
äom
->
u¾
;

410 
	}
}

412 
	$os_äom_£t_u¾
(
os_äom_t
 *
äom
, 
os_uri_t
 *
u¾
) {

413 
äom
->
u¾
 = url;

414 
	}
}

416 
	$os_äom_·¿m_g‘
(
os_äom_t
 *
äom
, 
pos
, 
os_g’”ic_·¿m_t
 **
å¬am
) {

417 *
å¬am
 = 
NULL
;

419 ià(
äom
 =ğ
NULL
)

420  
OSIP_BADPARAMETER
;

422 ià(
	`os_li¡_size
(&
äom
->
g’_·¿ms
è<ğ
pos
)

423  
OSIP_UNDEFINED_ERROR
;

425 *
å¬am
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘
(&
äom
->
g’_·¿ms
, 
pos
);

426  
pos
;

427 
	}
}

429 
	$os_äom_şÚe
(cÚ¡ 
os_äom_t
 *
äom
, os_äom_ˆ**
de¡
) {

430 
i
;

431 
os_äom_t
 *
ä
;

433 *
de¡
 = 
NULL
;

435 ià(
äom
 =ğ
NULL
)

436  
OSIP_BADPARAMETER
;

438 
i
 = 
	`os_äom_š™
(&
ä
);

440 ià(
i
 != 0)

441  
i
;

443 ià(
äom
->
di¥ÏyÇme
 !ğ
NULL
) {

444 
ä
->
di¥ÏyÇme
 = 
	`os_¡rdup
(
äom
->displayname);

446 ià(
ä
->
di¥ÏyÇme
 =ğ
NULL
) {

447 
	`os_äom_ä“
(
ä
);

448  
OSIP_NOMEM
;

452 ià(
äom
->
u¾
 !ğ
NULL
) {

453 
i
 = 
	`os_uri_şÚe
(
äom
->
u¾
, &(
ä
->url));

455 ià(
i
 != 0) {

456 
	`os_äom_ä“
(
ä
);

457  
i
;

461 
i
 = 
	`os_li¡_şÚe
(&
äom
->
g’_·¿ms
, &
ä
->g’_·¿ms, ((*)(*, **)è& 
os_g’”ic_·¿m_şÚe
);

463 ià(
i
 != 0) {

464 
	`os_äom_ä“
(
ä
);

465  
i
;

468 *
de¡
 = 
ä
;

469  
OSIP_SUCCESS
;

470 
	}
}

472 
	$os_äom_com·»
(
os_äom_t
 *
äom1
, os_äom_ˆ*
äom2
) {

473 *
g1
;

474 *
g2
;

476 ià(
äom1
 =ğ
NULL
 || 
äom2
 == NULL)

477  
OSIP_BADPARAMETER
;

479 ià(
äom1
->
u¾
 =ğ
NULL
 || 
äom2
->url == NULL)

480  
OSIP_BADPARAMETER
;

484 ià(
äom1
->
u¾
->
ho¡
 =ğ
NULL
 && 
äom2
->url->host == NULL) {

485 ià(
äom1
->
u¾
->
¡ršg
 =ğ
NULL
 || 
äom2
->url->string == NULL)

486  
OSIP_UNDEFINED_ERROR
;

488 ià(0 =ğ
	`¡rcmp
(
äom1
->
u¾
->
¡ršg
, 
äom2
->url->string))

489  
OSIP_SUCCESS
;

492 ià(
äom1
->
u¾
->
ho¡
 =ğ
NULL
 || 
äom2
->url->host == NULL)

493  
OSIP_UNDEFINED_ERROR
;

496 ià(0 !ğ
	`¡rcmp
(
äom1
->
u¾
->
ho¡
, 
äom2
->url->host))

497  
OSIP_UNDEFINED_ERROR
;

499 ià(
äom1
->
u¾
->
u£ºame
 !ğ
NULL
 && 
äom2
->url->username != NULL)

500 ià(0 !ğ
	`¡rcmp
(
äom1
->
u¾
->
u£ºame
, 
äom2
->url->username))

501  
OSIP_UNDEFINED_ERROR
;

503 
g1
 = 
NULL
;

504 
g2
 = 
NULL
;

506 
os_li¡_™”©Ü_t
 
™
;

507 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
äom1
->
g’_·¿ms
, &
™
);

509 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

510 ià(0 =ğ
	`¡ºcmp
(
u_·¿m
->
gÇme
, "tag", 3)) {

511 
g1
 = 
u_·¿m
->
gv®ue
;

515 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

519 
os_li¡_™”©Ü_t
 
™
;

520 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
äom2
->
g’_·¿ms
, &
™
);

522 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

523 ià(0 =ğ
	`¡ºcmp
(
u_·¿m
->
gÇme
, "tag", 3)) {

524 
g2
 = 
u_·¿m
->
gv®ue
;

528 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

540 ià(
g1
 !ğ
NULL
 && 
g2
 != NULL)

541 ià(0 !ğ
	`¡rcmp
(
g1
, 
g2
))

542  
OSIP_UNDEFINED_ERROR
;

547  
OSIP_SUCCESS
;

548 
	}
}

550 
	$__os_g’”ic_·¿m_·r£®l
(
os_li¡_t
 *
g’_·¿ms
, cÚ¡ *
·¿ms
) {

551 
i
;

552 *
²ame
;

553 *
pv®ue
;

555 cÚ¡ *
comma
;

556 cÚ¡ *
equ®
;

557 cÚ¡ *
¡¬tquÙe
;

558 cÚ¡ *
’dquÙe
;

563 
equ®
 = 
	`Ãxt_£·¿tÜ
(
·¿ms
 + 1, '=', ';');

564 
comma
 = 
	`¡rchr
(
·¿ms
 + 1, ';');

567 ià(
equ®
 !ğ
NULL
) {

568 cÚ¡ *
tmp
;

570 
¡¬tquÙe
 = 
NULL
;

572 
tmp
 = 
equ®
 + 1;mp[0] == ' ';mp++) {

575 ià(
tmp
[0] == '"')

576 
¡¬tquÙe
 = 
tmp
;

578 ià(
¡¬tquÙe
 !ğ
NULL
 && 
comma
 > startquote) {

579 
comma
 = 
NULL
;

580 
’dquÙe
 = 
	`__os_quÙe_fšd
(
¡¬tquÙe
 + 1);

582 ià(
’dquÙe
)

583 
comma
 = 
	`¡rchr
(
’dquÙe
, ';');

587 
comma
 !ğ
NULL
) {

588 ià(
equ®
 =ğ
NULL
) {

589 
equ®
 = 
comma
;

590 
pv®ue
 = 
NULL
;

593 cÚ¡ *
tmp
;

596 
tmp
 = 
equ®
 + 1;

597 
tmp
 +ğ
	`¡r¥n
(tmp, "\t ");

598 
pv®ue
 = 
NULL
;

600 ià(*
tmp
 != ',' && *tmp != '\0') {

601 ià(
comma
 - 
equ®
 < 2)

602  
OSIP_SYNTAXERROR
;

604 
pv®ue
 = (*è
	`os_m®loc
(
comma
 - 
equ®
);

606 ià(
pv®ue
 =ğ
NULL
)

607  
OSIP_NOMEM
;

609 
	`os_¡ºıy
(
pv®ue
, 
equ®
 + 1, 
comma
 -ƒqual - 1);

613 ià(
equ®
 - 
·¿ms
 < 2) {

614 
	`os_ä“
(
pv®ue
);

615  
OSIP_SYNTAXERROR
;

618 
²ame
 = (*è
	`os_m®loc
(
equ®
 - 
·¿ms
);

620 ià(
²ame
 =ğ
NULL
) {

621 
	`os_ä“
(
pv®ue
);

622  
OSIP_NOMEM
;

625 
	`os_¡ºıy
(
²ame
, 
·¿ms
 + 1, 
equ®
 -…arams - 1);

627 
i
 = 
	`os_g’”ic_·¿m_add
(
g’_·¿ms
, 
²ame
, 
pv®ue
);

629 ià(
i
 !ğ
OSIP_SUCCESS
) {

630 
	`os_ä“
(
²ame
);

631 
	`os_ä“
(
pv®ue
);

632  
OSIP_NOMEM
;

635 
·¿ms
 = 
comma
;

636 
equ®
 = 
	`Ãxt_£·¿tÜ
(
·¿ms
 + 1, '=', ';');

637 
comma
 = 
	`¡rchr
(
·¿ms
 + 1, ';');

640 ià(
equ®
 !ğ
NULL
) {

641 cÚ¡ *
tmp
;

643 
¡¬tquÙe
 = 
NULL
;

645 
tmp
 = 
equ®
 + 1;mp[0] == ' ';mp++) {

648 ià(
tmp
[0] == '"')

649 
¡¬tquÙe
 = 
tmp
;

651 ià(
¡¬tquÙe
 !ğ
NULL
 && 
comma
 > startquote) {

652 
comma
 = 
NULL
;

653 
’dquÙe
 = 
	`__os_quÙe_fšd
(
¡¬tquÙe
 + 1);

655 ià(
’dquÙe
)

656 
comma
 = 
	`¡rchr
(
’dquÙe
, ';');

662 
comma
 = 
·¿ms
 + 
	`¡¾’
(params);

664 ià(
equ®
 =ğ
NULL
) {

665 
equ®
 = 
comma
;

666 
pv®ue
 = 
NULL
;

668 ià(
equ®
 - 
·¿ms
 < 2) {

669 
	`os_ä“
(
pv®ue
);

670  
OSIP_SUCCESS
;

674 cÚ¡ *
tmp
;

677 
tmp
 = 
equ®
 + 1;

678 
tmp
 +ğ
	`¡r¥n
(tmp, "\t ");

679 
pv®ue
 = 
NULL
;

681 ià(*
tmp
 != ',' && *tmp != '\0') {

682 ià(
comma
 - 
equ®
 < 2)

683  
OSIP_SYNTAXERROR
;

685 
pv®ue
 = (*è
	`os_m®loc
(
comma
 - 
equ®
);

687 ià(
pv®ue
 =ğ
NULL
)

688  
OSIP_NOMEM
;

690 
	`os_¡ºıy
(
pv®ue
, 
equ®
 + 1, 
comma
 -ƒqual - 1);

694 ià(
equ®
 - 
·¿ms
 < 2) {

695 
	`os_ä“
(
pv®ue
);

696  
OSIP_SYNTAXERROR
;

699 
²ame
 = (*è
	`os_m®loc
(
equ®
 - 
·¿ms
);

701 ià(
²ame
 =ğ
NULL
) {

702 
	`os_ä“
(
pv®ue
);

703  
OSIP_NOMEM
;

706 
	`os_¡ºıy
(
²ame
, 
·¿ms
 + 1, 
equ®
 -…arams - 1);

708 
i
 = 
	`os_g’”ic_·¿m_add
(
g’_·¿ms
, 
²ame
, 
pv®ue
);

710 ià(
i
 !ğ
OSIP_SUCCESS
) {

711 
	`os_ä“
(
²ame
);

712 
	`os_ä“
(
pv®ue
);

713  
OSIP_NOMEM
;

716  
OSIP_SUCCESS
;

717 
	}
}

719 
	$os_g’”ic_·¿m_£t_v®ue
(
os_g’”ic_·¿m_t
 *
å¬am
, *
v®ue
) {

720 
å¬am
->
gv®ue
 = 
v®ue
;

721 
	}
}

723 *
	$os_g’”ic_·¿m_g‘_Çme
(cÚ¡ 
os_g’”ic_·¿m_t
 *
å¬am
) {

724 ià(
å¬am
 =ğ
NULL
)

725  
NULL
;

727  
å¬am
->
gÇme
;

728 
	}
}

730 
	$os_g’”ic_·¿m_£t_Çme
(
os_g’”ic_·¿m_t
 *
å¬am
, *
Çme
) {

731 
å¬am
->
gÇme
 = 
Çme
;

732 
	}
}

734 *
	$os_g’”ic_·¿m_g‘_v®ue
(cÚ¡ 
os_g’”ic_·¿m_t
 *
å¬am
) {

735 ià(
å¬am
 =ğ
NULL
)

736  
NULL
;

738 ià(
å¬am
->
gÇme
 =ğ
NULL
)

739  
NULL
;

741  
å¬am
->
gv®ue
;

742 
	}
}

744 
	$os_äom_g_m©ch
(
os_äom_t
 *
äom1
, os_äom_ˆ*
äom2
) {

745 
os_g’”ic_·¿m_t
 *
g_äom1
;

746 
os_g’”ic_·¿m_t
 *
g_äom2
;

748 ià(
äom1
 =ğ
NULL
 || 
äom2
 == NULL)

749  
OSIP_BADPARAMETER
;

751 
	`os_äom_·¿m_g‘_byÇme
(
äom1
, "g", &
g_äom1
);

752 
	`os_äom_·¿m_g‘_byÇme
(
äom2
, "g", &
g_äom2
);

754 ià(
g_äom1
 =ğ
NULL
 && 
g_äom2
 == NULL)

755  
OSIP_SUCCESS
;

757 ià((
g_äom1
 !ğ
NULL
 && 
g_äom2
 == NULL) || (tag_from1 == NULL &&ag_from2 != NULL))

758  
OSIP_UNDEFINED_ERROR
;

760 ià(
g_äom1
->
gv®ue
 =ğ
NULL
 || 
g_äom2
->gvalue == NULL)

761  
OSIP_UNDEFINED_ERROR
;

763 ià(0 !ğ
	`¡rcmp
(
g_äom1
->
gv®ue
, 
g_äom2
->gvalue))

764  
OSIP_UNDEFINED_ERROR
;

766  
OSIP_SUCCESS
;

767 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_header.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

31 
	$os_mes§ge_£t_h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
) {

32 
os_h—d”_t
 *
h
;

33 
i
;

35 ià(
s
 =ğ
NULL
 || 
hÇme
 == NULL)

36  
OSIP_BADPARAMETER
;

38 
i
 = 
	`os_h—d”_š™
(&
h
);

40 ià(
i
 != 0)

41  
i
;

43 
h
->
hÇme
 = (*è
	`os_m®loc
(
	`¡¾’
(hname) + 1);

45 ià(
h
->
hÇme
 =ğ
NULL
) {

46 
	`os_h—d”_ä“
(
h
);

47  
OSIP_NOMEM
;

50 
	`os_şºıy
(
h
->
hÇme
, hÇme, 
	`¡¾’
(hname));

52 ià(
hv®ue
 !ğ
NULL
) {

53 
h
->
hv®ue
 = (*è
	`os_m®loc
(
	`¡¾’
(hvalue) + 1);

55 ià(
h
->
hv®ue
 =ğ
NULL
) {

56 
	`os_h—d”_ä“
(
h
);

57  
OSIP_NOMEM
;

60 
	`os_şºıy
(
h
->
hv®ue
, hv®ue, 
	`¡¾’
(hvalue));

63 
h
->
hv®ue
 = 
NULL
;

65 
s
->
mes§ge_´İ”ty
 = 2;

66 
	`os_li¡_add
(&
s
->
h—d”s
, 
h
, -1);

67  
OSIP_SUCCESS
;

68 
	}
}

75 
	$os_mes§ge_»¶aû_h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
) {

76 
os_h—d”_t
 *
h
, *
Şdh
;

77 
i
, 
Şdpos
 = -1;

79 ià(
s
 =ğ
NULL
 || 
hÇme
 == NULL)

80  
OSIP_BADPARAMETER
;

82 
Şdpos
 = 
	`os_mes§ge_h—d”_g‘_byÇme
(
s
, 
hÇme
, 0, &
Şdh
);

84 
i
 = 
	`os_h—d”_š™
(&
h
);

86 ià(
i
 != 0)

87  
i
;

89 
h
->
hÇme
 = (*è
	`os_m®loc
(
	`¡¾’
(hname) + 1);

91 ià(
h
->
hÇme
 =ğ
NULL
) {

92 
	`os_h—d”_ä“
(
h
);

93  
OSIP_NOMEM
;

96 
	`os_şºıy
(
h
->
hÇme
, hÇme, 
	`¡¾’
(hname));

98 ià(
hv®ue
 !ğ
NULL
) {

99 
h
->
hv®ue
 = (*è
	`os_m®loc
(
	`¡¾’
(hvalue) + 1);

101 ià(
h
->
hv®ue
 =ğ
NULL
) {

102 
	`os_h—d”_ä“
(
h
);

103  
OSIP_NOMEM
;

106 
	`os_şºıy
(
h
->
hv®ue
, hv®ue, 
	`¡¾’
(hvalue));

109 
h
->
hv®ue
 = 
NULL
;

111 ià(
Şdpos
 != -1) {

112 
	`os_li¡_»move
(&
s
->
h—d”s
, 
Şdpos
);

113 
	`os_h—d”_ä“
(
Şdh
);

116 
s
->
mes§ge_´İ”ty
 = 2;

117 
	`os_li¡_add
(&
s
->
h—d”s
, 
h
, -1);

118  
OSIP_SUCCESS
;

119 
	}
}

121 #iâdeà
MINISIZE


127 
	$os_mes§ge_£t_tİh—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
) {

128 
os_h—d”_t
 *
h
;

129 
i
;

131 ià(
s
 =ğ
NULL
 || 
hÇme
 == NULL)

132  
OSIP_BADPARAMETER
;

134 
i
 = 
	`os_h—d”_š™
(&
h
);

136 ià(
i
 != 0)

137  
i
;

139 
h
->
hÇme
 = (*è
	`os_m®loc
(
	`¡¾’
(hname) + 1);

141 ià(
h
->
hÇme
 =ğ
NULL
) {

142 
	`os_h—d”_ä“
(
h
);

143  
OSIP_NOMEM
;

146 
	`os_şºıy
(
h
->
hÇme
, hÇme, 
	`¡¾’
(hname));

148 ià(
hv®ue
 !ğ
NULL
) {

149 
h
->
hv®ue
 = (*è
	`os_m®loc
(
	`¡¾’
(hvalue) + 1);

151 ià(
h
->
hv®ue
 =ğ
NULL
) {

152 
	`os_h—d”_ä“
(
h
);

153  
OSIP_NOMEM
;

156 
	`os_şºıy
(
h
->
hv®ue
, hv®ue, 
	`¡¾’
(hvalue));

159 
h
->
hv®ue
 = 
NULL
;

161 
s
->
mes§ge_´İ”ty
 = 2;

162 
	`os_li¡_add
(&
s
->
h—d”s
, 
h
, 0);

163  
OSIP_SUCCESS
;

164 
	}
}

170 
	$os_mes§ge_g‘_h—d”
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_h—d”_t
 **
de¡
) {

171 *
de¡
 = 
NULL
;

173 ià(
	`os_li¡_size
(&
s
->
h—d”s
è<ğ
pos
)

174  
OSIP_UNDEFINED_ERROR
;

176 *
de¡
 = (
os_h—d”_t
 *è
	`os_li¡_g‘
(&
s
->
h—d”s
, 
pos
);

177  
pos
;

178 
	}
}

186 
	$os_mes§ge_h—d”_g‘_byÇme
(cÚ¡ 
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, 
pos
, 
os_h—d”_t
 **
de¡
) {

187 
i
;

188 
os_h—d”_t
 *
tmp
;

190 *
de¡
 = 
NULL
;

191 
i
 = 
pos
;

193 ià(
	`os_li¡_size
(&
s
->
h—d”s
è<ğ
pos
)

194  
OSIP_UNDEFINED_ERROR
;

196 
	`os_li¡_size
(&
s
->
h—d”s
è> 
i
) {

197 
tmp
 = (
os_h—d”_t
 *è
	`os_li¡_g‘
(&
s
->
h—d”s
, 
i
);

199 ià(
	`os_¡rÿ£cmp
(
tmp
->
hÇme
, hname) == 0) {

200 *
de¡
 = 
tmp
;

201  
i
;

204 
i
++;

207  
OSIP_UNDEFINED_ERROR
;

208 
	}
}

210 
	$os_h—d”_š™
(
os_h—d”_t
 **
h—d”
) {

211 *
h—d”
 = (
os_h—d”_t
 *è
	`os_m®loc
((osip_header_t));

213 ià(*
h—d”
 =ğ
NULL
)

214  
OSIP_NOMEM
;

216 (*
h—d”
)->
hÇme
 = 
NULL
;

217 (*
h—d”
)->
hv®ue
 = 
NULL
;

218  
OSIP_SUCCESS
;

219 
	}
}

221 
	$os_h—d”_ä“
(
os_h—d”_t
 *
h—d”
) {

222 ià(
h—d”
 =ğ
NULL
)

225 
	`os_ä“
(
h—d”
->
hÇme
);

226 
	`os_ä“
(
h—d”
->
hv®ue
);

227 
h—d”
->
hÇme
 = 
NULL
;

228 
h—d”
->
hv®ue
 = 
NULL
;

230 
	`os_ä“
(
h—d”
);

231 
	}
}

236 
	$os_h—d”_to_¡r
(cÚ¡ 
os_h—d”_t
 *
h—d”
, **
de¡
) {

237 
size_t
 
Ën
, 
hËn
;

239 *
de¡
 = 
NULL
;

241 ià((
h—d”
 =ğ
NULL
è|| (h—d”->
hÇme
 == NULL))

242  
OSIP_BADPARAMETER
;

244 
Ën
 = 0;

245 
hËn
 = 
	`¡¾’
(
h—d”
->
hÇme
);

247 ià(
h—d”
->
hv®ue
 !ğ
NULL
)

248 
Ën
 = 
	`¡¾’
(
h—d”
->
hv®ue
);

250 *
de¡
 = (*è
	`os_m®loc
(
hËn
 + 
Ën
 + 3);

252 ià(*
de¡
 =ğ
NULL
)

253  
OSIP_NOMEM
;

255 ià(
h—d”
->
hv®ue
 !ğ
NULL
)

256 
	`¢´štf
(*
de¡
, 
hËn
 + 
Ën
 + 3, "%s: %s", 
h—d”
->
hÇme
, h—d”->
hv®ue
);

259 
	`¢´štf
(*
de¡
, 
hËn
 + 
Ën
 + 3, "%s: ", 
h—d”
->
hÇme
);

261 ià(*
de¡
[0] >= 'a' && *dest[0] <= 'z')

262 *
de¡
[0] = (*dest[0] - 32);

264  
OSIP_SUCCESS
;

265 
	}
}

267 *
	$os_h—d”_g‘_Çme
(cÚ¡ 
os_h—d”_t
 *
h—d”
) {

268 ià(
h—d”
 =ğ
NULL
)

269  
NULL
;

271  
h—d”
->
hÇme
;

272 
	}
}

274 
	$os_h—d”_£t_Çme
(
os_h—d”_t
 *
h—d”
, *
Çme
) {

275 
h—d”
->
hÇme
 = 
Çme
;

276 
	}
}

278 *
	$os_h—d”_g‘_v®ue
(cÚ¡ 
os_h—d”_t
 *
h—d”
) {

279 ià(
h—d”
 =ğ
NULL
)

280  
NULL
;

282  
h—d”
->
hv®ue
;

283 
	}
}

285 
	$os_h—d”_£t_v®ue
(
os_h—d”_t
 *
h—d”
, *
v®ue
) {

286 
h—d”
->
hv®ue
 = 
v®ue
;

287 
	}
}

289 
	$os_h—d”_şÚe
(cÚ¡ 
os_h—d”_t
 *
h—d”
, os_h—d”_ˆ**
de¡
) {

290 
i
;

291 
os_h—d”_t
 *
he
;

293 *
de¡
 = 
NULL
;

295 ià(
h—d”
 =ğ
NULL
)

296  
OSIP_BADPARAMETER
;

298 ià(
h—d”
->
hÇme
 =ğ
NULL
)

299  
OSIP_BADPARAMETER
;

301 
i
 = 
	`os_h—d”_š™
(&
he
);

303 ià(
i
 != 0)

304  
i
;

306 
he
->
hÇme
 = 
	`os_¡rdup
(
h—d”
->hname);

308 ià(
he
->
hÇme
 =ğ
NULL
) {

309 
	`os_h—d”_ä“
(
he
);

310  
OSIP_NOMEM
;

313 ià(
h—d”
->
hv®ue
 !ğ
NULL
) {

314 
he
->
hv®ue
 = 
	`os_¡rdup
(
h—d”
->hvalue);

316 ià(
he
->
hv®ue
 =ğ
NULL
) {

317 
	`os_h—d”_ä“
(
he
);

318  
OSIP_NOMEM
;

322 *
de¡
 = 
he
;

323  
OSIP_SUCCESS
;

324 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_list.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_li¡.h
>

25 
	$os_li¡_š™
(
os_li¡_t
 *
li
) {

26 ià(
li
 =ğ
NULL
)

27  
OSIP_BADPARAMETER
;

29 
	`mem£t
(
li
, 0, (
os_li¡_t
));

30  
OSIP_SUCCESS
;

31 
	}
}

33 
	$os_li¡_şÚe
(cÚ¡ 
os_li¡_t
 *
¤c
, os_li¡_ˆ*
d¡
, (*
şÚe_func
)(*, **)) {

34 *
d©a
;

35 *
d©a2
;

36 
i
;

37 
os_li¡_™”©Ü_t
 
™”©Ü
;

39 
d©a
 = 
	`os_li¡_g‘_fœ¡
((
os_li¡_t
 *è
¤c
, &
™”©Ü
); 
	`os_li¡_™”©Ü_has_–em
(™”©Ü); d©¨ğ
	`os_li¡_g‘_Ãxt
(&iterator)) {

40 
i
 = 
	`şÚe_func
(
d©a
, &
d©a2
);

42 ià(
i
 != 0)

43  
i
;

45 
	`os_li¡_add
(
d¡
, 
d©a2
, -1);

48  
OSIP_SUCCESS
;

49 
	}
}

51 
	$os_li¡_¥ecŸl_ä“
(
os_li¡_t
 *
li
, (*
ä“_func
)(*)) {

52 *
–em’t
;

54 ià(
li
 =ğ
NULL
)

57 !
	`os_li¡_eŞ
(
li
, 0)) {

58 
–em’t
 = (*è
	`os_li¡_g‘
(
li
, 0);

59 
	`os_li¡_»move
(
li
, 0);

61 ià(
ä“_func
 !ğ
NULL
)

62 
	`ä“_func
(
–em’t
);

64 
	}
}

66 
	$os_li¡_ofch¬_ä“
(
os_li¡_t
 *
li
) {

67 *
chaš
;

69 ià(
li
 =ğ
NULL
)

72 !
	`os_li¡_eŞ
(
li
, 0)) {

73 
chaš
 = (*è
	`os_li¡_g‘
(
li
, 0);

74 
	`os_li¡_»move
(
li
, 0);

75 
	`os_ä“
(
chaš
);

77 
	}
}

79 
	$os_li¡_size
(cÚ¡ 
os_li¡_t
 *
li
) {

80 ià(
li
 =ğ
NULL
)

81  
OSIP_BADPARAMETER
;

83  
li
->
nb_–t
;

84 
	}
}

86 
	$os_li¡_eŞ
(cÚ¡ 
os_li¡_t
 *
li
, 
i
) {

87 ià(
li
 =ğ
NULL
)

88  
OSIP_BADPARAMETER
;

90 ià(
i
 < 
li
->
nb_–t
)

91  
OSIP_SUCCESS
;

94 
	}
}

97 
	$os_li¡_add
(
os_li¡_t
 *
li
, *
–
, 
pos
) {

98 
__node_t
 *
Ámp
;

99 
i
 = 0;

101 ià(
li
 =ğ
NULL
)

102  
OSIP_BADPARAMETER
;

104 ià(
li
->
nb_–t
 == 0) {

105 
li
->
node
 = (
__node_t
 *è
	`os_m®loc
((__node_t));

107 ià(
li
->
node
 =ğ
NULL
)

108  
OSIP_NOMEM
;

110 
li
->
node
->
–em’t
 = 
–
;

111 
li
->
node
->
Ãxt
 = 
NULL
;

112 
li
->
nb_–t
++;

113  
li
->
nb_–t
;

116 ià(
pos
 =ğ-1 ||…o >ğ
li
->
nb_–t
) {

117 
pos
 = 
li
->
nb_–t
;

120 
Ámp
 = 
li
->
node
;

122 ià(
pos
 == 0) {

123 
li
->
node
 = (
__node_t
 *è
	`os_m®loc
((__node_t));

125 ià(
li
->
node
 =ğ
NULL
) {

127 
li
->
node
 = 
Ámp
;

128  
OSIP_NOMEM
;

131 
li
->
node
->
–em’t
 = 
–
;

132 
li
->
node
->
Ãxt
 = 
Ámp
;

133 
li
->
nb_–t
++;

134  
li
->
nb_–t
;

137 
pos
 > 
i
 + 1) {

138 
i
++;

140 
Ámp
 =‚tmp->
Ãxt
;

144 ià(
pos
 =ğ
li
->
nb_–t
) {

145 
Ámp
->
Ãxt
 = 
	`os_m®loc
((
__node_t
));

147 ià(
Ámp
->
Ãxt
 =ğ
NULL
)

148  
OSIP_NOMEM
;

150 
Ámp
 =‚tmp->
Ãxt
;

151 
Ámp
->
–em’t
 = 
–
;

152 
Ámp
->
Ãxt
 = 
NULL
;

153 
li
->
nb_–t
++;

154  
li
->
nb_–t
;

159 
__node_t
 *
ÃxŠode
 = 
Ámp
->
Ãxt
;

161 
Ámp
->
Ãxt
 = 
	`os_m®loc
((
__node_t
));

163 ià(
Ámp
->
Ãxt
 =ğ
NULL
) {

165 
Ámp
->
Ãxt
 = 
ÃxŠode
;

166  
OSIP_NOMEM
;

169 
Ámp
 =‚tmp->
Ãxt
;

170 
Ámp
->
–em’t
 = 
–
;

171 
Ámp
->
Ãxt
 = 
ÃxŠode
;

172 
li
->
nb_–t
++;

174  
li
->
nb_–t
;

175 
	}
}

178 *
	$os_li¡_g‘
(cÚ¡ 
os_li¡_t
 *
li
, 
pos
) {

179 
__node_t
 *
Ámp
;

180 
i
 = 0;

182 ià(
li
 =ğ
NULL
)

183  
NULL
;

185 ià(
pos
 < 0 ||…o >ğ
li
->
nb_–t
)

187  
NULL
;

189 
Ámp
 = 
li
->
node
;

191 
pos
 > 
i
) {

192 
i
++;

193 
Ámp
 =‚tmp->
Ãxt
;

196  
Ámp
->
–em’t
;

197 
	}
}

200 *
	$os_li¡_g‘_fœ¡
(cÚ¡ 
os_li¡_t
 *
li
, 
os_li¡_™”©Ü_t
 *
™”©Ü
) {

201 ià(
li
 =ğ
NULL
 || 0 >ğli->
nb_–t
) {

202 
™”©Ü
->
aùu®
 = 0;

203  
OSIP_SUCCESS
;

206 
™”©Ü
->
aùu®
 = 
li
->
node
;

207 
™”©Ü
->
´ev
 = (
__node_t
 **è&
li
->
node
;

208 
™”©Ü
->
li
 = (
os_li¡_t
 *)†i;

209 
™”©Ü
->
pos
 = 0;

211  
li
->
node
->
–em’t
;

212 
	}
}

215 *
	$os_li¡_g‘_Ãxt
(
os_li¡_™”©Ü_t
 *
™”©Ü
) {

216 ià(
™”©Ü
->
aùu®
 =ğ
NULL
) {

217  
OSIP_SUCCESS
;

220 
™”©Ü
->
´ev
 = &(™”©Ü->
aùu®
->
Ãxt
);

221 
™”©Ü
->
aùu®
 = i‹¿tÜ->aùu®->
Ãxt
;

222 ++(
™”©Ü
->
pos
);

224 ià(
	`os_li¡_™”©Ü_has_–em
(*
™”©Ü
)) {

225  
™”©Ü
->
aùu®
->
–em’t
;

228 
™”©Ü
->
aùu®
 = 0;

229  
OSIP_SUCCESS
;

230 
	}
}

233 *
	$os_li¡_™”©Ü_»move
(
os_li¡_™”©Ü_t
 *
™”©Ü
) {

234 ià(
	`os_li¡_™”©Ü_has_–em
(*
™”©Ü
)) {

235 --(
™”©Ü
->
li
->
nb_–t
);

237 *(
™”©Ü
->
´ev
èğ™”©Ü->
aùu®
->
Ãxt
;

239 
	`os_ä“
(
™”©Ü
->
aùu®
);

240 
™”©Ü
->
aùu®
 = *(™”©Ü->
´ev
);

243 ià(
	`os_li¡_™”©Ü_has_–em
(*
™”©Ü
)) {

244  
™”©Ü
->
aùu®
->
–em’t
;

247  
OSIP_SUCCESS
;

248 
	}
}

251 
	$os_li¡_»move
(
os_li¡_t
 *
li
, 
pos
) {

252 
__node_t
 *
Ámp
;

253 
i
 = 0;

255 ià(
li
 =ğ
NULL
)

256  
OSIP_BADPARAMETER
;

258 ià(
pos
 < 0 ||…o >ğ
li
->
nb_–t
)

260  
OSIP_UNDEFINED_ERROR
;

262 
Ámp
 = 
li
->
node
;

264 ià(
pos
 == 0) {

265 
li
->
node
 = 
Ámp
->
Ãxt
;

266 
li
->
nb_–t
--;

267 
	`os_ä“
(
Ámp
);

268  
li
->
nb_–t
;

271 
pos
 > 
i
 + 1) {

272 
i
++;

273 
Ámp
 =‚tmp->
Ãxt
;

278 
__node_t
 *
»mnode
;

280 
»mnode
 = 
Ámp
->
Ãxt
;

281 
Ámp
->
Ãxt
 = (ntmp->next)->next;

282 
	`os_ä“
(
»mnode
);

283 
li
->
nb_–t
--;

285  
li
->
nb_–t
;

286 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_md5c.c

34 #iâdeà
NO_MD5_SUPPORT


36 
	~<os·r£r2/os_md5.h
>

41 
	#S11
 7

	)

42 
	#S12
 12

	)

43 
	#S13
 17

	)

44 
	#S14
 22

	)

45 
	#S21
 5

	)

46 
	#S22
 9

	)

47 
	#S23
 14

	)

48 
	#S24
 20

	)

49 
	#S31
 4

	)

50 
	#S32
 11

	)

51 
	#S33
 16

	)

52 
	#S34
 23

	)

53 
	#S41
 6

	)

54 
	#S42
 10

	)

55 
	#S43
 15

	)

56 
	#S44
 21

	)

58 
os_MD5T¿nsfÜm
 
PROTO_LIST
((
UINT4
[4], [64]));

59 
os_Encode
 
PROTO_LIST
((*, 
UINT4
 *, ) );

60 
os_Decode
 
PROTO_LIST
((
UINT4
 *, *, ) );

61 
os_MD5_memıy
 
PROTO_LIST
((
POINTER
, POINTER, ) );

62 
os_MD5_mem£t
 
PROTO_LIST
((
POINTER
, , ) );

64 
	gPADDING
[64] = {0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

68 
	#F
(
x
, 
y
, 
z
è(((xè& (y)è| ((~xè& (z)))

	)

69 
	#G
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& (~z)))

	)

70 
	#H
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

71 
	#I
(
x
, 
y
, 
z
è((yè^ ((xè| (~z)))

	)

75 
	#ROTATE_LEFT
(
x
, 
n
è(((xè<< (n)è| ((xè>> (32 - (n))))

	)

80 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

82 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

83 (
a
èğ
	`ROTATE_LEFT
(×), (
s
)); \

84 (
a
è+ğ(
b
); \

85 }

	)

86 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

88 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

89 (
a
èğ
	`ROTATE_LEFT
(×), (
s
)); \

90 (
a
è+ğ(
b
); \

91 }

	)

92 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

94 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

95 (
a
èğ
	`ROTATE_LEFT
(×), (
s
)); \

96 (
a
è+ğ(
b
); \

97 }

	)

98 
	#II
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) \

100 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

101 (
a
èğ
	`ROTATE_LEFT
(×), (
s
)); \

102 (
a
è+ğ(
b
); \

103 }

	)

107 
	$os_MD5In™
(
os_MD5_CTX
 *
cÚ‹xt


109 
cÚ‹xt
->
couÁ
[0] = context->count[1] = 0;

112 
cÚ‹xt
->
¡©e
[0] = 0x67452301;

113 
cÚ‹xt
->
¡©e
[1] = 0xefcdab89;

114 
cÚ‹xt
->
¡©e
[2] = 0x98badcfe;

115 
cÚ‹xt
->
¡©e
[3] = 0x10325476;

116 
	}
}

122 
	$os_MD5Upd©e
(
os_MD5_CTX
 *
cÚ‹xt
,

123 *
šput
,

124 
šputL’


126 
i
, 
šdex
, 
·¹L’
;

129 
šdex
 = (è((
cÚ‹xt
->
couÁ
[0] >> 3) & 0x3F);

132 ià((
cÚ‹xt
->
couÁ
[0] +ğ((
UINT4
è
šputL’
 << 3)) < ((UINT4) inputLen << 3))

133 
cÚ‹xt
->
couÁ
[1]++;

135 
cÚ‹xt
->
couÁ
[1] +ğ((
UINT4
è
šputL’
 >> 29);

137 
·¹L’
 = 64 - 
šdex
;

141 ià(
šputL’
 >ğ
·¹L’
) {

142 
	`os_MD5_memıy
((
POINTER
è&
cÚ‹xt
->
bufãr
[
šdex
], (POINTERè
šput
, 
·¹L’
);

143 
	`os_MD5T¿nsfÜm
(
cÚ‹xt
->
¡©e
, cÚ‹xt->
bufãr
);

145 
i
 = 
·¹L’
; i + 63 < 
šputL’
; i += 64)

146 
	`os_MD5T¿nsfÜm
(
cÚ‹xt
->
¡©e
, &
šput
[
i
]);

148 
šdex
 = 0;

151 
i
 = 0;

154 
	`os_MD5_memıy
((
POINTER
è&
cÚ‹xt
->
bufãr
[
šdex
], (POINTERè&
šput
[
i
], 
šputL’
 - i);

155 
	}
}

160 
	$os_MD5Fš®
(
dige¡
[16],

161 
os_MD5_CTX
 *
cÚ‹xt


163 
b™s
[8];

164 
šdex
, 
·dL’
;

167 
	`os_Encode
(
b™s
, 
cÚ‹xt
->
couÁ
, 8);

171 
šdex
 = (è((
cÚ‹xt
->
couÁ
[0] >> 3) & 0x3f);

172 
·dL’
 = (
šdex
 < 56) ? (56 - index) : (120 - index);

173 
	`os_MD5Upd©e
(
cÚ‹xt
, 
PADDING
, 
·dL’
);

176 
	`os_MD5Upd©e
(
cÚ‹xt
, 
b™s
, 8);

179 
	`os_Encode
(
dige¡
, 
cÚ‹xt
->
¡©e
, 16);

183 
	`os_MD5_mem£t
((
POINTER
è
cÚ‹xt
, 0, (*context));

184 
	}
}

188 
	$os_MD5T¿nsfÜm
(
UINT4
 
¡©e
[4], 
block
[64]) {

189 
UINT4
 
a
 = 
¡©e
[0], 
b
 = s‹[1], 
c
 = s‹[2], 
d
 = s‹[3], 
x
[16];

191 
	`os_Decode
(
x
, 
block
, 64);

194 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[0], 
S11
, 0xd76aa478);

195 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[1], 
S12
, 0xe8c7b756);

196 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[2], 
S13
, 0x242070db);

197 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[3], 
S14
, 0xc1bdceee);

198 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[4], 
S11
, 0xf57c0faf);

199 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[5], 
S12
, 0x4787c62a);

200 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[6], 
S13
, 0xa8304613);

201 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[7], 
S14
, 0xfd469501);

202 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[8], 
S11
, 0x698098d8);

203 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[9], 
S12
, 0x8b44f7af);

204 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[10], 
S13
, 0xffff5bb1);

205 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[11], 
S14
, 0x895cd7be);

206 
	`FF
(
a
, 
b
, 
c
, 
d
, 
x
[12], 
S11
, 0x6b901122);

207 
	`FF
(
d
, 
a
, 
b
, 
c
, 
x
[13], 
S12
, 0xfd987193);

208 
	`FF
(
c
, 
d
, 
a
, 
b
, 
x
[14], 
S13
, 0xa679438e);

209 
	`FF
(
b
, 
c
, 
d
, 
a
, 
x
[15], 
S14
, 0x49b40821);

212 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[1], 
S21
, 0xf61e2562);

213 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[6], 
S22
, 0xc040b340);

214 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[11], 
S23
, 0x265e5a51);

215 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[0], 
S24
, 0xe9b6c7aa);

216 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[5], 
S21
, 0xd62f105d);

217 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[10], 
S22
, 0x2441453);

218 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[15], 
S23
, 0xd8a1e681);

219 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[4], 
S24
, 0xe7d3fbc8);

220 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[9], 
S21
, 0x21e1cde6);

221 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[14], 
S22
, 0xc33707d6);

222 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[3], 
S23
, 0xf4d50d87);

223 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[8], 
S24
, 0x455a14ed);

224 
	`GG
(
a
, 
b
, 
c
, 
d
, 
x
[13], 
S21
, 0xa9e3e905);

225 
	`GG
(
d
, 
a
, 
b
, 
c
, 
x
[2], 
S22
, 0xfcefa3f8);

226 
	`GG
(
c
, 
d
, 
a
, 
b
, 
x
[7], 
S23
, 0x676f02d9);

227 
	`GG
(
b
, 
c
, 
d
, 
a
, 
x
[12], 
S24
, 0x8d2a4c8a);

230 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[5], 
S31
, 0xfffa3942);

231 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[8], 
S32
, 0x8771f681);

232 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[11], 
S33
, 0x6d9d6122);

233 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[14], 
S34
, 0xfde5380c);

234 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[1], 
S31
, 0xa4beea44);

235 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[4], 
S32
, 0x4bdecfa9);

236 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[7], 
S33
, 0xf6bb4b60);

237 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[10], 
S34
, 0xbebfbc70);

238 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[13], 
S31
, 0x289b7ec6);

239 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[0], 
S32
, 0xeaa127fa);

240 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[3], 
S33
, 0xd4ef3085);

241 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[6], 
S34
, 0x4881d05);

242 
	`HH
(
a
, 
b
, 
c
, 
d
, 
x
[9], 
S31
, 0xd9d4d039);

243 
	`HH
(
d
, 
a
, 
b
, 
c
, 
x
[12], 
S32
, 0xe6db99e5);

244 
	`HH
(
c
, 
d
, 
a
, 
b
, 
x
[15], 
S33
, 0x1fa27cf8);

245 
	`HH
(
b
, 
c
, 
d
, 
a
, 
x
[2], 
S34
, 0xc4ac5665);

248 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[0], 
S41
, 0xf4292244);

249 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[7], 
S42
, 0x432aff97);

250 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[14], 
S43
, 0xab9423a7);

251 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[5], 
S44
, 0xfc93a039);

252 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[12], 
S41
, 0x655b59c3);

253 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[3], 
S42
, 0x8f0ccc92);

254 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[10], 
S43
, 0xffeff47d);

255 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[1], 
S44
, 0x85845dd1);

256 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[8], 
S41
, 0x6fa87e4f);

257 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[15], 
S42
, 0xfe2ce6e0);

258 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[6], 
S43
, 0xa3014314);

259 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[13], 
S44
, 0x4e0811a1);

260 
	`II
(
a
, 
b
, 
c
, 
d
, 
x
[4], 
S41
, 0xf7537e82);

261 
	`II
(
d
, 
a
, 
b
, 
c
, 
x
[11], 
S42
, 0xbd3af235);

262 
	`II
(
c
, 
d
, 
a
, 
b
, 
x
[2], 
S43
, 0x2ad7d2bb);

263 
	`II
(
b
, 
c
, 
d
, 
a
, 
x
[9], 
S44
, 0xeb86d391);

265 
¡©e
[0] +ğ
a
;

266 
¡©e
[1] +ğ
b
;

267 
¡©e
[2] +ğ
c
;

268 
¡©e
[3] +ğ
d
;

272 
	`os_MD5_mem£t
((
POINTER
è
x
, 0, (x));

273 
	}
}

278 
	$os_Encode
(*
ouut
, 
UINT4
 *
šput
, 
Ën
) {

279 
i
, 
j
;

281 
i
 = 0, 
j
 = 0; j < 
Ën
; i++, j += 4) {

282 
ouut
[
j
] = (è(
šput
[
i
] & 0xff);

283 
ouut
[
j
 + 1] = (è((
šput
[
i
] >> 8) & 0xff);

284 
ouut
[
j
 + 2] = (è((
šput
[
i
] >> 16) & 0xff);

285 
ouut
[
j
 + 3] = (è((
šput
[
i
] >> 24) & 0xff);

287 
	}
}

292 
	$os_Decode
(
UINT4
 *
ouut
, *
šput
, 
Ën
) {

293 
i
, 
j
;

295 
i
 = 0, 
j
 = 0; j < 
Ën
; i++, j += 4)

296 
ouut
[
i
] = ((
UINT4
è
šput
[
j
]) | (((UINT4) input[j + 1]) << 8) | (((UINT4) input[j + 2]) << 16) | (((UINT4) input[j + 3]) << 24);

297 
	}
}

302 
	$os_MD5_memıy
(
POINTER
 
ouut
, POINTER 
šput
, 
Ën
) {

303 
i
;

305 
i
 = 0; i < 
Ën
; i++)

306 
ouut
[
i
] = 
šput
[i];

307 
	}
}

311 
	$os_MD5_mem£t
(
POINTER
 
ouut
, 
v®ue
, 
Ën
) {

312 
i
;

314 
i
 = 0; i < 
Ën
; i++)

315 ((*è
ouut
)[
i
] = (è
v®ue
;

316 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

27 cÚ¡ *
	gos_´ÙocŞ_v”siÚ
 = "SIP/2.0";

29 
	$os_mes§ge_š™
(
os_mes§ge_t
 **
s
) {

30 *
s
 = (
os_mes§ge_t
 *è
	`os_m®loc
((osip_message_t));

32 ià(*
s
 =ğ
NULL
)

33  
OSIP_NOMEM
;

35 
	`mem£t
(*
s
, 0, (
os_mes§ge_t
));

37 #iâdeà
MINISIZE


38 
	`os_li¡_š™
(&(*
s
)->
acû±s
);

39 
	`os_li¡_š™
(&(*
s
)->
acû±_’codšgs
);

41 
	`os_li¡_š™
(&(*
s
)->
acû±_Ïnguages
);

42 
	`os_li¡_š™
(&(*
s
)->
®”t_šfos
);

43 
	`os_li¡_š™
(&(*
s
)->
®lows
);

44 
	`os_li¡_š™
(&(*
s
)->
auth’tiÿtiÚ_šfos
);

46 
	`os_li¡_š™
(&(*
s
)->
authÜiz©iÚs
);

47 (*
s
)->
ÿÎ_id
 = 
NULL
;

48 
	`os_li¡_š™
(&(*
s
)->
ÿÎ_šfos
);

49 
	`os_li¡_š™
(&(*
s
)->
cÚùs
);

51 #iâdeà
MINISIZE


52 
	`os_li¡_š™
(&(*
s
)->
cÚ‹Á_’codšgs
);

54 (*
s
)->
cÚ‹Á_Ëngth
 = 
NULL
;

55 (*
s
)->
cÚ‹Á_ty³
 = 
NULL
;

56 (*
s
)->
c£q
 = 
NULL
;

57 #iâdeà
MINISIZE


58 
	`os_li¡_š™
(&(*
s
)->
”rÜ_šfos
);

60 (*
s
)->
äom
 = 
NULL
;

61 (*
s
)->
mime_v”siÚ
 = 
NULL
;

62 
	`os_li¡_š™
(&(*
s
)->
´oxy_auth’tiÿ‹s
);

63 #iâdeà
MINISIZE


64 
	`os_li¡_š™
(&(*
s
)->
´oxy_auth’tiÿtiÚ_šfos
);

66 
	`os_li¡_š™
(&(*
s
)->
´oxy_authÜiz©iÚs
);

67 
	`os_li¡_š™
(&(*
s
)->
»cÜd_rou‹s
);

68 
	`os_li¡_š™
(&(*
s
)->
rou‹s
);

69 (*
s
)->
to
 = 
NULL
;

70 
	`os_li¡_š™
(&(*
s
)->
vŸs
);

71 
	`os_li¡_š™
(&(*
s
)->
www_auth’tiÿ‹s
);

73 
	`os_li¡_š™
(&(*
s
)->
bod›s
);

75 
	`os_li¡_š™
(&(*
s
)->
h—d”s
);

77 (*
s
)->
mes§ge_´İ”ty
 = 3;

78 (*
s
)->
mes§ge
 = 
NULL
;

79 (*
s
)->
mes§ge_Ëngth
 = 0;

81 (*
s
)->
­¶iÿtiÚ_d©a
 = 
NULL
;

82  
OSIP_SUCCESS
;

83 
	}
}

85 
	$os_mes§ge_£t_»asÚ_ph¿£
(
os_mes§ge_t
 *
s
, *
»asÚ
) {

86 
s
->
»asÚ_ph¿£
 = 
»asÚ
;

87 
	}
}

89 
	$os_mes§ge_£t_¡©us_code
(
os_mes§ge_t
 *
s
, 
¡©us_code
) {

90 
s
->
¡©us_code
 = status_code;

91 
	}
}

93 
	$os_mes§ge_£t_m‘hod
(
os_mes§ge_t
 *
s
, *
s_m‘hod
) {

94 
s
->
s_m‘hod
 = sip_method;

95 
	}
}

97 
	$os_mes§ge_£t_v”siÚ
(
os_mes§ge_t
 *
s
, *
s_v”siÚ
) {

98 
s
->
s_v”siÚ
 = sip_version;

99 
	}
}

101 
	$os_mes§ge_£t_uri
(
os_mes§ge_t
 *
s
, 
os_uri_t
 *
u¾
) {

102 
s
->
»q_uri
 = 
u¾
;

103 
	}
}

105 
	$os_mes§ge_ä“
(
os_mes§ge_t
 *
s
) {

106 ià(
s
 =ğ
NULL
)

109 
	`os_ä“
(
s
->
s_m‘hod
);

110 
	`os_ä“
(
s
->
s_v”siÚ
);

112 ià(
s
->
»q_uri
 !ğ
NULL
)

113 
	`os_uri_ä“
(
s
->
»q_uri
);

115 
	`os_ä“
(
s
->
»asÚ_ph¿£
);

117 #iâdeà
MINISIZE


118 
	`os_li¡_¥ecŸl_ä“
(&
s
->
acû±s
, ((*)(*)è& 
os_acû±_ä“
);

120 
	`os_li¡_¥ecŸl_ä“
(&
s
->
authÜiz©iÚs
, ((*)(*)è& 
os_authÜiz©iÚ_ä“
);

122 ià(
s
->
ÿÎ_id
 !ğ
NULL
)

123 
	`os_ÿÎ_id_ä“
(
s
->
ÿÎ_id
);

125 #iâdeà
MINISIZE


126 
	`os_li¡_¥ecŸl_ä“
(&
s
->
acû±_’codšgs
, ((*)(*)è& 
os_acû±_’codšg_ä“
);

127 
	`os_li¡_¥ecŸl_ä“
(&
s
->
acû±_Ïnguages
, ((*)(*)è& 
os_acû±_Ïnguage_ä“
);

128 
	`os_li¡_¥ecŸl_ä“
(&
s
->
®”t_šfos
, ((*)(*)è& 
os_®”t_šfo_ä“
);

129 
	`os_li¡_¥ecŸl_ä“
(&
s
->
®lows
, ((*)(*)è& 
os_®low_ä“
);

130 
	`os_li¡_¥ecŸl_ä“
(&
s
->
auth’tiÿtiÚ_šfos
, ((*)(*)è& 
os_auth’tiÿtiÚ_šfo_ä“
);

131 
	`os_li¡_¥ecŸl_ä“
(&
s
->
cÚ‹Á_’codšgs
, ((*)(*)è& 
os_cÚ‹Á_’codšg_ä“
);

132 
	`os_li¡_¥ecŸl_ä“
(&
s
->
”rÜ_šfos
, ((*)(*)è& 
os_”rÜ_šfo_ä“
);

133 
	`os_li¡_¥ecŸl_ä“
(&
s
->
´oxy_auth’tiÿtiÚ_šfos
, ((*)(*)è& 
os_´oxy_auth’tiÿtiÚ_šfo_ä“
);

135 
	`os_li¡_¥ecŸl_ä“
(&
s
->
ÿÎ_šfos
, ((*)(*)è& 
os_ÿÎ_šfo_ä“
);

136 
	`os_li¡_¥ecŸl_ä“
(&
s
->
cÚùs
, ((*)(*)è& 
os_cÚù_ä“
);

138 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
)

139 
	`os_cÚ‹Á_Ëngth_ä“
(
s
->
cÚ‹Á_Ëngth
);

141 ià(
s
->
cÚ‹Á_ty³
 !ğ
NULL
)

142 
	`os_cÚ‹Á_ty³_ä“
(
s
->
cÚ‹Á_ty³
);

144 ià(
s
->
c£q
 !ğ
NULL
)

145 
	`os_c£q_ä“
(
s
->
c£q
);

147 ià(
s
->
äom
 !ğ
NULL
)

148 
	`os_äom_ä“
(
s
->
äom
);

150 ià(
s
->
mime_v”siÚ
 !ğ
NULL
)

151 
	`os_mime_v”siÚ_ä“
(
s
->
mime_v”siÚ
);

153 
	`os_li¡_¥ecŸl_ä“
(&
s
->
´oxy_auth’tiÿ‹s
, ((*)(*)è& 
os_´oxy_auth’tiÿ‹_ä“
);

154 
	`os_li¡_¥ecŸl_ä“
(&
s
->
´oxy_authÜiz©iÚs
, ((*)(*)è& 
os_´oxy_authÜiz©iÚ_ä“
);

155 
	`os_li¡_¥ecŸl_ä“
(&
s
->
»cÜd_rou‹s
, ((*)(*)è& 
os_»cÜd_rou‹_ä“
);

156 
	`os_li¡_¥ecŸl_ä“
(&
s
->
rou‹s
, ((*)(*)è& 
os_rou‹_ä“
);

158 ià(
s
->
to
 !ğ
NULL
)

159 
	`os_to_ä“
(
s
->
to
);

161 
	`os_li¡_¥ecŸl_ä“
(&
s
->
vŸs
, ((*)(*)è& 
os_vŸ_ä“
);

162 
	`os_li¡_¥ecŸl_ä“
(&
s
->
www_auth’tiÿ‹s
, ((*)(*)è& 
os_www_auth’tiÿ‹_ä“
);

163 
	`os_li¡_¥ecŸl_ä“
(&
s
->
h—d”s
, ((*)(*)è& 
os_h—d”_ä“
);

164 
	`os_li¡_¥ecŸl_ä“
(&
s
->
bod›s
, ((*)(*)è& 
os_body_ä“
);

165 
	`os_ä“
(
s
->
mes§ge
);

166 
	`os_ä“
(
s
);

167 
	}
}

169 
	$os_mes§ge_şÚe
(cÚ¡ 
os_mes§ge_t
 *
s
, os_mes§ge_ˆ**
de¡
) {

170 
os_mes§ge_t
 *
cİy
;

171 
i
;

173 *
de¡
 = 
NULL
;

175 ià(
s
 =ğ
NULL
)

176  
OSIP_BADPARAMETER
;

178 
i
 = 
	`os_mes§ge_š™
(&
cİy
);

180 ià(
i
 != 0)

181  
i
;

183 
cİy
->
s_m‘hod
 = 
	`os_¡rdup
(
s
->sip_method);

185 ià(
s
->
s_m‘hod
 !ğ
NULL
 && 
cİy
->sip_method == NULL) {

186 
	`os_mes§ge_ä“
(
cİy
);

187  
OSIP_NOMEM
;

190 
cİy
->
s_v”siÚ
 = 
	`os_¡rdup
(
s
->sip_version);

192 ià(
s
->
s_v”siÚ
 !ğ
NULL
 && 
cİy
->sip_version == NULL) {

193 
	`os_mes§ge_ä“
(
cİy
);

194  
OSIP_NOMEM
;

197 
cİy
->
¡©us_code
 = 
s
->status_code;

198 
cİy
->
»asÚ_ph¿£
 = 
	`os_¡rdup
(
s
->reason_phrase);

200 ià(
s
->
»asÚ_ph¿£
 !ğ
NULL
 && 
cİy
->reason_phrase == NULL) {

201 
	`os_mes§ge_ä“
(
cİy
);

202  
OSIP_NOMEM
;

205 ià(
s
->
»q_uri
 !ğ
NULL
) {

206 
i
 = 
	`os_uri_şÚe
(
s
->
»q_uri
, &(
cİy
->req_uri));

208 ià(
i
 != 0) {

209 
	`os_mes§ge_ä“
(
cİy
);

210  
i
;

214 #iâdeà
MINISIZE


215 
i
 = 
	`os_li¡_şÚe
(&
s
->
acû±s
, &
cİy
->acû±s, ((*)(*, **)è& 
os_acû±_şÚe
);

217 ià(
i
 != 0) {

218 
	`os_mes§ge_ä“
(
cİy
);

219  
i
;

222 
i
 = 
	`os_li¡_şÚe
(&
s
->
acû±_’codšgs
, &
cİy
->acû±_’codšgs, ((*)(*, **)è& 
os_acû±_’codšg_şÚe
);

224 ià(
i
 != 0) {

225 
	`os_mes§ge_ä“
(
cİy
);

226  
i
;

229 
i
 = 
	`os_li¡_şÚe
(&
s
->
acû±_Ïnguages
, &
cİy
->acû±_Ïnguages, ((*)(*, **)è& 
os_acû±_Ïnguage_şÚe
);

231 ià(
i
 != 0) {

232 
	`os_mes§ge_ä“
(
cİy
);

233  
i
;

236 
i
 = 
	`os_li¡_şÚe
(&
s
->
®”t_šfos
, &
cİy
->®”t_šfos, ((*)(*, **)è& 
os_®”t_šfo_şÚe
);

238 ià(
i
 != 0) {

239 
	`os_mes§ge_ä“
(
cİy
);

240  
i
;

243 
i
 = 
	`os_li¡_şÚe
(&
s
->
®lows
, &
cİy
->®lows, ((*)(*, **)è& 
os_®low_şÚe
);

245 ià(
i
 != 0) {

246 
	`os_mes§ge_ä“
(
cİy
);

247  
i
;

250 
i
 = 
	`os_li¡_şÚe
(&
s
->
auth’tiÿtiÚ_šfos
, &
cİy
->auth’tiÿtiÚ_šfos, ((*)(*, **)è& 
os_auth’tiÿtiÚ_šfo_şÚe
);

252 ià(
i
 != 0) {

253 
	`os_mes§ge_ä“
(
cİy
);

254  
i
;

257 
i
 = 
	`os_li¡_şÚe
(&
s
->
cÚ‹Á_’codšgs
, &
cİy
->cÚ‹Á_’codšgs, ((*)(*, **)è& 
os_cÚ‹Á_’codšg_şÚe
);

259 ià(
i
 != 0) {

260 
	`os_mes§ge_ä“
(
cİy
);

261  
i
;

264 
i
 = 
	`os_li¡_şÚe
(&
s
->
”rÜ_šfos
, &
cİy
->”rÜ_šfos, ((*)(*, **)è& 
os_”rÜ_šfo_şÚe
);

266 ià(
i
 != 0) {

267 
	`os_mes§ge_ä“
(
cİy
);

268  
i
;

271 
i
 = 
	`os_li¡_şÚe
(&
s
->
´oxy_auth’tiÿtiÚ_šfos
, &
cİy
->´oxy_auth’tiÿtiÚ_šfos, ((*)(*, **)è& 
os_´oxy_auth’tiÿtiÚ_šfo_şÚe
);

273 ià(
i
 != 0) {

274 
	`os_mes§ge_ä“
(
cİy
);

275  
i
;

279 
i
 = 
	`os_li¡_şÚe
(&
s
->
ÿÎ_šfos
, &
cİy
->ÿÎ_šfos, ((*)(*, **)è& 
os_ÿÎ_šfo_şÚe
);

281 ià(
i
 != 0) {

282 
	`os_mes§ge_ä“
(
cİy
);

283  
i
;

286 
i
 = 
	`os_li¡_şÚe
(&
s
->
authÜiz©iÚs
, &
cİy
->authÜiz©iÚs, ((*)(*, **)è& 
os_authÜiz©iÚ_şÚe
);

288 ià(
i
 != 0) {

289 
	`os_mes§ge_ä“
(
cİy
);

290  
i
;

293 ià(
s
->
ÿÎ_id
 !ğ
NULL
) {

294 
i
 = 
	`os_ÿÎ_id_şÚe
(
s
->
ÿÎ_id
, &(
cİy
->call_id));

296 ià(
i
 != 0) {

297 
	`os_mes§ge_ä“
(
cİy
);

298  
i
;

302 
i
 = 
	`os_li¡_şÚe
(&
s
->
cÚùs
, &
cİy
->cÚùs, ((*)(*, **)è& 
os_cÚù_şÚe
);

304 ià(
i
 != 0) {

305 
	`os_mes§ge_ä“
(
cİy
);

306  
i
;

309 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
) {

310 
i
 = 
	`os_cÚ‹Á_Ëngth_şÚe
(
s
->
cÚ‹Á_Ëngth
, &(
cİy
->content_length));

312 ià(
i
 != 0) {

313 
	`os_mes§ge_ä“
(
cİy
);

314  
i
;

318 ià(
s
->
cÚ‹Á_ty³
 !ğ
NULL
) {

319 
i
 = 
	`os_cÚ‹Á_ty³_şÚe
(
s
->
cÚ‹Á_ty³
, &(
cİy
->content_type));

321 ià(
i
 != 0) {

322 
	`os_mes§ge_ä“
(
cİy
);

323  
i
;

327 ià(
s
->
c£q
 !ğ
NULL
) {

328 
i
 = 
	`os_c£q_şÚe
(
s
->
c£q
, &(
cİy
->cseq));

330 ià(
i
 != 0) {

331 
	`os_mes§ge_ä“
(
cİy
);

332  
i
;

336 ià(
s
->
äom
 !ğ
NULL
) {

337 
i
 = 
	`os_äom_şÚe
(
s
->
äom
, &(
cİy
->from));

339 ià(
i
 != 0) {

340 
	`os_mes§ge_ä“
(
cİy
);

341  
i
;

345 ià(
s
->
mime_v”siÚ
 !ğ
NULL
) {

346 
i
 = 
	`os_mime_v”siÚ_şÚe
(
s
->
mime_v”siÚ
, &(
cİy
->mime_version));

348 ià(
i
 != 0) {

349 
	`os_mes§ge_ä“
(
cİy
);

350  
i
;

354 
i
 = 
	`os_li¡_şÚe
(&
s
->
´oxy_auth’tiÿ‹s
, &
cİy
->´oxy_auth’tiÿ‹s, ((*)(*, **)è& 
os_´oxy_auth’tiÿ‹_şÚe
);

356 ià(
i
 != 0) {

357 
	`os_mes§ge_ä“
(
cİy
);

358  
i
;

361 
i
 = 
	`os_li¡_şÚe
(&
s
->
´oxy_authÜiz©iÚs
, &
cİy
->´oxy_authÜiz©iÚs, ((*)(*, **)è& 
os_´oxy_authÜiz©iÚ_şÚe
);

363 ià(
i
 != 0) {

364 
	`os_mes§ge_ä“
(
cİy
);

365  
i
;

368 
i
 = 
	`os_li¡_şÚe
(&
s
->
»cÜd_rou‹s
, &
cİy
->»cÜd_rou‹s, ((*)(*, **)è& 
os_»cÜd_rou‹_şÚe
);

370 ià(
i
 != 0) {

371 
	`os_mes§ge_ä“
(
cİy
);

372  
i
;

375 
i
 = 
	`os_li¡_şÚe
(&
s
->
rou‹s
, &
cİy
->rou‹s, ((*)(*, **)è& 
os_rou‹_şÚe
);

377 ià(
i
 != 0) {

378 
	`os_mes§ge_ä“
(
cİy
);

379  
i
;

382 ià(
s
->
to
 !ğ
NULL
) {

383 
i
 = 
	`os_to_şÚe
(
s
->
to
, &(
cİy
->to));

385 ià(
i
 != 0) {

386 
	`os_mes§ge_ä“
(
cİy
);

387  
i
;

391 
i
 = 
	`os_li¡_şÚe
(&
s
->
vŸs
, &
cİy
->vŸs, ((*)(*, **)è& 
os_vŸ_şÚe
);

393 ià(
i
 != 0) {

394 
	`os_mes§ge_ä“
(
cİy
);

395  
i
;

398 
i
 = 
	`os_li¡_şÚe
(&
s
->
www_auth’tiÿ‹s
, &
cİy
->www_auth’tiÿ‹s, ((*)(*, **)è& 
os_www_auth’tiÿ‹_şÚe
);

400 ià(
i
 != 0) {

401 
	`os_mes§ge_ä“
(
cİy
);

402  
i
;

405 
i
 = 
	`os_li¡_şÚe
(&
s
->
h—d”s
, &
cİy
->h—d”s, ((*)(*, **)è& 
os_h—d”_şÚe
);

407 ià(
i
 != 0) {

408 
	`os_mes§ge_ä“
(
cİy
);

409  
i
;

412 
i
 = 
	`os_li¡_şÚe
(&
s
->
bod›s
, &
cİy
->bod›s, ((*)(*, **)è& 
os_body_şÚe
);

414 ià(
i
 != 0) {

415 
	`os_mes§ge_ä“
(
cİy
);

416  
i
;

419 
cİy
->
mes§ge_Ëngth
 = 
s
->message_length;

420 
cİy
->
mes§ge
 = 
	`os_¡rdup
(
s
->message);

422 ià(
cİy
->
mes§ge
 =ğ
NULL
 && 
s
->message != NULL) {

423 
	`os_mes§ge_ä“
(
cİy
);

424  
OSIP_NOMEM
;

427 
cİy
->
mes§ge_´İ”ty
 = 
s
->message_property;

428 
cİy
->
­¶iÿtiÚ_d©a
 = 
s
->application_data;

430 *
de¡
 = 
cİy
;

431  
OSIP_SUCCESS
;

432 
	}
}

434 
	$os_mes§ge_g‘_knownh—d”li¡
(
os_li¡_t
 *
h—d”_li¡
, 
pos
, **
de¡
) {

435 *
de¡
 = 
NULL
;

437 ià(
	`os_li¡_size
(
h—d”_li¡
è<ğ
pos
)

438  
OSIP_UNDEFINED_ERROR
;

440 *
de¡
 = (*è
	`os_li¡_g‘
(
h—d”_li¡
, 
pos
);

441  
pos
;

442 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_parse.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_·r£r.h
>

24 
	~"·r£r.h
"

26 
os_ut_»¶aû_®l_lws
(*
s_mes§ge
);

27 
os_mes§ge_£t__h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
);

28 
msg_h—d”s_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
¡¬t_of_h—d”
, cÚ¡ **
body
);

29 
msg_os_body_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
¡¬t_of_buf
, cÚ¡ **
Ãxt_body
, 
size_t
 
Ëngth
);

31 
	$__os_mes§ge_¡¬še_·r£»q
(
os_mes§ge_t
 *
de¡
, cÚ¡ *
buf
, cÚ¡ **
h—d”s
) {

32 cÚ¡ *
p1
;

33 cÚ¡ *
p2
;

34 *
»que¡uri
;

35 
i
;

37 
de¡
->
s_m‘hod
 = 
NULL
;

38 
de¡
->
¡©us_code
 = 0;

39 
de¡
->
»asÚ_ph¿£
 = 
NULL
;

41 *
h—d”s
 = 
buf
;

44 
p2
 = 
	`¡rchr
(
buf
, ' ');

46 ià(
p2
 =ğ
NULL
)

47  
OSIP_SYNTAXERROR
;

49 ià(*(
p2
 + 1) == '\0' || *(p2 + 2) == '\0')

50  
OSIP_SYNTAXERROR
;

52 ià(
p2
 - 
buf
 == 0) {

53 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No space‡llowed here\n"));

54  
OSIP_SYNTAXERROR
;

57 
de¡
->
s_m‘hod
 = (*è
	`os_m®loc
(
p2
 - 
buf
 + 1);

59 ià(
de¡
->
s_m‘hod
 =ğ
NULL
)

60  
OSIP_NOMEM
;

62 
	`os_¡ºıy
(
de¡
->
s_m‘hod
, 
buf
, 
p2
 - buf);

65 
p1
 = 
	`¡rchr
(
p2
 + 2, ' ');

67 ià(
p1
 =ğ
NULL
) {

68 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Uncompliant„equest-uri\n"));

69 
	`os_ä“
(
de¡
->
s_m‘hod
);

70 
de¡
->
s_m‘hod
 = 
NULL
;

71  
OSIP_SYNTAXERROR
;

74 ià(
p1
 - 
p2
 < 2) {

75 
	`os_ä“
(
de¡
->
s_m‘hod
);

76 
de¡
->
s_m‘hod
 = 
NULL
;

77  
OSIP_SYNTAXERROR
;

80 
»que¡uri
 = (*è
	`os_m®loc
(
p1
 - 
p2
);

82 ià(
»que¡uri
 =ğ
NULL
) {

83 
	`os_ä“
(
de¡
->
s_m‘hod
);

84 
de¡
->
s_m‘hod
 = 
NULL
;

85  
OSIP_NOMEM
;

88 
	`os_şºıy
(
»que¡uri
, 
p2
 + 1, (
p1
 -…2 - 1));

90 
i
 = 
	`os_uri_š™
(&(
de¡
->
»q_uri
));

92 ià(
i
 != 0) {

93 
	`os_ä“
(
»que¡uri
);

94 
»que¡uri
 = 
NULL
;

95 
	`os_ä“
(
de¡
->
s_m‘hod
);

96 
de¡
->
s_m‘hod
 = 
NULL
;

97  
OSIP_NOMEM
;

100 
i
 = 
	`os_uri_·r£
(
de¡
->
»q_uri
, 
»que¡uri
);

101 
	`os_ä“
(
»que¡uri
);

103 ià(
i
 != 0) {

104 
	`os_ä“
(
de¡
->
s_m‘hod
);

105 
de¡
->
s_m‘hod
 = 
NULL
;

106 
	`os_uri_ä“
(
de¡
->
»q_uri
);

107 
de¡
->
»q_uri
 = 
NULL
;

108  
OSIP_SYNTAXERROR
;

113 cÚ¡ *
hp
 = 
p1
;

115 
hp
++;

117 ià(*
hp
 == '\0' || *(hp + 1) == '\0' || *(hp + 2) == '\0' || *(hp + 3) == '\0' || *(hp + 4) == '\0' || *(hp + 5) == '\0' || *(hp + 6) == '\0') {

118 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Uncomplete„equest†ine\n"));

119 
	`os_ä“
(
de¡
->
s_m‘hod
);

120 
de¡
->
s_m‘hod
 = 
NULL
;

121 
	`os_uri_ä“
(
de¡
->
»q_uri
);

122 
de¡
->
»q_uri
 = 
NULL
;

123  
OSIP_SYNTAXERROR
;

126 ià(((
hp
[0] != 'S') && (hp[0] != 's')) || ((hp[1] != 'I') && (hp[1] != 'i')) || ((hp[2] != 'P') && (hp[2] != 'p')) || (hp[3] != '/')) {

127 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found/No SIP/2.0 found\n"));

128 
	`os_ä“
(
de¡
->
s_m‘hod
);

129 
de¡
->
s_m‘hod
 = 
NULL
;

130 
	`os_uri_ä“
(
de¡
->
»q_uri
);

131 
de¡
->
»q_uri
 = 
NULL
;

132  
OSIP_SYNTAXERROR
;

135 
hp
 = hp + 4;

137 (*
hp
 != '\r') && (*hp != '\n')) {

138 ià(*
hp
) {

139 ià((*
hp
 >= '0') && (*hp <= '9'))

140 
hp
++;

142 ià(*
hp
 == '.')

143 
hp
++;

146 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "incorrect sip version string\n"));

147 
	`os_ä“
(
de¡
->
s_m‘hod
);

148 
de¡
->
s_m‘hod
 = 
NULL
;

149 
	`os_uri_ä“
(
de¡
->
»q_uri
);

150 
de¡
->
»q_uri
 = 
NULL
;

151  
OSIP_SYNTAXERROR
;

155 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found\n"));

156 
	`os_ä“
(
de¡
->
s_m‘hod
);

157 
de¡
->
s_m‘hod
 = 
NULL
;

158 
	`os_uri_ä“
(
de¡
->
»q_uri
);

159 
de¡
->
»q_uri
 = 
NULL
;

160  
OSIP_SYNTAXERROR
;

164 ià(
hp
 - 
p1
 < 2) {

165 
	`os_ä“
(
de¡
->
s_m‘hod
);

166 
de¡
->
s_m‘hod
 = 
NULL
;

167 
	`os_uri_ä“
(
de¡
->
»q_uri
);

168 
de¡
->
»q_uri
 = 
NULL
;

169  
OSIP_SYNTAXERROR
;

172 
de¡
->
s_v”siÚ
 = (*è
	`os_m®loc
(
hp
 - 
p1
);

174 ià(
de¡
->
s_v”siÚ
 =ğ
NULL
) {

175 
	`os_ä“
(
de¡
->
s_m‘hod
);

176 
de¡
->
s_m‘hod
 = 
NULL
;

177 
	`os_uri_ä“
(
de¡
->
»q_uri
);

178 
de¡
->
»q_uri
 = 
NULL
;

179  
OSIP_NOMEM
;

182 
	`os_¡ºıy
(
de¡
->
s_v”siÚ
, 
p1
 + 1, (
hp
 -…1 - 1));

184 ià(0 !ğ
	`os_¡rÿ£cmp
(
de¡
->
s_v”siÚ
, "SIP/2.0")) {

185 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Wrong version‚umber\n"));

188 
hp
++;

190 ià((*
hp
) && ('\r' == hp[-1]) && ('\n' == hp[0]))

191 
hp
++;

193 (*
h—d”s
èğ
hp
;

195  
OSIP_SUCCESS
;

196 
	}
}

198 
	$__os_mes§ge_¡¬še_·r£»¥
(
os_mes§ge_t
 *
de¡
, cÚ¡ *
buf
, cÚ¡ **
h—d”s
) {

199 cÚ¡ *
¡©uscode
;

200 cÚ¡ *
»asÚph¿£
;

202 
de¡
->
»q_uri
 = 
NULL
;

203 
de¡
->
s_m‘hod
 = 
NULL
;

205 *
h—d”s
 = 
buf
;

207 
¡©uscode
 = 
	`¡rchr
(
buf
, ' ');

209 ià(
¡©uscode
 =ğ
NULL
)

210  
OSIP_SYNTAXERROR
;

212 ià(
¡©uscode
 - (*
h—d”s
) < 7)

213  
OSIP_SYNTAXERROR
;

215 
de¡
->
s_v”siÚ
 = (*è
	`os_m®loc
(
¡©uscode
 - (*
h—d”s
) + 1);

217 ià(
de¡
->
s_v”siÚ
 =ğ
NULL
)

218  
OSIP_NOMEM
;

220 
	`os_¡ºıy
(
de¡
->
s_v”siÚ
, *
h—d”s
, 
¡©uscode
 - (*headers));

222 
»asÚph¿£
 = 
	`¡rchr
(
¡©uscode
 + 1, ' ');

224 ià(
»asÚph¿£
 =ğ
NULL
) {

225 
	`os_ä“
(
de¡
->
s_v”siÚ
);

226 
de¡
->
s_v”siÚ
 = 
NULL
;

227  
OSIP_SYNTAXERROR
;

232 ià(
	`ssÿnf
(
¡©uscode
 + 1, "%d", &
de¡
->
¡©us_code
) != 1) {

234  
OSIP_SYNTAXERROR
;

237 ià(
de¡
->
¡©us_code
 == 0)

238  
OSIP_SYNTAXERROR
;

241 cÚ¡ *
hp
 = 
»asÚph¿£
;

243 (*
hp
 != '\r') && (*hp != '\n')) {

244 ià(*
hp
)

245 
hp
++;

248 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "No crlf found\n"));

249  
OSIP_SYNTAXERROR
;

253 
de¡
->
»asÚ_ph¿£
 = (*è
	`os_m®loc
(
hp
 - 
»asÚph¿£
);

255 ià(
de¡
->
»asÚ_ph¿£
 =ğ
NULL
) {

256 
	`os_ä“
(
de¡
->
s_v”siÚ
);

257 
de¡
->
s_v”siÚ
 = 
NULL
;

258  
OSIP_NOMEM
;

261 
	`os_¡ºıy
(
de¡
->
»asÚ_ph¿£
, 
»asÚph¿£
 + 1, 
hp
 -„easonphrase - 1);

263 
hp
++;

265 ià((*
hp
) && ('\r' == hp[-1]) && ('\n' == hp[0]))

266 
hp
++;

268 (*
h—d”s
èğ
hp
;

270  
OSIP_SUCCESS
;

271 
	}
}

273 
	$__os_mes§ge_¡¬še_·r£
(
os_mes§ge_t
 *
de¡
, cÚ¡ *
buf
, cÚ¡ **
h—d”s
) {

274 ià(0 =ğ
	`¡ºcmp
((cÚ¡ *è
buf
, (const *) "SIP/", 4))

275  
	`__os_mes§ge_¡¬še_·r£»¥
(
de¡
, 
buf
, 
h—d”s
);

278  
	`__os_mes§ge_¡¬še_·r£»q
(
de¡
, 
buf
, 
h—d”s
);

279 
	}
}

281 
	$__os_fšd_Ãxt_occu»nû
(cÚ¡ *
¡r
, cÚ¡ *
buf
, cÚ¡ **
šdex_of_¡r
, cÚ¡ *
’d_of_buf
) {

282 
size_t
 
¦’
;

284 *
šdex_of_¡r
 = 
NULL
;

286 ià(
¡r
 =ğ
NULL
 || 
buf
 == NULL)

287  
OSIP_BADPARAMETER
;

289 
¦’
 = 
	`¡¾’
(
¡r
);

291 
¦’
 < (
size_t
)(
’d_of_buf
 - 
buf
)) {

292 ià(!
	`memcmp
(
¡r
, 
buf
, 
¦’
)) {

293 *
šdex_of_¡r
 = 
buf
;

294  
OSIP_SUCCESS
;

297 ++
buf
;

300  
OSIP_SYNTAXERROR
;

301 
	}
}

306 
	$os_ut_»¶aû_®l_lws
(*
s_mes§ge
) {

308 *
tmp
;

310 ià(
s_mes§ge
 =ğ
NULL
)

315 
tmp
 = 
s_mes§ge
;

317 ; 
tmp
[0] != '\0';mp++) {

318 ià(('\0' =ğ
tmp
[0]) || ('\0' ==mp[1]) || ('\0' ==mp[2]) || ('\0' ==mp[3]))

321 ià((('\r' =ğ
tmp
[0]) && ('\n' ==mp[1]) && ('\r' ==mp[2]) && ('\n' ==mp[3])) || (('\r' ==mp[0]) && ('\r' ==mp[1])) || (('\n' ==mp[0]) && ('\n' ==mp[1])))

324 ià((('\r' =ğ
tmp
[0]) && ('\n' ==mp[1]) && ((' ' ==mp[2]) || ('\t' ==mp[2]))) || (('\r' ==mp[0]) && ((' ' ==mp[1]) || ('\t' ==mp[1]))) || (('\n' ==mp[0]) && ((' ' ==mp[1]) || ('\t' ==mp[1])))) {

326 
tmp
[0] = ' ';

327 
tmp
[1] = ' ';

328 
tmp
 =mp + 2;

331 ; ('\t' =ğ
tmp
[0] || ' ' ==mp[0]);) {

332 
tmp
[0] = ' ';

333 
tmp
++;

336 ià(
tmp
[0] == '\0')

340 
	}
}

342 
	$__os_fšd_Ãxt_ülf
(cÚ¡ *
¡¬t_of_h—d”
, cÚ¡ **
’d_of_h—d”
) {

343 cÚ¡ *
soh
 = 
¡¬t_of_h—d”
;

345 *
’d_of_h—d”
 = 
NULL
;

347 ('\r' !ğ*
soh
) && ('\n' != *soh)) {

348 ià(*
soh
)

349 
soh
++;

352 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

353  
OSIP_SYNTAXERROR
;

357 ià(('\r' =ğ
soh
[0]) && ('\n' == soh[1]))

360 
soh
 = soh + 1;

364 ià((' ' =ğ
soh
[1]) || ('\t' == soh[1])) {

370 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_BUG
, 
NULL
, "Messagehat contains LWS must be…rocessed with osip_util_replace_all_lws(char *tmp) before being…arsed.\n"));

374 *
’d_of_h—d”
 = 
soh
 + 1;

375  
OSIP_SUCCESS
;

376 
	}
}

378 
	$__os_fšd_Ãxt_ülfülf
(cÚ¡ *
¡¬t_of_·¹
, cÚ¡ **
’d_of_·¹
) {

379 cÚ¡ *
¡¬t_of_lše
;

380 cÚ¡ *
’d_of_lše
;

381 
i
;

383 
¡¬t_of_lše
 = 
¡¬t_of_·¹
;

386 
i
 = 
	`__os_fšd_Ãxt_ülf
(
¡¬t_of_lše
, &
’d_of_lše
);

388 ià(
i
 == -2) {

389 } ià(
i
 != 0) {

390 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

391  
i
;

394 ià('\0' =ğ
’d_of_lše
[0]) {

395 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Final CRLF is missing\n"));

396  
OSIP_SYNTAXERROR
;

398 } ià('\r' =ğ
’d_of_lše
[0]) {

399 ià('\n' =ğ
’d_of_lše
[1])

400 
’d_of_lše
++;

402 *
’d_of_·¹
 = 
’d_of_lše
 + 1;

403  
OSIP_SUCCESS
;

405 } ià('\n' =ğ
’d_of_lše
[0]) {

406 *
’d_of_·¹
 = 
’d_of_lše
 + 1;

407  
OSIP_SUCCESS
;

410 
¡¬t_of_lše
 = 
’d_of_lše
;

412 
	}
}

414 
	$os_mes§ge_£t__h—d”
(
os_mes§ge_t
 *
s
, cÚ¡ *
hÇme
, cÚ¡ *
hv®ue
) {

415 
my_šdex
;

417 ià(
hÇme
 =ğ
NULL
)

418  
OSIP_SYNTAXERROR
;

422 
my_šdex
 = 
	`__os_mes§ge_is_known_h—d”
(
hÇme
);

424 ià(
my_šdex
 >= 0) {

425 
»t
;

427 
»t
 = 
	`__os_mes§ge_ÿÎ_m‘hod
(
my_šdex
, 
s
, 
hv®ue
);

429 ià(
»t
 != 0)

430  
»t
;

432  
OSIP_SUCCESS
;

436 ià(
	`os_mes§ge_£t_h—d”
(
s
, 
hÇme
, 
hv®ue
) != 0) {

437 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Could‚ot set unknown header\n"));

438  
OSIP_SUCCESS
;

441  
OSIP_SUCCESS
;

442 
	}
}

444 
	$os_mes§ge_£t_muÉË_h—d”
(
os_mes§ge_t
 *
s
, *
hÇme
, *
hv®ue
) {

445 
i
;

446 *
±r
, *
p
;

447 *
comma
;

448 *
beg
;

449 *
’d
;

450 
šquÙes
, 
šuri
;

453 
	`os_tŞow”
(
hÇme
);

455 ià(
hv®ue
 =ğ
NULL
) {

456 
i
 = 
	`os_mes§ge_£t__h—d”
(
s
, 
hÇme
, 
hv®ue
);

458 ià(
i
 != 0)

459  
i
;

461  
OSIP_SUCCESS
;

464 
±r
 = 
hv®ue
;

465 
comma
 = 
	`¡rchr
(
±r
, ',');

472 ià(
comma
 =ğ
NULL
 || 
	`__os_mes§ge_is_h—d”_comma_£·¿‹d
(
hÇme
è!ğ
OSIP_SUCCESS
) {

473 
i
 = 
	`os_mes§ge_£t__h—d”
(
s
, 
hÇme
, 
hv®ue
);

475 ià(
i
 != 0)

476  
i
;

478  
OSIP_SUCCESS
;

481 
beg
 = 
hv®ue
;

482 
šquÙes
 = 0;

483 
šuri
 = 0;

486 ;; 
±r
++) {

487 *
±r
) {

491 
i
 = 0, 
p
 = 
±r
 - 1;… >ğ
beg
 && *p == '\\';…--, i++)

494 ià(
i
 % 2 == 0)

495 
šquÙes
 = !inquotes;

500 ià(!
šquÙes
) {

501 ià(!
šuri
) {

502 ià((
	`os_¡ºÿ£cmp
(
±r
 + 1, "sip:", 4) == 0 || osip_strncasecmp(ptr + 1, "sips:", 5) == 0 || osip_strncasecmp(ptr + 1, "http:", 5) == 0 || osip_strncasecmp(ptr + 1, "https:", 6) == 0 || osip_strncasecmp(ptr + 1, "tel:", 4) == 0) &&

503 
	`¡rchr
(
±r
, '>'))

504 
šuri
 = 1;

519 ià(!
šquÙes
) {

520 ià(
šuri
)

521 
šuri
 = 0;

528 
šquÙes
 = 0;

529 
šuri
 = 0;

534 ià(!
šquÙes
 && !
šuri
) {

535 *
av®ue
;

537 ià(
beg
[0] == '\0')

538  
OSIP_SUCCESS
;

540 
’d
 = 
±r
;

542 ià(
’d
 - 
beg
 + 1 < 2) {

543 
beg
 = 
’d
 + 1;

547 
av®ue
 = (*è
	`os_m®loc
(
’d
 - 
beg
 + 1);

549 ià(
av®ue
 =ğ
NULL
)

550  
OSIP_NOMEM
;

552 
	`os_şºıy
(
av®ue
, 
beg
, 
’d
 - beg);

554 
i
 = 
	`os_mes§ge_£t__h—d”
(
s
, 
hÇme
, 
av®ue
);

555 
	`os_ä“
(
av®ue
);

557 ià(
i
 != 0)

558  
i
;

560 
beg
 = 
’d
 + 1;

563 ià(*
±r
 == '\0')

564  
OSIP_SUCCESS
;

572 
	}
}

575 
	$msg_h—d”s_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
¡¬t_of_h—d”
, cÚ¡ **
body
) {

576 cÚ¡ *
cŞÚ_šdex
;

577 *
hÇme
;

578 *
hv®ue
;

579 cÚ¡ *
’d_of_h—d”
;

580 
i
;

583 ià(
¡¬t_of_h—d”
[0] == '\0') {

584 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO1
, 
NULL
, "SIP message does‚otƒnd with CRLFCRLF\n"));

585  
OSIP_SUCCESS
;

588 
i
 = 
	`__os_fšd_Ãxt_ülf
(
¡¬t_of_h—d”
, &
’d_of_h—d”
);

590 ià(
i
 == -2) {

591 } ià(
i
 != 0) {

592 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

593  
i
;

598 ià((
¡¬t_of_h—d”
[0] == '\r') || (start_of_header[0] == '\n')) {

599 *
body
 = 
¡¬t_of_h—d”
;

600  
OSIP_SUCCESS
;

604 
cŞÚ_šdex
 = 
	`¡rchr
(
¡¬t_of_h—d”
, ':');

606 ià(
cŞÚ_šdex
 =ğ
NULL
) {

607 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

608  
OSIP_SYNTAXERROR
;

611 ià(
cŞÚ_šdex
 - 
¡¬t_of_h—d”
 + 1 < 2)

612  
OSIP_SYNTAXERROR
;

614 ià(
’d_of_h—d”
 <ğ
cŞÚ_šdex
) {

615 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Malformed message\n"));

616  
OSIP_SYNTAXERROR
;

619 
hÇme
 = (*è
	`os_m®loc
(
cŞÚ_šdex
 - 
¡¬t_of_h—d”
 + 1);

621 ià(
hÇme
 =ğ
NULL
)

622  
OSIP_NOMEM
;

624 
	`os_şºıy
(
hÇme
, 
¡¬t_of_h—d”
, 
cŞÚ_šdex
 - start_of_header);

627 cÚ¡ *
’d
;

631 ià((
’d_of_h—d”
[-2] == '\r') || (end_of_header[-2] == '\n'))

632 
’d
 = 
’d_of_h—d”
 - 2;

635 
’d
 = 
’d_of_h—d”
 - 1;

637 ià((
’d
è-
cŞÚ_šdex
 < 2)

638 
hv®ue
 = 
NULL
;

640 
hv®ue
 = (*è
	`os_m®loc
((
’d
è-
cŞÚ_šdex
 + 1);

642 ià(
hv®ue
 =ğ
NULL
) {

643 
	`os_ä“
(
hÇme
);

644  
OSIP_NOMEM
;

647 
	`os_şºıy
(
hv®ue
, 
cŞÚ_šdex
 + 1, (
’d
) -colon_index - 1);

655 
i
 = 
	`os_mes§ge_£t_muÉË_h—d”
(
s
, 
hÇme
, 
hv®ue
);

657 
	`os_ä“
(
hÇme
);

659 ià(
hv®ue
 !ğ
NULL
)

660 
	`os_ä“
(
hv®ue
);

662 ià(
i
 != 0) {

663 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "End of header Not found\n"));

664  
OSIP_SYNTAXERROR
;

668 
¡¬t_of_h—d”
 = 
’d_of_h—d”
;

675  
OSIP_SYNTAXERROR
;

676 
	}
}

678 
	$msg_os_body_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
¡¬t_of_buf
, cÚ¡ **
Ãxt_body
, 
size_t
 
Ëngth
) {

679 cÚ¡ *
¡¬t_of_body
;

680 cÚ¡ *
’d_of_body
;

681 cÚ¡ *
’d_of_buf
;

682 *
tmp
;

683 
i
;

685 *
£p_bound¬y
;

686 
size_t
 
Ën_£p_bound¬y
;

687 
os_g’”ic_·¿m_t
 *
ù_·¿m
;

689 ià(
s
->
cÚ‹Á_ty³
 =ğ
NULL
 || s->cÚ‹Á_ty³->
ty³
 =ğNULL || s->cÚ‹Á_ty³->
subty³
 == NULL)

690  
OSIP_SUCCESS
;

692 ià(0 !ğ
	`os_¡rÿ£cmp
(
s
->
cÚ‹Á_ty³
->
ty³
, "multipart")) {

693 
size_t
 
os_body_Ën
;

695 ià(
¡¬t_of_buf
[0] == '\0')

696  
OSIP_SYNTAXERROR
;

699 ià('\r' =ğ
¡¬t_of_buf
[0]) {

700 ià('\n' =ğ
¡¬t_of_buf
[1])

701 
¡¬t_of_body
 = 
¡¬t_of_buf
 + 2;

704 
¡¬t_of_body
 = 
¡¬t_of_buf
 + 1;

706 } ià('\n' =ğ
¡¬t_of_buf
[0])

707 
¡¬t_of_body
 = 
¡¬t_of_buf
 + 1;

710  
OSIP_SYNTAXERROR
;

713 
Ëngth
 =†’gth - (
¡¬t_of_body
 - 
¡¬t_of_buf
);

715 ià(
Ëngth
 <= 0)

716  
OSIP_SYNTAXERROR
;

718 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
)

719 
os_body_Ën
 = 
	`os_©oi
(
s
->
cÚ‹Á_Ëngth
->
v®ue
);

723 
tmp
[16];

725 
os_body_Ën
 = 
Ëngth
;

726 
	`¥rštf
(
tmp
, "%i", (è
os_body_Ën
);

727 
i
 = 
	`os_mes§ge_£t_cÚ‹Á_Ëngth
(
s
, 
tmp
);

729 ià(
i
 != 0)

730  
i
;

733 ià(
Ëngth
 < 
os_body_Ën
) {

734 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Mes§gwa nÙ„eû›vedƒÁ”–y.†’gth=%˜os_body_Ën=%i\n", (è
Ëngth
, (è
os_body_Ën
));

735  
OSIP_SYNTAXERROR
;

738 
’d_of_body
 = 
¡¬t_of_body
 + 
os_body_Ën
;

739 
tmp
 = 
	`os_m®loc
(
’d_of_body
 - 
¡¬t_of_body
 + 2);

741 ià(
tmp
 =ğ
NULL
)

742  
OSIP_NOMEM
;

744 
	`memıy
(
tmp
, 
¡¬t_of_body
, 
’d_of_body
 - start_of_body);

745 
tmp
[
’d_of_body
 - 
¡¬t_of_body
] = '\0';

747 
i
 = 
	`os_mes§ge_£t_body
(
s
, 
tmp
, 
’d_of_body
 - 
¡¬t_of_body
);

748 
	`os_ä“
(
tmp
);

750 ià(
i
 != 0)

751  
i
;

753  
OSIP_SUCCESS
;

757 
i
 = 
	`os_g’”ic_·¿m_g‘_byÇme
(&
s
->
cÚ‹Á_ty³
->
g’_·¿ms
, "bound¬y", &
ù_·¿m
);

759 ià(
i
 != 0)

760  
i
;

762 ià(
ù_·¿m
 =ğ
NULL
)

763  
OSIP_SYNTAXERROR
;

765 ià(
ù_·¿m
->
gv®ue
 =ğ
NULL
)

766  
OSIP_SYNTAXERROR
;

769 cÚ¡ *
bound¬y_´efix
 = "\n--";

771 
size_t
 
Ën
 = 
	`¡¾’
(
ù_·¿m
->
gv®ue
);

773 
£p_bound¬y
 = (*è
	`os_m®loc
(
Ën
 + 4);

775 ià(
£p_bound¬y
 =ğ
NULL
)

776  
OSIP_NOMEM
;

778 
	`¡rıy
(
£p_bound¬y
, 
bound¬y_´efix
);

780 ià(
ù_·¿m
->
gv®ue
[0] =ğ'"' && ct_·¿m->gv®ue[
Ën
 - 1] == '"')

781 
	`¡ºÿt
(
£p_bound¬y
, 
ù_·¿m
->
gv®ue
 + 1, 
Ën
 - 2);

784 
	`¡ºÿt
(
£p_bound¬y
, 
ù_·¿m
->
gv®ue
, 
Ën
);

787 
Ën_£p_bound¬y
 = 
	`¡¾’
(
£p_bound¬y
);

789 *
Ãxt_body
 = 
NULL
;

790 
¡¬t_of_body
 = 
¡¬t_of_buf
;

792 
’d_of_buf
 = 
¡¬t_of_buf
 + 
Ëngth
;

795 
size_t
 
body_Ën
 = 0;

797 
i
 = 
	`__os_fšd_Ãxt_occu»nû
(
£p_bound¬y
, 
¡¬t_of_body
, &¡¬t_of_body, 
’d_of_buf
);

799 ià(
i
 != 0) {

800 
	`os_ä“
(
£p_bound¬y
);

801  
i
;

804 
i
 = 
	`__os_fšd_Ãxt_occu»nû
(
£p_bound¬y
, 
¡¬t_of_body
 + 
Ën_£p_bound¬y
, &
’d_of_body
, 
’d_of_buf
);

806 ià(
i
 != 0) {

807 
	`os_ä“
(
£p_bound¬y
);

808  
i
;

812 
¡¬t_of_body
 = s¹_of_body + 
Ën_£p_bound¬y
 + 1;

814 ià('\n' =ğ
¡¬t_of_body
[0] || '\r' == start_of_body[0])

815 
¡¬t_of_body
++;

818 ià(
’d_of_body
 <ğ
¡¬t_of_body
) {

819 
	`os_ä“
(
£p_bound¬y
);

820  
OSIP_SYNTAXERROR
;

823 
body_Ën
 = 
’d_of_body
 - 
¡¬t_of_body
;

826 ià(*(
’d_of_body
 - 1) == '\r')

827 
body_Ën
--;

829 
tmp
 = 
	`os_m®loc
(
body_Ën
 + 2);

831 ià(
tmp
 =ğ
NULL
) {

832 
	`os_ä“
(
£p_bound¬y
);

833  
OSIP_NOMEM
;

836 
	`memıy
(
tmp
, 
¡¬t_of_body
, 
body_Ën
);

837 
tmp
[
body_Ën
] = '\0';

839 
i
 = 
	`os_mes§ge_£t_body_mime
(
s
, 
tmp
, 
body_Ën
);

840 
	`os_ä“
(
tmp
);

842 ià(
i
 != 0) {

843 
	`os_ä“
(
£p_bound¬y
);

844  
i
;

847 ià(
	`¡ºcmp
(
’d_of_body
 + 
Ën_£p_bound¬y
, "--", 2) == 0) {

848 *
Ãxt_body
 = 
’d_of_body
;

849 
	`os_ä“
(
£p_bound¬y
);

850  
OSIP_SUCCESS
;

854 
¡¬t_of_body
 = 
’d_of_body
;

859  
OSIP_SYNTAXERROR
;

860 
	}
}

863 
	$_os_mes§ge_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
, 
säag
) {

864 
i
;

865 cÚ¡ *
Ãxt_h—d”_šdex
;

866 *
tmp
;

867 *
beg
;

869 
tmp
 = 
	`os_m®loc
(
Ëngth
 + 2);

871 ià(
tmp
 =ğ
NULL
) {

872 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚ot‡llocate memory.\n"));

873  
OSIP_NOMEM
;

876 
beg
 = 
tmp
;

877 
	`memıy
(
tmp
, 
buf
, 
Ëngth
);

878 
tmp
[
Ëngth
] = '\0';

880 
tmp
 +ğ
	`¡r¥n
(tmp, "\r\n");

881 
	`os_ut_»¶aû_®l_lws
(
tmp
);

883 
i
 = 
	`__os_mes§ge_¡¬še_·r£
(
s
, 
tmp
, &
Ãxt_h—d”_šdex
);

885 ià(
i
 !ğ0 && !
säag
) {

886 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "Could‚ot…arse start†ine of message.\n"));

887 
	`os_ä“
(
beg
);

888  
i
;

891 
tmp
 = (*è
Ãxt_h—d”_šdex
;

894 
i
 = 
	`msg_h—d”s_·r£
(
s
, 
tmp
, &
Ãxt_h—d”_šdex
);

896 ià(
i
 != 0) {

897 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "error in msg_headers_parse()\n"));

898 
	`os_ä“
(
beg
);

899  
i
;

902 
tmp
 = (*è
Ãxt_h—d”_šdex
;

904 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
 && s->cÚ‹Á_Ëngth->
v®ue
 == NULL) {

906 
	`os_cÚ‹Á_Ëngth_ä“
(
s
->
cÚ‹Á_Ëngth
);

907 
s
->
cÚ‹Á_Ëngth
 = 
NULL
;

910 ià(
s
->
cÚ‹Á_Ëngth
 !ğ
NULL
 && s->cÚ‹Á_Ëngth->
v®ue
 !ğNULL && 
	`©oi
(sip->content_length->value) > 0) {

912 } ià(
s
->
cÚ‹Á_Ëngth
 =ğ
NULL
 && '\r' =ğ
Ãxt_h—d”_šdex
[0] && '\n' =ğÃxt_h—d”_šdex[1] && 
Ëngth
 - (
tmp
 - 
beg
) - (2) > 0) {

914 } ià(
s
->
cÚ‹Á_Ëngth
 =ğ
NULL
 && '\n' =ğ
Ãxt_h—d”_šdex
[0] && 
Ëngth
 - (
tmp
 - 
beg
) - (1) > 0) {

917 ià(
s
->
cÚ‹Á_Ëngth
 =ğ
NULL
)

918 
	`os_mes§ge_£t_cÚ‹Á_Ëngth
(
s
, "0");

920 
	`os_ä“
(
beg
);

921  
OSIP_SUCCESS
;

924 
i
 = 
	`msg_os_body_·r£
(
s
, 
tmp
, &
Ãxt_h—d”_šdex
, 
Ëngth
 - (tm°- 
beg
));

925 
	`os_ä“
(
beg
);

927 ià(
i
 != 0) {

928 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "error in msg_osip_body_parse()\n"));

929  
i
;

933 ià(
s
->
cÚ‹Á_Ëngth
 =ğ
NULL
)

934 
	`os_mes§ge_£t_cÚ‹Á_Ëngth
(
s
, "0");

936  
OSIP_SUCCESS
;

937 
	}
}

939 
	$os_mes§ge_·r£
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
) {

940  
	`_os_mes§ge_·r£
(
s
, 
buf
, 
Ëngth
, 0);

941 
	}
}

943 
	$os_mes§ge_·r£_säag
(
os_mes§ge_t
 *
s
, cÚ¡ *
buf
, 
size_t
 
Ëngth
) {

944  
	`_os_mes§ge_·r£
(
s
, 
buf
, 
Ëngth
, 1);

945 
	}
}

949 
	$os_mes§ge_fix_Ï¡_vŸ_h—d”
(
os_mes§ge_t
 *
»que¡
, cÚ¡ *
_addr
, 
pÜt
) {

950 
os_g’”ic_·¿m_t
 *
½Üt
;

951 
os_vŸ_t
 *
vŸ
;

954 ià(
»que¡
 =ğ
NULL
)

955  
OSIP_BADPARAMETER
;

957 ià(
	`MSG_IS_RESPONSE
(
»que¡
))

958  
OSIP_SUCCESS
;

960 
vŸ
 = 
	`os_li¡_g‘
(&
»que¡
->
vŸs
, 0);

962 ià(
vŸ
 =ğ
NULL
 || vŸ->
ho¡
 == NULL)

964  
OSIP_BADPARAMETER
;

966 
	`os_vŸ_·¿m_g‘_byÇme
(
vŸ
, "½Üt", &
½Üt
);

968 ià(
½Üt
 !ğ
NULL
) {

969 ià(
½Üt
->
gv®ue
 =ğ
NULL
) {

970 
½Üt
->
gv®ue
 = (*è
	`os_m®loc
(9);

972 ià(
½Üt
->
gv®ue
 =ğ
NULL
)

973  
OSIP_NOMEM
;

975 #ià!
defšed
 
__PALMOS__
 && (defšed 
WIN32
 || defšed 
_WIN32_WCE
)

976 
	`_¢´štf
(
½Üt
->
gv®ue
, 8, "%i", 
pÜt
);

978 
	`¢´štf
(
½Üt
->
gv®ue
, 8, "%i", 
pÜt
);

985 ià(0 =ğ
	`¡rcmp
(
vŸ
->
ho¡
, 
_addr
))

986  
OSIP_SUCCESS
;

988 
	`os_vŸ_£t_»ûived
(
vŸ
, 
	`os_¡rdup
(
_addr
));

989  
OSIP_SUCCESS
;

990 
	}
}

992 cÚ¡ *
	$os_mes§ge_g‘_»asÚ
(
»¶ycode
) {

993 
	scode_to_»asÚ
 {

994 
code
;

995 cÚ¡ *
»asÚ
;

998 cÚ¡ 
code_to_»asÚ
 
»asÚs1xx
[] = {

1001 cÚ¡ 
code_to_»asÚ
 
»asÚs2xx
[] = {

1006 cÚ¡ 
code_to_»asÚ
 
»asÚs3xx
[] = {

1009 cÚ¡ 
code_to_»asÚ
 
»asÚs4xx
[] = {

1058 cÚ¡ 
code_to_»asÚ
 
»asÚs5xx
[] = {

1061 cÚ¡ 
code_to_»asÚ
 
»asÚs6xx
[] = {{600, "Busy Everywhere"}, {603, "Decline"}, {604, "Does Not Exist Anywhere"}, {606, "Not Acceptable"}, {607, "Unwanted"}, {687, "Dialog Terminated"}};

1062 cÚ¡ 
code_to_»asÚ
 *
»asÚs
;

1063 
Ën
, 
i
;

1065 
»¶ycode
 / 100) {

1067 
»asÚs
 = 
»asÚs1xx
;

1068 
Ën
 = (
»asÚs1xx
è/ (*
»asÚs
);

1072 
»asÚs
 = 
»asÚs2xx
;

1073 
Ën
 = (
»asÚs2xx
è/ (*
»asÚs
);

1077 
»asÚs
 = 
»asÚs3xx
;

1078 
Ën
 = (
»asÚs3xx
è/ (*
»asÚs
);

1082 
»asÚs
 = 
»asÚs4xx
;

1083 
Ën
 = (
»asÚs4xx
è/ (*
»asÚs
);

1087 
»asÚs
 = 
»asÚs5xx
;

1088 
Ën
 = (
»asÚs5xx
è/ (*
»asÚs
);

1092 
»asÚs
 = 
»asÚs6xx
;

1093 
Ën
 = (
»asÚs6xx
è/ (*
»asÚs
);

1097  
NULL
;

1100 
i
 = 0; i < 
Ën
; i++)

1101 ià(
»asÚs
[
i
].
code
 =ğ
»¶ycode
)

1102  
»asÚs
[
i
].
»asÚ
;

1105  
NULL
;

1106 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_to_str.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_·r£r.h
>

25 
	#MIME_MAX_BOUNDARY_LEN
 70

	)

27 cÚ¡ *
os_´ÙocŞ_v”siÚ
;

29 
¡rÿt_sim¶e_h—d”
(**
_¡ršg
, 
size_t
 *
m®loc_size
, **
_mes§ge
, *
±r_h—d”
, *
h—d”_Çme
, size_ˆ
size_of_h—d”
, (*
xxx_to_¡r
)(*, **), **
Ãxt
);

30 
	`¡rÿt_h—d”s_Úe_³r_lše
(**
_¡ršg
, 
size_t
 *
m®loc_size
, **
_mes§ge
, 
os_li¡_t
 *
h—d”s
, *
h—d”
, size_ˆ
size_of_h—d”
, (*
xxx_to_¡r
)(*, **), **
Ãxt
);

32 
	$__os_mes§ge_¡¬še_to_¡¼eq
(
os_mes§ge_t
 *
s
, **
de¡
) {

33 cÚ¡ *
s_v”siÚ
;

34 *
tmp
;

35 *
rquri
;

36 
i
;

38 *
de¡
 = 
NULL
;

40 ià((
s
 =ğ
NULL
è|| (s->
»q_uri
 =ğNULLè|| (s->
s_m‘hod
 == NULL))

41  
OSIP_BADPARAMETER
;

43 
i
 = 
	`os_uri_to_¡r
(
s
->
»q_uri
, &
rquri
);

45 ià(
i
 != 0)

46  
i
;

48 ià(
s
->
s_v”siÚ
 =ğ
NULL
)

49 
s_v”siÚ
 = 
os_´ÙocŞ_v”siÚ
;

52 
s_v”siÚ
 = 
s
->sip_version;

54 *
de¡
 = (*è
	`os_m®loc
(
	`¡¾’
(
s
->
s_m‘hod
è+ sŒËn(
rquri
è+ sŒËn(
s_v”siÚ
) + 3);

56 ià(*
de¡
 =ğ
NULL
) {

57 
	`os_ä“
(
rquri
);

58  
OSIP_NOMEM
;

61 
tmp
 = *
de¡
;

63 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
s
->
s_m‘hod
);

64 *
tmp
 = ' ';

65 
tmp
++;

66 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
rquri
);

67 *
tmp
 = ' ';

68 
tmp
++;

69 
	`¡rıy
(
tmp
, 
s_v”siÚ
);

71 
	`os_ä“
(
rquri
);

72  
OSIP_SUCCESS
;

73 
	}
}

75 
	$__os_mes§ge_¡¬še_to_¡¼e¥
(
os_mes§ge_t
 *
s
, **
de¡
) {

76 *
tmp
;

77 cÚ¡ *
s_v”siÚ
;

78 
¡©us_code
[5];

80 *
de¡
 = 
NULL
;

82 ià((
s
 =ğ
NULL
è|| (s->
»asÚ_ph¿£
 =ğNULLè|| (s->
¡©us_code
 < 100) || (sip->status_code > 699))

83  
OSIP_BADPARAMETER
;

85 ià(
s
->
s_v”siÚ
 =ğ
NULL
)

86 
s_v”siÚ
 = 
os_´ÙocŞ_v”siÚ
;

89 
s_v”siÚ
 = 
s
->sip_version;

91 
	`¥rštf
(
¡©us_code
, "%u", 
s
->status_code);

93 *
de¡
 = (*è
	`os_m®loc
(
	`¡¾’
(
s_v”siÚ
è+ 3 + sŒËn(
s
->
»asÚ_ph¿£
) + 4);

95 ià(*
de¡
 =ğ
NULL
)

96  
OSIP_NOMEM
;

98 
tmp
 = *
de¡
;

100 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
s_v”siÚ
);

101 *
tmp
 = ' ';

102 
tmp
++;

104 
tmp
 = 
	`os_¡º_­³nd
Ñmp, 
¡©us_code
, 3);

105 *
tmp
 = ' ';

106 
tmp
++;

107 
	`¡rıy
(
tmp
, 
s
->
»asÚ_ph¿£
);

109  
OSIP_SUCCESS
;

110 
	}
}

112 
	$__os_mes§ge_¡¬še_to_¡r
(
os_mes§ge_t
 *
s
, **
de¡
) {

113 ià(
s
->
s_m‘hod
 !ğ
NULL
)

114  
	`__os_mes§ge_¡¬še_to_¡¼eq
(
s
, 
de¡
);

116 ià(
s
->
¡©us_code
 != 0)

117  
	`__os_mes§ge_¡¬še_to_¡¼e¥
(
s
, 
de¡
);

119 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
TRACE_LEVEL1
, 
NULL
, "ERROR method has‚o value or status code is 0!\n"));

120  
OSIP_BADPARAMETER
;

121 
	}
}

123 *
	$os_mes§ge_g‘_»asÚ_ph¿£
(cÚ¡ 
os_mes§ge_t
 *
s
) {

124  
s
->
»asÚ_ph¿£
;

125 
	}
}

127 
	$os_mes§ge_g‘_¡©us_code
(cÚ¡ 
os_mes§ge_t
 *
s
) {

128  
s
->
¡©us_code
;

129 
	}
}

131 *
	$os_mes§ge_g‘_m‘hod
(cÚ¡ 
os_mes§ge_t
 *
s
) {

132  
s
->
s_m‘hod
;

133 
	}
}

135 *
	$os_mes§ge_g‘_v”siÚ
(cÚ¡ 
os_mes§ge_t
 *
s
) {

136  
s
->
s_v”siÚ
;

137 
	}
}

139 
os_uri_t
 *
	$os_mes§ge_g‘_uri
(cÚ¡ 
os_mes§ge_t
 *
s
) {

140  
s
->
»q_uri
;

141 
	}
}

143 
	$¡rÿt_sim¶e_h—d”
(**
_¡ršg
, 
size_t
 *
m®loc_size
, **
_mes§ge
, *
±r_h—d”
, *
h—d”_Çme
, size_ˆ
size_of_h—d”
, (*
xxx_to_¡r
)(*, **), **
Ãxt
) {

144 *
¡ršg
;

145 *
mes§ge
;

146 *
tmp
;

147 
i
;

149 
¡ršg
 = *
_¡ršg
;

150 
mes§ge
 = *
_mes§ge
;

152 ià(
±r_h—d”
 !ğ
NULL
) {

153 ià(*
m®loc_size
 < 
mes§ge
 - 
¡ršg
 + 100 + 
size_of_h—d”
) {

155 
size_t
 
size
 = 
mes§ge
 - 
¡ršg
;

157 *
m®loc_size
 = 
mes§ge
 - 
¡ršg
 + 
size_of_h—d”
 + 100;

158 
¡ršg
 = 
	`os_»®loc
(¡ršg, *
m®loc_size
);

160 ià(
¡ršg
 =ğ
NULL
) {

161 
	`os_ä“
(*
_¡ršg
);

162 *
_¡ršg
 = 
NULL
;

163 *
_mes§ge
 = 
NULL
;

164  
OSIP_NOMEM
;

167 *
_¡ršg
 = 
¡ršg
;

168 
mes§ge
 = 
¡ršg
 + 
size
;

171 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
h—d”_Çme
, 
size_of_h—d”
);

173 
i
 = 
	`xxx_to_¡r
(
±r_h—d”
, &
tmp
);

175 ià(
i
 != 0) {

176 *
_¡ršg
 = 
¡ršg
;

177 *
_mes§ge
 = 
mes§ge
;

178 *
Ãxt
 = 
NULL
;

179  
i
;

182 ià(*
m®loc_size
 < 
mes§ge
 - 
¡ršg
 + 
	`¡¾’
(
tmp
) + 100) {

183 
size_t
 
size
 = 
mes§ge
 - 
¡ršg
;

185 *
m®loc_size
 = 
mes§ge
 - 
¡ršg
 + 
	`¡¾’
(
tmp
) + 100;

186 
¡ršg
 = 
	`os_»®loc
(¡ršg, *
m®loc_size
);

188 ià(
¡ršg
 =ğ
NULL
) {

189 
	`os_ä“
(*
_¡ršg
);

190 *
_¡ršg
 = 
NULL
;

191 *
_mes§ge
 = 
NULL
;

192  
OSIP_NOMEM
;

195 *
_¡ršg
 = 
¡ršg
;

196 
mes§ge
 = 
¡ršg
 + 
size
;

199 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
tmp
);

200 
	`os_ä“
(
tmp
);

201 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

204 *
_¡ršg
 = 
¡ršg
;

205 *
_mes§ge
 = 
mes§ge
;

206 *
Ãxt
 = 
mes§ge
;

207  
OSIP_SUCCESS
;

208 
	}
}

210 
	$¡rÿt_h—d”s_Úe_³r_lše
(**
_¡ršg
, 
size_t
 *
m®loc_size
, **
_mes§ge
, 
os_li¡_t
 *
h—d”s
, *
h—d”
, size_ˆ
size_of_h—d”
, (*
xxx_to_¡r
)(*, **), **
Ãxt
) {

211 *
¡ršg
;

212 *
mes§ge
;

213 *
tmp
;

214 
i
;

215 
os_li¡_™”©Ü_t
 
™
;

216 *
–t
 = 
	`os_li¡_g‘_fœ¡
(
h—d”s
, &
™
);

218 
¡ršg
 = *
_¡ršg
;

219 
mes§ge
 = *
_mes§ge
;

221 
–t
 !ğ
OSIP_SUCCESS
) {

222 ià(*
m®loc_size
 < 
mes§ge
 - 
¡ršg
 + 100 + 
size_of_h—d”
)

226 
size_t
 
size
 = 
mes§ge
 - 
¡ršg
;

228 *
m®loc_size
 = 
mes§ge
 - 
¡ršg
 + 
size_of_h—d”
 + 100;

229 
¡ršg
 = 
	`os_»®loc
(¡ršg, *
m®loc_size
);

231 ià(
¡ršg
 =ğ
NULL
) {

232 
	`os_ä“
(*
_¡ršg
);

233 *
_¡ršg
 = 
NULL
;

234 *
_mes§ge
 = 
NULL
;

235  
OSIP_NOMEM
;

238 *
_¡ršg
 = 
¡ršg
;

239 
mes§ge
 = 
¡ršg
 + 
size
;

242 
	`os_¡ºıy
(
mes§ge
, 
h—d”
, 
size_of_h—d”
);

243 
i
 = 
	`xxx_to_¡r
(
–t
, &
tmp
);

245 ià(
i
 != 0) {

246 *
_¡ršg
 = 
¡ršg
;

247 *
_mes§ge
 = 
mes§ge
;

248 *
Ãxt
 = 
NULL
;

249  
i
;

252 
mes§ge
 = mes§g+ 
	`¡¾’
(message);

254 ià(*
m®loc_size
 < 
mes§ge
 - 
¡ršg
 + 
	`¡¾’
(
tmp
) + 100) {

255 
size_t
 
size
 = 
mes§ge
 - 
¡ršg
;

257 *
m®loc_size
 = 
mes§ge
 - 
¡ršg
 + 
	`¡¾’
(
tmp
) + 100;

258 
¡ršg
 = 
	`os_»®loc
(¡ršg, *
m®loc_size
);

260 ià(
¡ršg
 =ğ
NULL
) {

261 
	`os_ä“
(*
_¡ršg
);

262 *
_¡ršg
 = 
NULL
;

263 *
_mes§ge
 = 
NULL
;

264  
OSIP_NOMEM
;

267 *
_¡ršg
 = 
¡ršg
;

268 
mes§ge
 = 
¡ršg
 + 
size
;

271 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
tmp
);

272 
	`os_ä“
(
tmp
);

273 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

274 
–t
 = 
	`os_li¡_g‘_Ãxt
(&
™
);

277 *
_¡ršg
 = 
¡ršg
;

278 *
_mes§ge
 = 
mes§ge
;

279 *
Ãxt
 = 
mes§ge
;

280  
OSIP_SUCCESS
;

281 
	}
}

288 
	$os_mes§ge_g‘__´İ”ty
(cÚ¡ 
os_mes§ge_t
 *
s
) {

289 ià(
s
 =ğ
NULL
)

290  
OSIP_BADPARAMETER
;

292  
s
->
mes§ge_´İ”ty
;

293 
	}
}

295 
	$os_mes§ge_fÜû_upd©e
(
os_mes§ge_t
 *
s
) {

296 ià(
s
 =ğ
NULL
)

297  
OSIP_BADPARAMETER
;

299 
s
->
mes§ge_´İ”ty
 = 2;

300  
OSIP_SUCCESS
;

301 
	}
}

303 
	$_os_mes§ge_»®loc
(**
mes§ge
, **
de¡
, 
size_t
 
Ãeded
, size_ˆ*
m®loc_size
) {

304 
size_t
 
size
 = *
mes§ge
 - *
de¡
;

306 ià(*
m®loc_size
 < (
size_t
)(
size
 + 
Ãeded
 + 100)) {

307 *
m®loc_size
 = 
size
 + 
Ãeded
 + 100;

308 *
de¡
 = 
	`os_»®loc
(*de¡, *
m®loc_size
);

310 ià(*
de¡
 =ğ
NULL
)

311  
OSIP_NOMEM
;

313 *
mes§ge
 = *
de¡
 + 
size
;

316  
OSIP_SUCCESS
;

317 
	}
}

319 
	$_os_mes§ge_to_¡r
(
os_mes§ge_t
 *
s
, **
de¡
, 
size_t
 *
mes§ge_Ëngth
, 
säag
) {

320 
size_t
 
m®loc_size
;

321 
size_t
 
tÙ®_Ëngth
 = 0;

324 *
¡¬t_of_bod›s
;

325 *
cÚ‹Á_Ëngth_to_modify
 = 
NULL
;

327 *
mes§ge
;

328 *
Ãxt
;

329 *
tmp
;

330 
pos
;

331 
i
;

332 *
bound¬y
 = 
NULL
;

334 
m®loc_size
 = 
SIP_MESSAGE_MAX_LENGTH
;

336 *
de¡
 = 
NULL
;

338 ià(
s
 =ğ
NULL
)

339  
OSIP_BADPARAMETER
;

342 ià(1 =ğ
	`os_mes§ge_g‘__´İ”ty
(
s
)) {

344 *
de¡
 = 
	`os_m®loc
(
s
->
mes§ge_Ëngth
 + 1);

346 ià(*
de¡
 =ğ
NULL
)

347  
OSIP_NOMEM
;

349 
	`memıy
(*
de¡
, 
s
->
mes§ge
, s->
mes§ge_Ëngth
);

350 (*
de¡
)[
s
->
mes§ge_Ëngth
] = '\0';

352 ià(
mes§ge_Ëngth
 !ğ
NULL
)

353 *
mes§ge_Ëngth
 = 
s
->message_length;

355  
OSIP_SUCCESS
;

359 
	`os_ä“
(
s
->
mes§ge
);

360 
s
->
mes§ge
 = 
NULL
;

364 
mes§ge
 = (*è
	`os_m®loc
(
SIP_MESSAGE_MAX_LENGTH
);

366 ià(
mes§ge
 =ğ
NULL
)

367  
OSIP_NOMEM
;

369 *
de¡
 = 
mes§ge
;

372 
i
 = 
	`__os_mes§ge_¡¬še_to_¡r
(
s
, &
tmp
);

374 ià(
i
 != 0) {

375 ià(!
säag
) {

376 
	`os_ä“
(*
de¡
);

377 *
de¡
 = 
NULL
;

378  
i
;

384 
size_t
 
mes§ge_Ën
 = 
	`¡¾’
(
tmp
);

386 ià(
	`_os_mes§ge_»®loc
(&
mes§ge
, 
de¡
, 
mes§ge_Ën
 + 3, &
m®loc_size
) < 0) {

387 
	`os_ä“
(
tmp
);

388 *
de¡
 = 
NULL
;

389  
OSIP_NOMEM
;

392 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
tmp
);

393 
	`os_ä“
(
tmp
);

394 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

398 
	sto_¡r_bË
 {

399 
h—d”_Çme
[30];

400 
h—d”_Ëngth
;

401 
os_li¡_t
 *
h—d”_li¡
;

402 *
h—d”_d©a
;

403 (*
to_¡r
)(*, **);

405 #iâdeà
MINISIZE


406 
bË
[25] =

408 
bË
[16] =

410 {{"VŸ: ", 5, 
NULL
, NULL, ((*)(*, **)è& 
os_vŸ_to_¡r
},

411 {"RecÜd-Rou‹: ", 14, 
NULL
, NULL, ((*)(*, **)è& 
os_»cÜd_rou‹_to_¡r
},

412 {"Rou‹: ", 7, 
NULL
, NULL, ((*)(*, **)è& 
os_rou‹_to_¡r
},

413 {"From: ", 6, 
NULL
, NULL, ((*)(*, **)è& 
os_äom_to_¡r
},

414 {"To: ", 4, 
NULL
, NULL, ((*)(*, **)è& 
os_to_to_¡r
},

415 {"C®l-ID: ", 9, 
NULL
, NULL, ((*)(*, **)è& 
os_ÿÎ_id_to_¡r
},

416 {"CSeq: ", 6, 
NULL
, NULL, ((*)(*, **)è& 
os_c£q_to_¡r
},

417 {"CÚù: ", 9, 
NULL
, NULL, ((*)(*, **)è& 
os_cÚù_to_¡r
},

418 {"AuthÜiz©iÚ: ", 15, 
NULL
, NULL, ((*)(*, **)è& 
os_authÜiz©iÚ_to_¡r
},

419 {"WWW-Auth’tiÿ‹: ", 18, 
NULL
, NULL, ((*)(*, **)è& 
os_www_auth’tiÿ‹_to_¡r
},

420 {"Proxy-Auth’tiÿ‹: ", 20, 
NULL
, NULL, ((*)(*, **)è& 
os_www_auth’tiÿ‹_to_¡r
},

421 {"Proxy-AuthÜiz©iÚ: ", 21, 
NULL
, NULL, ((*)(*, **)è& 
os_authÜiz©iÚ_to_¡r
},

422 {"C®l-Info: ", 11, 
NULL
, NULL, ((*)(*, **)è& 
os_ÿÎ_šfo_to_¡r
},

423 {"CÚ‹Á-Ty³: ", 14, 
NULL
, NULL, ((*)(*, **)è& 
os_cÚ‹Á_ty³_to_¡r
},

424 {"Mime-V”siÚ: ", 14, 
NULL
, NULL, ((*)(*, **)è& 
os_cÚ‹Á_Ëngth_to_¡r
},

425 #iâdeà
MINISIZE


426 {"AÎow: ", 7, 
NULL
, NULL, ((*)(*, **)è& 
os_®low_to_¡r
},

427 {"CÚ‹Á-Encodšg: ", 18, 
NULL
, NULL, ((*)(*, **)è& 
os_cÚ‹Á_’codšg_to_¡r
},

428 {"AË¹-Info: ", 12, 
NULL
, NULL, ((*)(*, **)è& 
os_ÿÎ_šfo_to_¡r
},

429 {"E¼Ü-Info: ", 12, 
NULL
, NULL, ((*)(*, **)è& 
os_ÿÎ_šfo_to_¡r
},

430 {"Acû±: ", 8, 
NULL
, NULL, ((*)(*, **)è& 
os_acû±_to_¡r
},

431 {"Acû±-Encodšg: ", 17, 
NULL
, NULL, ((*)(*, **)è& 
os_acû±_’codšg_to_¡r
},

432 {"Acû±-Lªguage: ", 17, 
NULL
, NULL, ((*)(*, **)è& 
os_acû±_Ïnguage_to_¡r
},

433 {"Auth’tiÿtiÚ-Info: ", 21, 
NULL
, NULL, ((*)(*, **)è& 
os_auth’tiÿtiÚ_šfo_to_¡r
},

434 {"Proxy-Auth’tiÿtiÚ-Info: ", 27, 
NULL
, NULL, ((*)(*, **)è& 
os_auth’tiÿtiÚ_šfo_to_¡r
},

436 {{'\0'}, 0, 
NULL
, NULL, NULL}};

437 
bË
[0].
h—d”_li¡
 = &
s
->
vŸs
;

438 
bË
[1].
h—d”_li¡
 = &
s
->
»cÜd_rou‹s
;

439 
bË
[2].
h—d”_li¡
 = &
s
->
rou‹s
;

440 
bË
[3].
h—d”_d©a
 = 
s
->
äom
;

441 
bË
[4].
h—d”_d©a
 = 
s
->
to
;

442 
bË
[5].
h—d”_d©a
 = 
s
->
ÿÎ_id
;

443 
bË
[6].
h—d”_d©a
 = 
s
->
c£q
;

444 
bË
[7].
h—d”_li¡
 = &
s
->
cÚùs
;

445 
bË
[8].
h—d”_li¡
 = &
s
->
authÜiz©iÚs
;

446 
bË
[9].
h—d”_li¡
 = &
s
->
www_auth’tiÿ‹s
;

447 
bË
[10].
h—d”_li¡
 = &
s
->
´oxy_auth’tiÿ‹s
;

448 
bË
[11].
h—d”_li¡
 = &
s
->
´oxy_authÜiz©iÚs
;

449 
bË
[12].
h—d”_li¡
 = &
s
->
ÿÎ_šfos
;

450 
bË
[13].
h—d”_d©a
 = 
s
->
cÚ‹Á_ty³
;

451 
bË
[14].
h—d”_d©a
 = 
s
->
mime_v”siÚ
;

452 #iâdeà
MINISIZE


453 
bË
[15].
h—d”_li¡
 = &
s
->
®lows
;

454 
bË
[16].
h—d”_li¡
 = &
s
->
cÚ‹Á_’codšgs
;

455 
bË
[17].
h—d”_li¡
 = &
s
->
®”t_šfos
;

456 
bË
[18].
h—d”_li¡
 = &
s
->
”rÜ_šfos
;

457 
bË
[19].
h—d”_li¡
 = &
s
->
acû±s
;

458 
bË
[20].
h—d”_li¡
 = &
s
->
acû±_’codšgs
;

459 
bË
[21].
h—d”_li¡
 = &
s
->
acû±_Ïnguages
;

460 
bË
[22].
h—d”_li¡
 = &
s
->
auth’tiÿtiÚ_šfos
;

461 
bË
[23].
h—d”_li¡
 = &
s
->
´oxy_auth’tiÿtiÚ_šfos
;

464 
pos
 = 0;

466 
bË
[
pos
].
h—d”_Çme
[0] != '\0') {

467 ià(
bË
[13].
h—d”_li¡
 =ğ
NULL
)

468 
i
 = 
	`¡rÿt_sim¶e_h—d”
(
de¡
, &
m®loc_size
, &
mes§ge
, 
bË
[
pos
].
h—d”_d©a
,abË[pos].
h—d”_Çme
,abË[pos].
h—d”_Ëngth
, (((*)(*, **)èbË[pos].
to_¡r
), &
Ãxt
);

470 
i
 = 
	`¡rÿt_h—d”s_Úe_³r_lše
(
de¡
, &
m®loc_size
, &
mes§ge
, 
bË
[
pos
].
h—d”_li¡
,abË[pos].
h—d”_Çme
,abË[pos].
h—d”_Ëngth
, (((*)(*, **)èbË[pos].
to_¡r
), &
Ãxt
);

472 ià(
i
 != 0) {

473 
	`os_ä“
(*
de¡
);

474 *
de¡
 = 
NULL
;

475  
i
;

478 
mes§ge
 = 
Ãxt
;

480 
pos
++;

485 
os_li¡_™”©Ü_t
 
™
;

486 
os_h—d”_t
 *
h—d”
 = (os_h—d”_ˆ*è
	`os_li¡_g‘_fœ¡
(&
s
->
h—d”s
, &
™
);

488 
h—d”
 !ğ
OSIP_SUCCESS
) {

489 
size_t
 
h—d”_Ën
 = 0;

491 
i
 = 
	`os_h—d”_to_¡r
(
h—d”
, &
tmp
);

493 ià(
i
 != 0) {

494 
	`os_ä“
(*
de¡
);

495 *
de¡
 = 
NULL
;

496  
i
;

499 
h—d”_Ën
 = 
	`¡¾’
(
tmp
);

501 ià(
	`_os_mes§ge_»®loc
(&
mes§ge
, 
de¡
, 
h—d”_Ën
 + 3, &
m®loc_size
) < 0) {

502 
	`os_ä“
(
tmp
);

503 *
de¡
 = 
NULL
;

504  
OSIP_NOMEM
;

507 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
tmp
);

508 
	`os_ä“
(
tmp
);

509 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

511 
h—d”
 = (
os_h—d”_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

518 ià(
	`_os_mes§ge_»®loc
(&
mes§ge
, 
de¡
, 16, &
m®loc_size
) < 0)

519  
OSIP_NOMEM
;

521 ià(
säag
 && 
	`os_li¡_eŞ
(&
s
->
bod›s
, 0)) {

523 
	`os_¡ºıy
(
mes§ge
, 
OSIP_CRLF
, 2);

524 
mes§ge
 = message + 2;

527 
s
->
mes§ge_´İ”ty
 = 1;

528 
s
->
mes§ge
 = 
	`os_¡rdup
(*
de¡
);

529 
s
->
mes§ge_Ëngth
 = 
mes§ge
 - *
de¡
;

531 ià(
mes§ge_Ëngth
 !ğ
NULL
)

532 *
mes§ge_Ëngth
 = 
mes§ge
 - *
de¡
;

534  
OSIP_SUCCESS
;

537 
	`os_¡ºıy
(
mes§ge
, "Content-Length: ", 16);

538 
mes§ge
 = message + 16;

555 ià(
	`os_li¡_eŞ
(&
s
->
bod›s
, 0))

556 
mes§ge
 = 
	`os_¡º_­³nd
(message, "0", 1);

567 
cÚ‹Á_Ëngth_to_modify
 = 
mes§ge
;

568 
mes§ge
 = 
	`os_¡r_­³nd
(message, " ");

573 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

576 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

578 
¡¬t_of_bod›s
 = 
mes§ge
;

579 
tÙ®_Ëngth
 = 
¡¬t_of_bod›s
 - *
de¡
;

581 ià(
	`os_li¡_eŞ
(&
s
->
bod›s
, 0)) {

583 
s
->
mes§ge_´İ”ty
 = 1;

584 
s
->
mes§ge
 = 
	`os_¡rdup
(*
de¡
);

585 
s
->
mes§ge_Ëngth
 = 
tÙ®_Ëngth
;

587 ià(
mes§ge_Ëngth
 !ğ
NULL
)

588 *
mes§ge_Ëngth
 = 
tÙ®_Ëngth
;

590  
OSIP_SUCCESS
;

593 ià(
s
->
cÚ‹Á_ty³
 && s->cÚ‹Á_ty³->
ty³
 && !
	`os_¡rÿ£cmp
(sip->content_type->type, "multipart")) {

594 
os_g’”ic_·¿m_t
 *
ù_·¿m
 = 
NULL
;

597 
i
 = 
	`os_g’”ic_·¿m_g‘_byÇme
(&
s
->
cÚ‹Á_ty³
->
g’_·¿ms
, "bound¬y", &
ù_·¿m
);

599 ià((
i
 >ğ0è&& 
ù_·¿m
 && ct_·¿m->
gv®ue
) {

600 
size_t
 
Ën
 = 
	`¡¾’
(
ù_·¿m
->
gv®ue
);

602 ià(
Ën
 > 
MIME_MAX_BOUNDARY_LEN
) {

603 
	`os_ä“
(*
de¡
);

604 *
de¡
 = 
NULL
;

605  
OSIP_SYNTAXERROR
;

608 ià(
Ën
 =ğ1 && 
ù_·¿m
->
gv®ue
[0] == '"') {

609 
	`os_ä“
(*
de¡
);

610 *
de¡
 = 
NULL
;

611  
OSIP_SYNTAXERROR
;

614 ià(
Ën
 =ğ2 && 
ù_·¿m
->
gv®ue
[0] == '"' && ct_param->gvalue[1] == '"') {

615 
	`os_ä“
(*
de¡
);

616 *
de¡
 = 
NULL
;

617  
OSIP_SYNTAXERROR
;

620 
bound¬y
 = 
	`os_m®loc
(
Ën
 + 5);

622 ià(
bound¬y
 =ğ
NULL
) {

623 
	`os_ä“
(*
de¡
);

624 *
de¡
 = 
NULL
;

625  
OSIP_NOMEM
;

628 
	`os_¡ºıy
(
bound¬y
, 
OSIP_CRLF
, 2);

629 
	`os_¡ºıy
(
bound¬y
 + 2, "--", 2);

631 ià(
ù_·¿m
->
gv®ue
[0] =ğ'"' && ct_·¿m->gv®ue[
Ën
 - 1] == '"')

632 
	`os_¡ºıy
(
bound¬y
 + 4, 
ù_·¿m
->
gv®ue
 + 1, 
Ën
 - 2);

635 
	`os_¡ºıy
(
bound¬y
 + 4, 
ù_·¿m
->
gv®ue
, 
Ën
);

640 
os_li¡_™”©Ü_t
 
™
;

641 
os_body_t
 *
body
 = (os_body_ˆ*è
	`os_li¡_g‘_fœ¡
(&
s
->
bod›s
, &
™
);

643 
body
 !ğ
OSIP_SUCCESS
) {

644 
size_t
 
body_Ëngth
;

646 ià(
bound¬y
) {

649 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
bound¬y
);

650 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

653 
i
 = 
	`os_body_to_¡r
(
body
, &
tmp
, &
body_Ëngth
);

655 ià(
i
 != 0) {

656 
	`os_ä“
(*
de¡
);

657 *
de¡
 = 
NULL
;

659 ià(
bound¬y
)

660 
	`os_ä“
(
bound¬y
);

662  
i
;

665 ià(
m®loc_size
 < 
mes§ge
 - *
de¡
 + 100 + 
body_Ëngth
) {

666 
size_t
 
size
 = 
mes§ge
 - *
de¡
;

667 
off£t_of_body
;

668 
off£t_cÚ‹Á_Ëngth_to_modify
 = 0;

670 
off£t_of_body
 = (è(
¡¬t_of_bod›s
 - *
de¡
);

672 ià(
cÚ‹Á_Ëngth_to_modify
 !ğ
NULL
)

673 
off£t_cÚ‹Á_Ëngth_to_modify
 = (è(
cÚ‹Á_Ëngth_to_modify
 - *
de¡
);

675 
m®loc_size
 = 
mes§ge
 - *
de¡
 + 
body_Ëngth
 + 100;

676 *
de¡
 = 
	`os_»®loc
(*de¡, 
m®loc_size
);

678 ià(*
de¡
 =ğ
NULL
) {

679 
	`os_ä“
(
tmp
);

681 ià(
bound¬y
)

682 
	`os_ä“
(
bound¬y
);

684  
OSIP_NOMEM
;

687 
¡¬t_of_bod›s
 = *
de¡
 + 
off£t_of_body
;

689 ià(
cÚ‹Á_Ëngth_to_modify
 !ğ
NULL
)

690 
cÚ‹Á_Ëngth_to_modify
 = *
de¡
 + 
off£t_cÚ‹Á_Ëngth_to_modify
;

692 
mes§ge
 = *
de¡
 + 
size
;

695 
	`memıy
(
mes§ge
, 
tmp
, 
body_Ëngth
);

696 
mes§ge
[
body_Ëngth
] = '\0';

697 
	`os_ä“
(
tmp
);

698 
mes§ge
 = mes§g+ 
body_Ëngth
;

700 
body
 = (
os_body_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

704 ià(
bound¬y
) {

707 
mes§ge
 = 
	`os_¡r_­³nd
(mes§ge, 
bound¬y
);

708 
mes§ge
 = 
	`os_¡º_­³nd
(message, "--", 2);

709 
mes§ge
 = 
	`os_¡º_­³nd
(mes§ge, 
OSIP_CRLF
, 2);

711 
	`os_ä“
(
bound¬y
);

712 
bound¬y
 = 
NULL
;

715 ià(
cÚ‹Á_Ëngth_to_modify
 =ğ
NULL
) {

716 
	`os_ä“
(*
de¡
);

717 *
de¡
 = 
NULL
;

718  
OSIP_SYNTAXERROR
;

723 
size_t
 
size
 = 
mes§ge
 - 
¡¬t_of_bod›s
;

724 
tmp2
[15];

726 
tÙ®_Ëngth
 +ğ
size
;

727 
	`¢´štf
(
tmp2
, 15, "%i", (è
size
);

729 
	`memıy
(
cÚ‹Á_Ëngth_to_modify
 + 5 - 
	`¡¾’
(
tmp2
),mp2, strlen(tmp2));

733 
s
->
mes§ge_´İ”ty
 = 1;

734 
s
->
mes§ge
 = 
	`os_m®loc
(
tÙ®_Ëngth
 + 1);

736 ià(
s
->
mes§ge
 !ğ
NULL
) {

737 
	`memıy
(
s
->
mes§ge
, *
de¡
, 
tÙ®_Ëngth
);

738 
s
->
mes§ge
[
tÙ®_Ëngth
] = '\0';

739 
s
->
mes§ge_Ëngth
 = 
tÙ®_Ëngth
;

741 ià(
mes§ge_Ëngth
 !ğ
NULL
)

742 *
mes§ge_Ëngth
 = 
tÙ®_Ëngth
;

745  
OSIP_SUCCESS
;

746 
	}
}

748 
	$os_mes§ge_to_¡r
(
os_mes§ge_t
 *
s
, **
de¡
, 
size_t
 *
mes§ge_Ëngth
) {

749  
	`_os_mes§ge_to_¡r
(
s
, 
de¡
, 
mes§ge_Ëngth
, 0);

750 
	}
}

752 
	$os_mes§ge_to_¡r_säag
(
os_mes§ge_t
 *
s
, **
de¡
, 
size_t
 *
mes§ge_Ëngth
) {

753  
	`_os_mes§ge_to_¡r
(
s
, 
de¡
, 
mes§ge_Ëngth
, 1);

754 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_mime_version.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

30 
	$os_mes§ge_£t_mime_v”siÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

31 
i
;

33 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

34  
OSIP_SUCCESS
;

36 ià(
s
->
mime_v”siÚ
 !ğ
NULL
)

37  
OSIP_SYNTAXERROR
;

39 
i
 = 
	`os_mime_v”siÚ_š™
(&(
s
->
mime_v”siÚ
));

41 ià(
i
 != 0)

42  
i
;

44 
s
->
mes§ge_´İ”ty
 = 2;

45 
i
 = 
	`os_mime_v”siÚ_·r£
(
s
->
mime_v”siÚ
, 
hv®ue
);

47 ià(
i
 != 0) {

48 
	`os_mime_v”siÚ_ä“
(
s
->
mime_v”siÚ
);

49 
s
->
mime_v”siÚ
 = 
NULL
;

50  
i
;

53  
OSIP_SUCCESS
;

54 
	}
}

56 #iâdeà
MINISIZE


60 
os_mime_v”siÚ_t
 *
	$os_mes§ge_g‘_mime_v”siÚ
(cÚ¡ 
os_mes§ge_t
 *
s
) {

61  
s
->
mime_v”siÚ
;

62 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_parser_cfg.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_·r£r.h
>

24 
	~"·r£r.h
"

26 
__os_mes§ge_cÚfig_t
 
	gpcÚfig
[
NUMBER_OF_HEADERS
];

27 
__os_mes§ge_cÚfig_comma£·¿‹d_t
 
	gpcÚfig_comma£p
[
NUMBER_OF_HEADERS_COMMASEPARATED
];

35 #iâdeà
HASH_TABLE_SIZE


36 #ifdeà
__amd64__


37 
	#HASH_TABLE_SIZE
 150

	)

39 
	#HASH_TABLE_SIZE
 \

40 150

	)

44 
	ghdr_»f_bË
[
HASH_TABLE_SIZE
];

60 
	$·r£r_š™
() {

61 
i
 = 0;

62 
hÇme_Ëngth
 = (
pcÚfig_comma£p
[0].
hÇme
);

64 
	`mem£t
(
pcÚfig_comma£p
, 0, (pconfig_commasep));

66 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept");

67 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "a");

68 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept-Encoding");

69 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept-Language");

70 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Alert-Info");

71 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Allow");

72 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Authentication-Info");

73 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Call-Info");

74 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Contact");

75 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "m");

76 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Content-Encoding");

77 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "e");

78 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Content-Language");

79 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Error-Info");

80 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "In-Reply-To");

81 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Proxy-Require");

82 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Record-Route");

83 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Require");

84 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Route");

85 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Supported");

86 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "k");

87 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Unsupported");

88 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Via");

89 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "v");

90 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Warning");

93 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Media-Authorization");

96 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Asserted-Identity");

97 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Preferred-Identity");

100 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Reason");

103 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Path");

106 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Security-Client");

107 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Security-Server");

108 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Security-Verify");

111 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Service-Route");

114 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Request-Disposition");

115 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "d");

116 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept-Contact");

117 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "a");

118 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Reject-Contact");

119 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "j");

122 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Resource-Priority");

123 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept-Resource-Priority");

126 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Early-Media");

129 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Refused-URI-List");

132 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Permission-Missing");

133 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Trigger-Consent");

136 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Asserted-Service");

137 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Preferred-Service");

140 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Recv-Info");

143 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Allow-Events");

144 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "u");

147 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Policy-ID");

148 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Policy-Contact");

151 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Feature-Caps");

154 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "History-Info");

155 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "Accept");

158 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Associated-URI");

159 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Visited-Network-ID");

160 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Access-Network-Info");

161 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "P-Charging-Function-Addresses");

164 
	`¢´štf
(
pcÚfig_comma£p
[
i
++].
hÇme
, 
hÇme_Ëngth
, "%s", "User-to-User");

166 
i
 = 0;

167 #iâdeà
MINISIZE


168 
pcÚfig
[
i
].
hÇme
 = 
ACCEPT
;

169 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

170 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_acû±
);

171 
pcÚfig
[
i
].
hÇme
 = 
ACCEPT_ENCODING
;

172 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

173 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_acû±_’codšg
);

174 
pcÚfig
[
i
].
hÇme
 = 
ACCEPT_LANGUAGE
;

175 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

176 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_acû±_Ïnguage
);

177 
pcÚfig
[
i
].
hÇme
 = 
ALERT_INFO
;

178 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

179 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_®”t_šfo
);

180 
pcÚfig
[
i
].
hÇme
 = 
ALLOW
;

181 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

182 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_®low
);

183 
pcÚfig
[
i
].
hÇme
 = 
AUTHENTICATION_INFO
;

184 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

185 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_auth’tiÿtiÚ_šfo
);

187 
pcÚfig
[
i
].
hÇme
 = 
AUTHORIZATION
;

188 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

189 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_authÜiz©iÚ
);

190 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_TYPE_SHORT
;

191 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

192 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_ty³
);

193 
pcÚfig
[
i
].
hÇme
 = 
CALL_ID
;

194 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

195 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_ÿÎ_id
);

196 #iâdeà
MINISIZE


197 
pcÚfig
[
i
].
hÇme
 = 
CALL_INFO
;

198 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

199 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_ÿÎ_šfo
);

201 
pcÚfig
[
i
].
hÇme
 = 
CONTACT
;

202 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

203 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚù
);

204 #iâdeà
MINISIZE


205 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_ENCODING
;

206 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

207 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_’codšg
);

209 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_LENGTH
;

210 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

211 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_Ëngth
);

212 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_TYPE
;

213 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

214 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_ty³
);

215 
pcÚfig
[
i
].
hÇme
 = 
CSEQ
;

216 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

217 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_c£q
);

218 #iâdeà
MINISIZE


219 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_ENCODING_SHORT
;

220 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

221 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_’codšg
);

222 
pcÚfig
[
i
].
hÇme
 = 
ERROR_INFO
;

223 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

224 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_”rÜ_šfo
);

226 
pcÚfig
[
i
].
hÇme
 = 
FROM_SHORT
;

227 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

228 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_äom
);

229 
pcÚfig
[
i
].
hÇme
 = 
FROM
;

230 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

231 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_äom
);

232 
pcÚfig
[
i
].
hÇme
 = 
CALL_ID_SHORT
;

233 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

234 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_ÿÎ_id
);

235 
pcÚfig
[
i
].
hÇme
 = 
CONTENT_LENGTH_SHORT
;

236 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

237 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚ‹Á_Ëngth
);

238 
pcÚfig
[
i
].
hÇme
 = 
CONTACT_SHORT
;

239 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

240 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_cÚù
);

241 
pcÚfig
[
i
].
hÇme
 = 
MIME_VERSION
;

242 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

243 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_mime_v”siÚ
);

244 
pcÚfig
[
i
].
hÇme
 = 
PROXY_AUTHENTICATE
;

245 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

246 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_´oxy_auth’tiÿ‹
);

247 #iâdeà
MINISIZE


248 
pcÚfig
[
i
].
hÇme
 = 
PROXY_AUTHENTICATION_INFO
;

249 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

250 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_´oxy_auth’tiÿtiÚ_šfo
);

252 
pcÚfig
[
i
].
hÇme
 = 
PROXY_AUTHORIZATION
;

253 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

254 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_´oxy_authÜiz©iÚ
);

255 
pcÚfig
[
i
].
hÇme
 = 
RECORD_ROUTE
;

256 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

257 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_»cÜd_rou‹
);

258 
pcÚfig
[
i
].
hÇme
 = 
ROUTE
;

259 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

260 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_rou‹
);

261 
pcÚfig
[
i
].
hÇme
 = 
TO_SHORT
;

262 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

263 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_to
);

264 
pcÚfig
[
i
].
hÇme
 = 
TO
;

265 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

266 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_to
);

267 
pcÚfig
[
i
].
hÇme
 = 
VIA_SHORT
;

268 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

269 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_vŸ
);

270 
pcÚfig
[
i
].
hÇme
 = 
VIA
;

271 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 0;

272 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_vŸ
);

273 
pcÚfig
[
i
].
hÇme
 = 
WWW_AUTHENTICATE
;

274 
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 = 1;

275 
pcÚfig
[
i
++].
£th—d”
 = (&
os_mes§ge_£t_www_auth’tiÿ‹
);

280 
i
 = 0; i < 
HASH_TABLE_SIZE
; i++) {

281 
hdr_»f_bË
[
i
] = -1;

284 
i
 = 0; i < 
NUMBER_OF_HEADERS
; i++) {

285 
hash
;

289 
hash
 = 
	`os_hash
(
pcÚfig
[
i
].
hÇme
);

290 
hash
 = hash % 
HASH_TABLE_SIZE
;

292 ià(
hdr_»f_bË
[
hash
] == -1) {

294 
hdr_»f_bË
[
hash
] = 
i
;

299 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_ERROR
, 
NULL
, "conflict with current hashtable size\n"));

300  
OSIP_UNDEFINED_ERROR
;

304  
OSIP_SUCCESS
;

305 
	}
}

307 
	$·r£r_add_comma_£·¿‹d_h—d”
(cÚ¡ *
hÇme
) {

308 
i
;

310 
i
 = 0; i < 
NUMBER_OF_HEADERS_COMMASEPARATED
; i++) {

311 ià(
pcÚfig_comma£p
[
i
].
hÇme
[0] == '\0') {

312 
	`¢´štf
(
pcÚfig_comma£p
[
i
].
hÇme
, (pconfig_commasep[i].hname), "%s", hname);

313  
OSIP_SUCCESS
;

317  
OSIP_UNDEFINED_ERROR
;

318 
	}
}

320 
	$__os_mes§ge_is_h—d”_comma_£·¿‹d
(cÚ¡ *
hÇme
) {

321 
i
;

323 
i
 = 0; i < 
NUMBER_OF_HEADERS_COMMASEPARATED
; i++) {

324 ià(
pcÚfig_comma£p
[
i
].
hÇme
[0] == '\0')

327 ià(
	`os_¡rÿ£cmp
(
pcÚfig_comma£p
[
i
].
hÇme
, hname) == 0)

328  
OSIP_SUCCESS
;

331  
OSIP_UNDEFINED_ERROR
;

332 
	}
}

336 
	$__os_mes§ge_is_known_h—d”
(cÚ¡ *
hÇme
) {

337 
hash
;

338 
»suÉ
 = -1;

340 
šdex
;

342 
hash
 = 
	`os_hash
(
hÇme
);

343 
hash
 = hash % 
HASH_TABLE_SIZE
;

344 
šdex
 = 
hdr_»f_bË
[
hash
];

346 ià((
šdex
 !ğ-1è&& (0 =ğ
	`¡rcmp
(
pcÚfig
[šdex].
hÇme
, hname))) {

347 
»suÉ
 = 
šdex
;

350  
»suÉ
;

351 
	}
}

356 
	$__os_mes§ge_ÿÎ_m‘hod
(
i
, 
os_mes§ge_t
 *
de¡
, cÚ¡ *
hv®ue
) {

357 
”r
;

359 
”r
 = 
pcÚfig
[
i
].
	`£th—d”
(
de¡
, 
hv®ue
);

361 ià(
”r
 < 0) {

362 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_WARNING
, 
NULL
, "Could‚Ù s‘ h—d”: %s: %s\n", 
pcÚfig
[
i
].
hÇme
, 
hv®ue
));

365 ià(
pcÚfig
[
i
].
ignÜed_wh’_šv®id
 == 1)

366  
OSIP_SUCCESS
;

368  
”r
;

369 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_port.c

20 #ifdeà
_WIN32_WCE


21 
	#_INC_TIME


	)

22 
	~<wšdows.h
>

25 
	~<os·r£r2/š‹º®.h
>

27 
	~<os·r£r2/os_pÜt.h
>

29 #ifdeà
HAVE_SYS_TYPES_H


30 
	~<sys/ty³s.h
>

32 #ifdeà
HAVE_SYS_STAT_H


33 
	~<sys/¡©.h
>

35 #ifdeà
HAVE_FCNTL_H


36 
	~<fú.h
>

39 #ifdeà
HAVE_CTYPE_H


40 
	~<ùy³.h
>

43 #ià
defšed
(
HAVE_STDARG_H
)

44 
	~<¡d¬g.h
>

45 
	#VA_START
(
a
, 
f
è
	`va_¡¬t
×, f)

	)

47 #ià
defšed
(
HAVE_VARARGS_H
)

48 
	~<v¬¬gs.h
>

49 
	#VA_START
(
a
, 
f
è
	`va_¡¬t
×)

	)

51 
	~<¡d¬g.h
>

52 
	#VA_START
(
a
, 
f
è
	`va_¡¬t
×, f)

	)

56 #ià
defšed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

57 
	~<TimeMgr.h
>

58 
	~<SysUts.h
>

59 
	~<Sy¡emMgr.h
>

60 
	~<SŒšgMgr.h
>

62 
	~<time.h
>

65 #ià
defšed
(
__VXWORKS_OS__
)

66 
	~<£ËùLib.h
>

69 
	~<vxWÜks.h
>

70 
	~<fioLib.h
>

71 
	~<¡ršg.h
>

73 #–ià
defšed
(
__PALMOS__
)

74 #ià
__PALMOS__
 >= 0x06000000

75 
	~<sys/time.h
>

76 
	~<SysTh»ad.h
>

78 #–ià(!
defšed
(
WIN32
è&& !defšed(
_WIN32_WCE
))

79 
	~<sys/time.h
>

80 #–ià
defšed
(
WIN32
)

81 
	~<wšdows.h
>

82 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

83 #ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

84 
	~<wšsock2.h
>

85 #–ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PC_APP
)

89 #ifdeà
WIN32_USE_CRYPTO


90 
	~<Wšüy±.h
>

94 #ià
defšed
(
__¹ems__
)

95 
	~<¹ems.h
>

98 #ià
defšed
(
HAVE_SYS_UNISTD_H
)

99 
	~<sys/uni¡d.h
>

102 #ià
defšed
(
HAVE_UNISTD_H
)

103 
	~<uni¡d.h
>

106 #ià
defšed
(
HAVE_SYSLOG_H
è&& !defšed(
__¬c__
)

107 
	~<sy¦og.h
>

110 #ià
defšed
(
HAVE_SYS_SELECT_H
)

111 
	~<sys/£Ëù.h
>

114 #ifdeà
HAVE_PTH_PTHREAD_H


115 
	~<±h»ad.h
>

118 #ià
defšed
(
__¬c__
)

119 
	#HAVE_LRAND48


	)

122 
FILE
 *
	glogfe
 = 
NULL
;

123 
	gŒacšg_bË
[
END_TRACE_LEVEL
];

124 
	gu£_sy¦og
 = 0;

125 
os_Œaû_func_t
 *
	gŒaû_func
 = 0;

127 
	g¿ndom_£ed_£t
 = 0;

129 #iâdeà
MINISIZE


130 #ià!
defšed
(
WIN32
è&& !defšed(
_WIN32_WCE
)

131 
os_m®loc_func_t
 *
	gos_m®loc_func
 = 0;

132 
os_»®loc_func_t
 *
	gos_»®loc_func
 = 0;

133 
os_ä“_func_t
 *
	gos_ä“_func
 = 0;

137 cÚ¡ *
	gos_”rÜ_bË
[] = {

146 cÚ¡ *
	$os_¡»¼Ü
(
”r
) {

147 ià(
”r
 > 0)

148  
os_”rÜ_bË
[0];

150 ià(
”r
 > -60)

151  
os_”rÜ_bË
[-
”r
];

153  
os_”rÜ_bË
[59];

154 
	}
}

156 #iâdeà
WIN32_USE_CRYPTO


157 
	$os_bud_¿ndom_numb”
()

159 
	$os_çÎback_¿ndom_numb”
()

162 ià(!
¿ndom_£ed_£t
) {

163 
ticks
;

165 #ifdeà
__PALMOS__


166 #ià
__PALMOS__
 < 0x06000000

167 
	`SysRªdom
((
IÁ32
è
	`TimG‘Ticks
());

169 
timev®
 
tv
;

171 
	`g‘timeofday
(&
tv
, 
NULL
);

172 
	`¤ªd
(
tv
.
tv_u£c
);

173 
ticks
 = 
tv
.
tv_£c
 +v.
tv_u£c
;

175 #–ià
	`defšed
(
WIN32
)

176 
LARGE_INTEGER
 
lCouÁ
;

178 
	`Qu”yP”fÜmªûCouÁ”
(&
lCouÁ
);

179 
ticks
 = 
lCouÁ
.
LowP¬t
 +†CouÁ.
HighP¬t
;

180 #–ià
	`defšed
(
_WIN32_WCE
)

181 
ticks
 = 
	`G‘TickCouÁ
();

182 #–ià
	`defšed
(
__PSOS__
)

183 #–ià
	`defšed
(
__¹ems__
)

184 
	`¹ems_şock_g‘
(
RTEMS_CLOCK_GET_TICKS_SINCE_BOOT
, &
ticks
);

185 #–ià
	`defšed
(
__VXWORKS_OS__
)

186 
time¥ec
 

;

188 
	`şock_g‘time
(
CLOCK_REALTIME
, &

);

189 
ticks
 = 

.
tv_£c
 +p.
tv_n£c
;

191 
timev®
 
tv
;

192 
fd
;

194 
	`g‘timeofday
(&
tv
, 
NULL
);

195 
ticks
 = (è(
tv
.
tv_£c
 +v.
tv_u£c
);

196 
fd
 = 
	`İ’
("/dev/u¿ndom", 
O_RDONLY
);

198 ià(
fd
 > 0) {

199 
r
;

200 
i
;

202 
i
 = 0; i < 512; i++) {

203 
	`»ad
(
fd
, &
r
, (r));

204 
ticks
 +ğ
r
;

207 
	`şo£
(
fd
);

212 #ifdeà
HAVE_LRAND48


213 
	`¤ªd48
(
ticks
);

215 
	`¤ªd
(
ticks
);

217 
¿ndom_£ed_£t
 = 1;

220 #ifdeà
HAVE_LRAND48


222 
v®
 = (è
	`Ìªd48
();

224 ià(
v®
 == 0) {

225 
ticks
;

226 
timev®
 
tv
;

228 
	`g‘timeofday
(&
tv
, 
NULL
);

229 
ticks
 = (è(
tv
.
tv_£c
 +v.
tv_u£c
);

230 
	`¤ªd48
(
ticks
);

231  (è
	`Ìªd48
();

234  
v®
;

237  
	`¿nd
();

239 
	}
}

241 #ifdeà
WIN32_USE_CRYPTO


243 
	$os_bud_¿ndom_numb”
() {

244 
HCRYPTPROV
 
üy±o
;

245 
BOOL
 
”r
;

246 
num
;

248 ià(!
¿ndom_£ed_£t
) {

249 
ticks
;

250 
LARGE_INTEGER
 
lCouÁ
;

252 
	`Qu”yP”fÜmªûCouÁ”
(&
lCouÁ
);

253 
ticks
 = 
lCouÁ
.
LowP¬t
 +†CouÁ.
HighP¬t
;

254 
	`¤ªd
(
ticks
);

255 
¿ndom_£ed_£t
 = 1;

258 
”r
 = 
	`Cry±AcquœeCÚ‹xt
(&
üy±o
, 
NULL
, NULL, 
PROV_RSA_FULL
, 
CRYPT_VERIFYCONTEXT
);

260 ià(
”r
) {

261 
”r
 = 
	`Cry±G’Rªdom
(
üy±o
, (
num
), (
BYTE
 *) &num);

262 
	`Cry±R–—£CÚ‹xt
(
üy±o
, 0);

265 ià(!
”r
) {

266 
num
 = 
	`os_çÎback_¿ndom_numb”
();

269  
num
;

270 
	}
}

274 #ià
defšed
(
__lšux
)

275 
	~<lim™s.h
>

278 *
	$os_¡ºıy
(*
de¡
, cÚ¡ *
¤c
, 
size_t
 
Ëngth
) {

279 
	`¡ºıy
(
de¡
, 
¤c
, 
Ëngth
);

280 
de¡
[
Ëngth
] = '\0';

281  
de¡
;

282 
	}
}

284 #undeà
os_¡rdup


286 *
	$os_¡rdup
(cÚ¡ *
ch
) {

287 *
cİy
;

288 
size_t
 
Ëngth
;

290 ià(
ch
 =ğ
NULL
)

291  
NULL
;

293 
Ëngth
 = 
	`¡¾’
(
ch
);

294 
cİy
 = (*è
	`os_m®loc
(
Ëngth
 + 1);

296 ià(
cİy
 =ğ
NULL
)

297  
NULL
;

299 
	`os_¡ºıy
(
cİy
, 
ch
, 
Ëngth
);

300  
cİy
;

301 
	}
}

303 #iâdeà
MINISIZE


304 
	$os_©oi
(cÚ¡ *
numb”
) {

305 #ià
	`defšed
(
__lšux
è|| defšed(
HAVE_STRTOL
)

306 
i
;

308 ià(
numb”
 =ğ
NULL
)

309  
OSIP_UNDEFINED_ERROR
;

311 
i
 = 
	`¡¹Ş
(
numb”
, (**è
NULL
, 10);

313 ià(
i
 =ğ
LONG_MIN
 || i =ğ
LONG_MAX
)

314  
OSIP_UNDEFINED_ERROR
;

316  
i
;

319  
	`©oi
(
numb”
);

320 
	}
}

324 #ià(
_MSC_VER
 >ğ1700è&& !
defšed
(
_USING_V110_SDK71_
)

325 #ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PHONE_APP
)

326 
	#HAVE_WINDOWSPHONE_API


	)

327 #–ià
defšed
(
WINAPI_FAMILY
è&& (WINAPI_FAMILY =ğ
WINAPI_FAMILY_PC_APP
)

328 
	#HAVE_WINAPPSTORE_API


	)

332 
	$os_u¦“p
(
u£cÚds
) {

333 #ià
	`defšed
(
__PALMOS__
) && (__PALMOS__ >= 0x06000000)

335 
n£cs_t
 
Çno£cÚds
 = 
u£cÚds
 * 1000;

337 
	`SysTh»adD–ay
(
Çno£cÚds
, 
P_ABSOLUTE_TIMEOUT
);

338 #–ià
	`defšed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

339 
UIÁ32
 
¡İtime
 = 
	`TimG‘Ticks
(è+ (
u£cÚds
 / 1000000è* 
	`SysTicksP”SecÚd
();

341 
¡İtime
 > 
	`TimG‘Ticks
())

345 #–ià
	`defšed
(
HAVE_WINDOWSPHONE_API
)

346 
timev®
 
d–ay
;

347 
£c
;

349 
£c
 = (è
u£cÚds
 / 1000000;

351 ià(
£c
 > 0) {

352 
d–ay
.
tv_£c
 = 
£c
;

353 
d–ay
.
tv_u£c
 = 0;

356 
d–ay
.
tv_£c
 = 0;

357 
d–ay
.
tv_u£c
 = 
u£cÚds
;

360 
	`£Ëù
(0, 0, 0, 0, &
d–ay
);

361 #–ià
	`defšed
(
HAVE_WINAPPSTORE_API
)

362 
TODO


363 #–ià
	`defšed
(
WIN32
)

364 
	`SË•
(
u£cÚds
 / 1000);

365 #–ià
	`defšed
(
__¹ems__
)

366 
	`¹ems_sk_wake_aá”
(
	`RTEMS_MICROSECONDS_TO_TICKS
(
u£cÚds
));

367 #–ià
	`defšed
(
__¬c__
)

368 
time¥ec
 
»q
;

369 
time¥ec
 
»m
;

371 
»q
.
tv_£c
 = (è
u£cÚds
 / 1000000;

372 
»q
.
tv_n£c
 = (è(
u£cÚds
 % 1000000) * 1000;

373 
	`Çno¦“p
(&
»q
, &
»m
);

375 
timev®
 
d–ay
;

376 
£c
;

378 
£c
 = (è
u£cÚds
 / 1000000;

380 ià(
£c
 > 0) {

381 
d–ay
.
tv_£c
 = 
£c
;

382 
d–ay
.
tv_u£c
 = 0;

385 
d–ay
.
tv_£c
 = 0;

386 
d–ay
.
tv_u£c
 = 
u£cÚds
;

389 
	`£Ëù
(0, 0, 0, 0, &
d–ay
);

391 
	}
}

393 *
	$os_¡rdup_w™hout_quÙe
(cÚ¡ *
ch
) {

394 *
cİy
 = (*è
	`os_m®loc
(
	`¡¾’
(
ch
) + 1);

396 ià(
cİy
 =ğ
NULL
)

397  
NULL
;

400 ià((*
ch
 == '\"')) {

401 
	`os_¡ºıy
(
cİy
, 
ch
 + 1, 
	`¡¾’
(ch + 1));

402 
	`os_¡ºıy
(
cİy
 + 
	`¡¾’
(copy) - 1, "\0", 1);

405 
	`os_¡ºıy
(
cİy
, 
ch
, 
	`¡¾’
(ch));

407  
cİy
;

408 
	}
}

410 
	$os_tŞow”
(*
wÜd
) {

411 #ià
	`defšed
(
HAVE_CTYPE_H
è&& !defšed(
_WIN32_WCE
)

413 ; *
wÜd
; word++)

414 *
wÜd
 = (è
	`tŞow”
(*word);

417 
size_t
 
i
;

418 
size_t
 
Ën
 = 
	`¡¾’
(
wÜd
);

420 
i
 = 0; i <ğ
Ën
 - 1; i++) {

421 ià('A' <ğ
wÜd
[
i
] && word[i] <= 'Z')

422 
wÜd
[
i
] = word[i] + 32;

426  
OSIP_SUCCESS
;

427 
	}
}

429 #iâdeà
MINISIZE


430 
	$os_¡rÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
) {

431 #ià
	`defšed
(
__VXWORKS_OS__
è|| defšed(
__PSOS__
)

433 (*
s1
 !ğ'\0'è&& (
	`tŞow”
(*s1è=ğtŞow”(*
s2
))) {

434 
s1
++;

435 
s2
++;

438  (
	`tŞow”
(*
s1
è-Şow”(*
s2
));

439 #–ià
	`defšed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

440  
	`SŒCa£ËssCom·»
(
s1
, 
s2
);

441 #–ià
	`defšed
(
__PALMOS__
è|| (!
defšed
 
WIN32
 && !defšed 
_WIN32_WCE
)

442  
	`¡rÿ£cmp
(
s1
, 
s2
);

444  
	`_¡ricmp
(
s1
, 
s2
);

446 
	}
}

448 
	$os_¡ºÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
, 
size_t
 
Ën
) {

449 #ià
	`defšed
(
__VXWORKS_OS__
è|| defšed(
__PSOS__
)

451 ià(
Ën
 == 0)

452  
OSIP_SUCCESS
;

454 (
Ën
 > 0è&& (
	`tŞow”
(*
s1
è=ğtŞow”(*
s2
))) {

455 
Ën
--;

457 ià((
Ën
 =ğ0è|| (*
s1
 =ğ'\0'è|| (*
s2
 == '\0'))

460 
s1
++;

461 
s2
++;

464  
	`tŞow”
(*
s1
è-Şow”(*
s2
);

465 #–ià
	`defšed
(
__PALMOS__
) && (__PALMOS__ < 0x06000000)

466  
	`SŒNCa£ËssCom·»
(
s1
, 
s2
, 
Ën
);

467 #–ià
	`defšed
(
__PALMOS__
è|| (!
defšed
 
WIN32
 && !defšed 
_WIN32_WCE
)

468  
	`¡ºÿ£cmp
(
s1
, 
s2
, 
Ën
);

470  
	`_¡ºicmp
(
s1
, 
s2
, 
Ën
);

472 
	}
}

476 *
	$os_¡rÿ£¡r
(cÚ¡ *
hay¡ack
, cÚ¡ *
ÃedË
) {

477 
c
, 
sc
;

478 
size_t
 
Ën
;

480 ià((
c
 = *
ÃedË
++) != 0) {

481 
c
 = 
	`tŞow”
(() c);

482 
Ën
 = 
	`¡¾’
(
ÃedË
);

486 ià((
sc
 = *
hay¡ack
++) == 0)

487  (
NULL
);

488 } (è
	`tŞow”
((è
sc
è!ğ
c
);

489 } 
	`os_¡ºÿ£cmp
(
hay¡ack
, 
ÃedË
, 
Ën
) != 0);

491 
hay¡ack
--;

494  (*è
hay¡ack
;

495 
	}
}

498 
	$os_şr¥aû
(*
wÜd
) {

499 *
pbeg
;

500 *
³nd
;

501 
size_t
 
Ën
;

503 ià(
wÜd
 =ğ
NULL
)

504  
OSIP_UNDEFINED_ERROR
;

506 ià(*
wÜd
 == '\0')

507  
OSIP_SUCCESS
;

509 
Ën
 = 
	`¡¾’
(
wÜd
);

511 
pbeg
 = 
wÜd
;

512 
pbeg
 +ğ
	`¡r¥n
(pbeg, " \r\n\t");

514 
³nd
 = 
wÜd
 + 
Ën
 - 1;

516 (' ' =ğ*
³nd
) || ('\r' == *pend) || ('\n' == *pend) || ('\t' == *pend)) {

517 
³nd
--;

519 ià(
³nd
 < 
pbeg
) {

520 *
wÜd
 = '\0';

521  
OSIP_SUCCESS
;

526 ià(
³nd
 + 1 <ğ
wÜd
 + (
Ën
 - 1))

527 
³nd
[1] = '\0';

529 ià(
pbeg
 !ğ
wÜd
)

530 
	`memmove
(
wÜd
, 
pbeg
, 
³nd
 -…beg + 2);

532  
OSIP_SUCCESS
;

533 
	}
}

547 
	$__os_£t_Ãxt_tok’
(**
de¡
, *
buf
, 
’d_£·¿tÜ
, **
Ãxt
) {

548 *
£p
;

550 *
Ãxt
 = 
NULL
;

552 
£p
 = 
buf
;

554 (*
£p
 !ğ
’d_£·¿tÜ
) && (*sep != '\0') && (*sep != '\r') && (*sep != '\n'))

555 
£p
++;

557 ià((*
£p
 == '\r') || (*sep == '\n')) {

558 ià(*
£p
 !ğ
’d_£·¿tÜ
)

559  
OSIP_UNDEFINED_ERROR
;

562 ià(*
£p
 == '\0')

563  
OSIP_UNDEFINED_ERROR
;

565 ià(
£p
 =ğ
buf
)

566  
OSIP_UNDEFINED_ERROR
;

568 *
de¡
 = 
	`os_m®loc
(
£p
 - (
buf
) + 1);

570 ià(*
de¡
 =ğ
NULL
)

571  
OSIP_NOMEM
;

573 
	`os_¡ºıy
(*
de¡
, 
buf
, 
£p
 - buf);

575 *
Ãxt
 = 
£p
 + 1;

576  
OSIP_SUCCESS
;

577 
	}
}

582 
	$__os_£t_Ãxt_tok’_b‘‹r
(**
de¡
, *
buf
, 
’d_£·¿tÜ
, *
fÜbidd’_b
[], 
size_b
, **
Ãxt
) {

583 *
£p
;

585 *
Ãxt
 = 
NULL
;

587 
£p
 = 
buf
;

589 (*
£p
 !ğ
’d_£·¿tÜ
) && (*sep != '\0') && (*sep != '\r')

590 && (*
£p
 != '\n'))

591 
£p
++;

593 ià((*
£p
 == '\r') && (*sep == '\n')) {

594 ià(*
£p
 !ğ
’d_£·¿tÜ
)

595  
OSIP_UNDEFINED_ERROR
;

598 ià(*
£p
 == '\0')

599  
OSIP_UNDEFINED_ERROR
;

601 ià(
£p
 =ğ
buf
)

602  
OSIP_UNDEFINED_ERROR
;

604 *
de¡
 = 
	`os_m®loc
(
£p
 - (
buf
) + 1);

606 ià(*
de¡
 =ğ
NULL
)

607  
OSIP_NOMEM
;

609 
	`os_¡ºıy
(*
de¡
, 
buf
, 
£p
 - buf);

611 *
Ãxt
 = 
£p
 + 1;

613 
	}
}

618 cÚ¡ *
	$__os_quÙe_fšd
(cÚ¡ *
q¡ršg
) {

619 cÚ¡ *
quÙe
;

621 
quÙe
 = 
	`¡rchr
(
q¡ršg
, '"');

623 ià(
quÙe
 =ğ
q¡ršg
)

624  
quÙe
;

626 ià(
quÙe
 =ğ
NULL
)

627  
NULL
;

638 
i
 = 1;

641 ià(0 =ğ
	`¡ºcmp
(
quÙe
 - 
i
, "\\", 1))

642 
i
++;

645 ià(
i
 % 2 == 1)

646  
quÙe
;

649 
quÙe
 = 
	`¡rchr
(quote + 1, '"');

651 ià(
quÙe
 =ğ
NULL
)

652  
NULL
;

654 
i
 = 1;

657 ià(
quÙe
 - 
i
 =ğ
q¡ršg
 - 1)

662 ià(*
q¡ršg
 == '\\')

663 
i
++;

665 ià(
i
 % 2 == 0)

666  
quÙe
;

669 
q¡ršg
 = 
quÙe
 + 1;

671 
quÙe
 = 
	`¡rchr
(quote + 1, '"');

673 ià(
quÙe
 =ğ
NULL
)

674  
NULL
;

676 
i
 = 1;

681  
NULL
;

683 
	}
}

685 *
	$os_’quÙe
(cÚ¡ *
s
) {

686 *
¹n
;

687 *
t
;

689 
t
 = 
¹n
 = 
	`os_m®loc
(
	`¡¾’
(
s
) * 2 + 3);

691 ià(
¹n
 =ğ
NULL
)

692  
NULL
;

694 *
t
++ = '"';

696 ; *
s
 != '\0'; s++) {

697 *
s
) {

701 *
t
++ = '\\';

702 *
t
++ = *
s
;

707 *
t
++ = ' ';

711 *
t
++ = *
s
;

716 *
t
++ = '"';

717 *
t
++ = '\0';

718  
¹n
;

719 
	}
}

721 
	$os_dequÙe
(*
s
) {

722 
size_t
 
Ën
;

724 ià(*
s
 == '\0')

727 ià(*
s
 != '"')

730 
Ën
 = 
	`¡¾’
(
s
);

731 
	`memmove
(
s
, s + 1, 
Ën
--);

733 ià(
Ën
 > 0 && 
s
[len - 1] == '"')

734 
s
[--
Ën
] = '\0';

736 ; *
s
 !ğ'\0'; s++, 
Ën
--) {

737 ià(*
s
 == '\\')

738 
	`memmove
(
s
, s + 1, 
Ën
--);

740 
	}
}

749 #iâdeà
ENABLE_TRACE


750 
	$os_Œaû_š™Ÿlize_func
(
os_Œaû_Ëv–_t
 
Ëv–
, 
os_Œaû_func_t
 *
func
) {

751 
	}
}

753 
	$os_Œaû_š™Ÿlize_sy¦og
(
os_Œaû_Ëv–_t
 
Ëv–
, *
id’t
) {

754 
	}
}

756 
	$os_Œaû_š™Ÿlize
(
os_Œaû_Ëv–_t
 
Ëv–
, 
FILE
 *
fe
) {

757  
OSIP_UNDEFINED_ERROR
;

758 
	}
}

760 
	$os_Œaû_’abË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
) {

761 
	}
}

763 
	$os_Œaû_di§bË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
) {

764 
	}
}

766 
	$os_is_Œaû_Ëv–_aùiv©e
(
os_Œaû_Ëv–_t
 
Ëv–
) {

767  
LOG_FALSE
;

768 
	}
}

774 
	$os_Œaû_š™Ÿlize
(
os_Œaû_Ëv–_t
 
Ëv–
, 
FILE
 *
fe
) {

775 
os_Œaû_Ëv–_t
 
i
 = 
TRACE_LEVEL0
;

778 
logfe
 = 
NULL
;

780 ià(
fe
 !ğ
NULL
)

781 
logfe
 = 
fe
;

784 
logfe
 = 
¡dout
;

787 
i
 < 
END_TRACE_LEVEL
) {

788 ià(
i
 < 
Ëv–
)

789 
Œacšg_bË
[
i
] = 
LOG_TRUE
;

792 
Œacšg_bË
[
i
] = 
LOG_FALSE
;

794 
i
++;

798 
	}
}

800 
	$os_Œaû_š™Ÿlize_sy¦og
(
os_Œaû_Ëv–_t
 
Ëv–
, *
id’t
) {

801 
os_Œaû_Ëv–_t
 
i
 = 
TRACE_LEVEL0
;

803 #ià
	`defšed
(
HAVE_SYSLOG_H
è&& !defšed(
__¬c__
)

804 
	`İ’log
(
id’t
, 
LOG_CONS
 | 
LOG_PID
, 
LOG_DAEMON
);

805 
u£_sy¦og
 = 1;

809 
i
 < 
END_TRACE_LEVEL
) {

810 ià(
i
 < 
Ëv–
)

811 
Œacšg_bË
[
i
] = 
LOG_TRUE
;

814 
Œacšg_bË
[
i
] = 
LOG_FALSE
;

816 
i
++;

818 
	}
}

820 
	$os_Œaû_’abË_uÁ_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
) {

821 
os_Œaû_Ëv–_t
 
i
 = 0;

823 
i
 < 
END_TRACE_LEVEL
) {

824 ià(
i
 < 
Ëv–
)

825 
Œacšg_bË
[
i
] = 
LOG_TRUE
;

828 
Œacšg_bË
[
i
] = 
LOG_FALSE
;

830 
i
++;

832 
	}
}

834 
	$os_Œaû_š™Ÿlize_func
(
os_Œaû_Ëv–_t
 
Ëv–
, 
os_Œaû_func_t
 *
func
) {

835 
os_Œaû_Ëv–_t
 
i
 = 0;

837 
Œaû_func
 = 
func
;

840 
i
 < 
END_TRACE_LEVEL
) {

841 ià(
i
 < 
Ëv–
)

842 
Œacšg_bË
[
i
] = 
LOG_TRUE
;

845 
Œacšg_bË
[
i
] = 
LOG_FALSE
;

847 
i
++;

849 
	}
}

852 
	$os_Œaû_’abË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
) {

853 
Œacšg_bË
[
Ëv–
] = 
LOG_TRUE
;

854 
	}
}

857 
	$os_Œaû_di§bË_Ëv–
(
os_Œaû_Ëv–_t
 
Ëv–
) {

858 
Œacšg_bË
[
Ëv–
] = 
LOG_FALSE
;

859 
	}
}

862 
	$os_is_Œaû_Ëv–_aùiv©e
(
os_Œaû_Ëv–_t
 
Ëv–
) {

863  
Œacšg_bË
[
Ëv–
];

864 
	}
}

867 #ià
defšed
(
WIN32
è&& !defšed(
_WIN32_WCE
)

869 
	~<time.h
>

870 
	~<sys/timeb.h
>

872 
	$__os_pÜt_g‘timeofday
(
timev®
 *

, *
tz
) {

873 
_timeb
 
timebufãr
;

875 
	`_áime
(&
timebufãr
);

876 

->
tv_£c
 = (è
timebufãr
.
time
;

877 

->
tv_u£c
 = 
timebufãr
.
ml™m
 * 1000;

878  
OSIP_SUCCESS
;

879 
	}
}

880 #–ià
defšed
(
__lšux
)

881 
	~<sys/time.h
>

882 
	#__os_pÜt_g‘timeofday
 
g‘timeofday


	)

883 #–ià
defšed
(
__APPLE__
)

884 
	~<sys/time.h
>

885 
	#__os_pÜt_g‘timeofday
 
g‘timeofday


	)

888 #ifdeà
ANDROID


889 
	~<ªdroid/log.h
>

892 #iâdeà
MAX_LENGTH_TR


893 
	#MAX_LENGTH_TR
 2024

	)

896 
	$os_Œaû
(cÚ¡ *
f’ame_lÚg
, 
li
, 
os_Œaû_Ëv–_t
 
Ëv–
, 
FILE
 *
f
, cÚ¡ *
chä
, ...) {

897 #ifdeà
ENABLE_TRACE


898 
va_li¡
 
­
;

899 
time_bufãr
[80] = {'\0'};

901 cÚ¡ *
fi
 = 
NULL
;

903 ià(
logfe
 =ğ
NULL
 && 
u£_sy¦og
 =ğ0 && 
Œaû_func
 =ğNULL && 
f
 == NULL) {

905 
	`os_Œaû_š™Ÿlize
(
OSIP_WARNING
, 
¡dout
);

908 ià(
Œacšg_bË
[
Ëv–
] =ğ
LOG_FALSE
)

909  
OSIP_SUCCESS
;

911 #ià
	`defšed
(
HAVE_LOCALTIME
)

913 
time_t
 
time¡amp
;

914 
timev®
 
now
;

915 
tm
 *
±m
;

916 #ifdeà
__USE_POSIX


917 
tm
 
loÿl_tm
;

919 
‹Áhs_ms
;

920 
	`__os_pÜt_g‘timeofday
(&
now
, 
NULL
);

922 
time¡amp
 = 
now
.
tv_£c
;

923 
‹Áhs_ms
 = 
now
.
tv_u£c
 / (100L);

924 #ifdeà
__USE_POSIX


925 
±m
 = 
	`loÿÉime_r
(&
time¡amp
, &
loÿl_tm
);

927 
±m
 = 
	`loÿÉime
(&
time¡amp
);

930 
	`¢´štf
(
time_bufãr
, 80, "%04d-%02d-%02d %02d:%02d:%02d.%04d", 1900 + 
±m
->
tm_y—r
,…tm->
tm_mÚ
 + 1,…tm->
tm_mday
,…tm->
tm_hour
,…tm->
tm_mš
,…tm->
tm_£c
, 
‹Áhs_ms
);

934 ià(
f’ame_lÚg
 !ğ
NULL
) {

935 
fi
 = 
	`¡¼chr
(
f’ame_lÚg
, '/');

937 ià(
fi
 =ğ
NULL
)

938 
fi
 = 
	`¡¼chr
(
f’ame_lÚg
, '\\');

940 ià(
fi
 !ğ
NULL
)

941 
fi
++;

943 ià(
fi
 =ğ
NULL
)

944 
fi
 = 
f’ame_lÚg
;

947 ià(
f
 =ğ
NULL
)

948 
f
 = 
logfe
;

950 #ià
	`defšed
(
__VXWORKS_OS__
è|| defšed(
__¹ems__
)

952 
f
 = 
¡dout
;

955 
	`VA_START
(
­
, 
chä
);

957 ià(
Œaû_func
) {

958 
	`Œaû_func
(
fi
, 
li
, 
Ëv–
, 
chä
, 
­
);

959 
	`va_’d
(
­
);

960  
OSIP_SUCCESS
;

963 #ifdeà
ANDROID


965 
Ëv
;

967 
Ëv–
) {

968 
OSIP_INFO3
:

969 
Ëv
 = 
ANDROID_LOG_DEBUG
;

972 
OSIP_INFO4
:

973 
Ëv
 = 
ANDROID_LOG_DEBUG
;

976 
OSIP_INFO2
:

977 
Ëv
 = 
ANDROID_LOG_INFO
;

980 
OSIP_INFO1
:

981 
Ëv
 = 
ANDROID_LOG_INFO
;

984 
OSIP_WARNING
:

985 
Ëv
 = 
ANDROID_LOG_WARN
;

988 
OSIP_ERROR
:

989 
Ëv
 = 
ANDROID_LOG_ERROR
;

992 
OSIP_BUG
:

993 
Ëv
 = 
ANDROID_LOG_FATAL
;

996 
OSIP_FATAL
:

997 
Ëv
 = 
ANDROID_LOG_FATAL
;

1001 
Ëv
 = 
ANDROID_LOG_DEFAULT
;

1005 
	`__ªdroid_log_v´št
(
Ëv
, "os2", 
chä
, 
­
);

1006 
	`va_’d
(
­
);

1007  
OSIP_SUCCESS
;

1012 
bufãr
[
MAX_LENGTH_TR
];

1013 
š
 = 0;

1015 
	`mem£t
(
bufãr
, 0, (buffer));

1017 ià(
Ëv–
 =ğ
OSIP_FATAL
)

1018 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| FATAL | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1020 ià(
Ëv–
 =ğ
OSIP_BUG
)

1021 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| BUG | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1023 ià(
Ëv–
 =ğ
OSIP_ERROR
)

1024 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| ERROR | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1026 ià(
Ëv–
 =ğ
OSIP_WARNING
)

1027 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "|WARNING| % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1029 ià(
Ëv–
 =ğ
OSIP_INFO1
)

1030 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| INFO1 | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1032 ià(
Ëv–
 =ğ
OSIP_INFO2
)

1033 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| INFO2 | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1035 ià(
Ëv–
 =ğ
OSIP_INFO3
)

1036 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| INFO3 | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1038 ià(
Ëv–
 =ğ
OSIP_INFO4
)

1039 
š
 = 
	`¢´štf
(
bufãr
, 
MAX_LENGTH_TR
 - 1, "| INFO4 | % <%10.10s:%5i> ", 
time_bufãr
, 
fi
, 
li
);

1041 
	`v¢´štf
(
bufãr
 + 
š
, 
MAX_LENGTH_TR
 - 1 - in, 
chä
, 
­
);

1043 #ià
	`defšed
(
HAVE_SYSLOG_H
è&& !defšed(
__¬c__
)

1045 ià(
u£_sy¦og
 == 1) {

1046 ià(
Ëv–
 =ğ
OSIP_FATAL
)

1047 
	`sy¦og
(
LOG_ERR
, "%s", 
bufãr
);

1049 ià(
Ëv–
 =ğ
OSIP_BUG
)

1050 
	`sy¦og
(
LOG_ERR
, "%s", 
bufãr
);

1052 ià(
Ëv–
 =ğ
OSIP_ERROR
)

1053 
	`sy¦og
(
LOG_ERR
, "%s", 
bufãr
);

1055 ià(
Ëv–
 =ğ
OSIP_WARNING
)

1056 
	`sy¦og
(
LOG_WARNING
, "%s", 
bufãr
);

1058 ià(
Ëv–
 =ğ
OSIP_INFO1
)

1059 
	`sy¦og
(
LOG_INFO
, "%s", 
bufãr
);

1061 ià(
Ëv–
 =ğ
OSIP_INFO2
)

1062 
	`sy¦og
(
LOG_INFO
, "%s", 
bufãr
);

1064 ià(
Ëv–
 =ğ
OSIP_INFO3
)

1065 
	`sy¦og
(
LOG_DEBUG
, "%s", 
bufãr
);

1067 ià(
Ëv–
 =ğ
OSIP_INFO4
)

1068 
	`sy¦og
(
LOG_DEBUG
, "%s", 
bufãr
);

1070 
	`va_’d
(
­
);

1071  
OSIP_SUCCESS
;

1076 #ià
	`defšed
(
WIN32
)

1078 ià(
f
 =ğ
¡dout
) {

1079 #ifdeà
UNICODE


1080 
WCHAR
 
wUnicode
[
MAX_LENGTH_TR
 * 2];

1081 
size
;

1083 
size
 = 
	`MuÉiBy‹ToWideCh¬
(
CP_UTF8
, 0, 
bufãr
, -1, 
wUnicode
, 
MAX_LENGTH_TR
 * 2);

1084 
wUnicode
[
size
 - 2] = '\n';

1085 
wUnicode
[
size
 - 1] = '\0';

1086 
	`OuutDebugSŒšg
(
wUnicode
);

1088 
	`OuutDebugSŒšg
(
bufãr
);

1090 
	`va_’d
(
­
);

1091  
OSIP_SUCCESS
;

1096 #ià
	`defšed
(
__APPLE__
è&& defšed(
__OBJC__
)

1098 ià(
f
 =ğ
¡dout
) {

1099 
	`NSLog
(@"%s", 
bufãr
);

1100 
	`va_’d
(
­
);

1101  
OSIP_SUCCESS
;

1106 ià(
f
) {

1107 
	`årštf
(
f
, "%s", 
bufãr
);

1108 
	`fæush
(
f
);

1109 
	`va_’d
(
­
);

1110  
OSIP_SUCCESS
;

1114 
	`va_’d
(
­
);

1116  
OSIP_SUCCESS
;

1117 
	}
}

1119 #ià
defšed
(
WIN32
è|| defšed(
_WIN32_WCE
)

1121 #undeà
os_m®loc


1122 *
	$os_m®loc
(
size_t
 
size
) {

1123 *
±r
 = 
	`m®loc
(
size
);

1125 ià(
±r
 !ğ
NULL
)

1126 
	`mem£t
(
±r
, 0, 
size
);

1128  
±r
;

1129 
	}
}

1131 #undeà
os_»®loc


1132 *
	$os_»®loc
(*
±r
, 
size_t
 
size
) {

1133  
	`»®loc
(
±r
, 
size
);

1134 
	}
}

1136 #undeà
os_ä“


1137 
	$os_ä“
(*
±r
) {

1138 ià(
±r
 =ğ
NULL
)

1141 
	`ä“
(
±r
);

1142 
	}
}

1146 #iâdeà
MINISIZE


1147 
	$os_£t_®loÿtÜs
(
os_m®loc_func_t
 *
m®loc_func
, 
os_»®loc_func_t
 *
»®loc_func
, 
os_ä“_func_t
 *
ä“_func
) {

1148 
os_m®loc_func
 = 
m®loc_func
;

1149 
os_»®loc_func
 = 
»®loc_func
;

1150 
os_ä“_func
 = 
ä“_func
;

1151 
	}
}

1156 #ià
defšed
(
__VXWORKS_OS__
)

1159 *
	m¡r
;

1160 
	mmax
;

1161 
	mËn
;

1162 } 
	t_cÚ‹xt
;

1164 
STATUS
 
_cb_¢´štf
(*
bufãr
, 
nc
, 
¬g
);

1166 
STATUS
 
	$_cb_¢´štf
(*
bufãr
, 
nc
, 
¬g
) {

1167 
_cÚ‹xt
 *
ùx
 = (_cÚ‹xˆ*è
¬g
;

1169 ià(
ùx
->
max
 - ctx->
Ën
 - 
nc
 < 1) {

1170 
nc
 = 
ùx
->
max
 - ctx->
Ën
 - 1;

1173 ià(
nc
 > 0) {

1174 
	`memıy
(
ùx
->
¡r
 + ctx->
Ën
, 
bufãr
, 
nc
);

1175 
ùx
->
Ën
 +ğ
nc
;

1178 
ùx
->
¡r
[ùx->
Ën
] = '\0';

1180  
OK
;

1181 
	}
}

1183 
	$os_v¢´štf
(*
buf
, 
max
, cÚ¡ *
fmt
, 
va_li¡
 
­
) {

1184 
_cÚ‹xt
 
ùx
;

1186 
ùx
.
¡r
 = 
buf
;

1187 
ùx
.
max
 = max;

1188 
ùx
.
Ën
 = 0;

1190 ià(
	`fioFÜm©V
(
fmt
, 
­
, 
_cb_¢´štf
, (è&
ùx
è!ğ
OK
) {

1191  
OSIP_UNDEFINED_ERROR
;

1194  
ùx
.
Ën
;

1195 
	}
}

1197 
	$os_¢´štf
(*
buf
, 
max
, cÚ¡ *
fmt
, ...) {

1198 
»tv®
;

1199 
va_li¡
 
­
;

1201 
	`va_¡¬t
(
­
, 
fmt
);

1202 
»tv®
 = 
	`os_v¢´štf
(
buf
, 
max
, 
fmt
, 
­
);

1203 
	`va_’d
(
­
);

1204  
»tv®
;

1205 
	}
}

1209 #ià
defšed
(
__PSOS__
)

1211 
	$os_¢´štf
(*
buf
, 
max
, cÚ¡ *
fmt
, ...) {

1212 
bufãr
[1024];

1213 
»tv®
;

1214 
va_li¡
 
­
;

1216 
bufãr
[0] = '\n';

1217 
	`va_¡¬t
(
­
, 
fmt
);

1218 
	`v¥rštf
(&(
bufãr
[
	`¡¾’
(bufãr)]), 
fmt
, 
­
);

1219 
	`va_’d
(
­
);

1220 
»tv®
 = 
	`¡¾’
(
bufãr
);

1221 
	`memmove
(
buf
, 
bufãr
, 
max
);

1223 ià(
»tv®
 > 
max
)

1224  
OSIP_UNDEFINED_ERROR
;

1226  
»tv®
;

1227 
	}
}

1231 #ifdeà
DEBUG_MEM


1240 *
	$_os_m®loc
(
size_t
 
size
, *
fe
, 
lše
) {

1241 *
mem
;

1243 
mem
 = 
	`os_m®loc_func
(
size
 + 20);

1245 ià(
mem
 !ğ
NULL
) {

1246 *
s
;

1248 
	`memıy
(
mem
, &
lše
, 2);

1250 
s
 = 
fe
 + 
	`¡¾’
(file); s != file; s--) {

1251 ià(*
s
 == '\\' || *s == '/') {

1252 
s
++;

1257 
	`¡ºıy
((*è
mem
 + 2, 
s
, 18);

1258  (*è((*è
mem
 + 20);

1261  
NULL
;

1262 
	}
}

1264 
	$_os_ä“
(*
±r
) {

1265 ià(
±r
 !ğ
NULL
) {

1266 
	`os_ä“_func
((*è
±r
 - 20);

1268 
	}
}

1270 *
	$_os_»®loc
(*
±r
, 
size_t
 
size
, *
fe
, 
lše
) {

1271 *
mem
;

1273 
mem
 = 
	`os_»®loc_func
((*è
±r
 - 20, 
size
 + 20);

1275 ià(
mem
 !ğ
NULL
) {

1276 *
s
;

1278 
	`memıy
(
mem
, &
lše
, 2);

1280 
s
 = 
fe
 + 
	`¡¾’
(file); s != file; s--) {

1281 ià(*
s
 == '\\' || *s == '/') {

1282 
s
++;

1287 
	`¡ºıy
((*è
mem
 + 2, 
s
, 18);

1288  (*è
mem
 + 20;

1291  
NULL
;

1292 
	}
}

1296 #ifdeà
OSIP_MEMORY_DEBUG


1298 
	#_CRTDBG_MAP_ALLOC


	)

1299 
	~<ütdbg.h
>

1307 *
	$_os_m®loc
(
size_t
 
size
, *
fe
, 
lše
) {

1308  
	`_m®loc_dbg
(
size
, 
_NORMAL_BLOCK
, 
fe
, 
lše
);

1309 
	}
}

1311 
	$_os_ä“
(*
±r
) {

1312 
	`_ä“_dbg
(
±r
, 
_NORMAL_BLOCK
);

1313 
	}
}

1315 *
	$_os_»®loc
(*
±r
, 
size_t
 
size
, *
fe
, 
lše
) {

1316  
	`_»®loc_dbg
(
±r
, 
size
, 
_NORMAL_BLOCK
, 
fe
, 
lše
);

1317 
	}
}

1322 
	$os_hash
(cÚ¡ *
¡r
) {

1323 
hash
 = 5381;

1324 
c
;

1326 (
c
 = *
¡r
++))

1327 
hash
 = ((hash << 5è+ hashè+ 
c
;

1329  
hash
 & 0xFFFFFFFFu;

1330 
	}
}

1345 *
	$os_¡r_­³nd
(*
d¡
, cÚ¡ *
¤c
) {

1346 *
¤c
 != '\0') {

1347 *
d¡
 = *
¤c
;

1348 
¤c
++;

1349 
d¡
++;

1352 *
d¡
 = '\0';

1353  
d¡
;

1354 
	}
}

1358 *
	$os_¡º_­³nd
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
) {

1359 
	`memmove
((*è
d¡
, (*è
¤c
, 
Ën
);

1360 
d¡
 +ğ
Ën
;

1361 *
d¡
 = '\0';

1362  
d¡
;

1363 
	}
}

1369 #iâdeà
MINISIZE


1370 *
	$os_şºıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
) {

1371 cÚ¡ *
pbeg
;

1372 cÚ¡ *
³nd
;

1373 *
p
;

1374 
size_t
 
¥aûËss_Ëngth
;

1376 ià(
¤c
 =ğ
NULL
 || 
Ën
 == 0) {

1377 *
d¡
 = '\0';

1378  
NULL
;

1382 
pbeg
 = 
¤c
;

1383 
pbeg
 +ğ
	`¡r¥n
(pbeg, " \r\n\t");

1386 
³nd
 = 
¤c
 + 
Ën
 - 1;

1388 (' ' =ğ*
³nd
) || ('\r' == *pend) || ('\n' == *pend) || ('\t' == *pend)) {

1389 
³nd
--;

1391 ià(
³nd
 < 
pbeg
) {

1392 *
d¡
 = '\0';

1393  
d¡
;

1398 
¥aûËss_Ëngth
 = 
³nd
 - 
pbeg
 + 1;

1399 
	`memmove
(
d¡
, 
pbeg
, 
¥aûËss_Ëngth
);

1400 
p
 = 
d¡
 + 
¥aûËss_Ëngth
;

1402 #ià
	`defšed
(
__GNUC__
)

1406 *
p
 = '\0';

1408 ià(
	`__butš_ex³ù
(++
¥aûËss_Ëngth
 < 
Ën
, 0)) {

1410 *++
p
 = '\0';

1412 ++
¥aûËss_Ëngth
 < 
Ën
);

1419 *
p
 = '\0';

1420 
p
++;

1421 
¥aûËss_Ëngth
++;

1422 } 
¥aûËss_Ëngth
 < 
Ën
);

1426  
d¡
;

1427 
	}
}

1431 *
	$os_şºıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
) {

1432 
	`os_¡ºıy
(
d¡
, 
¤c
, 
Ën
);

1433 
	`os_şr¥aû
(
d¡
);

1434  
d¡
;

1435 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authenticate.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

30 
	$os_mes§ge_£t_´oxy_auth’tiÿ‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

31 
os_´oxy_auth’tiÿ‹_t
 *
´oxy_auth’tiÿ‹
;

32 
i
;

34 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

35  
OSIP_SUCCESS
;

37 
i
 = 
	`os_´oxy_auth’tiÿ‹_š™
(&(
´oxy_auth’tiÿ‹
));

39 ià(
i
 != 0)

40  
i
;

42 
i
 = 
	`os_´oxy_auth’tiÿ‹_·r£
(
´oxy_auth’tiÿ‹
, 
hv®ue
);

44 ià(
i
 != 0) {

45 
	`os_´oxy_auth’tiÿ‹_ä“
(
´oxy_auth’tiÿ‹
);

46  
i
;

49 
s
->
mes§ge_´İ”ty
 = 2;

50 
	`os_li¡_add
(&
s
->
´oxy_auth’tiÿ‹s
, 
´oxy_auth’tiÿ‹
, -1);

51  
OSIP_SUCCESS
;

52 
	}
}

54 #iâdeà
MINISIZE


58 
	$os_mes§ge_g‘_´oxy_auth’tiÿ‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_auth’tiÿ‹_t
 **
de¡
) {

59 
os_´oxy_auth’tiÿ‹_t
 *
´oxy_auth’tiÿ‹
;

61 *
de¡
 = 
NULL
;

63 ià(
	`os_li¡_size
(&
s
->
´oxy_auth’tiÿ‹s
è<ğ
pos
)

64  
OSIP_UNDEFINED_ERROR
;

66 
´oxy_auth’tiÿ‹
 = (
os_´oxy_auth’tiÿ‹_t
 *è
	`os_li¡_g‘
(&
s
->
´oxy_auth’tiÿ‹s
, 
pos
);

68 *
de¡
 = 
´oxy_auth’tiÿ‹
;

69  
pos
;

70 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authentication_info.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 #iâdeà
MINISIZE


32 
	$os_mes§ge_£t_´oxy_auth’tiÿtiÚ_šfo
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

33 
os_´oxy_auth’tiÿtiÚ_šfo_t
 *
´oxy_auth’tiÿtiÚ_šfo
;

34 
i
;

36 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

37  
OSIP_SUCCESS
;

39 
i
 = 
	`os_´oxy_auth’tiÿtiÚ_šfo_š™
(&(
´oxy_auth’tiÿtiÚ_šfo
));

41 ià(
i
 != 0)

42  
i
;

44 
i
 = 
	`os_´oxy_auth’tiÿtiÚ_šfo_·r£
(
´oxy_auth’tiÿtiÚ_šfo
, 
hv®ue
);

46 ià(
i
 != 0) {

47 
	`os_´oxy_auth’tiÿtiÚ_šfo_ä“
(
´oxy_auth’tiÿtiÚ_šfo
);

48  
i
;

51 
s
->
mes§ge_´İ”ty
 = 2;

53 
	`os_li¡_add
(&
s
->
´oxy_auth’tiÿtiÚ_šfos
, 
´oxy_auth’tiÿtiÚ_šfo
, -1);

54  
OSIP_SUCCESS
;

55 
	}
}

60 
	$os_mes§ge_g‘_´oxy_auth’tiÿtiÚ_šfo
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_auth’tiÿtiÚ_šfo_t
 **
de¡
) {

61 
os_´oxy_auth’tiÿtiÚ_šfo_t
 *
´oxy_auth’tiÿtiÚ_šfo
;

63 *
de¡
 = 
NULL
;

65 ià(
	`os_li¡_size
(&
s
->
´oxy_auth’tiÿtiÚ_šfos
è<ğ
pos
)

66  
OSIP_UNDEFINED_ERROR
;

68 
´oxy_auth’tiÿtiÚ_šfo
 = (
os_´oxy_auth’tiÿtiÚ_šfo_t
 *è
	`os_li¡_g‘
(&
s
->
´oxy_auth’tiÿtiÚ_šfos
, 
pos
);

70 *
de¡
 = 
´oxy_auth’tiÿtiÚ_šfo
;

71  
pos
;

72 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authorization.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

31 
	$os_mes§ge_£t_´oxy_authÜiz©iÚ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

32 
os_´oxy_authÜiz©iÚ_t
 *
´oxy_authÜiz©iÚ
;

33 
i
;

35 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

36  
OSIP_SUCCESS
;

38 
i
 = 
	`os_´oxy_authÜiz©iÚ_š™
(&
´oxy_authÜiz©iÚ
);

40 ià(
i
 != 0)

41  
i
;

43 
i
 = 
	`os_´oxy_authÜiz©iÚ_·r£
(
´oxy_authÜiz©iÚ
, 
hv®ue
);

45 ià(
i
 != 0) {

46 
	`os_´oxy_authÜiz©iÚ_ä“
(
´oxy_authÜiz©iÚ
);

47  
i
;

50 
s
->
mes§ge_´İ”ty
 = 2;

51 
	`os_li¡_add
(&
s
->
´oxy_authÜiz©iÚs
, 
´oxy_authÜiz©iÚ
, -1);

52  
OSIP_SUCCESS
;

53 
	}
}

55 #iâdeà
MINISIZE


56 
	$os_mes§ge_g‘_´oxy_authÜiz©iÚ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_´oxy_authÜiz©iÚ_t
 **
de¡
) {

57 
os_´oxy_authÜiz©iÚ_t
 *
´oxy_authÜiz©iÚ
;

59 *
de¡
 = 
NULL
;

61 ià(
	`os_li¡_size
(&
s
->
´oxy_authÜiz©iÚs
è<ğ
pos
)

62  
OSIP_UNDEFINED_ERROR
;

64 
´oxy_authÜiz©iÚ
 = (
os_´oxy_authÜiz©iÚ_t
 *è
	`os_li¡_g‘
(&
s
->
´oxy_authÜiz©iÚs
, 
pos
);

65 *
de¡
 = 
´oxy_authÜiz©iÚ
;

66  
pos
;

67 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_record_route.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 #iâdeà
MINISIZE


27 
	$os_»cÜd_rou‹_š™
(
os_»cÜd_rou‹_t
 **
»cÜd_rou‹
) {

28  
	`os_äom_š™
((
os_äom_t
 **è
»cÜd_rou‹
);

29 
	}
}

36 
	$os_mes§ge_£t_»cÜd_rou‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

37 
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
;

38 
i
;

40 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

41  
OSIP_SUCCESS
;

43 
i
 = 
	`os_»cÜd_rou‹_š™
(&
»cÜd_rou‹
);

45 ià(
i
 != 0)

46  
i
;

48 
i
 = 
	`os_»cÜd_rou‹_·r£
(
»cÜd_rou‹
, 
hv®ue
);

50 ià(
i
 != 0) {

51 
	`os_»cÜd_rou‹_ä“
(
»cÜd_rou‹
);

52  
i
;

55 
s
->
mes§ge_´İ”ty
 = 2;

56 
	`os_li¡_add
(&
s
->
»cÜd_rou‹s
, 
»cÜd_rou‹
, -1);

57  
OSIP_SUCCESS
;

58 
	}
}

60 #iâdeà
MINISIZE


64 
	$os_mes§ge_g‘_»cÜd_rou‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_»cÜd_rou‹_t
 **
de¡
) {

65 
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
;

67 *
de¡
 = 
NULL
;

69 ià(
	`os_li¡_size
(&
s
->
»cÜd_rou‹s
è<ğ
pos
)

70  
OSIP_UNDEFINED_ERROR
;

72 
»cÜd_rou‹
 = (
os_»cÜd_rou‹_t
 *è
	`os_li¡_g‘
(&
s
->
»cÜd_rou‹s
, 
pos
);

73 *
de¡
 = 
»cÜd_rou‹
;

74  
pos
;

75 
	}
}

78 #iâdeà
MINISIZE


79 
	$os_»cÜd_rou‹_·r£
(
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
, cÚ¡ *
hv®ue
) {

80  
	`os_äom_·r£
((
os_äom_t
 *è
»cÜd_rou‹
, 
hv®ue
);

81 
	}
}

86 
	$os_»cÜd_rou‹_to_¡r
(cÚ¡ 
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
, **
de¡
) {

87 *
u¾
;

88 *
buf
;

89 
i
;

90 
size_t
 
Ën
;

92 *
de¡
 = 
NULL
;

94 ià((
»cÜd_rou‹
 =ğ
NULL
è|| (»cÜd_rou‹->
u¾
 == NULL))

95  
OSIP_BADPARAMETER
;

97 
i
 = 
	`os_uri_to_¡r
(
»cÜd_rou‹
->
u¾
, &url);

99 ià(
i
 != 0)

100  
i
;

102 ià(
»cÜd_rou‹
->
di¥ÏyÇme
 =ğ
NULL
)

103 
Ën
 = 
	`¡¾’
(
u¾
) + 5;

106 
Ën
 = 
	`¡¾’
(
u¾
è+ sŒËn(
»cÜd_rou‹
->
di¥ÏyÇme
) + 5;

108 
buf
 = (*è
	`os_m®loc
(
Ën
);

110 ià(
buf
 =ğ
NULL
) {

111 
	`os_ä“
(
u¾
);

112  
OSIP_NOMEM
;

116 ià(
»cÜd_rou‹
->
di¥ÏyÇme
 !ğ
NULL
)

117 
	`¥rštf
(
buf
, "% <%s>", 
»cÜd_rou‹
->
di¥ÏyÇme
, 
u¾
);

120 
	`¥rštf
(
buf
, "<%s>", 
u¾
);

122 
	`os_ä“
(
u¾
);

125 
size_t
 
¶’
;

126 *
tmp
;

127 
os_li¡_™”©Ü_t
 
™
;

128 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
»cÜd_rou‹
->
g’_·¿ms
, &
™
);

130 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

131 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

132 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
) + 2;

135 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 3;

137 
Ën
 =†’ + 
¶’
;

138 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

139 
tmp
 = 
buf
;

140 
tmp
 =m°+ 
	`¡¾’
(tmp);

142 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

143 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s", 
u_·¿m
->
gÇme
);

146 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), ";%s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

148 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

151 *
de¡
 = 
buf
;

152  
OSIP_SUCCESS
;

153 
	}
}

157 
	$os_»cÜd_rou‹_ä“
(
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
) {

158 
	`os_äom_ä“
((
os_äom_t
 *è
»cÜd_rou‹
);

159 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_route.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

26 #iâdeà
MINISIZE


27 
	$os_rou‹_š™
(
os_rou‹_t
 **
rou‹
) {

28  
	`os_äom_š™
((
os_äom_t
 **è
rou‹
);

29 
	}
}

36 
	$os_mes§ge_£t_rou‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

37 
os_rou‹_t
 *
rou‹
;

38 
i
;

40 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

41  
OSIP_SUCCESS
;

43 
i
 = 
	`os_rou‹_š™
(&
rou‹
);

45 ià(
i
 != 0)

46  
i
;

48 
i
 = 
	`os_rou‹_·r£
(
rou‹
, 
hv®ue
);

50 ià(
i
 != 0) {

51 
	`os_rou‹_ä“
(
rou‹
);

52  
i
;

55 
s
->
mes§ge_´İ”ty
 = 2;

56 
	`os_li¡_add
(&
s
->
rou‹s
, 
rou‹
, -1);

57  
OSIP_SUCCESS
;

58 
	}
}

60 #iâdeà
MINISIZE


64 
	$os_mes§ge_g‘_rou‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_rou‹_t
 **
de¡
) {

65 
os_rou‹_t
 *
rou‹
;

67 *
de¡
 = 
NULL
;

69 ià(
	`os_li¡_size
(&
s
->
rou‹s
è<ğ
pos
)

70  
OSIP_UNDEFINED_ERROR
;

72 
rou‹
 = (
os_rou‹_t
 *è
	`os_li¡_g‘
(&
s
->
rou‹s
, 
pos
);

73 *
de¡
 = 
rou‹
;

74  
pos
;

75 
	}
}

78 #iâdeà
MINISIZE


79 
	$os_rou‹_·r£
(
os_rou‹_t
 *
rou‹
, cÚ¡ *
hv®ue
) {

80  
	`os_äom_·r£
((
os_äom_t
 *è
rou‹
, 
hv®ue
);

81 
	}
}

86 
	$os_rou‹_to_¡r
(cÚ¡ 
os_rou‹_t
 *
rou‹
, **
de¡
) {

89  
	`os_»cÜd_rou‹_to_¡r
((
os_»cÜd_rou‹_t
 *è
rou‹
, 
de¡
);

90 
	}
}

94 
	$os_rou‹_ä“
(
os_rou‹_t
 *
rou‹
) {

95 
	`os_äom_ä“
((
os_äom_t
 *è
rou‹
);

96 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_to.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_mes§ge.h
>

23 
	~<os·r£r2/os_·r£r.h
>

25 #iâdeà
MINISIZE


26 
	$os_to_š™
(
os_to_t
 **
to
) {

27  
	`os_äom_š™
((
os_äom_t
 **è
to
);

28 
	}
}

35 
	$os_mes§ge_£t_to
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

36 
i
;

38 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

39  
OSIP_SUCCESS
;

41 ià(
s
->
to
 !ğ
NULL
)

42  
OSIP_SYNTAXERROR
;

44 
i
 = 
	`os_to_š™
(&(
s
->
to
));

46 ià(
i
 != 0)

47  
i
;

49 
s
->
mes§ge_´İ”ty
 = 2;

50 
i
 = 
	`os_to_·r£
(
s
->
to
, 
hv®ue
);

52 ià(
i
 != 0) {

53 
	`os_to_ä“
(
s
->
to
);

54 
s
->
to
 = 
NULL
;

55  
i
;

58  
OSIP_SUCCESS
;

59 
	}
}

61 #iâdeà
MINISIZE


65 
os_to_t
 *
	$os_mes§ge_g‘_to
(cÚ¡ 
os_mes§ge_t
 *
s
) {

66  
s
->
to
;

67 
	}
}

70 #iâdeà
MINISIZE


72 
	$os_to_·r£
(
os_to_t
 *
to
, cÚ¡ *
hv®ue
) {

73  
	`os_äom_·r£
((
os_äom_t
 *è
to
, 
hv®ue
);

74 
	}
}

79 
	$os_to_to_¡r
(cÚ¡ 
os_to_t
 *
to
, **
de¡
) {

80  
	`os_äom_to_¡r
((
os_äom_t
 *è
to
, 
de¡
);

81 
	}
}

85 
	$os_to_ä“
(
os_to_t
 *
to
) {

86 
	`os_äom_ä“
((
os_äom_t
 *è
to
);

87 
	}
}

89 
	$os_to_şÚe
(cÚ¡ 
os_to_t
 *
to
, os_to_ˆ**
de¡
) {

90  
	`os_äom_şÚe
((
os_äom_t
 *è
to
, (os_äom_ˆ**è
de¡
);

91 
	}
}

93 
	$os_to_g_m©ch
(
os_to_t
 *
to1
, os_to_ˆ*
to2
) {

94  
	`os_äom_g_m©ch
((
os_äom_t
 *è
to1
, (os_äom_ˆ*è
to2
);

95 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_uri.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

25 
	#os_is_®pha
(
š
è((š >ğ'a' && iÀ<ğ'z'è|| (š >ğ'A' && iÀ<ğ'Z'))

	)

31 
	$os_uri_š™
(
os_uri_t
 **
u¾
) {

32 *
u¾
 = (
os_uri_t
 *è
	`os_m®loc
((osip_uri_t));

34 ià(*
u¾
 =ğ
NULL
)

35  
OSIP_NOMEM
;

37 (*
u¾
)->
scheme
 = 
NULL
;

38 (*
u¾
)->
u£ºame
 = 
NULL
;

39 (*
u¾
)->
·sswÜd
 = 
NULL
;

40 (*
u¾
)->
ho¡
 = 
NULL
;

41 (*
u¾
)->
pÜt
 = 
NULL
;

43 
	`os_li¡_š™
(&(*
u¾
)->
u¾_·¿ms
);

45 
	`os_li¡_š™
(&(*
u¾
)->
u¾_h—d”s
);

47 (*
u¾
)->
¡ršg
 = 
NULL
;

48  
OSIP_SUCCESS
;

49 
	}
}

70 cÚ¡ *
	$Ãxt_£·¿tÜ
(cÚ¡ *
ch
, 
£·¿tÜ_os_to_fšd
, 
befÜe_£·¿tÜ
) {

71 cÚ¡ *
šd
;

72 cÚ¡ *
tmp
;

74 
šd
 = 
	`¡rchr
(
ch
, 
£·¿tÜ_os_to_fšd
);

76 ià(
šd
 =ğ
NULL
)

77  
NULL
;

79 
tmp
 = 
NULL
;

81 ià(
befÜe_£·¿tÜ
 != 0)

82 
tmp
 = 
	`¡rchr
(
ch
, 
befÜe_£·¿tÜ
);

84 ià(
tmp
 !ğ
NULL
) {

85 ià(
šd
 < 
tmp
)

86  
šd
;

89  
šd
;

91  
NULL
;

92 
	}
}

99 
	$os_uri_·r£
(
os_uri_t
 *
u¾
, cÚ¡ *
buf
) {

100 cÚ¡ *
u£ºame
;

101 cÚ¡ *
·sswÜd
;

102 cÚ¡ *
ho¡
;

103 cÚ¡ *
pÜt
;

104 cÚ¡ *
·¿ms
;

105 cÚ¡ *
h—d”s
;

106 cÚ¡ *
tmp
;

107 
i
;

110 ià(
buf
 =ğ
NULL
 || buf[0] == '\0')

111  
OSIP_BADPARAMETER
;

113 
tmp
 = 
	`¡rchr
(
buf
, ':');

115 ià(
tmp
 =ğ
NULL
)

116  
OSIP_SYNTAXERROR
;

118 ià(
tmp
 - 
buf
 < 2)

119  
OSIP_SYNTAXERROR
;

121 
i
 = 0;

123 
buf
 + 
i
 < 
tmp
) {

124 ià(!
	`os_is_®pha
(
buf
[
i
]))

125  
OSIP_SYNTAXERROR
;

127 
i
++;

130 
u¾
->
scheme
 = (*è
	`os_m®loc
(
tmp
 - 
buf
 + 1);

132 ià(
u¾
->
scheme
 =ğ
NULL
)

133  
OSIP_NOMEM
;

135 
	`os_¡ºıy
(
u¾
->
scheme
, 
buf
, 
tmp
 - buf);

137 ià(
	`¡rchr
(
u¾
->
scheme
, ' 'è!ğ
NULL
) {

138  
OSIP_SYNTAXERROR
;

141 ià(
	`¡¾’
(
u¾
->
scheme
è< 3 || (0 !ğ
	`os_¡ºÿ£cmp
(url->scheme, "sip", 3) && 0 != osip_strncasecmp(url->scheme, "sips", 4))) {

142 
size_t
 
i
 = 
	`¡¾’
(
tmp
 + 1);

144 ià(
i
 < 2)

145  
OSIP_SYNTAXERROR
;

147 
u¾
->
¡ršg
 = (*è
	`os_m®loc
(
i
 + 1);

149 ià(
u¾
->
¡ršg
 =ğ
NULL
)

150  
OSIP_NOMEM
;

152 
	`os_¡ºıy
(
u¾
->
¡ršg
, 
tmp
 + 1, 
i
);

153  
OSIP_SUCCESS
;

165 
u£ºame
 = 
	`¡rchr
(
buf
, ':');

168 ià(
u£ºame
 =ğ
NULL
)

169  
OSIP_SYNTAXERROR
;

171 
ho¡
 = 
	`¡rchr
(
buf
, '@');

173 ià(
ho¡
 =ğ
NULL
)

174 
ho¡
 = 
u£ºame
;

176 ià(
u£ºame
[1] == '@')

177 
ho¡
 = 
u£ºame
 + 1;

182 
·sswÜd
 = 
	`Ãxt_£·¿tÜ
(
u£ºame
 + 1, ':', '@');

184 ià(
·sswÜd
 =ğ
NULL
)

185 
·sswÜd
 = 
ho¡
;

190 ià(
ho¡
 - 
·sswÜd
 < 2)

191  
OSIP_SYNTAXERROR
;

193 
u¾
->
·sswÜd
 = (*è
	`os_m®loc
(
ho¡
 -…assword);

195 ià(
u¾
->
·sswÜd
 =ğ
NULL
)

196  
OSIP_NOMEM
;

198 
	`os_¡ºıy
(
u¾
->
·sswÜd
,…asswÜd + 1, 
ho¡
 -…assword - 1);

199 
	`__os_uri_uÃsÿ³
(
u¾
->
·sswÜd
);

202 ià(
·sswÜd
 - 
u£ºame
 < 2)

203  
OSIP_SYNTAXERROR
;

206 
u¾
->
u£ºame
 = (*è
	`os_m®loc
(
·sswÜd
 - username);

208 ià(
u¾
->
u£ºame
 =ğ
NULL
)

209  
OSIP_NOMEM
;

211 
	`os_¡ºıy
(
u¾
->
u£ºame
, u£ºam+ 1, 
·sswÜd
 - username - 1);

212 
	`__os_uri_uÃsÿ³
(
u¾
->
u£ºame
);

217 
h—d”s
 = 
	`¡rchr
(
ho¡
, '?');

219 ià(
h—d”s
 =ğ
NULL
)

220 
h—d”s
 = 
buf
 + 
	`¡¾’
(buf);

224 
	`os_uri_·r£_h—d”s
(
u¾
, 
h—d”s
);

227 
·¿ms
 = 
	`¡rchr
(
ho¡
, ';');

229 ià(
·¿ms
 =ğ
NULL
)

230 
·¿ms
 = 
h—d”s
;

235 *
tmpbuf
;

237 ià(
h—d”s
 - 
·¿ms
 + 1 < 2)

238  
OSIP_SYNTAXERROR
;

240 
tmpbuf
 = 
	`os_m®loc
(
h—d”s
 - 
·¿ms
 + 1);

242 ià(
tmpbuf
 =ğ
NULL
)

243  
OSIP_NOMEM
;

245 
tmpbuf
 = 
	`os_¡ºıy
Ñmpbuf, 
·¿ms
, 
h—d”s
 -…arams);

246 
	`os_uri_·r£_·¿ms
(
u¾
, 
tmpbuf
);

247 
	`os_ä“
(
tmpbuf
);

250 
pÜt
 = 
·¿ms
 - 1;

252 
pÜt
 > 
ho¡
 && *port != ']' && *port != ':')

253 
pÜt
--;

255 ià(*
pÜt
 == ':') {

256 ià(
ho¡
 =ğ
pÜt
)

257 
pÜt
 = 
·¿ms
;

260 ià((
·¿ms
 - 
pÜt
 < 2) || (params -…ort > 8))

261  
OSIP_SYNTAXERROR
;

263 
u¾
->
pÜt
 = (*è
	`os_m®loc
(
·¿ms
 -…ort);

265 ià(
u¾
->
pÜt
 =ğ
NULL
)

266  
OSIP_NOMEM
;

268 
	`os_şºıy
(
u¾
->
pÜt
,…Üˆ+ 1, 
·¿ms
 -…ort - 1);

272 
pÜt
 = 
·¿ms
;

275 
tmp
 = 
pÜt
;

277 
tmp
 > 
ho¡
 && *tmp != ']')

278 
tmp
--;

280 ià(*
tmp
 == ']') {

281 
pÜt
 = 
tmp
;

283 
ho¡
 < 
pÜt
 && *host != '[')

284 
ho¡
++;

286 ià(
ho¡
 >ğ
pÜt
)

287  
OSIP_SYNTAXERROR
;

290 ià(
pÜt
 - 
ho¡
 < 2)

291  
OSIP_SYNTAXERROR
;

293 
u¾
->
ho¡
 = (*è
	`os_m®loc
(
pÜt
 - host);

295 ià(
u¾
->
ho¡
 =ğ
NULL
)

296  
OSIP_NOMEM
;

298 
	`os_şºıy
(
u¾
->
ho¡
, ho¡ + 1, 
pÜt
 - host - 1);

300  
OSIP_SUCCESS
;

301 
	}
}

303 
	$os_uri_£t_scheme
(
os_uri_t
 *
u¾
, *
scheme
) {

304 ià(
u¾
 =ğ
NULL
)

307 
u¾
->
scheme
 = scheme;

308 
	}
}

310 *
	$os_uri_g‘_scheme
(
os_uri_t
 *
u¾
) {

311 ià(
u¾
 =ğ
NULL
)

312  
NULL
;

314  
u¾
->
scheme
;

315 
	}
}

317 
	$os_uri_£t_u£ºame
(
os_uri_t
 *
u¾
, *
u£ºame
) {

318 ià(
u¾
 =ğ
NULL
)

321 
u¾
->
u£ºame
 = username;

322 
	}
}

324 *
	$os_uri_g‘_u£ºame
(
os_uri_t
 *
u¾
) {

325 ià(
u¾
 =ğ
NULL
)

326  
NULL
;

328  
u¾
->
u£ºame
;

329 
	}
}

331 
	$os_uri_£t_·sswÜd
(
os_uri_t
 *
u¾
, *
·sswÜd
) {

332 ià(
u¾
 =ğ
NULL
)

335 
u¾
->
·sswÜd
 =…assword;

336 
	}
}

338 *
	$os_uri_g‘_·sswÜd
(
os_uri_t
 *
u¾
) {

339 ià(
u¾
 =ğ
NULL
)

340  
NULL
;

342  
u¾
->
·sswÜd
;

343 
	}
}

345 
	$os_uri_£t_ho¡
(
os_uri_t
 *
u¾
, *
ho¡
) {

346 ià(
u¾
 =ğ
NULL
)

349 
u¾
->
ho¡
 = host;

350 
	}
}

352 *
	$os_uri_g‘_ho¡
(
os_uri_t
 *
u¾
) {

353 ià(
u¾
 =ğ
NULL
)

354  
NULL
;

356  
u¾
->
ho¡
;

357 
	}
}

359 
	$os_uri_£t_pÜt
(
os_uri_t
 *
u¾
, *
pÜt
) {

360 ià(
u¾
 =ğ
NULL
)

363 
u¾
->
pÜt
 =…ort;

364 
	}
}

366 *
	$os_uri_g‘_pÜt
(
os_uri_t
 *
u¾
) {

367 ià(
u¾
 =ğ
NULL
)

368  
NULL
;

370  
u¾
->
pÜt
;

371 
	}
}

373 
	$os_uri_·r£_h—d”s
(
os_uri_t
 *
u¾
, cÚ¡ *
h—d”s
) {

374 
i
;

375 cÚ¡ *
_ªd
;

376 cÚ¡ *
equ®
;

378 ià(
h—d”s
[0] != '?')

379  
OSIP_SYNTAXERROR
;

384 
equ®
 = 
	`¡rchr
(
h—d”s
, '=');

385 
_ªd
 = 
	`¡rchr
(
h—d”s
 + 1, '&');

387 ià(
equ®
 =ğ
NULL
)

388  
OSIP_SYNTAXERROR
;

391 *
hÇme
;

392 *
hv®ue
;

394 
hÇme
 = (*è
	`os_m®loc
(
equ®
 - 
h—d”s
);

396 ià(
hÇme
 =ğ
NULL
)

397  
OSIP_NOMEM
;

399 
	`os_¡ºıy
(
hÇme
, 
h—d”s
 + 1, 
equ®
 - headers - 1);

400 
	`__os_uri_uÃsÿ³
(
hÇme
);

402 ià(
_ªd
 !ğ
NULL
) {

403 ià(
_ªd
 - 
equ®
 < 2) {

404 
	`os_ä“
(
hÇme
);

405  
OSIP_SYNTAXERROR
;

408 
hv®ue
 = (*è
	`os_m®loc
(
_ªd
 - 
equ®
);

410 ià(
hv®ue
 =ğ
NULL
) {

411 
	`os_ä“
(
hÇme
);

412  
OSIP_NOMEM
;

415 
	`os_¡ºıy
(
hv®ue
, 
equ®
 + 1, 
_ªd
 -ƒqual - 1);

416 
	`__os_uri_uÃsÿ³
(
hv®ue
);

419 ià(
h—d”s
 + 
	`¡¾’
(h—d”sè- 
equ®
 + 1 < 2) {

420 
	`os_ä“
(
hÇme
);

421  
OSIP_SYNTAXERROR
;

424 
hv®ue
 = (*è
	`os_m®loc
(
h—d”s
 + 
	`¡¾’
(h—d”sè- 
equ®
 + 1);

426 ià(
hv®ue
 =ğ
NULL
) {

427 
	`os_ä“
(
hÇme
);

428  
OSIP_NOMEM
;

431 
	`os_¡ºıy
(
hv®ue
, 
equ®
 + 1, 
h—d”s
 + 
	`¡¾’
(headers) -ƒqual);

432 
	`__os_uri_uÃsÿ³
(
hv®ue
);

435 
i
 = 
	`os_uri_uh—d”_add
(
u¾
, 
hÇme
, 
hv®ue
);

437 ià(
i
 !ğ
OSIP_SUCCESS
) {

438 
	`os_ä“
(
hÇme
);

439 
	`os_ä“
(
hv®ue
);

440  
i
;

443 ià(
_ªd
 =ğ
NULL
)

444 
equ®
 = 
NULL
;

448 
h—d”s
 = 
_ªd
;

449 
equ®
 = 
	`¡rchr
(
h—d”s
, '=');

450 
_ªd
 = 
	`¡rchr
(
h—d”s
 + 1, '&');

452 ià(
equ®
 =ğ
NULL
)

453  
OSIP_SYNTAXERROR
;

455 } 
equ®
 !ğ
NULL
);

457  
OSIP_SUCCESS
;

458 
	}
}

460 
	$os_uri_·r£_·¿ms
(
os_uri_t
 *
u¾
, cÚ¡ *
·¿ms
) {

461 
i
;

462 *
²ame
;

463 *
pv®ue
;

465 cÚ¡ *
comma
;

466 cÚ¡ *
equ®
;

468 ià(
·¿ms
[0] != ';')

469  
OSIP_SYNTAXERROR
;

474 
equ®
 = 
	`Ãxt_£·¿tÜ
(
·¿ms
 + 1, '=', ';');

475 
comma
 = 
	`¡rchr
(
·¿ms
 + 1, ';');

477 
comma
 !ğ
NULL
) {

478 ià(
equ®
 =ğ
NULL
) {

479 
equ®
 = 
comma
;

480 
pv®ue
 = 
NULL
;

483 ià(
comma
 - 
equ®
 < 2)

484  
OSIP_SYNTAXERROR
;

486 
pv®ue
 = (*è
	`os_m®loc
(
comma
 - 
equ®
);

488 ià(
pv®ue
 =ğ
NULL
)

489  
OSIP_NOMEM
;

491 
	`os_¡ºıy
(
pv®ue
, 
equ®
 + 1, 
comma
 -ƒqual - 1);

492 
	`__os_uri_uÃsÿ³
(
pv®ue
);

495 ià(
equ®
 - 
·¿ms
 < 2) {

496 
	`os_ä“
(
pv®ue
);

497  
OSIP_SYNTAXERROR
;

500 
²ame
 = (*è
	`os_m®loc
(
equ®
 - 
·¿ms
);

502 ià(
²ame
 =ğ
NULL
) {

503 
	`os_ä“
(
pv®ue
);

504  
OSIP_NOMEM
;

507 
	`os_¡ºıy
(
²ame
, 
·¿ms
 + 1, 
equ®
 -…arams - 1);

508 
	`__os_uri_uÃsÿ³
(
²ame
);

510 
i
 = 
	`os_uri_u·¿m_add
(
u¾
, 
²ame
, 
pv®ue
);

512 ià(
i
 !ğ
OSIP_SUCCESS
) {

513 
	`os_ä“
(
²ame
);

514 
	`os_ä“
(
pv®ue
);

515  
OSIP_NOMEM
;

518 
·¿ms
 = 
comma
;

519 
equ®
 = 
	`Ãxt_£·¿tÜ
(
·¿ms
 + 1, '=', ';');

520 
comma
 = 
	`¡rchr
(
·¿ms
 + 1, ';');

524 
comma
 = 
·¿ms
 + 
	`¡¾’
(params);

526 ià(
equ®
 =ğ
NULL
) {

527 
equ®
 = 
comma
;

528 
pv®ue
 = 
NULL
;

531 ià(
comma
 - 
equ®
 < 2)

532  
OSIP_SYNTAXERROR
;

534 
pv®ue
 = (*è
	`os_m®loc
(
comma
 - 
equ®
);

536 ià(
pv®ue
 =ğ
NULL
)

537  
OSIP_NOMEM
;

539 
	`os_¡ºıy
(
pv®ue
, 
equ®
 + 1, 
comma
 -ƒqual - 1);

540 
	`__os_uri_uÃsÿ³
(
pv®ue
);

543 ià(
equ®
 - 
·¿ms
 < 2) {

544 
	`os_ä“
(
pv®ue
);

545  
OSIP_SYNTAXERROR
;

548 
²ame
 = (*è
	`os_m®loc
(
equ®
 - 
·¿ms
);

550 ià(
²ame
 =ğ
NULL
) {

551 
	`os_ä“
(
pv®ue
);

552  
OSIP_NOMEM
;

555 
	`os_¡ºıy
(
²ame
, 
·¿ms
 + 1, 
equ®
 -…arams - 1);

556 
	`__os_uri_uÃsÿ³
(
²ame
);

558 
i
 = 
	`os_uri_u·¿m_add
(
u¾
, 
²ame
, 
pv®ue
);

560 ià(
i
 !ğ
OSIP_SUCCESS
) {

561 
	`os_ä“
(
²ame
);

562 
	`os_ä“
(
pv®ue
);

563  
OSIP_NOMEM
;

566  
OSIP_SUCCESS
;

567 
	}
}

569 
	$os_uri_to_¡r
(cÚ¡ 
os_uri_t
 *
u¾
, **
de¡
) {

570 *
buf
;

571 
size_t
 
Ën
;

572 
size_t
 
¶’
;

573 *
tmp
;

574 cÚ¡ *
scheme
;

576 *
de¡
 = 
NULL
;

578 ià(
u¾
 =ğ
NULL
)

579  
OSIP_BADPARAMETER
;

581 ià(
u¾
->
ho¡
 =ğ
NULL
 && u¾->
¡ršg
 == NULL)

582  
OSIP_BADPARAMETER
;

584 ià(
u¾
->
scheme
 =ğ
NULL
 && u¾->
¡ršg
 != NULL)

585  
OSIP_BADPARAMETER
;

587 ià(
u¾
->
¡ršg
 =ğ
NULL
 && u¾->
scheme
 == NULL)

588 
scheme
 = "sip";

590 
scheme
 = 
u¾
->scheme;

592 ià(
u¾
->
¡ršg
 !ğ
NULL
) {

593 
buf
 = (*è
	`os_m®loc
(
	`¡¾’
(
scheme
è+ sŒËn(
u¾
->
¡ršg
) + 3);

595 ià(
buf
 =ğ
NULL
)

596  
OSIP_NOMEM
;

598 *
de¡
 = 
buf
;

599 
	`¥rštf
(
buf
, "%s:", 
scheme
);

600 
buf
 = buà+ 
	`¡¾’
(
scheme
) + 1;

601 
	`¥rštf
(
buf
, "%s", 
u¾
->
¡ršg
);

602  
OSIP_SUCCESS
;

605 
Ën
 = 
	`¡¾’
(
scheme
è+ 1 + sŒËn(
u¾
->
ho¡
) + 5;

607 ià(
u¾
->
u£ºame
 !ğ
NULL
)

608 
Ën
 =†’ + (
	`¡¾’
(
u¾
->
u£ºame
) * 3) + 1;

610 ià(
u¾
->
·sswÜd
 !ğ
NULL
)

611 
Ën
 =†’ + (
	`¡¾’
(
u¾
->
·sswÜd
) * 3) + 1;

613 ià(
u¾
->
pÜt
 !ğ
NULL
)

614 
Ën
 =†’ + 
	`¡¾’
(
u¾
->
pÜt
) + 3;

616 
buf
 = (*è
	`os_m®loc
(
Ën
);

618 ià(
buf
 =ğ
NULL
)

619  
OSIP_NOMEM
;

621 
tmp
 = 
buf
;

623 
	`¥rštf
(
tmp
, "%s:", 
scheme
);

624 
tmp
 =m°+ 
	`¡¾’
(tmp);

626 ià(
u¾
->
u£ºame
 !ğ
NULL
) {

627 *
tmp2
 = 
	`__os_uri_esÿ³_u£ršfo
(
u¾
->
u£ºame
);

629 ià(
tmp2
 =ğ
NULL
) {

630 
	`os_ä“
(
buf
);

631  
OSIP_NOMEM
;

634 
	`¥rštf
(
tmp
, "%s", 
tmp2
);

635 
	`os_ä“
(
tmp2
);

636 
tmp
 =m°+ 
	`¡¾’
(tmp);

639 ià((
u¾
->
·sswÜd
 !ğ
NULL
è&& (u¾->
u£ºame
 != NULL)) {

640 *
tmp2
 = 
	`__os_uri_esÿ³_·sswÜd
(
u¾
->
·sswÜd
);

642 ià(
tmp2
 =ğ
NULL
) {

643 
	`os_ä“
(
buf
);

644  
OSIP_NOMEM
;

647 
	`¥rštf
(
tmp
, ":%s", 
tmp2
);

648 
	`os_ä“
(
tmp2
);

649 
tmp
 =m°+ 
	`¡¾’
(tmp);

652 ià(
u¾
->
u£ºame
 !ğ
NULL
) {

653 
	`¥rštf
(
tmp
, "@");

654 
tmp
++;

657 ià(
	`¡rchr
(
u¾
->
ho¡
, ':'è!ğ
NULL
) {

658 
	`¥rštf
(
tmp
, "[%s]", 
u¾
->
ho¡
);

659 
tmp
 =m°+ 
	`¡¾’
(tmp);

662 
	`¥rštf
(
tmp
, "%s", 
u¾
->
ho¡
);

663 
tmp
 =m°+ 
	`¡¾’
(tmp);

666 ià(
u¾
->
pÜt
 !ğ
NULL
) {

667 
	`¥rštf
(
tmp
, ":%s", 
u¾
->
pÜt
);

668 
tmp
 =m°+ 
	`¡¾’
(tmp);

672 
os_li¡_™”©Ü_t
 
™
;

673 
os_uri_·¿m_t
 *
u_·¿m
 = (os_uri_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
u¾
->
u¾_·¿ms
, &
™
);

675 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

676 *
tmp1
;

677 *
tmp2
 = 
NULL
;

678 *
´evious_buf
;

680 ià(
	`os_¡rÿ£cmp
(
u_·¿m
->
gÇme
, "x-obr") == 0 || osip_strcasecmp(u_param->gname, "x-obp") == 0) {

682 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

686 
tmp1
 = 
	`__os_uri_esÿ³_uri_·¿m
(
u_·¿m
->
gÇme
);

688 ià(
tmp1
 =ğ
NULL
) {

689 
	`os_ä“
(
buf
);

690  
OSIP_SYNTAXERROR
;

693 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

694 
¶’
 = 
	`¡¾’
(
tmp1
) + 2;

697 
tmp2
 = 
	`__os_uri_esÿ³_uri_·¿m
(
u_·¿m
->
gv®ue
);

699 ià(
tmp2
 =ğ
NULL
) {

700 
	`os_ä“
(
tmp1
);

701 
	`os_ä“
(
buf
);

702  
OSIP_SYNTAXERROR
;

705 
¶’
 = 
	`¡¾’
(
tmp1
è+ sŒËn(
tmp2
) + 3;

708 
Ën
 =†’ + 
¶’
;

709 
´evious_buf
 = 
buf
;

710 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

712 ià(
buf
 =ğ
NULL
) {

713 
	`os_ä“
(
´evious_buf
);

714 
	`os_ä“
(
tmp1
);

715 
	`os_ä“
(
tmp2
);

716  
OSIP_NOMEM
;

719 
tmp
 = 
buf
;

720 
tmp
 =m°+ 
	`¡¾’
(tmp);

722 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

723 
	`¥rštf
(
tmp
, ";%s", 
tmp1
);

726 
	`¥rštf
(
tmp
, ";%s=%s", 
tmp1
, 
tmp2
);

727 
	`os_ä“
(
tmp2
);

730 
	`os_ä“
(
tmp1
);

731 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

736 
os_li¡_™”©Ü_t
 
™
;

737 
os_uri_h—d”_t
 *
u_h—d”
 = (os_uri_h—d”_ˆ*è
	`os_li¡_g‘_fœ¡
(&
u¾
->
u¾_h—d”s
, &
™
);

739 
u_h—d”
 !ğ
OSIP_SUCCESS
) {

740 *
tmp1
;

741 *
tmp2
;

742 *
´evious_buf
;

744 
tmp1
 = 
	`__os_uri_esÿ³_h—d”_·¿m
(
u_h—d”
->
gÇme
);

746 ià(
tmp1
 =ğ
NULL
) {

747 
	`os_ä“
(
buf
);

748  
OSIP_SYNTAXERROR
;

751 
tmp2
 = 
	`__os_uri_esÿ³_h—d”_·¿m
(
u_h—d”
->
gv®ue
);

753 ià(
tmp2
 =ğ
NULL
) {

754 
	`os_ä“
(
tmp1
);

755 
	`os_ä“
(
buf
);

756  
OSIP_SYNTAXERROR
;

759 
¶’
 = 
	`¡¾’
(
tmp1
è+ sŒËn(
tmp2
) + 4;

761 
Ën
 =†’ + 
¶’
;

762 
´evious_buf
 = 
buf
;

763 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

765 ià(
buf
 =ğ
NULL
) {

766 
	`os_ä“
(
´evious_buf
);

767 
	`os_ä“
(
tmp1
);

768 
	`os_ä“
(
tmp2
);

769  
OSIP_NOMEM
;

772 
tmp
 = 
buf
;

773 
tmp
 =m°+ 
	`¡¾’
(tmp);

775 ià(
™
.
pos
 == 0)

776 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), "?%s=%s", 
tmp1
, 
tmp2
);

779 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), "&%s=%s", 
tmp1
, 
tmp2
);

781 
	`os_ä“
(
tmp1
);

782 
	`os_ä“
(
tmp2
);

783 
u_h—d”
 = (
os_uri_h—d”_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

787 *
de¡
 = 
buf
;

788  
OSIP_SUCCESS
;

789 
	}
}

791 
	$os_uri_ä“
(
os_uri_t
 *
u¾
) {

792 ià(
u¾
 =ğ
NULL
)

795 
	`os_ä“
(
u¾
->
scheme
);

796 
	`os_ä“
(
u¾
->
u£ºame
);

797 
	`os_ä“
(
u¾
->
·sswÜd
);

798 
	`os_ä“
(
u¾
->
ho¡
);

799 
	`os_ä“
(
u¾
->
pÜt
);

801 
	`os_uri_·¿m_ä“li¡
(&
u¾
->
u¾_·¿ms
);

804 
os_uri_h—d”_t
 *
u_h—d”
;

806 !
	`os_li¡_eŞ
(&
u¾
->
u¾_h—d”s
, 0)) {

807 
u_h—d”
 = (
os_uri_h—d”_t
 *è
	`os_li¡_g‘
(&
u¾
->
u¾_h—d”s
, 0);

808 
	`os_li¡_»move
(&
u¾
->
u¾_h—d”s
, 0);

809 
	`os_uri_h—d”_ä“
(
u_h—d”
);

813 
	`os_ä“
(
u¾
->
¡ršg
);

815 
	`os_ä“
(
u¾
);

816 
	}
}

818 
	$os_uri_şÚe
(cÚ¡ 
os_uri_t
 *
u¾
, os_uri_ˆ**
de¡
) {

819 
i
;

820 
os_uri_t
 *
ur
;

822 *
de¡
 = 
NULL
;

824 ià(
u¾
 =ğ
NULL
)

825  
OSIP_BADPARAMETER
;

827 ià(
u¾
->
ho¡
 =ğ
NULL
 && u¾->
¡ršg
 == NULL)

828  
OSIP_BADPARAMETER
;

830 
i
 = 
	`os_uri_š™
(&
ur
);

832 ià(
i
 != 0)

833  
i
;

835 ià(
u¾
->
scheme
 !ğ
NULL
)

836 
ur
->
scheme
 = 
	`os_¡rdup
(
u¾
->scheme);

838 ià(
u¾
->
u£ºame
 !ğ
NULL
)

839 
ur
->
u£ºame
 = 
	`os_¡rdup
(
u¾
->username);

841 ià(
u¾
->
·sswÜd
 !ğ
NULL
)

842 
ur
->
·sswÜd
 = 
	`os_¡rdup
(
u¾
->password);

844 ià(
u¾
->
ho¡
 !ğ
NULL
)

845 
ur
->
ho¡
 = 
	`os_¡rdup
(
u¾
->host);

847 ià(
u¾
->
pÜt
 !ğ
NULL
)

848 
ur
->
pÜt
 = 
	`os_¡rdup
(
u¾
->port);

850 ià(
u¾
->
¡ršg
 !ğ
NULL
)

851 
ur
->
¡ršg
 = 
	`os_¡rdup
(
u¾
->string);

853 
i
 = 
	`os_li¡_şÚe
(&
u¾
->
u¾_·¿ms
, &
ur
->u¾_·¿ms, ((*)(*, **)è& 
os_uri_·¿m_şÚe
);

855 ià(
i
 != 0) {

856 
	`os_uri_ä“
(
ur
);

857  
i
;

860 
i
 = 
	`os_li¡_şÚe
(&
u¾
->
u¾_h—d”s
, &
ur
->u¾_h—d”s, ((*)(*, **)è& 
os_uri_·¿m_şÚe
);

862 ià(
i
 != 0) {

863 
	`os_uri_ä“
(
ur
);

864  
i
;

867 *
de¡
 = 
ur
;

868  
OSIP_SUCCESS
;

869 
	}
}

871 
	$os_uri_·¿m_š™
(
os_uri_·¿m_t
 **
u¾_·¿m
) {

872 *
u¾_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_m®loc
((osip_uri_param_t));

874 ià(*
u¾_·¿m
 =ğ
NULL
)

875  
OSIP_NOMEM
;

877 (*
u¾_·¿m
)->
gÇme
 = 
NULL
;

878 (*
u¾_·¿m
)->
gv®ue
 = 
NULL
;

879  
OSIP_SUCCESS
;

880 
	}
}

882 
	$os_uri_·¿m_ä“
(
os_uri_·¿m_t
 *
u¾_·¿m
) {

883 
	`os_ä“
(
u¾_·¿m
->
gÇme
);

884 
	`os_ä“
(
u¾_·¿m
->
gv®ue
);

885 
	`os_ä“
(
u¾_·¿m
);

886 
	}
}

888 
	$os_uri_·¿m_£t
(
os_uri_·¿m_t
 *
u¾_·¿m
, *
²ame
, *
pv®ue
) {

889 
u¾_·¿m
->
gÇme
 = 
²ame
;

891 
	`os_şr¥aû
(
u¾_·¿m
->
gÇme
);

892 
u¾_·¿m
->
gv®ue
 = 
pv®ue
;

894 ià(
u¾_·¿m
->
gv®ue
 !ğ
NULL
)

895 
	`os_şr¥aû
(
u¾_·¿m
->
gv®ue
);

897  
OSIP_SUCCESS
;

898 
	}
}

900 
	$os_uri_·¿m_add
(
os_li¡_t
 *
u¾_·¿ms
, *
²ame
, *
pv®ue
) {

901 
i
;

902 
os_uri_·¿m_t
 *
u¾_·¿m
;

904 
i
 = 
	`os_uri_·¿m_š™
(&
u¾_·¿m
);

906 ià(
i
 != 0)

907  
i
;

909 
i
 = 
	`os_uri_·¿m_£t
(
u¾_·¿m
, 
²ame
, 
pv®ue
);

911 ià(
i
 != 0) {

912 
	`os_uri_·¿m_ä“
(
u¾_·¿m
);

913  
i
;

916 
	`os_li¡_add
(
u¾_·¿ms
, 
u¾_·¿m
, -1);

917  
OSIP_SUCCESS
;

918 
	}
}

920 
	$os_uri_·¿m_ä“li¡
(
os_li¡_t
 *
·¿ms
) {

921 
os_uri_·¿m_t
 *
u_·¿m
;

923 !
	`os_li¡_eŞ
(
·¿ms
, 0)) {

924 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘
(
·¿ms
, 0);

925 
	`os_li¡_»move
(
·¿ms
, 0);

926 
	`os_uri_·¿m_ä“
(
u_·¿m
);

928 
	}
}

930 
	$os_uri_·¿m_g‘_byÇme
(
os_li¡_t
 *
·¿ms
, *
²ame
, 
os_uri_·¿m_t
 **
u¾_·¿m
) {

931 
size_t
 
²ame_Ën
;

932 
os_uri_·¿m_t
 *
u_·¿m
;

933 
os_li¡_™”©Ü_t
 
™
;

935 *
u¾_·¿m
 = 
NULL
;

937 ià(
²ame
 =ğ
NULL
)

938  
OSIP_BADPARAMETER
;

940 
²ame_Ën
 = 
	`¡¾’
(
²ame
);

942 ià(
²ame_Ën
 <= 0)

943  
OSIP_BADPARAMETER
;

945 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘_fœ¡
(
·¿ms
, &
™
);

947 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

948 
size_t
 
Ën
;

950 
Ën
 = 
	`¡¾’
(
u_·¿m
->
gÇme
);

952 ià(
²ame_Ën
 =ğ
Ën
 && 
	`os_¡ºÿ£cmp
(
u_·¿m
->
gÇme
, 
²ame
, 
	`¡¾’
(pname)) == 0) {

953 *
u¾_·¿m
 = 
u_·¿m
;

954  
OSIP_SUCCESS
;

957 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

960  
OSIP_UNDEFINED_ERROR
;

961 
	}
}

963 
	$os_uri_·¿m_şÚe
(cÚ¡ 
os_uri_·¿m_t
 *
u·¿m
, os_uri_·¿m_ˆ**
de¡
) {

964 
i
;

965 
os_uri_·¿m_t
 *
up
;

967 *
de¡
 = 
NULL
;

969 ià(
u·¿m
 =ğ
NULL
)

970  
OSIP_BADPARAMETER
;

972 ià(
u·¿m
->
gÇme
 =ğ
NULL
)

973  
OSIP_BADPARAMETER
;

975 
i
 = 
	`os_uri_·¿m_š™
(&
up
);

977 ià(
i
 != 0)

978  
i
;

980 
up
->
gÇme
 = 
	`os_¡rdup
(
u·¿m
->gname);

982 ià(
u·¿m
->
gv®ue
 !ğ
NULL
)

983 
up
->
gv®ue
 = 
	`os_¡rdup
(
u·¿m
->gvalue);

986 
up
->
gv®ue
 = 
NULL
;

988 *
de¡
 = 
up
;

989  
OSIP_SUCCESS
;

990 
	}
}

992 
	#_ALPHANUM_
 "abcdefghijklmnİqr¡uvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\0"

	)

993 
	#_RESERVED_
 ";/?:@&=+$\0"

	)

994 
	#_MARK_
 "-_.!~*'()\0"

	)

996 
	#_MARK__USER_UNRESERVED_
 "-_.!~*'()&=+$,;?/\0"

	)

997 
	#_MARK__PWORD_UNRESERVED_
 "-_.!~*'()&=+$,\0"

	)

998 
	#_MARK__URI_PARAM_UNRESERVED_
 "-_.!~*'()[]/:&+$\0"

	)

999 
	#_MARK__HEADER_PARAM_UNRESERVED_
 "-_.!~*'()[]/?:+$\0"

	)

1001 
	#os_is_®phªum
(
š
è((š >ğ'a' && iÀ<ğ'z'è|| (š >ğ'A' && iÀ<ğ'Z'è|| (š >ğ'0' && iÀ<ğ'9'))

	)

1003 *
	$__os_uri_esÿ³_nÚascii_ªd_nÚdef
(cÚ¡ *
¡ršg
, cÚ¡ *
def
) {

1004 
size_t
 
®loc
 = 
	`¡¾’
(
¡ršg
) + 1;

1005 
size_t
 
Ëngth
;

1006 *
ns
 = (*è
	`os_m®loc
(
®loc
);

1007 
š
;

1008 
size_t
 
ÃwËn
 = 
®loc
;

1009 
šdex
 = 0;

1010 cÚ¡ *
tmp
;

1011 
i
;

1013 ià(
ns
 =ğ
NULL
)

1014  
NULL
;

1016 
Ëngth
 = 
®loc
 - 1;

1018 
Ëngth
--) {

1019 
š
 = *
¡ršg
;

1021 
i
 = 0;

1022 
tmp
 = 
NULL
;

1024 ià(
	`os_is_®phªum
(
š
))

1025 
tmp
 = 
¡ršg
;

1028 ; 
def
[
i
] !ğ'\0' && def[i] !ğ
š
; i++) {

1031 ià(
def
[
i
] != '\0')

1032 
tmp
 = 
¡ršg
;

1035 ià(
tmp
 =ğ
NULL
) {

1037 
ÃwËn
 += 2;

1039 ià(
ÃwËn
 > 
®loc
) {

1040 *
´evious_ns
;

1042 
®loc
 *= 2;

1043 
´evious_ns
 = 
ns
;

1044 
ns
 = 
	`os_»®loc
Òs, 
®loc
);

1046 ià(!
ns
) {

1047 
	`os_ä“
(
´evious_ns
);

1048  
NULL
;

1052 
	`¥rštf
(&
ns
[
šdex
], "%%%02X", 
š
);

1053 
šdex
 += 3;

1057 
ns
[
šdex
++] = 
š
;

1060 
¡ršg
++;

1063 
ns
[
šdex
] = 0;

1064  
ns
;

1065 
	}
}

1068 cÚ¡ *
	gu£ršfo_def
 = 
_MARK__USER_UNRESERVED_
;

1069 *
	$__os_uri_esÿ³_u£ršfo
(cÚ¡ *
¡ršg
) {

1070  
	`__os_uri_esÿ³_nÚascii_ªd_nÚdef
(
¡ršg
, 
u£ršfo_def
);

1071 
	}
}

1074 cÚ¡ *
	g·sswÜd_def
 = 
_MARK__PWORD_UNRESERVED_
;

1075 *
	$__os_uri_esÿ³_·sswÜd
(cÚ¡ *
¡ršg
) {

1076  
	`__os_uri_esÿ³_nÚascii_ªd_nÚdef
(
¡ršg
, 
·sswÜd_def
);

1077 
	}
}

1079 cÚ¡ *
	guri_·¿m_def
 = 
_MARK__URI_PARAM_UNRESERVED_
;

1080 *
	$__os_uri_esÿ³_uri_·¿m
(*
¡ršg
) {

1081  
	`__os_uri_esÿ³_nÚascii_ªd_nÚdef
(
¡ršg
, 
uri_·¿m_def
);

1082 
	}
}

1084 cÚ¡ *
	gh—d”_·¿m_def
 = 
_MARK__HEADER_PARAM_UNRESERVED_
;

1085 *
	$__os_uri_esÿ³_h—d”_·¿m
(*
¡ršg
) {

1086  
	`__os_uri_esÿ³_nÚascii_ªd_nÚdef
(
¡ršg
, 
h—d”_·¿m_def
);

1087 
	}
}

1089 
	$__os_uri_uÃsÿ³
(*
¡ršg
) {

1090 
size_t
 
®loc
 = 
	`¡¾’
(
¡ršg
) + 1;

1091 
š
;

1092 
šdex
 = 0;

1093 
hex
;

1094 *
±r
;

1096 
±r
 = 
¡ršg
;

1098 --
®loc
 > 0) {

1099 
š
 = *
±r
;

1101 ià('%' =ğ
š
) {

1103 ià(
®loc
 > 2 && 
	`ssÿnf
(
±r
 + 1, "%02X", &
hex
) == 1) {

1104 
š
 = (è
hex
;

1106 ià(*(
±r
 + 2) && ((*(ptr + 2) >= '0' && *(ptr + 2) <= '9') || (*(ptr + 2) >= 'a' && *(ptr + 2) <= 'f') || (*(ptr + 2) >= 'A' && *(ptr + 2) <= 'F'))) {

1107 
®loc
 -= 2;

1108 
±r
 += 2;

1111 
®loc
 -= 1;

1112 
±r
 += 1;

1120 
¡ršg
[
šdex
++] = 
š
;

1121 
±r
++;

1124 
¡ršg
[
šdex
] = 0;

1125 
	}
}

1129 
	$os_uri_to_¡r_ÿnÚiÿl
(cÚ¡ 
os_uri_t
 *
u¾
, **
de¡
) {

1130 
»suÉ
;

1132 *
de¡
 = 
NULL
;

1133 
»suÉ
 = 
	`os_uri_to_¡r
(
u¾
, 
de¡
);

1135 ià(
»suÉ
 == 0) {

1144 
	`__os_uri_uÃsÿ³
(*
de¡
);

1147  
»suÉ
;

1148 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_via.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

31 
	$os_mes§ge_£t_vŸ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

32 
os_vŸ_t
 *
vŸ
;

33 
i
;

35 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

36  
OSIP_SUCCESS
;

38 
i
 = 
	`os_vŸ_š™
(&
vŸ
);

40 ià(
i
 != 0)

41  
i
;

43 
i
 = 
	`os_vŸ_·r£
(
vŸ
, 
hv®ue
);

45 ià(
i
 != 0) {

46 
	`os_vŸ_ä“
(
vŸ
);

47  
i
;

50 
s
->
mes§ge_´İ”ty
 = 2;

51 
	`os_li¡_add
(&
s
->
vŸs
, 
vŸ
, -1);

52  
OSIP_SUCCESS
;

53 
	}
}

59 
	$os_mes§ge_­³nd_vŸ
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

60 
os_vŸ_t
 *
vŸ
;

61 
i
;

63 
i
 = 
	`os_vŸ_š™
(&
vŸ
);

65 ià(
i
 != 0)

66  
i
;

68 
i
 = 
	`os_vŸ_·r£
(
vŸ
, 
hv®ue
);

70 ià(
i
 != 0) {

71 
	`os_vŸ_ä“
(
vŸ
);

72  
i
;

75 
s
->
mes§ge_´İ”ty
 = 2;

76 
	`os_li¡_add
(&
s
->
vŸs
, 
vŸ
, 0);

77  
OSIP_SUCCESS
;

78 
	}
}

80 #iâdeà
MINISIZE


86 
	$os_mes§ge_g‘_vŸ
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_vŸ_t
 **
de¡
) {

87 *
de¡
 = 
NULL
;

89 ià(
s
 =ğ
NULL
)

90  
OSIP_BADPARAMETER
;

92 ià(
	`os_li¡_size
(&
s
->
vŸs
è<ğ
pos
)

93  
OSIP_UNDEFINED_ERROR
;

95 *
de¡
 = (
os_vŸ_t
 *è
	`os_li¡_g‘
(&
s
->
vŸs
, 
pos
);

97  
pos
;

98 
	}
}

101 
	$os_vŸ_š™
(
os_vŸ_t
 **
vŸ
) {

102 *
vŸ
 = (
os_vŸ_t
 *è
	`os_m®loc
((osip_via_t));

104 ià(*
vŸ
 =ğ
NULL
)

105  
OSIP_NOMEM
;

107 
	`mem£t
(*
vŸ
, 0, (
os_vŸ_t
));

109 
	`os_li¡_š™
(&(*
vŸ
)->
vŸ_·¿ms
);

111  
OSIP_SUCCESS
;

112 
	}
}

114 
	$os_vŸ_ä“
(
os_vŸ_t
 *
vŸ
) {

115 ià(
vŸ
 =ğ
NULL
)

118 
	`os_ä“
(
vŸ
->
v”siÚ
);

119 
	`os_ä“
(
vŸ
->
´ÙocŞ
);

120 
	`os_ä“
(
vŸ
->
ho¡
);

121 
	`os_ä“
(
vŸ
->
pÜt
);

122 
	`os_ä“
(
vŸ
->
comm’t
);

123 
	`os_g’”ic_·¿m_ä“li¡
(&
vŸ
->
vŸ_·¿ms
);

125 
	`os_ä“
(
vŸ
);

126 
	}
}

128 
	$os_vŸ_·r£
(
os_vŸ_t
 *
vŸ
, cÚ¡ *
hv®ue
) {

129 cÚ¡ *
v”siÚ
;

130 cÚ¡ *
´ÙocŞ
;

131 cÚ¡ *
ho¡
;

132 cÚ¡ *
v6ho¡
;

133 cÚ¡ *
pÜt
;

134 cÚ¡ *
vŸ_·¿ms
;

135 cÚ¡ *
comm’t
;

136 
i
;

138 ià(
hv®ue
 =ğ
NULL
)

139  
OSIP_BADPARAMETER
;

141 
v”siÚ
 = 
	`¡rchr
(
hv®ue
, '/');

143 ià(
v”siÚ
 =ğ
NULL
)

144  
OSIP_SYNTAXERROR
;

146 
´ÙocŞ
 = 
	`¡rchr
(
v”siÚ
 + 1, '/');

148 ià(
´ÙocŞ
 =ğ
NULL
)

149  
OSIP_SYNTAXERROR
;

152 ià(
´ÙocŞ
 - 
v”siÚ
 < 2)

153  
OSIP_SYNTAXERROR
;

155 
vŸ
->
v”siÚ
 = (*è
	`os_m®loc
(
´ÙocŞ
 - version);

157 ià(
vŸ
->
v”siÚ
 =ğ
NULL
)

158  
OSIP_NOMEM
;

160 
	`os_şºıy
(
vŸ
->
v”siÚ
, v”siÚ + 1, 
´ÙocŞ
 - version - 1);

163 
ho¡
 = 
	`¡rchr
(
´ÙocŞ
 + 1, ' ');

165 ià(
ho¡
 =ğ
NULL
)

166  
OSIP_SYNTAXERROR
;

168 ià(
ho¡
 =ğ
´ÙocŞ
 + 1) {

169 0 =ğ
	`¡ºcmp
(
ho¡
, " ", 1)) {

170 
ho¡
++;

172 ià(
	`¡¾’
(
ho¡
) <= 1)

173  
OSIP_SYNTAXERROR
;

177 
ho¡
 = 
	`¡rchr
(host + 1, ' ');

179 ià(
ho¡
 =ğ
NULL
)

180  
OSIP_SYNTAXERROR
;

184 ià(
ho¡
 - 
´ÙocŞ
 < 2)

185  
OSIP_SYNTAXERROR
;

187 
vŸ
->
´ÙocŞ
 = (*è
	`os_m®loc
(
ho¡
 -…rotocol);

189 ià(
vŸ
->
´ÙocŞ
 =ğ
NULL
)

190  
OSIP_NOMEM
;

192 
	`os_şºıy
(
vŸ
->
´ÙocŞ
,…rÙocŞ + 1, 
ho¡
 -…rotocol - 1);

195 
comm’t
 = 
	`¡rchr
(
ho¡
, '(');

197 ià(
comm’t
 !ğ
NULL
) {

198 *
’d_comm’t
;

200 
’d_comm’t
 = 
	`¡rchr
(
ho¡
, ')');

202 ià(
’d_comm’t
 =ğ
NULL
)

203  
OSIP_SYNTAXERROR
;

205 ià(
’d_comm’t
 - 
comm’t
 < 2)

206  
OSIP_SYNTAXERROR
;

208 
vŸ
->
comm’t
 = (*è
	`os_m®loc
(
’d_comm’t
 - comment);

210 ià(
vŸ
->
comm’t
 =ğ
NULL
)

211  
OSIP_NOMEM
;

213 
	`os_¡ºıy
(
vŸ
->
comm’t
, comm’ˆ+ 1, 
’d_comm’t
 - comment - 1);

214 
comm’t
--;

217 
comm’t
 = 
ho¡
 + 
	`¡¾’
(host);

219 
vŸ_·¿ms
 = 
	`¡rchr
(
ho¡
, ';');

221 ià((
vŸ_·¿ms
 !ğ
NULL
è&& (vŸ_·¿m < 
comm’t
))

224 *
tmp
;

226 ià(
comm’t
 - 
vŸ_·¿ms
 + 1 < 2)

227  
OSIP_SYNTAXERROR
;

229 
tmp
 = (*è
	`os_m®loc
(
comm’t
 - 
vŸ_·¿ms
 + 1);

231 ià(
tmp
 =ğ
NULL
)

232  
OSIP_NOMEM
;

234 
	`os_¡ºıy
(
tmp
, 
vŸ_·¿ms
, 
comm’t
 - via_params);

235 
i
 = 
	`__os_g’”ic_·¿m_·r£®l
(&
vŸ
->
vŸ_·¿ms
, 
tmp
);

237 ià(
i
 != 0) {

238 
	`os_ä“
(
tmp
);

239  
i
;

242 
	`os_ä“
(
tmp
);

245 ià(
vŸ_·¿ms
 =ğ
NULL
)

246 
vŸ_·¿ms
 = 
comm’t
;

250 
v6ho¡
 = 
	`¡rchr
(
ho¡
, '[');

252 ià(
v6ho¡
 !ğ
NULL
 && ipv6ho¡ < 
vŸ_·¿ms
) {

253 
pÜt
 = 
	`¡rchr
(
v6ho¡
, ']');

255 ià(
pÜt
 =ğ
NULL
 ||…Üˆ> 
vŸ_·¿ms
)

256  
OSIP_SYNTAXERROR
;

258 ià(
pÜt
 - 
v6ho¡
 < 2)

259  
OSIP_SYNTAXERROR
;

261 
vŸ
->
ho¡
 = (*è
	`os_m®loc
(
pÜt
 - 
v6ho¡
);

263 ià(
vŸ
->
ho¡
 =ğ
NULL
)

264  
OSIP_NOMEM
;

266 
	`os_şºıy
(
vŸ
->
ho¡
, 
v6ho¡
 + 1, 
pÜt
 - ipv6host - 1);

268 
pÜt
 = 
	`¡rchr
(port, ':');

271 
pÜt
 = 
	`¡rchr
(
ho¡
, ':');

272 
v6ho¡
 = 
NULL
;

275 ià((
pÜt
 !ğ
NULL
è&& (pÜˆ< 
vŸ_·¿ms
)) {

276 ià(
vŸ_·¿ms
 - 
pÜt
 < 2)

277  
OSIP_SYNTAXERROR
;

279 
vŸ
->
pÜt
 = (*è
	`os_m®loc
(
vŸ_·¿ms
 -…ort);

281 ià(
vŸ
->
pÜt
 =ğ
NULL
)

282  
OSIP_NOMEM
;

284 
	`os_şºıy
(
vŸ
->
pÜt
,…Üˆ+ 1, 
vŸ_·¿ms
 -…ort - 1);

286 ià(
	`os_©oi
(
vŸ
->
pÜt
) < 0)

287  
OSIP_SYNTAXERROR
;

290 
pÜt
 = 
vŸ_·¿ms
;

293 ià(
v6ho¡
 !ğ
NULL
)

294  
OSIP_SUCCESS
;

296 ià(
pÜt
 - 
ho¡
 < 2)

297  
OSIP_SYNTAXERROR
;

299 
vŸ
->
ho¡
 = (*è
	`os_m®loc
(
pÜt
 - host);

301 ià(
vŸ
->
ho¡
 =ğ
NULL
)

302  
OSIP_NOMEM
;

304 
	`os_şºıy
(
vŸ
->
ho¡
, ho¡ + 1, 
pÜt
 - host - 1);

306  
OSIP_SUCCESS
;

307 
	}
}

312 
	$os_vŸ_to_¡r
(cÚ¡ 
os_vŸ_t
 *
vŸ
, **
de¡
) {

313 *
buf
;

314 
size_t
 
Ën
;

315 
size_t
 
¶’
;

316 *
tmp
;

318 *
de¡
 = 
NULL
;

320 ià((
vŸ
 =ğ
NULL
è|| (vŸ->
ho¡
 =ğNULLè|| (vŸ->
v”siÚ
 =ğNULLè|| (vŸ->
´ÙocŞ
 == NULL))

321  
OSIP_BADPARAMETER
;

323 
Ën
 = 
	`¡¾’
(
vŸ
->
v”siÚ
è+ 1 + sŒËn(vŸ->
´ÙocŞ
) + 1 + 3 + 2;

324 
Ën
 =†’ + 
	`¡¾’
(
vŸ
->
ho¡
) + 3 + 1;

326 ià(
vŸ
->
pÜt
 !ğ
NULL
)

327 
Ën
 =†’ + 
	`¡¾’
(
vŸ
->
pÜt
) + 2;

329 
buf
 = (*è
	`os_m®loc
(
Ën
);

331 ià(
buf
 =ğ
NULL
)

332  
OSIP_NOMEM
;

334 ià(
	`¡rchr
(
vŸ
->
ho¡
, ':'è!ğ
NULL
) {

335 ià(
vŸ
->
pÜt
 =ğ
NULL
)

336 
	`¥rštf
(
buf
, "SIP/%s/% [%s]", 
vŸ
->
v”siÚ
, vŸ->
´ÙocŞ
, vŸ->
ho¡
);

339 
	`¥rštf
(
buf
, "SIP/%s/% [%s]:%s", 
vŸ
->
v”siÚ
, vŸ->
´ÙocŞ
, vŸ->
ho¡
, vŸ->
pÜt
);

342 ià(
vŸ
->
pÜt
 =ğ
NULL
)

343 
	`¥rštf
(
buf
, "SIP/%s/% %s", 
vŸ
->
v”siÚ
, vŸ->
´ÙocŞ
, vŸ->
ho¡
);

346 
	`¥rštf
(
buf
, "SIP/%s/% %s:%s", 
vŸ
->
v”siÚ
, vŸ->
´ÙocŞ
, vŸ->
ho¡
, vŸ->
pÜt
);

350 
os_li¡_™”©Ü_t
 
™
;

351 
os_g’”ic_·¿m_t
 *
u_·¿m
 = (os_g’”ic_·¿m_ˆ*è
	`os_li¡_g‘_fœ¡
(&
vŸ
->
vŸ_·¿ms
, &
™
);

353 
u_·¿m
 !ğ
OSIP_SUCCESS
) {

354 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

355 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
) + 2;

358 
¶’
 = 
	`¡¾’
(
u_·¿m
->
gÇme
è+ sŒËn(u_·¿m->
gv®ue
) + 3;

360 
Ën
 =†’ + 
¶’
;

361 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

362 
tmp
 = 
buf
;

363 
tmp
 =m°+ 
	`¡¾’
(tmp);

365 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

366 
	`¥rštf
(
tmp
, ";%s", 
u_·¿m
->
gÇme
);

369 
	`¥rštf
(
tmp
, ";%s=%s", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

371 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘_Ãxt
(&
™
);

375 ià(
vŸ
->
comm’t
 !ğ
NULL
) {

376 
Ën
 =†’ + 
	`¡¾’
(
vŸ
->
comm’t
) + 4;

377 
buf
 = (*è
	`os_»®loc
(buf, 
Ën
);

378 
tmp
 = 
buf
;

379 
tmp
 =m°+ 
	`¡¾’
(tmp);

380 
	`¢´štf
(
tmp
, 
Ën
 - (tm°- 
buf
), " (%s)", 
vŸ
->
comm’t
);

383 *
de¡
 = 
buf
;

384  
OSIP_SUCCESS
;

385 
	}
}

387 
	$vŸ_£t_v”siÚ
(
os_vŸ_t
 *
vŸ
, *
v”siÚ
) {

388 
vŸ
->
v”siÚ
 = version;

389 
	}
}

391 *
	$vŸ_g‘_v”siÚ
(
os_vŸ_t
 *
vŸ
) {

392 ià(
vŸ
 =ğ
NULL
)

393  
NULL
;

395  
vŸ
->
v”siÚ
;

396 
	}
}

398 
	$vŸ_£t_´ÙocŞ
(
os_vŸ_t
 *
vŸ
, *
´ÙocŞ
) {

399 
vŸ
->
´ÙocŞ
 =…rotocol;

400 
	}
}

402 *
	$vŸ_g‘_´ÙocŞ
(
os_vŸ_t
 *
vŸ
) {

403 ià(
vŸ
 =ğ
NULL
)

404  
NULL
;

406  
vŸ
->
´ÙocŞ
;

407 
	}
}

409 
	$vŸ_£t_ho¡
(
os_vŸ_t
 *
vŸ
, *
ho¡
) {

410 
vŸ
->
ho¡
 = host;

411 
	}
}

413 *
	$vŸ_g‘_ho¡
(
os_vŸ_t
 *
vŸ
) {

414 ià(
vŸ
 =ğ
NULL
)

415  
NULL
;

417  
vŸ
->
ho¡
;

418 
	}
}

420 
	$vŸ_£t_pÜt
(
os_vŸ_t
 *
vŸ
, *
pÜt
) {

421 
vŸ
->
pÜt
 =…ort;

422 
	}
}

424 *
	$vŸ_g‘_pÜt
(
os_vŸ_t
 *
vŸ
) {

425 ià(
vŸ
 =ğ
NULL
)

426  
NULL
;

428  
vŸ
->
pÜt
;

429 
	}
}

431 
	$vŸ_£t_comm’t
(
os_vŸ_t
 *
vŸ
, *
comm’t
) {

432 
vŸ
->
comm’t
 = comment;

433 
	}
}

435 *
	$vŸ_g‘_comm’t
(
os_vŸ_t
 *
vŸ
) {

436 ià(
vŸ
 =ğ
NULL
)

437  
NULL
;

439  
vŸ
->
comm’t
;

440 
	}
}

442 
	$os_vŸ_şÚe
(cÚ¡ 
os_vŸ_t
 *
vŸ
, os_vŸ_ˆ**
de¡
) {

443 
i
;

444 
os_vŸ_t
 *
vi
;

446 *
de¡
 = 
NULL
;

448 ià(
vŸ
 =ğ
NULL
)

449  
OSIP_BADPARAMETER
;

451 ià(
vŸ
->
v”siÚ
 =ğ
NULL
)

452  
OSIP_BADPARAMETER
;

454 ià(
vŸ
->
´ÙocŞ
 =ğ
NULL
)

455  
OSIP_BADPARAMETER
;

457 ià(
vŸ
->
ho¡
 =ğ
NULL
)

458  
OSIP_BADPARAMETER
;

460 
i
 = 
	`os_vŸ_š™
(&
vi
);

462 ià(
i
 != 0)

463  
i
;

465 
vi
->
v”siÚ
 = 
	`os_¡rdup
(
vŸ
->version);

467 ià(
vi
->
v”siÚ
 =ğ
NULL
 && 
vŸ
->version != NULL) {

468 
	`os_vŸ_ä“
(
vi
);

469  
OSIP_NOMEM
;

472 
vi
->
´ÙocŞ
 = 
	`os_¡rdup
(
vŸ
->protocol);

474 ià(
vi
->
´ÙocŞ
 =ğ
NULL
 && 
vŸ
->protocol != NULL) {

475 
	`os_vŸ_ä“
(
vi
);

476  
OSIP_NOMEM
;

479 
vi
->
ho¡
 = 
	`os_¡rdup
(
vŸ
->host);

481 ià(
vi
->
ho¡
 =ğ
NULL
 && 
vŸ
->host != NULL) {

482 
	`os_vŸ_ä“
(
vi
);

483  
OSIP_NOMEM
;

486 ià(
vŸ
->
pÜt
 !ğ
NULL
) {

487 
vi
->
pÜt
 = 
	`os_¡rdup
(
vŸ
->port);

489 ià(
vi
->
pÜt
 =ğ
NULL
) {

490 
	`os_vŸ_ä“
(
vi
);

491  
OSIP_NOMEM
;

495 ià(
vŸ
->
comm’t
 !ğ
NULL
) {

496 
vi
->
comm’t
 = 
	`os_¡rdup
(
vŸ
->comment);

498 ià(
vi
->
comm’t
 =ğ
NULL
) {

499 
	`os_vŸ_ä“
(
vi
);

500  
OSIP_NOMEM
;

504 
i
 = 
	`os_li¡_şÚe
(&
vŸ
->
vŸ_·¿ms
, &
vi
->vŸ_·¿ms, ((*)(*, **)è& 
os_g’”ic_·¿m_şÚe
);

506 ià(
i
 != 0) {

507 
	`os_vŸ_ä“
(
vi
);

508  
i
;

511 *
de¡
 = 
vi
;

512  
OSIP_SUCCESS
;

513 
	}
}

515 
	$os_vŸ_m©ch
(
os_vŸ_t
 *
vŸ1
, os_vŸ_ˆ*
vŸ2
) {

521 *
_vŸ1
;

522 *
_vŸ2
;

523 
i
;

525 ià(
vŸ1
 =ğ
NULL
 || 
vŸ2
 == NULL)

526  
OSIP_BADPARAMETER
;

528 
i
 = 
	`os_vŸ_to_¡r
(
vŸ1
, &
_vŸ1
);

530 ià(
i
 != 0)

531  
i
;

533 
i
 = 
	`os_vŸ_to_¡r
(
vŸ2
, &
_vŸ2
);

535 ià(
i
 != 0) {

536 
	`os_ä“
(
_vŸ1
);

537  
i
;

540 
i
 = 
	`¡rcmp
(
_vŸ1
, 
_vŸ2
);

541 
	`os_ä“
(
_vŸ1
);

542 
	`os_ä“
(
_vŸ2
);

544 ià(
i
 != 0)

545  
OSIP_UNDEFINED_ERROR
;

547  
OSIP_SUCCESS
;

548 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_www_authenticate.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_pÜt.h
>

23 
	~<os·r£r2/os_mes§ge.h
>

24 
	~<os·r£r2/os_·r£r.h
>

25 
	~"·r£r.h
"

27 
	$os_www_auth’tiÿ‹_š™
(
os_www_auth’tiÿ‹_t
 **
de¡
) {

28 *
de¡
 = (
os_www_auth’tiÿ‹_t
 *è
	`os_m®loc
((osip_www_authenticate_t));

30 ià(*
de¡
 =ğ
NULL
)

31  
OSIP_NOMEM
;

33 
	`mem£t
(*
de¡
, 0, (
os_www_auth’tiÿ‹_t
));

34  
OSIP_SUCCESS
;

35 
	}
}

41 
	$os_mes§ge_£t_www_auth’tiÿ‹
(
os_mes§ge_t
 *
s
, cÚ¡ *
hv®ue
) {

42 
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
;

43 
i
;

45 ià(
hv®ue
 =ğ
NULL
 || hvalue[0] == '\0')

46  
OSIP_SUCCESS
;

48 ià(
s
 =ğ
NULL
)

49  
OSIP_BADPARAMETER
;

51 
i
 = 
	`os_www_auth’tiÿ‹_š™
(&
www_auth’tiÿ‹
);

53 ià(
i
 != 0)

54  
i
;

56 
i
 = 
	`os_www_auth’tiÿ‹_·r£
(
www_auth’tiÿ‹
, 
hv®ue
);

58 ià(
i
 != 0) {

59 
	`os_www_auth’tiÿ‹_ä“
(
www_auth’tiÿ‹
);

60  
i
;

63 
s
->
mes§ge_´İ”ty
 = 2;

64 
	`os_li¡_add
(&
s
->
www_auth’tiÿ‹s
, 
www_auth’tiÿ‹
, -1);

65  
OSIP_SUCCESS
;

66 
	}
}

68 
	$__os_quÙed_¡ršg_£t
(cÚ¡ *
Çme
, cÚ¡ *
¡r
, **
»suÉ
, cÚ¡ **
Ãxt
) {

69 *
Ãxt
 = 
¡r
;

71 ià(*
»suÉ
 !ğ
NULL
)

72  
OSIP_SUCCESS
;

74 *
Ãxt
 = 
NULL
;

76 (' ' =ğ*
¡r
) || ('\t' == *str) || (',' == *str))

77 ià(*
¡r
)

78 
¡r
++;

81  
OSIP_SYNTAXERROR
;

83 ià(
	`os_¡ºÿ£cmp
(
Çme
, 
¡r
, 
	`¡¾’
(name)) == 0) {

84 cÚ¡ *
quÙe1
;

85 cÚ¡ *
quÙe2
;

86 cÚ¡ *
tmp
;

87 cÚ¡ *
hack
 = 
	`¡rchr
(
¡r
, '=');

89 ià(
hack
 =ğ
NULL
)

90  
OSIP_SYNTAXERROR
;

92 ' ' =ğ*(
hack
 - 1))

93 
hack
--;

95 ià((
size_t
)(
hack
 - 
¡r
è!ğ
	`¡¾’
(
Çme
)) {

96 *
Ãxt
 = 
¡r
;

97  
OSIP_SUCCESS
;

100 
quÙe1
 = 
	`__os_quÙe_fšd
(
¡r
);

102 ià(
quÙe1
 =ğ
NULL
)

103  
OSIP_SYNTAXERROR
;

105 
quÙe2
 = 
	`__os_quÙe_fšd
(
quÙe1
 + 1);

107 ià(
quÙe2
 =ğ
NULL
)

108  
OSIP_SYNTAXERROR
;

110 ià(
quÙe2
 - 
quÙe1
 == 1) {

116 
tmp
 = 
quÙe2
 + 1;

117 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

118 
tmp
 +ğ
	`¡r¥n
(tmp, "\n\r");

119 *
Ãxt
 = 
NULL
;

121 ià(*
tmp
 == '\0')

122  
OSIP_SUCCESS
;

124 ià(*
tmp
 != '\t' && *tmp != ' ')

126 *
Ãxt
 = 
tmp
;

129 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

131 ià(*
tmp
 == '\0')

132  
OSIP_SUCCESS
;

134 *
Ãxt
 = 
tmp
;

137  
OSIP_SUCCESS
;

140 *
»suÉ
 = (*è
	`os_m®loc
(
quÙe2
 - 
quÙe1
 + 3);

142 ià(*
»suÉ
 =ğ
NULL
)

143  
OSIP_NOMEM
;

145 
	`os_¡ºıy
(*
»suÉ
, 
quÙe1
, 
quÙe2
 - quote1 + 1);

146 
tmp
 = 
quÙe2
 + 1;

147 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

148 
tmp
 +ğ
	`¡r¥n
(tmp, "\n\r");

149 *
Ãxt
 = 
NULL
;

151 ià(*
tmp
 == '\0')

152  
OSIP_SUCCESS
;

154 ià(*
tmp
 != '\t' && *tmp != ' ')

156 *
Ãxt
 = 
tmp
;

159 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

161 ià(*
tmp
 == '\0')

162  
OSIP_SUCCESS
;

164 *
Ãxt
 = 
tmp
;

168 *
Ãxt
 = 
¡r
;

170  
OSIP_SUCCESS
;

171 
	}
}

173 
	$__os_tok’_£t
(cÚ¡ *
Çme
, cÚ¡ *
¡r
, **
»suÉ
, cÚ¡ **
Ãxt
) {

174 cÚ¡ *
beg
;

175 cÚ¡ *
tmp
;

177 *
Ãxt
 = 
¡r
;

179 ià(*
»suÉ
 !ğ
NULL
)

180  
OSIP_SUCCESS
;

182 *
Ãxt
 = 
NULL
;

184 
beg
 = 
	`¡rchr
(
¡r
, '=');

186 ià(
beg
 =ğ
NULL
)

187  
OSIP_SYNTAXERROR
;

189 ià(
	`¡¾’
(
¡r
) < 6)

190  
OSIP_SUCCESS
;

192 (' ' =ğ*
¡r
) || ('\t' == *str) || (',' == *str))

193 ià(*
¡r
)

194 
¡r
++;

197  
OSIP_SYNTAXERROR
;

199 ià(
	`os_¡ºÿ£cmp
(
Çme
, 
¡r
, 
	`¡¾’
(name)) == 0) {

200 cÚ¡ *
’d
;

202 
’d
 = 
	`¡rchr
(
¡r
, ',');

204 ià(
’d
 =ğ
NULL
)

205 
’d
 = 
¡r
 + 
	`¡¾’
(str);

207 ià(
’d
 - 
beg
 < 2)

208  
OSIP_SYNTAXERROR
;

210 *
»suÉ
 = (*è
	`os_m®loc
(
’d
 - 
beg
);

212 ià(*
»suÉ
 =ğ
NULL
)

213  
OSIP_NOMEM
;

215 
	`os_şºıy
(*
»suÉ
, 
beg
 + 1, 
’d
 - beg - 1);

218 
tmp
 = (*
’d
) ? (end + 1) :ƒnd;

219 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

220 
tmp
 +ğ
	`¡r¥n
(tmp, "\n\r");

221 *
Ãxt
 = 
NULL
;

223 ià(*
tmp
 == '\0')

224  
OSIP_SUCCESS
;

226 ià(*
tmp
 != '\t' && *tmp != ' ')

228 *
Ãxt
 = 
tmp
;

231 
tmp
 +ğ
	`¡r¥n
(tmp, " \t");

233 ià(*
tmp
 == '\0')

234  
OSIP_SUCCESS
;

236 *
Ãxt
 = 
tmp
;

240 *
Ãxt
 = 
¡r
;

242  
OSIP_SUCCESS
;

243 
	}
}

253 
	$os_www_auth’tiÿ‹_·r£
(
os_www_auth’tiÿ‹_t
 *
wwwa
, cÚ¡ *
hv®ue
) {

254 cÚ¡ *
¥aû
;

255 cÚ¡ *
Ãxt
 = 
NULL
;

256 
i
;

258 
¥aû
 = 
	`¡rchr
(
hv®ue
, ' ');

260 ià(
¥aû
 =ğ
NULL
)

261  
OSIP_SYNTAXERROR
;

263 ià(
¥aû
 - 
hv®ue
 + 1 < 2)

264  
OSIP_SYNTAXERROR
;

266 
wwwa
->
auth_ty³
 = (*è
	`os_m®loc
(
¥aû
 - 
hv®ue
 + 1);

268 ià(
wwwa
->
auth_ty³
 =ğ
NULL
)

269  
OSIP_NOMEM
;

271 
	`os_¡ºıy
(
wwwa
->
auth_ty³
, 
hv®ue
, 
¥aû
 - hvalue);

274 
·r£_ok
 = 0;

276 
i
 = 
	`__os_quÙed_¡ršg_£t
("»®m", 
¥aû
, &(
wwwa
->
»®m
), &
Ãxt
);

278 ià(
i
 != 0)

279  
i
;

281 ià(
Ãxt
 =ğ
NULL
)

282  
OSIP_SUCCESS
;

283 ià(
Ãxt
 !ğ
¥aû
) {

284 
¥aû
 = 
Ãxt
;

285 
·r£_ok
++;

288 
i
 = 
	`__os_quÙed_¡ršg_£t
("domaš", 
¥aû
, &(
wwwa
->
domaš
), &
Ãxt
);

290 ià(
i
 != 0)

291  
i
;

293 ià(
Ãxt
 =ğ
NULL
)

294  
OSIP_SUCCESS
;

295 ià(
Ãxt
 !ğ
¥aû
) {

296 
¥aû
 = 
Ãxt
;

297 
·r£_ok
++;

300 
i
 = 
	`__os_quÙed_¡ršg_£t
("nÚû", 
¥aû
, &(
wwwa
->
nÚû
), &
Ãxt
);

302 ià(
i
 != 0)

303  
i
;

305 ià(
Ãxt
 =ğ
NULL
)

306  
OSIP_SUCCESS
;

307 ià(
Ãxt
 !ğ
¥aû
) {

308 
¥aû
 = 
Ãxt
;

309 
·r£_ok
++;

312 
i
 = 
	`__os_quÙed_¡ršg_£t
("İaque", 
¥aû
, &(
wwwa
->
İaque
), &
Ãxt
);

314 ià(
i
 != 0)

315  
i
;

317 ià(
Ãxt
 =ğ
NULL
)

318  
OSIP_SUCCESS
;

319 ià(
Ãxt
 !ğ
¥aû
) {

320 
¥aû
 = 
Ãxt
;

321 
·r£_ok
++;

324 
i
 = 
	`__os_tok’_£t
("¡®e", 
¥aû
, &(
wwwa
->
¡®e
), &
Ãxt
);

326 ià(
i
 != 0)

327  
i
;

329 ià(
Ãxt
 =ğ
NULL
)

330  
OSIP_SUCCESS
;

331 ià(
Ãxt
 !ğ
¥aû
) {

332 
¥aû
 = 
Ãxt
;

333 
·r£_ok
++;

336 
i
 = 
	`__os_tok’_£t
("®gÜ™hm", 
¥aû
, &(
wwwa
->
®gÜ™hm
), &
Ãxt
);

338 ià(
i
 != 0)

339  
i
;

341 ià(
Ãxt
 =ğ
NULL
)

342  
OSIP_SUCCESS
;

343 ià(
Ãxt
 !ğ
¥aû
) {

344 
¥aû
 = 
Ãxt
;

345 
·r£_ok
++;

348 
i
 = 
	`__os_quÙed_¡ršg_£t
("qİ", 
¥aû
, &(
wwwa
->
qİ_İtiÚs
), &
Ãxt
);

350 ià(
i
 != 0)

351  
i
;

353 ià(
Ãxt
 =ğ
NULL
)

354  
OSIP_SUCCESS
;

355 ià(
Ãxt
 !ğ
¥aû
) {

356 
¥aû
 = 
Ãxt
;

357 
·r£_ok
++;

360 
i
 = 
	`__os_tok’_£t
("v”siÚ", 
¥aû
, &(
wwwa
->
v”siÚ
), &
Ãxt
);

362 ià(
i
 != 0)

363  
i
;

365 ià(
Ãxt
 =ğ
NULL
)

366  
OSIP_SUCCESS
;

367 ià(
Ãxt
 !ğ
¥aû
) {

368 
¥aû
 = 
Ãxt
;

369 
·r£_ok
++;

372 
i
 = 
	`__os_quÙed_¡ršg_£t
("rg‘Çme", 
¥aû
, &(
wwwa
->
rg‘Çme
), &
Ãxt
);

374 ià(
i
 != 0)

375  
i
;

377 ià(
Ãxt
 =ğ
NULL
)

378  
OSIP_SUCCESS
;

379 ià(
Ãxt
 !ğ
¥aû
) {

380 
¥aû
 = 
Ãxt
;

381 
·r£_ok
++;

384 
i
 = 
	`__os_quÙed_¡ršg_£t
("gs§pi-d©a", 
¥aû
, &(
wwwa
->
gs§pi_d©a
), &
Ãxt
);

386 ià(
i
 != 0)

387  
i
;

389 ià(
Ãxt
 =ğ
NULL
)

390  
OSIP_SUCCESS
;

391 ià(
Ãxt
 !ğ
¥aû
) {

392 
¥aû
 = 
Ãxt
;

393 
·r£_ok
++;

396 ià(0 =ğ
·r£_ok
) {

397 cÚ¡ *
quÙe1
, *
quÙe2
, *
tmp
;

402 ià(
	`¡¾’
(
¥aû
) < 1)

403  
OSIP_SUCCESS
;

405 
tmp
 = 
	`¡rchr
(
¥aû
 + 1, ',');

407 ià(
tmp
 =ğ
NULL
)

408  
OSIP_SUCCESS
;

410 
quÙe1
 = 
	`__os_quÙe_fšd
(
¥aû
);

412 ià((
quÙe1
 !ğ
NULL
è&& (quÙe1 < 
tmp
)) {

413 
quÙe2
 = 
	`__os_quÙe_fšd
(
quÙe1
 + 1);

415 ià(
quÙe2
 =ğ
NULL
)

416  
OSIP_SYNTAXERROR
;

418 ià(
tmp
 < 
quÙe2
)

419 
¥aû
 = 
	`¡rchr
(
quÙe2
, ',');

422 
¥aû
 = 
tmp
;

424 ià(
¥aû
 =ğ
NULL
)

425  
OSIP_SUCCESS
;

428 
¥aû
 = 
tmp
;

434  
OSIP_SUCCESS
;

435 
	}
}

437 #iâdeà
MINISIZE


441 
	$os_mes§ge_g‘_www_auth’tiÿ‹
(cÚ¡ 
os_mes§ge_t
 *
s
, 
pos
, 
os_www_auth’tiÿ‹_t
 **
de¡
) {

442 
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
;

444 *
de¡
 = 
NULL
;

446 ià(
	`os_li¡_size
(&
s
->
www_auth’tiÿ‹s
è<ğ
pos
)

447  
OSIP_UNDEFINED_ERROR
;

449 
www_auth’tiÿ‹
 = (
os_www_auth’tiÿ‹_t
 *è
	`os_li¡_g‘
(&
s
->
www_auth’tiÿ‹s
, 
pos
);

451 *
de¡
 = 
www_auth’tiÿ‹
;

452  
pos
;

453 
	}
}

456 *
	$os_www_auth’tiÿ‹_g‘_auth_ty³
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

457  
www_auth’tiÿ‹
->
auth_ty³
;

458 
	}
}

460 
	$os_www_auth’tiÿ‹_£t_auth_ty³
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
auth_ty³
) {

461 
www_auth’tiÿ‹
->
auth_ty³
 = (*)‡uth_type;

462 
	}
}

464 *
	$os_www_auth’tiÿ‹_g‘_»®m
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

465  
www_auth’tiÿ‹
->
»®m
;

466 
	}
}

468 
	$os_www_auth’tiÿ‹_£t_»®m
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
»®m
) {

469 
www_auth’tiÿ‹
->
»®m
 = (*)„ealm;

470 
	}
}

472 *
	$os_www_auth’tiÿ‹_g‘_domaš
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

473  
www_auth’tiÿ‹
->
domaš
;

474 
	}
}

476 
	$os_www_auth’tiÿ‹_£t_domaš
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
domaš
) {

477 
www_auth’tiÿ‹
->
domaš
 = (*) domain;

478 
	}
}

480 *
	$os_www_auth’tiÿ‹_g‘_nÚû
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

481  
www_auth’tiÿ‹
->
nÚû
;

482 
	}
}

484 
	$os_www_auth’tiÿ‹_£t_nÚû
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
nÚû
) {

485 
www_auth’tiÿ‹
->
nÚû
 = (*)‚once;

486 
	}
}

488 *
	$os_www_auth’tiÿ‹_g‘_¡®e
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

489  
www_auth’tiÿ‹
->
¡®e
;

490 
	}
}

492 
	$os_www_auth’tiÿ‹_£t_¡®e
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
¡®e
) {

493 
www_auth’tiÿ‹
->
¡®e
 = (*) stale;

494 
	}
}

496 *
	$os_www_auth’tiÿ‹_g‘_İaque
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

497  
www_auth’tiÿ‹
->
İaque
;

498 
	}
}

500 
	$os_www_auth’tiÿ‹_£t_İaque
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
İaque
) {

501 
www_auth’tiÿ‹
->
İaque
 = (*) opaque;

502 
	}
}

504 *
	$os_www_auth’tiÿ‹_g‘_®gÜ™hm
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

505  
www_auth’tiÿ‹
->
®gÜ™hm
;

506 
	}
}

508 
	$os_www_auth’tiÿ‹_£t_®gÜ™hm
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
®gÜ™hm
) {

509 
www_auth’tiÿ‹
->
®gÜ™hm
 = (*)‡lgorithm;

510 
	}
}

512 *
	$os_www_auth’tiÿ‹_g‘_qİ_İtiÚs
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

513  
www_auth’tiÿ‹
->
qİ_İtiÚs
;

514 
	}
}

516 
	$os_www_auth’tiÿ‹_£t_qİ_İtiÚs
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
qİ_İtiÚs
) {

517 
www_auth’tiÿ‹
->
qİ_İtiÚs
 = (*) qop_options;

518 
	}
}

520 *
	$os_www_auth’tiÿ‹_g‘_v”siÚ
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

521  
www_auth’tiÿ‹
->
v”siÚ
;

522 
	}
}

524 
	$os_www_auth’tiÿ‹_£t_v”siÚ
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
v”siÚ
) {

525 
www_auth’tiÿ‹
->
v”siÚ
 = (*) version;

526 
	}
}

528 *
	$os_www_auth’tiÿ‹_g‘_rg‘Çme
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

529  
www_auth’tiÿ‹
->
rg‘Çme
;

530 
	}
}

532 
	$os_www_auth’tiÿ‹_£t_rg‘Çme
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
rg‘Çme
) {

533 
www_auth’tiÿ‹
->
rg‘Çme
 = (*)argetname;

534 
	}
}

536 *
	$os_www_auth’tiÿ‹_g‘_gs§pi_d©a
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

537  
www_auth’tiÿ‹
->
gs§pi_d©a
;

538 
	}
}

540 
	$os_www_auth’tiÿ‹_£t_gs§pi_d©a
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
, *
gs§pi_d©a
) {

541 
www_auth’tiÿ‹
->
gs§pi_d©a
 = (*) gssapi_data;

542 
	}
}

547 
	$os_www_auth’tiÿ‹_to_¡r
(cÚ¡ 
os_www_auth’tiÿ‹_t
 *
wwwa
, **
de¡
) {

548 
size_t
 
Ën
;

549 *
tmp
;

551 *
de¡
 = 
NULL
;

553 ià((
wwwa
 =ğ
NULL
è|| (wwwa->
auth_ty³
 == NULL))

554  
OSIP_BADPARAMETER
;

556 
Ën
 = 
	`¡¾’
(
wwwa
->
auth_ty³
) + 1;

558 ià(
wwwa
->
»®m
 !ğ
NULL
)

559 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
»®m
) + 7;

561 ià(
wwwa
->
nÚû
 !ğ
NULL
)

562 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
nÚû
) + 8;

564 
Ën
 =†en + 2;

566 ià(
wwwa
->
domaš
 !ğ
NULL
)

567 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
domaš
) + 9;

569 ià(
wwwa
->
İaque
 !ğ
NULL
)

570 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
İaque
) + 9;

572 ià(
wwwa
->
¡®e
 !ğ
NULL
)

573 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
¡®e
) + 8;

575 ià(
wwwa
->
®gÜ™hm
 !ğ
NULL
)

576 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
®gÜ™hm
) + 12;

578 ià(
wwwa
->
qİ_İtiÚs
 !ğ
NULL
)

579 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
qİ_İtiÚs
) + 6;

581 ià(
wwwa
->
v”siÚ
 !ğ
NULL
)

582 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
v”siÚ
) + 10;

584 ià(
wwwa
->
rg‘Çme
 !ğ
NULL
)

585 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
rg‘Çme
) + 13;

587 ià(
wwwa
->
gs§pi_d©a
 !ğ
NULL
)

588 
Ën
 =†’ + 
	`¡¾’
(
wwwa
->
gs§pi_d©a
) + 14;

590 
tmp
 = (*è
	`os_m®loc
(
Ën
);

592 ià(
tmp
 =ğ
NULL
)

593  
OSIP_NOMEM
;

595 *
de¡
 = 
tmp
;

597 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
auth_ty³
);

599 ià(
wwwa
->
»®m
 !ğ
NULL
) {

600 
tmp
 = 
	`os_¡º_­³nd
(tmp, "„ealm=", 7);

601 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
»®m
);

604 ià(
wwwa
->
domaš
 !ğ
NULL
) {

605 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", domain=", 9);

606 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
domaš
);

609 ià(
wwwa
->
nÚû
 !ğ
NULL
) {

610 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",‚once=", 8);

611 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
nÚû
);

614 ià(
wwwa
->
İaque
 !ğ
NULL
) {

615 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", opaque=", 9);

616 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
İaque
);

619 ià(
wwwa
->
¡®e
 !ğ
NULL
) {

620 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", stale=", 8);

621 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
¡®e
);

624 ià(
wwwa
->
®gÜ™hm
 !ğ
NULL
) {

625 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",‡lgorithm=", 12);

626 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
®gÜ™hm
);

629 ià(
wwwa
->
qİ_İtiÚs
 !ğ
NULL
) {

630 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", qop=", 6);

631 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
qİ_İtiÚs
);

634 ià(
wwwa
->
v”siÚ
 !ğ
NULL
) {

635 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", version=", 10);

636 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
v”siÚ
);

639 ià(
wwwa
->
rg‘Çme
 !ğ
NULL
) {

640 
tmp
 = 
	`os_¡º_­³nd
(tmp, ",argetname=", 13);

641 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
rg‘Çme
);

644 ià(
wwwa
->
gs§pi_d©a
 !ğ
NULL
) {

645 
tmp
 = 
	`os_¡º_­³nd
(tmp, ", gssapi-data=", 14);

646 
tmp
 = 
	`os_¡r_­³nd
Ñmp, 
wwwa
->
gs§pi_d©a
);

649 ià(
wwwa
->
»®m
 =ğ
NULL
) {

651 
Ën
 = 
	`¡¾’
(
wwwa
->
auth_ty³
);

653 ià((*
de¡
)[
Ën
] == ',')

654 (*
de¡
)[
Ën
] = ' ';

657  
OSIP_SUCCESS
;

658 
	}
}

662 
	$os_www_auth’tiÿ‹_ä“
(
os_www_auth’tiÿ‹_t
 *
www_auth’tiÿ‹
) {

663 ià(
www_auth’tiÿ‹
 =ğ
NULL
)

666 
	`os_ä“
(
www_auth’tiÿ‹
->
auth_ty³
);

667 
	`os_ä“
(
www_auth’tiÿ‹
->
»®m
);

668 
	`os_ä“
(
www_auth’tiÿ‹
->
domaš
);

669 
	`os_ä“
(
www_auth’tiÿ‹
->
nÚû
);

670 
	`os_ä“
(
www_auth’tiÿ‹
->
İaque
);

671 
	`os_ä“
(
www_auth’tiÿ‹
->
¡®e
);

672 
	`os_ä“
(
www_auth’tiÿ‹
->
®gÜ™hm
);

673 
	`os_ä“
(
www_auth’tiÿ‹
->
qİ_İtiÚs
);

674 
	`os_ä“
(
www_auth’tiÿ‹
->
v”siÚ
);

675 
	`os_ä“
(
www_auth’tiÿ‹
->
rg‘Çme
);

676 
	`os_ä“
(
www_auth’tiÿ‹
->
gs§pi_d©a
);

678 
	`os_ä“
(
www_auth’tiÿ‹
);

679 
	}
}

681 
	$os_www_auth’tiÿ‹_şÚe
(cÚ¡ 
os_www_auth’tiÿ‹_t
 *
wwwa
, os_www_auth’tiÿ‹_ˆ**
de¡
) {

682 
i
;

683 
os_www_auth’tiÿ‹_t
 *
wa
;

685 *
de¡
 = 
NULL
;

687 ià(
wwwa
 =ğ
NULL
)

688  
OSIP_BADPARAMETER
;

690 ià(
wwwa
->
auth_ty³
 =ğ
NULL
)

691  
OSIP_BADPARAMETER
;

693 
i
 = 
	`os_www_auth’tiÿ‹_š™
(&
wa
);

695 ià(
i
 != 0)

696  
i
;

698 
wa
->
auth_ty³
 = 
	`os_¡rdup
(
wwwa
->auth_type);

700 ià(
wa
->
auth_ty³
 =ğ
NULL
 && 
wwwa
->auth_type != NULL) {

701 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

702  
OSIP_NOMEM
;

705 ià(
wwwa
->
»®m
 !ğ
NULL
)

706 
wa
->
»®m
 = 
	`os_¡rdup
(
wwwa
->realm);

708 ià(
wa
->
»®m
 =ğ
NULL
 && 
wwwa
->realm != NULL) {

709 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

710  
OSIP_NOMEM
;

713 ià(
wwwa
->
domaš
 !ğ
NULL
)

714 
wa
->
domaš
 = 
	`os_¡rdup
(
wwwa
->domain);

716 ià(
wa
->
domaš
 =ğ
NULL
 && 
wwwa
->domain != NULL) {

717 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

718  
OSIP_NOMEM
;

721 ià(
wwwa
->
nÚû
 !ğ
NULL
)

722 
wa
->
nÚû
 = 
	`os_¡rdup
(
wwwa
->nonce);

724 ià(
wa
->
nÚû
 =ğ
NULL
 && 
wwwa
->nonce != NULL) {

725 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

726  
OSIP_NOMEM
;

729 ià(
wwwa
->
İaque
 !ğ
NULL
)

730 
wa
->
İaque
 = 
	`os_¡rdup
(
wwwa
->opaque);

732 ià(
wa
->
İaque
 =ğ
NULL
 && 
wwwa
->opaque != NULL) {

733 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

734  
OSIP_NOMEM
;

737 ià(
wwwa
->
¡®e
 !ğ
NULL
)

738 
wa
->
¡®e
 = 
	`os_¡rdup
(
wwwa
->stale);

740 ià(
wa
->
¡®e
 =ğ
NULL
 && 
wwwa
->stale != NULL) {

741 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

742  
OSIP_NOMEM
;

745 ià(
wwwa
->
®gÜ™hm
 !ğ
NULL
)

746 
wa
->
®gÜ™hm
 = 
	`os_¡rdup
(
wwwa
->algorithm);

748 ià(
wa
->
®gÜ™hm
 =ğ
NULL
 && 
wwwa
->algorithm != NULL) {

749 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

750  
OSIP_NOMEM
;

753 ià(
wwwa
->
qİ_İtiÚs
 !ğ
NULL
)

754 
wa
->
qİ_İtiÚs
 = 
	`os_¡rdup
(
wwwa
->qop_options);

756 ià(
wa
->
qİ_İtiÚs
 =ğ
NULL
 && 
wwwa
->qop_options != NULL) {

757 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

758  
OSIP_NOMEM
;

761 ià(
wwwa
->
v”siÚ
 !ğ
NULL
)

762 
wa
->
v”siÚ
 = 
	`os_¡rdup
(
wwwa
->version);

764 ià(
wa
->
v”siÚ
 =ğ
NULL
 && 
wwwa
->version != NULL) {

765 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

766  
OSIP_NOMEM
;

769 ià(
wwwa
->
rg‘Çme
 !ğ
NULL
)

770 
wa
->
rg‘Çme
 = 
	`os_¡rdup
(
wwwa
->targetname);

772 ià(
wa
->
rg‘Çme
 =ğ
NULL
 && 
wwwa
->targetname != NULL) {

773 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

774  
OSIP_NOMEM
;

777 ià(
wwwa
->
gs§pi_d©a
 !ğ
NULL
)

778 
wa
->
gs§pi_d©a
 = 
	`os_¡rdup
(
wwwa
->gssapi_data);

780 ià(
wa
->
gs§pi_d©a
 =ğ
NULL
 && 
wwwa
->gssapi_data != NULL) {

781 
	`os_www_auth’tiÿ‹_ä“
(
wa
);

782  
OSIP_NOMEM
;

785 *
de¡
 = 
wa
;

786  
OSIP_SUCCESS
;

787 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/parser.h

20 #iâdeà
_MSG_H_


21 
	#_MSG_H_


	)

23 #iâdeà
DOXYGEN


25 #iâdeà
MINISIZE


26 
	#NUMBER_OF_HEADERS
 33

	)

28 
	#NUMBER_OF_HEADERS
 22

	)

31 #iâdeà
NUMBER_OF_HEADERS_COMMASEPARATED


32 
	#NUMBER_OF_HEADERS_COMMASEPARATED
 256

	)

36 
	s___os_mes§ge_cÚfig_t
 {

37 *
	mhÇme
;

38 (*
	m£th—d”
)(
	mos_mes§ge_t
 *, const *);

39 
	mignÜed_wh’_šv®id
;

40 } 
	t__os_mes§ge_cÚfig_t
;

42 
	s___os_mes§ge_cÚfig_comma£·¿‹d_t
 {

43 
	mhÇme
[256];

44 } 
	t__os_mes§ge_cÚfig_comma£·¿‹d_t
;

46 
__os_mes§ge_ÿÎ_m‘hod
(
i
, 
os_mes§ge_t
 *
de¡
, cÚ¡ *
hv®ue
);

47 
__os_mes§ge_is_h—d”_comma_£·¿‹d
(cÚ¡ *
hÇme
);

48 
__os_mes§ge_is_known_h—d”
(cÚ¡ *
hÇme
);

50 
__os_fšd_Ãxt_occu»nû
(cÚ¡ *
¡r
, cÚ¡ *
buf
, cÚ¡ **
šdex_of_¡r
, cÚ¡ *
’d_of_buf
);

51 
__os_fšd_Ãxt_ülf
(cÚ¡ *
¡¬t_of_h—d”
, cÚ¡ **
’d_of_h—d”
);

52 
__os_fšd_Ãxt_ülfülf
(cÚ¡ *
¡¬t_of_·¹
, cÚ¡ **
’d_of_·¹
);

54 
__os_quÙed_¡ršg_£t
(cÚ¡ *
Çme
, cÚ¡ *
¡r
, **
»suÉ
, cÚ¡ **
Ãxt
);

55 
__os_tok’_£t
(cÚ¡ *
Çme
, cÚ¡ *
¡r
, **
»suÉ
, cÚ¡ **
Ãxt
);

57 
__os_g’”ic_·¿m_·r£®l
(
os_li¡_t
 *
g’_·¿ms
, cÚ¡ *
·¿ms
);

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_accessor.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_cÚ¡.h
>

23 
	~<os·r£r2/os_pÜt.h
>

24 
	~<os·r£r2/sdp_mes§ge.h
>

26 
	$sdp_mes§ge_v_v”siÚ_£t
(
sdp_mes§ge_t
 *
sdp
, *
v_v”siÚ
) {

27 ià(
sdp
 =ğ
NULL
)

28  
OSIP_BADPARAMETER
;

30 
sdp
->
v_v”siÚ
 = v_version;

31  
OSIP_SUCCESS
;

32 
	}
}

34 *
	$sdp_mes§ge_v_v”siÚ_g‘
(
sdp_mes§ge_t
 *
sdp
) {

35 ià(
sdp
 =ğ
NULL
)

36  
NULL
;

38  
sdp
->
v_v”siÚ
;

39 
	}
}

41 
	$sdp_mes§ge_o_Üigš_£t
(
sdp_mes§ge_t
 *
sdp
, *
u£ºame
, *
£ss_id
, *
£ss_v”siÚ
, *
Ã‰y³
, *
add¹y³
, *
addr
) {

42 ià(
sdp
 =ğ
NULL
)

43  
OSIP_BADPARAMETER
;

45 
sdp
->
o_u£ºame
 = 
u£ºame
;

46 
sdp
->
o_£ss_id
 = 
£ss_id
;

47 
sdp
->
o_£ss_v”siÚ
 = 
£ss_v”siÚ
;

48 
sdp
->
o_Ã‰y³
 = 
Ã‰y³
;

49 
sdp
->
o_add¹y³
 = 
add¹y³
;

50 
sdp
->
o_addr
 = 
addr
;

51  
OSIP_SUCCESS
;

52 
	}
}

54 *
	$sdp_mes§ge_o_u£ºame_g‘
(
sdp_mes§ge_t
 *
sdp
) {

55 ià(
sdp
 =ğ
NULL
)

56  
NULL
;

58  
sdp
->
o_u£ºame
;

59 
	}
}

61 *
	$sdp_mes§ge_o_£ss_id_g‘
(
sdp_mes§ge_t
 *
sdp
) {

62 ià(
sdp
 =ğ
NULL
)

63  
NULL
;

65  
sdp
->
o_£ss_id
;

66 
	}
}

68 *
	$sdp_mes§ge_o_£ss_v”siÚ_g‘
(
sdp_mes§ge_t
 *
sdp
) {

69 ià(
sdp
 =ğ
NULL
)

70  
NULL
;

72  
sdp
->
o_£ss_v”siÚ
;

73 
	}
}

75 *
	$sdp_mes§ge_o_Ã‰y³_g‘
(
sdp_mes§ge_t
 *
sdp
) {

76 ià(
sdp
 =ğ
NULL
)

77  
NULL
;

79  
sdp
->
o_Ã‰y³
;

80 
	}
}

82 *
	$sdp_mes§ge_o_add¹y³_g‘
(
sdp_mes§ge_t
 *
sdp
) {

83 ià(
sdp
 =ğ
NULL
)

84  
NULL
;

86  
sdp
->
o_add¹y³
;

87 
	}
}

89 *
	$sdp_mes§ge_o_addr_g‘
(
sdp_mes§ge_t
 *
sdp
) {

90 ià(
sdp
 =ğ
NULL
)

91  
NULL
;

93  
sdp
->
o_addr
;

94 
	}
}

96 
	$sdp_mes§ge_s_Çme_£t
(
sdp_mes§ge_t
 *
sdp
, *
Çme
) {

97 ià(
sdp
 =ğ
NULL
)

100 
sdp
->
s_Çme
 = 
Çme
;

101  
OSIP_SUCCESS
;

102 
	}
}

104 *
	$sdp_mes§ge_s_Çme_g‘
(
sdp_mes§ge_t
 *
sdp
) {

105 ià(
sdp
 =ğ
NULL
)

106  
NULL
;

108  
sdp
->
s_Çme
;

109 
	}
}

111 
	$sdp_mes§ge_i_šfo_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
šfo
) {

112 
sdp_medŸ_t
 *
med
;

114 ià(
sdp
 =ğ
NULL
)

115  
OSIP_BADPARAMETER
;

117 ià(
pos_medŸ
 == -1) {

118 
sdp
->
i_šfo
 = 
šfo
;

119  
OSIP_SUCCESS
;

122 
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

124 ià(
med
 =ğ
NULL
)

125  
OSIP_UNDEFINED_ERROR
;

127 
med
->
i_šfo
 = 
šfo
;

128  
OSIP_SUCCESS
;

129 
	}
}

131 *
	$sdp_mes§ge_i_šfo_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

132 
sdp_medŸ_t
 *
med
;

134 ià(
sdp
 =ğ
NULL
)

135  
NULL
;

137 ià(
pos_medŸ
 == -1) {

138  
sdp
->
i_šfo
;

141 
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

143 ià(
med
 =ğ
NULL
)

144  
NULL
;

146  
med
->
i_šfo
;

147 
	}
}

149 
	$sdp_mes§ge_u_uri_£t
(
sdp_mes§ge_t
 *
sdp
, *
uri
) {

150 ià(
sdp
 =ğ
NULL
)

151  
OSIP_BADPARAMETER
;

153 
sdp
->
u_uri
 = 
uri
;

154  
OSIP_SUCCESS
;

155 
	}
}

157 *
	$sdp_mes§ge_u_uri_g‘
(
sdp_mes§ge_t
 *
sdp
) {

158 ià(
sdp
 =ğ
NULL
)

159  
NULL
;

161  
sdp
->
u_uri
;

162 
	}
}

164 
	$sdp_mes§ge_e_ema_add
(
sdp_mes§ge_t
 *
sdp
, *
ema
) {

165 ià(
sdp
 =ğ
NULL
)

166  
OSIP_BADPARAMETER
;

168 
	`os_li¡_add
(&
sdp
->
e_emas
, 
ema
, -1);

169  
OSIP_SUCCESS
;

170 
	}
}

172 *
	$sdp_mes§ge_e_ema_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos
) {

173 ià(
sdp
 =ğ
NULL
)

174  
NULL
;

176 ià(
	`os_li¡_size
(&
sdp
->
e_emas
è> 
pos
)

177  (*è
	`os_li¡_g‘
(&
sdp
->
e_emas
, 
pos
);

179  
NULL
;

180 
	}
}

182 
	$sdp_mes§ge_p_phÚe_add
(
sdp_mes§ge_t
 *
sdp
, *
phÚe
) {

183 ià(
sdp
 =ğ
NULL
)

184  
OSIP_BADPARAMETER
;

186 
	`os_li¡_add
(&
sdp
->
p_phÚes
, 
phÚe
, -1);

187  
OSIP_SUCCESS
;

188 
	}
}

190 *
	$sdp_mes§ge_p_phÚe_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos
) {

191 ià(
sdp
 =ğ
NULL
)

192  
NULL
;

194 ià(
	`os_li¡_size
(&
sdp
->
p_phÚes
è> 
pos
)

195  (*è
	`os_li¡_g‘
(&
sdp
->
p_phÚes
, 
pos
);

197  
NULL
;

198 
	}
}

200 
	$sdp_mes§ge_c_cÚÃùiÚ_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
Ã‰y³
, *
add¹y³
, *
addr
, *
addr_muÉiÿ¡_‰l
, *
addr_muÉiÿ¡_št
) {

201 
i
;

202 
sdp_medŸ_t
 *
med
;

203 
sdp_cÚÃùiÚ_t
 *
cÚn
;

205 ià(
sdp
 =ğ
NULL
)

206  
OSIP_BADPARAMETER
;

208 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

211 
i
 = 
	`sdp_cÚÃùiÚ_š™
(&
cÚn
);

213 ià(
i
 != 0)

214  
i
;

216 
cÚn
->
c_Ã‰y³
 = 
Ã‰y³
;

217 
cÚn
->
c_add¹y³
 = 
add¹y³
;

218 
cÚn
->
c_addr
 = 
addr
;

219 
cÚn
->
c_addr_muÉiÿ¡_‰l
 = 
addr_muÉiÿ¡_‰l
;

220 
cÚn
->
c_addr_muÉiÿ¡_št
 = 
addr_muÉiÿ¡_št
;

222 ià(
pos_medŸ
 == -1) {

223 
sdp
->
c_cÚÃùiÚ
 = 
cÚn
;

224  
OSIP_SUCCESS
;

227 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

228 
	`os_li¡_add
(&
med
->
c_cÚÃùiÚs
, 
cÚn
, -1);

229  
OSIP_SUCCESS
;

230 
	}
}

233 
sdp_cÚÃùiÚ_t
 *
	$sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

234 
sdp_medŸ_t
 *
med
;

236 ià(
sdp
 =ğ
NULL
)

237  
NULL
;

239 ià(
pos_medŸ
 == -1)

240  
sdp
->
c_cÚÃùiÚ
;

242 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

244 ià(
med
 =ğ
NULL
)

245  
NULL
;

247  (
sdp_cÚÃùiÚ_t
 *è
	`os_li¡_g‘
(&
med
->
c_cÚÃùiÚs
, 
pos
);

248 
	}
}

250 *
	$sdp_mes§ge_c_Ã‰y³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

251 
sdp_cÚÃùiÚ_t
 *
cÚn
 = 
	`sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

253 ià(
cÚn
 =ğ
NULL
)

254  
NULL
;

256  
cÚn
->
c_Ã‰y³
;

257 
	}
}

259 *
	$sdp_mes§ge_c_add¹y³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

260 
sdp_cÚÃùiÚ_t
 *
cÚn
 = 
	`sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

262 ià(
cÚn
 =ğ
NULL
)

263  
NULL
;

265  
cÚn
->
c_add¹y³
;

266 
	}
}

268 *
	$sdp_mes§ge_c_addr_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

269 
sdp_cÚÃùiÚ_t
 *
cÚn
 = 
	`sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

271 ià(
cÚn
 =ğ
NULL
)

272  
NULL
;

274  
cÚn
->
c_addr
;

275 
	}
}

277 *
	$sdp_mes§ge_c_addr_muÉiÿ¡_‰l_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

278 
sdp_cÚÃùiÚ_t
 *
cÚn
 = 
	`sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

280 ià(
cÚn
 =ğ
NULL
)

281  
NULL
;

283  
cÚn
->
c_addr_muÉiÿ¡_‰l
;

284 
	}
}

286 *
	$sdp_mes§ge_c_addr_muÉiÿ¡_št_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

287 
sdp_cÚÃùiÚ_t
 *
cÚn
 = 
	`sdp_mes§ge_cÚÃùiÚ_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

289 ià(
cÚn
 =ğ
NULL
)

290  
NULL
;

292  
cÚn
->
c_addr_muÉiÿ¡_št
;

293 
	}
}

295 
	$sdp_mes§ge_b_bªdwidth_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
bwty³
, *
bªdwidth
) {

296 
i
;

297 
sdp_medŸ_t
 *
med
;

298 
sdp_bªdwidth_t
 *
bªd
;

300 ià(
sdp
 =ğ
NULL
)

301  
OSIP_BADPARAMETER
;

303 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

304  
OSIP_UNDEFINED_ERROR
;

306 
i
 = 
	`sdp_bªdwidth_š™
(&
bªd
);

308 ià(
i
 != 0)

309  
i
;

311 
bªd
->
b_bwty³
 = 
bwty³
;

312 
bªd
->
b_bªdwidth
 = 
bªdwidth
;

314 ià(
pos_medŸ
 == -1) {

315 
	`os_li¡_add
(&
sdp
->
b_bªdwidths
, 
bªd
, -1);

316  
OSIP_SUCCESS
;

319 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

320 
	`os_li¡_add
(&
med
->
b_bªdwidths
, 
bªd
, -1);

321  
OSIP_SUCCESS
;

322 
	}
}

324 
sdp_bªdwidth_t
 *
	$sdp_mes§ge_bªdwidth_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

325 
sdp_medŸ_t
 *
med
;

327 ià(
sdp
 =ğ
NULL
)

328  
NULL
;

330 ià(
pos_medŸ
 == -1)

331  (
sdp_bªdwidth_t
 *è
	`os_li¡_g‘
(&
sdp
->
b_bªdwidths
, 
pos
);

333 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

335 ià(
med
 =ğ
NULL
)

336  
NULL
;

338  (
sdp_bªdwidth_t
 *è
	`os_li¡_g‘
(&
med
->
b_bªdwidths
, 
pos
);

339 
	}
}

341 *
	$sdp_mes§ge_b_bwty³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

342 
sdp_bªdwidth_t
 *
bªd
 = 
	`sdp_mes§ge_bªdwidth_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

344 ià(
bªd
 =ğ
NULL
)

345  
NULL
;

347  
bªd
->
b_bwty³
;

348 
	}
}

350 *
	$sdp_mes§ge_b_bªdwidth_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

351 
sdp_bªdwidth_t
 *
bªd
 = 
	`sdp_mes§ge_bªdwidth_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

353 ià(
bªd
 =ğ
NULL
)

354  
NULL
;

356  
bªd
->
b_bªdwidth
;

357 
	}
}

359 
	$sdp_mes§ge_t_time_desü_add
(
sdp_mes§ge_t
 *
sdp
, *
¡¬t
, *
¡İ
) {

360 
i
;

361 
sdp_time_desü_t
 *
td
;

363 ià(
sdp
 =ğ
NULL
)

364  
OSIP_BADPARAMETER
;

366 
i
 = 
	`sdp_time_desü_š™
(&
td
);

368 ià(
i
 != 0)

369  
i
;

371 
td
->
t_¡¬t_time
 = 
¡¬t
;

372 
td
->
t_¡İ_time
 = 
¡İ
;

373 
	`os_li¡_add
(&
sdp
->
t_desüs
, 
td
, -1);

374  
OSIP_SUCCESS
;

375 
	}
}

377 *
	$sdp_mes§ge_t_¡¬t_time_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_td
) {

378 
sdp_time_desü_t
 *
td
;

380 ià(
sdp
 =ğ
NULL
)

381  
NULL
;

383 
td
 = (
sdp_time_desü_t
 *è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
pos_td
);

385 ià(
td
 =ğ
NULL
)

386  
NULL
;

388  
td
->
t_¡¬t_time
;

389 
	}
}

391 *
	$sdp_mes§ge_t_¡İ_time_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_td
) {

392 
sdp_time_desü_t
 *
td
;

394 ià(
sdp
 =ğ
NULL
)

395  
NULL
;

397 
td
 = (
sdp_time_desü_t
 *è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
pos_td
);

399 ià(
td
 =ğ
NULL
)

400  
NULL
;

402  
td
->
t_¡İ_time
;

403 
	}
}

405 
	$sdp_mes§ge_r_»³©_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_time_desü
, *
f›ld
) {

406 
sdp_time_desü_t
 *
td
;

408 ià(
sdp
 =ğ
NULL
)

409  
OSIP_BADPARAMETER
;

411 
td
 = (
sdp_time_desü_t
 *è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
pos_time_desü
);

413 ià(
td
 =ğ
NULL
)

414  
OSIP_UNDEFINED_ERROR
;

416 
	`os_li¡_add
(&
td
->
r_»³©s
, 
f›ld
, -1);

417  
OSIP_SUCCESS
;

418 
	}
}

420 *
	$sdp_mes§ge_r_»³©_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_time_desü
, 
pos_»³©
) {

421 
sdp_time_desü_t
 *
td
;

423 ià(
sdp
 =ğ
NULL
)

424  
NULL
;

426 
td
 = (
sdp_time_desü_t
 *è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
pos_time_desü
);

428 ià(
td
 =ğ
NULL
)

429  
NULL
;

431  (*è
	`os_li¡_g‘
(&
td
->
r_»³©s
, 
pos_»³©
);

432 
	}
}

434 
	$sdp_mes§ge_z_adju¡m’ts_£t
(
sdp_mes§ge_t
 *
sdp
, *
f›ld
) {

435 ià(
sdp
 =ğ
NULL
)

436  
OSIP_BADPARAMETER
;

438 
sdp
->
z_adju¡m’ts
 = 
f›ld
;

439  
OSIP_SUCCESS
;

440 
	}
}

442 *
	$sdp_mes§ge_z_adju¡m’ts_g‘
(
sdp_mes§ge_t
 *
sdp
) {

443 ià(
sdp
 =ğ
NULL
)

444  
NULL
;

446  
sdp
->
z_adju¡m’ts
;

447 
	}
}

449 
	$sdp_mes§ge_k_key_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
keyty³
, *
keyd©a
) {

450 
sdp_key_t
 *
key
;

451 
sdp_medŸ_t
 *
med
;

452 
i
;

454 ià(
sdp
 =ğ
NULL
)

455  
OSIP_BADPARAMETER
;

457 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

458  
OSIP_UNDEFINED_ERROR
;

460 
i
 = 
	`sdp_key_š™
(&
key
);

462 ià(
i
 != 0)

463  
i
;

465 
key
->
k_keyty³
 = 
keyty³
;

466 
key
->
k_keyd©a
 = 
keyd©a
;

468 ià(
pos_medŸ
 == -1) {

469 
sdp
->
k_key
 = 
key
;

470  
OSIP_SUCCESS
;

473 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

474 
med
->
k_key
 = 
key
;

475  
OSIP_SUCCESS
;

476 
	}
}

478 *
	$sdp_mes§ge_k_keyty³_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

479 
sdp_medŸ_t
 *
med
;

481 ià(
sdp
 =ğ
NULL
)

482  
NULL
;

484 ià(
pos_medŸ
 == -1) {

485 ià(
sdp
->
k_key
 =ğ
NULL
)

486  
NULL
;

488  
sdp
->
k_key
->
k_keyty³
;

491 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

492  
NULL
;

494 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

496 ià(
med
->
k_key
 =ğ
NULL
)

497  
NULL
;

499  
med
->
k_key
->
k_keyty³
;

500 
	}
}

502 *
	$sdp_mes§ge_k_keyd©a_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

503 
sdp_medŸ_t
 *
med
;

505 ià(
sdp
 =ğ
NULL
)

506  
NULL
;

508 ià(
pos_medŸ
 == -1) {

509 ià(
sdp
->
k_key
 =ğ
NULL
)

510  
NULL
;

512  
sdp
->
k_key
->
k_keyd©a
;

515 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

516  
NULL
;

518 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

520 ià(
med
->
k_key
 =ğ
NULL
)

521  
NULL
;

523  
med
->
k_key
->
k_keyd©a
;

524 
	}
}

526 
	$sdp_mes§ge_a_©Œibu‹_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
, *
©t_v®ue
) {

527 
i
;

528 
sdp_medŸ_t
 *
med
;

529 
sdp_©Œibu‹_t
 *
©Œ
;

531 ià(
sdp
 =ğ
NULL
)

532  
OSIP_BADPARAMETER
;

534 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

535  
OSIP_UNDEFINED_ERROR
;

537 
i
 = 
	`sdp_©Œibu‹_š™
(&
©Œ
);

539 ià(
i
 != 0)

540  
i
;

542 
©Œ
->
a_©t_f›ld
 = 
©t_f›ld
;

543 
©Œ
->
a_©t_v®ue
 = 
©t_v®ue
;

545 ià(
pos_medŸ
 == -1) {

546 
	`os_li¡_add
(&
sdp
->
a_©Œibu‹s
, 
©Œ
, -1);

547  
OSIP_SUCCESS
;

550 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

551 
	`os_li¡_add
(&
med
->
a_©Œibu‹s
, 
©Œ
, -1);

552  
OSIP_SUCCESS
;

553 
	}
}

555 
	$sdp_mes§ge_a_©Œibu‹_d–
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
) {

556 
i
;

557 
sdp_medŸ_t
 *
med
;

558 
sdp_©Œibu‹_t
 *
©Œ
;

560 ià(
sdp
 =ğ
NULL
)

561  
OSIP_BADPARAMETER
;

563 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

564  
OSIP_UNDEFINED_ERROR
;

566 ià(
pos_medŸ
 == -1) {

567 
i
 = 0; i < 
	`os_li¡_size
(&
sdp
->
a_©Œibu‹s
);) {

568 
©Œ
 = 
	`os_li¡_g‘
(&
sdp
->
a_©Œibu‹s
, 
i
);

570 ià(
	`¡rcmp
(
©Œ
->
a_©t_f›ld
, 
©t_f›ld
) == 0) {

571 
	`os_li¡_»move
(&
sdp
->
a_©Œibu‹s
, 
i
);

572 
	`sdp_©Œibu‹_ä“
(
©Œ
);

575 
i
++;

578  
OSIP_SUCCESS
;

581 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

583 ià(
med
 =ğ
NULL
)

584  
OSIP_UNDEFINED_ERROR
;

586 
i
 = 0; i < 
	`os_li¡_size
(&
med
->
a_©Œibu‹s
);) {

587 
©Œ
 = 
	`os_li¡_g‘
(&
med
->
a_©Œibu‹s
, 
i
);

589 ià(
	`¡rcmp
(
©Œ
->
a_©t_f›ld
, 
©t_f›ld
) == 0) {

590 
	`os_li¡_»move
(&
med
->
a_©Œibu‹s
, 
i
);

591 
	`sdp_©Œibu‹_ä“
(
©Œ
);

594 
i
++;

597  
OSIP_SUCCESS
;

598 
	}
}

600 
	$sdp_mes§ge_a_©Œibu‹_d–_©_šdex
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
©t_f›ld
, 
pos_©Œ
) {

601 
sdp_medŸ_t
 *
med
;

602 
sdp_©Œibu‹_t
 *
©Œ
;

604 ià(
sdp
 =ğ
NULL
)

605  
OSIP_BADPARAMETER
;

607 ià((
pos_medŸ
 !ğ-1è&& (
	`os_li¡_size
(&
sdp
->
m_medŸs
) <…os_media + 1))

608  
OSIP_BADPARAMETER
;

610 ià(
pos_©Œ
 == -1)

611  
	`sdp_mes§ge_a_©Œibu‹_d–
(
sdp
, 
pos_medŸ
, 
©t_f›ld
);

613 ià(
pos_medŸ
 == -1) {

614 ià((
©Œ
 = 
	`os_li¡_g‘
(&
sdp
->
a_©Œibu‹s
, 
pos_©Œ
)è!ğ
NULL
) {

615 ià(
	`¡rcmp
(
©Œ
->
a_©t_f›ld
, 
©t_f›ld
) == 0) {

616 
	`os_li¡_»move
(&
sdp
->
a_©Œibu‹s
, 
pos_©Œ
);

617 
	`sdp_©Œibu‹_ä“
(
©Œ
);

618  
OSIP_SUCCESS
;

622  
OSIP_BADPARAMETER
;

625 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

627 ià(
med
 =ğ
NULL
)

628  
OSIP_UNDEFINED_ERROR
;

630 ià((
©Œ
 = 
	`os_li¡_g‘
(&
med
->
a_©Œibu‹s
, 
pos_©Œ
)è!ğ
NULL
) {

631 ià(
	`¡rcmp
(
©Œ
->
a_©t_f›ld
, 
©t_f›ld
) == 0) {

632 
	`os_li¡_»move
(&
med
->
a_©Œibu‹s
, 
pos_©Œ
);

633 
	`sdp_©Œibu‹_ä“
(
©Œ
);

634  
OSIP_SUCCESS
;

638  
OSIP_BADPARAMETER
;

639 
	}
}

641 
sdp_©Œibu‹_t
 *
	$sdp_mes§ge_©Œibu‹_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

642 
sdp_medŸ_t
 *
med
;

644 ià(
sdp
 =ğ
NULL
)

645  
NULL
;

647 ià(
pos_medŸ
 == -1)

648  (
sdp_©Œibu‹_t
 *è
	`os_li¡_g‘
(&
sdp
->
a_©Œibu‹s
, 
pos
);

650 
med
 = (
sdp_medŸ_t
 *è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

652 ià(
med
 =ğ
NULL
)

653  
NULL
;

655  (
sdp_©Œibu‹_t
 *è
	`os_li¡_g‘
(&
med
->
a_©Œibu‹s
, 
pos
);

656 
	}
}

658 *
	$sdp_mes§ge_a_©t_f›ld_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

659 
sdp_©Œibu‹_t
 *
©Œ
 = 
	`sdp_mes§ge_©Œibu‹_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

661 ià(
©Œ
 =ğ
NULL
)

662  
NULL
;

664  
©Œ
->
a_©t_f›ld
;

665 
	}
}

667 *
	$sdp_mes§ge_a_©t_v®ue_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

668 
sdp_©Œibu‹_t
 *
©Œ
 = 
	`sdp_mes§ge_©Œibu‹_g‘
(
sdp
, 
pos_medŸ
, 
pos
);

670 ià(
©Œ
 =ğ
NULL
)

671  
NULL
;

673  
©Œ
->
a_©t_v®ue
;

674 
	}
}

676 
	$sdp_mes§ge_’dof_medŸ
(
sdp_mes§ge_t
 *
sdp
, 
i
) {

677 ià(
sdp
 =ğ
NULL
)

678  
OSIP_BADPARAMETER
;

680 ià(
i
 == -1)

681  
OSIP_SUCCESS
;

683 ià(!
	`os_li¡_eŞ
(&
sdp
->
m_medŸs
, 
i
))

684  
OSIP_SUCCESS
;

686  
OSIP_UNDEFINED_ERROR
;

687 
	}
}

689 
	$sdp_mes§ge_m_medŸ_add
(
sdp_mes§ge_t
 *
sdp
, *
medŸ
, *
pÜt
, *
numb”_of_pÜt
, *
´Ùo
) {

690 
i
;

691 
sdp_medŸ_t
 *
med
;

693 
i
 = 
	`sdp_medŸ_š™
(&
med
);

695 ià(
i
 != 0)

696  
i
;

698 
med
->
m_medŸ
 = 
medŸ
;

699 
med
->
m_pÜt
 = 
pÜt
;

700 
med
->
m_numb”_of_pÜt
 = 
numb”_of_pÜt
;

701 
med
->
m_´Ùo
 = 
´Ùo
;

702 
	`os_li¡_add
(&
sdp
->
m_medŸs
, 
med
, -1);

703  
OSIP_SUCCESS
;

704 
	}
}

706 *
	$sdp_mes§ge_m_medŸ_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

707 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

709 ià(
med
 =ğ
NULL
)

710  
NULL
;

712  
med
->
m_medŸ
;

713 
	}
}

715 *
	$sdp_mes§ge_m_pÜt_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

716 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

718 ià(
med
 =ğ
NULL
)

719  
NULL
;

721  
med
->
m_pÜt
;

722 
	}
}

724 *
	$sdp_mes§ge_m_numb”_of_pÜt_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

725 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

727 ià(
med
 =ğ
NULL
)

728  
NULL
;

730  
med
->
m_numb”_of_pÜt
;

731 
	}
}

733 
	$sdp_mes§ge_m_pÜt_£t
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
pÜt
) {

734 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

736 ià(
med
 =ğ
NULL
)

737  
OSIP_BADPARAMETER
;

739 ià(
med
->
m_pÜt
)

740 
	`os_ä“
(
med
->
m_pÜt
);

742 
med
->
m_pÜt
 = 
pÜt
;

743  
OSIP_SUCCESS
;

744 
	}
}

746 *
	$sdp_mes§ge_m_´Ùo_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
) {

747 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

749 ià(
med
 =ğ
NULL
)

750  
NULL
;

752  
med
->
m_´Ùo
;

753 
	}
}

755 
	$sdp_mes§ge_m_·ylßd_add
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, *
·ylßd
) {

756 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

758 ià(
med
 =ğ
NULL
)

759  
OSIP_BADPARAMETER
;

761 
	`os_li¡_add
(&
med
->
m_·ylßds
, 
·ylßd
, -1);

762  
OSIP_SUCCESS
;

763 
	}
}

765 *
	$sdp_mes§ge_m_·ylßd_g‘
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

766 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

768 ià(
med
 =ğ
NULL
)

769  
NULL
;

771  (*è
	`os_li¡_g‘
(&
med
->
m_·ylßds
, 
pos
);

772 
	}
}

774 
	$sdp_mes§ge_m_·ylßd_d–
(
sdp_mes§ge_t
 *
sdp
, 
pos_medŸ
, 
pos
) {

775 
sdp_medŸ_t
 *
med
 = 
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos_medŸ
);

776 *
·ylßd
;

778 ià(
med
 =ğ
NULL
)

779  
OSIP_BADPARAMETER
;

781 ià((
·ylßd
 = 
	`os_li¡_g‘
(&
med
->
m_·ylßds
, 
pos
)è=ğ
NULL
)

782  
OSIP_UNDEFINED_ERROR
;

784 
	`os_li¡_»move
(&
med
->
m_·ylßds
, 
pos
);

785 
	`os_ä“
(
·ylßd
);

786  
OSIP_SUCCESS
;

787 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_message.c

20 
	~<os·r£r2/š‹º®.h
>

22 
	~<os·r£r2/os_cÚ¡.h
>

23 
	~<os·r£r2/sdp_mes§ge.h
>

24 
	~<os·r£r2/os_mes§ge.h
>

25 
	~<os·r£r2/os_pÜt.h
>

27 
	#ERR_ERROR
 -1

	)

28 
	#ERR_DISCARD
 0

	)

29 
	#OSIP_WF
 1

	)

31 
sdp_mes§ge_·r£_v
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

32 
sdp_mes§ge_·r£_o
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

33 
sdp_mes§ge_·r£_s
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

34 
sdp_mes§ge_·r£_i
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

35 
sdp_mes§ge_·r£_u
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

36 
sdp_mes§ge_·r£_e
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

37 
sdp_mes§ge_·r£_p
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

38 
sdp_mes§ge_·r£_c
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

39 
sdp_mes§ge_·r£_b
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

40 
sdp_mes§ge_·r£_t
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

41 
sdp_mes§ge_·r£_r
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

42 
sdp_mes§ge_·r£_z
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

43 
sdp_mes§ge_·r£_k
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

44 
sdp_mes§ge_·r£_a
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

45 
sdp_mes§ge_·r£_m
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
);

47 
sdp_­³nd_medŸ
(**
¡ršg
, *
size
, *
tmp
, 
sdp_medŸ_t
 *
medŸ
, **
Ãxt_tmp
);

48 
sdp_­³nd_©Œibu‹
(**
¡ršg
, *
size
, *
tmp
, 
sdp_©Œibu‹_t
 *
©Œibu‹
, **
Ãxt_tmp
);

49 
sdp_­³nd_key
(**
¡ršg
, *
size
, *
tmp
, 
sdp_key_t
 *
key
, **
Ãxt_tmp
);

50 
sdp_­³nd_time_desü
(**
¡ršg
, *
size
, *
tmp
, 
sdp_time_desü_t
 *
time_desü
, **
Ãxt_tmp
);

51 
sdp_­³nd_bªdwidth
(**
¡ršg
, *
size
, *
tmp
, 
sdp_bªdwidth_t
 *
bªdwidth
, **
Ãxt_tmp
);

52 
sdp_­³nd_cÚÃùiÚ
(**
¡ršg
, *
size
, *
tmp
, 
sdp_cÚÃùiÚ_t
 *
cÚn
, **
Ãxt_tmp
);

54 *
__os_sdp_­³nd_¡ršg
(**
¡ršg
, *
size
, *
cur
, *
¡ršg_os_to_­³nd
);

56 
	$sdp_bªdwidth_š™
(
sdp_bªdwidth_t
 **
b
) {

57 *
b
 = (
sdp_bªdwidth_t
 *è
	`os_m®loc
((sdp_bandwidth_t));

59 ià(*
b
 =ğ
NULL
)

60  
OSIP_NOMEM
;

62 (*
b
)->
b_bwty³
 = 
NULL
;

63 (*
b
)->
b_bªdwidth
 = 
NULL
;

64  
OSIP_SUCCESS
;

65 
	}
}

67 
	$sdp_bªdwidth_ä“
(
sdp_bªdwidth_t
 *
b
) {

68 ià(
b
 =ğ
NULL
)

71 
	`os_ä“
(
b
->
b_bwty³
);

72 
	`os_ä“
(
b
->
b_bªdwidth
);

73 
	`os_ä“
(
b
);

74 
	}
}

76 
	$sdp_time_desü_š™
(
sdp_time_desü_t
 **
td
) {

77 *
td
 = (
sdp_time_desü_t
 *è
	`os_m®loc
((sdp_time_descr_t));

79 ià(*
td
 =ğ
NULL
)

80  
OSIP_NOMEM
;

82 (*
td
)->
t_¡¬t_time
 = 
NULL
;

83 (*
td
)->
t_¡İ_time
 = 
NULL
;

84 
	`os_li¡_š™
(&(*
td
)->
r_»³©s
);

85  
OSIP_SUCCESS
;

86 
	}
}

88 
	$sdp_time_desü_ä“
(
sdp_time_desü_t
 *
td
) {

89 ià(
td
 =ğ
NULL
)

92 
	`os_ä“
(
td
->
t_¡¬t_time
);

93 
	`os_ä“
(
td
->
t_¡İ_time
);

94 
	`os_li¡_ofch¬_ä“
(&
td
->
r_»³©s
);

95 
	`os_ä“
(
td
);

96 
	}
}

98 
	$sdp_key_š™
(
sdp_key_t
 **
key
) {

99 *
key
 = (
sdp_key_t
 *è
	`os_m®loc
((sdp_key_t));

101 ià(*
key
 =ğ
NULL
)

102  
OSIP_NOMEM
;

104 (*
key
)->
k_keyty³
 = 
NULL
;

105 (*
key
)->
k_keyd©a
 = 
NULL
;

106  
OSIP_SUCCESS
;

107 
	}
}

109 
	$sdp_key_ä“
(
sdp_key_t
 *
key
) {

110 ià(
key
 =ğ
NULL
)

113 
	`os_ä“
(
key
->
k_keyty³
);

114 
	`os_ä“
(
key
->
k_keyd©a
);

115 
	`os_ä“
(
key
);

116 
	}
}

118 
	$sdp_©Œibu‹_š™
(
sdp_©Œibu‹_t
 **
©Œibu‹
) {

119 *
©Œibu‹
 = (
sdp_©Œibu‹_t
 *è
	`os_m®loc
((sdp_attribute_t));

121 ià(*
©Œibu‹
 =ğ
NULL
)

122  
OSIP_NOMEM
;

124 (*
©Œibu‹
)->
a_©t_f›ld
 = 
NULL
;

125 (*
©Œibu‹
)->
a_©t_v®ue
 = 
NULL
;

126  
OSIP_SUCCESS
;

127 
	}
}

129 
	$sdp_©Œibu‹_ä“
(
sdp_©Œibu‹_t
 *
©Œibu‹
) {

130 ià(
©Œibu‹
 =ğ
NULL
)

133 
	`os_ä“
(
©Œibu‹
->
a_©t_f›ld
);

134 
	`os_ä“
(
©Œibu‹
->
a_©t_v®ue
);

135 
	`os_ä“
(
©Œibu‹
);

136 
	}
}

138 
	$sdp_cÚÃùiÚ_š™
(
sdp_cÚÃùiÚ_t
 **
cÚÃùiÚ
) {

139 *
cÚÃùiÚ
 = (
sdp_cÚÃùiÚ_t
 *è
	`os_m®loc
((sdp_connection_t));

141 ià(*
cÚÃùiÚ
 =ğ
NULL
)

142  
OSIP_NOMEM
;

144 (*
cÚÃùiÚ
)->
c_Ã‰y³
 = 
NULL
;

145 (*
cÚÃùiÚ
)->
c_add¹y³
 = 
NULL
;

146 (*
cÚÃùiÚ
)->
c_addr
 = 
NULL
;

147 (*
cÚÃùiÚ
)->
c_addr_muÉiÿ¡_‰l
 = 
NULL
;

148 (*
cÚÃùiÚ
)->
c_addr_muÉiÿ¡_št
 = 
NULL
;

149  
OSIP_SUCCESS
;

150 
	}
}

152 
	$sdp_cÚÃùiÚ_ä“
(
sdp_cÚÃùiÚ_t
 *
cÚÃùiÚ
) {

153 ià(
cÚÃùiÚ
 =ğ
NULL
)

156 
	`os_ä“
(
cÚÃùiÚ
->
c_Ã‰y³
);

157 
	`os_ä“
(
cÚÃùiÚ
->
c_add¹y³
);

158 
	`os_ä“
(
cÚÃùiÚ
->
c_addr
);

159 
	`os_ä“
(
cÚÃùiÚ
->
c_addr_muÉiÿ¡_‰l
);

160 
	`os_ä“
(
cÚÃùiÚ
->
c_addr_muÉiÿ¡_št
);

161 
	`os_ä“
(
cÚÃùiÚ
);

162 
	}
}

164 
	$sdp_medŸ_š™
(
sdp_medŸ_t
 **
medŸ
) {

165 
i
;

167 *
medŸ
 = (
sdp_medŸ_t
 *è
	`os_m®loc
((sdp_media_t));

169 ià(*
medŸ
 =ğ
NULL
)

170  
OSIP_NOMEM
;

172 (*
medŸ
)->
m_medŸ
 = 
NULL
;

173 (*
medŸ
)->
m_pÜt
 = 
NULL
;

174 (*
medŸ
)->
m_numb”_of_pÜt
 = 
NULL
;

175 (*
medŸ
)->
m_´Ùo
 = 
NULL
;

176 
i
 = 
	`os_li¡_š™
(&(*
medŸ
)->
m_·ylßds
);

178 ià(
i
 != 0) {

179 
	`os_ä“
(*
medŸ
);

180 *
medŸ
 = 
NULL
;

181  
OSIP_NOMEM
;

184 (*
medŸ
)->
i_šfo
 = 
NULL
;

185 
i
 = 
	`os_li¡_š™
(&(*
medŸ
)->
c_cÚÃùiÚs
);

187 ià(
i
 != 0) {

188 
	`os_li¡_ofch¬_ä“
(&(*
medŸ
)->
m_·ylßds
);

189 
	`os_ä“
(*
medŸ
);

190 *
medŸ
 = 
NULL
;

191  
OSIP_NOMEM
;

194 
i
 = 
	`os_li¡_š™
(&(*
medŸ
)->
b_bªdwidths
);

196 ià(
i
 != 0) {

197 
	`os_li¡_ofch¬_ä“
(&(*
medŸ
)->
m_·ylßds
);

198 
	`os_li¡_¥ecŸl_ä“
(&(*
medŸ
)->
c_cÚÃùiÚs
, ((*)(*)è& 
sdp_cÚÃùiÚ_ä“
);

199 
	`os_ä“
(*
medŸ
);

200 *
medŸ
 = 
NULL
;

201  
OSIP_NOMEM
;

204 
i
 = 
	`os_li¡_š™
(&(*
medŸ
)->
a_©Œibu‹s
);

206 ià(
i
 != 0) {

207 
	`os_li¡_ofch¬_ä“
(&(*
medŸ
)->
m_·ylßds
);

208 
	`os_li¡_¥ecŸl_ä“
(&(*
medŸ
)->
c_cÚÃùiÚs
, ((*)(*)è& 
sdp_cÚÃùiÚ_ä“
);

209 
	`os_li¡_¥ecŸl_ä“
(&(*
medŸ
)->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

210 
	`os_ä“
(*
medŸ
);

211 *
medŸ
 = 
NULL
;

212  
OSIP_NOMEM
;

215 (*
medŸ
)->
k_key
 = 
NULL
;

216  
OSIP_SUCCESS
;

217 
	}
}

219 
	$sdp_medŸ_ä“
(
sdp_medŸ_t
 *
medŸ
) {

220 ià(
medŸ
 =ğ
NULL
)

223 
	`os_ä“
(
medŸ
->
m_medŸ
);

224 
	`os_ä“
(
medŸ
->
m_pÜt
);

225 
	`os_ä“
(
medŸ
->
m_numb”_of_pÜt
);

226 
	`os_ä“
(
medŸ
->
m_´Ùo
);

227 
	`os_li¡_ofch¬_ä“
(&
medŸ
->
m_·ylßds
);

228 
	`os_ä“
(
medŸ
->
i_šfo
);

229 
	`os_li¡_¥ecŸl_ä“
(&
medŸ
->
c_cÚÃùiÚs
, ((*)(*)è& 
sdp_cÚÃùiÚ_ä“
);

230 
	`os_li¡_¥ecŸl_ä“
(&
medŸ
->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

231 
	`os_li¡_¥ecŸl_ä“
(&
medŸ
->
a_©Œibu‹s
, ((*)(*)è& 
sdp_©Œibu‹_ä“
);

232 
	`sdp_key_ä“
(
medŸ
->
k_key
);

233 
	`os_ä“
(
medŸ
);

234 
	}
}

237 
	$sdp_mes§ge_š™
(
sdp_mes§ge_t
 **
sdp
) {

238 
i
;

240 (*
sdp
èğ(
sdp_mes§ge_t
 *è
	`os_m®loc
((sdp_message_t));

242 ià(*
sdp
 =ğ
NULL
)

243  
OSIP_NOMEM
;

245 (*
sdp
)->
v_v”siÚ
 = 
NULL
;

246 (*
sdp
)->
o_u£ºame
 = 
NULL
;

247 (*
sdp
)->
o_£ss_id
 = 
NULL
;

248 (*
sdp
)->
o_£ss_v”siÚ
 = 
NULL
;

249 (*
sdp
)->
o_Ã‰y³
 = 
NULL
;

250 (*
sdp
)->
o_add¹y³
 = 
NULL
;

251 (*
sdp
)->
o_addr
 = 
NULL
;

252 (*
sdp
)->
s_Çme
 = 
NULL
;

253 (*
sdp
)->
i_šfo
 = 
NULL
;

254 (*
sdp
)->
u_uri
 = 
NULL
;

256 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
e_emas
);

258 ià(
i
 != 0) {

259 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

260 
	`os_ä“
(*
sdp
);

261 *
sdp
 = 
NULL
;

262  
OSIP_NOMEM
;

265 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
p_phÚes
);

267 ià(
i
 != 0) {

268 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

269 
	`os_ä“
(*
sdp
);

270 *
sdp
 = 
NULL
;

271  
OSIP_NOMEM
;

274 (*
sdp
)->
c_cÚÃùiÚ
 = 
NULL
;

276 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
b_bªdwidths
);

278 ià(
i
 != 0) {

279 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

280 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
p_phÚes
);

281 
	`os_ä“
(*
sdp
);

282 *
sdp
 = 
NULL
;

283  
OSIP_NOMEM
;

286 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
t_desüs
);

288 ià(
i
 != 0) {

289 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

290 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
p_phÚes
);

291 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

292 
	`os_ä“
(*
sdp
);

293 *
sdp
 = 
NULL
;

294  
OSIP_NOMEM
;

297 (*
sdp
)->
z_adju¡m’ts
 = 
NULL
;

298 (*
sdp
)->
k_key
 = 
NULL
;

300 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
a_©Œibu‹s
);

302 ià(
i
 != 0) {

303 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

304 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
p_phÚes
);

305 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

306 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
t_desüs
, ((*)(*)è& 
sdp_time_desü_ä“
);

307 
	`os_ä“
(*
sdp
);

308 *
sdp
 = 
NULL
;

309  
OSIP_NOMEM
;

312 
i
 = 
	`os_li¡_š™
(&(*
sdp
)->
m_medŸs
);

314 ià(
i
 != 0) {

315 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
e_emas
);

316 
	`os_li¡_ofch¬_ä“
(&(*
sdp
)->
p_phÚes
);

317 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

318 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
t_desüs
, ((*)(*)è& 
sdp_time_desü_ä“
);

319 
	`os_li¡_¥ecŸl_ä“
(&(*
sdp
)->
a_©Œibu‹s
, ((*)(*)è& 
sdp_©Œibu‹_ä“
);

320 
	`os_ä“
(*
sdp
);

321 *
sdp
 = 
NULL
;

322  
OSIP_NOMEM
;

325  
OSIP_SUCCESS
;

326 
	}
}

331 *
	$__os_sdp_­³nd_¡ršg
(**
¡ršg
, *
size
, *
cur
, *
¡ršg_os_to_­³nd
) {

332 
Ëngth
 = (è
	`¡¾’
(
¡ršg_os_to_­³nd
);

334 ià(
cur
 - (*
¡ršg
è+ 
Ëngth
 + 1 > *
size
) {

335 
Ëngth2
;

337 
Ëngth2
 = (è(
cur
 - *
¡ršg
);

338 (*
¡ršg
èğ
	`os_»®loc
((*¡ršg), *
size
 + 
Ëngth
 + 500);

339 *
size
 = *siz+ 
Ëngth
 + 500;

340 
cur
 = (*
¡ršg
è+ 
Ëngth2
;

343 
	`os_¡ºıy
(
cur
, 
¡ršg_os_to_­³nd
, 
Ëngth
);

344  
cur
 + 
	`¡¾’
(cur);

345 
	}
}

347 
	$sdp_mes§ge_·r£_v
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

348 *
equ®
;

349 *
ülf
;

351 *
Ãxt
 = 
buf
;

353 
equ®
 = 
buf
;

355 (*
equ®
 != '=') && (*equal != '\0'))

356 
equ®
++;

358 ià(*
equ®
 == '\0')

359  
ERR_ERROR
;

361 ià(
equ®
 =ğ
buf
)

362  
ERR_DISCARD
;

365 ià(
equ®
[-1] != 'v')

366  
ERR_DISCARD
;

368 
ülf
 = 
equ®
 + 1;

370 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

371 
ülf
++;

373 ià(*
ülf
 == '\0')

374  
ERR_ERROR
;

376 ià(
ülf
 =ğ
equ®
 + 1)

377  
ERR_ERROR
;

379 
sdp
->
v_v”siÚ
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

381 ià(
sdp
->
v_v”siÚ
 =ğ
NULL
)

382  
OSIP_NOMEM
;

384 
	`os_¡ºıy
(
sdp
->
v_v”siÚ
, 
equ®
 + 1, 
ülf
 - (equal + 1));

386 ià(
ülf
[1] == '\n')

387 *
Ãxt
 = 
ülf
 + 2;

390 *
Ãxt
 = 
ülf
 + 1;

392  
OSIP_WF
;

393 
	}
}

395 
	$sdp_mes§ge_·r£_o
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

396 *
equ®
;

397 *
ülf
;

398 *
tmp
;

399 *
tmp_Ãxt
;

400 
i
;

402 *
Ãxt
 = 
buf
;

404 
equ®
 = 
buf
;

406 (*
equ®
 != '=') && (*equal != '\0'))

407 
equ®
++;

409 ià(*
equ®
 == '\0')

410  
ERR_ERROR
;

413 ià(
equ®
[-1] != 'o')

414  
ERR_DISCARD
;

416 
ülf
 = 
equ®
 + 1;

418 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

419 
ülf
++;

421 ià(*
ülf
 == '\0')

422  
ERR_ERROR
;

424 ià(
ülf
 =ğ
equ®
 + 1)

425  
ERR_ERROR
;

427 
tmp
 = 
equ®
 + 1;

431 #ifdeà
FIREFLY_BUG_SUPPORT


433 ià(
tmp
[0] == ' ') {

434 
sdp
->
o_u£ºame
 = 
	`os_¡rdup
("firefly");

435 
tmp
++;

438 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_u£ºame
), 
tmp
, ' ', &
tmp_Ãxt
);

440 ià(
i
 != 0)

443 
tmp
 = 
tmp_Ãxt
;

447 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_u£ºame
), 
tmp
, ' ', &
tmp_Ãxt
);

449 ià(
i
 != 0)

452 
tmp
 = 
tmp_Ãxt
;

456 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_£ss_id
), 
tmp
, ' ', &
tmp_Ãxt
);

458 ià(
i
 != 0)

461 
tmp
 = 
tmp_Ãxt
;

464 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_£ss_v”siÚ
), 
tmp
, ' ', &
tmp_Ãxt
);

466 ià(
i
 != 0)

469 
tmp
 = 
tmp_Ãxt
;

472 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_Ã‰y³
), 
tmp
, ' ', &
tmp_Ãxt
);

474 ià(
i
 != 0)

477 
tmp
 = 
tmp_Ãxt
;

480 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_add¹y³
), 
tmp
, ' ', &
tmp_Ãxt
);

482 ià(
i
 != 0)

485 
tmp
 = 
tmp_Ãxt
;

488 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_addr
), 
tmp
, '\r', &
tmp_Ãxt
);

490 ià(
i
 != 0) {

491 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
sdp
->
o_addr
), 
tmp
, '\n', &
tmp_Ãxt
);

493 ià(
i
 != 0)

497 ià(
ülf
[1] == '\n')

498 *
Ãxt
 = 
ülf
 + 2;

501 *
Ãxt
 = 
ülf
 + 1;

503  
OSIP_WF
;

504 
	}
}

506 
	$sdp_mes§ge_·r£_s
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

507 *
equ®
;

508 *
ülf
;

510 *
Ãxt
 = 
buf
;

512 
equ®
 = 
buf
;

514 (*
equ®
 != '=') && (*equal != '\0'))

515 
equ®
++;

517 ià(*
equ®
 == '\0')

518  
ERR_ERROR
;

521 ià(
equ®
[-1] != 's')

522  
ERR_DISCARD
;

524 
ülf
 = 
equ®
 + 1;

526 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

527 
ülf
++;

529 ià(*
ülf
 == '\0')

530  
ERR_ERROR
;

532 #ifdeà
FIREFLY_BUG_SUPPORT


534 ià(
ülf
 =ğ
equ®
 + 1) {

535 
sdp
->
s_Çme
 = 
	`os_¡rdup
(" ");

537 ià(
ülf
[1] == '\n')

538 *
Ãxt
 = 
ülf
 + 2;

541 *
Ãxt
 = 
ülf
 + 1;

543  
OSIP_WF
;

548 ià(
ülf
 =ğ
equ®
 + 1)

549  
ERR_ERROR
;

557 
sdp
->
s_Çme
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

559 ià(
sdp
->
s_Çme
 =ğ
NULL
)

560  
OSIP_NOMEM
;

562 
	`os_¡ºıy
(
sdp
->
s_Çme
, 
equ®
 + 1, 
ülf
 - (equal + 1));

564 ià(
ülf
[1] == '\n')

565 *
Ãxt
 = 
ülf
 + 2;

568 *
Ãxt
 = 
ülf
 + 1;

570  
OSIP_WF
;

571 
	}
}

573 
	$sdp_mes§ge_·r£_i
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

574 *
equ®
;

575 *
ülf
;

576 
i
;

577 *
i_šfo
;

579 *
Ãxt
 = 
buf
;

581 
equ®
 = 
buf
;

583 (*
equ®
 != '=') && (*equal != '\0'))

584 
equ®
++;

586 ià(*
equ®
 == '\0')

587  
ERR_ERROR
;

590 ià(
equ®
[-1] != 'i')

591  
ERR_DISCARD
;

593 
ülf
 = 
equ®
 + 1;

595 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

596 
ülf
++;

598 ià(*
ülf
 == '\0')

599  
ERR_ERROR
;

601 ià(
ülf
 =ğ
equ®
 + 1)

602  
ERR_ERROR
;

608 
i_šfo
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

610 ià(
i_šfo
 =ğ
NULL
)

611  
OSIP_NOMEM
;

613 
	`os_¡ºıy
(
i_šfo
, 
equ®
 + 1, 
ülf
 - (equal + 1));

619 
i
 = 
	`os_li¡_size
(&
sdp
->
m_medŸs
);

621 ià(
i
 == 0)

622 
sdp
->
i_šfo
 = i_info;

625 
sdp_medŸ_t
 *
Ï¡_sdp_medŸ
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
i
 - 1);

627 
Ï¡_sdp_medŸ
->
i_šfo
 = i_info;

630 ià(
ülf
[1] == '\n')

631 *
Ãxt
 = 
ülf
 + 2;

634 *
Ãxt
 = 
ülf
 + 1;

636  
OSIP_WF
;

637 
	}
}

639 
	$sdp_mes§ge_·r£_u
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

640 *
equ®
;

641 *
ülf
;

643 *
Ãxt
 = 
buf
;

645 
equ®
 = 
buf
;

647 (*
equ®
 != '=') && (*equal != '\0'))

648 
equ®
++;

650 ià(*
equ®
 == '\0')

651  
ERR_ERROR
;

654 ià(
equ®
[-1] != 'u')

655  
ERR_DISCARD
;

657 
ülf
 = 
equ®
 + 1;

659 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

660 
ülf
++;

662 ià(*
ülf
 == '\0')

663  
ERR_ERROR
;

665 ià(
ülf
 =ğ
equ®
 + 1)

666  
ERR_ERROR
;

670 
sdp
->
u_uri
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

672 ià(
sdp
->
u_uri
 =ğ
NULL
)

673  
OSIP_NOMEM
;

675 
	`os_¡ºıy
(
sdp
->
u_uri
, 
equ®
 + 1, 
ülf
 - (equal + 1));

677 ià(
ülf
[1] == '\n')

678 *
Ãxt
 = 
ülf
 + 2;

681 *
Ãxt
 = 
ülf
 + 1;

683  
OSIP_WF
;

684 
	}
}

686 
	$sdp_mes§ge_·r£_e
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

687 *
equ®
;

688 *
ülf
;

689 *
e_ema
;

691 *
Ãxt
 = 
buf
;

693 
equ®
 = 
buf
;

695 (*
equ®
 != '=') && (*equal != '\0'))

696 
equ®
++;

698 ià(*
equ®
 == '\0')

699  
ERR_ERROR
;

702 ià(
equ®
[-1] != 'e')

703  
ERR_DISCARD
;

705 
ülf
 = 
equ®
 + 1;

707 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

708 
ülf
++;

710 ià(*
ülf
 == '\0')

711  
ERR_ERROR
;

713 ià(
ülf
 =ğ
equ®
 + 1)

714  
ERR_ERROR
;

718 
e_ema
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

720 ià(
e_ema
 =ğ
NULL
)

721  
OSIP_NOMEM
;

723 
	`os_¡ºıy
(
e_ema
, 
equ®
 + 1, 
ülf
 - (equal + 1));

725 
	`os_li¡_add
(&
sdp
->
e_emas
, 
e_ema
, -1);

727 ià(
ülf
[1] == '\n')

728 *
Ãxt
 = 
ülf
 + 2;

731 *
Ãxt
 = 
ülf
 + 1;

733  
OSIP_WF
;

734 
	}
}

736 
	$sdp_mes§ge_·r£_p
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

737 *
equ®
;

738 *
ülf
;

739 *
p_phÚe
;

741 *
Ãxt
 = 
buf
;

743 
equ®
 = 
buf
;

745 (*
equ®
 != '=') && (*equal != '\0'))

746 
equ®
++;

748 ià(*
equ®
 == '\0')

749  
ERR_ERROR
;

752 ià(
equ®
[-1] != 'p')

753  
ERR_DISCARD
;

755 
ülf
 = 
equ®
 + 1;

757 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

758 
ülf
++;

760 ià(*
ülf
 == '\0')

761  
ERR_ERROR
;

763 ià(
ülf
 =ğ
equ®
 + 1)

764  
ERR_ERROR
;

768 
p_phÚe
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

770 ià(
p_phÚe
 =ğ
NULL
)

771  
OSIP_NOMEM
;

773 
	`os_¡ºıy
(
p_phÚe
, 
equ®
 + 1, 
ülf
 - (equal + 1));

775 
	`os_li¡_add
(&
sdp
->
p_phÚes
, 
p_phÚe
, -1);

777 ià(
ülf
[1] == '\n')

778 *
Ãxt
 = 
ülf
 + 2;

781 *
Ãxt
 = 
ülf
 + 1;

783  
OSIP_WF
;

784 
	}
}

786 
	$sdp_mes§ge_·r£_c
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

787 *
equ®
;

788 *
ülf
;

789 *
tmp
;

790 *
tmp_Ãxt
;

791 
sdp_cÚÃùiÚ_t
 *
c_h—d”
;

792 
i
;

794 *
Ãxt
 = 
buf
;

796 
equ®
 = 
buf
;

798 (*
equ®
 != '=') && (*equal != '\0'))

799 
equ®
++;

801 ià(*
equ®
 == '\0')

802  
ERR_ERROR
;

805 ià(
equ®
[-1] != 'c')

806  
ERR_DISCARD
;

808 
ülf
 = 
equ®
 + 1;

810 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

811 
ülf
++;

813 ià(*
ülf
 == '\0')

814  
ERR_ERROR
;

816 ià(
ülf
 =ğ
equ®
 + 1)

817  
ERR_ERROR
;

819 
tmp
 = 
equ®
 + 1;

820 
i
 = 
	`sdp_cÚÃùiÚ_š™
(&
c_h—d”
);

822 ià(
i
 != 0)

823  
ERR_ERROR
;

828 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_Ã‰y³
), 
tmp
, ' ', &
tmp_Ãxt
);

830 ià(
i
 != 0) {

831 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

835 
tmp
 = 
tmp_Ãxt
;

838 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_add¹y³
), 
tmp
, ' ', &
tmp_Ãxt
);

840 ià(
i
 != 0) {

841 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

845 
tmp
 = 
tmp_Ãxt
;

853 *
¦ash
 = 
	`¡rchr
(
tmp
, '/');

855 ià(
¦ash
 !ğ
NULL
 && sÏsh < 
ülf
) {

856 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr
), 
tmp
, '/', &
tmp_Ãxt
);

858 ià(
i
 != 0) {

859 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

863 
tmp
 = 
tmp_Ãxt
;

864 
¦ash
 = 
	`¡rchr
(slash + 1, '/');

866 ià(
¦ash
 !ğ
NULL
 && sÏsh < 
ülf
) {

867 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr_muÉiÿ¡_‰l
), 
tmp
, '/', &
tmp_Ãxt
);

869 ià(
i
 != 0) {

870 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

874 
tmp
 = 
tmp_Ãxt
;

875 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr_muÉiÿ¡_št
), 
tmp
, '\r', &
tmp_Ãxt
);

877 ià(
i
 != 0) {

878 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr_muÉiÿ¡_št
), 
tmp
, '\n', &
tmp_Ãxt
);

880 ià(
i
 != 0) {

881 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

887 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr_muÉiÿ¡_‰l
), 
tmp
, '\r', &
tmp_Ãxt
);

889 ià(
i
 != 0) {

890 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr_muÉiÿ¡_‰l
), 
tmp
, '\n', &
tmp_Ãxt
);

892 ià(
i
 != 0) {

893 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

901 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr
), 
tmp
, '\r', &
tmp_Ãxt
);

903 ià(
i
 != 0) {

904 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
c_h—d”
->
c_addr
), 
tmp
, '\n', &
tmp_Ãxt
);

906 ià(
i
 != 0) {

907 
	`sdp_cÚÃùiÚ_ä“
(
c_h—d”
);

918 
i
 = 
	`os_li¡_size
(&
sdp
->
m_medŸs
);

920 ià(
i
 == 0)

921 
sdp
->
c_cÚÃùiÚ
 = 
c_h—d”
;

924 
sdp_medŸ_t
 *
Ï¡_sdp_medŸ
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
i
 - 1);

926 
	`os_li¡_add
(&
Ï¡_sdp_medŸ
->
c_cÚÃùiÚs
, 
c_h—d”
, -1);

929 ià(
ülf
[1] == '\n')

930 *
Ãxt
 = 
ülf
 + 2;

933 *
Ãxt
 = 
ülf
 + 1;

935  
OSIP_WF
;

936 
	}
}

938 
	$sdp_mes§ge_·r£_b
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

939 *
equ®
;

940 *
ülf
;

941 *
tmp
;

942 *
tmp_Ãxt
;

943 
i
;

944 
sdp_bªdwidth_t
 *
b_h—d”
;

946 *
Ãxt
 = 
buf
;

948 
equ®
 = 
buf
;

950 (*
equ®
 != '=') && (*equal != '\0'))

951 
equ®
++;

953 ià(*
equ®
 == '\0')

954  
ERR_ERROR
;

957 ià(
equ®
[-1] != 'b')

958  
ERR_DISCARD
;

960 
ülf
 = 
equ®
 + 1;

962 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

963 
ülf
++;

965 ià(*
ülf
 == '\0')

966  
ERR_ERROR
;

968 ià(
ülf
 =ğ
equ®
 + 1)

969  
ERR_ERROR
;

971 
tmp
 = 
equ®
 + 1;

973 
i
 = 
	`sdp_bªdwidth_š™
(&
b_h—d”
);

975 ià(
i
 != 0)

976  
ERR_ERROR
;

979 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
b_h—d”
->
b_bwty³
), 
tmp
, ':', &
tmp_Ãxt
);

981 ià(
i
 != 0) {

982 
	`sdp_bªdwidth_ä“
(
b_h—d”
);

986 
tmp
 = 
tmp_Ãxt
;

988 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
b_h—d”
->
b_bªdwidth
), 
tmp
, '\r', &
tmp_Ãxt
);

990 ià(
i
 != 0) {

991 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
b_h—d”
->
b_bªdwidth
), 
tmp
, '\n', &
tmp_Ãxt
);

993 ià(
i
 != 0) {

994 
	`sdp_bªdwidth_ä“
(
b_h—d”
);

1003 
i
 = 
	`os_li¡_size
(&
sdp
->
m_medŸs
);

1005 ià(
i
 == 0)

1006 
	`os_li¡_add
(&
sdp
->
b_bªdwidths
, 
b_h—d”
, -1);

1009 
sdp_medŸ_t
 *
Ï¡_sdp_medŸ
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
i
 - 1);

1011 
	`os_li¡_add
(&
Ï¡_sdp_medŸ
->
b_bªdwidths
, 
b_h—d”
, -1);

1014 ià(
ülf
[1] == '\n')

1015 *
Ãxt
 = 
ülf
 + 2;

1018 *
Ãxt
 = 
ülf
 + 1;

1020  
OSIP_WF
;

1021 
	}
}

1023 
	$sdp_mes§ge_·r£_t
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1024 *
equ®
;

1025 *
ülf
;

1026 *
tmp
;

1027 *
tmp_Ãxt
;

1028 
i
;

1029 
sdp_time_desü_t
 *
t_h—d”
;

1031 *
Ãxt
 = 
buf
;

1033 
equ®
 = 
buf
;

1035 (*
equ®
 != '=') && (*equal != '\0'))

1036 
equ®
++;

1038 ià(*
equ®
 == '\0')

1039  
ERR_ERROR
;

1042 ià(
equ®
[-1] != 't')

1043  
ERR_DISCARD
;

1045 
ülf
 = 
equ®
 + 1;

1047 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1048 
ülf
++;

1050 ià(*
ülf
 == '\0')

1051  
ERR_ERROR
;

1053 ià(
ülf
 =ğ
equ®
 + 1)

1054  
ERR_ERROR
;

1056 
tmp
 = 
equ®
 + 1;

1058 
i
 = 
	`sdp_time_desü_š™
(&
t_h—d”
);

1060 ià(
i
 != 0)

1061  
ERR_ERROR
;

1063 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
t_h—d”
->
t_¡¬t_time
), 
tmp
, ' ', &
tmp_Ãxt
);

1065 ià(
i
 != 0) {

1066 
	`sdp_time_desü_ä“
(
t_h—d”
);

1070 
tmp
 = 
tmp_Ãxt
;

1072 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
t_h—d”
->
t_¡İ_time
), 
tmp
, '\r', &
tmp_Ãxt
);

1074 ià(
i
 != 0) {

1075 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
t_h—d”
->
t_¡İ_time
), 
tmp
, '\n', &
tmp_Ãxt
);

1077 ià(
i
 != 0) {

1078 
	`sdp_time_desü_ä“
(
t_h—d”
);

1084 
	`os_li¡_add
(&
sdp
->
t_desüs
, 
t_h—d”
, -1);

1086 ià(
ülf
[1] == '\n')

1087 *
Ãxt
 = 
ülf
 + 2;

1090 *
Ãxt
 = 
ülf
 + 1;

1092  
OSIP_WF
;

1093 
	}
}

1095 
	$sdp_mes§ge_·r£_r
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1096 *
equ®
;

1097 *
ülf
;

1098 
šdex
;

1099 *
r_h—d”
;

1100 
sdp_time_desü_t
 *
t_desü
;

1102 *
Ãxt
 = 
buf
;

1104 
equ®
 = 
buf
;

1106 (*
equ®
 != '=') && (*equal != '\0'))

1107 
equ®
++;

1109 ià(*
equ®
 == '\0')

1110  
ERR_ERROR
;

1113 ià(
equ®
[-1] != 'r')

1114  
ERR_DISCARD
;

1116 
šdex
 = 
	`os_li¡_size
(&
sdp
->
t_desüs
);

1118 ià(
šdex
 == 0)

1119  
ERR_ERROR
;

1121 
ülf
 = 
equ®
 + 1;

1123 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1124 
ülf
++;

1126 ià(*
ülf
 == '\0')

1127  
ERR_ERROR
;

1129 ià(
ülf
 =ğ
equ®
 + 1)

1130  
ERR_ERROR
;

1133 
r_h—d”
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

1135 ià(
r_h—d”
 =ğ
NULL
)

1136  
OSIP_NOMEM
;

1138 
	`os_¡ºıy
(
r_h—d”
, 
equ®
 + 1, 
ülf
 - (equal + 1));

1141 
t_desü
 = (
sdp_time_desü_t
 *è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
šdex
 - 1);

1142 
	`os_li¡_add
(&
t_desü
->
r_»³©s
, 
r_h—d”
, -1);

1144 ià(
ülf
[1] == '\n')

1145 *
Ãxt
 = 
ülf
 + 2;

1148 *
Ãxt
 = 
ülf
 + 1;

1150  
OSIP_WF
;

1151 
	}
}

1153 
	$sdp_mes§ge_·r£_z
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1154 *
equ®
;

1155 *
ülf
;

1156 *
z_h—d”
;

1158 *
Ãxt
 = 
buf
;

1160 
equ®
 = 
buf
;

1162 (*
equ®
 != '=') && (*equal != '\0'))

1163 
equ®
++;

1165 ià(*
equ®
 == '\0')

1166  
ERR_ERROR
;

1169 ià(
equ®
[-1] != 'z')

1170  
ERR_DISCARD
;

1172 
ülf
 = 
equ®
 + 1;

1174 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1175 
ülf
++;

1177 ià(*
ülf
 == '\0')

1178  
ERR_ERROR
;

1180 ià(
ülf
 =ğ
equ®
 + 1)

1181  
ERR_ERROR
;

1184 
z_h—d”
 = 
	`os_m®loc
(
ülf
 - (
equ®
 + 1) + 1);

1186 ià(
z_h—d”
 =ğ
NULL
)

1187  
OSIP_NOMEM
;

1189 
	`os_¡ºıy
(
z_h—d”
, 
equ®
 + 1, 
ülf
 - (equal + 1));

1191 
sdp
->
z_adju¡m’ts
 = 
z_h—d”
;

1193 ià(
ülf
[1] == '\n')

1194 *
Ãxt
 = 
ülf
 + 2;

1197 *
Ãxt
 = 
ülf
 + 1;

1199  
OSIP_WF
;

1200 
	}
}

1202 
	$sdp_mes§ge_·r£_k
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1203 *
equ®
;

1204 *
ülf
;

1205 
i
;

1206 *
cŞÚ
;

1207 
sdp_key_t
 *
k_h—d”
;

1208 *
tmp
;

1209 *
tmp_Ãxt
;

1211 *
Ãxt
 = 
buf
;

1213 
equ®
 = 
buf
;

1215 (*
equ®
 != '=') && (*equal != '\0'))

1216 
equ®
++;

1218 ià(*
equ®
 == '\0')

1219  
ERR_ERROR
;

1222 ià(
equ®
[-1] != 'k')

1223  
ERR_DISCARD
;

1225 
ülf
 = 
equ®
 + 1;

1227 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1228 
ülf
++;

1230 ià(*
ülf
 == '\0')

1231  
ERR_ERROR
;

1233 ià(
ülf
 =ğ
equ®
 + 1)

1234  
ERR_ERROR
;

1236 
tmp
 = 
equ®
 + 1;

1238 
i
 = 
	`sdp_key_š™
(&
k_h—d”
);

1240 ià(
i
 != 0)

1241  
ERR_ERROR
;

1246 
cŞÚ
 = 
	`¡rchr
(
equ®
 + 1, ':');

1248 ià((
cŞÚ
 !ğ
NULL
è&& (cŞÚ < 
ülf
)) {

1250 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
k_h—d”
->
k_keyty³
), 
tmp
, ':', &
tmp_Ãxt
);

1252 ià(
i
 != 0) {

1253 
	`sdp_key_ä“
(
k_h—d”
);

1257 
tmp
 = 
tmp_Ãxt
;

1259 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
k_h—d”
->
k_keyd©a
), 
tmp
, '\r', &
tmp_Ãxt
);

1261 ià(
i
 != 0) {

1262 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
k_h—d”
->
k_keyd©a
), 
tmp
, '\n', &
tmp_Ãxt
);

1264 ià(
i
 != 0) {

1265 
	`sdp_key_ä“
(
k_h—d”
);

1271 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
k_h—d”
->
k_keyty³
), 
tmp
, '\r', &
tmp_Ãxt
);

1273 ià(
i
 != 0) {

1274 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
k_h—d”
->
k_keyty³
), 
tmp
, '\n', &
tmp_Ãxt
);

1276 ià(
i
 != 0) {

1277 
	`sdp_key_ä“
(
k_h—d”
);

1287 
i
 = 
	`os_li¡_size
(&
sdp
->
m_medŸs
);

1289 ià(
i
 == 0)

1290 
sdp
->
k_key
 = 
k_h—d”
;

1293 
sdp_medŸ_t
 *
Ï¡_sdp_medŸ
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
i
 - 1);

1297 ià(
Ï¡_sdp_medŸ
->
k_key
 !ğ
NULL
) {

1299 
	`sdp_key_ä“
(
k_h—d”
);

1303 
Ï¡_sdp_medŸ
->
k_key
 = 
k_h—d”
;

1306 ià(
ülf
[1] == '\n')

1307 *
Ãxt
 = 
ülf
 + 2;

1310 *
Ãxt
 = 
ülf
 + 1;

1312  
OSIP_WF
;

1313 
	}
}

1315 
	$sdp_mes§ge_·r£_a
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1316 *
equ®
;

1317 *
ülf
;

1318 *
tmp
;

1319 *
tmp_Ãxt
;

1320 
i
;

1321 
sdp_©Œibu‹_t
 *
a_©Œibu‹
;

1322 *
cŞÚ
;

1324 *
Ãxt
 = 
buf
;

1326 
equ®
 = 
buf
;

1328 (*
equ®
 != '=') && (*equal != '\0'))

1329 
equ®
++;

1331 ià(*
equ®
 == '\0')

1332  
ERR_ERROR
;

1335 ià(
equ®
[-1] != 'a')

1336  
ERR_DISCARD
;

1338 
ülf
 = 
equ®
 + 1;

1340 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1341 
ülf
++;

1343 ià(*
ülf
 == '\0')

1344  
ERR_ERROR
;

1346 ià(
ülf
 =ğ
equ®
 + 1)

1347  
ERR_ERROR
;

1349 
tmp
 = 
equ®
 + 1;

1351 
i
 = 
	`sdp_©Œibu‹_š™
(&
a_©Œibu‹
);

1353 ià(
i
 != 0)

1354  
ERR_ERROR
;

1359 
cŞÚ
 = 
	`¡rchr
(
equ®
 + 1, ':');

1361 ià((
cŞÚ
 !ğ
NULL
è&& (cŞÚ < 
ülf
)) {

1363 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
a_©Œibu‹
->
a_©t_f›ld
), 
tmp
, ':', &
tmp_Ãxt
);

1365 ià(
i
 != 0) {

1366 
	`sdp_©Œibu‹_ä“
(
a_©Œibu‹
);

1370 
tmp
 = 
tmp_Ãxt
;

1372 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
a_©Œibu‹
->
a_©t_v®ue
), 
tmp
, '\r', &
tmp_Ãxt
);

1374 ià(
i
 != 0) {

1375 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
a_©Œibu‹
->
a_©t_v®ue
), 
tmp
, '\n', &
tmp_Ãxt
);

1377 ià(
i
 != 0) {

1378 
	`sdp_©Œibu‹_ä“
(
a_©Œibu‹
);

1384 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
a_©Œibu‹
->
a_©t_f›ld
), 
tmp
, '\r', &
tmp_Ãxt
);

1386 ià(
i
 != 0) {

1387 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
a_©Œibu‹
->
a_©t_f›ld
), 
tmp
, '\n', &
tmp_Ãxt
);

1389 ià(
i
 != 0) {

1390 
	`sdp_©Œibu‹_ä“
(
a_©Œibu‹
);

1400 
i
 = 
	`os_li¡_size
(&
sdp
->
m_medŸs
);

1402 ià(
i
 == 0)

1403 
	`os_li¡_add
(&
sdp
->
a_©Œibu‹s
, 
a_©Œibu‹
, -1);

1406 
sdp_medŸ_t
 *
Ï¡_sdp_medŸ
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
i
 - 1);

1408 
	`os_li¡_add
(&
Ï¡_sdp_medŸ
->
a_©Œibu‹s
, 
a_©Œibu‹
, -1);

1411 ià(
ülf
[1] == '\n')

1412 *
Ãxt
 = 
ülf
 + 2;

1415 *
Ãxt
 = 
ülf
 + 1;

1417  
OSIP_WF
;

1418 
	}
}

1420 
	$sdp_mes§ge_·r£_m
(
sdp_mes§ge_t
 *
sdp
, *
buf
, **
Ãxt
) {

1421 *
equ®
;

1422 *
ülf
;

1423 *
tmp
;

1424 *
tmp_Ãxt
;

1425 
i
;

1426 
sdp_medŸ_t
 *
m_h—d”
;

1427 *
¦ash
;

1428 *
¥aû
;

1430 *
Ãxt
 = 
buf
;

1432 
equ®
 = 
buf
;

1434 (*
equ®
 != '=') && (*equal != '\0'))

1435 
equ®
++;

1437 ià(*
equ®
 == '\0')

1438  
ERR_ERROR
;

1441 ià(
equ®
[-1] != 'm')

1442  
ERR_ERROR
;

1444 
ülf
 = 
equ®
 + 1;

1446 (*
ülf
 != '\r') && (*crlf != '\n') && (*crlf != '\0'))

1447 
ülf
++;

1449 ià(*
ülf
 == '\0')

1450  
ERR_ERROR
;

1452 ià(
ülf
 =ğ
equ®
 + 1)

1453  
ERR_ERROR
;

1455 
tmp
 = 
equ®
 + 1;

1457 
i
 = 
	`sdp_medŸ_š™
(&
m_h—d”
);

1459 ià(
i
 != 0)

1460  
ERR_ERROR
;

1465 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_medŸ
), 
tmp
, ' ', &
tmp_Ãxt
);

1467 ià(
i
 != 0) {

1468 
	`sdp_medŸ_ä“
(
m_h—d”
);

1472 
tmp
 = 
tmp_Ãxt
;

1474 
¦ash
 = 
	`¡rchr
(
tmp
, '/');

1475 
¥aû
 = 
	`¡rchr
(
tmp
, ' ');

1477 ià(
¥aû
 =ğ
NULL
) {

1478 
	`sdp_medŸ_ä“
(
m_h—d”
);

1479  
ERR_ERROR
;

1482 ià((
¦ash
 !ğ
NULL
è&& (¦ash < 
¥aû
)) {

1483 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_pÜt
), 
tmp
, '/', &
tmp_Ãxt
);

1485 ià(
i
 != 0) {

1486 
	`sdp_medŸ_ä“
(
m_h—d”
);

1490 
tmp
 = 
tmp_Ãxt
;

1492 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_numb”_of_pÜt
), 
tmp
, ' ', &
tmp_Ãxt
);

1494 ià(
i
 != 0) {

1495 
	`sdp_medŸ_ä“
(
m_h—d”
);

1499 
tmp
 = 
tmp_Ãxt
;

1502 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_pÜt
), 
tmp
, ' ', &
tmp_Ãxt
);

1504 ià(
i
 != 0) {

1505 
	`sdp_medŸ_ä“
(
m_h—d”
);

1509 
tmp
 = 
tmp_Ãxt
;

1512 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_´Ùo
), 
tmp
, ' ', &
tmp_Ãxt
);

1514 ià(
i
 != 0) {

1516 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_´Ùo
), 
tmp
, '\r', &
tmp_Ãxt
);

1518 ià(
i
 != 0) {

1519 
i
 = 
	`__os_£t_Ãxt_tok’
(&(
m_h—d”
->
m_´Ùo
), 
tmp
, '\n', &
tmp_Ãxt
);

1521 ià(
i
 != 0) {

1522 
	`sdp_medŸ_ä“
(
m_h—d”
);

1528 
tmp
 = 
tmp_Ãxt
;

1531 *
¡r
;

1532 
mÜe_¥aû_befÜe_ülf
;

1534 
¥aû
 = 
	`¡rchr
(
tmp
 + 1, ' ');

1536 ià(
¥aû
 =ğ
NULL
)

1537 
mÜe_¥aû_befÜe_ülf
 = 1;

1539 ià((
¥aû
 !ğ
NULL
è&& (¥aû > 
ülf
))

1540 
mÜe_¥aû_befÜe_ülf
 = 1;

1543 
mÜe_¥aû_befÜe_ülf
 = 0;

1545 
mÜe_¥aû_befÜe_ülf
 == 0) {

1546 
i
 = 
	`__os_£t_Ãxt_tok’
(&
¡r
, 
tmp
, ' ', &
tmp_Ãxt
);

1548 ià(
i
 != 0) {

1549 
	`sdp_medŸ_ä“
(
m_h—d”
);

1553 
tmp
 = 
tmp_Ãxt
;

1554 
	`os_li¡_add
(&
m_h—d”
->
m_·ylßds
, 
¡r
, -1);

1556 
¥aû
 = 
	`¡rchr
(
tmp
 + 1, ' ');

1558 ià(
¥aû
 =ğ
NULL
)

1559 
mÜe_¥aû_befÜe_ülf
 = 1;

1561 ià((
¥aû
 !ğ
NULL
è&& (¥aû > 
ülf
))

1562 
mÜe_¥aû_befÜe_ülf
 = 1;

1565 
mÜe_¥aû_befÜe_ülf
 = 0;

1568 ià(
tmp_Ãxt
 < 
ülf
) {

1569 
i
 = 
	`__os_£t_Ãxt_tok’
(&
¡r
, 
tmp
, '\r', &
tmp_Ãxt
);

1571 ià(
i
 != 0) {

1572 
i
 = 
	`__os_£t_Ãxt_tok’
(&
¡r
, 
tmp
, '\n', &
tmp_Ãxt
);

1574 ià(
i
 != 0) {

1575 
	`sdp_medŸ_ä“
(
m_h—d”
);

1580 
	`os_li¡_add
(&
m_h—d”
->
m_·ylßds
, 
¡r
, -1);

1584 
	`os_li¡_add
(&
sdp
->
m_medŸs
, 
m_h—d”
, -1);

1586 ià(
ülf
[1] == '\n')

1587 *
Ãxt
 = 
ülf
 + 2;

1590 *
Ãxt
 = 
ülf
 + 1;

1592  
OSIP_WF
;

1593 
	}
}

1595 
	$sdp_mes§ge_·r£
(
sdp_mes§ge_t
 *
sdp
, cÚ¡ *
buf
) {

1609 *
Ãxt_buf
;

1610 *
±r
;

1611 
i
;

1613 
±r
 = (*è
buf
;

1615 
i
 = 
	`sdp_mes§ge_·r£_v
(
sdp
, 
±r
, &
Ãxt_buf
);

1617 ià(
i
 == -1)

1620 ià(0 =ğ
i
)

1623 
±r
 = 
Ãxt_buf
;

1626 
i
 = 
	`sdp_mes§ge_·r£_s
(
sdp
, 
±r
, &
Ãxt_buf
);

1628 ià(
i
 == -1)

1634 
±r
 = 
Ãxt_buf
;

1636 
i
 = 
	`sdp_mes§ge_·r£_o
(
sdp
, 
±r
, &
Ãxt_buf
);

1638 ià(
i
 == -1)

1641 ià(0 =ğ
i
)

1644 
±r
 = 
Ãxt_buf
;

1646 ià(
sdp
->
s_Çme
 =ğ
NULL
) {

1647 
i
 = 
	`sdp_mes§ge_·r£_s
(
sdp
, 
±r
, &
Ãxt_buf
);

1649 ià(
i
 == -1)

1652 ià(0 =ğ
i
) {

1654 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "The \"s\"…arameter is mandatory, buthis…acket does‚ot contain‡ny! -‡nyway, we don't mind‡bout it.\n"));

1657 
±r
 = 
Ãxt_buf
;

1660 
i
 = 
	`sdp_mes§ge_·r£_i
(
sdp
, 
±r
, &
Ãxt_buf
);

1662 ià(
i
 == -1)

1665 
±r
 = 
Ãxt_buf
;

1667 
i
 = 
	`sdp_mes§ge_·r£_u
(
sdp
, 
±r
, &
Ãxt_buf
);

1669 ià(
i
 == -1)

1672 
±r
 = 
Ãxt_buf
;

1674 
i
 = 1;

1676 
i
 == 1) {

1677 
i
 = 
	`sdp_mes§ge_·r£_e
(
sdp
, 
±r
, &
Ãxt_buf
);

1679 ià(
i
 == -1)

1682 
±r
 = 
Ãxt_buf
;

1685 
i
 = 1;

1687 
i
 == 1) {

1688 
i
 = 
	`sdp_mes§ge_·r£_p
(
sdp
, 
±r
, &
Ãxt_buf
);

1690 ià(
i
 == -1)

1693 
±r
 = 
Ãxt_buf
;

1697 ià(
	`os_li¡_size
(&
sdp
->
e_emas
è=ğ0 && os_li¡_size(&sdp->
p_phÚes
) == 0) {

1698 
	`OSIP_TRACE
(
	`os_Œaû
(
__FILE__
, 
__LINE__
, 
OSIP_INFO4
, 
NULL
, "The„fc2327 sayshere should be‡t†east‡nƒmail or‡…hone header!-‡nyway, we don't mind‡bout it.\n"));

1701 
i
 = 
	`sdp_mes§ge_·r£_c
(
sdp
, 
±r
, &
Ãxt_buf
);

1703 ià(
i
 == -1)

1706 
±r
 = 
Ãxt_buf
;

1708 
i
 = 1;

1710 
i
 == 1) {

1711 
i
 = 
	`sdp_mes§ge_·r£_b
(
sdp
, 
±r
, &
Ãxt_buf
);

1713 ià(
i
 == -1)

1716 
±r
 = 
Ãxt_buf
;

1720 
i
 = 
	`sdp_mes§ge_·r£_t
(
sdp
, 
±r
, &
Ãxt_buf
);

1722 ià(
i
 == -1)

1725 ià(
i
 =ğ
ERR_DISCARD
)

1728 
±r
 = 
Ãxt_buf
;

1730 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1731  
OSIP_SUCCESS
;

1733 
i
 = 1;

1735 
i
 == 1) {

1736 
i
 = 
	`sdp_mes§ge_·r£_r
(
sdp
, 
±r
, &
Ãxt_buf
);

1738 ià(
i
 == -1)

1741 
±r
 = 
Ãxt_buf
;

1743 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1744  
OSIP_SUCCESS
;

1748 
mÜe_t_h—d”
 = 1;

1750 
i
 = 
	`sdp_mes§ge_·r£_t
(
sdp
, 
±r
, &
Ãxt_buf
);

1752 ià(
i
 == -1)

1755 
±r
 = 
Ãxt_buf
;

1757 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1758  
OSIP_SUCCESS
;

1760 
mÜe_t_h—d”
 == 1) {

1761 
i
 = 1;

1763 
i
 == 1) {

1764 
i
 = 
	`sdp_mes§ge_·r£_r
(
sdp
, 
±r
, &
Ãxt_buf
);

1766 ià(
i
 == -1)

1769 
±r
 = 
Ãxt_buf
;

1771 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1772  
OSIP_SUCCESS
;

1775 
i
 = 
	`sdp_mes§ge_·r£_t
(
sdp
, 
±r
, &
Ãxt_buf
);

1777 ià(
i
 == -1)

1780 ià(
i
 =ğ
ERR_DISCARD
)

1781 
mÜe_t_h—d”
 = 0;

1784 
mÜe_t_h—d”
 = 1;

1786 
±r
 = 
Ãxt_buf
;

1788 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1789  
OSIP_SUCCESS
;

1793 
i
 = 
	`sdp_mes§ge_·r£_z
(
sdp
, 
±r
, &
Ãxt_buf
);

1795 ià(
i
 == -1)

1798 
±r
 = 
Ãxt_buf
;

1800 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1801  
OSIP_SUCCESS
;

1803 
i
 = 
	`sdp_mes§ge_·r£_k
(
sdp
, 
±r
, &
Ãxt_buf
);

1805 ià(
i
 == -1)

1808 
±r
 = 
Ãxt_buf
;

1810 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1811  
OSIP_SUCCESS
;

1814 
i
 = 1;

1816 
i
 == 1) {

1817 
i
 = 
	`sdp_mes§ge_·r£_a
(
sdp
, 
±r
, &
Ãxt_buf
);

1819 ià(
i
 == -1)

1822 
±r
 = 
Ãxt_buf
;

1824 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1825  
OSIP_SUCCESS
;

1830 
mÜe_m_h—d”
 = 1;

1832 
mÜe_m_h—d”
 == 1) {

1833 
mÜe_m_h—d”
 = 
	`sdp_mes§ge_·r£_m
(
sdp
, 
±r
, &
Ãxt_buf
);

1835 ià(
mÜe_m_h—d”
 == -1)

1838 
±r
 = 
Ãxt_buf
;

1840 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1841  
OSIP_SUCCESS
;

1843 
i
 = 
	`sdp_mes§ge_·r£_i
(
sdp
, 
±r
, &
Ãxt_buf
);

1845 ià(
i
 == -1)

1848 
±r
 = 
Ãxt_buf
;

1850 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1851  
OSIP_SUCCESS
;

1853 
i
 = 1;

1855 
i
 == 1) {

1856 
i
 = 
	`sdp_mes§ge_·r£_c
(
sdp
, 
±r
, &
Ãxt_buf
);

1858 ià(
i
 == -1)

1861 
±r
 = 
Ãxt_buf
;

1863 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1864  
OSIP_SUCCESS
;

1867 
i
 = 1;

1869 
i
 == 1) {

1870 
i
 = 
	`sdp_mes§ge_·r£_b
(
sdp
, 
±r
, &
Ãxt_buf
);

1872 ià(
i
 == -1)

1875 
±r
 = 
Ãxt_buf
;

1877 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1878  
OSIP_SUCCESS
;

1881 
i
 = 
	`sdp_mes§ge_·r£_k
(
sdp
, 
±r
, &
Ãxt_buf
);

1883 ià(
i
 == -1)

1886 
±r
 = 
Ãxt_buf
;

1888 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1889  
OSIP_SUCCESS
;

1892 
i
 = 1;

1894 
i
 == 1) {

1895 
i
 = 
	`sdp_mes§ge_·r£_a
(
sdp
, 
±r
, &
Ãxt_buf
);

1897 ià(
i
 == -1)

1900 
±r
 = 
Ãxt_buf
;

1902 ià(*
±r
 == '\0' || (*ptr == '\r') || (*ptr == '\n'))

1903  
OSIP_SUCCESS
;

1908  
OSIP_SUCCESS
;

1909 
	}
}

1911 
	$sdp_­³nd_cÚÃùiÚ
(**
¡ršg
, *
size
, *
tmp
, 
sdp_cÚÃùiÚ_t
 *
cÚn
, **
Ãxt_tmp
) {

1912 ià(
cÚn
->
c_Ã‰y³
 =ğ
NULL
)

1915 ià(
cÚn
->
c_add¹y³
 =ğ
NULL
)

1918 ià(
cÚn
->
c_addr
 =ğ
NULL
)

1921 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "c=");

1922 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
cÚn
->
c_Ã‰y³
);

1923 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

1924 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
cÚn
->
c_add¹y³
);

1925 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

1926 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
cÚn
->
c_addr
);

1928 ià(
cÚn
->
c_addr_muÉiÿ¡_‰l
 !ğ
NULL
) {

1929 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "/");

1930 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
cÚn
->
c_addr_muÉiÿ¡_‰l
);

1933 ià(
cÚn
->
c_addr_muÉiÿ¡_št
 !ğ
NULL
) {

1934 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "/");

1935 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
cÚn
->
c_addr_muÉiÿ¡_št
);

1938 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

1939 *
Ãxt_tmp
 = 
tmp
;

1940  
OSIP_SUCCESS
;

1941 
	}
}

1943 
	$sdp_­³nd_bªdwidth
(**
¡ršg
, *
size
, *
tmp
, 
sdp_bªdwidth_t
 *
bªdwidth
, **
Ãxt_tmp
) {

1944 ià(
bªdwidth
->
b_bwty³
 =ğ
NULL
)

1947 ià(
bªdwidth
->
b_bªdwidth
 =ğ
NULL
)

1950 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "b=");

1951 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
bªdwidth
->
b_bwty³
);

1952 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, ":");

1953 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
bªdwidth
->
b_bªdwidth
);

1954 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

1956 *
Ãxt_tmp
 = 
tmp
;

1957  
OSIP_SUCCESS
;

1958 
	}
}

1960 
	$sdp_­³nd_time_desü
(**
¡ršg
, *
size
, *
tmp
, 
sdp_time_desü_t
 *
time_desü
, **
Ãxt_tmp
) {

1961 
pos
;

1963 ià(
time_desü
->
t_¡¬t_time
 =ğ
NULL
)

1966 ià(
time_desü
->
t_¡İ_time
 =ğ
NULL
)

1969 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "t=");

1970 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
time_desü
->
t_¡¬t_time
);

1971 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

1972 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
time_desü
->
t_¡İ_time
);

1974 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

1976 
pos
 = 0;

1978 !
	`os_li¡_eŞ
(&
time_desü
->
r_»³©s
, 
pos
)) {

1979 *
¡r
 = (*è
	`os_li¡_g‘
(&
time_desü
->
r_»³©s
, 
pos
);

1981 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "r=");

1982 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
¡r
);

1983 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

1984 
pos
++;

1987 *
Ãxt_tmp
 = 
tmp
;

1988  
OSIP_SUCCESS
;

1989 
	}
}

1991 
	$sdp_­³nd_key
(**
¡ršg
, *
size
, *
tmp
, 
sdp_key_t
 *
key
, **
Ãxt_tmp
) {

1992 ià(
key
->
k_keyty³
 =ğ
NULL
)

1995 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "k=");

1996 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
key
->
k_keyty³
);

1998 ià(
key
->
k_keyd©a
 !ğ
NULL
) {

1999 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, ":");

2000 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
key
->
k_keyd©a
);

2003 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

2004 *
Ãxt_tmp
 = 
tmp
;

2005  
OSIP_SUCCESS
;

2006 
	}
}

2008 
	$sdp_­³nd_©Œibu‹
(**
¡ršg
, *
size
, *
tmp
, 
sdp_©Œibu‹_t
 *
©Œibu‹
, **
Ãxt_tmp
) {

2009 ià(
©Œibu‹
->
a_©t_f›ld
 =ğ
NULL
)

2012 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "a=");

2013 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
©Œibu‹
->
a_©t_f›ld
);

2015 ià(
©Œibu‹
->
a_©t_v®ue
 !ğ
NULL
) {

2016 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, ":");

2017 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
©Œibu‹
->
a_©t_v®ue
);

2020 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

2022 *
Ãxt_tmp
 = 
tmp
;

2023  
OSIP_SUCCESS
;

2024 
	}
}

2027 
	$sdp_­³nd_medŸ
(**
¡ršg
, *
size
, *
tmp
, 
sdp_medŸ_t
 *
medŸ
, **
Ãxt_tmp
) {

2028 
pos
;

2030 ià(
medŸ
->
m_medŸ
 =ğ
NULL
)

2033 ià(
medŸ
->
m_pÜt
 =ğ
NULL
)

2036 ià(
medŸ
->
m_´Ùo
 =ğ
NULL
)

2039 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "m=");

2040 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
medŸ
->
m_medŸ
);

2041 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

2042 ià(
medŸ
->
m_pÜt
[0] == '0')

2043 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "0");

2045 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
medŸ
->
m_pÜt
);

2047 ià(
medŸ
->
m_numb”_of_pÜt
 !ğ
NULL
) {

2048 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "/");

2049 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
medŸ
->
m_numb”_of_pÜt
);

2052 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

2053 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
medŸ
->
m_´Ùo
);

2054 
pos
 = 0;

2056 !
	`os_li¡_eŞ
(&
medŸ
->
m_·ylßds
, 
pos
)) {

2057 *
¡r
 = (*è
	`os_li¡_g‘
(&
medŸ
->
m_·ylßds
, 
pos
);

2059 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, " ");

2060 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
¡r
);

2061 
pos
++;

2064 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

2066 ià(
medŸ
->
i_šfo
 !ğ
NULL
) {

2067 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, "i=");

2068 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
medŸ
->
i_šfo
);

2069 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(
¡ršg
, 
size
,mp, 
OSIP_CRLF
);

2072 
pos
 = 0;

2074 !
	`os_li¡_eŞ
(&
medŸ
->
c_cÚÃùiÚs
, 
pos
)) {

2075 
sdp_cÚÃùiÚ_t
 *
cÚn
 = (sdp_cÚÃùiÚ_ˆ*è
	`os_li¡_g‘
(&
medŸ
->
c_cÚÃùiÚs
, 
pos
);

2076 *
Ãxt_tmp2
;

2077 
i
;

2079 
i
 = 
	`sdp_­³nd_cÚÃùiÚ
(
¡ršg
, 
size
, 
tmp
, 
cÚn
, &
Ãxt_tmp2
);

2081 ià(
i
 != 0)

2084 
tmp
 = 
Ãxt_tmp2
;

2085 
pos
++;

2088 
pos
 = 0;

2090 !
	`os_li¡_eŞ
(&
medŸ
->
b_bªdwidths
, 
pos
)) {

2091 
sdp_bªdwidth_t
 *
bªd
 = (sdp_bªdwidth_ˆ*è
	`os_li¡_g‘
(&
medŸ
->
b_bªdwidths
, 
pos
);

2092 *
Ãxt_tmp2
;

2093 
i
;

2095 
i
 = 
	`sdp_­³nd_bªdwidth
(
¡ršg
, 
size
, 
tmp
, 
bªd
, &
Ãxt_tmp2
);

2097 ià(
i
 != 0)

2100 
tmp
 = 
Ãxt_tmp2
;

2101 
pos
++;

2104 ià(
medŸ
->
k_key
 !ğ
NULL
) {

2105 *
Ãxt_tmp2
;

2106 
i
;

2108 
i
 = 
	`sdp_­³nd_key
(
¡ršg
, 
size
, 
tmp
, 
medŸ
->
k_key
, &
Ãxt_tmp2
);

2110 ià(
i
 != 0)

2113 
tmp
 = 
Ãxt_tmp2
;

2116 
pos
 = 0;

2118 !
	`os_li¡_eŞ
(&
medŸ
->
a_©Œibu‹s
, 
pos
)) {

2119 
sdp_©Œibu‹_t
 *
©Œ
 = (sdp_©Œibu‹_ˆ*è
	`os_li¡_g‘
(&
medŸ
->
a_©Œibu‹s
, 
pos
);

2120 *
Ãxt_tmp2
;

2121 
i
;

2123 
i
 = 
	`sdp_­³nd_©Œibu‹
(
¡ršg
, 
size
, 
tmp
, 
©Œ
, &
Ãxt_tmp2
);

2125 ià(
i
 != 0)

2128 
tmp
 = 
Ãxt_tmp2
;

2129 
pos
++;

2132 *
Ãxt_tmp
 = 
tmp
;

2133  
OSIP_SUCCESS
;

2134 
	}
}

2136 
	$sdp_mes§ge_to_¡r
(
sdp_mes§ge_t
 *
sdp
, **
de¡
) {

2137 
size
;

2138 
pos
;

2139 *
tmp
;

2140 *
¡ršg
;

2142 *
de¡
 = 
NULL
;

2144 ià(!
sdp
 || sdp->
v_v”siÚ
 =ğ
NULL
)

2147 ià(
sdp
->
o_u£ºame
 =ğ
NULL
 || sdp->
o_£ss_id
 =ğNULL || sdp->
o_£ss_v”siÚ
 =ğNULL || sdp->
o_Ã‰y³
 =ğNULL || sdp->
o_add¹y³
 =ğNULL || sdp->
o_addr
 == NULL)

2157 
size
 = 
BODY_MESSAGE_MAX_SIZE
;

2158 
tmp
 = (*è
	`os_m®loc
(
size
);

2160 ià(
tmp
 =ğ
NULL
)

2161  
OSIP_NOMEM
;

2163 
¡ršg
 = 
tmp
;

2165 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "v=");

2166 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
v_v”siÚ
);

2167 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2168 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "o=");

2169 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_u£ºame
);

2170 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, " ");

2171 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_£ss_id
);

2172 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, " ");

2173 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_£ss_v”siÚ
);

2174 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, " ");

2175 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_Ã‰y³
);

2176 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, " ");

2177 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_add¹y³
);

2178 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, " ");

2179 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
o_addr
);

2180 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2182 ià(
sdp
->
s_Çme
 !ğ
NULL
) {

2183 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "s=");

2184 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
s_Çme
);

2185 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2188 ià(
sdp
->
i_šfo
 !ğ
NULL
) {

2189 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "i=");

2190 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
i_šfo
);

2191 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2194 ià(
sdp
->
u_uri
 !ğ
NULL
) {

2195 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "u=");

2196 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
u_uri
);

2197 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2200 
pos
 = 0;

2202 !
	`os_li¡_eŞ
(&
sdp
->
e_emas
, 
pos
)) {

2203 *
ema
 = (*è
	`os_li¡_g‘
(&
sdp
->
e_emas
, 
pos
);

2205 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "e=");

2206 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
ema
);

2207 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2208 
pos
++;

2211 
pos
 = 0;

2213 !
	`os_li¡_eŞ
(&
sdp
->
p_phÚes
, 
pos
)) {

2214 *
phÚe
 = (*è
	`os_li¡_g‘
(&
sdp
->
p_phÚes
, 
pos
);

2216 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "p=");

2217 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
phÚe
);

2218 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2219 
pos
++;

2222 ià(
sdp
->
c_cÚÃùiÚ
 !ğ
NULL
) {

2223 *
Ãxt_tmp
;

2224 
i
;

2226 
i
 = 
	`sdp_­³nd_cÚÃùiÚ
(&
¡ršg
, &
size
, 
tmp
, 
sdp
->
c_cÚÃùiÚ
, &
Ãxt_tmp
);

2228 ià(
i
 != 0) {

2229 
	`os_ä“
(
¡ršg
);

2233 
tmp
 = 
Ãxt_tmp
;

2236 
pos
 = 0;

2238 !
	`os_li¡_eŞ
(&
sdp
->
b_bªdwidths
, 
pos
)) {

2239 
sdp_bªdwidth_t
 *
h—d”
 = (sdp_bªdwidth_ˆ*è
	`os_li¡_g‘
(&
sdp
->
b_bªdwidths
, 
pos
);

2240 *
Ãxt_tmp
;

2241 
i
;

2243 
i
 = 
	`sdp_­³nd_bªdwidth
(&
¡ršg
, &
size
, 
tmp
, 
h—d”
, &
Ãxt_tmp
);

2245 ià(
i
 != 0) {

2246 
	`os_ä“
(
¡ršg
);

2250 
tmp
 = 
Ãxt_tmp
;

2251 
pos
++;

2254 
pos
 = 0;

2256 !
	`os_li¡_eŞ
(&
sdp
->
t_desüs
, 
pos
)) {

2257 
sdp_time_desü_t
 *
h—d”
 = (sdp_time_desü_ˆ*è
	`os_li¡_g‘
(&
sdp
->
t_desüs
, 
pos
);

2258 *
Ãxt_tmp
;

2259 
i
;

2261 
i
 = 
	`sdp_­³nd_time_desü
(&
¡ršg
, &
size
, 
tmp
, 
h—d”
, &
Ãxt_tmp
);

2263 ià(
i
 != 0) {

2264 
	`os_ä“
(
¡ršg
);

2268 
tmp
 = 
Ãxt_tmp
;

2269 
pos
++;

2272 ià(
sdp
->
z_adju¡m’ts
 !ğ
NULL
) {

2273 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, "z=");

2274 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
sdp
->
z_adju¡m’ts
);

2275 
tmp
 = 
	`__os_sdp_­³nd_¡ršg
(&
¡ršg
, &
size
,mp, 
OSIP_CRLF
);

2278 ià(
sdp
->
k_key
 !ğ
NULL
) {

2279 *
Ãxt_tmp
;

2280 
i
;

2282 
i
 = 
	`sdp_­³nd_key
(&
¡ršg
, &
size
, 
tmp
, 
sdp
->
k_key
, &
Ãxt_tmp
);

2284 ià(
i
 != 0) {

2285 
	`os_ä“
(
¡ršg
);

2289 
tmp
 = 
Ãxt_tmp
;

2292 
pos
 = 0;

2294 !
	`os_li¡_eŞ
(&
sdp
->
a_©Œibu‹s
, 
pos
)) {

2295 
sdp_©Œibu‹_t
 *
h—d”
 = (sdp_©Œibu‹_ˆ*è
	`os_li¡_g‘
(&
sdp
->
a_©Œibu‹s
, 
pos
);

2296 *
Ãxt_tmp
;

2297 
i
;

2299 
i
 = 
	`sdp_­³nd_©Œibu‹
(&
¡ršg
, &
size
, 
tmp
, 
h—d”
, &
Ãxt_tmp
);

2301 ià(
i
 != 0) {

2302 
	`os_ä“
(
¡ršg
);

2306 
tmp
 = 
Ãxt_tmp
;

2307 
pos
++;

2310 
pos
 = 0;

2312 !
	`os_li¡_eŞ
(&
sdp
->
m_medŸs
, 
pos
)) {

2313 
sdp_medŸ_t
 *
h—d”
 = (sdp_medŸ_ˆ*è
	`os_li¡_g‘
(&
sdp
->
m_medŸs
, 
pos
);

2314 *
Ãxt_tmp
;

2315 
i
;

2317 
i
 = 
	`sdp_­³nd_medŸ
(&
¡ršg
, &
size
, 
tmp
, 
h—d”
, &
Ãxt_tmp
);

2319 ià(
i
 != 0) {

2320 
	`os_ä“
(
¡ršg
);

2324 
tmp
 = 
Ãxt_tmp
;

2325 
pos
++;

2328 *
de¡
 = 
¡ršg
;

2329  
OSIP_SUCCESS
;

2330 
	}
}

2332 
	$sdp_mes§ge_ä“
(
sdp_mes§ge_t
 *
sdp
) {

2333 ià(
sdp
 =ğ
NULL
)

2336 
	`os_ä“
(
sdp
->
v_v”siÚ
);

2337 
	`os_ä“
(
sdp
->
o_u£ºame
);

2338 
	`os_ä“
(
sdp
->
o_£ss_id
);

2339 
	`os_ä“
(
sdp
->
o_£ss_v”siÚ
);

2340 
	`os_ä“
(
sdp
->
o_Ã‰y³
);

2341 
	`os_ä“
(
sdp
->
o_add¹y³
);

2342 
	`os_ä“
(
sdp
->
o_addr
);

2343 
	`os_ä“
(
sdp
->
s_Çme
);

2344 
	`os_ä“
(
sdp
->
i_šfo
);

2345 
	`os_ä“
(
sdp
->
u_uri
);

2347 
	`os_li¡_ofch¬_ä“
(&
sdp
->
e_emas
);

2349 
	`os_li¡_ofch¬_ä“
(&
sdp
->
p_phÚes
);

2351 
	`sdp_cÚÃùiÚ_ä“
(
sdp
->
c_cÚÃùiÚ
);

2353 
	`os_li¡_¥ecŸl_ä“
(&
sdp
->
b_bªdwidths
, ((*)(*)è& 
sdp_bªdwidth_ä“
);

2355 
	`os_li¡_¥ecŸl_ä“
(&
sdp
->
t_desüs
, ((*)(*)è& 
sdp_time_desü_ä“
);

2357 
	`os_ä“
(
sdp
->
z_adju¡m’ts
);

2358 
	`sdp_key_ä“
(
sdp
->
k_key
);

2360 
	`os_li¡_¥ecŸl_ä“
(&
sdp
->
a_©Œibu‹s
, ((*)(*)è& 
sdp_©Œibu‹_ä“
);

2362 
	`os_li¡_¥ecŸl_ä“
(&
sdp
->
m_medŸs
, ((*)(*)è& 
sdp_medŸ_ä“
);

2364 
	`os_ä“
(
sdp
);

2365 
	}
}

2367 
	$sdp_mes§ge_şÚe
(
sdp_mes§ge_t
 *
sdp
, sdp_mes§ge_ˆ**
de¡
) {

2368 
i
;

2369 *
body
;

2371 
i
 = 
	`sdp_mes§ge_š™
(
de¡
);

2373 ià(
i
 != 0)

2376 
i
 = 
	`sdp_mes§ge_to_¡r
(
sdp
, &
body
);

2378 ià(
i
 != 0)

2379 
”rÜ_sc1
;

2381 
i
 = 
	`sdp_mes§ge_·r£
(*
de¡
, 
body
);

2382 
	`os_ä“
(
body
);

2384 ià(
i
 != 0)

2385 
”rÜ_sc1
;

2387  
OSIP_SUCCESS
;

2389 
”rÜ_sc1
:

2390 
	`sdp_mes§ge_ä“
(*
de¡
);

2392 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcallid.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
ÿÎids_fe
;

31 
os_ÿÎ_id_t
 *
ÿÎid
;

32 *
a_ÿÎid
;

33 *
de¡
;

34 *
»s
;

36 
ÿÎids_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
ÿÎids_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:ÿÎid c®lids.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_ÿÎid
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_ÿÎid
, 200, 
ÿÎids_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_ÿÎid
 + 
	`¡¾’
(a_callid) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_ÿÎid
, "#", 1)) {

54 
	`os_ÿÎ_id_š™
(&
ÿÎid
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("CALLID TO PARSE: |%s|\n", 
a_ÿÎid
);

57 
”rcode
 = 
	`os_ÿÎ_id_·r£
(
ÿÎid
, 
a_ÿÎid
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_ÿÎ_id_to_¡r
(
ÿÎid
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad c®lid fÜm©: %s\n", 
a_ÿÎid
);

68 
	`os_ÿÎ_id_ä“
(
ÿÎid
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_ÿÎid
, 200, 
ÿÎids_fe
);

75 
	`os_ä“
(
a_ÿÎid
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontact.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
cÚùs_fe
;

31 
os_cÚù_t
 *
cÚù
;

32 *
a_cÚù
;

33 *
de¡
;

34 *
»s
;

36 
cÚùs_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
cÚùs_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:cÚù cÚùs.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_cÚù
 = (*è
	`os_m®loc
(500);

44 
»s
 = 
	`fg‘s
(
a_cÚù
, 500, 
cÚùs_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_cÚù
 + 
	`¡¾’
(a_contact) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_cÚù
, "#", 1)) {

54 
	`os_cÚù_š™
(&
cÚù
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("CONTACT TO PARSE: |%s|\n", 
a_cÚù
);

57 
”rcode
 = 
	`os_cÚù_·r£
(
cÚù
, 
a_cÚù
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_cÚù_to_¡r
(
cÚù
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

64 
pos
 = 0;

65 
os_g’”ic_·¿m_t
 *
u_·¿m
;

67 !
	`os_li¡_eŞ
(&
cÚù
->
g’_·¿ms
, 
pos
)) {

68 
u_·¿m
 = (
os_g’”ic_·¿m_t
 *è
	`os_li¡_g‘
(&
cÚù
->
g’_·¿ms
, 
pos
);

70 ià(
u_·¿m
->
gv®ue
 =ğ
NULL
)

71 
	`´štf
("»suÉ: ;%s\n", 
u_·¿m
->
gÇme
);

74 
	`´štf
("»suÉ: ;%s=%s\n", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

76 
pos
++;

80 
	`os_ä“
(
de¡
);

84 
	`´štf
("Bad cÚù fÜm©: %s\n", 
a_cÚù
);

86 
	`os_cÚù_ä“
(
cÚù
);

87 
	`´štf
("=================================================\n");

90 
»s
 = 
	`fg‘s
(
a_cÚù
, 500, 
cÚùs_fe
);

93 
	`os_ä“
(
a_cÚù
);

95 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontentt.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
cÚ‹Á_ty³s_fe
;

31 
os_cÚ‹Á_ty³_t
 *
cÚ‹Á_ty³
;

32 *
a_cÚ‹Á_ty³
;

33 *
de¡
;

34 *
»s
;

36 
cÚ‹Á_ty³s_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
cÚ‹Á_ty³s_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:cÚ‹Á_ty³ cÚ‹Á_ty³s.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_cÚ‹Á_ty³
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_cÚ‹Á_ty³
, 200, 
cÚ‹Á_ty³s_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_cÚ‹Á_ty³
 + 
	`¡¾’
(a_content_type) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_cÚ‹Á_ty³
, "#", 1)) {

54 
	`os_cÚ‹Á_ty³_š™
(&
cÚ‹Á_ty³
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("CONTENT_TYPE TO PARSE: |%s|\n", 
a_cÚ‹Á_ty³
);

57 
”rcode
 = 
	`os_cÚ‹Á_ty³_·r£
(
cÚ‹Á_ty³
, 
a_cÚ‹Á_ty³
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_cÚ‹Á_ty³_to_¡r
(
cÚ‹Á_ty³
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad cÚ‹Á_ty³ fÜm©: %s\n", 
a_cÚ‹Á_ty³
);

68 
	`os_cÚ‹Á_ty³_ä“
(
cÚ‹Á_ty³
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_cÚ‹Á_ty³
, 200, 
cÚ‹Á_ty³s_fe
);

75 
	`os_ä“
(
a_cÚ‹Á_ty³
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tfrom.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
äoms_fe
;

31 
os_äom_t
 *
äom
;

32 *
a_äom
;

33 *
de¡
;

34 *
»s
;

36 
äoms_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
äoms_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:äom froms.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_äom
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_äom
, 200, 
äoms_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_äom
 + 
	`¡¾’
(a_from) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_äom
, "#", 1)) {

54 
	`os_äom_š™
(&
äom
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("FROM TO PARSE: |%s|\n", 
a_äom
);

57 
”rcode
 = 
	`os_äom_·r£
(
äom
, 
a_äom
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_äom_to_¡r
(
äom
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad from fÜm©: %s\n", 
a_äom
);

68 
	`os_äom_ä“
(
äom
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_äom
, 200, 
äoms_fe
);

75 
	`os_ä“
(
a_äom
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/torture.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_·r£r.h
>

27 
	~<os·r£r2/sdp_mes§ge.h
>

29 
‹¡_mes§ge
(*
msg
, 
size_t
 
Ën
, 
v”bo£
, 
şÚe
, 
³rf
);

30 
u§ge
();

32 
	$u§ge
() {

33 
	`årštf
(
¡d”r
, "Usage: ./torture_testorture_file [-v (verbose)] [-c (clone)] [-p (performance:†oop 100.000]\n");

34 
	`ex™
(1);

35 
	}
}

37 
	$»ad_bš¬y
(**
msg
, *
Ën
, 
FILE
 *
tÜtu»_fe
) {

38 *
msg
 = (*è
	`os_m®loc
(100000);

40 *
Ën
 = 
	`ä—d
(*
msg
, 1, 100000, 
tÜtu»_fe
);

41  
	`ã¼Ü
(
tÜtu»_fe
) ? -1 : 0;

42 
	}
}

44 
	$maš
(
¬gc
, **
¬gv
) {

45 
sucûss
 = 1;

46 
loİ
 = 1;

47 
v”bo£
 = 0;

48 
şÚe
 = 0;

49 
FILE
 *
tÜtu»_fe
;

50 *
msg
;

51 *
±r
;

52 
pos
;

53 
Ën
;

54 
ex³ùed_”rÜ
 = 
OSIP_SUCCESS
;

56 
pos
 = 2;…o < 
¬gc
;…os++) {

57 ià(0 =ğ
	`¡ºcmp
(
¬gv
[
pos
], "-v", 2))

58 
v”bo£
 = 1;

60 ià(0 =ğ
	`¡ºcmp
(
¬gv
[
pos
], "-c", 2))

61 
şÚe
 = 1;

63 ià(0 =ğ
	`¡ºcmp
(
¬gv
[
pos
], "-p", 2))

64 
loİ
 = 100000;

67 
	`u§ge
();

70 ià(
¬gc
 < 2) {

71 
	`u§ge
();

74 
tÜtu»_fe
 = 
	`fİ’
(
¬gv
[1], "r");

76 ià(
tÜtu»_fe
 =ğ
NULL
) {

77 
	`u§ge
();

81 
	`·r£r_š™
();

83 ià(
	`»ad_bš¬y
(&
msg
, &
Ën
, 
tÜtu»_fe
) < 0) {

84 
	`årštf
(
¡dout
, "‹¡ % : ===========================ğFAILED (ÿÂÙ„—d fe)\n", 
¬gv
[1]);

88 
±r
 = 
msg
;

90 ià(
	`os_¡ºÿ£cmp
(
msg
, "ex³ùed_”rÜ:", 
	`¡¾’
("expected_error:")) == 0) {

91 
±r
 +ğ
	`¡¾’
("expected_error:");

92 
Ën
 -ğ
	`¡¾’
("expected_error:");

93 
ex³ùed_”rÜ
 = 
	`©oi
(
±r
);

95 *
±r
 != '\r' && *ptr != '\n') {

96 
±r
++;

97 
Ën
--;

100 *
±r
 == '\r' || *ptr == '\n') {

101 
±r
++;

102 
Ën
--;

106 
sucûss
 = 
	`‹¡_mes§ge
(
±r
, 
Ën
, 
v”bo£
, 
şÚe
, 
loİ
);

108 ià(
v”bo£
) {

109 
	`årštf
(
¡dout
, "‹¡ % : ===========================ğ\n", 
¬gv
[1]);

110 
	`fwr™e
(
msg
, 1, 
Ën
, 
¡dout
);

113 ià(
sucûss
 =ğ
ex³ùed_”rÜ
)

114 
	`årštf
(
¡dout
, "‹¡ % : ===========================ğOK (”rÜ_code=%i)\n", 
¬gv
[1], 
ex³ùed_”rÜ
);

117 
	`årštf
(
¡dout
, "‹¡ % : ===========================ğFAILED (ex³ùed=%˜”rÜ_code=%i)\n", 
¬gv
[1], 
ex³ùed_”rÜ
, 
sucûss
);

119 
	`os_ä“
(
msg
);

120 
	`fşo£
(
tÜtu»_fe
);

121 #ifdeà
__lšux


123 ià(
sucûss
 !ğ
ex³ùed_”rÜ
)

124 
	`ex™
(
EXIT_FAILURE
);

127 
	`ex™
(
EXIT_SUCCESS
);

130  
sucûss
;

131 
	}
}

133 
	$‹¡_mes§ge
(*
msg
, 
size_t
 
Ën
, 
v”bo£
, 
şÚe
, 
³rf
) {

134 
os_mes§ge_t
 *
s
;

135 
”r
 = 0;

136 *
»suÉ
;

138 
j
 = 
³rf
;

140 ià(
v”bo£
)

141 
	`årštf
(
¡dout
, "Tryšg %˜£qu’tŸl ÿÎ tØos_mes§ge_š™(), os_mes§ge_·r£(èªd os_mes§ge_ä“()\n", 
j
);

143 
j
 != 0) {

144 
j
--;

145 
	`os_mes§ge_š™
(&
s
);

146 
”r
 = 
	`os_mes§ge_·r£
(
s
, 
msg
, 
Ën
);

148 ià(
”r
 != 0) {

149 ià(
v”bo£
)

150 
	`årštf
(
¡dout
, "ERROR: failed while…arsing!\n");

152 
	`os_mes§ge_ä“
(
s
);

153  
”r
;

156 
	`os_mes§ge_ä“
(
s
);

159 
	`os_mes§ge_š™
(&
s
);

160 
”r
 = 
	`os_mes§ge_·r£
(
s
, 
msg
, 
Ën
);

162 ià(
”r
 != 0) {

163 ià(
v”bo£
)

164 
	`årštf
(
¡dout
, "ERROR: failed while…arsing!\n");

166 
	`os_mes§ge_ä“
(
s
);

167  
”r
;

170 
size_t
 
Ëngth
;

173 
sdp_mes§ge_t
 *
sdp
;

174 
os_body_t
 *
Şdbody
;

175 
pos
;

177 
pos
 = 0;

179 !
	`os_li¡_eŞ
(&
s
->
bod›s
, 
pos
)) {

180 
Şdbody
 = (
os_body_t
 *è
	`os_li¡_g‘
(&
s
->
bod›s
, 
pos
);

181 
pos
++;

182 
	`sdp_mes§ge_š™
(&
sdp
);

183 
”r
 = 
	`sdp_mes§ge_·r£
(
sdp
, 
Şdbody
->
body
);

184 
	`sdp_mes§ge_ä“
(
sdp
);

185 
sdp
 = 
NULL
;

187 ià(
”r
 != 0) {

188 ià(
v”bo£
)

189 
	`årštf
(
¡dout
, "ERROR: Bad SDP!\n");

193 } ià(
v”bo£
)

194 
	`årštf
(
¡dout
, "SUCCESS: Correct SDP!\n");

199 
	`os_mes§ge_fÜû_upd©e
(
s
);

200 
”r
 = 
	`os_mes§ge_to_¡r
(
s
, &
»suÉ
, &
Ëngth
);

202 ià(
”r
 !ğ
OSIP_SUCCESS
) {

203 ià(
v”bo£
)

204 
	`årštf
(
¡dout
, "ERROR: failed while…rinting message!\n");

206 
	`os_mes§ge_ä“
(
s
);

207  
”r
;

210 ià(
v”bo£
)

211 
	`fwr™e
(
»suÉ
, 1, 
Ëngth
, 
¡dout
);

213 ià(
şÚe
) {

214 
j
 = 
³rf
;

216 ià(
v”bo£
)

217 
	`årštf
(
¡dout
, "Tryšg %˜£qu’tŸl ÿÎ tØos_mes§ge_şÚe(èªd os_mes§ge_ä“()\n", 
j
);

219 
j
 != 0) {

220 
os_mes§ge_t
 *
cİy
;

222 
j
--;

223 
”r
 = 
	`os_mes§ge_şÚe
(
s
, &
cİy
);

225 ià(
”r
 !ğ
OSIP_SUCCESS
) {

226 ià(
v”bo£
)

227 
	`årštf
(
¡dout
, "ERROR: failed while creating copy of message!\n");

232 *
tmp
;

233 
size_t
 
Ëngth
;

235 
	`os_mes§ge_fÜû_upd©e
(
cİy
);

236 
”r
 = 
	`os_mes§ge_to_¡r
(
cİy
, &
tmp
, &
Ëngth
);

238 ià(
”r
 !ğ
OSIP_SUCCESS
) {

239 ià(
v”bo£
)

240 
	`årštf
(
¡dout
, "ERROR: failed while…rinting message!\n");

243 ià(0 =ğ
	`¡rcmp
(
»suÉ
, 
tmp
)) {

244 ià(
v”bo£
)

245 
	`´štf
("The osip_message_clone method works…erfectly\n");

248 
	`´štf
("ERROR: The osip_message_clone method DOES NOT works\n");

249 
”r
 = -1;

251 ià(
v”bo£
) {

252 
	`´štf
("Here ishe copy: \n");

253 
	`fwr™e
(
tmp
, 1, 
Ëngth
, 
¡dout
);

254 
	`´štf
("\n");

258 
	`os_ä“
(
tmp
);

261 
	`os_mes§ge_ä“
(
cİy
);

265 ià(
v”bo£
)

266 
	`årštf
(
¡dout
, "sequentials calls: done\n");

269 
	`os_ä“
(
»suÉ
);

272 
	`os_mes§ge_ä“
(
s
);

275  
”r
;

276 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/trecordr.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
»cÜd_rou‹s_fe
;

31 
os_»cÜd_rou‹_t
 *
»cÜd_rou‹
;

32 *
a_»cÜd_rou‹
;

33 *
de¡
;

34 *
»s
;

36 
»cÜd_rou‹s_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
»cÜd_rou‹s_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:»cÜd_rou‹„ecÜd_rou‹s.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_»cÜd_rou‹
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_»cÜd_rou‹
, 200, 
»cÜd_rou‹s_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_»cÜd_rou‹
 + 
	`¡¾’
(a_record_route) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_»cÜd_rou‹
, "#", 1)) {

54 
	`os_»cÜd_rou‹_š™
(&
»cÜd_rou‹
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("RECORD_ROUTE TO PARSE: |%s|\n", 
a_»cÜd_rou‹
);

57 
”rcode
 = 
	`os_»cÜd_rou‹_·r£
(
»cÜd_rou‹
, 
a_»cÜd_rou‹
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_»cÜd_rou‹_to_¡r
(
»cÜd_rou‹
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad„ecÜd_rou‹ fÜm©: %s\n", 
a_»cÜd_rou‹
);

68 
	`os_»cÜd_rou‹_ä“
(
»cÜd_rou‹
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_»cÜd_rou‹
, 200, 
»cÜd_rou‹s_fe
);

75 
	`os_ä“
(
a_»cÜd_rou‹
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/troute.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
rou‹s_fe
;

31 
os_rou‹_t
 *
rou‹
;

32 *
a_rou‹
;

33 *
de¡
;

34 *
»s
;

36 
rou‹s_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
rou‹s_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:rou‹„ou‹s.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_rou‹
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_rou‹
, 200, 
rou‹s_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_rou‹
 + 
	`¡¾’
(a_route) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_rou‹
, "#", 1)) {

54 
	`os_rou‹_š™
(&
rou‹
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("ROUTE TO PARSE: |%s|\n", 
a_rou‹
);

57 
”rcode
 = 
	`os_rou‹_·r£
(
rou‹
, 
a_rou‹
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_rou‹_to_¡r
(
rou‹
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad„ou‹ fÜm©: %s\n", 
a_rou‹
);

68 
	`os_rou‹_ä“
(
rou‹
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_rou‹
, 200, 
rou‹s_fe
);

75 
	`os_ä“
(
a_rou‹
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tto.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
tos_fe
;

31 
os_to_t
 *
to
;

32 *
a_to
;

33 *
de¡
;

34 *
»s
;

36 
tos_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
tos_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:tØtos.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_to
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_to
, 200, 
tos_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_to
 + 
	`¡¾’
(a_to) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_to
, "#", 1)) {

54 
	`os_to_š™
(&
to
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("TO TO PARSE: |%s|\n", 
a_to
);

57 
”rcode
 = 
	`os_to_·r£
(
to
, 
a_to
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_to_to_¡r
(
to
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("BadØfÜm©: %s\n", 
a_to
);

68 
	`os_to_ä“
(
to
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_to
, 200, 
tos_fe
);

75 
	`os_ä“
(
a_to
);

77 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/turls.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_uri.h
>

28 
os_uri_‹¡_acûssÜ_­i
(
os_uri_t
 *
u¾
);

30 
	$maš
(
¬gc
, **
¬gv
) {

31 
FILE
 *
u¾s_fe
;

33 
os_uri_t
 *
u¾
;

34 *
a_u¾
;

35 *
de¡
;

36 *
»s
;

38 
u¾s_fe
 = 
	`fİ’
(
¬gv
[1], "r");

40 ià(
u¾s_fe
 =ğ
NULL
) {

41 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:u¾ u¾s.txt\n", 
¬gv
[1]);

42 
	`ex™
(0);

45 
a_u¾
 = (*è
	`os_m®loc
(200);

46 
»s
 = 
	`fg‘s
(
a_u¾
, 200, 
u¾s_fe
);

48 
»s
 !ğ
NULL
) {

49 
”rcode
;

52 
	`os_¡ºıy
(
a_u¾
 + 
	`¡¾’
(a_url) - 1, "\0", 1);

54 ià(0 !ğ
	`¡ºcmp
(
a_u¾
, "#", 1)) {

56 
	`os_uri_š™
(&
u¾
);

57 
	`´štf
("=================================================\n");

58 
	`´štf
("URL TO PARSE: |%s|\n", 
a_u¾
);

59 
”rcode
 = 
	`os_uri_·r£
(
u¾
, 
a_u¾
);

61 ià(
”rcode
 != -1) {

62 ià(
	`os_uri_to_¡r
(
u¾
, &
de¡
) != -1) {

63 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

64 
	`os_uri_‹¡_acûssÜ_­i
(
u¾
);

65 
	`os_ä“
(
de¡
);

69 
	`´štf
("Bad u¾ fÜm©: %s\n", 
a_u¾
);

71 
	`os_uri_ä“
(
u¾
);

72 
	`´štf
("=================================================\n");

75 
»s
 = 
	`fg‘s
(
a_u¾
, 200, 
u¾s_fe
);

78 
	`os_ä“
(
a_u¾
);

80 
	}
}

82 
	$os_uri_‹¡_acûssÜ_­i
(
os_uri_t
 *
u¾
) {

83 ià(
u¾
->
scheme
 !ğ
NULL
)

84 
	`årštf
(
¡dout
, "%s:", 
u¾
->
scheme
);

86 ià(
u¾
->
¡ršg
 !ğ
NULL
) {

87 
	`årštf
(
¡dout
, "|%s", 
u¾
->
¡ršg
);

88 
	`årštf
(
¡dout
, "\n");

92 ià(
u¾
->
u£ºame
 !ğ
NULL
)

93 
	`årštf
(
¡dout
, "%s|", 
u¾
->
u£ºame
);

95 ià((
u¾
->
·sswÜd
 !ğ
NULL
è&& (u¾->
u£ºame
 != NULL))

96 
	`årštf
(
¡dout
, ":%s|", 
u¾
->
·sswÜd
);

98 ià(
u¾
->
u£ºame
 !ğ
NULL
)

99 
	`årštf
(
¡dout
, "@|");

101 ià(
u¾
->
ho¡
 !ğ
NULL
) {

102 ià(
	`¡rchr
(
u¾
->
ho¡
, ':'è!ğ
NULL
)

103 
	`årštf
(
¡dout
, "[%s]|", 
u¾
->
ho¡
);

106 
	`årštf
(
¡dout
, "%s|", 
u¾
->
ho¡
);

109 ià(
u¾
->
pÜt
 !ğ
NULL
)

110 
	`årštf
(
¡dout
, ":%s|", 
u¾
->
pÜt
);

112 
	`årštf
(
¡dout
, "\nuri-params\n");

115 
pos
 = 0;

116 
os_uri_·¿m_t
 *
u_·¿m
;

118 !
	`os_li¡_eŞ
(&
u¾
->
u¾_·¿ms
, 
pos
)) {

119 
u_·¿m
 = (
os_uri_·¿m_t
 *è
	`os_li¡_g‘
(&
u¾
->
u¾_·¿ms
, 
pos
);

121 ià(
u_·¿m
->
gv®ue
 !ğ
NULL
)

122 
	`årštf
(
¡dout
, ";%s|=|%s|", 
u_·¿m
->
gÇme
, u_·¿m->
gv®ue
);

125 
	`årštf
(
¡dout
, ";%s|", 
u_·¿m
->
gÇme
);

127 
pos
++;

131 
	`årštf
(
¡dout
, "\nheaders\n");

134 
pos
 = 0;

135 
os_uri_h—d”_t
 *
u_h—d”
;

137 !
	`os_li¡_eŞ
(&
u¾
->
u¾_h—d”s
, 
pos
)) {

138 
u_h—d”
 = (
os_uri_h—d”_t
 *è
	`os_li¡_g‘
(&
u¾
->
u¾_h—d”s
, 
pos
);

140 ià(
pos
 == 0)

141 
	`årštf
(
¡dout
, "?%s|=|%s|", 
u_h—d”
->
gÇme
, u_h—d”->
gv®ue
);

144 
	`årštf
(
¡dout
, "&%s|=|%s|", 
u_h—d”
->
gÇme
, u_h—d”->
gv®ue
);

146 
pos
++;

149 
	`årštf
(
¡dout
, "\n");

151 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tvia.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
vŸs_fe
;

31 
os_vŸ_t
 *
vŸ
;

32 *
a_vŸ
;

33 *
de¡
;

34 *
»s
;

36 
vŸs_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
vŸs_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:vŸ vŸs.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_vŸ
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_vŸ
, 200, 
vŸs_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`os_¡ºıy
(
a_vŸ
 + 
	`¡¾’
(a_via) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_vŸ
, "#", 1)) {

54 
	`os_vŸ_š™
(&
vŸ
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("VIA TO PARSE: |%s|\n", 
a_vŸ
);

57 
”rcode
 = 
	`os_vŸ_·r£
(
vŸ
, 
a_vŸ
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_vŸ_to_¡r
(
vŸ
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad vŸ fÜm©: %s\n", 
a_vŸ
);

68 
	`os_vŸ_ä“
(
vŸ
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_vŸ
, 200, 
vŸs_fe
);

75 
	`os_ä“
(
a_vŸ
);

78 
	}
}

	@/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/twwwa.c

20 #ifdeà
ENABLE_MPATROL


21 
	~<m·ŒŞ.h
>

24 
	~<os·r£r2/š‹º®.h
>

25 
	~<os·r£r2/os_pÜt.h
>

26 
	~<os·r£r2/os_mes§ge.h
>

28 
	$maš
(
¬gc
, **
¬gv
) {

29 
FILE
 *
wwwauth’tiÿ‹s_fe
;

31 
os_www_auth’tiÿ‹_t
 *
wwwauth’tiÿ‹
;

32 *
a_wwwauth’tiÿ‹
;

33 *
de¡
;

34 *
»s
;

36 
wwwauth’tiÿ‹s_fe
 = 
	`fİ’
(
¬gv
[1], "r");

38 ià(
wwwauth’tiÿ‹s_fe
 =ğ
NULL
) {

39 
	`årštf
(
¡dout
, "FaedØİ’ % fe.\nU§ge:wwwauth’tiÿ‹ wwwauth’tiÿ‹s.txt\n", 
¬gv
[1]);

40 
	`ex™
(0);

43 
a_wwwauth’tiÿ‹
 = (*è
	`os_m®loc
(200);

44 
»s
 = 
	`fg‘s
(
a_wwwauth’tiÿ‹
, 200, 
wwwauth’tiÿ‹s_fe
);

46 
»s
 !ğ
NULL
) {

47 
”rcode
;

50 
	`¡ºıy
(
a_wwwauth’tiÿ‹
 + 
	`¡¾’
(a_wwwauthenticate) - 1, "\0", 1);

52 ià(0 !ğ
	`¡ºcmp
(
a_wwwauth’tiÿ‹
, "#", 1)) {

54 
	`os_www_auth’tiÿ‹_š™
(&
wwwauth’tiÿ‹
);

55 
	`´štf
("=================================================\n");

56 
	`´štf
("WWWAUTHENTICATE TO PARSE: |%s|\n", 
a_wwwauth’tiÿ‹
);

57 
”rcode
 = 
	`os_www_auth’tiÿ‹_·r£
(
wwwauth’tiÿ‹
, 
a_wwwauth’tiÿ‹
);

59 ià(
”rcode
 != -1) {

60 ià(
	`os_www_auth’tiÿ‹_to_¡r
(
wwwauth’tiÿ‹
, &
de¡
) != -1) {

61 
	`´štf
("»suÉ: |%s|\n", 
de¡
);

62 
	`os_ä“
(
de¡
);

66 
	`´štf
("Bad wwwauth’tiÿ‹ fÜm©: %s\n", 
a_wwwauth’tiÿ‹
);

68 
	`os_www_auth’tiÿ‹_ä“
(
wwwauth’tiÿ‹
);

69 
	`´štf
("=================================================\n");

72 
»s
 = 
	`fg‘s
(
a_wwwauth’tiÿ‹
, 200, 
wwwauth’tiÿ‹s_fe
);

75 
	`os_ä“
(
a_wwwauth’tiÿ‹
);

77 
	}
}

	@
1
.
0
115
8680
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/internal.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_condv.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_dialog.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_fifo.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_mt.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osip2/osip_time.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_encoding.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_accept_language.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_alert_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_allow.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authentication_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_authorization.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_id.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_call_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_contact.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_disposition.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_encoding.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_length.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_content_type.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_cseq.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_error_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_from.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_header.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_mime_version.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authenticate.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authentication_info.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_proxy_authorization.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_record_route.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_route.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_to.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_via.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/headers/osip_www_authenticate.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/internal.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_body.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_const.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_headers.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_list.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_md5.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_message.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_parser.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_port.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/osip_uri.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/include/osipparser2/sdp_message.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/fsm_misc.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ict_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/ist_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nict_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/nist_fsm.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_dialog.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_event.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_time.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/osip_transaction.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_condv.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_fifo.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_sema.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/port_thread.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osip2/xixt.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_encoding.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_accept_language.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_alert_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_allow.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authentication_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_authorization.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_body.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_id.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_call_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_contact.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_disposition.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_encoding.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_length.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_content_type.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_cseq.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_error_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_from.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_header.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_list.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_md5c.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_parse.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_message_to_str.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_mime_version.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_parser_cfg.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_port.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authenticate.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authentication_info.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_proxy_authorization.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_record_route.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_route.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_to.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_uri.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_via.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/osip_www_authenticate.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/parser.h
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_accessor.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/osipparser2/sdp_message.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcallid.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontact.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tcontentt.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tfrom.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/torture.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/trecordr.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/troute.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tto.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/turls.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/tvia.c
/home/unasaw/sip_project/libosip2-5.3.0_bp/src/test/twwwa.c
